AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3rd party libraries used by Inventor 2024
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3rd-party-libraries-used-by-inventor-2024
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2024/09/3rd-party-libraries-used-by-inventor-2024.html 
DATE: 09/24/2024 06:30:09 PM
-----
BODY:
<p>Looks like I missed to publish this for <strong>Inventor 2024</strong> but some people do need it, so here it goes.</p>
<p>If you are using any of them from your <strong>add-in</strong> then the best is to make sure you are using the same version to avoid version conflict:</p>
<table style="height: 334px; border-style: solid; border-color: #000000; float: left; width: 288px;">
<tbody>
<tr style="height: 10px;">
<td style="height: 10px; width: 167px;">
<p><strong>Component Name</strong></p>
</td>
<td style="height: 10px; width: 105px;">
<p><strong>Version</strong></p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>DevExpress</p>
</td>
<td style="height: 30px; width: 105px;">
<p>21.1.5</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>7z</p>
</td>
<td style="height: 30px; width: 105px;">
<p>22.00.0.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>SQLite</p>
</td>
<td style="height: 30px; width: 105px;">
<p>3.30.1</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>QtTK</p>
</td>
<td style="height: 46px; width: 105px;">
<p>6.2.40</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>QtMFCBridge</p>
</td>
<td style="height: 30px; width: 105px;">
<p>620.280.2</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 10px; width: 167px;">
<p>TBB</p>
</td>
<td style="height: 10px; width: 105px;">
<p>6.1.30</p>
</td>
</tr>
<tr style="height: 46px;">
<td style="width: 167px; height: 46px;">
<p>NLog</p>
</td>
<td style="width: 105px; height: 46px;">
<p>4.7.10</p>
</td>
</tr>
<tr style="height: 46px;">
<td style="width: 167px; height: 46px;">
<p>WebView2</p>
</td>
<td style="width: 105px; height: 46px;">
<p>1.0.1210.39</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Debug new Inventor 2025 add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: debug-new-inventor-2025-add-in
CATEGORY: Adam
CATEGORY: Add-In Creation
CATEGORY: C#
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2024/09/debug-new-inventor-2025-add-in.html 
DATE: 09/02/2024 09:02:48 AM
-----
BODY:
<p>When creating a new <strong>add-in</strong> you can take advantage of the <strong>Visual Studio 2022</strong> templates that are installed as part of the <strong>developertools.msi</strong> installer found in <strong>C:\Users\Public\Documents\Autodesk\Inventor 2025\SDK<br /></strong>More info on it: <a href="https://help.autodesk.com/view/INVNTOR/2025/ENU/?guid=GUID-52422162-1784-4E8F-B495-CDB7BE9987AB">https://help.autodesk.com/view/INVNTOR/2025/ENU/?guid=GUID-52422162-1784-4E8F-B495-CDB7BE9987AB&#0160;</a></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5a13200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Inventor2025Template" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3ba5a13200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5a13200c-500wi" title="Inventor2025Template" /></a></p>
<p>You can simply create a folder for your app under <strong>C:\ProgramData\Autodesk\Inventor Addins\</strong></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5a26200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="AddinLocation" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3ba5a26200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5a26200c-500wi" title="AddinLocation" /></a></p>
<p>and set the <strong>Base output path</strong> of your project to this in the <strong>Project Properties</strong> panel so that both the <strong>*.addin</strong> file and the <strong>dll</strong> will end up at the right location, i.e. where <strong>Inventor</strong> can find them.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf43a200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Outputpath" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3bdf43a200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf43a200b-500wi" title="Outputpath" /></a></p>
<p>One more thing to do is set the <strong>Copy to Output Directory</strong> property of the <strong>*.addin</strong> file to <strong>Copy if newer&#0160;</strong>so it does get copied into the folder we created.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf44a200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Copyaddin" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3bdf44a200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf44a200b-500wi" title="Copyaddin" /></a></p>
<p>Usually, when you want to debug your <strong>add-in</strong>, you want <strong>Visual Studio</strong> to start up <strong>Inventor</strong> which will then load your <strong>add-in</strong>. <br />In the case of <strong>.NET Framework add-ins</strong> (like the one for <strong>Inventor 2024</strong>) that was an option using <strong>Start external program</strong>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402dad0ce2b03200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="2024addin" class="asset  asset-image at-xid-6a00e553fcbfc6883402dad0ce2b03200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402dad0ce2b03200d-500wi" title="2024addin" /></a><br />In the case of an <strong>Inventor 2025 .NET 8.0 add-in</strong> that option is not exposed directly in the <strong>Visual Studio</strong> UI. What you can do is modify e.g. the <strong>Command line arguments</strong> of the <strong>Launch Profile</strong> which will then generate a <strong>launchSettings.json</strong> file under the <strong>Properties</strong> folder - just make sure <strong>Show All Files</strong> option is enabled in the <strong>Solution Explorer</strong> so that you can see the file.&#0160;&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf49e200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="LaunchSettingsCreation" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3bdf49e200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bdf49e200b-500wi" title="LaunchSettingsCreation" /></a></p>
<p>Now you can just open the <strong>launchSettings.json</strong> file and modify the content of the profile so that it&#39;s using the highlighted parts:</p>
<pre>{
  &quot;profiles&quot;: {
    &quot;InventorAddIn2025&quot;: {
      <strong>&quot;commandName&quot;: &quot;Executable&quot;,
      &quot;executablePath&quot;: &quot;C:\\Program Files\\Autodesk\\Inventor 2025\\Bin\\Inventor.exe&quot;</strong>
    }
  }
}</pre>
<p>Now when you click the <strong>Debug</strong> button <strong>Inventor</strong> will start up</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5aa3200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="InventorStartup" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3ba5aa3200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5aa3200c-500wi" title="InventorStartup" /></a></p>
<p>A developer just told me that there is another way to run <strong>Inventor</strong> when debugging - you just have to create a new <strong>Executable</strong> profile that allows you to specify the path of an <strong>Executable</strong> (I also renamed it to <strong>Start Inventor</strong> to make it clear what it does)</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bade35200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"></a> <a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bade3c200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Startinventor" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3bade3c200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3bade3c200c-500wi" title="Startinventor" /></a></p>
<p>As usual, the first time <strong>Inventor</strong> encounters your <strong>add-in</strong> it will block it (<a href="https://adndevblog.typepad.com/manufacturing/2016/04/add-in-security-in-inventor-2017.html">unless it&#39;s been signed</a>) and warn you about it, so you just have to go to the <strong>Add-In Manager</strong>, unblock it and load it</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402dad0ce2b8a200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Addinmanager" class="asset  asset-image at-xid-6a00e553fcbfc6883402dad0ce2b8a200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402dad0ce2b8a200d-500wi" title="Addinmanager" /></a></p>
<p>If you placed a <strong>break point</strong> inside the <strong>Activate</strong> method, that should be hit ðŸ¥³</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5ac5200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Breakpoint" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3ba5ac5200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3ba5ac5200c-500wi" title="Breakpoint" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3rd party libraries used by Inventor 2025
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3rd-party-libraries-used-by-inventor-2025
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2024/05/3rd-party-libraries-used-by-inventor-2025.html 
DATE: 05/10/2024 11:53:23 PM
-----
BODY:
<p>Here is a list of the various 3rd parties <strong>libraries</strong> and their <strong>versions</strong> that <strong>Inventor</strong> <strong>2025</strong>&#0160;is using - i.e. they are used by the <strong>core product</strong>, and some of them are also used by certain <strong>add-ins</strong>.</p>
<p>If you are using any of them from your <strong>add-in</strong> then the best is to make sure you are using the same version to avoid version conflict:</p>
<table style="height: 334px; border-style: solid; border-color: #000000; float: left; width: 288px;">
<tbody>
<tr style="height: 10px;">
<td style="height: 10px; width: 167px;">
<p><strong>Component Name</strong></p>
</td>
<td style="height: 10px; width: 105px;">
<p><strong>Version</strong></p>
</td>
</tr>
<tr style="height: 10px;">
<td style="height: 10px; width: 167px;">
<p>.NET Code</p>
</td>
<td style="height: 10px; width: 105px;">
<p>8.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>DevExpress</p>
</td>
<td style="height: 30px; width: 105px;">
<p>22.2.7</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>7z</p>
</td>
<td style="height: 30px; width: 105px;">
<p>22.00.0.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>SQLite</p>
</td>
<td style="height: 30px; width: 105px;">
<p>3.40.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>Qt</p>
</td>
<td style="height: 46px; width: 105px;">
<p>6.5.10</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>QtMFCBridge</p>
</td>
<td style="height: 30px; width: 105px;">
<p>651.280.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 10px; width: 167px;">
<p>TBB</p>
</td>
<td style="height: 10px; width: 105px;">
<p>6.1.30</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 10px; width: 167px;">
<p>OneTBB</p>
</td>
<td style="height: 10px; width: 105px;">
<p>7.0.100</p>
</td>
</tr>
<tr style="height: 46px;">
<td style="width: 167px; height: 46px;">
<p>NLog</p>
</td>
<td style="width: 105px; height: 46px;">
<p>4.7.10</p>
</td>
</tr>
<tr style="height: 46px;">
<td style="width: 167px; height: 46px;">
<p>WebView2 SDK</p>
</td>
<td style="width: 105px; height: 46px;">
<p>1.0.1210.39</p>
</td>
</tr>
<tr style="height: 46px;">
<td style="width: 167px; height: 46px;">
<p>WebView2 RUNTIME</p>
</td>
<td style="width: 105px; height: 46px;">
<p>1.3.165.21</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Communicate with add-in from custom web page
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: communicate-with-add-in-from-custom-web-page
CATEGORY: Adam
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: JavaScript

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2024/02/communicate-with-add-in-from-custom-web-page.html 
DATE: 02/09/2024 03:30:59 PM
-----
BODY:
<p>This does not have much to do with <strong>Inventor</strong>, it&#39;s simply about using a web browser component (<a href="https://cefsharp.github.io/">CefSharp</a>,&#0160;<a href="https://developer.microsoft.com/en-us/microsoft-edge/webview2/">WebView2</a> or something else) and send messages from the displayed website to the app.</p>
<p>I created a very basic sample to prove this works and used <strong>WebView2</strong> just like my colleague for the <a href="https://adndevblog.typepad.com/manufacturing/2020/12/using-microsoft-edge-webview2-in-a-detailpanetab.html">Vault add-in sample</a>.</p>
<p>Took the <strong>SimpleAddIn</strong> sample available in the <strong>Inventor SDK</strong> under &quot;DeveloperTools\Samples\VCSharp.NET\AddIns\SimpleAddIn&quot;, added a <strong>Form</strong> to it that includes a <strong>WebView2</strong> component.</p>
<pre>using System.Windows.Forms;

namespace SimpleAddIn
{
    public partial class MyBrowserForm : Form
    {
        Inventor.Application _app;

        public MyBrowserForm(Inventor.Application app)
        {
            _app = app;

            // This seems to be needed
            string path = System.Environment.GetFolderPath(System.Environment.SpecialFolder.ApplicationData);
            System.Environment.SetEnvironmentVariable(&quot;WEBVIEW2_USER_DATA_FOLDER&quot;, path);

            InitializeComponent();

            myWebView2.WebMessageReceived += MyWebView2_WebMessageReceived;
            myWebView2.CoreWebView2InitializationCompleted += MyWebView2_CoreWebView2InitializationCompleted;
            myWebView2.EnsureCoreWebView2Async();
        }

        private void MyWebView2_CoreWebView2InitializationCompleted(object sender, Microsoft.Web.WebView2.Core.CoreWebView2InitializationCompletedEventArgs e)
        {
            var htmlContent = @&quot;
&lt;html&gt;
&lt;body&gt;
&lt;script&gt;
function onClick() {
  window.chrome.webview.postMessage(&#39;Hello from web page&#39;);
}
&lt;/script&gt;
&lt;button onclick=&quot;&quot;onClick()&quot;&quot;&gt;Hello&lt;/button&gt;
&lt;/body&gt;
&lt;/html&gt;
            &quot;;
            myWebView2.NavigateToString(htmlContent);
        }

        private void MyWebView2_WebMessageReceived(object sender, Microsoft.Web.WebView2.Core.CoreWebView2WebMessageReceivedEventArgs e)
        {
            var text = e.TryGetWebMessageAsString();
            var docName = _app.ActiveDocument.DisplayName;
            MessageBox.Show(text + &quot; for &quot; + docName);
        }
    }
}
</pre>
<p>Then show that <strong>Form</strong> when the &quot;<strong>Draw Slot</strong>&quot; button is clicked.</p>
<pre>override protected void ButtonDefinition_OnExecute(NameValueMap context)
{
    var myBrowserForm = new MyBrowserForm(InventorApplication);
    myBrowserForm.Show();
}</pre>
<p>When the user clicks the &quot;Hello&quot; button of the web page that will send a message back to the container.<br />The message can be caught using the <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.web.webview2.winforms.webview2.webmessagereceived">WebMessageReceived</a> event handler.</p>
<p>See it in action:</p>
<p><iframe allowfullscreen="" frameborder="0" height="270" src="//www.youtube.com/embed/DpoqUrG0_Wk" width="480"></iframe></p>
<p>Source code:&#0160;<a href="https://github.com/adamenagy/InventorWebView2">https://github.com/adamenagy/InventorWebView2</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Check if external iLogic rules are used
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: check-if-external-ilogic-rules-are-used
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2023/12/check-if-external-ilogic-rules-are-used.html 
DATE: 12/13/2023 12:43:47 PM
-----
BODY:
<p>It might not be easy to check manually if a document and its referenced documents are relying on external iLogic rules or not.</p>
<p>They might be used from &quot;Event Triggers&quot; or called from other rules using the &quot;RunExternalRule&quot; function.</p>
<p>Here is a utility rule that can be used to help with this. The results will be printed in the &quot;iLogic Log&quot; panel.</p>
<pre>Imports System.Text.RegularExpressions
Sub Main()
  Dim doc As Inventor.Document
  doc = ThisDoc.Document

  CheckDocument(doc)
  For Each doc In doc.AllReferencedDocuments
    CheckDocument(doc)
  Next
End Sub

Sub CheckDocument(doc As Document)
  Logger.Debug(&quot;Checking document &quot; + doc.FullDocumentName)
  CheckEventTriggers(doc)
  CheckRules(doc)
End Sub

&#39; Check if any Event Trigger use an external rule
Sub CheckEventTriggers(doc As Document)
  Dim propSets As PropertySets = doc.PropertySets
  Dim iLogicPropSet As PropertySet

  Try
    iLogicPropSet = propSets.Item(&quot;{2C540830-0723-455E-A8E2-891722EB4C3E}&quot;)
  Catch
    Exit Sub
  End Try

  For Each prop As Inventor.Property In iLogicPropSet
    If Not prop.Value.StartsWith(&quot;file://&quot;) Then Continue For

    Logger.Debug(prop.Name + &quot; uses &quot; + prop.Value)
  Next
End Sub

&#39; Check if any rules try to execute an external rule
Sub CheckRules(doc As Document)
  Dim iLogicAuto = iLogicVb.Automation

  Dim rules = iLogicAuto.Rules(doc)
  If (rules Is Nothing) Then Exit Sub

  For Each rule In rules
    CheckRuleText(rule.Name, rule.Text)
  Next
End Sub

Sub CheckRuleText(ruleName As String, ruleText As String)
  &#39; Used https://regexr.com/ to figure out the Regex string
  Dim res = Regex.Matches(ruleText, &quot;(RunExternalRule\s*\(\s*&quot;&quot;)(.+)(\&quot;&quot;)&quot;)

  Dim externalRules = New List(Of String)
  For Each match As Match In res
    Try
      Dim name = match.Groups(2).Value
      If Not externalRules.Contains(name) Then
        externalRules.Add(name)
      End If
    Catch

    End Try
  Next

  If externalRules.Count &gt; 0 Then
    Dim str = String.Join(&quot;, &quot;, externalRules)
    Logger.Debug(ruleName + &quot; uses these external rules: &quot; + str)
  End If
End Sub</pre>
<p>And the result when running it on my assembly:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3a15139200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CheckForExternalRuleReferences" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883402c8d3a15139200c image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402c8d3a15139200c-800wi" title="CheckForExternalRuleReferences" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Get object type when using "Embed Interop Types" False
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-object-type-when-using-embed-interop-types-false
CATEGORY: Adam
CATEGORY: C#
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2023/05/get-object-type-when-using-embed-interop-types-false.html 
DATE: 05/18/2023 09:52:44 AM
-----
BODY:
<p>There is a <a href="https://modthemachine.typepad.com/my_weblog/2012/07/set-embed-interop-types-to-false-to-avoid-problems-with-events.html">blog post</a> on why it&#39;s better to have <strong>Embed Interop Types</strong> of the <strong>autodesk.inventor.interop</strong> assembly set to <strong>False</strong></p>
<p>However, in this case some properties might not show up when typing your code, but they can still be accessed if you are using <strong>late binding</strong> - in case of <strong>C#</strong> you can do that by declaring a variable as <strong>dynamic</strong></p>
<p>Also, <strong>GetType()</strong> will not provide the exact com type, but just a generic <strong>__ComObject</strong></p>
<p>Having the <strong>Type</strong> property should be enough to identify the type of the object, but if you really need the actual <strong>COM</strong> name of it, then you can use the <strong>Microsoft.VisualBasic</strong> assembly for that.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402b751a53ac4200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ComType" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883402b751a53ac4200c image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883402b751a53ac4200c-800wi" title="ComType" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 Affiliate Program
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-affiliate-program
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2023/03/fusion-360-affiliate-program.html 
DATE: 03/14/2023 05:56:35 PM
-----
BODY:
<p><em>Are you a huge fan of Autodesk Fusion 360? Do you have a robust community or following that trusts your opinion on software (and other things)? The Fusion 360 Marketing Team has a lucrative proposal for you: join our affiliate program!</em></p>
<p>Affiliate marketing is a process by which an affiliate earns a commission for selling another companyâ€™s products. At Autodesk, potential affiliates apply to our program and, once approved, are given unique links and visuals to use when mentioning our products on their channels. Members receive a commission on every verified sale made through their unique link.</p>
<p><strong>Whatâ€™s in it for me? </strong></p>
<p>The team at Fusion 360 is looking for passionate community members with a following that would respect their opinion on design and manufacturing software solutions. We think such valuable voices deserve compensation for any sales they help make happen, so we offer a starting commission of 7% on verified digital sales.</p>
<p>The Fusion 360 team is really excited to launch a program that recognizes and rewards our community members in everyoneâ€™s favorite way: cash! If youâ€™re interested, please reach out to the Fusion 360 social media manager at <a href="mailto:fusion360affiliateprogram@autodesk.com">fusion360affiliateprogram@autodesk.com</a>, or simply DM us on social media to get in touch.</p>
<p>-Muna Idriss</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3rd party libraries used by Inventor 2023
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3rd-party-libraries-used-by-inventor-2023
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2023/01/3rd-party-libraries-used-by-inventor-2023.html 
DATE: 01/04/2023 10:32:37 AM
-----
BODY:
<p>Here is a list of the various 3rd parties <strong>libraries</strong> and their <strong>versions</strong> that <strong>Inventor</strong> <strong>2023</strong>&#0160;is using - i.e. they are used by the <strong>core product</strong>, and some of them are also used by certain <strong>add-ins</strong>.</p>
<p>If you are using any of them from your <strong>add-in</strong> then the best is to make sure you are using the same version to avoid version conflict:</p>
<table style="height: 232px; border-style: solid; border-color: #000000; float: left; width: 288px;">
<tbody>
<tr style="height: 10px;">
<td style="height: 10px; width: 167px;">
<p><strong>Component Name</strong></p>
</td>
<td style="height: 10px; width: 105px;">
<p><strong>Version</strong></p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>DevExpress</p>
</td>
<td style="height: 30px; width: 105px;">
<p>21.1.5</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>7z</p>
</td>
<td style="height: 30px; width: 105px;">
<p>18.06.0.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>CEFSharp</p>
</td>
<td style="height: 46px; width: 105px;">
<p>91.1.230</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>SQLite</p>
</td>
<td style="height: 30px; width: 105px;">
<p>3.30.1</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>Qt</p>
</td>
<td style="height: 46px; width: 105px;">
<p>5.150.40</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>QtMFCBridge</p>
</td>
<td style="height: 30px; width: 105px;">
<p>5150.280.1</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 10px; width: 167px;">
<p>TBB</p>
</td>
<td style="height: 10px; width: 105px;">
<p>6.1.30</p>
</td>
</tr>
<tr>
<td style="width: 167px;">
<p>NLog</p>
</td>
<td style="width: 105px;">
<p>4.7.10</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Import Data Exchange model 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: import-data-exchange-model
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2022/04/import-data-exchange-model.html 
DATE: 04/12/2022 09:49:43 PM
-----
BODY:
<p>There is a new feature called <strong>Data Exchange</strong> that also has an <strong>API</strong> now available in <strong>public</strong> <strong>beta</strong> - see <a href="https://forge.autodesk.com/blog/data-exchange-released-forge-data-exchange-apis-now-available-public-beta">Data Exchange Released! Forge Data Exchange APIs now available in Public Beta</a></p>
<p>Through the user interface you can import such models in <strong>Inventor</strong> and you can also automate that process using the <strong>Inventor API.</strong></p>
<p>For testing purposes, the easiest thing is to find a previously created <strong>Data Exchange</strong> model in your <strong>Autodesk Construction Cloud</strong> account, check its id available under <strong>entityId</strong> in the <strong>URL</strong>, and assign that in the below code to the <strong>sUrn </strong>variable.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834027880769f86200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image (14)" border="0" class="asset  asset-image at-xid-6a00e553fcbfc68834027880769f86200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834027880769f86200d-800wi" title="Image (14)" /></a></p>
<pre>Sub ImportDataExchangeComponentSample()
    Dim oDoc As AssemblyDocument
    Set oDoc = ThisApplication.ActiveDocument
    
    Dim sFdx As String
    sFdx = &quot;https://developer.api.autodesk.com/exchange/v1/exchanges&quot;
    
    Dim sUrn As String
    sUrn = &quot;urn:adsk.wipprod:dm.lineage:sTpS6wv0ROS_QQglZOXReQ&quot;
    
    Dim sUrl As String
    sUrl = sFdx + &quot;?filters=attribute.exchangeFileUrn==&quot; + sUrn
    
    Dim oDEDef As ImportedDataExchangeComponentDefinition
    Set oDEDef = oDoc.ComponentDefinition.ImportedComponents.CreateDataExchangeDefinition(sUrl)
    
    Dim oDEComp As ImportedDataExchangeComponent
    Set oDEComp = oDoc.ComponentDefinition.ImportedComponents.Add(oDEDef)
End Sub
</pre>
<p>&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Important info if your add-in uses pyc files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: important-info-if-your-add-in-uses-pyc-files
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2022/01/important-info-if-your-add-in-uses-pyc-files.html 
DATE: 01/31/2022 10:49:40 AM
-----
BODY:
<p><strong>Fusion 360</strong> is migrating to a newer engine of <strong>Python</strong> and it will make your <strong>add-in</strong> fail if it&#39;s relying on compiled <strong>Python</strong> files (*.<strong>pyc</strong>)</p>
<p>For more info see <a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-36B1FFB5-5291-4532-8F11-90E912769B34">https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-36B1FFB5-5291-4532-8F11-90E912769B34</a>&#0160;&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Migrate Inventor templates
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: migrate-inventor-templates
CATEGORY: Adam
CATEGORY: Drawings
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/11/migrate-inventor-templates.html 
DATE: 11/15/2021 09:27:19 PM
-----
BODY:
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdf00780f200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MigrateTemplate" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdf00780f200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdf00780f200c-500wi" title="MigrateTemplate" /></a></p>
<p>There is a difference between using a&#0160;<strong>document</strong>&#0160;as a&#0160;<strong>template</strong>&#0160;or just simply&#0160;<strong>opening</strong>&#0160;it. Especially in the case of&#0160;<strong>drawing templates</strong>.</p>
<p><strong>Inventor</strong>&#0160;can open&#0160;<strong>older documents&#0160;</strong>created in&#0160;<strong>previous versions&#0160;</strong>of the software and then save them. That&#39;s what&#0160;<strong>document migration&#0160;</strong>is: opening an old document and saving it in the latest version of the software. You&#0160;can find more information about it&#0160;<a href="https://help.autodesk.com/view/INVNTOR/2022/ENU/?guid=GUID-6DEACF61-4350-4874-B6E9-5720C48AED2A">here</a>.</p>
<p><strong>Inventor</strong>&#0160;documents have a property called&#0160;<a href="https://help.autodesk.com/view/INVNTOR/2022/ENU/?guid=GUID-F92A4B9B-33C4-4F16-AA92-33F663753ACF">NeedsMigrating</a>, but it only tells you if the document&#0160;<strong>needs to be saved before modifying</strong>&#0160;its content. It does not say if it can be&#0160;<strong>used as a template</strong>&#0160;or not.</p>
<p>Just to be on the safe side, the best thing is to migrate an older document before trying to use&#0160;it as a template - especially a&#0160;<strong>drawing template</strong>.&#0160;</p>
<p>You can do all this in advance e.g. using&#0160;<a href="https://help.autodesk.com/view/INVNTOR/2022/ENU/?guid=GUID-9D665936-6837-4698-9B83-4CCD16FF8383">Task Scheduler</a>, or&#0160;<strong>just-in-time&#0160;</strong>as well - here&#39;s how.</p>
<p>You can check programmatically the&#0160;<strong>Inventor</strong>&#0160;version the drawing was last saved in. If it has&#0160;<strong>not been migrated</strong>&#0160;yet then you can just&#0160;<strong>open</strong>,&#0160;<strong>save</strong>&#0160;and&#0160;<strong>close</strong>&#0160;it before using it as a&#0160;<strong>template</strong>.</p>
<p>Here is a&#0160;<strong>VBA</strong>&#0160;sample:</p>
<pre>Sub UseTemplate()
  Const templatePath = &quot;C:\Temp\Template2021\Standard.idw&quot;<br /><br />  Dim templateVersion As SoftwareVersion<br />  Set templateVersion = ThisApplication.FileManager.SoftwareVersionSaved(templatePath)<br /><br />  Dim inventorVersion As SoftwareVersion<br />  Set inventorVersion = ThisApplication.SoftwareVersion<br /><br />  If inventorVersion.Major &gt; templateVersion.Major Then<br />    &#39; Migrate drawing template before using it<br />    Dim t As DrawingDocument<br />    Set t = ThisApplication.Documents.Open(templatePath, False)<br /><br />    t.Save<br /><br />    t.Close<br />  End If<br /><br />  Dim doc As Document<br />  Set doc = ThisApplication.Documents.Add(kDrawingDocumentObject, templatePath, True)
End Sub</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3rd party libraries used by Inventor 2022
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3rd-party-libraries-used-by-inventor
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/07/3rd-party-libraries-used-by-inventor.html 
DATE: 07/14/2021 12:57:47 PM
-----
BODY:
<p>Here is a list of the various 3rd parties <strong>libraries</strong> and their <strong>versions</strong> that <strong>Inventor</strong> <strong>2022</strong> is using - i.e. they are used by the <strong>core product</strong>, and some of them are also used by certain <strong>add-ins</strong>.</p>
<p>If you are using any of them from your <strong>add-in</strong> then the best is to make sure you are using the same version to avoid version conflict:</p>
<table style="height: 232px; border-style: solid; border-color: #000000; float: left; width: 288px;">
<tbody>
<tr style="height: 10px;">
<td style="height: 10px; width: 167px;">
<p><strong>Component Name</strong></p>
</td>
<td style="height: 10px; width: 105px;">
<p><strong>Version</strong></p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>DevExpress</p>
</td>
<td style="height: 30px; width: 105px;">
<p>19.1.5</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>7z</p>
</td>
<td style="height: 30px; width: 105px;">
<p>18.06.0.0</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>CEFSharp</p>
</td>
<td style="height: 46px; width: 105px;">
<p>75.1.141</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>SQLite</p>
</td>
<td style="height: 30px; width: 105px;">
<p>3.30.1</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 46px; width: 167px;">
<p>Qt</p>
</td>
<td style="height: 46px; width: 105px;">
<p>5.150.10</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 30px; width: 167px;">
<p>QtMFCBridge</p>
</td>
<td style="height: 30px; width: 105px;">
<p>5150.280.1</p>
</td>
</tr>
<tr style="height: 30px;">
<td style="height: 10px; width: 167px;">
<p>TBB</p>
</td>
<td style="height: 10px; width: 105px;">
<p>6.1.20</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Nacho
EMAIL: nmjshaw@outlook.com
IP: 72.178.164.174
URL: 
DATE: 09/20/2021 06:22:05 PM
what Inventor components are using each 3rd party library? I use Dev Express for my addin and im on V21.1. I dont really want to take a sewried of backward steps to align with out of date libraries
-----
COMMENT:
AUTHOR: Adam Nagy
EMAIL: 
IP: 86.2.185.49
URL: https://profile.typepad.com/1236098880s16462
DATE: 09/20/2021 09:41:15 PM
I updated the article to clarify that those are used by the core product, so you cannot avoid them. FYI currently we plan to migrate to DevExpress v21.1.5 in the next Inventor release - if it's of any help.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Tooltip text gets cropped
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: tooltip-text-gets-cropped
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/06/tooltip-text-gets-cropped.html 
DATE: 06/11/2021 10:40:48 AM
-----
BODY:
<p>If you are using very long strings without <strong>tabs</strong> or <strong>spaces</strong> in them (e.g. a long file path), those will get cropped.<br />E.g. the file path &quot;C:\\top_folder\\sub_folder\\sub_sub_folder\\sub_sub_sub_folder\\sub_sub_sub_sub_folder\\somefile.txt&quot; will show up like this:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278802fabfb200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Tooltip_issue" class="asset  asset-image at-xid-6a00e553fcbfc688340278802fabfb200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278802fabfb200d-500wi" title="Tooltip_issue" /></a><br />Currently, that will also add an empty area on the right side of the tooltip, but that will be fixed.</p>
<p>There are two things you can do:<br />- add <strong>zero-width space</strong> characters (\u200b) wherever you are ok with the string being broken into a new line (e.g. after each \ character in the file path)<br />- add an <strong>ellipsis</strong> character (\u2026) at the point where the rest of the information is not important<br />(the tooltip width is 300 pixels which would allow about 40-50 characters in a line)&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278802faca5200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Tooltip_fixed" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340278802faca5200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278802faca5200d-800wi" title="Tooltip_fixed" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Export driven joint values
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: export-driven-joint-values
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/03/export-driven-joint-values.html 
DATE: 03/19/2021 09:46:32 AM
-----
BODY:
<p>In certain workflows, it can come handy to get the values of joints at multiple states of the model.<br />This way you can use those values downstream to drive (or at least help set up) a real-life model.</p>
<p>In the user interface, you can drag components to drive the movement of the model, or use e.g. <a href="https://help.autodesk.com/view/fusion360/ENU/courses/AP-SOLIDWORKS-JOINTS-MOTION-STUDIES">Motion Study</a></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278801cc2a6200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="2021-03-18_17-50-47 (3)" class="asset  asset-image at-xid-6a00e553fcbfc688340278801cc2a6200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278801cc2a6200d-500wi" title="2021-03-18_17-50-47 (3)" /></a></p>
<p>We can do the same using the <strong>API</strong> as well. As we keep driving the model, we can check how the change affects the various <strong>joints</strong> and record their values.<br />Then we can save the values in a <a href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> file which then could be opened in <a href="https://en.wikipedia.org/wiki/Microsoft_Excel">Excel</a> or a similar spreadsheet editor.</p>
<p>The code is made for this specific model but could easily be modified for others. It expects a <strong>list of components</strong> and a <strong>list of joints</strong> inside them that you want to monitor. In the case of both lists, you can specify the <strong>name</strong> that should be used in the <strong>CSV</strong> file.</p>
<p>After specifying where you want the <strong>CSV</strong> file to be saved, you can also provide the <strong>distance</strong> the main joint should be moved.&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdec5009e200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Params" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdec5009e200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdec5009e200c-500wi" title="Params" /></a></p>
<p>The source code is here: <br /><a href="https://github.com/adamenagy/JointValueExporter/blob/main/JointValueExporter.py">https://github.com/adamenagy/JointValueExporter/blob/main/JointValueExporter.py</a>&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Log debug messages in Fusion 360
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: log-debug-messages-in-fusion-360
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/03/log-debug-messages-in-fusion-360.html 
DATE: 03/18/2021 03:07:55 PM
-----
BODY:
<p>The usual way to debug your <a href="https://www.python.org/">Python</a> <strong>add-in</strong> is to start it from <a href="https://code.visualstudio.com/">Visual Studio Code</a>, and use <a href="https://docs.python.org/3/library/functions.html#print">print()</a> to write messages to the <a href="https://code.visualstudio.com/Docs/editor/debugging">Debug Console</a>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e99781dc200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DebugPrint" class="asset  asset-image at-xid-6a00e553fcbfc688340263e99781dc200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e99781dc200b-500wi" title="DebugPrint" /></a></p>
<p>However, sometimes you might just want some insight into what&#39;s going on inside your <strong>add-in</strong> without starting a debugging session.</p>
<p>One obvious way is to write information into a <strong>log file</strong>. Depending on your needs that might be the thing to do.</p>
<p>That will not provide <strong>real-time</strong> information though: you have to open the file in order to see what was written into it.</p>
<p>Another option is to write to the &quot;<strong>Text Commands</strong>&quot; palette of <strong>Fusion 360</strong>. If you don&#39;t mind a bit of delay for the messages to appear then just call <strong>writeText()</strong> function of the <strong>palette</strong>, otherwise <strong>also call</strong> <a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-743C88FB-CA3F-44B0-B0B9-FCC378D0D782">adsk.doEvents()</a></p>
<p>You could create a couple of simple classes to implement what&#39;s needed:</p>
<pre>class UiLogger:
    def __init__(self, forceUpdate):  
        app = adsk.core.Application.get()
        ui  = app.userInterface
        palettes = ui.palettes
        self.textPalette = palettes.itemById(&quot;TextCommands&quot;)
        self.forceUpdate = forceUpdate
        self.textPalette.isVisible = True 
    
    def print(self, text):       
        self.textPalette.writeText(text)
        if (self.forceUpdate):
            adsk.doEvents() 

class FileLogger:
    def __init__(self, filePath): 
        try:
            open(filePath, &#39;a&#39;).close()
        
            self.filePath = filePath
        except:
            raise Exception(&quot;Could not open/create file = &quot; + filePath)

    def print(self, text):
        with open(self.filePath, &#39;a&#39;) as txtFile:
            txtFile.writelines(text + &#39;\r\n&#39;)</pre>
<p>Then you can create an instance of either of them and start logging messages. E.g. using the <strong>UiLogger</strong>:</p>
<pre>logger = UiLogger(True)
# ...
logger.print(&quot;Some message&quot;)
</pre>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278801cba78200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="TextCommands" class="asset  asset-image at-xid-6a00e553fcbfc688340278801cba78200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340278801cba78200d-500wi" title="TextCommands" /></a></p>
<p>Or use the <strong>FileLogger</strong></p>
<pre>logger = FileLogger(&quot;/Users/nagyad/Documents/log.txt&quot;)
# ...
logger.print(&quot;Some message&quot;)</pre>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdec4d1cc200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="LogFile" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdec4d1cc200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdec4d1cc200c-500wi" title="LogFile" /></a></p>
<p>That <strong>palette</strong> is not only for writing messages but can also be used to run <strong>Python</strong> scripts - see <a href="https://modthemachine.typepad.com/my_weblog/2020/01/run-commands-from-the-text-commands-panel.html">Run commands from the &quot;Text Commands&quot; panel</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Join us for our DevDays Online webinars
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: join-us-for-our-devdays-online-webinars
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/02/join-us-for-our-devdays-online-webinars.html 
DATE: 02/12/2021 09:35:56 AM
-----
BODY:
<p>Our yearly <strong>webinars</strong> about the new product <strong>API</strong> features (both <strong>cloud</strong> and <strong>desktop</strong>) are coming up at the beginning of <strong>March</strong>.<br /><br />You can find all the details here if you are interested in joining us: <br /><a href="https://adndevblog.typepad.com/autocad/2021/01/join-us-for-our-devdays-online-webinars.html">https://adndevblog.typepad.com/autocad/2021/01/join-us-for-our-devdays-online-webinars.html</a>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: "Member not found" error in C# add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: member-not-found-error-in-c-add-in
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2021/02/member-not-found-error-in-c-add-in.html 
DATE: 02/10/2021 01:01:31 PM
-----
BODY:
<p>As mentioned in other blog posts (e.g. <a href="https://modthemachine.typepad.com/my_weblog/2012/07/set-embed-interop-types-to-false-to-avoid-problems-with-events.html">here</a> and <a href="https://forge.autodesk.com/blog/resolving-referenced-inventor-files">here</a>) as well, using <strong>Embed Interop Types = True</strong> with the <strong>Inventor</strong> interop assembly does not work well.&#0160;</p>
<p>Apart from some events not firing, you might not find all the properties either. E.g. in the case of a <strong>Parameter</strong> object, when doing this:&#0160;</p>
<pre>var unitType = param.get_Units();</pre>
<p>I get this error:</p>
<pre>{&quot;Member not found. (Exception from HRESULT: 0x80020003 (DISP_E_MEMBERNOTFOUND))&quot;}</pre>
<p>So just set <strong>Embed Interop Types </strong>to<strong> False:</strong></p>
<p><strong> <a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e98f07b4200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="EmbedInteoropTypes" class="asset  asset-image at-xid-6a00e553fcbfc688340263e98f07b4200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e98f07b4200b-320wi" title="EmbedInteoropTypes" /></a><br /></strong></p>
<p>Just for completeness&#39; sake (though the above solution should solve the problem), there could be another way as well to avoid this error. <br />You could declare a <strong>dynamic</strong> variable for the parameter (in order to use late-binding) and access the property through that:&#0160;&#0160;</p>
<pre>dynamic p = param;
var unitType = p.Units;</pre>
<p>- Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Export profile sketch points to CSV 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: export-profile-sketch-points-to-csv
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/12/export-profile-sketch-points-to-csv.html 
DATE: 12/15/2020 12:58:36 PM
-----
BODY:
<p>There is a <strong>Python</strong> script part of the <strong>Fusion 360</strong> installation that can import points from a <strong>CSV</strong> file into a <strong>spline</strong>:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdeade257200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ImportSpline" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdeade257200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdeade257200c-320wi" title="ImportSpline" /></a><br />We could use the source code of that as a starting point to implement the reverse: export the points of a <strong>spline</strong>. <br /><br />In this case, however, I&#39;m changing it to export the points of a <strong>profile </strong>instead: one consisting of many short sketch lines forming a closed loop.<br /><img alt="Profile" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdeade303200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdeade303200c-320wi" title="Profile" /><br />Because it&#39;s a closed loop, therefore it&#39;s enough to just export the coordinates of the <strong>start sketch point</strong> of each line as we iterate through the sketch lines.&#0160;</p>
<pre>import adsk.core, adsk.fusion, traceback
import io

def run(context):
    ui = None
    try:
        app = adsk.core.Application.get()
        ui  = app.userInterface
        # Get all components in the active design.
        product = app.activeProduct
        design = adsk.fusion.Design.cast(product)
        title = &#39;Export Spline csv&#39;
        if not design:
            ui.messageBox(&#39;No active Fusion design&#39;, title)
            return

        if app.userInterface.activeSelections.count != 1:
            ui.messageBox(&#39;Select profile before running command&#39;, title)
            return

        profile = app.userInterface.activeSelections.item(0).entity
        if not type(profile) is adsk.fusion.Profile:
            ui.messageBox(&#39;Selected object needs to be a profile&#39;, title)
            return

        dlg = ui.createFileDialog()
        dlg.title = &#39;Save CSV File&#39;
        dlg.filter = &#39;Comma Separated Values (*.csv)&#39;
        if dlg.showSave() != adsk.core.DialogResults.DialogOK :
            return
        
        filename = dlg.filename

        with io.open(filename, &#39;w&#39;, encoding=&#39;utf-8-sig&#39;) as f:
            profile = adsk.fusion.Profile.cast(profile)
            loop = profile.profileLoops.item(0)
            curves = loop.profileCurves
            for curve in curves:
                curve = adsk.fusion.ProfileCurve.cast(curve)
                entity = curve.sketchEntity
                point = entity.startSketchPoint
                point = adsk.fusion.SketchPoint.cast(point)
                geometry = point.geometry
                f.write(str(geometry.x) + &quot;,&quot; + str(geometry.y) + &quot;\n&quot;)

    except:
        if ui:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))</pre>
<p>In order to use the above code, you can simply create a new <strong>Python Script</strong> in the &quot;<strong>Scripts and Add-Ins</strong>&quot; dialog and replace the code in the generated <strong>Python</strong> file with the one shown above - see&#0160;<a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-9701BBA7-EC0E-4016-A9C8-964AA4838954">Creating a Script or Add-In</a> &#0160;</p>
<p>Here is the result produced by the script:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be42ceb4b200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="TestCsv" class="asset  asset-image at-xid-6a00e553fcbfc68834026be42ceb4b200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be42ceb4b200d-500wi" title="TestCsv" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Level Of Details in next Inventor release
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: level-of-details-in-next-inventor-release
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/11/level-of-details-in-next-inventor-release.html 
DATE: 11/30/2020 07:00:29 PM
-----
BODY:
<p>As <a href="https://blogs.autodesk.com/inventor/author/garingardiner/">Garin</a> mentioned in <a href="https://blogs.autodesk.com/inventor/2020/11/10/inventor-road-map/">this post</a>, one of the new features the team has been working on is <strong>Model States</strong>.</p>
<p>This might have an effect on some of the <strong>Level Of Details</strong> related functions, events, and properties in the <strong>API</strong>.</p>
<p>If you are using any of those, the best thing to do is join the <a href="https://feedback.autodesk.com/welcome/">beta program</a> where you can find more details about this functionality and can also use <strong>pre-release versions</strong> (alphas and betas) of <strong>Inventor </strong>to test your <strong>add-in</strong>.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdea97031200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="LOD" class="asset  asset-image at-xid-6a00e553fcbfc68834026bdea97031200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bdea97031200c-320wi" title="LOD" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Switch to latest VS Code Python extension
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: switch-to-latest-vs-code-python-extension
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/10/switch-to-latest-vs-code-python-extension.html 
DATE: 10/26/2020 01:00:00 PM
-----
BODY:
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bde9e2f5a200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="PythonExtensionLatest" class="asset  asset-image at-xid-6a00e553fcbfc68834026bde9e2f5a200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026bde9e2f5a200c-500wi" title="PythonExtensionLatest" /></a></p>
<p>In the past, you had to <a href="https://modthemachine.typepad.com/my_weblog/2019/10/problem-debugging-python-code.html">stick to a given version</a> of the <strong>Python </strong>extension in <strong>Visual Studio Code</strong> in order to edit and/or debug <strong>Fusion 360</strong> add-ins with it.</p>
<p>Now I&#39;ve just run into the opposite problem in case of the latest update of <strong>Fusion 360</strong>: when using that version of the extension (i.e. version <strong>2019.9.34911</strong>) the &quot;<strong>Debug</strong>&quot; and &quot;<strong>Edit</strong>&quot; buttons inside the &quot;<strong>Scripts and Add-Ins</strong>&quot; dialog of <strong>Fusion 360</strong> stopped working.</p>
<p>The engineering team confirmed that now developers should be using the <strong>latest version</strong> of the <strong>Python</strong> extension in <strong>VS Code</strong>.<br />And indeed, that does work for me too ðŸŽ‰</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Stricter call checks in Fusion 360 API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: stricter-call-checks-in-fusion-360-api
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/10/stricter-call-checks-in-fusion-360-api.html 
DATE: 10/23/2020 05:34:34 PM
-----
BODY:
<p>Last time it was the <a href="https://modthemachine.typepad.com/my_weblog/2019/10/issues-with-migrating-to-python-373.html">Python compiler that got stricter</a>, in the latest update it&#39;s <strong>Fusion 360</strong> that got stricter on <strong>API</strong> calls.</p>
<p>Previously, you could get away with trying to <strong>set</strong> a <strong>read-only</strong> property - it had no effect but did not cause an error either.<br /><br />This change is good because now you&#39;ll get an error and will be notified as you&#39;re developing your <strong>add-in</strong> when you&#39;re trying to do something that does not make sense.</p>
<p>The only problem is if you happen to have a published <strong>add-in</strong> that includes such a call ðŸ™„</p>
<p>If your <strong>add-in</strong> stopped working (like mine ðŸ¤« ) in the latest <strong>Fusion 360</strong> update then this might be it.&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 JavaScript API support ending this December
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-javascript-api-support-ending-this-december
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/09/fusion-360-javascript-api-support-ending-this-december.html 
DATE: 09/26/2020 05:56:54 PM
-----
BODY:
<p>We stopped fully supporting the <strong>JavaScript</strong> <strong>API</strong> a few years ago, but your existing <strong>add-ins</strong> using it kept running. <br />Not anymore. In <strong>December</strong> they will stop running, and you need to migrate your <strong>add-ins</strong> to another programming language: either <strong>C++</strong> or <strong>Python</strong>.</p>
<p>See post from product management: <a href="https://forums.autodesk.com/t5/fusion-360-api-and-scripts/notice-javascript-api-is-being-fully-retired/td-p/9748484">Notice: Javascript API is being fully retired</a></p>
<p><strong>Edit</strong>: looks like now there is also a pop-up dialog warning you if you have a <strong>JavaScript</strong> add-in installed:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e97eb86e200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="JavaScriptAddIn" class="asset  asset-image at-xid-6a00e553fcbfc688340263e97eb86e200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e97eb86e200b-320wi" title="JavaScriptAddIn" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Generate flat pattern for 3d folded sheet metal files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: generate-flat-pattern-for-3d-sheet-metal-files
CATEGORY: Adam
CATEGORY: Inventor
CATEGORY: Sheet Metal

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/09/generate-flat-pattern-for-3d-sheet-metal-files.html 
DATE: 09/22/2020 08:04:31 PM
-----
BODY:
<p>I vaguely remember now seeing this before, but could not recall it when someone asked about it the other day, that <strong>Inventor</strong> can generate <strong>flat pattern</strong> for any <strong>folded sheet metal</strong> model, without having to first create all the related <strong>sheet metal features</strong> (bend, flange, etc) by hand.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be413d162200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ConvertToSheetMetalpng" border="0" class="asset  asset-image at-xid-6a00e553fcbfc68834026be413d162200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be413d162200d-800wi" title="ConvertToSheetMetalpng" /></a></p>
<p>In this case I started with opening a <strong>STEP</strong> file of the <strong>3D folded sheet metal</strong>. When I select &quot;<strong>Convert To Sheet Metal</strong>&quot; then I need to select the <strong>base face</strong> for the sheet metal, and then the <strong>thickness</strong> will be automatically populated with the correct value.</p>
<p>There is no dedicated function in the <strong>Inventor API</strong> for that very last part about finding out the thickness. <br />However, we can use things like <strong>FindUsingRay()</strong> to find the face opposite the one we want to use as the base, and then check the distance between them</p>
<p>There are two ways to open a <strong>non-Inventor</strong> file: simply use the <strong>Documents.Open()</strong> function, in which case the file will be <strong>converted</strong>, or through <strong>ComponentDefinition.ImportedComponents</strong>, in which case you can also decide to <strong>reference</strong> the file - see <a href="https://modthemachine.typepad.com/my_weblog/2019/04/import-anycad-documents-associatively.html">Import AnyCAD documents associatively</a></p>
<p>When doing this whole thing through the <strong>API</strong>, then you have to find a way to figure out which <strong>face</strong> should be used as <strong>base</strong>. One option could be looking for the largest planar face. <br />Once you have that you need to find the face opposite that and check the distance between them. That should provide the thickness of the sheet metal.</p>
<p>Here is a <strong>VBA</strong> sample showing this:</p>
<pre>Function GetThickness(sb As SurfaceBody) As Double
  &#39; Find biggest face
  Dim f As Face
  Dim bf As Face
  Dim area As Double
  For Each f In sb.Faces
    &#39; Only care about planar faces
    If TypeOf f.Geometry Is Plane And f.Evaluator.area &gt; area Then
      Set bf = f
      area = f.Evaluator.area
    End If
  Next
  
  &#39; Find the opposite face
  Dim p As Plane
  Set p = bf.Geometry
  
  Dim pt1 As Point
  Set pt1 = bf.PointOnFace
  
  Dim tr As TransientGeometry
  Set tr = ThisApplication.TransientGeometry
  
  Dim objs As ObjectsEnumerator
  Dim pts As ObjectsEnumerator
  Dim n As UnitVector
  &#39; We have to search in the opposite direction
  &#39; of the face&#39;s normal vector
  If bf.IsParamReversed Then <br />    Set n = p.Normal <br />  Else <br />    Set n = tr.CreateUnitVector( _ <br />      -p.Normal.x, -p.Normal.y, -p.Normal.z) <br />  End If
  &#39; objs(2) should be the opposite face
  &#39; but we do not need it, the intersection point
  &#39; is enough, i.e. pts(2)
  Call sb.FindUsingRay(pt1, n, 0, objs, pts)
  
  &#39; The first point found will be on the same face
  &#39; The second one will be on the face opposite
  Dim pt2 As Point
  Set pt2 = pts(2)
  
  GetThickness = pt1.DistanceTo(pt2)
End Function

Sub ConvertToSheetMetal()
  Dim path As String: path = &quot;C:\Temp\SheetMetal_0.05in.stp&quot;
  
  Dim doc As PartDocument
  Set doc = ThisApplication.Documents.Open(path)
  
  &#39; Turn it into a sheet metal part
  doc.SubType = &quot;{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}&quot;
  
  Dim cd As SheetMetalComponentDefinition
  Set cd = doc.ComponentDefinition
 
  cd.UseSheetMetalStyleThickness = False
  cd.Thickness.Value = GetThickness(cd.SurfaceBodies(1))
  
  Call cd.Unfold
End Sub</pre>
<p>And the result:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be413d2ad200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="SheetMetalResult" class="asset  asset-image at-xid-6a00e553fcbfc68834026be413d2ad200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be413d2ad200d-500wi" title="SheetMetalResult" /></a></p>
<p>If the part is not really a <strong>folded</strong> sheet metal, then though the <strong>Unfold</strong> &quot;succeeds&quot;, the body of the &quot;<strong>Folded Model</strong>&quot; and the &quot;<strong>Flat Pattern</strong>&quot; will be the same.&#0160;&#0160;<br />You can test this by comparing the bodies:</p>
<pre>Sub TestFlatPattern()
  Dim doc As PartDocument
  Set doc = ThisApplication.ActiveDocument
  
  Dim cd As SheetMetalComponentDefinition
  Set cd = doc.ComponentDefinition
  
  Dim tr As TransientBRep
  Set tr = ThisApplication.TransientBRep
  
  Dim objs As ObjectCollection
  Set objs = ThisApplication.TransientObjects.CreateObjectCollection
  Call objs.Add(cd.SurfaceBodies(1))
  Call objs.Add(cd.FlatPattern.SurfaceBodies(1))
  Set objs = tr.GetIdenticalBodies(objs)
  
  If objs.Count &gt; 0 Then
    MsgBox (&quot;The flat pattern body is the same as the original body&quot;)
  End If
End Sub
</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Olle
EMAIL: 
IP: 101.165.17.170
URL: https://profile.typepad.com/d174483784706433037
DATE: 09/23/2020 12:54:30 AM
Awesome Adam. Thanks
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Get Named Face of iPartFactory
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-named-face-of-ipartfactory
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/09/get-named-face-of-ipartfactory.html 
DATE: 09/15/2020 02:30:05 PM
-----
BODY:
<p>One enhancement in <strong>Inventor 2019</strong> was the ability to <strong>Assign Name to objects</strong> - see <a href="https://knowledge.autodesk.com/support/inventor/learn-explore/caas/CloudHelp/cloudhelp/2019/ENU/Inventor-WhatsNew/files/GUID-80AD0392-0B8C-4A27-A9B3-7466D53999BF-htm.html">iLogic Enhancements</a></p>
<p>I wrote about how you could automate that in <a href="https://modthemachine.typepad.com/my_weblog/2019/03/automate-creation-of-named-geometry.html">Automate creation of Named Geometry</a></p>
<p>This feature is something that you could also use to mark objects in an <strong>iPart</strong> <strong>factory</strong> and use that later on to find them when its <strong>member</strong> is used in an <strong>assembly</strong>.</p>
<p>Here is an article on the difficulties of finding derived objects in <strong>iPart members</strong>: <a href="https://adndevblog.typepad.com/manufacturing/2014/11/get-edge-in-derived-part-that-drives-work-point.html">Get edge in derived part that drives work point</a>&#0160;</p>
<p>Let&#39;s say we have these files:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be411ab03200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="NamedFaceAll" border="0" class="asset  asset-image at-xid-6a00e553fcbfc68834026be411ab03200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834026be411ab03200d-800wi" title="NamedFaceAll" /></a></p>
<p>The <strong>Named Face</strong> in the <strong>iPart Factory</strong> will not show up in the <strong>iPart Member</strong>, so we&#39;ll have to figure out the connection ourselves using the <strong>ReferencedEntity</strong> property of the <strong>Face</strong> in the member document.&#0160; &#0160;</p>
<p>Once we have that we need to also get the <strong>Face</strong> <strong>Proxy</strong> representing the specific <strong>Face</strong> of the <strong>iPart Member</strong> inside the <strong>Assembly</strong>, so that we can do things with it, like selecting it in the <strong>UI</strong>.</p>
<p>We can achieve all that using the following code - this is <strong>VBA</strong>&#0160;</p>
<pre>Sub TestSelectNamedFace()
  Dim selSet As SelectSet
  Set selSet = ThisApplication.ActiveDocument.SelectSet

  Dim occ As ComponentOccurrence
  Set occ = selSet(1)
  
  Call selSet.Clear
  
  Call selSet.Select(GetNamedFace(occ, &quot;MyFace&quot;))
End Sub

Function GetNamedFace(occ As ComponentOccurrence, name As String) As Face
  Dim memberDoc As PartDocument
  Set memberDoc = occ.Definition.Document
  
  If Not memberDoc.ComponentDefinition.IsiPartMember Then
    Call MsgBox(&quot;Not an iPart member based occurrence&quot;)
  End If
  
  Dim factoryDoc As PartDocument
  Set factoryDoc = memberDoc.ComponentDefinition. _
    iPartMember.ReferencedDocumentDescriptor.ReferencedDocument
    
  Dim addin As ApplicationAddIn
  Set addin = ThisApplication.ApplicationAddIns. _
    ItemById(&quot;{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}&quot;)
  
  Dim iLogicAuto As Object
  Set iLogicAuto = addin.Automation
  
  Dim namedEntities As Object
  Set namedEntities = iLogicAuto.GetNamedEntities(factoryDoc)
  
  Dim f As Face
  Set f = namedEntities.FindEntity(name)
  
  If f Is Nothing Then
    Call MsgBox(&quot;Did not find named Face&quot;)
  End If
  
  Dim f2 As Face
  For Each f2 In memberDoc.ComponentDefinition.SurfaceBodies(1).Faces
    If f2.ReferencedEntity Is f Then
      &#39; Get the face into the context of the assembly
      Call occ.CreateGeometryProxy(f2, GetNamedFace)

      Exit Function
    End If
  Next
End Function</pre>
<p>First select the relevant occurrence in the assembly then run the code:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e965940b200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="NamedFace5" class="asset  asset-image at-xid-6a00e553fcbfc688340263e965940b200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e965940b200b-500wi" title="NamedFace5" /></a></p>
<p>You can find info on <strong>NamedEntities</strong> object and its functions like <strong>FindEntity()</strong> <a href="https://help.autodesk.com/cloudhelp/2019/CSY/Inventor-iLogic/iLogic_API/html/6852069e-b8c4-e9d3-77e2-1e3d84cbbdde.htm">here</a>&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Has higher version than referenced assembly 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: has-higher-version-than-referenced-assembly-
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/06/has-higher-version-than-referenced-assembly-.html 
DATE: 06/23/2020 12:04:06 PM
-----
BODY:
<p>Some assemblies might be relying on a specific higher version of <strong>Autodesk.Inventor.Interop.dll</strong> than the one your project is referencing. That&#39;s the problem I ran into with <strong>Autodesk.iLogic.Core.dll</strong> in case of the project talked about here: <a href="https://forge.autodesk.com/blog/get-ilogic-form-information-inventor-documents">Get iLogic Form information from Inventor documents</a></p>
<p>My project was working fine, but when I installed the latest <strong>Inventor 2020 update</strong> and tried to compile my project, I got this error:</p>
<pre>Assembly &#39;Autodesk.iLogic.Core&#39; with identity &#39;Autodesk.iLogic.Core, Version=24.30.37300.0, 
Culture=neutral, PublicKeyToken=null&#39; uses &#39;Autodesk.Inventor.Interop, Version=24.2.0.0, 
Culture=neutral, PublicKeyToken=d84147f8b4276564&#39; which has a higher version than referenced assembly 
&#39;Autodesk.Inventor.Interop&#39; with identity &#39;Autodesk.Inventor.Interop, Version=24.1.0.0, 
Culture=neutral, PublicKeyToken=d84147f8b4276564&#39;</pre>
<p>You can find the various versions of <strong>Autodesk.Inventor.Interop.dll</strong> in the &quot;<strong>C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Autodesk.Inventor.Interop</strong>&quot; folder including version <strong>24.2</strong> (after installing the relevant Inventor update):</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263ec23e4ab200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Autodesk.Inventor.Interop_2020.2" class="asset  asset-image at-xid-6a00e553fcbfc688340263ec23e4ab200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263ec23e4ab200c-500wi" title="Autodesk.Inventor.Interop_2020.2" /></a></p>
<p>Once I added that reference, the project compiled fine. ðŸ˜€&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: iMates based shelving unit
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: imates-based-shelving-unit
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/05/imates-based-shelving-unit.html 
DATE: 05/11/2020 10:34:30 AM
-----
BODY:
<p>I wrote about using <strong>iMates</strong> a few times already, but I thought it could still be worth sharing this model as well that I&#39;m using for a <a href="https://forge.autodesk.com/en/docs/design-automation/v3/overview/">Design Automation API for Inventor</a> sample talked about <a href="https://forge.autodesk.com/blog/faster-configuration-results">here</a>.</p>
<p>I have <strong>90cm</strong> and <strong>180cm</strong> <strong>corner posts</strong> and <strong>mid-section posts</strong>, and <strong>90cm</strong> and <strong>120cm</strong> wide <strong>shelves</strong> to select from:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8616d61200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ShelvingParts" class="asset  asset-image at-xid-6a00e553fcbfc688340263e8616d61200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8616d61200d-500wi" title="ShelvingParts" /></a></p>
<p>I have the following <strong>iMates</strong> in the models:&#0160;&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8616e5f200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IMates" class="asset  asset-image at-xid-6a00e553fcbfc688340263e8616e5f200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8616e5f200d-500wi" title="IMates" /></a></p>
<p>The corner posts have an <strong>a</strong> and <strong>b</strong> <strong>iMate</strong> at each level named (a1, b1, a2, b2, etc), the mid-section posts have an additional <strong>c</strong> and <strong>d</strong> <strong>iMates</strong> as well at each level (<strong>c1</strong>, <strong>d1</strong>, etc)&#0160;&#0160;<br />The selves have <strong>a</strong> to <strong>d</strong> <strong>iMates</strong> on the two ends (<strong>1a</strong> - <strong>1d</strong> and <strong>2a</strong> - <strong>2d</strong>)<br />Most of the time the correct letters match up between the <strong>post</strong> and the <strong>shelf</strong>, apart from two corner posts where <strong>a</strong> is matched with <strong>c</strong> and <strong>b</strong> is matched with <strong>d</strong>.</p>
<p>All <strong>iMates</strong> use the same <strong>Constraint</strong> type: <strong>Insert</strong> &amp; <strong>Opposed</strong></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8623cfa200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ShelfiMate" class="asset  asset-image at-xid-6a00e553fcbfc688340263e8623cfa200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263e8623cfa200d-320wi" title="ShelfiMate" /></a></p>
<p>The 3 parameters driving the model are: <strong>Column</strong>, <strong>Height</strong> and <strong>ShelfWidth</strong><br />When the rule is run it has three main parts:<br />1) start<br />- add corner post and ground it<br />- add the shelves<br />- add the other corner post</p>
<p>2) middle (repeated depending on how many columns we have)<br />- add the two mid-section posts<br />- add the shelves</p>
<p>3) end<br />- add the two corner posts</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263ec1835c7200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Shelving" class="asset  asset-image at-xid-6a00e553fcbfc688340263ec1835c7200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340263ec1835c7200c-500wi" title="Shelving" /></a></p>
<p>Instead of the main parameter changes kicking off the <strong>iLogic</strong> rule, I added an <strong>iTrigger</strong> parameter to do it.</p>
<pre>Sub Main()
  Trace.WriteLine(&quot;Main,  starting&quot;)
  trigger = iTrigger0	
	
  Dim height As String = Parameter(&quot;Height&quot;)  &#39;Height
  Dim width As String = Parameter(&quot;ShelfWidth&quot;) &#39; ShelfWidth 
  Dim columns As Integer = Parameter(&quot;Columns&quot;) &#39; Columns 
  Dim rows = 4 
  If height = &quot;90&quot; Then rows = 2
	  
  Trace.TraceInformation(&quot;Main, Values: height = {0}, width = {1}, columns = {2}, rows = {3}&quot;, height, width, columns, rows) 	  

  Dim asm As AssemblyDocument
  asm = ThisDoc.Document 
  
  Dim acd As AssemblyComponentDefinition
  acd = asm.ComponentDefinition
  
  Dim tg As TransientGeometry
  tg = ThisServer.TransientGeometry
  
  Dim path As String
  path = ThisDoc.Path + &quot;\&quot;
  Trace.WriteLine(&quot;Main, path = &quot; + path)

  &#39; START
  
  Dim post As ComponentOccurrence
  Dim bottomShelf As ComponentOccurrence
  
  &#39; add first corner (a,b)
  post = acd.Occurrences.Add(path + &quot;corner&quot; + height + &quot;.ipt&quot;, tg.CreateMatrix)
  post.Grounded = True
  
  &#39; add shelves (1a,1b)
  bottomShelf = AddShelves(post, path + &quot;shelf&quot; + width + &quot;.ipt&quot;, rows)
  
  &#39; add second corner (1c,1d) // enough to mate the first level
  Call AddPost(bottomShelf, path + &quot;corner&quot; + height + &quot;.ipt&quot;, &quot;1&quot;, &quot;c&quot;, &quot;a&quot;, &quot;d&quot;, &quot;b&quot;)
  
  &#39; MIDDLE
  Dim Column As Integer
  For Column = 2 To columns
    &#39; add first mid (2a,2b) // enough to mate the first level
    Call AddPost(bottomShelf, path + &quot;mid&quot; + height + &quot;.ipt&quot;, &quot;2&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;)
  
    &#39; add second mid (2c,2d) // enough to mate the first level
    post = AddPost(bottomShelf, path + &quot;mid&quot; + height + &quot;.ipt&quot;, &quot;2&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;d&quot;)
  
    &#39; add shelves ()
    bottomShelf = AddShelves(post, path + &quot;shelf&quot; + width + &quot;.ipt&quot;, rows)
    
    &#39; repeat
  Next
  
  &#39; END
  
  &#39; add third corner (2a,2b) // enough to mate the first level
  Call AddPost(bottomShelf, path + &quot;corner&quot; + height + &quot;.ipt&quot;, &quot;2&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;)
  
  &#39; add fourth corner (2c,2d) // enough to mate the first level
  Call AddPost(bottomShelf, path + &quot;corner&quot; + height + &quot;.ipt&quot;, &quot;2&quot;, &quot;c&quot;, &quot;a&quot;, &quot;d&quot;, &quot;b&quot;)
End Sub

Function GetimateDefinition(defs As iMateDefinitionsEnumerator, name As String) As iMateDefinition
  Dim def As iMateDefinition
  For Each def In defs
    If def.Name = name Then
      GetimateDefinition = def
      Exit For
    End If
  Next
End Function

Function AddShelves(post As ComponentOccurrence, fullPath As String, rows As Integer) As ComponentOccurrence
  Trace.WriteLine(&quot;AddShelves, fullPath = &quot; + fullPath)
  
  Dim tg As TransientGeometry
  tg = ThisServer.TransientGeometry
  
  Dim acd As AssemblyComponentDefinition
  acd = post.Parent
  
  Dim occs As ComponentOccurrences
  occs = acd.Occurrences
  
  Dim postMate As iMateDefinition
  Dim shelfMate As iMateDefinition
  Dim shelf As ComponentOccurrence
  Dim i As Integer
  For i = 1 To rows
    shelf = occs.Add(fullPath, tg.CreateMatrix)
    If AddShelves Is Nothing Then
      AddShelves = shelf
    End If
    
    postMate = GetimateDefinition(post.iMateDefinitions, &quot;a&quot; + CStr(i))
    shelfMate = GetimateDefinition(shelf.iMateDefinitions, &quot;1a&quot;)
    Call acd.iMateResults.AddByTwoiMates(postMate, shelfMate)
    
    postMate = GetimateDefinition(post.iMateDefinitions, &quot;b&quot; + CStr(i))
    shelfMate = GetimateDefinition(shelf.iMateDefinitions, &quot;1b&quot;)
    Call acd.iMateResults.AddByTwoiMates(postMate, shelfMate)
  Next
End Function

Function AddPost(shelf As ComponentOccurrence, fullPath As String, shelfSide As String, shelfMate1 As String, postMate1 As String, shelfMate2 As String, postMate2 As String) As ComponentOccurrence
  Trace.WriteLine(&quot;AddPost, fullPath = &quot; + fullPath)
  Dim tg As TransientGeometry
  tg = ThisServer.TransientGeometry
  
  Dim acd As AssemblyComponentDefinition
  acd = shelf.Parent
  
  Dim occs As ComponentOccurrences
  occs = acd.Occurrences
  
  Dim postMate As iMateDefinition
  Dim shelfMate As iMateDefinition
  AddPost = occs.Add(fullPath, tg.CreateMatrix)
  
  postMate = GetimateDefinition(AddPost.iMateDefinitions, postMate1 + &quot;1&quot;)
  shelfMate = GetimateDefinition(shelf.iMateDefinitions, shelfSide + shelfMate1)
  Call acd.iMateResults.AddByTwoiMates(postMate, shelfMate)
  
  postMate = GetimateDefinition(AddPost.iMateDefinitions, postMate2 + &quot;1&quot;)
  shelfMate = GetimateDefinition(shelf.iMateDefinitions, shelfSide + shelfMate2)
  Call acd.iMateResults.AddByTwoiMates(postMate, shelfMate)
End Function</pre>
<p>The model can be found here: <a href="https://github.com/adamenagy/QuickerAssemblerDA/tree/master/forgesample/wwwroot/files">https://github.com/adamenagy/QuickerAssemblerDA/tree/master/forgesample/wwwroot/files</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Reference Key Manager
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: reference-key-manager
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/04/reference-key-manager.html 
DATE: 04/19/2020 02:36:39 PM
-----
BODY:
<p><a href="https://modthemachine.typepad.com/my_weblog/about-the-author.html">Brian</a> has a very detailed <a href="https://modthemachine.typepad.com/my_weblog/2015/09/understanding-reference-keys-in-inventor.html">article on Reference Keys</a> (exposed through the <a href="http://help.autodesk.com/view/INVNTOR/2020/ENU/?guid=GUID-7ACB5EC8-04F5-4E03-9DB1-B295D8563270">ReferenceKeyManager</a> object) and as I was playing with them I thought it could be useful to have a tool for that.</p>
<p>So I created an <strong>add-in</strong> that lets you create <strong>Key Contexts</strong> and <strong>Reference Keys</strong> for the various objects, and <strong>binding</strong> them back to objects in the model.<br />When switching between documents, it also stores/loads data to/from <strong>json</strong> files named based on the <strong>Document</strong>&#39;s <strong>DisplayName</strong> plus &quot;<strong>.json</strong>&quot; as extension, .e.g. &quot;Boxes.iam.json&quot;&#0160;<br />They will be saved in the same folder as the <strong>add-in</strong>&#39;s <strong>dll</strong> and their content will look like this:</p>
<pre>{
  &quot;contexts&quot;: {
    &quot;Default&quot;: {
      &quot;index&quot;: 0,
      &quot;keys&quot;: [
        &quot;AgEBAAQAAAADAAAA&quot;
      ]
    },
    &quot;AgAAAAEAAAA=&quot;: {
      &quot;index&quot;: 1,
      &quot;keys&quot;: [
        &quot;AgEBAAQAAAACAAAA&quot;,
        &quot;AgEBAAQAAAADAAAA&quot;,
        &quot;AgEBAAQAAAAGAAAA&quot;
      ]
    }
  }
}</pre>
<p>Here is the add-in&#39;s form:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a521ae04200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ReferenceKeyManager" class="asset  asset-image at-xid-6a00e553fcbfc688340240a521ae04200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a521ae04200b-500wi" title="ReferenceKeyManager" /></a></p>
<p>As I was looking for <strong>icons</strong> I ran into the <strong>Visual Studio Image Library</strong> which can be downloaded from the <strong>Microsoft</strong> website:<br /><a href="https://www.microsoft.com/en-us/download/confirmation.aspx?id=35825">https://www.microsoft.com/en-us/download/confirmation.aspx?id=35825</a></p>
<p>Here is the source code of the project: <a href="https://github.com/adamenagy/ReferenceKeyManager">https://github.com/adamenagy/ReferenceKeyManager</a></p>
<p>I modified the <strong>Project</strong> settings so that the <strong>Output</strong> folder will always be the correct location for loading the <strong>add-in</strong> in <strong>Inventor</strong>:<br /><strong>%AppData%</strong>\Autodesk\ApplicationPlugins\ReferenceKeyManager</p>
<p>The way to do that is open the <a href="https://github.com/adamenagy/ReferenceKeyManager/blob/master/ReferenceKeyManager/ReferenceKeyManager.csproj"><strong>csproj</strong></a> file in a <strong>text editor</strong> and then you can use <strong>special variables</strong> like <strong>$(AppData)</strong> in the <strong>&lt;OutputPath&gt;</strong>:</p>
<pre>&lt;OutputPath&gt;$(AppData)\Autodesk\ApplicationPlugins\ReferenceKeyManager\&lt;/OutputPath&gt;</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: ReleaseComObject vs FinalReleaseComObject
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: releasecomobject-vs-finalreleasecomobject
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/04/releasecomobject-vs-finalreleasecomobject.html 
DATE: 04/18/2020 03:17:29 PM
-----
BODY:
<p>When freeing up <strong>COM</strong> objects in your <strong>Inventor</strong> <strong>add-in</strong>, don&#39;t use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.marshal.finalreleasecomobject">FinalReleaseComObject()</a> as it will badly affect other <strong>add-ins</strong>. It fully releases the object, so that other <strong>add-ins</strong> previously referencing it will not be able to access it either.</p>
<p>Here is an example.</p>
<p><span style="text-decoration: underline;"><strong>AddIn1</strong> does this when being unloaded:</span></p>
<pre>public void Deactivate()
{
  Marshal.FinalReleaseComObject(m_inventorApplication);
  m_inventorApplication = null;

  GC.Collect();
  GC.WaitForPendingFinalizers();
}</pre>
<p><span style="text-decoration: underline;"><strong>AddIn2</strong> has the following code executing when its button is clicked:</span></p>
<pre>private void M_buttonDefinition_OnExecute(NameValueMap Context)
{
  try
  {
    MessageBox.Show(m_inventorApplication.ActiveDocument.DisplayName, <br />      &quot;m_inventorApplication.ActiveDocument.DisplayName&quot;);
  }
  catch (Exception ex)
  {
    MessageBox.Show(ex.Message, &quot;Accessing m_inventorApplication&quot;);
  }
}
</pre>
<p>If I <strong>unload</strong> <strong>AddIn1</strong> and try to use <strong>AddIn2&#39;s command</strong>, I&#39;ll run into this:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4fcdac8200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="FinalReleaseComObject_Issue" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4fcdac8200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4fcdac8200d-800wi" title="FinalReleaseComObject_Issue" /></a></p>
<p>(error message says: &quot;COM object that has been separated from its underlying RCW cannot be used.&quot;)</p>
<p>Instead of using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.marshal.finalreleasecomobject">FinalReleaseComObject()</a>, you could use <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.marshal.releasecomobject">ReleaseComObject()</a> or even just setting the variable to <strong>null&#0160;</strong>might be enough.<br />You can still call <a href="https://docs.microsoft.com/en-us/dotnet/api/system.gc.collect">GC.Collect()</a> &amp; <a href="https://docs.microsoft.com/en-us/dotnet/api/system.gc.waitforpendingfinalizers">GC.WaitForPendingFinalizers()</a> to trigger the release of the objects.</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: iLogic variable not up-to-date
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: ilogic-variable-not-up-to-date
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/04/ilogic-variable-not-up-to-date.html 
DATE: 04/06/2020 12:02:31 PM
-----
BODY:
<p>When an <strong>iLogic rule</strong> runs and it has a <strong>variable</strong> with the name of a given <strong>Inventor parameter,</strong> then it will take the current value of that <strong>parameter</strong> and keep using it - its value will <strong>not get updated</strong> if the value of the <strong>parameter</strong> is changed in the meantime outside the <strong>rule</strong>.<br />The following article alludes to it, though does not say it explicitly: <a href="https://help.autodesk.com/view/INVNTOR/2020/ENU/?guid=GUID-EF53484C-D750-41F8-9AB1-032B73BB071F">About Rules and Forms in iLogic</a></p>
<p>Let&#39;s say we have a <strong>parameter</strong> named &quot;<strong>MyParam</strong>&quot; and two <strong>rules</strong>: &quot;<strong>MyRule</strong>&quot; and &quot;<strong>ChangeMyParam</strong>&quot;. Neither&#0160;<strong>rule </strong>is run automatically, i.e. they have the &quot;<strong>Don&#39;t run automatically</strong>&quot; option checked:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a51dba70200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DontRunAutomatically" class="asset  asset-image at-xid-6a00e553fcbfc688340240a51dba70200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a51dba70200b-500wi" title="DontRunAutomatically" /></a></p>
<p>Inside &quot;<strong>MyRule</strong>&quot; we use &quot;<strong>MyParam</strong>&quot; variable and show its value <strong>before</strong> and <strong>after</strong> calling &quot;<strong>ChangeMyParam</strong>&quot; rule.</p>
<p><span style="text-decoration: underline;"><strong>MyRule</strong>:</span></p>
<pre>MessageBox.Show(MyParam, &quot;MyRule before ChangeMyParam&quot;)

iLogicVb.RunRule(&quot;ChangeMyParam&quot;) 

MessageBox.Show(MyParam, &quot;MyRule after ChangeMyParam&quot;)

MessageBox.Show(Parameter(&quot;MyParam&quot;), &quot;MyRule after ChangeMyParam&quot;)</pre>
<p><span style="text-decoration: underline;"><strong>ChangeMyParam</strong>:</span></p>
<pre>MyParam = MyParam + 10</pre>
<p>This is what we get when we run &quot;<strong>MyRule</strong>&quot;:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a51dbb0c200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyRule" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a51dbb0c200b image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a51dbb0c200b-800wi" title="MyRule" /></a></p>
<p>As you can see, if you want to get the <strong>up-to-date value</strong> of an <strong>Inventor parameter</strong>, then you can use the<strong> Parameter() </strong>function.</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Drive all revolute joints
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: drive-all-revolute-joints
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/03/drive-all-revolute-joints.html 
DATE: 03/25/2020 09:39:04 PM
-----
BODY:
<p>I have two blog posts on driving revolute joints of a model:<br /><a href="https://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion.html">Drive robot arm in Fusion</a> and <a href="https://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion-update.html">Drive robot arm in Fusion - update</a></p>
<p>However, in those cases you have to select the joints you want to drive and use the keyboard.<br />If you prefer driving all the revolute joints&#39; rotation values through a slider, then here is a sample script you could use.<br />This also takes limits into consideration.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f5bb52200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Robot" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4f5bb52200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f5bb52200d-800wi" title="Robot" /></a></p>
<p><strong>Python</strong> script code:</p>
<pre>#Author-
#Description-

import adsk.core, adsk.fusion, adsk.cam, math, traceback

# Global variable used to maintain a reference to all event handlers.
handlers = []

# Other global variables
joints = None
commandName = &quot;DriveJoints&quot;
app = adsk.core.Application.get()
if app:
    ui = app.userInterface
            
# Event handler for the inputChanged event.
class MyInputChangedHandler(adsk.core.InputChangedEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        eventArgs = adsk.core.InputChangedEventArgs.cast(args)
        commandInput = eventArgs.input
        
# Event handler for the executePreview event.
class MyExecutePreviewHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        eventArgs = adsk.core.CommandEventArgs.cast(args)
        inputs = eventArgs.command.commandInputs

        for i in inputs:
            joint = joints.itemByName(i.name)
            rot = i.valueOne
            motion = joint.jointMotion
            motion.rotationValue = rot

        # Make it accept the changes whatever happens
        eventArgs.isValidResult = True
        

class MyCommandCreatedHandler(adsk.core.CommandCreatedEventHandler):    
    def __init__(self):
        super().__init__()        
    def notify(self, args):
        try:
            command = adsk.core.Command.cast(args.command)
            
            # Subscribe to the various command events
            onInputChanged = MyInputChangedHandler()
            command.inputChanged.add(onInputChanged)
            handlers.append(onInputChanged)

            onExecutePreview = MyExecutePreviewHandler()
            command.executePreview.add(onExecutePreview)
            handlers.append(onExecutePreview)
        
            onDestroy = MyCommandDestroyHandler()
            command.destroy.add(onDestroy)
            handlers.append(onDestroy)
            
            inputs = command.commandInputs

            for joint in joints:
                if joint.jointMotion.objectType == adsk.fusion.RevoluteJointMotion.classType():
                    minRot = 0
                    maxRot = math.pi * 2

                    limits = joint.jointMotion.rotationLimits
                    if (limits.isMinimumValueEnabled and limits.isMaximumValueEnabled):
                        minRot = limits.minimumValue
                        maxRot = limits.maximumValue

                    rev = inputs.addFloatSliderCommandInput(
                        commandName + joint.name,
                        joint.name,
                        &#39;rad&#39;,
                        minRot,
                        maxRot,
                        False)
                    rev.valueOne = joint.jointMotion.rotationValue

            command.isAutoExecute = True
                
        except:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))              
            
            
class MyCommandDestroyHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        try:
            commandDefinitions = ui.commandDefinitions
            # Check the command exists or not
            cmdDef = commandDefinitions.itemById(commandName)
            if cmdDef:
                cmdDef.deleteMe                
                
            # When the command is done, terminate the script
            # this will release all globals which will remove all event handlers
            adsk.terminate()
            
        except:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))        
            
            
def run(context):
    try:
        product = app.activeProduct
        design = adsk.fusion.Design.cast(product)
        if not design:
            ui.messageBox(&#39;It is not supported in current workspace, please change to MODEL workspace and try again.&#39;)
            return
        
        global joints
        joints = design.rootComponent.joints
         
        commandDefinitions = ui.commandDefinitions
        # Check the command exists or not
        cmdDef = commandDefinitions.itemById(commandName)
        if not cmdDef:
            cmdDef = commandDefinitions.addButtonDefinition(
                commandName, commandName, commandName, &#39;&#39;) 

        # Subscribe to events 
        onCommandCreated = MyCommandCreatedHandler()
        cmdDef.commandCreated.add(onCommandCreated)
        # Keep the handler referenced beyond this function
        handlers.append(onCommandCreated)
        
        # Run the command
        inputs = adsk.core.NamedValues.create()
        cmdDef.execute(inputs)

        # Prevent this module from being terminated when the script returns, 
        # because we are waiting for event handlers to fire
        adsk.autoTerminate(False)

    except:
        ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Hook up a chain using iMate's with MatchList
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: hook-up-a-chain-using-imates-with-matchlist
CATEGORY: Adam
CATEGORY: Assemblies
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/03/hook-up-a-chain-using-imates-with-matchlist.html 
DATE: 03/24/2020 11:33:13 AM
-----
BODY:
<p>I already had a blog post on <a href="https://adndevblog.typepad.com/manufacturing/2013/03/hook-up-a-chain-using-imates.html">Hook up a chain using iMate&#39;s</a>, but I was recently asked about more <a href="http://help.autodesk.com/view/INVNTOR/2020/ENU/?guid=GUID-00FD3BDE-8081-4A41-94A0-9B3E1F0B9004"><strong>iMate</strong></a> related <strong>API</strong> samples, so I thought I could also demonstrate the usage of <strong>iMate</strong> <a href="http://help.autodesk.com/view/INVNTOR/2020/ENU/?guid=GUID-D25FD747-FFCB-47A9-BEC7-B94DDA0C6AC1"><strong>MatchList</strong></a>.&#0160; <br />In theory, when using a <strong>MatchList</strong>, the <strong>iMates</strong> in the various components should be matched <strong>automatically</strong> when using the &quot;<strong data-stringify-type="bold">Automatically generate iMates on place</strong>&quot; option in the &quot;<strong>Place Component</strong>&quot; dialog, based on the names provided in the list. I did not realize that they <strong>over-match</strong> ðŸ˜¬<br />(i.e. if there are unresolved/unpaired <strong>iMates</strong> left then they will be matched even if there is no appropriate name in the <strong>MatchList</strong>)&#0160;<br /><a href="https://forums.autodesk.com/t5/inventor-ideas/match-list-for-imates/idi-p/4634729">Inventor Idea Station: Match list for imates</a></p>
<p>This is what I thought of doing as a test:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f5402b200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IMates1" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4f5402b200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f5402b200d-800wi" title="IMates1" /></a></p>
<p>We have 4 parts based on 2 types of models: <strong>a</strong> and<strong> b</strong>. There will be four connection points as shown in the above image. So we&#39;ll have an <strong>a</strong> type part with connections for points <strong>1 and 2</strong> named <strong>chain_a_1-2.ipt</strong>, one <strong>b</strong> type part with connections for point <strong>2 and 3</strong> named <strong>chain_b_2-3.ipt</strong>, etc<br /><strong>iMates</strong> will be named following this pattern: &quot;&lt;iMate type [<strong>Insert</strong> or <strong>Mate</strong>]&gt;&lt;connection point number [<strong>1</strong>..<strong>4</strong>]&gt;&lt;part type [<strong>a</strong> or <strong>b</strong>]&gt;&quot;, e.g. <strong>Insert2b</strong><br />Each <strong>iMate</strong> will have a <strong>MatchList</strong> containing the same <strong>iMate</strong> type for the same connection point but for the opposite part type:</p>
<p><strong>Insert1a</strong> will be matching <strong>Insert1b</strong>, and <strong>Insert1b</strong> will be matching <strong>nothing</strong>, etc&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a519ea76200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IMates4b" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a519ea76200b image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a519ea76200b-800wi" title="IMates4b" /></a></p>
<p>Unfortunately, as I mentioned above, simply relying on the &quot;<strong data-stringify-type="bold">Automatically generate iMates on place</strong>&quot; option in the &quot;<strong>Place Component</strong>&quot; dialog will not work as it will also match <strong>Insert1a</strong> to <strong>Insert3b</strong> and <strong>Mate1a</strong> to <strong>Mate3b</strong> when adding the second part to the assembly.</p>
<p>Instead, we can just place all the components in the assembly at the same time <strong>without</strong> automatic <strong>iMate</strong> resolution and then use the <strong>API</strong> to match the <strong>iMates</strong>.&#0160;&#0160;</p>
<p>Here is the <strong>VBA</strong> code I used - if you want to use <strong>.NET</strong> / <strong>iLogic</strong> instead have a look at <a href="https://adndevblog.typepad.com/manufacturing/2015/11/convert-vba-to-net-ilogic.html">Convert VBA to .NET / iLogic</a></p>
<pre>Function GetAlliMates(cd As AssemblyComponentDefinition) As NameValueMap
  Dim res As NameValueMap
  Set res = ThisApplication.TransientObjects.CreateNameValueMap
  
  Dim occ As ComponentOccurrence
  For Each occ In cd.Occurrences
    Dim imate As iMateDefinition
    For Each imate In occ.iMateDefinitions
      Call res.Add(imate.name, imate)
    Next
  Next
  
  Set GetAlliMates = res
End Function

Function MatchiMate( _
cd As AssemblyComponentDefinition, _
imate As iMateDefinition, _
imates As NameValueMap, _
ByVal name As String) As Boolean
  On Error Resume Next

  Dim imateMatch As iMateDefinition
  Set imateMatch = imates.item(name)
  If Not imateMatch Is Nothing Then
    Call cd.iMateResults.AddByTwoiMates(imate, imateMatch)
    Debug.Print &quot;Matching &quot; + imate.name + &quot; with &quot; + imateMatch.name + &quot; // &quot; + Err.Description
  End If
  MatchiMate = (Err.Number = 0)
  
  On Error GoTo 0
End Function

Sub HookTheChain()
  Dim doc As AssemblyDocument
  Set doc = ThisApplication.ActiveDocument
    
  Dim cd As AssemblyComponentDefinition
  Set cd = doc.ComponentDefinition
    
  Dim imates As NameValueMap
  Set imates = GetAlliMates(cd)
    
  Dim imate As iMateDefinition
  For Each imate In imates
    Dim item As Variant
    For Each item In imate.MatchList
      If MatchiMate(cd, imate, imates, item) Then
        Exit For
      End If
    Next
  Next
End Sub</pre>
<p>When the code finishes, the parts will be on top of each other - I described the same thing in the <a href="https://adndevblog.typepad.com/manufacturing/2013/03/hook-up-a-chain-using-imates.html">other article</a>.&#0160;<br />Best thing is to <strong>ground</strong> one of the components and then you can move around the others so they come apart and end up like shown in the picture on the top.</p>
<p>The above code only works well if inside the assembly each <strong>iMate</strong> has a unique name and should only be matched with a specific other <strong>iMate</strong>.</p>
<p>Here is the <strong>Inventor 2020</strong> model I used: <span class="asset  asset-generic at-xid-6a00e553fcbfc688340240a519eae0200b img-responsive"><a href="https://modthemachine.typepad.com/files/chain_with_matchlist-1.zip">Download Chain_with_MatchList</a></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Change Front camera view of model 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: change-front-camera-view-of-model-
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/02/change-front-camera-view-of-model-.html 
DATE: 02/19/2020 04:24:13 PM
-----
BODY:
<p>In the <strong>UI</strong> there is an option to modify the <strong>Front</strong>/<strong>Top</strong>/etc orientation of camera for the model. <br />It&#39;s available under the <strong>View Cube</strong>&#39;s menu item &quot;<strong>Set Current View as</strong>&quot; - see left side of picture</p>
<p>You can also run that command programmatically to achieve the same result.&#0160;<br />First set the camera to the direction that you want to set as the <strong>Front</strong> then run the command &quot;AppViewCubeViewFrontCmd&quot;</p>
<pre>Dim c As Camera
Set c = ThisApplication.ActiveView.Camera
c.ViewOrientationType = kRightViewOrientation
Call c.ApplyWithoutTransition
 
Dim cds As ControlDefinitions
Set cds = ThisApplication.CommandManager.ControlDefinitions
 
Dim cd As ControlDefinition
Set cd = cds.Item(&quot;AppViewCubeViewFrontCmd&quot;)
Call cd.Execute</pre>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a50daa10200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="SetCurrentView" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a50daa10200b image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a50daa10200b-800wi" title="SetCurrentView" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Modify Inventor Project (*.ipj file) directly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: modify-inventor-project-ipj-directly
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/02/modify-inventor-project-ipj-directly.html 
DATE: 02/06/2020 04:38:45 PM
-----
BODY:
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e49c5f200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ProjectManager" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4e49c5f200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e49c5f200d-500wi" title="ProjectManager" /></a></p>
<p>The <strong>Inventor API</strong> exposes pretty much all the <strong>Project</strong> related functionality through the <strong>DesignProjectManager</strong> and <strong>DesignProject</strong> objects:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4bb6fc4200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DesignProjectAPI" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4bb6fc4200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4bb6fc4200c-320wi" title="DesignProjectAPI" /></a></p>
<p>However, if a certain functionality is not exposed or is not working correctly, you may modify the project file (<strong>*.ipj</strong>) directly as well.</p>
<p>1) Make sure that a copy of the project file is saved somewhere so that you won&#39;t overwrite it by accident<br />2) Then modify the project through the <strong>UI</strong> - see above picture<br />3) Save the project file<br />4) Compare the content of the original project file and the new one to see what exactly got added or changed<br />5) Now you know how to modify the project programmatically so that it will have the necessary content<br /><br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e49ead200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ProjectFile" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4e49ead200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e49ead200d-800wi" title="ProjectFile" /></a><br /><br />This is the method that was followed in this example as well: <a href="https://adndevblog.typepad.com/manufacturing/2016/11/add-to-frequently-used-subfolders-collection.html">https://adndevblog.typepad.com/manufacturing/2016/11/add-to-frequently-used-subfolders-collection.html</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Run commands from the "Text Commands" panel
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: run-commands-from-the-text-commands-panel
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/01/run-commands-from-the-text-commands-panel.html 
DATE: 01/28/2020 01:15:02 PM
-----
BODY:
<p>As mentioned <a href="https://modthemachine.typepad.com/my_weblog/2016/01/run-fusion-commands.html">in this article</a> already, you can run registered <strong>Fusion 360</strong> commands programmatically as well.</p>
<p>You can also do it without creating a script or add-in, by using the &quot;<strong>Text Commands</strong>&quot; panel:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e0eace200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="TextCommandsPanel" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4e0eace200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e0eace200d-500wi" title="TextCommandsPanel" /></a></p>
<p>In this case we are using <strong>Python</strong>, so make sure that the appropriate radio button is selected:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a50588e1200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="RunCcommand" class="asset  asset-image at-xid-6a00e553fcbfc688340240a50588e1200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a50588e1200b-500wi" title="RunCcommand" /></a></p>
<pre>import adsk.core, adsk.fusion 
app = adsk.core.Application.get() 
ui = app.userInterface 
cmdDefs = ui.commandDefinitions 
cmdDef = cmdDefs.itemById(&quot;DragKnifeAddInMenuEntry&quot;) 
cmdDef.execute()</pre>
<p>As mentioned in the article I linked to above, you can <a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-d2b85a7e-fd08-11e4-9e07-3417ebd3d5be">get a list of all the commands that were added to the UI</a> and find out the <strong>ID</strong> of the <strong>CommandDefinition</strong> you want to run.<br />You can also get it by listing the <strong>name</strong> and <strong>id</strong> of all the registered <strong>CommandDefinitions</strong>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b7bf2d200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ListCommands" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4b7bf2d200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b7bf2d200c-500wi" title="ListCommands" /></a></p>
<pre>import adsk.core, adsk.fusion 
app = adsk.core.Application.get() 
ui = app.userInterface 
cmdDefs = ui.commandDefinitions 
result = &quot;&quot; 
for cmdDef in cmdDefs: 
  result += &quot;\n&quot; + cmdDef.name + &quot;, &quot; + cmdDef.id 
print(result) </pre>
<p>PS: after typing the line of &quot;<strong>result += ...</strong>&quot; you&#39;ll have to press enter twice to get out of the <strong>for loop</strong> section</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Join us for our DevDays Online webinars
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: join-us-for-our-devdays-online-webinars
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2020/01/join-us-for-our-devdays-online-webinars.html 
DATE: 01/22/2020 12:01:10 PM
-----
BODY:
<p>Join us for our special series of webinars where weâ€™ll be going over some of the topics covered last year&#39;s DevCon events in detail (see full list below). These webinars are a great opportunity for you to learn about Autodesk Forge and, of course, where Autodesk is taking the desktop platforms in the coming year.</p>
<p>Click on the links below to register today for the webinar(s) of your choice. All webinars start at 8am PST (4pm GMT, 5pm CET, 11am EST). If the session timing is inconvenient for you to attend (which is true for most of our partners in Asia), you can rest assured we will be recording all the sessions and will post them on the web for your later viewing. Registration is open to all except where noted below.</p>
<p><strong>Tuesday February 25 - DevDays Keynotes</strong><br />Jim Quanci, Senior Director for Software Partner Development, kicks off our DevDays online webinar series with the latest news for desktop developers (get ready for the 2021 releases this Spring), Forge roadmap that includes the Forge Design Automation CAD Engines on the cloud (AutoCAD, Revit, Inventor and 3ds Max) and an overview of the enhanced BIM 360 APIs for the Autodesk Construction Cloud.<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_J-iJ9Iy1TQ-TYgB3CdQoLg">https://autodesk.zoom.us/webinar/register/WN_J-iJ9Iy1TQ-TYgB3CdQoLg</a></p>
<p><strong>Wednesday February 26 - Forge API update</strong><br />Augusto Goncalves will discuss in detail the updated and new APIs added to the Forge platform during the last year.&#0160;<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_MlyzAqW8TF-oC7XPFcC7FA">https://autodesk.zoom.us/webinar/register/WN_MlyzAqW8TF-oC7XPFcC7FA</a></p>
<p><strong>Thursday February 27 - Revit, Civil 3D and InfraWorks API updates (for ADN members only)</strong><br />Join Mikako Harada and Augusto Goncalves to discover the product and API changes and enhancements coming in the next releases Revit, Civil 3D and InfraWorks.<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_jLl0gXjxTnK3PWHsGyzARg">https://autodesk.zoom.us/webinar/register/WN_jLl0gXjxTnK3PWHsGyzARg</a></p>
<p><strong>Tuesday March 3 - Inventor, Vault and Fusion API update (for ADN members only)</strong><br />We will review upcoming changes in the next release of Inventor as well as recent updates in Vault and Fusion 360 API.<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_XlRo7ADySLGofmc7M9cdkQ">https://autodesk.zoom.us/webinar/register/WN_XlRo7ADySLGofmc7M9cdkQ</a></p>
<p><strong>Wednesday March 4 - BIM 360 API update</strong><br />Learn about the new APIs for the BIM 360 family. Weâ€™ll talk about whatâ€™s in the pipeline for API enhancements.<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_TIxv3ZpPS1228DYy_-i7HA">https://autodesk.zoom.us/webinar/register/WN_TIxv3ZpPS1228DYy_-i7HA</a></p>
<p><strong>Thursday March 5 - The next release of AutoCAD APIs (for ADN members only)</strong><br />Discover API changes coming in the upcoming release of AutoCAD Rogue<br />Register -&#0160;<a href="https://autodesk.zoom.us/webinar/register/WN_h1Mmc-leRjKAFhqIjiv9Sw">https://autodesk.zoom.us/webinar/register/WN_h1Mmc-leRjKAFhqIjiv9Sw</a></p>
<p>After registering, you will receive a confirmation email containing information about joining the webinars.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Using Visual Studio to Debug iLogic Rules
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-visual-studio-to-debug-ilogic-rules
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/12/using-visual-studio-to-debug-ilogic-rules.html 
DATE: 12/06/2019 09:51:22 PM
-----
BODY:
<p>In <strong>Inventor 2019</strong>, we have incorporated an experimental mechanism that allows you to use <strong>Visual Studio</strong> to debug your <strong>iLogic</strong> rules.&#0160; It is not a seamless experience, but nevertheless is an effective technique.&#0160; We are looking for feedback as to whether the quirks in the experience are tolerable, versus the benefits of being able to use an industrial-strength debugger.</p>
<p>To debug your <strong>iLogic</strong> rules:</p>
<ul>
<li>Prerequisite 1:&#0160; Install <strong>Inventor 2019</strong> or a later version (does not work in <strong>2018</strong> or earlier releases)</li>
<li>Prerequisite 2:&#0160; Install <strong>Microsoft Visual Studio 2017</strong> or <strong>2019</strong> (<strong>Community</strong>, <strong>Professional</strong> or <strong>Enterprise edition</strong>.&#0160; Not &quot;<strong>Code</strong>&quot;).&#0160; The &quot;<strong>Community</strong>&quot; edition is a free download if you meet certain qualifications, available here:&#0160;<a class="external-link" href="https://www.visualstudio.com/downloads/" rel="nofollow noopener" target="_blank">https://www.visualstudio.com/downloads/</a>&#0160; Earlier versions of <strong>VS</strong> will probably work, too.&#0160; We have not tested every version of every edition, but we expect that any recent version will be OK.&#0160; When I tested the <strong>Community</strong> edition, I only installed the &quot;<strong>.NET Desktop</strong>&quot; subset.&#0160; For more information about <strong>Visual Studio</strong>, try these links:<br /><a class="external-link" href="https://www.visualstudio.com/vs/community/" rel="nofollow noopener" target="_blank">https://www.visualstudio.com/vs/community/</a> <a class="external-link" href="https://visualstudio.microsoft.com/license-terms/mlt031819/" rel="nofollow noopener" target="_blank">https://visualstudio.microsoft.com/license-terms/mlt031819/</a> <a class="external-link" href="https://www.visualstudio.com/vs/pricing/#tab-b8953f16f0b68f60f18" rel="nofollow noopener" target="_blank">https://www.visualstudio.com/vs/pricing/#tab-b8953f16f0b68f60f18</a></li>
<li>Setup:&#0160;&#0160;
<ul>
<li>Start <strong>Visual Studio</strong> (&quot;VS&quot;).&#0160;&#0160;</li>
<li>Create a new <strong>VS</strong> project using &quot;<strong>Visual Basic Class Library (standard .NET Framework)</strong>&quot;.&#0160; You don&#39;t have to do anything with this project, you just have to have one, so it&#39;s <strong>OK</strong> to accept all the defaults.</li>
<li>Turn on all <strong>CLR</strong> Exceptions, as shown here:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a6078d200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image2018-1-2_15-57-21" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4a6078d200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a6078d200c-500wi" title="Image2018-1-2_15-57-21" /></a><br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f3cd66200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image2018-1-2_15-58-34" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4f3cd66200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f3cd66200b-320wi" title="Image2018-1-2_15-58-34" /></a></li>
<li>Disable the option shown below:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f3cd73200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Vs-option" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4f3cd73200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4f3cd73200b-500wi" title="Vs-option" /></a></li>
<li>Enable the option shown below:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4cf2dee200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DebuggingLegacyEvaluators" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4cf2dee200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4cf2dee200d-500wi" title="DebuggingLegacyEvaluators" /></a></li>
</ul>
</li>
</ul>
<p>To debug your rules:</p>
<ul>
<li>Open an Inventor file with <strong>iLogic</strong> rules.</li>
<li>Start <strong>Visual Studio</strong> (&quot;VS&quot;)</li>
<li><s>Open the VS project you created (or create a new one)</s>&#0160; (not necessary)</li>
<li>Attach <strong>VS</strong> to the <strong>Inventor</strong> process.&#0160; This is easy in <strong>VS 2017</strong> or <strong>2019</strong>, a little trickier in earlier <strong>VS</strong> versions.&#0160; Put &quot;<strong>Inventor</strong>&quot; in the search box to find the process.&#0160; Use&#0160;the &quot;<strong>Attach to</strong>&quot; option set to&#0160;&quot;<strong>Managed (v4.6, v4.5, v4.0) code</strong>&quot; (automatic)<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a607b9200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image2018-1-2_16-3-12" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4a607b9200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a607b9200c-500wi" title="Image2018-1-2_16-3-12" /></a><br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a607c0200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image2018-1-2_16-4-31" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4a607c0200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a607c0200c-500wi" title="Image2018-1-2_16-4-31" /></a></li>
<li>Set breakpoints by one or more of these methods:
<ul>
<li>Use this function in your rule:&#0160;<strong>Break&#0160;</strong>&#0160;(as a single line of code in your rule).&#0160; This is persistent (across sessions, like any code in your rule)</li>
<li>Get an exception (error) in your rule-code.&#0160; <strong>VS</strong> will automatically stop and give you the chance to inspect the state.</li>
<li>Later, you can use additional <strong>VS</strong> breakpoints, by simply clicking on the line where you want to break, in the <strong>VB</strong> files in <strong>VS</strong>, once the files are loaded. These breakpoints are saved with the <strong>VS</strong> project, and can be used again in future sessions.&#0160;&#0160;</li>
</ul>
</li>
</ul>
<ul>
<li>Now go back to <strong>Inventor</strong> and run the rule.&#0160; If the rule execution hits a breakpoint or gets any exception, then the code will stop in <strong>VS</strong>, and you can use all the <strong>VS</strong> tools to examine the current state.&#0160;Note that Inventor itself is &quot;hung&quot; at this point; you cannot do anything else inside Inventor while you are at the breakpoint.&#0160; When you&#39;re ready to go back to Inventor, click &quot;<strong>Continue</strong>&quot; (or press F5), and use Inventor normally after that.<br /><br /></li>
<li>Tools you can use:
<ul>
<li>Examine values of local variables</li>
<li>If a variable is declared &quot;<strong>as Object</strong>&quot; (perhaps implicitly), use the &quot;<strong>Dynamic view</strong>&quot; to its properties&#0160;</li>
<li>Use &quot;<strong>Watch</strong>&quot; window to enter expressions, especially to see items of arrays/collections, e.g., myArray(6)</li>
<li>Call stack</li>
<li>Use &quot;<strong>debug.print</strong>&quot; in your rule to send text to the &quot;output&quot; window</li>
<li>In addition, in <strong>2019.1</strong>, you can also use the new <strong>iLogic</strong> &quot;<strong>Logger</strong>&quot; functions (does not require nor use VS).</li>
</ul>
</li>
</ul>
<ul>
<li>However, note that &quot;the code&quot; that you see in <strong>VS</strong> is not exactly your original code from your rule.&#0160; It has been &quot;processed&quot; to support some special <strong>iLogic</strong> features.&#0160; <strong>VS</strong> is actually using a temporary file that is &quot;pure&quot; <strong>Visual Basic</strong>. Fortunately, the differences are minor,&#0160;&#0160;including: &quot;wrapper&quot; code, conversion of unit-strings to expressions, extra &quot;m_parameter&quot; on parameter-names, etc.&#0160;&#0160;</li>
<li>When you have found the problem, you have to use the <strong>Rule Editor</strong> to change the code of the rule.&#0160; You cannot edit the temporary <strong>VB</strong> file directly in <strong>VS</strong> (think of it as read-only).</li>
<li>By default, all rule code temporary files are stored in the folder &quot;%Temp%\iLogic Rules&quot;</li>
</ul>
<p>Re-stating some of the known limitations:</p>
<ul>
<li>You have to install and run <strong>Visual Studio</strong> (VS).</li>
<li>You have to start <strong>VS</strong> and &quot;attach&quot; it to the running Inventor process.</li>
<li>Inventor is &quot;hung&quot; while in the breakpoint.</li>
<li>The &quot;code&quot; that is displayed has some minor deviations from the rule as-written.</li>
<li>You cannot edit your code in <strong>VS</strong>, you must go back to the <strong>Rule Editor</strong>.</li>
</ul>
<p>We welcome your feedback on this experimental feature.&#0160;&#0160;</p>
<p>Differences between the code in the rule and the code shown in <strong>VS</strong>:</p>
<ul>
<li>&quot;System code&quot;&#0160;â€“ extra bits and pieces that <strong>iLogic</strong> provides for you.&#0160; These lines are flagged with a comment, &quot;<strong>**iLogic system**</strong>&quot;, and you can ignore them.</li>
<li>&quot;m_parameter_&quot;&#0160;&#0160;â€“ references to parameters will have this prefix</li>
<li>Units ...</li>
<li>Highlighting</li>
</ul>
<p>Things to try to get used to it:</p>
<ul>
<li>Start with a simple rule that has both local variables (&quot;dim xxx =thisDoc.path&quot;) and references to parameters in the document.&#0160;&#0160;
<ul>
<li>Insert a &quot;break&quot; line in the rule.&#0160;&#0160;</li>
<li>Run the rule; it should automatically stop in the debugger (<strong>VS</strong>)</li>
<li>Use &quot;F10&quot; (Or click on &quot;step over&quot; icon) to step through.&#0160; You may have to use it once just to get it &quot;in&quot;.</li>
<li>Look at the values of the variables in the &quot;Locals&quot; or &quot;Auto&quot; pane.&#0160;&#0160;</li>
<li>Try to use Inventor while still in the debugger â€“ you can&#39;t.&#0160; Inventor is &quot;hung&quot; while it is stopped in the debugger.&#0160;</li>
<li>Note that the code you&#39;re seeing is not (really) editable.&#0160; You will have to use the <strong>Rule Editor</strong> to make changes.</li>
<li>Click &quot;<strong>continue</strong>&quot; (or press F5) to go back to Inventor.</li>
</ul>
</li>
<li>Change your rule:&#0160; Remove the &#39;break&#39; line, and add a deliberate error, e.g., refer to the -1&#39;th element of an array, etc.
<ul>
<li>Run the rule.&#0160; It should automatically stop in <strong>VS</strong>.</li>
<li>Look at the values</li>
<li>Enter some tests in a <strong>Watch window</strong>.</li>
<li>Click &quot;<strong>continue</strong>&quot; or &quot;F5&quot;</li>
</ul>
</li>
</ul>
<p>-Mike Deck</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Error getting Thumbnail using Apprentice
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: error-getting-thumbnail-using-apprentice
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/11/error-getting-thumbnail-using-apprentice.html 
DATE: 11/01/2019 12:28:12 PM
-----
BODY:
<p>I already have an article on problems with using <strong>Apprentice</strong> from a <strong>side thread</strong>, which also mentions that this <strong>side thread</strong> needs to be a <a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-3.0/ms182351(v=vs.80)?redirectedfrom=MSDN">single-threaded apartment</a>. However, the <strong>main thread</strong> of your application might be a <strong>non single-threaded apartment</strong> (i.e. multi-threaded apartment) too - something to watch out for. <br />Depending on the language you are using the default is different:<br /><a href="https://docs.microsoft.com/en-us/dotnet/api/system.stathreadattribute?view=netframework-4.8">https://docs.microsoft.com/en-us/dotnet/api/system.stathreadattribute?view=netframework-4.8</a></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e63414200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="STA" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4e63414200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e63414200b-320wi" title="STA" /></a></p>
<p>So, whatever thread you are creating and using your <a href="http://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-255C01D4-EF33-4E40-B425-FB588D7C4B7A"><strong>ApprenticeServerComponent</strong></a> from, it needs to be a <strong>single-threaded apartment</strong> type. You can simply add the <strong>[STAThread]</strong> attribute to your application&#39;s <strong>Main</strong> function:</p>
<pre>namespace MyApp
{
  static class Program
  {
    <strong><span style="color: #ff0000;">[STAThread]</span></strong>
    static void Main()
    {
      Application.EnableVisualStyles();
      Application.SetCompatibleTextRenderingDefault(false);
      Application.Run(new MyForm());
    }
  }
}</pre>
<p>As a background info, <strong>Windows Form</strong> components (like <strong>AxHost</strong>)&#0160;require the use of <strong>single-threaded apartment</strong>. As mentioned in the <a href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-3.0/ms182351(v=vs.80)?redirectedfrom=MSDN#rule-description">Rule Description</a>:<br />&quot;... if it is omitted, the Windows components might not work correctly.&#0160;&quot;</p>
<p><br />&#0160;&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Problem debugging Python code
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: problem-debugging-python-code
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/10/problem-debugging-python-code.html 
DATE: 10/30/2019 09:48:04 PM
-----
BODY:
<p>When using the latest two versions of the <strong>Python</strong> extension inside <strong>Visual Studio Code</strong>, then instead of <strong>VS Code</strong> showing up when you click &quot;<strong>Edit</strong>&quot; or &quot;<strong>Debug</strong>&quot; inside the&#0160; &quot;<strong>Script&#0160;and&#0160;Add-Ins</strong>&quot; dialog, another instance of <strong>Fusion 360</strong> will come up ðŸ˜¬</p>
<p>Fortunately, you can simply downgrade back to version <strong>2019.9.34911</strong> of the <strong>Python</strong> extension to solve the problem:<br />- go to the <strong>Extensions</strong> tab in <strong>VS Code</strong>&#0160;<br />- click on the <strong>Settings</strong> button âš™ of the <strong>Python</strong> extension<br />- select &quot;<strong>Install Another Version...</strong>&quot;<br />- select <strong>2019.9.34911</strong></p>
<p><strong> <a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e5a105200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="PythonExtension" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4e5a105200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4e5a105200b-500wi" title="PythonExtension" /></a><br /></strong></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Un-remove Fusion 360 add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: un-remove-fusion-360-add-in
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/10/un-remove-fusion-360-add-in.html 
DATE: 10/06/2019 03:04:37 PM
-----
BODY:
<p>Inside the &quot;<strong>Scripts and Add-Ins</strong>&quot; dialog you have the option to &quot;<strong>Remove</strong>&quot; a given <strong>add-in</strong> or <strong>script</strong>. This will <strong>not</strong> <strong>delete</strong> the <strong>add-in</strong>, but will simply <strong>mark</strong> it to be <strong>ignored</strong> in the future, and so it <strong>won&#39;t be</strong> <strong>listed</strong> or <strong>loaded</strong> anymore:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48cc93f200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="RemoveFusionAddIn" class="asset  asset-image at-xid-6a00e553fcbfc688340240a48cc93f200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48cc93f200c-500wi" title="RemoveFusionAddIn" /></a></p>
<p>But how can you bring it back if you changed your mind? ðŸ¤”</p>
<p>1) Close <strong>Fusion 360</strong> (if it&#39;s running)<br />2) <strong>Move</strong> the folder of the <strong>add-in</strong> to a temporary location - maybe place it in the <strong>trash</strong>?&#0160;<br />3) Start <strong>Fusion 360</strong> - it will realize that the <strong>add-in</strong> does not exist anymore, so it can delete the note about ignoring it<br />4) Close <strong>Fusion 360</strong><br />5) Move the <strong>add-in</strong>&#39;s folder back where it was before<br />6) Start <strong>Fusion 360</strong> - the <strong>add-in</strong> will show up in the list again ðŸ˜€</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Constrain Sketch Blocks
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: constrain-sketch-blocks
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/10/constrain-sketch-blocks.html 
DATE: 10/05/2019 02:15:58 PM
-----
BODY:
<p>You can group sketch geometry together by creating a <strong>SketchBlockDefinition</strong> out of them using the &quot;<strong>Create Block</strong>&quot; command:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4da90b0200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateBlock" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4da90b0200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4da90b0200b-500wi" title="CreateBlock" /></a></p>
<p>If you have <strong>SketchBlock</strong>&#39;s (instances of <strong>SketchBlockDefinition</strong>) in your <strong>Sketch</strong> then through the <strong>UI</strong> you can constrain them together without creating any additional geometry in the <strong>SketchBlock</strong>&#39;s definition (<strong>SketchBlockDefinition</strong>) - e.g. using the <strong>midpoint</strong> of one of the lines of the <strong>SketchBlock</strong>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b60adb200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="SketchBlockUI" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4b60adb200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b60adb200d-800wi" title="SketchBlockUI" /></a><br />If you try to do the same through the <strong>API</strong>, <strong>Inventor</strong> will crash! ðŸ˜±</p>
<p>You can work around that by creating the constrained <strong>SketchPoint</strong> <span style="text-decoration: underline;">inside</span> the <strong>SketchBlockDefinition</strong>, and use the <strong>representation</strong> of that <strong>point</strong> in the <strong>Sketch</strong> to add further constraints. Each object in the definition will be represented by a sketch object inside the sketch where you placed the <strong>SketchBlock</strong>. You can find out which object in the sketch is representing a given object from the <strong>SketchBlockDefinition</strong> by using the <strong>SketchBlock.GetObject()</strong> function.&#0160;<br />FYI: the first <strong>SketchPoint</strong> in the <strong>SketchBlockDefinition</strong> is always the <strong>insertion point</strong>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48cc442200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateBlock2b" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a48cc442200c image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48cc442200c-800wi" title="CreateBlock2b" /></a><br />If you wanted to constrain two <strong>instances</strong> of the same <strong>SketchBlockDefinition</strong> together by the midpoint of their <strong>3rd</strong> and <strong>1st line</strong>, then this is how you could do it:</p>
<pre>Sub ConstrainBlockLine()
Dim oPartDoc As PartDocument
Dim oSketchLine As SketchLine
Dim oMiddlePoint1 As SketchPoint
Dim oMiddlePoint2 As SketchPoint
Dim oTG As TransientGeometry
Dim oSketch As PlanarSketch
Dim oSketchBlock1 As SketchBlock
Dim oSketchBlock2 As SketchBlock
Dim oSketchBlockDef As SketchBlockDefinition

Set oPartDoc = ThisApplication.ActiveDocument
Set oTG = ThisApplication.TransientGeometry

Set oSketch = oPartDoc.ComponentDefinition.Sketches(1)
Set oSketchBlock1 = oSketch.SketchBlocks.Item(1)
Set oSketchBlock2 = oSketch.SketchBlocks.Item(2)
Set oSketchBlockDef = oSketchBlock1.Definition

&#39;edit Sketch
Call oSketch.Edit
&#39;edit SketchBlock
Call oSketchBlock1.Edit

Dim oMiddlePointNative1 As SketchPoint
Set oMiddlePointNative1 = oSketchBlockDef.SketchPoints.Add(oTG.CreatePoint2d(0, 0), False)

Set oSketchLine = oSketchBlockDef.SketchLines(1)
Call oSketchBlockDef.GeometricConstraints.AddMidpoint(oMiddlePointNative1, oSketchLine)

Dim oMiddlePointNative2 As SketchPoint
Set oMiddlePointNative2 = oSketchBlockDef.SketchPoints.Add(oTG.CreatePoint2d(0, 0), False)

Set oSketchLine = oSketchBlockDef.SketchLines(3)
Call oSketchBlockDef.GeometricConstraints.AddMidpoint(oMiddlePointNative2, oSketchLine)

Call oSketchBlock1.ExitEdit(kExitToPrevious)

Set oMiddlePoint1 = oSketchBlock1.GetObject(oMiddlePointNative1)
Set oMiddlePoint2 = oSketchBlock2.GetObject(oMiddlePointNative2)

Call oSketch.GeometricConstraints.AddCoincident(oMiddlePoint1, oMiddlePoint2)

Call oSketch.ExitEdit

End Sub</pre>
<p>Result:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4da90a7200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateConstraintAPI" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4da90a7200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4da90a7200b-320wi" title="CreateConstraintAPI" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Issues with migrating to Python 3.7.3
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: issues-with-migrating-to-python-373
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/10/issues-with-migrating-to-python-373.html 
DATE: 10/02/2019 07:19:13 PM
-----
BODY:
<p>As I mentioned it in <a href="https://modthemachine.typepad.com/my_weblog/2019/09/debug-fusion-360-add-ins.html">this blog post</a>, the new version of <strong>Python</strong> (3.7.3) that <strong>Fusion 360</strong> migrated to seems more strict, and is causing some <strong>add-ins</strong> to fail.</p>
<p>Here are the main issues I&#39;ve seen pop up:<br /><br />1) Having an empty code block: if/else, try/except, etc<br /><strong>Code:</strong></p>
<pre>try:
except:</pre>
<p><strong>Error:</strong></p>
<pre>Sorry: IndentationError: expected an indented block (PythonTest.py, line 25)</pre>
<p><strong>Solution:</strong> remove the whole block or just put a &quot;<strong>pass</strong>&quot; inside it:</p>
<pre>try:
  pass
except:
  pass</pre>
<p>2) Referencing a global variable multiple times in the same function using the &quot;<strong>global</strong>&quot; keyword - even if from different execution paths<br /><strong>Code:</strong></p>
<pre>my_global_variable = &quot;&quot;

def run(context):
  if ui:
    global my_global_variable
    my_global_variable = &quot;True&quot;
  else: 
    global my_global_variable
    my_global_variable = &quot;False&quot;</pre>
<p><strong>Error:</strong></p>
<pre>SyntaxError: name &#39;my_global_variable&#39; is assigned to before global declaration</pre>
<p><strong>Solution:</strong> use the &quot;<strong>global</strong>&quot; references at the beginning of the function&#0160;</p>
<pre>my_global_variable = &quot;&quot;

def run(context):
  global my_global_variable
  if ui:
    my_global_variable = &quot;True&quot;
  else: 
    my_global_variable = &quot;False&quot;</pre>
<p>3) One other issue, which is not necessarily a result of the compiler&#39;s strictness, is that you may be relying on&#0160;<strong>packages</strong> that are based on an earlier version of <strong>Python</strong>. If loading those modules is causing errors then you might have to upgrade those packages. It might be done in different ways depending on where you got those packages from.&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Cannot debug my Python add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: cannot-debug-my-python-add-in
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/10/cannot-debug-my-python-add-in.html 
DATE: 10/02/2019 06:33:35 PM
-----
BODY:
<p>Just wrote <a href="https://modthemachine.typepad.com/my_weblog/2019/09/debug-fusion-360-add-ins.html">an article</a> on how to debug your <strong>Python</strong> script/add-in</p>
<p>One thing missing from it is about what to do if the compiler runs into problems with the main module (vs an additional module your code is loading). <br />In that case, checking &quot;<strong>Raised Exceptions</strong>&quot; in the &quot;<strong>Breakpoints</strong>&quot; section is not enough ðŸ™<br />Your code will fail silently and the debug process won&#39;t start</p>
<p>You can work around that by running <strong>Python</strong> compile on your main module/main <strong>Python</strong> file to find out what the problem is with it.</p>
<p>Once you started debugging your code from <strong>Fusion 360</strong> and ended up in <strong>VS Code</strong>, you can follow these steps:</p>
<p>1) Open up the <strong>Terminal</strong> in <strong>VS Code</strong> (View &gt;&gt; Terminal)</p>
<p>2) Open the <strong>.vscode\settings.json</strong> file of your add-in - this will have the path to the <strong>Python</strong> version that <strong>Fusion 360</strong> is using</p>
<p>3) Copy the full path set for &quot;<strong>python.pythonPath</strong>&quot; into the terminal</p>
<p>4) Add &quot;<strong>-m py_compile</strong>&quot; to the text in the <strong>Terminal</strong> window</p>
<p>5) <strong>Drag&amp;drop</strong> your <strong>Python</strong> file&#39;s <strong>tab</strong> into the <strong>Terminal</strong> - that will copy/paste the full path of that file in the <strong>Terminal</strong></p>
<p>6) Now just hit <strong>enter</strong> in the <strong>Terminal</strong> and that should run the <strong>Python</strong> compiler, which should list the first error the <strong>compiler</strong> runs into&#0160;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b4da6c200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DebugPython1" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4b4da6c200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b4da6c200d-800wi" title="DebugPython1" /></a></p>
<p>Let&#39;s compare the error and our <strong>Python</strong> file:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48b8f12200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DebugPython2" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a48b8f12200c image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a48b8f12200c-800wi" title="DebugPython2" /></a></p>
<p>In this case, the error message is not the clearest, but at least we have something to go on ðŸ™‚<br />Solution to this specific error is here: <a href="https://modthemachine.typepad.com/my_weblog/2019/10/issues-with-migrating-to-python-373.html">Issues with migrating to Python 3.7.3</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Debug Fusion 360 add-ins with VS Code
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: debug-fusion-360-add-ins
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/09/debug-fusion-360-add-ins.html 
DATE: 09/28/2019 10:55:01 AM
-----
BODY:
<p>As I wrote about it in <a href="https://modthemachine.typepad.com/my_weblog/2019/08/new-python-version-and-visual-studio-code.html">this blog post</a>, we were switching to <a href="https://code.visualstudio.com/">Visual Studio Code</a> as the debugging tool for <strong>Fusion 360</strong> - I think that&#39;s great ðŸ˜€</p>
<p>At the same time, we also upgraded the <a href="https://www.python.org/">Python</a> version used in <strong>Fusion 360</strong> to <a href="https://www.python.org/downloads/release/python-373/">3.7.3</a>&#0160;<br />Unfortunately, some <strong>add-ins</strong> got caught up in that. It looks like the new <strong>Python</strong> version is more strict and so you might run into compiler issues.</p>
<p><span style="color: #ff0000;"><strong>Please do check your add-ins to make sure they are still working ok. Thank you!</strong></span></p>
<p><strong><span style="text-decoration: underline;">Debugging to the rescue!</span></strong></p>
<p><span style="color: #111111;">First of all, you need to install <a href="https://code.visualstudio.com/">Visual Studio Code</a>. If you follow the below steps and you do not have it installed yet, then you will get a notification dialog asking you to do this along with the <strong>URL</strong> to the download site - but of course, you can easily find it on the net, and I&#39;m providing the link as well in the paragraph ðŸ™‚&#0160;</span></p>
<p><span style="color: #111111;">1) Select your <strong>add-in</strong> in the &quot;<strong>Scripts and Add-Ins</strong>&quot; dialog and select &quot;<strong>Debug</strong>&quot; under the &quot;<strong>Run</strong>&quot; drop-down menu&#0160;</span></p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b30e45200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ScriptsAndAddins" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4b30e45200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b30e45200d-500wi" title="ScriptsAndAddins" /></a></p>
<p>2) As soon as <strong>Visual Studio Code</strong> starts up, switch over to it (in case it does not get focus automatically), select the &quot;<strong>Debug</strong>&quot; environment and click the &quot;<strong>Start Debugging</strong>&quot; button (looks like a Play button)</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b3113c200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Debugging" border="0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4b3113c200d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4b3113c200d-800wi" title="Debugging" /></a></p>
<p>3) As shown in the above picture, it&#39;s a good idea to select the &quot;<strong>Raised Exceptions</strong>&quot; option in the &quot;<strong>Breakpoints</strong>&quot; section. This way you&#39;ll get a meaningful error even if the compiler runs into problems with a module you&#39;re trying to load. This won&#39;t help though if the problem is in our main module - <a href="https://modthemachine.typepad.com/my_weblog/2019/10/cannot-debug-my-python-add-in.html">this blog post</a> has a workaround for that.</p>
<p>4) Now you have the usual options for stepping through the code, use breakpoints, etc</p>
<p>5) If you want to start the process again (maybe your code failed, etc) and the debugging toolbar in <strong>Visual Studio Code</strong> is still visible, then click the &quot;<strong>Disconnect</strong>&quot; button on it, and follow the above steps again</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d79ea9200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Disconnect" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4d79ea9200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d79ea9200b-500wi" title="Disconnect" /></a></p>
<p>6) Using <strong>print()</strong> you can write information to the &quot;<strong>Debug Console</strong>&quot;:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d7a82b200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DebugConsole" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4d7a82b200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d7a82b200b-500wi" title="DebugConsole" /></a></p>
<p>More information on debugging in <strong>VS Code</strong> on its website: <a href="https://code.visualstudio.com/docs/editor/debugging">https://code.visualstudio.com/docs/editor/debugging</a>&#0160;</p>
<p>-Adam&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Entitlement API changes in Inventor 2020
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: entitlement-api-changes-in-inventor-2020
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/09/entitlement-api-changes-in-inventor-2020.html 
DATE: 09/21/2019 06:05:34 PM
-----
BODY:
<p>We already have some articles on using the <strong>Entitlement API</strong> from <strong>Inventor</strong>:<br />- <a href="https://adndevblog.typepad.com/manufacturing/2015/03/entitlement-api-in-inventor.html">Entitlement API in Inventor</a><br />- <a href="https://adndevblog.typepad.com/manufacturing/2017/08/entitlement-api-in-inventor-2018.html">Entitlement API in Inventor 2018</a></p>
<p>There is now a change you have to be aware of.<br />Starting with <strong>Inventor 2020</strong>, to guarantee the <strong>Entitlement API</strong> calls work properly to get the <strong>UserName</strong>, call the <strong>Inventor API&#39;s</strong> <strong>Application.Login()</strong> function before or after <strong>webServiceMgr.Initialize()</strong> so the <strong>WebServices</strong> are fully initialized. <br />Otherwise, you may see a valid <strong>UserId</strong>, but an empty <strong>UserName</strong> when the user is already logged in:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a486c274200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="NoUserName" class="asset  asset-image at-xid-6a00e553fcbfc688340240a486c274200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a486c274200c-500wi" title="NoUserName" /></a><br /><strong>Note</strong>: the <strong>Application.Login()</strong> function is <strong>hidden</strong>, so <a href="https://docs.microsoft.com/en-us/visualstudio/ide/using-intellisense"><strong>IntelliSense</strong></a> in <strong>Visual Studio</strong> will not list it.</p>
<p>And, if the user attempts to login when you have not used the <strong>Login() </strong>API call, they may get an error dialog that the service is not available:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4af3a05200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image-2019-05-09-12-26-49-479" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4af3a05200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4af3a05200b-320wi" title="Image-2019-05-09-12-26-49-479" /></a></p>
<p>You can use the following code to get <strong>userId</strong> and <strong>userName</strong>:</p>
<pre>public void Activate(Inventor.ApplicationAddInSite addInSiteObject, bool firstTime)
{
  m_inventorApplication = addInSiteObject.Application;

  CWebServicesManager mgr = new CWebServicesManager();
  bool isInitialized = mgr.Initialize();

  if (isInitialized)
  {
    try
    {
      m_inventorApplication.Login();
      string userId = &quot;&quot;;
      mgr.GetUserId(ref userId);
      string userName = &quot;&quot;;
      mgr.GetLoginUserName(ref userName);
      MsgBox.Show(
        &quot;User ID = &#39;&quot; + userId + &quot;\n&quot; +
        &quot;User Name = &#39;&quot; + userName + &quot;&#39;&quot;);
    }
    catch (Exception ex)
    {
      MsgBox.Show(ex.Message);
    }
  }
}</pre>
<p>This solved the problem:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d4a90b200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="NoUserNameFixed" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4d4a90b200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4d4a90b200b-500wi" title="NoUserNameFixed" /></a></p>
<p>As pointed out in one of the above-referenced articles, there is a <strong>GitHub</strong> repo with a project showing the usage of the <strong>Entitlement API</strong> from an <strong>Inventor add-in</strong>. I updated it with &quot;<strong>releases</strong>&quot; for <strong>Inventor 2016/2017</strong>, <strong>2018/2019</strong> and <strong>2020</strong>: <a href="https://github.com/ADN-DevTech/EntitlementAPI_Inventor">https://github.com/ADN-DevTech/EntitlementAPI_Inventor</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Thomas Rambach
EMAIL: thomas.rambach@gmail.com
IP: 65.184.34.43
URL: 
DATE: 09/21/2019 05:11:21 PM
Can you explain this better or give an example of what this would look like?
-----
COMMENT:
AUTHOR: Adam Nagy
EMAIL: 
IP: 193.151.121.127
URL: https://profile.typepad.com/1236098880s16462
DATE: 09/21/2019 06:10:52 PM
Sure. I updated now the article with more details 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: New Python version and Visual Studio Code
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: new-python-version-and-visual-studio-code
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/08/new-python-version-and-visual-studio-code.html 
DATE: 08/27/2019 06:11:51 PM
-----
BODY:
<p>We are upgrading the <a href="https://www.python.org/"><strong>Python</strong></a> version used in <a href="https://www.autodesk.co.uk/products/fusion-360/overview"><strong>Fusion 360</strong></a> to <strong>3.7.3</strong> in the<strong>&#0160;September</strong> release.<br />It could mostly impact <strong>add-ins</strong> written in <strong>Python</strong> where the version of&#0160; <strong>Python</strong> used to <strong>compile</strong> the source code to a *<strong>.pyc</strong> file has been locked down.&#0160;<br />If that is the case then please test your <strong>add-in</strong> once the <strong>September</strong> release is out, and in case of any problems, <strong>recompile</strong> your <strong>add-in</strong> with the <strong>3.7.3 version</strong> of <strong>Python </strong>and upload the new version of your <strong>add-in</strong> to the <strong>App Store</strong>. <br />It might be a good idea to check your <strong>add-in</strong> even if your <strong>Python</strong> source code is <strong>not compiled</strong>. &#0160;</p>
<p>We are also going to replace the editor from <a href="https://www.spyder-ide.org/"><strong>Spyder</strong></a> to <a href="https://code.visualstudio.com/"><strong>VSCode</strong></a> in this release. <br />If you&#39;ve done any web development, you might be quite familiar with it already - and hopefully, you like it as well :)</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a47ba26d200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="VScode" class="asset  asset-image at-xid-6a00e553fcbfc688340240a47ba26d200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a47ba26d200c-320wi" title="VScode" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: New API's in Inventor 2020.1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: new-apis-in-inventor-20201
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/07/new-apis-in-inventor-20201.html 
DATE: 07/22/2019 12:25:03 PM
-----
BODY:
<p>For the clearance hole <strong>APIs</strong> we expose the HoleFeatures.<strong>CreateClearanceInfo</strong> and also make the HoleFeature.<strong>ClearanceInfo</strong> writable in I<strong>nventor 2020.1</strong> so users now can create a clearance hole via <strong>API</strong>.</p>
<p>Here is a sample:</p>
<pre>Sub test() 
   &#39; open a part document with a hole feature
   Dim oDoc As PartDocument 
   Set oDoc = ThisApplication.ActiveDocument 
     
   Dim oHole As HoleFeature 
   Set oHole = oDoc.ComponentDefinition.Features.HoleFeatures(1) 
     
   Debug.Print oHole.IsClearanceHole 
   
   &#39; Create a HoleClearanceInfo(not associative with any HoleFeature) 
   Dim oHCI As HoleClearanceInfo 
   Set oHCI = oDoc.ComponentDefinition.Features.HoleFeatures.CreateClearanceInfo(&quot;Ansi Unified Screw Threads&quot;, &quot;Flat Head Machine Screw (100)&quot;, &quot;#1&quot;, kNormalFitType) 
   Debug.Print oHCI.FastenerStandard 
   Debug.Print oHCI.FastenerType 
   Debug.Print oHCI.FastenerSize 
   Debug.Print oHCI.FastenerFitType 
   
   &#39; we can change the property when the HoleClearanceInfo is not associative with a HoleFeature 
   oHCI.FastenerStandard = &quot;ISO&quot; 
   oHCI.FastenerType = &quot;Countersunk Flat Head Screw ISO 2009/7046&quot; 
   oHCI.FastenerSize = &quot;M1.6&quot; 
   oHCI.FastenerFitType = kCloseFitType 
   
   Debug.Print &quot;----------------------------&quot; 
   Debug.Print oHCI.FastenerStandard 
   Debug.Print oHCI.FastenerType 
   Debug.Print oHCI.FastenerSize 
   Debug.Print oHCI.FastenerFitType 
   
   &#39; set the hole as a clearance hole 
   oHole.ClearanceInfo = oHCI 
   Debug.Print oHole.IsClearanceHole 
   
   &#39; retrieve the HoleClearanceInfo from a HoleFeature 
   Set oHCI = oHole.ClearanceInfo 
   
   Debug.Print &quot;----------------------------&quot; 
   Debug.Print oHCI.FastenerStandard 
   Debug.Print oHCI.FastenerType 
   Debug.Print oHCI.FastenerSize 
   Debug.Print oHCI.FastenerFitType 
   
   &#39; now the oHCI is associative with a HoleFeature, we don&#39;t allow to change a property(like FastenerStandard) directly on the property 
   &#39; but you can call the SetClearanceInfo method to change the properties, and the change will affect the HoleFeature directly 
   Call oHCI.SetClearanceInfo(&quot;Ansi Unified Screw Threads&quot;, &quot;Flat Head Machine Screw (82)&quot;, &quot;#8&quot;, kNormalFitType) 
   Debug.Print &quot;----------------------------&quot; 
   Debug.Print oHCI.FastenerStandard 
   Debug.Print oHCI.FastenerType 
   Debug.Print oHCI.FastenerSize 
   Debug.Print oHCI.FastenerFitType 
   
   &#39; also you can create another HoleClearanceInfo(not associative with any HoleFeature), and assign it to the HoleFeature.ClearanceInfo to change its clearance info 
   Dim onewHCI As HoleClearanceInfo 
   Set onewHCI = oDoc.ComponentDefinition.Features.HoleFeatures.CreateClearanceInfo(&quot;DIN&quot;, &quot;Countersunk Flat Head Screw DIN EN ISO 2009&quot;, &quot;M1.6&quot;, kNormalFitType) 
   oHole.ClearanceInfo = onewHCI 
   
   Set oHCI = oHole.ClearanceInfo 
   Debug.Print &quot;----------------------------&quot; 
   Debug.Print oHCI.FastenerStandard 
   Debug.Print oHCI.FastenerType 
   Debug.Print oHCI.FastenerSize 
   Debug.Print oHCI.FastenerFitType 
 
End Sub</pre>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: The new Fusion 360 UI is here!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: the-new-fusion-360-ui-is-here
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/07/the-new-fusion-360-ui-is-here.html 
DATE: 07/22/2019 10:52:06 AM
-----
BODY:
<p>A new <strong>Fusion 360</strong> toolbar <strong>UI</strong> is becoming official soon, including changes to the existing <strong>API</strong>. To ensure that your <strong>add-ins</strong> are still compatible, we highly encourage you to update your <strong>add-in</strong> using the new <strong>API</strong>: <a href="https://docs.google.com/document/d/174ISmaXs-60JRtn8bt4Sbr6Z3jqzkyoSizVD9YwChOQ/edit?usp=sharing">https://docs.google.com/document/d/174ISmaXs-60JRtn8bt4Sbr6Z3jqzkyoSizVD9YwChOQ/edit?usp=sharing</a></p>
<p>For convenience I&#39;m also pasting here the content:</p>
<pre><strong>Tabbed Toolbar API</strong>

UserInterface class changes
<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-52303e26-c1c2-4a1c-8c1a-a3c199e6db63">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-52303e26-c1c2-4a1c-8c1a-a3c199e6db63</a>

app = adsk.core.Application.get()
ui  = app.userInterface

Indicates if Fusion 360 is running with in the old toolbar or new toolbar:

# bool isTabbedToolbar { get; }
runningTabbedToolbar = ui.isTabbedToolbar

Gets all of the toolbar tabs. This returns all of the tabs available, regardless of which workspace or product they&#39;re associated with.

# ToolbarTabList allToolbarTabs { get; }
Similar example:  see commandDefinitions, like:  ui.commandDefinitions
allToolbarTabsList = ui.allToolbarTabs

this gets all of the toolbar tabs associated with the specified product. The full list of available products can be obtained by using the Application.supportedProductTypes property.

# ToolbarTabList toolbarTabsByProductType(string productType);
supportedProductTypesList = app.supportedProductTypes
print(supportProductTypesList)
# Example output:  (&#39;CAMProductType&#39;, &#39;AnimationProductType&#39;, &#39;DesignProductType&#39;, &#39;FusionDrawingProductType&#39;, &#39;SimStudiesProductType&#39;)
tabsListForProduct = ui.toolbarTabsByProductType(&#39;DesignProductType&#39;)

<strong>New! ToolbarTabList class</strong>

This is a collection of ToolbarTab objects

Returns the specified tab using an index into the collection.
# ToolbarTab item(uint index);

Returns the ToolbarTab of the specified ID.
# ToolbarTab itemById(string id);

Gets the number of toolbar tabs in the collection.
# uint count { get; }

Try to get the Solid tab:
solidTab = allToolbarTabsList.itemById(&#39;SolidTab&#39;)

<strong>New! ToolbarTab class</strong>

Gets ID of tab:
# string id { get; }

Get position of this tab within its toolbar:
# uint index { get; }

Gets whether this tab is currently being displayed in the user interface
# bool isVisible { get; }

Gets the name of the tab as seen in the user interface.
# string name { get; }

Gets the collection containing the panels associated with this tab.
It&#39;s through this collection that you can add new toolbar panels.
# ToolbarTabPanels toolbarPanels { get; }

Gets the parent UserInterface object.
# UserInterface parentUserInterface { get; }    

# Returns the name of the product this toolbar tab is associated with.
# string productType { get; }   

# Make sure that it isn&#39;t null
if solidTab:
    # Found solidTab!  Ok to use it now!
    isSolidTabVisible = solidTab.isVisible
    allSolidTabPanels = solidTab.toolbarPanels

<strong>New! ToolbarTabPanels class</strong> <br />
Collection of ToolbarPanel objects (ToolbarPanel is existing class) 
Unlike ToolbarPanels, ToolbarTabPanels class lets you position the panel in a specific tab in relation to other panels in the toolbar. 
 
Creates a new ToolbarPanel. The panel is initially empty.
# ToolbarPanel add(string id, string name, [Optional] string positionID = &quot;&quot;, [Optional] bool isBefore = true);

Returns the specified toolbar panel using an index into the collection.
# ToolbarPanel item(uint index);

Returns the ToolbarPanel at the specified ID.
ToolbarPanel itemById(string id);

Gets the number of panels.
# uint count { get; }

Add a new panel to a particular tab:
fancyAddinToolbarPanel = allSolidTabPanels.add(&#39;JenCompanyAddin&#39;, &#39;DoImportantFusionThingPanel&#39;)

<strong>ToolbarPanel class (existing class, but 1 new method)</strong>
<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-0ca48ac9-da95-4623-bf87-150f3729717a">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-0ca48ac9-da95-4623-bf87-150f3729717a</a>

# string id { get; }
# uint index { get; }
# bool isVisible { get; }
# string name { get; }
# bool deleteMe();
# ToolbarControls controls { get; }
# UserInterface parentUserInterface { get; }
# ToolbarControlList promotedControls { get; }
# ObjectCollection relatedWorkspaces { get; set; }
# productType { get; }

New method - Gets the position this panel is in within the toolbar tab.
# uint indexWithinTab(string tabId); 

Add a control to the initially empty new toolbar panel:
ToolbarControls class:  <a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-df24e158-40e0-4aed-9990-97c470935dbb">https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-df24e158-40e0-4aed-9990-97c470935dbb</a>

fancyAddinToolbarPanelControls = fancyAddinToolbarPanel.controls

Assume JenFancyCommmandDef created already....
<a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-1ed0cfb5-2ad4-4285-9eec-484ef19f2729">https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-1ed0cfb5-2ad4-4285-9eec-484ef19f2729</a>
doSomethingAmazingCmdControl = fancyAddinToolbarPanelControls.addCommand(JenFancyCommmandDef, &#39;&#39;, False)

<strong>Workspace class (existing class, but 1 new method)<br /></strong>
Gets the collection containing the tabs associated with this workspace.
# ToolbarTabs toolbarTabs { get; }

Get a list of all workspaces:
<a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-75ac7274-735c-4a61-af57-1d837c4df217">https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-75ac7274-735c-4a61-af57-1d837c4df217</a>

workspacesList = ui.workspaces
print (workspacesList.count)    

The above example prints 29 total workspaces in Fusion.
Note from Jennifer:  With 29 workspaces that don&#39;t match up with the new Tabbed Toolbar 
&quot;Workspaces&quot; as shown in the Workspace Switcher, I&#39;m not sure how valuable 
workspaces will be for new API writers and tabbed toolbar?

Get a single workspace:
oneWorkspace = workspacesList.itemById(&#39;FusionModelingEnvironment&#39;) 

<a href="https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-33f9ed37-e5c7-4153-ba85-c3254a199dd1">https://help.autodesk.com/view/fusion360/ENU/?guid=GUID-33f9ed37-e5c7-4153-ba85-c3254a199dd1</a>

# Gets the collection containing the tabs associated with this workspace.
# ToolbarTabs toolbarTabs { get; }
modelingEnvToolbarTabs = oneWorkspace.toolbarTabs

<strong>New! ToolbarTabs class<br /></strong>
Collection of ToolbarTab objects

Returns the specified toolbar tab using an index into the collection.
#  ToolbarTab item(uint index);

Returns the ToolbarTab at the specified ID.
# ToolbarTab itemById(string id);

# Gets the number of ToolbarTabs.
# uint count { get; }
</pre>
<p>In the <strong>August Update</strong> (coming around <strong>mid August</strong>), we will be making the new toolbar <strong>UI</strong> the default toolbar for <strong>Fusion 360</strong>. Users will have the option to revert back to the old toolbar, however this option will only be available for a limited period of time. The current plan is to completely transition over to the new toolbar <strong>UI</strong> by the <strong>September</strong> <strong>Update</strong>.&#0160;</p>
<p>If you havenâ€™t tried out the new toolbar <strong>UI</strong> yet, you can turn it on by going to the <strong>Preferences</strong> &gt; <strong>Preview</strong> section and checking the <strong>UI Preview</strong> option. <br />Here is a video of the <a href="https://youtu.be/Zf-fErCl43I">top 5 changes to look for when using the new toolbar UI.&#0160;</a></p>
<p>The commands of existing <strong>add-ins</strong> will be redirected to the most appropriate place, but it&#39;s not always possible. In that case the command buttons will be placed in the <strong>Tools</strong> tab as a default location under the new toolbar <strong>UI</strong>.&#0160; <br />It&#39;s better to use the new <strong>API</strong>&#39;s to make sure your command button goes exactly where you want it ðŸ˜€</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Mirror Sketch Geometry
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mirror-sketch-geometry
CATEGORY: Adam
CATEGORY: Inventor
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/07/mirror-sketch-geometry.html 
DATE: 07/12/2019 10:48:19 AM
-----
BODY:
<p>In the <strong>Sketch</strong> environment there is a <strong>Mirror</strong> command in the <strong>Pattern</strong> palette:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4bbff76200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Sketch_Mirror4" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4bbff76200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4bbff76200b-500wi" title="Sketch_Mirror4" /></a></p>
<p>Unfortunately, its functionality is not directly exposed in the <strong>API</strong>.&#0160; <br />However, we can check what it does and try to replicate it.</p>
<p>When I mirror sketch geometry, I can see that the <strong>Mirror</strong> command basically <strong>copies</strong> all the <strong>sketch points and lines</strong>, and then sets up a <strong>symmetry constraint</strong> between the original and copied <strong>sketch points</strong>.</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a46e2523200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Sketch_Mirror3" class="asset  asset-image at-xid-6a00e553fcbfc688340240a46e2523200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a46e2523200c-500wi" title="Sketch_Mirror3" /></a></p>
<p>Here is a <strong>VBA</strong> sample which achieves this for <strong>sketch lines </strong>- for other geometry you would have to implement the functionality in a similar fashion:</p>
<pre>Function CopyAndConstrainPoint(pt As SketchPoint, ln As SketchLine, pts As Dictionary) As SketchPoint
  &#39; The sketch we are working in
  Dim sk As PlanarSketch
  Set sk = pt.Parent
     
  &#39; Check if we already copied this
  &#39; sketch point
  If Not pts.Exists(pt) Then
    &#39; Create new point
    Set CopyAndConstrainPoint = sk.SketchPoints.Add(pt.Geometry, False)
    Call pts.Add(pt, CopyAndConstrainPoint)
    &#39; Constrain it
    Call sk.GeometricConstraints.AddSymmetry(pt, CopyAndConstrainPoint, ln)
  Else
    Set CopyAndConstrainPoint = pts(pt)
  End If
End Function

Sub MirrorSketchLines()
  Dim selSet As SelectSet
  Set selSet = ThisApplication.ActiveDocument.SelectSet

  &#39; The first selected item needs to be the
  &#39; mirror line
  Dim mirrorLine As SketchLine
  Set mirrorLine = selSet(1)
  
  &#39; The sketch we are working in
  Dim sk As PlanarSketch
  Set sk = mirrorLine.Parent
  
  &#39; Let&#39;s get the lines we need to mirror
  &#39; We need to copy the lines, the sketch points
  &#39; and set up a symmetry constraint between the
  &#39; points and the mirror line
  Dim mirroredSketchPoints As New Dictionary
  Dim sketchLines As ObjectCollection
  Set sketchLines = ThisApplication.TransientObjects.CreateObjectCollection()
  
  &#39; First store the selection set
  &#39; because it might get reset when adding new
  &#39; sketch entities and setting up constraints
  Dim i As Integer
  For i = 2 To selSet.Count
    If TypeOf selSet(i) Is SketchLine Then
      Call sketchLines.Add(selSet(i))
    End If
  Next
      
  Dim line As SketchLine
  For Each line In sketchLines
    &#39; Get the copied points
    Dim sp As SketchPoint
    Set sp = CopyAndConstrainPoint(line.StartSketchPoint, mirrorLine, mirroredSketchPoints)
    
    Dim ep As SketchPoint
    Set ep = CopyAndConstrainPoint(line.EndSketchPoint, mirrorLine, mirroredSketchPoints)
    
    &#39; Create the new line using the copied and constrained
    &#39; sketch points
    Call sk.sketchLines.AddByTwoPoints(sp, ep)
  Next
End Sub</pre>
<p>When running it, make sure that you <strong>first</strong> select the <strong>mirror line</strong>, and <strong>then</strong> the <strong>rest of the geometry</strong>:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a46e2539200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Sketch_Mirror2" class="asset  asset-image at-xid-6a00e553fcbfc688340240a46e2539200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a46e2539200c-500wi" title="Sketch_Mirror2" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Import AnyCAD documents associatively
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: import-anycad-documents-associatively
CATEGORY: Adam
CATEGORY: Assemblies
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/04/import-anycad-documents-associatively.html 
DATE: 04/29/2019 03:23:08 PM
-----
BODY:
<p>There are two main ways to import a <strong>non-Inventor</strong> document: use &quot;<strong>Reference Model</strong>&quot; or &quot;<strong>Convert Model</strong>&quot;</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a45870dc200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Import1" class="asset  asset-image at-xid-6a00e553fcbfc688340240a45870dc200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a45870dc200c-320wi" title="Import1" /></a></p>
<p>In case of the &quot;<strong>Convert Model</strong>&quot;, for each component of the original document an <strong>Inventor</strong> model (assembly or part) will be created. It&#39;s the same for &quot;<strong>Reference Model</strong>&quot;, but instead of storing those files separately on the hard drive in a special folder (default folder is &quot;<strong>C:\Users\&lt;user name&gt;\Documents\Inventor</strong>&quot;), those documents will be embedded in the <strong>Inventor</strong> model. Not only that, but there will be a <strong>reference</strong> to the original model and if that gets updated, then <strong>Inventor</strong> will offer you to update the host assembly as well.&#0160;</p>
<p>If you simply add a <strong>non-Inventor</strong> model as a new occurrence then the &quot;<strong>Convert Model</strong>&quot; option will be used:<br />(Note: I simply opened the <strong>Stapler</strong> sample (<strong>Inventor</strong> sample models are available from <a href="https://knowledge.autodesk.com/support/inventor-products/troubleshooting/caas/downloads/content/inventor-sample-files.html">here</a>), exported it as a <strong>Step</strong> file and used that in the below code)</p>
<pre>Sub ImportAnyCADToAssembly()
    Dim oDoc As AssemblyDocument
    Set oDoc = ThisApplication.ActiveDocument
 
    Dim oAssyCompDef As AssemblyComponentDefinition
    Set oAssyCompDef = oDoc.ComponentDefinition
    
    Dim oMatrix As Matrix
    Set oMatrix = ThisApplication.TransientGeometry.CreateMatrix()
 
    Dim oOcc As ComponentOccurrence
    Set oOcc = oAssyCompDef.Occurrences.Add( _
        &quot;C:\Autodesk\autodesk_inventor_2019_samples_dlm\Models\Assemblies\Stapler\Stapler.stp&quot;, _
        oMatrix)
End Sub</pre>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4587178200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Import2" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4587178200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4587178200c-500wi" title="Import2" /></a></p>
<p>If you want to import the model using the &quot;<strong>Reference Model</strong>&quot; option then you have to go through the <strong>ImportedComponents</strong> collection. There is a <a href="https://help.autodesk.com/view/INVNTOR/2019/ENU/?guid=GUID-DC63C2B0-5CB2-4CBF-A3B9-3AECF1DC3005">sample</a> for that in the <strong>Inventor API Help</strong>, but here it is as well:</p>
<pre>Sub AssociativelyImportAnyCADToAssembly()
    Dim oDoc As AssemblyDocument
    Set oDoc = ThisApplication.ActiveDocument
 
    Dim oAssyCompDef As AssemblyComponentDefinition
    Set oAssyCompDef = oDoc.ComponentDefinition
 
    &#39;Create the ImportedGenericComponentDefinition based on a Step file
    Dim oImportedGenericCompDef As ImportedGenericComponentDefinition
    Set oImportedGenericCompDef = oAssyCompDef.ImportedComponents.CreateDefinition( _
        &quot;C:\Autodesk\autodesk_inventor_2019_samples_dlm\Models\Assemblies\Stapler\Stapler.stp&quot;)
 
    &#39;Set the ReferenceModel to associatively import the Step file
    &#39;True is the default value
    oImportedGenericCompDef.ReferenceModel = True
 
    &#39;Import the Step file to assembly
    Dim oImportedComp As ImportedComponent
    Set oImportedComp = oAssyCompDef.ImportedComponents.Add(oImportedGenericCompDef)
    Dim oOcc As ComponentOccurrence
    &#39;The last occurrence should be the one we just added
    Set oOcc = oAssyCompDef.Occurrences(oAssyCompDef.Occurrences.Count)
    
    &#39;If you want to add more instances, you can do that e.g. through using the
    &#39;occurrence&#39;s definition
    &#39;Dim oMatrix As Matrix
    &#39;Set oMatrix = ThisApplication.TransientGeometry.CreateMatrix()
    &#39;Set oOcc = oAssyCompDef.Occurrences.AddByComponentDefinition(oOcc.Definition, oMatrix)
End Sub</pre>
<p>Now we got the model embedded in the assembly:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a45871f0200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Import3" class="asset  asset-image at-xid-6a00e553fcbfc688340240a45871f0200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a45871f0200c-500wi" title="Import3" /></a></p>
<p>You can see that the <strong>icons</strong> for the occurrence are different in this case from the usual <strong>assembly</strong> and <strong>part</strong> document icons.</p>
<p>For completeness&#39; sake, here is another way of importing <strong>non-Inventor</strong> documents in an <strong>associative</strong> way. This time going through the <strong>translator</strong> add-ins:</p>
<pre>Sub AssocImport()
    Dim sFilename As String
    sFilename = &quot;C:\Autodesk\autodesk_inventor_2019_samples_dlm\Models\Assemblies\Stapler\Stapler.stp&quot;
       
    Dim sClientID As String
    sClientID = &quot;{90AF7F40-0C01-11D5-8E83-0010B541CD80}&quot; &#39;GetTranslatorCLSID for STEP
   
    Dim oTransAddIn As TranslatorAddIn
    Set oTransAddIn = ThisApplication.ApplicationAddIns.ItemById(sClientID)
   
    oTransAddIn.Activate
   
    &#39;Get the transient object, take it as a factory to produce other objects
    Dim oTransientObj As TransientObjects
    Set oTransientObj = ThisApplication.TransientObjects
   
    &#39;Prepare the 1st parameter for Open(), the file name
    Dim oFile As DataMedium
    Set oFile = oTransientObj.CreateDataMedium
    oFile.FileName = sFilename
 
    &#39;Prepare the 2nd parameter for Open(), the open type, for convenience set it as drag&amp;drop
    Dim oContext As TranslationContext
    Set oContext = oTransientObj.CreateTranslationContext
    oContext.Type = kFileBrowseIOMechanism
   
    &#39;Prepare the 3rd parameter for Open(), the import options
    Dim oOptions As NameValueMap
    Set oOptions = oTransientObj.CreateNameValueMap
   
    Dim oDefaultOptions As NameValueMap
    Set oDefaultOptions = oTransientObj.CreateNameValueMap
     
    Dim bHasOpt As Boolean
    bHasOpt = oTransAddIn.HasOpenOptions(oFile, oContext, oDefaultOptions)
    oOptions.Value(&quot;AssociativeImport&quot;) = True
 
    Dim oSourceObj As Object
    oTransAddIn.Open oFile, oContext, oOptions, oSourceObj
   
    Dim oTransDoc As Document
    Set oTransDoc = oSourceObj
   
    If oTransDoc.DocumentType = kAssemblyDocumentObject Then
        Dim oAsm As AssemblyDocument: Set oAsm = oTransDoc
        Debug.Print oAsm.ComponentDefinition.ImportedComponents(1).Name
    ElseIf oTransDoc.DocumentType = kPartDocumentObject Then
        Dim oPart As PartDocument: Set oPart = oTransDoc
        Debug.Print oPart.ComponentDefinition.ReferenceComponents.ImportedComponents(1).Name
    End If
End Sub</pre>
<p>There are two useful code samples in this blog post that can be useful concerning translator add-ins (getting a list of them with their ID&#39;s and listing all the available settings they provide): <a href="https://adndevblog.typepad.com/manufacturing/2014/02/get-option-names-and-values-supported-by-inventor-translator-addins-via-api.html">https://adndevblog.typepad.com/manufacturing/2014/02/get-option-names-and-values-supported-by-inventor-translator-addins-via-api.html</a><br /><br />-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Design Automation for Inventor webinar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: design-automation-for-inventor-webinar
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/04/design-automation-for-inventor-webinar.html 
DATE: 04/23/2019 10:48:29 AM
-----
BODY:
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a431e5200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Inventorda_webinar2_0" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4a431e5200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4a431e5200b-500wi" title="Inventorda_webinar2_0" /></a></p>
<p>If you are developing <strong>add-in</strong>&#39;s for <strong>Inventor,</strong> this <strong>webcast</strong> could be a nice way to learn about how to migrate all or parts of your <strong>add-in</strong>&#39;s functionality to the <strong>cloud</strong> by using <a href="https://forge.autodesk.com/"><strong>Forge</strong></a> <a href="https://forge.autodesk.com/en/docs/design-automation/v2/developers_guide/overview/"><strong>Design Automation for Inventor</strong></a>.</p>
<p>Further details on the webcast <a href="https://forge.autodesk.com/blog/design-automation-api-inventor-webinar">here</a>.</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Cannot convert argument 1 from 'const wchar_t [16]' to 'LPTSTR'
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: cannot-convert-argument-1-from-const-wchar_t-16-to-lptstr
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/04/cannot-convert-argument-1-from-const-wchar_t-16-to-lptstr.html 
DATE: 04/11/2019 10:40:54 AM
-----
BODY:
<p>You might run into this error when you ...</p>
<p>1) Create a <strong>C++ standalone project</strong> in <strong>VS2017 </strong>(15.5 and later versions)<br />2) Turn the <strong>C/C++ </strong>-&gt;<strong> Language </strong>-&gt; <strong>Conformance mode</strong> option to <strong>Yes</strong>:<br /><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a47abe16200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Image004" class="asset  asset-image at-xid-6a00e553fcbfc688340240a47abe16200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a47abe16200d-500wi" title="Image004" /></a></p>
<p>3) Include <strong>InventorUtils.h</strong></p>
<p>The exact error will be:</p>
<table border="1" style="border-collapse: collapse; width: 86.2762%;">
<tbody>
<tr>
<td style="width: 8.65385%;">Severity</td>
<td style="width: 6.38117%;">Code</td>
<td style="width: 38.0245%;">Description</td>
<td style="width: 33.2167%;">File</td>
</tr>
<tr>
<td style="width: 8.65385%;">Error</td>
<td style="width: 6.38117%;">C2664</td>
<td style="width: 38.0245%;">&#39;LPOLESTR T2OLE(LPTSTR)&#39;: cannot convert argument 1 from &#39;const wchar_t [16]&#39; to &#39;LPTSTR&#39;</td>
<td style="width: 33.2167%;">c:\users\public\documents\autodesk\inventor 2020\sdk\developertools\include\dispatchutils.h</td>
</tr>
</tbody>
</table>
<p>The solution is to turn <strong>off</strong> the <strong>Conformance mode</strong></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Automate creation of Named Geometry
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: automate-creation-of-named-geometry
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/03/automate-creation-of-named-geometry.html 
DATE: 03/06/2019 06:08:58 PM
-----
BODY:
<p><strong>Named Geometry</strong> is an <strong>iLogic</strong> feature that lets you tag geometry in the <strong>UI</strong>:<br />(See section &quot;Use Assign Name to Identify Geometry for Constraints&quot; <a href="https://help.autodesk.com/view/INVNTOR/2019/ENU/?guid=GUID-80AD0392-0B8C-4A27-A9B3-7466D53999BF">here</a>)</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4426edd200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"> </a> <a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a49030d6200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="AssignName" class="asset  asset-image at-xid-6a00e553fcbfc688340240a49030d6200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a49030d6200b-500wi" title="AssignName" /></a><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4426edd200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><br /></a></p>
<p><strong>iLogic</strong> has an <a href="https://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2019/ENU/Inventor-iLogic/iLogic-API/html/f6ad8d4d-8d5a-8967-a35d-d77a28628d0b-htm.html">Automation</a> interface that lets you automate <strong>iLogic</strong> specific features from your <strong>iLogic Rule</strong> or <strong>add-in</strong>/<strong>app</strong>.&#0160;</p>
<p>Using that we can also manipulate <strong>Named Geometry </strong>entries - e.g. add a new one. <br />This is what it would look like in a <strong>Rule</strong>:</p>
<pre>&#39; Select Face before running this code
Dim iLogicAuto = iLogicVb.Automation

Dim namedEntities = iLogicAuto.GetNamedEntities(ThisDoc.Document)

Dim f = ThisDoc.Document.SelectSet(1)

namedEntities.SetName(f, &quot;MyNewFace&quot;)</pre>
<p>Result:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4903150200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Assignname2" class="asset  asset-image at-xid-6a00e553fcbfc688340240a4903150200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a4903150200b-500wi" title="Assignname2" /></a></p>
<p>We can also achieve the same from e.g. <strong>VBA</strong>:</p>
<pre>Sub AddNamedGeometry()
 &#39; Select Face before running this code
  Const iLogicAddinGuid As String = &quot;{3BDD8D79-2179-4B11-8A5A-257B1C0263AC}&quot;

  Dim doc As Document
  Set doc = ThisApplication.ActiveDocument
  
  Dim addin As ApplicationAddIn
  Set addin = ThisApplication.ApplicationAddIns.ItemById(iLogicAddinGuid)

  Dim iLogicAuto As Object
  Set iLogicAuto = addin.Automation

  Dim namedEntities As Object
  Set namedEntities = iLogicAuto.GetNamedEntities(doc)

  Dim f As Face
  Set f = doc.SelectSet(1)

  Call namedEntities.SetName(f, &quot;MyNewFace&quot;)
End Sub</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Accessing iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-iproperties
CATEGORY: Adam
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/03/accessing-iproperties.html 
DATE: 03/04/2019 06:29:23 PM
-----
BODY:
<p>I was told that it could be useful to provide a list of all the <strong>property names</strong> used for <strong>iProperties </strong>- for reference, I assume.</p>
<p>Actually, you can get this list with a simple <strong>VBA</strong> code ðŸ˜€</p>
<pre>Sub GetPropertySets()
  Dim doc As Document
  Set doc = ThisApplication.ActiveDocument
  
  Dim ps As PropertySet
  For Each ps In doc.PropertySets
    Debug.Print ps.Name + &quot; / &quot; + ps.InternalName
    Dim p As Property
    For Each p In ps
      Debug.Print &quot;  &quot; + p.Name + &quot; /&quot; + Str(p.PropId)
    Next
  Next
End Sub
</pre>
<p>Here is the result:</p>
<pre>Inventor Summary Information / {F29F85E0-4FF9-1068-AB91-08002B27B3D9}
  Title / 2
  Subject / 3
  Author / 4
  Keywords / 5
  Comments / 6
  Last Saved By / 8
  Revision Number / 9
  Thumbnail / 17
Inventor Document Summary Information / {D5CDD502-2E9C-101B-9397-08002B2CF9AE}
  Category / 2
  Manager / 14
  Company / 15
Design Tracking Properties / {32853F0F-3444-11D1-9E93-0060B03C1CA6}
  Creation Time / 4
  Part Number / 5
  Project / 7
  Cost Center / 9
  Checked By / 10
  Date Checked / 11
  Engr Approved By / 12
  Engr Date Approved / 13
  User Status / 17
  Material / 20
  Part Property Revision Id / 21
  Catalog Web Link / 23
  Part Icon / 28
  Description / 29
  Vendor / 30
  Document SubType / 31
  Document SubType Name / 32
  Proxy Refresh Date / 33
  Mfg Approved By / 34
  Mfg Date Approved / 35
  Cost / 36
  Standard / 37
  Design Status / 40
  Designer / 41
  Engineer / 42
  Authority / 43
  Parameterized Template / 44
  Template Row / 45
  External Property Revision Id / 46
  Standard Revision / 47
  Manufacturer / 48
  Standards Organization / 49
  Language / 50
  Defer Updates / 51
  Size Designation / 52
  Categories / 56
  Stock Number / 55
  Weld Material / 57
  Mass / 58
  SurfaceArea / 59
  Volume / 60
  Density / 61
  Valid MassProps / 62
  Flat Pattern Width / 63
  Flat Pattern Length / 64
  Flat Pattern Area / 65
  Sheet Metal Rule / 66
  Last Updated With / 67
  Sheet Metal Width / 68
  Sheet Metal Length / 69
  Sheet Metal Area / 70
  Material Identifier / 71
  Appearance / 72
  Flat Pattern Defer Update / 73
Inventor User Defined Properties / {D5CDD505-2E9C-101B-9397-08002B2CF9AE}</pre>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a441a1ad200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IProperties" class="asset  asset-image at-xid-6a00e553fcbfc688340240a441a1ad200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340240a441a1ad200c-320wi" title="IProperties" /></a></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Existing add-ins and scripts now work with the UI Preview
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: existing-add-ins-and-scripts-now-work-with-the-ui-preview
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2019/01/existing-add-ins-and-scripts-now-work-with-the-ui-preview.html 
DATE: 01/15/2019 10:42:23 AM
-----
BODY:
<p>As I wrote about it <a href="https://modthemachine.typepad.com/my_weblog/2018/12/prepare-add-in-for-ui-preview.html">before</a> there is a <strong>new</strong> <strong>UI</strong> coming in <strong>Fusion 360</strong> that might need the attention of <strong>add-in</strong> developers.</p>
<p>However, in the latest release, the majority of the existing <strong>add-ins</strong> will be supported by accepting code placing command buttons at the old locations and putting them to the new ones <strong>automatically</strong>: <a href="https://www.autodesk.com/products/fusion-360/blog/january-9-2019-product-update-whats-new/#Previews">https://www.autodesk.com/products/fusion-360/blog/january-9-2019-product-update-whats-new/#Previews</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Getting Offline Access to the Fusion 360 API Help
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: getting-offline-access-to-the-fusion-360-api-help
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/12/getting-offline-access-to-the-fusion-360-api-help.html 
DATE: 12/21/2018 10:30:15 AM
-----
BODY:
<p>Our online help system or your internet is down, or you&#39;re travelling where there is no mobile/cellular reception?</p>
<p>That&#39;s not a good enough reason anymore not to double-check something in the <strong>Fusion 360 API</strong> documentation! ðŸ˜€</p>
<p>Have a look at <strong>Brian</strong>&#39;s article about the <strong>offline</strong> help file you can download:<br /><a href="https://ekinssolutions.com/getting-offline-access-to-the-fusion-360-api-help/">https://ekinssolutions.com/getting-offline-access-to-the-fusion-360-api-help/</a></p>
<p>As <strong>Masoun Mardini</strong> mentions it in the comments section, you can even use it on a <strong>Mac</strong></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: TSmithCAD
EMAIL: tsmithcad@gmail.com
IP: 12.166.248.178
URL: 
DATE: 12/27/2018 06:12:27 PM
I would like to contribute to this blog.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Prepare your add-in for UI Preview
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: prepare-add-in-for-ui-preview
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/12/prepare-add-in-for-ui-preview.html 
DATE: 12/18/2018 01:37:34 PM
-----
BODY:
<p>There is a <strong>UI Preview</strong> available in <strong>Fusion 360 </strong>providing a tabbed experience.&#0160;If you enable it then depending on which <strong>UI</strong> section your <strong>add-in</strong> is currently trying to add its buttons to, it might fail since some items were replaced with new ones.</p>
<div class="photo-wrap photo-xid-6a00e553fcbfc68834022ad382111c200c" id="photo-xid-6a00e553fcbfc68834022ad382111c200c" style="display: inline-block; width: 500px;"><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad382111c200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false"><img alt="UiPreview" class="asset  asset-image at-xid-6a00e553fcbfc68834022ad382111c200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad382111c200c-500wi" title="UiPreview" /></a>
<div class="photo-caption caption-xid-6a00e553fcbfc68834022ad382111c200c" id="caption-xid-6a00e553fcbfc68834022ad382111c200c">UI Preview</div>
</div>
<p>E.g. instead of having a single <strong>toolbar</strong> <strong>panel</strong> for <strong>Sketch</strong> with id &quot;<strong>SketchPanel</strong>&quot; in the &quot;<strong>Design</strong>&quot; environment (id=<strong>FusionSolidEnvironment</strong>), now we have multiple of those, inc. &quot;<strong>Create</strong>&quot; (id=<strong>SketchCreatePanel)</strong>, &quot;<strong>Modify</strong>&quot; (id=<strong>SketchModifyPanel)</strong>, etc</p>
<div class="photo-wrap photo-xid-6a00e553fcbfc68834022ad3a816ce200d" id="photo-xid-6a00e553fcbfc68834022ad3a816ce200d" style="display: inline-block; width: 500px;"><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad3a816ce200d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false"><img alt="NewFusionUi" class="asset  asset-image at-xid-6a00e553fcbfc68834022ad3a816ce200d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad3a816ce200d-500wi" title="NewFusionUi" /></a>
<div class="photo-caption caption-xid-6a00e553fcbfc68834022ad3a816ce200d" id="caption-xid-6a00e553fcbfc68834022ad3a816ce200d">Current vs New UI</div>
</div>
<p>In order to make your <strong>add-in </strong>work in this new environment, you should make sure that if the <strong>classic UI</strong> item is not available then you try using the <strong>new</strong> <strong>UI</strong> item instead:</p>
<pre>modelingWorkspace_ = workspaces_.itemById(&#39;FusionSolidEnvironment&#39;)
toolbarPanels_ = modelingWorkspace_.toolbarPanels
try:
    # try to add it to the classic ui item
    toolbarPanel_ = toolbarPanels_.itemById(&#39;SketchPanel&#39;)
    toolbarControlsPanel_ = toolbarPanel_.controls
except:
    # if it fails, try to add it to the new ui item
    toolbarPanel_ = toolbarPanels_.itemById(&#39;SketchCreatePanel&#39;) 
    toolbarControlsPanel_ = toolbarPanel_.controls
# etc</pre>
<p>You can easily find the list of all <strong>workspaces</strong> and <strong>toolbarPanels</strong> available using a simple <strong>python</strong> script like this:</p>
<pre>def listUIParts():
    try:
        global app, ui
        app = adsk.core.Application.get()
        ui = app.userInterface
        
        fileDialog = ui.createFileDialog()
        fileDialog.isMultiSelectEnabled = False
        fileDialog.title = &quot;Select file to save the information to&quot;
        fileDialog.filter = &#39;Text files (*.txt)&#39;
        fileDialog.filterIndex = 0
        dialogResult = fileDialog.showSave()
        
        if dialogResult == adsk.core.DialogResults.DialogOK:
            filename = fileDialog.filename
        else:
            return

        result = &#39;&#39;
        for ws in ui.workspaces:
            result += &#39;workspace name: &#39; + ws.name + &#39;, id: &#39; + ws.id + &#39;\n&#39;
            
            try:
                for tb in ws.toolbarPanels:
                    result += &#39;  toolbarPanel name: &#39; + tb.name + &#39;, id: &#39; + tb.id + &#39;\n&#39;
            except:
                result += &#39;  toolbarPanels not available\n&#39;
                
        with open(filename, &#39;w&#39;) as outputFile:        
            outputFile.writelines(result)
  
    except:
        if ui:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc())) </pre>
<p>For convenience, here is the text file with the result of the above code: <span class="asset  asset-generic at-xid-6a00e553fcbfc68834022ad3c7c6c4200b img-responsive"><a href="https://modthemachine.typepad.com/files/uielements.txt">UIelements.txt</a></span></p>
<p>- Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Troubleshooting, debugging
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: troubleshooting-debugging
CATEGORY: Adam
CATEGORY: iLogic
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/10/troubleshooting-debugging.html 
DATE: 10/29/2018 01:38:19 PM
-----
BODY:
<p>Sometimes we get code samples with hundreds of lines of code in <strong>iLogic</strong> where the last part fails. Even if it&#39;s not <strong>iLogic</strong>, it&#39;s still better to narrow down things to the specific function that is not working and create a test that focuses on it.</p>
<p>This will make it much easier for others to help you (e.g. on the forum) and might enable you to spot the issue with your code (if it&#39;s not a problem with the <strong>API</strong> itself)</p>
<p>For example, if your code is creating all the geometry that you want to add a feature to and that last bit fails for some reason, then <br />- remove the feature creation you have problems with<br />- run the rest of the code to create the geometry that the feature needs<br />- save that part/assembly and create a function that focuses on the feature that you&#39;re having problems with creating<br /><br />The best is to do that in a programming environment that allows you to step through code and investigate the variables you are using. The simplest way for everyone to run your code in is&#0160;<strong>VBA</strong> - if you create a <strong>.NET</strong> project (whether <strong>add-in</strong> or <strong>stand-alone app</strong>) not everyone has <strong>Visual Studio</strong> installed to run it, and if it&#39;s <strong>iLogic</strong> then you have limited debugging options.</p>
<p>Let&#39;s say we run into issues with <strong>KnitFeatures.Add()</strong> when running this sample code:&#0160;<a href="https://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-0A0F1E4A-FC5E-4241-8E1C-C0A617C47554">Adding a new stitch (knit) feature API Sample</a>&#0160;</p>
<p>I can just remove the last part about creating the <strong>KnitFeature</strong> object and run it:</p>
<p><a class="asset-img-link" href="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad37581d6200c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="KnitFeature" class="asset  asset-image at-xid-6a00e553fcbfc68834022ad37581d6200c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad37581d6200c-500wi" title="KnitFeature" /></a><a class="asset-img-link" href="https://a4.typepad.com/6a0112791b8fe628a4022ad3bb3a44200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><br /></a></p>
<p>Now I have the geometry that the creation of the last feature needs, and can move the last part of the code into a separate <strong>VBA</strong> method that would only run the code that creates the <strong>KnitFeature</strong>:</p>
<pre>Sub StitchFeatureCreate_Test()
    Dim oPartDoc As PartDocument
    Set oPartDoc = ThisApplication.ActiveDocument

    Dim oCompDef As PartComponentDefinition
    Set oCompDef = oPartDoc.ComponentDefinition
    
    Dim oSurfaces As ObjectCollection
    Set oSurfaces = ThisApplication.TransientObjects.CreateObjectCollection
    
    oSurfaces.Add oCompDef.WorkSurfaces.Item(1)
    oSurfaces.Add oCompDef.WorkSurfaces.Item(2)
    
    Dim oKnitFeature As KnitFeature
    Set oKnitFeature = oCompDef.Features.KnitFeatures.Add(oSurfaces)
End Sub</pre>
<p>As discussed in <a href="https://adndevblog.typepad.com/manufacturing/2013/10/discover-object-model.html">this blog post</a>, this way you can also examine the various objects you are using - you might e.g. realize that you are trying to pass in the wrong objects to the function, or some parameters are not correct.</p>
<p>If you happened to find an issue with the <strong>API</strong> then it will make it much easier for us to verify the problem on our side :)&#0160;</p>
<p>When it comes to debugging <strong>iLogic</strong> code, this might come handy too:&#0160;<br /><a href="https://adndevblog.typepad.com/manufacturing/2014/08/debug-ilogic.html">https://adndevblog.typepad.com/manufacturing/2014/08/debug-ilogic.html</a></p>
<p>-Adam</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: AU Early Bird registration ending soon...
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-early-bird-ending-soon
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/10/au-early-bird-ending-soon.html 
DATE: 10/02/2018 11:38:28 AM
-----
BODY:
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad3b56426200b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Devcon" class="asset  asset-image at-xid-6a00e553fcbfc68834022ad3b56426200b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834022ad3b56426200b-320wi" title="Devcon" /></a></p>
<p>If you want to learn about all the new things we are working on then <strong>DevCon &amp; AU Las Vegas</strong>&#0160;are probably the best places for that.</p>
<p>Here is one class not to miss if you are writing <strong>Inventor</strong> <strong>add-ins</strong> and thinking of venturing into the cloud:<br /><a href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=225601">SD225601 - Bringing your Inventor Add-in into Forge Design Automation</a></p>
<p>I will also have a presentation on getting started with <strong>Next Generation Forge</strong> technologies:<br /><a href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=231764">FDC231764 - My First Forge Data Platform and Forge Services Application</a></p>
<p>Here you can register for both <strong>AU</strong> and <strong>DevCon</strong>:<br /><a href="https://forge.autodesk.com/devcon-2018#tickets">https://forge.autodesk.com/devcon-2018#tickets</a></p>
<p>Please note that <strong>AU Early Bird</strong> registration is ending on <strong>15th October</strong>!</p>
<p>Hope to see you there! :)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: "The installation failed" for app store plug-ins 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: the-installation-failed-for-app-store-plug-ins
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/04/the-installation-failed-for-app-store-plug-ins.html 
DATE: 04/04/2018 10:24:18 PM
-----
BODY:
<p>When installing a <strong>Fusion 360</strong> app from the <a href="https://apps.autodesk.com/FUSION/en/Home/Index">Autodesk App Store</a>, the installer simply copies the so called <strong>bundle</strong> (hence the <strong>.bundle</strong> extension on the folder) into the appropriate &quot;<strong>ApplicationPlugins</strong>&quot; folder - the location depends on where you installed <strong>Fusion 360</strong> from:</p>
<ul>
<li><strong>Fusion 360</strong> installed from the&#0160;<strong>Autodesk web site</strong>: ~/Library/Application Support/Autodesk/<strong>ApplicationPlugins</strong></li>
<li><strong>Fusion 360</strong> installed from the <strong>Mac App Store</strong>: ~/Library/Containers/com.autodesk.mas.fusion360/Data/Library/Application Support/Autodesk/<strong>ApplicationPlugins</strong></li>
</ul>
<p>For some reason, you may have the access rights for the folder set to &quot;<strong>Read only</strong>&quot;, and so the installer cannot write into it:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2c6ff66970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ReadOnly" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d2c6ff66970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2c6ff66970c-320wi" title="ReadOnly" /></a></p>
<p>And that can cause the installation to fail:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2c6feb5970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="InstallationFailed" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d2c6feb5970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2c6feb5970c-320wi" title="InstallationFailed" /></a></p>
<p>You can simply <strong>right-click</strong> on the correct &quot;<strong>ApplicationPlugins</strong>&quot; folder, select &quot;<strong>Get Info</strong>&quot; and provide &quot;<strong>Read &amp; Write</strong>&quot; in the &quot;<strong>Privilege</strong>&quot; column for your account.</p>
<p>Hopefully, that should solve the issue.</p>
<p><strong>If that does not help</strong>, then you could follow these steps:</p>
<p>1) Get an app that can read <strong>pkg</strong> files, like&#0160;<a href="http://www.mothersruin.com/software/SuspiciousPackage/">http://www.mothersruin.com/software/SuspiciousPackage/</a></p>
<p>2) In that program, open the <strong>pkg</strong> file that you downloaded from the <strong>Autodesk App Store</strong></p>
<p>3) Select the <strong>.bundle</strong> folder, click &quot;<strong>Export</strong>&quot; and navigate to the appropriate &quot;<strong>ApplicationPlugins</strong>&quot; folder:</p>
<ul>
<li><strong>Fusion 360</strong> installed from the&#0160;<strong>Autodesk web site</strong>: ~/Library/Application Support/Autodesk/<strong>ApplicationPlugins</strong></li>
<li><strong>Fusion 360</strong> installed from the <strong>Mac App Store</strong>: ~/Library/Containers/com.autodesk.mas.fusion360/Data/Library/Application Support/Autodesk/<strong>ApplicationPlugins</strong></li>
</ul>
<p><a class="asset-img-link" href="http://a0.typepad.com/6a0112791b8fe628a401b7c95dfed0970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Bundle_export" class="asset  asset-image at-xid-6a0112791b8fe628a401b7c95dfed0970b img-responsive" src="https://a0.typepad.com/6a0112791b8fe628a401b7c95dfed0970b-500wi" title="Bundle_export" /></a></p>
<p>4) Then click &quot;<strong>Save</strong>&quot;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2e83dd9970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Bundle_save" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d2e83dd9970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2e83dd9970c-500wi" title="Bundle_save" /></a></p>
<p>Once you restart <strong>Fusion 360</strong>, it should now be able to find and load the <strong>add-in</strong>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Goodbye and Hello
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: goodbye-and-hello

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2018/03/goodbye-and-hello.html 
DATE: 03/09/2018 08:02:56 PM
-----
BODY:
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2dff3ec970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false"><img alt="GoodbyeAndWelcome" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d2dff3ec970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2dff3ec970c-500wi" style="display: block; margin-left: auto; margin-right: auto;" title="GoodbyeAndWelcome" /></a><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2dff3d4970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><br /></a></p>
<p>There have been some big changes recently, and I am no longer working for Autodesk.&#0160; As a result, I want to say goodbye because this will be my last post on Mod the Machine.&#0160; This blog started with my first post almost 10 years ago on August 21, 2008.&#0160; The time has flown since then and I appreciate all the kinds words I&#39;ve gotten from many of you.</p>
<p>I want to say hello because I&#39;m not leaving the CAD world but have started my own consulting and contracting company called <strong><a href="https://ekinssolutions.com/">Ekins Solutions</a></strong>.&#0160; I&#39;m starting my own blog that will continue what Mod the Machine has started. I&#39;ll be creating new content but also updating and re-posting some of my content from Mod the Machine.&#0160; I&#39;m hoping that as an Inventor or Fusion 360 user that it will become one of the places to go for programming help.&#0160; Since it&#39;s my own website it also gives me more control and will allow me a better and easier way to provide some of the utilities I&#39;ve written in the past like <strong>Attribute Manager,</strong> <strong>Sheet Metal Extents</strong>, and <strong>Facet Enabler</strong>. Watch for more utilities to be posted soon, both for Inventor and Fusion 360.</p>
<p>Since I&#39;m my own boss now and can decide for myself what do, it frees me up to provide additional kinds of support that I wasn&#39;t able to do before.&#0160; For example, I&#39;ve been asked to teach API training classes, to go on-site to help with projects, and to write custom software.&#0160; All things that I enjoy doing and would have loved to do but they didn&#39;t fall within my job responsibilities while working at Autodesk and I had to say no.&#0160; I&#39;m hoping those needs are still out there because I&#39;m available now.</p>
<p>Youâ€™ll find my blog, utilities, services, and contact info on my new website at <a href="https://ekinssolutions.com/">EkinsSolutions.com</a>.&#0160; Best of luck to all of you in your endeavors with CAD and in your personal lives.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Johan Gunnar
EMAIL: johan.gunnar@cadcraft.se
IP: 37.196.156.105
URL: http://www.cadcraft.se
DATE: 03/10/2018 11:07:03 AM
Goodbye- see you in 
thanks for all tips and trix

-----
COMMENT:
AUTHOR: AlexFielder
EMAIL: 
IP: 86.10.37.197
URL: http://profile.typepad.com/alexfielder
DATE: 03/12/2018 08:06:41 PM
Goodbye and Thanks for the inspiration/many tips over the years Brian, I look forward to seeing what you conjure up in your new venture. :)
-----
COMMENT:
AUTHOR: MIKEJONESPE
EMAIL: 
IP: 12.205.8.154
URL: http://profile.typepad.com/mikejonespe
DATE: 03/20/2018 05:49:41 PM
Good luck and best wishes in your new endeavour.

Your posts have always been helpful and educational.


-----
COMMENT:
AUTHOR: Tony
EMAIL: ajsmith1968@gmail.com
IP: 14.203.236.108
URL: 
DATE: 04/15/2018 01:40:35 PM
Here's an idea for your new blog, do this properly: <a href="http://modthemachine.typepad.com/my_weblog/2017/05/controlling-points-in-a-sketch-using-parameters.html">http://modthemachine.typepad.com/my_weblog/2017/05/controlling-points-in-a-sketch-using-parameters.html</a>

Setting dimensions doesn't work as it doesn't constrain the angles the splines are drawn at.  That is you can still use the grab handles to swing the arcs around, and that's exactly what Fusion 360 does when you try to scale stuff.

The end points don't move, but you don't get the curve you were expecting.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Still time to register for Forge DevCon!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: still-time-to-register-for-forge-devcon
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/10/still-time-to-register-for-forge-devcon.html 
DATE: 10/21/2017 10:34:18 AM
-----
BODY:
<div>If you havenâ€™t registered yet for <strong>Forge</strong>&#0160;<strong>DevCon</strong> itâ€™s still not too late. If you are coming to <strong>AU</strong> anyway, then just for an extra <strong>$95</strong> you will be able to attend this event happening on the <strong>Monday</strong> just before <strong>AU</strong>.</div>
<div>&#0160;</div>
<div>Here are the ways to get access to the event:</div>
<div><a href="https://forge.autodesk.com/blog/ways-get-forge-devcon-pass">https://forge.autodesk.com/blog/ways-get-forge-devcon-pass</a></div>
<div>&#0160;</div>
<div><strong>Forge DevCon</strong> will have manufacturing related presentations as well, as mentioned in this <strong>Forge</strong> blog post:</div>
<div><a href="https://forge.autodesk.com/blog/forge-devcon-fusion-users">https://forge.autodesk.com/blog/forge-devcon-fusion-users</a></div>
<div>&#0160;</div>
<div>I will also have a <strong>Fusion 360</strong> related presentation that will show you how <strong>Forge</strong> can help <strong>Fusion 360</strong> users and developers:</div>
<div><a class="openInPopup" href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=129788&amp;tclass=popup"><span class="abbreviation">FDC129788 -&#0160;</span><span class="title">Streamline Fusion 360 processes with Forge</span></a></div>
<div>&#0160;</div>
<div>In my other class I will co-present with <strong>Monmohan</strong> from&#0160;<strong>Forge</strong> <strong>Engineering</strong> team on the use of <strong>Webhooks</strong> and how they can help you make your application or service work seamlessly with <strong>Forge</strong>:<br /><a class="openInPopup" href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=122160&amp;tclass=popup"><span class="abbreviation">FDC122160 -&#0160;</span><span class="title">Seamless integration with Forge Webhooks</span></a></div>
<div>&#0160;</div>
<div>If you stay for <strong>AU</strong> as well then do check out <strong>Brian</strong>&#39;s classes:</div>
<div><a class="openInPopup" href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=125452&amp;tclass=popup"><span class="abbreviation">SD125452 -&#0160;</span><span class="title">Having Fun Using Components, Occurrences, Matrices, and Proxies with Inventor Softwareâ€™s API</span></a></div>
<div>&#0160;</div>
<div><a class="openInPopup" href="https://autodeskuniversity.smarteventscloud.com/connect/sessionDetail.ww?SESSION_ID=125353&amp;tclass=popup"><span class="abbreviation">SD125353 -&#0160;</span><span class="title">Components, Components, Components: An In-Depth Look at the Internals of Fusion 360</span></a></div>
<div>&#0160; &#0160;</div>
<div>See you there! :)</div>
<div>&#0160;</div>
<div>-Adam</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Forge DevCon at AU Las Vegas
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-devcon-at-au-las-vegas
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/09/forge-devcon-at-au-las-vegas.html 
DATE: 09/12/2017 10:01:31 PM
-----
BODY:
<p>We mentioned it before that this year around our <a href="https://forge.autodesk.com/devcon-2017">Forge Developer Conference</a> will be held together with <a href="http://au.autodesk.com/las-vegas/overview">Autodesk University Las Vegas</a></p>
<p>It&#39;s a great opportunity for users and developers to come together and find ways to use <a href="https://forge.autodesk.com">Forge</a> to streamline processes :) &#0160;</p>
<p>If you need a bit more convincing to register, then please read Stephen&#39;s post:<br /><a href="https://forge.autodesk.com/blog/developing-autodesk-desktop-software-heres-why-you-should-care-about-forge-devcon-and-autodesk">https://forge.autodesk.com/blog/developing-autodesk-desktop-software-heres-why-you-should-care-about-forge-devcon-and-autodesk</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c91f72f9970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ForgeDevCon" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c91f72f9970b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c91f72f9970b-320wi" title="ForgeDevCon" /></a></p>
<p>Also, don&#39;t forget that the&#0160;<strong>AU Early Bird Discount</strong> expires on <strong>October 16<sup>th</sup></strong>. Thatâ€™s a <strong>$425</strong> saving for <strong>AU</strong>!</p>
<p>-Adam</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: New Fusion 360 Update and an Announcement
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: new-fusion-360-update-and-an-announcement
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/06/new-fusion-360-update-and-an-announcement.html 
DATE: 06/22/2017 09:51:49 PM
-----
BODY:
<p>This week a new Fusion 360 update went out.&#0160; There are a few API related enhancements in this update and one big <span style="background-color: #ffff00;">announcement</span>.</p>
<h4><strong>Enhancements</strong></h4>
<ul>
<li><strong>User Specified Program Path </strong>- You can now specify the location where Fusion will look for existing scripts and add-ins and where new scripts and add-ins will be created. You do this using a new setting in the Preferences dialog, as shown below. The default path was deep and in a system folder. With this you can choose the location of your programs. This path is not saved as part of your cloud preferences but is a local preference. This allows you to have a different path on different computers.<br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c904ee87970b-pi"><img alt="ScriptPath" border="0" height="180" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a814e9970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="ScriptPath" width="570" /></a><br />A big benefit of being able to choose your script and add-in location is that this can be a folder that is synced to the cloud using any of the available file syncing services.<br />
<p>&#0160;</p>
</li>
<li>
<p><strong>Change in Adding Script or Add-In </strong>- A small change has been made to how you add a script or add-in to the list of known scripts and add-ins. The &quot;Scripts and Add-Ins&quot; dialog allows you to select a script or add-in anywhere on your computer and Fusion 360 will remember it after that. You do that by using the green &quot;+&quot; button on the &quot;Scripts and Add-In&quot; dialog, as shown below. This also helps to resolve a security issue on Mac where selecting just the file didn&#39;t provide access to the other files in the folder. Selecting a folder provides access to its entire contents.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c904ee8b970b-pi"><img alt="AddScript" border="0" height="212" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c904ee8f970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="AddScript" width="290" /></a></p>
<p>Clicking the green plus will display a browse dialog where you can browse to and select the script or add-in. The change is that previously you had to pick the file that represented the script or add-in. This tended to be confusing because these files will have different file extensions depending on which language the script or add-in was written and it was possible that there could be multiple code files that the main file depended on. The change is that you no longer select the file but now choose the folder that contains all of the files of the script or add-in.</p>
<p>&#0160;</p>
</li>
<li><strong>Change to ModelParameter.createdBy property</strong> - The createdBy property of the ModelParameter object was changed in the previous update so that it will return the object that caused the parameter to be created. There are cases where the creating object isn&#39;t currently supported by the API so the createdBy property doesn&#39;t have anything to return. In the last update, when this occurs it results in an exception. This has been changed in this update to that the property returns null instead.</li>
<li><strong>Clearing a List</strong> - A problem was reported on the forum quite a while ago regarding being able to empty the list associated with a DropDownCommandInput. This has been resolved in this update with the addition of the clear method to the ListItems object.</li>
<li><strong>Additional Feature Support</strong> - Support for copying or cutting and pasting a body is now supported through the API. Basic query support it now also available for the offset face feature (which is created in the UI using the &quot;Press Pull&quot; command).</li>
<li><strong>External References</strong> - Additional functionality related to external references has been added to the API.</li>
</ul>
<p>The full list of changes can be found on the <a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-36B1FFB5-5291-4532-8F11-90E912769B34">Whatâ€™s New page of the Fusion API help</a>.</p>
<p>&#0160;</p>
<h4><strong>Announcement</strong></h4>
<p>The Fusion 360 product team constantly monitors analytics data to get information about how Fusion 360 is being used to help make decisions about where to focus resources for future development. This information is also useful in identifying areas of Fusion 360 that have very little usage. In some cases these areas are retired in order to focus resources on the portions of the product that will benefit the most people. One area that has been identified as have very little usage is the JavaScript API interface. <span style="background-color: #ffff00;">With the upcoming July 24th update, Fusion 360 will be moving the JavaScript API interface into maintenance mode.</span></p>
<p>&quot;Maintenance mode&quot; in this case means that documentation for the JavaScript API will be removed from the online help and the capability to create new JavaScript scripts and add-ins will be removed from the Scripts and Add-Ins dialog. However, the actual JavaScript interface will continue to be delivered, but without any new enhancements, to allow any existing JavaScript scripts and add-ins to continue to run and be used and they will still appear in the Scripts and Add-Ins dialog so they can be run.</p>
<p>This was a difficult decision to make and we understand it is not good news if you&#39;ve been using the JavaScript API. It takes continued resources from the Fusion 360 team to create, test, document, and support any API and based on usage numbers there are very few users using JavaScript to program Fusion 360. So, the decision was made to move it into maintenance mode and concentrate our efforts on the Python and C++ interfaces.</p>
<p>As mentioned above, existing programs will continue to run as they do today. It&#39;s possible the JavaScript API will be retired and completely removed from Fusion 360 at some point in the future but that has not yet been determined. You&#39;re encouraged to re-write your existing programs in Python or C++. Please feel free to contact us at <a href="mailto:fusion.apps@autodesk.com&amp;subject=Fusion 360 JavaScript Retirement">fusion.apps@autodesk.com</a> with your concerns and comments.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: patrick
EMAIL: patrickjef2018@gmail.com
IP: 41.89.64.58
URL: http://uonlibrary.uonbi.ac.ke/
DATE: 06/30/2017 11:46:43 AM
Thanks for sharing 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Use ChromiumWebBrowser from Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: use-chromiumwebbrowser-from-inventor
CATEGORY: Adam
CATEGORY: C#
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/06/use-chromiumwebbrowser-from-inventor.html 
DATE: 06/16/2017 02:32:06 PM
-----
BODY:
<p><strong>ChromiumWebBrowser</strong> enables you to have a browser component in your app with <strong>Chrome</strong> capabilities. It requires an external process as well called&#0160;<strong>CefSharp.BrowserSubprocess.exe</strong>, which is generated as part of your output by the&#0160;<strong>CefSharp.WinForms NuGet</strong> component that you need to add to your project.</p>
<p>In case of having a <strong>standalone application</strong> the default settings are good enough because all the components will be created in the same output path next to your <strong>project&#39;s exe</strong>. However, in case of an <strong>Inventor</strong> <strong>add-in</strong> (or any other add-in for that matter) the add-in files will be located somewhere other than the <strong>main exe</strong> (in this case <strong>Inventor.exe</strong>), so you need to adjust the&#0160;<strong>CefSettings</strong> accordingly.</p>
<pre>private void InitializeChromium()
{
    CefSettings settings = new CefSettings();
    // Get the folder path of the add-in dll
    string assemblyFolder = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    settings.BrowserSubprocessPath = Path.Combine(assemblyFolder, &quot;CefSharp.BrowserSubprocess.exe&quot;);
    Cef.Initialize(settings);

    ChromeWebBrowser = new ChromiumWebBrowser(&quot;http://www.google.com&quot;);
    ChromeWebBrowser.LoadError += ChromeWebBrowser_LoadError;

    this.Controls.Add(ChromeWebBrowser);
    ChromeWebBrowser.Dock = DockStyle.Fill;
}</pre>
<p>In this case you&#39;ll see that the sub-process gets started successfully:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28d4dd7970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ChromiumBackgroundProcess" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d28d4dd7970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28d4dd7970c-500wi" title="ChromiumBackgroundProcess" /></a></p>
<p>And the <strong>Chromium</strong> browser component seems to work fine:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a6289c970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="InventorChromium" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb09a6289c970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a6289c970d-500wi" title="InventorChromium" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Gavinbath
EMAIL: 
IP: 210.54.34.48
URL: http://profile.typepad.com/gavinbath
DATE: 06/16/2017 08:30:16 PM
You legend! Thank you very much. I actually ditched CefSharp last night and got it working with ChromiumFx. I had exactly the same problem and only found info on the BrowserSubProcess requirement really late. I didn't realize it was the same in CefSharp. I prefer CefSharp so I think I'll go back to it. Thanks again for figuring this out!
Gavin 
-----
COMMENT:
AUTHOR: Einladungs Vorlagen
EMAIL: bm@gmail.com
IP: 115.178.202.45
URL: https://naturismusbilder.com/
DATE: 10/20/2017 08:07:49 AM
good
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Getting the Overall Size of Parts
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: getting-the-overall-size-of-parts
CATEGORY: Brian
CATEGORY: Fusion 360
CATEGORY: Inventor
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/06/getting-the-overall-size-of-parts.html 
DATE: 06/06/2017 09:12:02 PM
-----
BODY:
<p>The question of getting the size of a part frequently comes up and I wanted to spend some time discussing the existing functionality and other options. The discussion here applies to both Fusion 360 and Inventor (and probably most other CAD systems).</p>
<p><span style="font-size: large;"><strong>What is a Bounding Box?<br /></strong></span>The easiest way to get a size of a part is to get the bounding box (also called the range box) of the object.&#0160; Letâ€™s look at what a bounding box is by looking at some simple 2D examples first.&#0160; A 2D bounding box is a rectangle that encompasses the object. Below is an example of a part (the shaded area) and itâ€™s bounding rectangle (dashed lines).&#0160; If we measured the size of this box I think we would all agree that it looks like an accurate measure of the overall size of the part.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d49970c-pi"><img alt="Range1" border="0" height="238" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8ffe955970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Range1" width="318" /></a></p>
<p>&#0160;</p>
<p>A typical bounding box is defined using just two points; the minimum and maximum points.&#0160; The picture below shows the two 2D points used to define the bounding box. A limitation with defining a bounding box in this way is that the rectangle is oriented such that itâ€™s edges are always parallel to the x and y model axes.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d4e970c-pi"><img alt="Range2" border="0" height="224" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d52970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Range2" width="293" /></a></p>
<p>&#0160;</p>
<p>Below is the same part that has been rotated and its bounding box is displayed. In this case the size of the bounding box probably isnâ€™t what you wanted and in most cases is not particularly usefu<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8ffef4c970b-pi">l</a>.<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a2fd9b970d-pi"><img alt="range3" border="0" height="300" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8ffe95a970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="range3" width="304" /></a></p>
<p>What you probably really wanted was this bounding box but that box canâ€™t be defined by a simple two points and needs additional information to define the orientation.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a2f82d970d-pi"><img alt="Range4" border="0" height="341" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d5a970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Range4" width="349" /></a></p>
<p>Bounding boxes arenâ€™t something specific to the Inventor and Fusion 360 APIâ€™s but are a basic concept in computer graphics. The usual intent of a bounding box is not to provide a tight fitting, orientated box around a part but instead to provide a very fast box that fits around a certain piece of geometry. The only thing guaranteed is that the object is completely contained within the box and there is no guarantee about how tight the box fits around the object. In many cases, like in the first example, the size of the range box is the same as the physical size of the part but there are cases when this is not the case. Below, on the left, is an example from Inventor where the bounding box is quite a bit larger than the visible part. At first glance this would seem to be a bug in the calculation but the bounding box is including the control polygon of the spline surface, as shown on the right. So it may not be what you want but it is arguably correct and is the simplest for Inventor to calculate.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d5e970c-pi"><img alt="range5" border="0" height="351" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a2f832970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="range5" width="414" /></a></p>
<p>Bounding boxes are intended to be used in more complex operations where you need to first determine if a particular object should be considered in a calculation. To determine if an object should be included you can often use itâ€™s bounding box to see if itâ€™s within the area to be calculated. This is a very simple and fast calculation that can be performed to determine if the object can be eliminated from the more complicated and costly computations.&#0160; Operations with bounding boxes like this are also very simple.&#0160; For example you can combine bounding boxes to create a new box that contains the originals.</p>
<p>The Inventor API has the Box and Box2d objects that are used to pass back the bounding box information and these objects also provide properties and methods to let you work with the box information.&#0160; The Fusion 360 API has the BoundingBox3D and BoundingBox2D objects that provide the equivalent functionality.&#0160; The most important feature of these objects is that they return the coordinates of the min and max points.</p>
<p><span style="font-size: large;"><strong>Getting Accurate Bounding Boxes</strong></span><br />As discussed above, the bounding box returned by the Inventor RangeBox property and returned by the Fusion360 boundingBox property may not be what you need.&#0160; Unfortunately, a bounding box that is always tight fitting to the visible graphics is not currently provided by either Inventor or Fusion 360. However, it is possible to calculate a very close approximation on your own using other API functionality. What Iâ€™m going to show you here will create a tight range box but it will still be oriented so itâ€™s parallel to the world XYZ planes. The ability to automatically calculate a bounding box that is oriented to get the tightest fitting box possible is a very difficult problem that I havenâ€™t seen a solution to. Itâ€™s something you could probably write a PhD paper on. The easiest approach to the orientation problem is to ask the user for help by lettin them define the coordinate system the bounding box should be calculated in, essentially defining the directions for the length, width and height. Thatâ€™s possible but a little more than I wanted to go into in this post so Iâ€™ll limit this discussion to calculating a tight fitting bounding box thatâ€™s oriented parallel to the world XYZ planes.</p>
<p>To do this you can use a triangular mesh representation of the model and calculate your own bounding box by including all of the vertices of the mesh. The result will be as accurate as the mesh. In both Inventor and Fusion 360 you can calculate a mesh representation to any tolerance you want or you can get the existing mesh that Inventor or Fusion 360 is using for the display of the model.&#0160; The actual model is made up of accurate smooth surfaces, but a mesh representation is created and used internally to display the model. Using the existing mesh is faster that calculating a new one but if accuracy is critical you might want to calculate a new mesh. The shape of the model will also affect the accuracy. A model made up entirely of planes will result in an exact mesh representation regardless of the tolerance of the mesh because the triangles exactly represent those faces.&#0160; If a model has any curved surfaces, even as simple as a cylinder, then the mesh is an approximation.&#0160; Iâ€™ve tried to illustrate this in the picture below.&#0160; On the left are the original models where one model is made entirely of planes and the other has planes, cylinders, and a sphere.&#0160; On the right is the triangular mesh representations of the two parts.&#0160; The first model is an exact representation because the shape can be exactly represented by the triangles.&#0160; However, the second model has curved surfaces and has to be approximated by the triangles.&#0160; The accuracy of the bounding box you build will depend on their being a triangle vertex at the minimum and maximum X, Y, and Z sizes of the model.&#0160; The more triangles, the more likely youâ€™ll have vertices at those locations but it also means more processing for Inventor or Fusion to calculate the mesh and more processing for you to analyze the mesh to build the range box.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a2f836970d-pi"><img alt="MeshExample" border="0" height="302" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09a2f83a970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="MeshExample" width="974" /></a></p>
<p>&#0160;</p>
<p>Iâ€™ve used the code similar to that below in a few programs Iâ€™ve posted previously. The calculateTightBoundingBox function takes in a body and optional tolerance and returns the tight fitting bounding box.&#0160; If no tolerance is provided, the existing display mesh is used. There can be more than one display mesh because Inventor and Fusion will generate different meshes depending on how close you zoom into the model so the display always appears smooth. When using the display mesh, this function will use the highest quality display mesh that exists. If a tolerance is provided, then a new mesh is calculated using that tolerance. There is a test function for each that is used to test the calculateTightBoundingBox function.&#0160; Samples below are provided in Python for Fusion 360 and VBA and Visual Basic for Inventor.&#0160; Below is the result on the previous model where the bounding box returned by Inventor was much larger.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d63970c-pi"><img alt="NewRange" border="0" height="387" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28a0d67970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="NewRange" width="493" /></a></p>
<p><span style="font-size: large;"><strong>Fusion 360 Python</strong></span></p>
<pre><span style="color: #0000ff;"># Function to test the calculateTightBoundingBox function.<br /></span>def run(context):<br />&#0160;&#0160;&#0160; ui = None <br />&#0160;&#0160;&#0160; try:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; app = adsk.core.Application.get()<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ui = app.userInterface<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; des = adsk.fusion.Design.cast(app.activeProduct)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bodySelect = ui.selectEntity(&#39;Select the body.&#39;, &#39;Bodies&#39;)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; body = adsk.fusion.BRepBody.cast(bodySelect.entity)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Call the function to get the tight bounding box.<br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bndBox= calculateTightBoundingBox(body)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Draw the bounding box using a sketch.<br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sk = des.rootComponent.sketches.add(des.rootComponent.xYConstructionPlane)&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines = sk.sketchCurves.sketchLines<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; minXYZ = bndBox.minPoint<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; minXYmaxZ = adsk.core.Point3D.create(bndBox.minPoint.x, bndBox.minPoint.y, bndBox.maxPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; minXmaxYZ = adsk.core.Point3D.create(bndBox.minPoint.x, bndBox.maxPoint.y, bndBox.maxPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; minXZmaxY = adsk.core.Point3D.create(bndBox.minPoint.x, bndBox.maxPoint.y, bndBox.minPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; maxXYZ = bndBox.maxPoint<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; maxXYminZ = adsk.core.Point3D.create(bndBox.maxPoint.x, bndBox.maxPoint.y, bndBox.minPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; maxXZminY = adsk.core.Point3D.create(bndBox.maxPoint.x, bndBox.minPoint.y, bndBox.maxPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; maxXminYZ = adsk.core.Point3D.create(bndBox.maxPoint.x, bndBox.minPoint.y, bndBox.minPoint.z)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXYZ, minXYmaxZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXYZ, minXZmaxY)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXZmaxY, minXmaxYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXYmaxZ, minXmaxYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(maxXYZ, maxXYminZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(maxXYZ, maxXZminY)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(maxXYminZ, maxXminYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(maxXZminY, maxXminYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXYZ, maxXminYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXYmaxZ, maxXZminY)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXmaxYZ, maxXYZ)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lines.addByTwoPoints(minXZmaxY, maxXYminZ) <br />&#0160;&#0160;&#0160; except:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if ui:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))</pre>
<p><br /><span style="color: #0000ff;"># Calculates a tight bounding box around the input body.&#0160; An optional<br /># tolerance argument is available.&#0160; This specificies the tolerance in <br /># centimeters.&#0160; If not provided the best existing display mesh is used.</span><br />def calculateTightBoundingBox(body, tolerance = 0):<br />&#0160;&#0160;&#0160; try:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># If the tolerance is zero, use the best display mesh available.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if tolerance &lt;= 0:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Get the best display mesh available.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; triMesh = body.meshManager.displayMeshes.bestMesh<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; else:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Calculate a new mesh based on the input tolerance.<br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; meshMgr = adsk.fusion.MeshManager.cast(body.meshManager)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; meshCalc = meshMgr.createMeshCalculator()<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; meshCalc.surfaceTolerance = tolerance<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; triMesh = meshCalc.calculate()<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Calculate the range of the mesh.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt = adsk.core.Point3D.cast(triMesh.nodeCoordinates[0])<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt = adsk.core.Point3D.cast(triMesh.nodeCoordinates[0])<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertex = adsk.core.Point3D.cast(None)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; for vertex in triMesh.nodeCoordinates:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.x &lt; smallPnt.x:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.x = vertex.x<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.y &lt; smallPnt.y:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.y = vertex.y<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.z &lt; smallPnt.z:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.z = vertex.z<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.x &gt; largePnt.x:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.x = vertex.x<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.y &gt; largePnt.y:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.y = vertex.y<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if vertex.z &gt; largePnt.z:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.z = vertex.z <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># Create and return a BoundingBox3D as the result.<br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; return(adsk.core.BoundingBox3D.create(smallPnt, largePnt))<br />&#0160;&#0160;&#0160; except:<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"># An error occurred so return None.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; return(None)</p>
<p>&#0160;</p>
<p><span style="font-size: large;"><strong>Inventor VBA</strong></span></p>
<pre>Public Sub TestTightBoundingBox()<br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Have a body selected.<br /></span>&#0160;&#0160;&#0160; Dim body As SurfaceBody<br />&#0160;&#0160;&#0160; Set body = ThisApplication.CommandManager.Pick(kPartBodyFilter, &quot;Select the body.&quot;)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Call the function to get the tight bounding box.<br /></span>&#0160;&#0160;&#0160; Dim bndBox As Box<br />&#0160;&#0160;&#0160; Set bndBox = calculateTightBoundingBox(body)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Draw the bounding box using a 3D sketch.</span><br />&#0160;&#0160;&#0160; Dim partDoc As PartDocument<br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument<br />&#0160;&#0160;&#0160; Dim sk As Sketch3D<br />&#0160;&#0160;&#0160; Set sk = partDoc.ComponentDefinition.Sketches3D.Add()<br />&#0160;&#0160;&#0160; Dim lines As SketchLines3D<br />&#0160;&#0160;&#0160; Set lines = sk.SketchLines3D<br /><br />&#0160;&#0160;&#0160; Dim tg As TransientGeometry<br />&#0160;&#0160;&#0160; Set tg = ThisApplication.TransientGeometry<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim minXYZ As Point<br />&#0160;&#0160;&#0160; Dim minXYmaxZ As Point<br />&#0160;&#0160;&#0160; Dim minXmaxYZ As Point<br />&#0160;&#0160;&#0160; Dim minXZmaxY As Point<br />&#0160;&#0160;&#0160; Set minXYZ = bndBox.MinPoint<br />&#0160;&#0160;&#0160; Set minXYmaxZ = tg.CreatePoint(bndBox.MinPoint.x, bndBox.MinPoint.y, bndBox.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set minXmaxYZ = tg.CreatePoint(bndBox.MinPoint.x, bndBox.MaxPoint.y, bndBox.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set minXZmaxY = tg.CreatePoint(bndBox.MinPoint.x, bndBox.MaxPoint.y, bndBox.MinPoint.Z)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim maxXYZ As Point<br />&#0160;&#0160;&#0160; Dim maxXYminZ As Point<br />&#0160;&#0160;&#0160; Dim maxXZminY As Point<br />&#0160;&#0160;&#0160; Dim maxXminYZ As Point<br />&#0160;&#0160;&#0160; Set maxXYZ = bndBox.MaxPoint<br />&#0160;&#0160;&#0160; Set maxXYminZ = tg.CreatePoint(bndBox.MaxPoint.x, bndBox.MaxPoint.y, bndBox.MinPoint.Z)<br />&#0160;&#0160;&#0160; Set maxXZminY = tg.CreatePoint(bndBox.MaxPoint.x, bndBox.MinPoint.y, bndBox.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set maxXminYZ = tg.CreatePoint(bndBox.MaxPoint.x, bndBox.MinPoint.y, bndBox.MinPoint.Z)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXYZ, minXYmaxZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXYZ, minXZmaxY)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXZmaxY, minXmaxYZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXYmaxZ, minXmaxYZ)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(maxXYZ, maxXYminZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(maxXYZ, maxXZminY)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(maxXYminZ, maxXminYZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(maxXZminY, maxXminYZ)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXYZ, maxXminYZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXYmaxZ, maxXZminY)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXmaxYZ, maxXYZ)<br />&#0160;&#0160;&#0160; Call lines.AddByTwoPoints(minXZmaxY, maxXYminZ)<br />End Sub</pre>
<p><br /><span style="color: #0000ff;">&#39; Calculates a tight bounding box around the input body.&#0160; An optional<br />&#39; tolerance argument is available.&#0160; This specificies the tolerance in<br />&#39; centimeters.&#0160; If not provided the best existing display mesh is used.<br /></span>Public Function calculateTightBoundingBox(body As SurfaceBody, Optional Tolerance As Double = 0) As Box<br />&#0160;&#0160;&#0160; On Error GoTo ErrorFound<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim vertCount As Long<br />&#0160;&#0160;&#0160; Dim facetCount As Long<br />&#0160;&#0160;&#0160; Dim vertCoords() As Double<br />&#0160;&#0160;&#0160; Dim normVectors() As Double<br />&#0160;&#0160;&#0160; Dim vertInds() As Long<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; If the tolerance is zero, use the best display mesh available.<br /></span>&#0160;&#0160;&#0160; If Tolerance &lt;= 0 Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the best display mesh available.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim tolCount As Long<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim tols() As Double<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call body.GetExistingFacetTolerances(tolCount, tols)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim i As Integer<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim bestTol As Double<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bestTol = tols(0)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For i = 1 To tolCount - 1<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If tols(i) &lt; bestTol Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bestTol = tols(i)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call body.GetExistingFacets(bestTol, vertCount, facetCount, vertCoords, normVectors, vertInds)<br />&#0160;&#0160;&#0160; Else<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Calculate a new mesh based on the input tolerance.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call body.CalculateFacets(Tolerance, vertCount, facetCount, vertCoords, normVectors, vertInds)<br />&#0160;&#0160;&#0160; End If<br /><br />&#0160;&#0160;&#0160; Dim tg As TransientGeometry<br />&#0160;&#0160;&#0160; Set tg = ThisApplication.TransientGeometry<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Calculate the range of the mesh.</span><br />&#0160;&#0160;&#0160; Dim smallPnt As Point<br />&#0160;&#0160;&#0160; Dim largePnt As Point<br />&#0160;&#0160;&#0160; Set smallPnt = tg.CreatePoint(vertCoords(0), vertCoords(1), vertCoords(2))<br />&#0160;&#0160;&#0160; Set largePnt = tg.CreatePoint(vertCoords(0), vertCoords(1), vertCoords(2))<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; For i = 1 To vertCount - 1<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim vertX As Double<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim vertY As Double<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim vertZ As Double<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertX = vertCoords(i * 3)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertY = vertCoords(i * 3 + 1)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertZ = vertCoords(i * 3 + 2)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertX &lt; smallPnt.x Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.x = vertX<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertY &lt; smallPnt.y Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.y = vertY<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertZ &lt; smallPnt.Z Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallPnt.Z = vertZ<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertX &gt; largePnt.x Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.x = vertX<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertY &gt; largePnt.y Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.y = vertY<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If vertZ &gt; largePnt.Z Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; largePnt.Z = vertZ<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create and return a Box as the result.<br /></span>&#0160;&#0160;&#0160; Set calculateTightBoundingBox = tg.CreateBox()<br />&#0160;&#0160;&#0160; calculateTightBoundingBox.MinPoint = smallPnt<br />&#0160;&#0160;&#0160; calculateTightBoundingBox.MaxPoint = largePnt<br />&#0160;&#0160;&#0160; Exit Function<br />ErrorFound:<br />&#0160;&#0160;&#0160; Set calculateTightBoundingBox = Nothing<br />&#0160;&#0160;&#0160; Exit Function<br />End Function</p>
<p>&#0160;</p>
<p><span style="font-size: large;"><strong>Inventor Visual Basic (iLogic)</strong></span></p>
<pre>Public Sub TestTightBoundingBox()
    Dim invApp As Inventor.Application = GetObject(, &quot;Inventor.Application&quot;)
    &#39; Have a body selected.
    Dim body As SurfaceBody
    body = invApp.CommandManager.Pick(SelectionFilterEnum.kPartBodyFilter, &quot;Select the body.&quot;)

    &#39; Call the function to get the tight bounding box.
    Dim bndBox As Box = calculateTightBoundingBox(body)

    &#39; Draw the bounding box using a 3D sketch.
    Dim partDoc As PartDocument = invApp.ActiveDocument
    Dim sk As Sketch3D = partDoc.ComponentDefinition.Sketches3D.Add()
    Dim lines As SketchLines3D = sk.SketchLines3D

    Dim tg As TransientGeometry = invApp.TransientGeometry

    Dim minXYZ As Point = bndBox.MinPoint
    Dim minXYmaxZ As Point = tg.CreatePoint(bndBox.MinPoint.X, bndBox.MinPoint.Y, bndBox.MaxPoint.Z)
    Dim minXmaxYZ As Point = tg.CreatePoint(bndBox.MinPoint.X, bndBox.MaxPoint.Y, bndBox.MaxPoint.Z)
    Dim minXZmaxY As Point = tg.CreatePoint(bndBox.MinPoint.X, bndBox.MaxPoint.Y, bndBox.MinPoint.Z)

    Dim maxXYZ As Point = bndBox.MaxPoint
    Dim maxXYminZ As Point = tg.CreatePoint(bndBox.MaxPoint.X, bndBox.MaxPoint.Y, bndBox.MinPoint.Z)
    Dim maxXZminY As Point = tg.CreatePoint(bndBox.MaxPoint.X, bndBox.MinPoint.Y, bndBox.MaxPoint.Z)
    Dim maxXminYZ As Point = tg.CreatePoint(bndBox.MaxPoint.X, bndBox.MinPoint.Y, bndBox.MinPoint.Z)

    lines.AddByTwoPoints(minXYZ, minXYmaxZ)
    lines.AddByTwoPoints(minXYZ, minXZmaxY)
    lines.AddByTwoPoints(minXZmaxY, minXmaxYZ)
    lines.AddByTwoPoints(minXYmaxZ, minXmaxYZ)

    lines.AddByTwoPoints(maxXYZ, maxXYminZ)
    lines.AddByTwoPoints(maxXYZ, maxXZminY)
    lines.AddByTwoPoints(maxXYminZ, maxXminYZ)
    lines.AddByTwoPoints(maxXZminY, maxXminYZ)

    lines.AddByTwoPoints(minXYZ, maxXminYZ)
    lines.AddByTwoPoints(minXYmaxZ, maxXZminY)
    lines.AddByTwoPoints(minXmaxYZ, maxXYZ)
    lines.AddByTwoPoints(minXZmaxY, maxXYminZ)
End Sub


&#39; Calculates a tight bounding box around the input body.  An optional
&#39; tolerance argument is available.  This specificies the tolerance in
&#39; centimeters.  If not provided the best existing display mesh is used.
Public Function calculateTightBoundingBox(body As SurfaceBody, Optional Tolerance As Double = 0) As Box
    Try
        Dim vertCount As Integer
        Dim facetCount As Integer
        Dim vertCoords() As Double = {}
        Dim normVectors() As Double = {}
        Dim vertInds() As Integer = {}

        &#39; If the tolerance is zero, use the best display mesh available.
        If Tolerance &lt;= 0 Then
            &#39; Get the best display mesh available.
            Dim tolCount As Long
            Dim tols() As Double = {}
            Call body.GetExistingFacetTolerances(tolCount, tols)
            Dim bestTol As Double
            bestTol = tols(0)
            For i As Integer = 1 To tolCount - 1
                If tols(i) &lt; bestTol Then
                    bestTol = tols(i)
                End If
            Next

            body.GetExistingFacets(bestTol, vertCount, facetCount, vertCoords, normVectors, vertInds)
        Else
            &#39; Calculate a new mesh based on the input tolerance.
            body.CalculateFacets(Tolerance, vertCount, facetCount, vertCoords, normVectors, vertInds)
        End If

        Dim tg As TransientGeometry = body.Application.TransientGeometry

        &#39; Calculate the range of the mesh.
        Dim smallPnt As Point = tg.CreatePoint(vertCoords(0), vertCoords(1), vertCoords(2))
        Dim largePnt As Point = tg.CreatePoint(vertCoords(0), vertCoords(1), vertCoords(2))
        For i As Integer = 1 To vertCount - 1
            Dim vertX As Double = vertCoords(i * 3)
            Dim vertY As Double = vertCoords(i * 3 + 1)
            Dim vertZ As Double = vertCoords(i * 3 + 2)

            If vertX &lt; smallPnt.X Then
                smallPnt.X = vertX
            End If

            If vertY &lt; smallPnt.Y Then
                smallPnt.Y = vertY
            End If

            If vertZ &lt; smallPnt.Z Then
                smallPnt.Z = vertZ
            End If

            If vertX &gt; largePnt.X Then
                largePnt.X = vertX
            End If

            If vertY &gt; largePnt.Y Then
                largePnt.Y = vertY
            End If

            If vertZ &gt; largePnt.Z Then
                largePnt.Z = vertZ
            End If
        Next

        &#39; Create and return a Box as the result.
        Dim newBox As Box = tg.CreateBox()
        newBox.MinPoint = smallPnt
        newBox.MaxPoint = largePnt
        Return newBox
    Catch ex As Exception
        Return Nothing
    End Try
End Function
</pre>
<p>&#0160;</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Stig Kristiansen
EMAIL: stig@kruz.no
IP: 109.74.179.227
URL: 
DATE: 06/22/2017 02:04:09 PM
Had to change counter i from integer to long because of inherent limitations.
Otherwise worked well. I only tested vba.
-----
COMMENT:
AUTHOR: LG
EMAIL: 
IP: 93.176.82.162
URL: http://profile.typepad.com/6p01b8d29e6a9b970c
DATE: 08/09/2017 02:57:17 PM
Can you do something similar for assemblies?

If you have a part with splines and use that in an assembly, then the RangeBox for the assembly will (potentially) be wrong.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 50.53.103.50
URL: http://profile.typepad.com/1218580234s15464
DATE: 08/09/2017 04:50:34 PM
Yes, it can be done for an assembly.  It means doing this process on each occurrence in the assembly and combining the bounding boxes to get the overall bounding box.
-----
COMMENT:
AUTHOR: LG
EMAIL: 
IP: 93.176.82.162
URL: http://profile.typepad.com/6p01b8d29e6a9b970c
DATE: 08/10/2017 08:49:41 AM
Thanks...

I kinda figured that was the way to do, but wanted to see if there was another way.

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Vote For the Topics You Like
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: vote-for-the-topics-you-like
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/05/vote-for-the-topics-you-like.html 
DATE: 05/26/2017 05:03:43 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8fbed28970b-pi"><img alt="AU2017" border="0" height="367" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8fbed30970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="AU2017" width="1107" /></a></p>
<p>&#0160;</p>
<p>I know most of you wonâ€™t have an opportunity to attend Autodesk University but you still benefit from the event by having access to the material from previous years.&#0160; You can browser the class papers from previous years at <a href="http://au.autodesk.com/au-online/overview">AU Online</a>.&#0160; Besides the papers, many of the classes were also recorded so you can hear and see what was projected on the screen during the class.</p>
<p>For AU 2017 theyâ€™re doing something new and itâ€™s a chance for you to influence what will be presented at Autodesk University which will then be available to you and everyone else after the conference.&#0160; All of the class proposals that have been submitted are now available and can be voted on.&#0160; The voting will be a part of the criteria used in determining which classes will be chosen.&#0160; I was looking through the current voting and was surprised to see a big interest in Factory and CAM related classes.&#0160; You can view and vote on the submissions that look interesting to you <a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals/voting">here</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: patrick
EMAIL: patrickjef2018@gmail.com
IP: 41.89.64.58
URL: http://uonlibrary.uonbi.ac.ke/
DATE: 06/30/2017 11:45:35 AM
Thanks for sharing also check my link 
-----
COMMENT:
AUTHOR: Einladungs Vorlagen
EMAIL: bm@gmail.com
IP: 115.178.202.45
URL: https://naturismusbilder.com/
DATE: 10/20/2017 08:05:07 AM
nice
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Controlling Points in a Sketch using Parameters
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: controlling-points-in-a-sketch-using-parameters
CATEGORY: Brian
CATEGORY: Fusion 360
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/05/controlling-points-in-a-sketch-using-parameters.html 
DATE: 05/25/2017 05:35:27 PM
-----
BODY:
<p>I saw a similar question being asked twice recently and thought I would address it here.&#0160; The questions were from Fusion 360 users but it also applies to Inventor.&#0160; The specific question was â€œHow to create a 3D spline where the control points are determined by parameters?â€</p>
<p>The first thing to discuss is what exactly youâ€™re controlling. The question was about controlling the shape of a spline but it could also be about changing the end point of a line or the center of a circle. The good news is that the same answer applies to any sketch geometry.&#0160; The important thing to understand is that all sketch geometry, in both Fusion 360 and Inventor, is controlled by sketch points. When you drag and change the position of the end of a line youâ€™re really just dragging a sketch point and the line is attached to that so it moves.&#0160; The same is true with the center of a circle.&#0160; The point you see at the center isnâ€™t just for convenience so you can easily see where the center is but itâ€™s a real sketch point that controls the position of the circle.&#0160; Splines are the same.&#0160; When you create a spline and click to define a fit point, Fusion 360 or Inventor, creates a sketch point and the spline fits through and is dependent on that point. You modify the shape of the spline by moving the point.</p>
<p>By understanding that the position of sketch geometry is controlled by sketch points, that changes the original question to â€œHow do I control the position of sketch points using parameters?â€ Thatâ€™s what I want to explain here. If we look at a single point in a sketch and want to precisely control its position we can add dimension constraints to it, like shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d285fca2970c-pi"><img alt="SketchPoint1" border="0" height="287" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d285fca6970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint1" width="355" /></a></p>
<p>&#0160;</p>
<p>I created the sketch on the X-Y construction plane, (or work plane in Inventor), so all points on the plane will have a Z value of 0.&#0160; (Iâ€™ll use the term â€œconstruction planeâ€ for the remainder of this post.) The dimensions are between the origin point and the sketch point I want to control so the values specify the X and Y offset from the model origin.&#0160; When the dimensions were placed, model parameters were automatically created and the dimension is dependent on them.&#0160; The picture below shows the two parameters with their default names of d1 and d2 in the Fusion 360 Parameters dialog.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099ed367970d-pi"><img alt="SketchPoint2" border="0" height="274" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d285fca8970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint2" width="681" /></a></p>
<p>&#0160;</p>
<p>Itâ€™s wise to rename these as you go along so you can easily identify which dimension controls which point.&#0160; Iâ€™ve renamed them to point1_x and point1_y, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d285fcaa970c-pi"><img alt="SketchPoint3" border="0" height="274" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d285fcae970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint3" width="681" /></a></p>
<p>&#0160;</p>
<p>Thatâ€™s really the answer to question and you just build on that idea to be able to control a spline using parameters.&#0160; Youâ€™ll just have more points and a lot more parameters.&#0160; Below is an example of a spline and itâ€™s controlling parameters.&#0160; When creating a spline you can draw the spline first and then dimension to the points that were automatically created or you can draw the points first and then fit the spline through the existing sketch points.&#0160; Either approach will create the same result so itâ€™s just a matter of which seems the easiest for you.&#0160; For me, I think creating the points first can be a little easier because itâ€™s easier to understand which parameter goes with which point when you just have one or two.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099ed36b970d-pi"><img alt="SketchPoint4" border="0" height="329" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8fbba40970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint4" width="1024" /></a></p>
<p>&#0160;</p>
<p>Now by editing the parameter values I can easily modify the curve to an exact desired shape, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099ed36f970d-pi"><img alt="SketchPoint5" border="0" height="332" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099ed373970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint5" width="1024" /></a></p>
<p>&#0160;</p>
<p>I <a href="http://modthemachine.typepad.com/my_weblog/2016/04/fusion-meetups-and-melting-butter.html">posted previously</a> showing a model that I built and animated using exactly this same technique.&#0160; The picture below shows the result but itâ€™s all accomplished by editing the values of parameters which in turn control the positions of points that splines fit through and then various features were created using those splines.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099f027b970d-pi"><img alt="SketchPoint5" border="0" height="404" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb099f027b970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint5" width="800" /></a></p>
<p>&#0160;</p>
<p><strong><span style="font-size: large;">Controlling the Z Value</span></strong></p>
<p>The above illustrates how to control the X and Y position of a sketch point, which it typically all thatâ€™s needed.&#0160; However in some cases you might also want to control the Z position.&#0160; First you need to decide if you really need to control the Z position or if using a plane that is positioned other than on the model X-Y plane will work.&#0160; You can create the sketch in any arbitrary plane and dimension the points from any arbitrary point so it doesnâ€™t always have to be from the model origin but that is common to have coordinate data relative to the model base coordinate system.</p>
<p>In Fusion 360, all sketches are 3D so sketch points can exist anywhere in space and arenâ€™t limited to being on the x-y plane of the sketch.&#0160; However, if you move a point out of the x-y plane you canâ€™t control the z offset using a dimension which means itâ€™s only the x-y position that can be controlled by a dimension and the associated parameter.&#0160; Inventor is the same except that 2D and 3D sketches are different types of sketches.&#0160; What Iâ€™ve discussed so far is for 2D sketches.</p>
<p>For both Fusion 360 and Inventor, the way to control the Z height is by using construction planes.&#0160; Assuming we want to control the x-y-z position of a point relative to model space, youâ€™ll first create a construction plane that is an offset from the X-Y base construction plane.&#0160; When you create an offset construction plane, Fusion 360 and Inventor automatically create a parameter that controls the offset distance of the construction plane.&#0160; Youâ€™ll then create the sketch that contains the points on that construction plane.&#0160; The offset distance of the construction plane now controls the Z height of all points on that sketch and the dimension constraints to those points defines the X and Y positions.&#0160; If every point needs to have independent Z values that means a new offset construction plane and sketch for each point.</p>
<p>If you end up with points in different sketches then you have some additional work.&#0160; In Inventor you need to create a new 3D sketch and create a new spline by selecting the points as the points to fit the spline to.&#0160; In Fusion 360 itâ€™s also easy but you have to change a preference setting to allow the creation of a spline off of the x-y plane of the sketch.&#0160; That preference setting is highlighted below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8fbe474970b-pi"><img alt="SketchPoint6" border="0" height="387" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d28626db970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SketchPoint6" width="635" /></a></p>
<p>Now you have full control of the x, y, and z positions of a sketch point.</p>
<p>&#0160;</p>
<p><strong><span style="font-size: large;">Using the API</span></strong></p>
<p>Another option for controlling the position of sketch points is to use the API in either Fusion 360 or Inventor.&#0160; There are two ways to use the API to control the position of a sketch point.&#0160; In the example of the melting butter I created points whose positions were controlled by parameters like Iâ€™ve already talked about and then used a Python script to change the values of the parameters.&#0160; Thatâ€™s illustrated in the <a href="http://modthemachine.typepad.com/my_weblog/2016/04/fusion-meetups-and-melting-butter.html">melting butter post</a>.&#0160; Another approach is to not use parameters at all and use the API to move the points to the desired location.&#0160; Thatâ€™s possible but also has itâ€™s own issues, like finding the point you want to move.&#0160; Using the API to directly move a point is a bit beyond the scope of this post but I wanted to mention it in case itâ€™s something that might better fit your needs.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Units and Parameters in Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: units-and-parameters-in-inventor
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/04/units-and-parameters-in-inventor.html 
DATE: 04/26/2017 08:30:56 PM
-----
BODY:
<p>I recently saw a question asking about how to determine if a parameter is of a certain unit type and thought it would be worth writing a bit more here for everyoneâ€™s benefit.</p>
<p>First, letâ€™s look at the object model for Parameters, which is shown below on the left.&nbsp; Youâ€™ll notice that thereâ€™s a base class â€œParameterâ€ object and several other types derived from it; DerivedParameter, ModelParameter, TableParameter, ReferenceParameter, and UserParameter.&nbsp; These correspond to the groupings you see in the Parameter dialog.&nbsp; In the picture on the right you can see two model parameters which were created when I placed two dimension constraints in a sketch to control the sketch size. These are referred to as â€œdrivingâ€ dimensions because these drive the model and if I change their values the model will update.&nbsp; Model dimensions are also created when you create modeling features that are driven by a parameter.&nbsp; There are two reference parameters which were created when I added dimension constraints to a sketch that would have overconstrained the sketch.&nbsp; These dimensions are being controlled by the sketch and are referred to as â€œdrivenâ€ dimensions.&nbsp; The parameters will update as the model changes.&nbsp; I also created three parameters that I named â€œLengthâ€, â€œMessageâ€, and â€œIsItRainingâ€.&nbsp; These are user parameters because theyâ€™re created by the user.&nbsp; There can also be other types besides numeric like in the example below with Text and Boolean parameters.&nbsp; And the final type represented below are table parameters.&nbsp; These are created when you import an Excel spreadsheet to create parameters.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8f1d675970b-pi"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="params" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8f1d679970b-pi" alt="params" width="1044" height="478" border="0" /></a></p>
<p>So, those are the types of parameters that Inventor supports.&nbsp; Depending on the type, there are certain things you can and canâ€™t do with a parameter.&nbsp; For example, you canâ€™t delete a model parameter, because its tied to a modeling entity and will exist as long as that entity exists.&nbsp; A table parameter canâ€™t be deleted either because itâ€™s controlled by the referenced Excel spreadsheet.&nbsp; You canâ€™t edit the value of a reference or table parameter because the value is controlled by the model or the value in the spreadsheet.&nbsp; The point is that all of these are different types of the Parameter object and they each have slightly different behaviors but they all support the functionality of the Parameter object.&nbsp; The parameter object supports quite a few methods and properties and depending on the specific type of parameter, not all of them may function the same.&nbsp; For example you can use the Value property to get and set the value of a model parameter but for a reference parameter the Value property behaves as read-only.&nbsp;</p>
<p>The question that sparked this response was related to the units of a parameter.&nbsp; The units of a parameter donâ€™t define its object type but the unit is just a property of a parameter. In fact for user parameters, the user can easily change the units of a parameter. The value of a parameter can be of three different categories; numeric, text, or Boolean.&nbsp; The Parameter object supports the Units property which returns a String indicating the unit category.&nbsp; For a parameter that has a text value the Units property will return â€œTextâ€ and for a Boolean value it will return â€œBooleanâ€.&nbsp;</p>
<p>By far, the most common unit category is a numeric value.&nbsp; The Units property for a numeric value can return an almost infinite number of results.&nbsp; It returns the current unit string that represents the current unit assigned to that parameter.&nbsp; For example, the most common kind of numeric unit is length and could be returned as â€œmmâ€, â€œcmâ€,, â€œmâ€, â€œinâ€, â€œydâ€, â€œmiâ€ (for miles), etc.&nbsp; These are all valid units for lengths.&nbsp; For model and reference parameters, the units used to define length uses the default length units of the document as defined in the Document Settings dialog, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8f1d67d970b-pi"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="DocUnits" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8f1d681970b-pi" alt="DocUnits" width="297" height="322" border="0" /></a></p>
<p>For user parameters you can define any unit type you want.&nbsp; For lengths there are a known set of length types that Inventor will allow you to use. I think I listed most of them above. The same is true for the other base unit types like angles, mass, and time.&nbsp; However, there are a lot of units types that are a combination of other types so their can be a huge number of combinations.&nbsp; For example, area is defined using any of the length types like â€œin * inâ€ or â€œcm * cmâ€.&nbsp; In fact it will even allow â€œin * cmâ€ as a valid area.&nbsp; Iâ€™m not sure what that means but it just demonstrates the flexibility.&nbsp; More complex types that arenâ€™t even listed in the units list in Inventor can be defined by the user like acceleration using â€œm/s/sâ€ or â€œm/s^2â€.&nbsp; The point being that there isnâ€™t a small set of unit types that can be used for numeric parameter values.&nbsp;</p>
<p>In the API there is an enum with the most common unit types that can be used in some cases but you can also always use the String equivalent and in many cases have to use the String representation of the unit type because itâ€™s not in the enum.&nbsp; For example you can use kInchLengthUnits from the UnitTypesEnum or â€œinâ€ or â€œinchâ€.</p>
<p>The original question was about how to determine if a parameter is defining a length or an angle value. You can use the Units property of the parameter to get back the current units of the parameter. Remember that this will return â€œTextâ€, â€œBooleanâ€, or a string defining the unit type of a numeric parameter. The trick is to be able to correctly handle the numeric parameter because a length or angle can be defined in many different ways.&nbsp; In most cases you donâ€™t care if theyâ€™ve chosen to use cm, inch, or mile but just want to know if itâ€™s a length or not.&nbsp; There are some other utilities in Inventor that can help to determine this.</p>
<p>The UnitsOfMeasure object provides several utility methods related to units.&nbsp; You can take advantage of these when working with parameters. You get the UnitsOfMeasure object from the Document using its UnitsOfMeasure property.&nbsp; Iâ€™ll let you look at the <a href="http://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-026FB34F-60A7-4F2A-A708-190EAA6A1162">documentation for the UnitsOfMeasure object</a> to see all of what the UnitsOfMeasure supports but I want to focus on one its the more obscure methods right now, which is the CompatibleUnits method.&nbsp; Using this method we can answer the question above.&nbsp; What this method does is test two different values to see if their units are â€œcompatibleâ€ or of the same category of unit.&nbsp; If we want to know if a parameter defines a length we can use this to see if itâ€™s compatible with a value we know is a length.&nbsp; If this returns True, we know it defines a length.&nbsp; Hereâ€™s a VBA example to check to see if a parameter is a length.</p>
<pre><code>Dim param As Parameter
Set param = partDoc.ComponentDefinition.Parameters.Item(â€œSomeParameterâ€)

Dim uom As UnitsOfMeasure
Set uom = partDoc.UnitsOfMeasure

If uom.CompatibleUnits(param.Expression, param.Units, "1", "cm") Then
    MsgBox(â€œIs Lengthâ€)
Else
    MsgBox(â€œIs NOT a Lengthâ€)
End If
</code></pre>
<p>The CompatibleUnits method compares two values where each value is defined by two inputs.&nbsp; The first is the expression of the value which is a string and could be something like â€œ5â€ or â€œ5 inâ€ or â€œ5in + 3cmâ€ or â€œd1â€ or any number of valid expressions that can be used to define the value of a parameter.&nbsp; The second input is the unit of the parameter which can be any of the of unit types discussed previously (â€œinâ€, â€œcm*cmâ€, â€œm/s^2â€, etc.).&nbsp; In the example above itâ€™s using the Expression property of the parameter as the first input and its Units property as the second input. For the value to compare, all we need is a value that we know defines a valid length.&nbsp; For the expression portion I use â€œ1â€, but it could be any value like â€œ99.999â€ or â€œ1/2â€.&nbsp; For the unit portion I use â€œcmâ€ but any of the known length units will also work because it doesnâ€™t matter what the specific unit type is as long as it defines a length.</p>
<p>Here are two functions that can be used to easily determine if a parameter is a length or angle. The TestParamFunctions method tests the two functions. Notice that in the functions I first check to make sure the parameter isnâ€™t a Text or Boolean type because the CompatibleUnits method will fail in those cases.</p>
<strong>VBA</strong>
<pre><code>Public Sub TestParamFunctions()
    Dim partDoc As PartDocument
    Set partDoc = ThisApplication.ActiveDocument
    
    Dim param As Parameter
    For Each param In partDoc.ComponentDefinition.Parameters
        If IsLengthParam(param, partDoc) Then
            MsgBox param.name &amp; " is a length."
        ElseIf isAngleParam(param, partDoc) Then
            MsgBox param.name &amp; " is an angle."
        Else
            MsgBox param.name &amp; " is something else."
        End If
    Next
End Sub

Public Function IsLengthParam(param As Parameter, doc As Document) As Boolean
    If param.Units = "Boolean" Or param.Units = "Text" Then
        IsLengthParam = False
        Exit Function
    End If
    
    Dim uom As UnitsOfMeasure
    Set uom = doc.UnitsOfMeasure
    
    If uom.CompatibleUnits(param.expression, param.Units, "1", "cm") Then
        IsLengthParam = True
    Else
        IsLengthParam = False
    End If
End Function

Public Function isAngleParam(param As Parameter, doc As Document) As Boolean
    If param.Units = "Boolean" Or param.Units = "Text" Then
        isAngleParam = False
        Exit Function
    End If
    
    Dim uom As UnitsOfMeasure
    Set uom = doc.UnitsOfMeasure
    
    If uom.CompatibleUnits(param.expression, param.Units, "1", "deg") Then
        isAngleParam = True
    Else
        isAngleParam = False
    End If
End Function
</code></pre>
<br>
<strong>Visual Basic .NET and iLogic</strong>
<pre><code>Public Sub TestParamFunctions()
    Dim invApp As Inventor.Application = GetObject(, "Inventor.Application")
    Dim partDoc As PartDocument = invApp.ActiveDocument

    Dim param As Parameter
    For Each param In partDoc.ComponentDefinition.Parameters
        If IsLengthParam(param, partDoc) Then
            MsgBox(param.Name &amp; " is a length.")
        ElseIf isAngleParam(param, partDoc) Then
            MsgBox(param.Name &amp; " is an angle.")
        Else
            MsgBox(param.Name &amp; " is something else.")
        End If
    Next
End Sub

Public Function IsLengthParam(param As Parameter, doc As Document) As Boolean
    If param.Units = "Boolean" Or param.Units = "Text" Then
        Return False
    End If

    Dim uom As UnitsOfMeasure = doc.UnitsOfMeasure

    If uom.CompatibleUnits(param.Expression, param.Units, "1", "cm") Then
        Return True
    Else
        Return False
    End If
End Function

Public Function isAngleParam(param As Parameter, doc As Document) As Boolean
    If param.Units = "Boolean" Or param.Units = "Text" Then
        Return False
    End If

    Dim uom As UnitsOfMeasure = doc.UnitsOfMeasure

    If uom.CompatibleUnits(param.Expression, param.Units, "1", "deg") Then
        Return True
    Else
        Return False
    End If
End Function
</code></pre>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: dba
EMAIL: 
IP: 91.141.3.40
URL: http://profile.typepad.com/6p01910489d0be970c
DATE: 04/26/2017 09:07:11 PM
Thank you for this great article on the Unitsofmeasure Object!
BR, 
Daniel 
-----
COMMENT:
AUTHOR: Ivan
EMAIL: strandvata@yahoo.com
IP: 93.45.86.2
URL: 
DATE: 04/26/2017 09:30:19 PM
10x! it's a realy a good piece of information.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk University 2017 Classes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-university-2017-classes
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/04/autodesk-university-2017-classes.html 
DATE: 04/19/2017 07:57:50 PM
-----
BODY:
<p>The <a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals">call for proposals</a> for classes at this yearâ€™s Autodesk University is now open.&#0160; Do you have something interesting youâ€™ve been working on that youâ€™d like to share?&#0160; You definitely wonâ€™t get rich teaching classes but there are definitely some benefits to teaching too.&#0160; First, is the opportunity to mix with others with the same interests you have and share your work with them.&#0160; You also get a free AU event Pass, but that is just for the conference and doesnâ€™t include hotel or travel costs.&#0160; If you teach more than one class you get $400 for each additional class.&#0160; The <a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals">AU website</a> has a lot of great information about submitting a proposal.</p>
<p><a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals"><img alt="CFP Insta" border="0" height="454" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09926cdf970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="CFP Insta" width="454" /></a></p>
<p>&#0160;</p>
<p>I know for most of you teaching at AU probably isnâ€™t something youâ€™re that interested in but you do benefit from the classes whether you can attend AU or not by having access to the material after AU.&#0160; Do you have any ideas for classes you would like; particularly any related to the Inventor or Fusion APIâ€™s?&#0160; Feel free to comment under this post if you do.&#0160; I know Iâ€™m still trying to figure out what to present this year.&#0160; Theyâ€™ve also introduced a new â€œ<a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals/recommend">Request a Class</a>â€ option this year if you have ideas on something youâ€™d like to see thatâ€™s not related to the API.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Evelyn Wangari
EMAIL: eve891301@gmail.com
IP: 41.89.64.73
URL: http://uonlibrary.uonbi.ac.ke/
DATE: 06/30/2017 01:37:35 PM
This is nice. One can now make a choice
-----
COMMENT:
AUTHOR: Martin
EMAIL: ionica@mail.ru
IP: 193.200.76.203
URL: https://essaytypers.net
DATE: 07/24/2017 02:12:06 PM
Thank you!
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Some Time at Shaper HQ
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: some-time-at-shaper-hq
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Woodworking

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/04/some-time-at-shaper-hq.html 
DATE: 04/04/2017 01:09:42 AM
-----
BODY:
<p>A couple of weeks ago I was able to spend some time at the headquarters of Shaper Tools to have a little time with their new Shaper Origin tool and work with them on building a better integration with Fusion 360.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb098c6b2d970d-pi"><img alt="Shaper" border="0" height="513" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8e940c0970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="Shaper" width="384" /></a></p>
<p>&#0160;</p>
<p>If youâ€™re interested in woodworking and havenâ€™t seen or heard of the new <a href="https://shapertools.com/">Shaper Origin</a> router you need go check out their <a href="https://shapertools.com/">website</a>. I think the best link to fully understand what it is and how it works is the â€œ<a href="https://shapertools.com/features/">Features</a>â€ link where there are a series of videos demonstrating various features of the tool. My definition of the tool is that itâ€™s a cross between a hand-held and a CNC router. You upload the design you want to cut onto the router, like you would with a CNC router. The router has vision and uses the domino looking tape you can see in the picture above to accurately know where it is on the board. You visually position your pattern on the board using the screen on the router and then move the router along the pattern by watching a â€œcursorâ€ on the screen.&#0160; The spindle moves independently of the router so as you move the router the best you can to follow the pattern it corrects the position of the cutter to keep it where it should be.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2739bdc970c-pi"><img alt="ShaperOrigin" border="0" height="513" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb098c6b32970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="ShaperOrigin" width="702" /></a></p>
<p>&#0160;</p>
<p>I worked primarily with Sam while I was there, (who youâ€™ll meet on the demo videos), and met most of the rest of the team too. Theyâ€™ve been working on this for a long time and have gone through several prototypes and are working hard to put out a good product. As you can probably tell, Iâ€™m excited about the product and can see using it in my shop.</p>
<p>I donâ€™t want to say too much about the Fusion integration at this point because itâ€™s still a work in progress and I donâ€™t know where weâ€™ll end up but it should make creating the patterns to cut much easier than without it.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: nmjshaw@outlook.com
EMAIL: nmjshaw@outlook.com
IP: 79.74.11.128
URL: 
DATE: 04/18/2017 12:12:50 AM
looks like a great but its far too expensive for a small workshop. At that price, you could buy a 2nd hand full size CNC and use that :)
-----
COMMENT:
AUTHOR: josh
EMAIL: jkarani@uonbi.ac.ke
IP: 41.89.64.78
URL: http://academics.uonbi.ac.ke/
DATE: 06/30/2017 11:31:24 AM
dope technology..nmjshaw@outlook.com couldnt agree more the price is way off for a stater business 
-----
COMMENT:
AUTHOR: Bradley Alvarez
EMAIL: tiva@akgq701.com
IP: 103.49.170.194
URL: http://knifegeeky.com/
DATE: 07/22/2017 08:03:02 AM
Hi Brian,
I think this is very useful tools for woodworking. But this is so expensive. Would you give me a source for buy a second hand ?

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360 API Introductory Course
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: fusion-360-api-introductory-course
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/03/fusion-360-api-introductory-course.html 
DATE: 03/27/2017 05:24:28 PM
-----
BODY:
<p>I posted a teaser video last week about a course that would soon be available.&nbsp; Well itâ€™s here now on the <a href="https://academy.autodesk.com/node/119472">Autodesk Design Academy</a> site. You can use your existing Autodesk account to sign up and itâ€™s free.</p> <p><a href="https://academy.autodesk.com/node/119472"><img title="VideoCourse" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="VideoCourse" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09881ed5970d-pi" width="768" height="601"></a></p> <p>Hereâ€™s the official description of the course:</p> <blockquote> <p>This course combines the power of 3D design with the programming language Python to teach you how to automate the 3D modeling process. You will learn how to develop and publish an app to the Autodesk App Store that automates the design of 3D printer parts in Autodesk Fusion 360. After completing this course, you will be able to write code that controls Fusion 360, allowing you to automate CAD modeling specific to your industry and passions. Automating your CAD modeling in the application programming interface (API) will save you time, money, and resources. This course is designed for those who have a basic understanding of Fusion 360 and beginning to advanced experience programming in Python. Whether youâ€™re a designer exploring programming languages or a developer stepping into the design space, challenge yourself by learning how to automate your 3D modeling.</p></blockquote> <p>All of the credit goes to the team at Brigham Young University that developed the course. They were great to work with and have created something that should be a great help to those that are new to automating Fusion 360. Feedback on the content and any suggestions to improve it are very welcome.</p> <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: enock
EMAIL: enbore@yahoo.com
IP: 197.136.72.121
URL: http://cae.uonbi.ac.ke
DATE: 06/07/2017 06:40:50 AM
this is a great innovation
-----
COMMENT:
AUTHOR: Jayson
EMAIL: jaysonblog@yahoo.com
IP: 41.89.91.19
URL: http://kavi-icr.uonbi.ac.ke/
DATE: 07/01/2017 01:35:05 PM
Thanks for the information.
-----
COMMENT:
AUTHOR: Martin
EMAIL: ionica@mail.ru
IP: 193.200.76.203
URL: https://thesamedayessay.com/
DATE: 07/06/2017 11:50:32 AM
That is really great!! Thanks so much for all your assistance
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Help is Online
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: inventor-api-help-is-online
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/03/inventor-api-help-is-online.html 
DATE: 03/22/2017 07:37:16 PM
-----
BODY:
<p>With Inventor 2018, thereâ€™s now a new topic in the Inventor help table of contents making the help for the Inventor API <a href="http://help.autodesk.com/view/INVNTOR/2018/ENU/">available online</a>.</p> <p><a href="http://help.autodesk.com/view/INVNTOR/2018/ENU/"><img title="InventorAPIOnline" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="InventorAPIOnline" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8e3322e970b-pi" width="415" height="378"></a></p> <p>Previously, the API help for Inventor has always been delivered as a chm as part of an Inventor install. When we first started delivering an API with Inventor, chm was the standard for help content on Windows and a chm is still needed to provide context sensitive help when working in VBA. Itâ€™s also often convenient to have local help content and not be required to be connected to the internet, however there are also a few advantages to having the help content online.</p> <ul> <li>Having the content online now makes it available to search engines, so Google searches will now be able to return results from the API help. Searching within the Autodesk help system will now also include the API topics.<br></li> <li>It was difficult to reference content from the help because you couldnâ€™t provide someone a direct link to a topic in the chm version of the help but instead had to give directions for someone to be able to look up the topic on their own. Now you can provide a direct link to a specific topic, like the example below which will take you to one of the samples that demonstrates creating an extrusion.<br><br><a title="http://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-8F065843-9574-440B-8E0D-2698B4238BB5" href="http://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-8F065843-9574-440B-8E0D-2698B4238BB5">http://help.autodesk.com/view/INVNTOR/2018/ENU/?guid=GUID-8F065843-9574-440B-8E0D-2698B4238BB5</a><br></li> <li>It lets you browse the help without having Inventor installed.</li></ul> <p>The content of the online help is identical to whatâ€™s in the chm.&nbsp; There is one new feature in the help topics (both chm and online) that wasnâ€™t there before that can be useful. For each object there is now a new section titled â€œAccessed Fromâ€ which returns a list of every method and property that returns that particular object. This is somewhat equivalent to using the object model chart to traverse up the chart to figure out how to access a specific object.</p> <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0986659f970d-pi"><img title="AccessedFrom" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="AccessedFrom" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d26d92cf970c-pi" width="613" height="343"></a></p> <p>Weâ€™ll continue to deliver the chm but will also be publishing the API help online from now on. </p> <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: yichuan
EMAIL: yichuan.xing@autodesk.com
IP: 10.148.210.198
URL: 
DATE: 03/23/2017 01:36:07 AM
Cool!
-----
COMMENT:
AUTHOR: Owen Ransen
EMAIL: help@ransen.com
IP: 88.62.101.146
URL: 
DATE: 07/05/2017 09:57:53 AM
Looking at the new help on line I find it hard to find the page which explains the methods for the Plane object. Is there an index for the API? 
-----
COMMENT:
AUTHOR: Peninnah
EMAIL: ninahgambi@gmail.com
IP: 197.136.68.28
URL: http://ipmo.uonbi.ac.ke
DATE: 07/11/2017 01:12:58 PM
Thanks for sharing the table of contents. So helpful
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion API Video Course
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-api-video-course
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/03/fusion-api-video-course.html 
DATE: 03/21/2017 08:19:34 PM
-----
BODY:
<p>Weâ€™ve been working with the Mechanical Engineering Dept. at Brigham Young University over the past year to develop a video course for the Fusion API.&#0160;Some final work is being done now to publish it live but here&#39;s a&#0160;little teaser from one of the members of the team&#0160;about what to expect.&#0160;Iâ€™ll post here when the course becomes available.</p>
<p style="text-align: center;"><iframe allowfullscreen="" frameborder="0" height="281" src="https://www.youtube.com/embed/78wTp7vAxcs?feature=oembed" style="width: 690px; height: 403px;" width="500"></iframe></p>
<p style="text-align: left;">-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: AU London registrations open
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-london-registrations-open
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/03/au-london-registrations-open.html 
DATE: 03/15/2017 02:07:18 PM
-----
BODY:
<p>For the first time ever, we&#39;ll organize an <strong>AU</strong> in <strong>London</strong> as well this summer: <strong>21-22 June</strong><br /><a href="http://gems.autodesk.com/events/au-london-2017/event-summary-9dba4a429f994dbab348c68dfad1ca6a.aspx?RefID=au-web-redirect">AU London 2017</a></p>
<p>The registrations are now open! Also, the numbers are limited so don&#39;t leave it too late! :)</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0983d0b7970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="6a00e553e16897883301bb09839351970d-800wi" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb0983d0b7970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0983d0b7970d-500wi" title="6a00e553e16897883301bb09839351970d-800wi" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Forge accelerators coming up
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-accelerators-coming-up
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/forge-accelerators-coming-up.html 
DATE: 02/28/2017 11:08:37 PM
-----
BODY:
<p>You looked at <a href="http://autode.sk/2m4MMoo">Forge</a>, have a great idea, but would need hands-on help from us to get started? :)</p>
<p>Do consider attending one of our <a href="http://autodeskcloudaccelerator.com/">Forge Accelerators</a>!</p>
<p>There are two coming up in <strong>Europe</strong>:<br />- <strong>Gothenburg</strong>: March 27 - 30&#0160;<br />- <strong>Barcelona</strong>: June 12 - 16</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb097e5ba4970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Accelerators" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb097e5ba4970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb097e5ba4970d-320wi" title="Accelerators" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Changes in Fusion 360 Help
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: changes-in-fusion-360-help
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/changes-in-fusion-360-help.html 
DATE: 02/16/2017 11:53:44 PM
-----
BODY:
<p>Have you noticed the recent changes in the Fusion 360 help? I know the help team was tired of hearing from me and Iâ€™ve heard many of you talk about some of the problems when using the help. When using the API youâ€™re very dependent on the help so any problems quickly becomes apparent.&#0160; The help team has continually chipped away at the known issues and with a big change that appeared a couple of weeks ago I think all of the issues have now been addressed.</p>
<p>One of the big problems, and the one they fixed a couple of weeks ago is that the table of contents and the current topic were a single scrollable window.&#0160; When the list of API objects is open in the table of contents, itâ€™s a long list and makes the window very long.&#0160; To see a particular topic you would scroll down to find the topic you wanted, click the topic and it would switch to that topic but it would also jump to the top so you could see the topic. To choose an adjacent topic in the table of contents you would have to scroll back down again, click it and have it jump to the top.&#0160; Now the table of contents is a separate scrollable area from the content topic, as shown below so now you can use the table of contents without it scrolling to the top.&#0160; Itâ€™s much easier to use now.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d6e764970b-pi"><img alt="NewFusionHelp" border="0" height="774" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d6e768970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="NewFusionHelp" width="883" /></a></p>
<p>I want to thank the help team for their efforts in fixing the help platform.</p>
<p>The content that displays on the right-hand side I control (except for some of the styling), so if you find any issues in the content itself, you can direct those to me and Iâ€™ll take the blame.&#0160; I did figure out some css issues recently that were causing me to lose some desired formatting and thatâ€™s also been fixed but there is always room for improvement in both the content itself and how itâ€™s displayed so Iâ€™m always interested in suggestions in how we can make it better.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Connect to Fusion Lifecycle from Fusion 360 add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: connect-to-fusion-lifecycle-from-fusion-360-add-in
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/connect-to-fusion-lifecycle-from-fusion-360-add-in.html 
DATE: 02/15/2017 03:20:37 PM
-----
BODY:
<p><a href="http://www.autodeskfusionlifecycle.com/discover/">Fusion Lifecycle</a> has a <a href="http://help.autodesk.com/view/PLM/ENU/?guid=GUID-C03A2183-DE8D-41F5-9E33-9AC4435C5051">RESTful API</a> which can be accessed through simple <strong>HTTP</strong> requests, and so can be used from a <a href="http://www.autodesk.com/products/fusion-360/overview">Fusion 360</a> <strong>add-in</strong>/<strong>script</strong> as well:<br /><a href="http://modthemachine.typepad.com/my_weblog/2015/10/call-web-services-from-fusion-add-in.html">http://modthemachine.typepad.com/my_weblog/2015/10/call-web-services-from-fusion-add-in.html</a></p>
<p>I had a bit of difficulty doing <strong>HTTP</strong> requests from a&#0160;<a href="https://www.javascript.com">JavaScript</a>&#0160;<strong>Fusion 360 script</strong>, but all is fine from <a href="https://www.python.org">Python</a>.&#0160;</p>
<p>It&#39;s very easy to create a new <strong>Python</strong>&#0160;<strong>script</strong>/<strong>add-in</strong> inside <strong>Fusion 360</strong> and open it for edit. <br />Once it&#39;s open, you can add the following code that will log into your&#0160;<strong>Fusion Lifecycle</strong> tenant.<br />Note: <strong>POST login</strong> endpoint help:&#0160;<a href="http://help.autodesk.com/view/PLM/ENU/?guid=GUID-43302513-5120-4A42-8804-EF835D97D10D">http://help.autodesk.com/view/PLM/ENU/?guid=GUID-43302513-5120-4A42-8804-EF835D97D10D</a></p>
<p>You just have to set the correct <strong>userID</strong>, <strong>password</strong>, and <strong>tenant</strong>&#0160;<strong>URL</strong> in the code:</p>
<pre>#Author-
#Description-

import adsk.core, adsk.fusion, adsk.cam, traceback, json, http.client

def login(): 
    body = {
        &quot;userID&quot;: &quot;&lt;your user id&gt;&quot;, 
        &quot;password&quot;: &quot;&lt;your password&gt;&quot;
    }
    h = http.client.HTTPSConnection(&#39;&lt;name of your tenant&gt;.autodeskplm360.net&#39;)
    headers = {
        &#39;User-Agent&#39;: &#39;Fusion360&#39;,
        &#39;Content-Type&#39;: &#39;application/json&#39;,
        &#39;Accept&#39;: &#39;application/json&#39;
    }
    h.request(&#39;POST&#39;, &#39;/rest/auth/1/login&#39;, json.dumps(body), headers)
    res = h.getresponse()
    return res.status, res.reason, res.read()

def run(context):
    ui = None
    try:
        app = adsk.core.Application.get()
        ui  = app.userInterface
        
        status, response, data = login()
        dataString = data.decode(&#39;utf-8&#39;)
        ui.messageBox(dataString)
        
        # parse the json string
        dataObject = json.loads(dataString)
        ui.messageBox(&quot;My sessionid is &quot; + dataObject[&quot;sessionid&quot;])
    except:
        if ui:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))
</pre>
<p>This what you get when running the code (if everything goes well):</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d65190970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="LoginSuccess" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8d65190970b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d65190970b-320wi" title="LoginSuccess" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3D PDF Publish fails for invisible document
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3d-pdf-publish-fails-for-invisible-document
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/3d-pdf-publish-fails-for-invisible-document.html 
DATE: 02/15/2017 10:48:51 AM
-----
BODY:
<p>When creating a <strong>3D PDF</strong> file for a document, it needs to be <strong>visibly</strong> open inside <strong>Inventor</strong>. This is currently the requirement.</p>
<p>However, you can have an invisible <strong>Inventor</strong> instance doing the <strong>3D PDF</strong> generation, as discussed <a href="http://modthemachine.typepad.com/my_weblog/2017/02/3d-pdf-publish-makes-inventor-visible.html">here</a>.<br />So you could do things that way if you don&#39;t want the document to pop up for the user in the <strong>UI</strong>. &#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: XML to PDF
EMAIL: stevejohn140@gmail.com
IP: 114.79.169.107
URL: https://www.alt-soft.com/cases/xml-pdf/
DATE: 05/18/2017 01:22:33 PM
Thanks for this useful information.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: 3D PDF Publish makes Inventor visible
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3d-pdf-publish-makes-inventor-visible
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/3d-pdf-publish-makes-inventor-visible.html 
DATE: 02/13/2017 10:32:29 PM
-----
BODY:
<p>A partner reported that when using <strong>Inventor</strong> invisibly in the background to create <strong>3D PDF</strong>, then the <strong>Publish</strong> command of the <strong>3D&#0160;PDF Add-In</strong> causes <strong>Inventor</strong> to become visible :-/</p>
<p>He was kind enough to also check with <a href="http://www.anark.com">Anark</a> (the creator of the <strong>3D PDF Add-In</strong>) about it :) and they said the issue was solved in&#0160;<strong>Inventor 2017 SP1/R2 </strong>and is of course also available in<strong> 2017.3 Update</strong>.</p>
<p>I checked things with&#0160;<a href="https://knowledge.autodesk.com/support/inventor-products/downloads/caas/downloads/content/inventor-2017-r2-update-for-customers-subscription-and-service-pack-1.html">Inventor 2017 SP1/R2</a> and indeed the issue seems to have been solved :)</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Martin Buuri Kaburia
EMAIL: buuri26@gmail.com
IP: 41.89.91.4
URL: http://medphysiology.uonbi.ac.ke/
DATE: 06/28/2017 05:56:54 PM
How nice to have come across your site,just learnt something amazing
-----
COMMENT:
AUTHOR: Peninnah
EMAIL: ninahgambi@gmail.com
IP: 197.136.68.28
URL: http://ipmo.uonbi.ac.ke
DATE: 07/11/2017 01:14:26 PM
You are kind enough to share this post. Thanks a lot
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: A Problem with Attribute Helper and a Fix
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: a-problem-with-attribute-helper-and-a-fix
CATEGORY: Add-In Creation
CATEGORY: Attributes
CATEGORY: Brian
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/02/a-problem-with-attribute-helper-and-a-fix.html 
DATE: 02/01/2017 11:20:47 PM
-----
BODY:
<p>A partner notified me about a problem he had found with my Attribute Helper add-in that I wasnâ€™t aware of. He told me that if you have the new â€œInteractive Tutorialâ€ and â€œAttribute Helperâ€ add-ins both loaded, then Inventor will crash when you shut it down with the dialog below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09742c2e970d-pi"><img alt="CrashDialog" border="0" height="154" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d10e5c970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="CrashDialog" width="478" /></a></p>
<p>&#0160;</p>
<p>As I said, I wasnâ€™t aware of the problem but had a good idea of the cause. I wasnâ€™t following my own advice from <a href="http://modthemachine.typepad.com/my_weblog/2016/03/is-your-add-in-causing-problems-in-inventor-2017.html">this post</a> almost a year ago.&#0160; I made the changes recommended there so that my Deactivate method of the add-in went from this:</p>
<div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">
<p>Public Sub Deactivate() Implements Inventor.ApplicationAddInServer.Deactivate<br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Release objects.</strong></span><br />&#0160;&#0160;&#0160; Marshal.FinalReleaseComObject(g_inventorApplication)<br />&#0160;&#0160;&#0160; g_inventorApplication = Nothing<br /><br />&#0160;&#0160;&#0160; If Not m_attributeButtonDef Is Nothing Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Marshal.FinalReleaseComObject(m_attributeButtonDef)<br />&#0160;&#0160;&#0160; End If<br /><br />&#0160;&#0160;&#0160; If Not m_UIEvents Is Nothing Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Marshal.FinalReleaseComObject(m_UIEvents)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_UIEvents = Nothing<br />&#0160;&#0160;&#0160; End If<br /><br />&#0160;&#0160;&#0160; System.GC.WaitForPendingFinalizers()<br />&#0160;&#0160;&#0160; System.GC.Collect()<br />End Sub</p>
</div>
<p>To this:</p>
<div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">Public Sub Deactivate() Implements Inventor.ApplicationAddInServer.Deactivate<br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Release objects.</strong></span><br />&#0160;&#0160;&#0160; m_attributeButtonDef = Nothing<br />&#0160;&#0160;&#0160; m_UIEvents = Nothing<br />End Sub</div>
<p>&#0160;</p>
<p>With that change, the crash went away. I hadnâ€™t published a new version of the â€œAttribute Helperâ€ add-in for a couple of years so Iâ€™ve made this change and created a new installer.&#0160; You can get the latest version of <a href="http://modthemachine.typepad.com/AttributeHelperSetup_2.6.zip">â€œAttribute Helperâ€ here</a>.&#0160; After installing make sure that youâ€™re running the latest version by checking that the version is 2.6, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8d10e5e970b-pi"><img alt="AttributeHelperVersion" border="0" height="115" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09742c32970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="AttributeHelperVersion" width="365" /></a></p>
<p>And if attributes are new to you, you can learn more about what they are <a href="http://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html">here</a>.&#0160; The source code for the add-in is also available on <a href="https://github.com/brianekins/AttributeHelper/">GitHub</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: dba
EMAIL: 
IP: 10.110.60.162
URL: http://profile.typepad.com/6p01910489d0be970c
DATE: 06/06/2017 11:38:30 AM
Maybe I should post this on a forum... 
If I set an Attribute to a sketchedsymbol (the symbol on the sheet, not the definition!) in a drawingdocument and save this as a template (save a copy in the template folder), when I use the template for new drawings, the attributes are gone... Tested on german Inventor 2016 Pro.
Is this by design? Is this a bug? Are Attributes generally wiped on creating new files?
Thanks!
BR,
Daniel
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Forge DevCon 2017 - Change of date and venue
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-devcon-2017-change-of-date-and-venue
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/01/forge-devcon-2017-change-of-date-and-venue.html 
DATE: 01/20/2017 08:28:39 PM
-----
BODY:
<p>The Autodesk Forge DevCon conference, originally scheduled for June 27-28 in San Francisco, will now be held on November 13-14 in Las Vegas.</p>
<p><strong>One time. One location. Two great conferences.</strong></p>
<p>We received feedback from many of last year&#39;s Forge DevCon attendees that it was hard to travel to two Autodesk conferences in a year. This change will allow you to attend Forge DevCon and <a href="http://au.autodesk.com/">Autodesk University</a> in Las Vegas in a single trip. There will be DevCon-only, AU-only, and AU+DevCon ticketing options available.</p>
<p>Because the conference will now be held five months later, we have postponed the Call For Proposals and attendee registration.</p>
<p><strong>New Date. New Location. Same Great Experience.</strong></p>
<p>Last year, our first Forge DevCon offered two-days of the most up-to-date training, technologies, news, and insights around design, simulation, reality capture, AR, VR, and IoT. It was an indispensable experience for anyone working with the Forge platform.<br />At this year&#39;s event you can expect more of the same. Only more so.<br />Stay tuned for updates and please visit the <a href="http://gems.autodesk.com/events/autodesk-forge-devcon-2017/event-summary-da5182da21a9407795079f65da16c75d.aspx">Forge DevCon 2017 site</a> to learn more.<br />If you have any questions please don&#39;t hesitate to contact us at <a href="mailto:forge.devcon@autodesk.com">forge.devcon@autodesk.com</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: January 2017 Fusion Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: january-2017-fusion-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/01/january-2017-fusion-update.html 
DATE: 01/20/2017 04:53:03 AM
-----
BODY:
<p>There are several new enhancements in this update and a couple that open some new doors on what can be done with the Fusion API.</p>
<ol>
<li>
<p>The first of these is the ability to customize the context menu, or as it&#39;s called in Fusion, the <em>marking menu</em>. You do this by responding to the MarkingMenuDisplaying event which is fired just before the marking menu is shown to the user. Here, you have a chance to find out what&#39;s currently selected in the UI (which is what defines the context) and then add and remove commands from the linear and radial marking menus. Below is an example where a new custom &quot;Design Notes&quot; command is being added to the marking menu when the user right-clicks on the root component.</p>
<div style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb096ee3fe970d-pi"><img alt="ContextMenu_DesignNotes" border="0" height="453" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d255edac970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="ContextMenu_DesignNotes" width="310" /></a></div>
</li>
<li>
<p>There are a couple of breaking changes in this release that we decided to go ahead and make because the functionality being changed is new and/or we believe the likelihood of impact on existing code to be very low. These are:</p>
<ul>
<li>
<p>The various add methods to create new sketch dimensions have a new &quot;isDriving&quot; argument to allow you to create driving or driven dimensions. This is an optional argument with the default value being True to create a driving dimension, which is the same as before. Because it&#39;s an optional argument that defaults to the same result as before, there is no impact to Python or JavaScript programs because they&#39;re interpreted and will automatically use the optional argument. C++ code will need to be recompiled.</p>
</li>
<li>
<p>In the last update we added some changes to bring the API in sync with the user-interface for creating extrusions. There were a couple of mistakes that we need to clean up in this update. The first is that the taperAngleOne and taperAngleTwo properties were typed to return a base.Core object. This has been corrected so they&#39;re typed to return a ModelParameter object.</p>
<p>The second issue is that there were two settings to control the direction of a through-all extent extrusion which was confusing. We&#39;ve removed the &quot;isPositiveDirection&quot; argument from the create method of the ThroughAllExtentDefinition class. If you&#39;ve used this you&#39;ll need to update your code to remove setting that argument and continue to use the &quot;direction&quot; argument on the setOneSideExtent method of the ExtrudeFeatureInput object.</p>
</li>
</ul>
</li>
<li>
<p>With the recent changes to the Extrude feature the API to create extrusions got quite a bit more complicated. However, we recognized that even though the feature is more powerful and provides a lot more capabilities, the majority of the time people still create simple finite extrusions. To make this more common workflow easier, we&#39;ve added a new <a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-0F875632-0DCB-4F18-9176-9617783AE794">addSimple</a>. method to the ExtrudeFeatures collection. This makes creating an extrusion much simpler than it ever was before with a single API call.</p>
</li>
<li>
<p>Fusion recently added the ability to choose which bodies will be affected when creating certain features; extrude, hole, loft, revolve, and sweep. The input objects for each of those features and the feature objects themselves all now support a &quot;participantBodies&quot; property that lets you specify the set of bodies that will participate in the feature. The default is that all visible bodies that intersect the feature will be used, which was also the previous default so existing programs shouldn&#39;t see any change of behavior.</p>
</li>
<li>
<p>An entirely new feature in this update is the ability for an add-in to fire an event to itself. This may seem like a strange thing to do but it opens up some new capabilities for some add-ins. Because all add-ins run in the main thread of Fusion, when the add-in code is actively executing everything else is blocked. This behavior is typical of most applications that have a user-interface. Changes to Fusion data, (both interactively and through the API), is done by code running in the main thread. However, there are cases where an add-in wants to do some separate work outside of Fusion and doesn&#39;t want to block the user interacting with Fusion while this work occurs. It&#39;s possible to create a new thread where this separate work can happen so the main thread isn&#39;t blocked but it hasn&#39;t been possible for that worker thread to communicate back to the add-in in the main thread. This new event provides that capability. See the new <a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-F9FD4A6D-C59F-4176-9003-CE04F7558CCC">Working in a Separate Thread topic</a> in the user manual for more information.</p>
</li>
<li>
<p>A new command input to allow the user to enter an angle, both in a command dialog and in the graphics window is now supported. The AngleValueCommandInput will allow you to create an input like that used to define the angle in the Revolve feature command, like shown below.</p>
<div style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d255edae970c-pi"><img alt="AngleInputExample" border="0" height="347" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8cbbf28970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="AngleInputExample" width="570" /></a></div>
</li>
<li>
<p>In response to <a href="http://forums.autodesk.com/t5/api-and-scripts/is-there-a-way-to-batch-delete-curves/m-p/6582414#M2193">ross.korsky&#39;s question</a> in the forum we&#39;ve added a new deleteEntities method on the Design object. This takes in an array of entities and deletes them all at once which is much simpler and faster than deleting them one at a time, which is what you had to do before. This is similar to selecting several entities and pressing the Delete key in the user-interface.</p>
</li>
<li>
<p>We&#39;ve also fixed several issues we found in our testing and the following problems that were reported on the forum.</p>
<ul>
<li>
<p><a href="http://forums.autodesk.com/t5/api-and-scripts/patch-with-splines/td-p/6756827" rel="noopener noreferrer" target="_blank">darinAZY43 reported a problem</a> where the creation of Patch features was failing when the input curves were non-planar. This has now been fixed.</p>
</li>
<li>
<p><a href="http://forums.autodesk.com/t5/api-and-scripts/divide-path-into-equal-segments/td-p/6753005" rel="noopener noreferrer" target="_blank">GeoffPacker7777 reported a problem</a> where the setByDistanceOnPath method of the ConstructionPlaneInput object was not allowing a Path as input but only single entities. This has now been fixed.</p>
</li>
<li>
<p>It was reported that TableCommandInputs don&#39;t work correctly when your command dialog has tabs with tables on each tab. This has now been fixed.</p>
</li>
</ul>
</li>
</ol>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Store and restore occurrence position
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: store-and-restore-occurrence-position
CATEGORY: Adam
CATEGORY: Attributes
CATEGORY: Inventor
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2017/01/store-and-restore-occurrence-position.html 
DATE: 01/05/2017 02:11:39 PM
-----
BODY:
<p>If you want to store the position of a&#0160;<strong>ComponentOccurrence</strong> in order to be able to restore it later on, then you could simply store the <strong>Transformation</strong> values of the <strong>occurrence</strong>. They could be saved in a separate file, in <strong>Attributes</strong>, some other place - up to you where.</p>
<p>This <strong>VBA</strong> sample will store the values in an <strong>AttributeSet</strong>:</p>
<pre>Sub StorePosition()
  Const kAttSetName = &quot;Adam.OccurrencePosition&quot;
  Const kCellNamePrefix = &quot;cell&quot;
  
  Dim asm As AssemblyDocument
  Set asm = ThisApplication.ActiveDocument
  
  Dim occ As ComponentOccurrence
  Set occ = asm.SelectSet(1)
  
  Dim cells() As Double
  Call occ.Transformation.GetMatrixData(cells)
  
  Dim attValues(15) As Variant
  Dim attNames(15) As String
  Dim attTypes(15) As ValueTypeEnum
  
  Dim i As Integer
  For i = LBound(cells) To UBound(cells)
    attValues(i) = cells(i)
    attNames(i) = kCellNamePrefix + Trim(str(i))
    attTypes(i) = kDoubleType
  Next
  
  Dim attSet As AttributeSet
  If occ.AttributeSets.NameIsUsed(kAttSetName) Then
    Set attSet = occ.AttributeSets(&quot;Adam.OccurrencePosition&quot;)
  Else
    Set attSet = occ.AttributeSets.Add(&quot;Adam.OccurrencePosition&quot;)
  End If
  
  Dim attEnum As AttributesEnumerator
  &#39; If the name was not Trim()-ed this would give an error
  Set attEnum = attSet.AddAttributes(attNames, attTypes, attValues, True)
End Sub

Sub RestorePosition()
  Const kAttSetName = &quot;Adam.OccurrencePosition&quot;
  Const kCellNamePrefix = &quot;cell&quot;
  
  Dim asm As AssemblyDocument
  Set asm = ThisApplication.ActiveDocument
  
  Dim occ As ComponentOccurrence
  Set occ = asm.SelectSet(1)
  
  Dim attSet As AttributeSet
  If occ.AttributeSets.NameIsUsed(kAttSetName) Then
    Set attSet = occ.AttributeSets(&quot;Adam.OccurrencePosition&quot;)
  Else
    Call MsgBox(&quot;Position data was not stored for this occurrence!&quot;)
    Exit Sub
  End If
  
  Dim cells(15) As Double
  Dim i As Integer
  For i = 0 To 15
    Dim cellName As String
    cellName = kCellNamePrefix + Trim(str(i))
    If Not attSet.NameIsUsed(cellName) Then
      Call MsgBox(&quot;Not all position data stored for this occurrence!&quot;)
      Exit Sub
    End If

    cells(i) = attSet(cellName).value
  Next
  
  Dim mx As Matrix
  Set mx = occ.Transformation
  
  Call mx.PutMatrixData(cells)
  
  occ.Transformation = mx
End Sub</pre>
<p>The code in action:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8c423eb970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="StorePosition1" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8c423eb970b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8c423eb970b-320wi" title="StorePosition1" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d24df568970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="StorePosition2" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d24df568970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d24df568970c-320wi" title="StorePosition2" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d24df575970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="StorePosition3" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d24df575970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d24df575970c-320wi" title="StorePosition3" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Parameter I/O issues
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: parameter-io-issues
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/12/parameter-io-issues.html 
DATE: 12/30/2016 10:36:58 AM
-----
BODY:
<p>Our team,&#0160;<a href="http://www.autodesk.com/developers">Autodesk Developer Network</a> / <a href="https://developer.autodesk.com/">Forge Partner Development</a>, created a few <strong>add-in</strong>&#39;s for the <a href="https://apps.autodesk.com/en">Autodesk App Store</a>, including the <a href="https://apps.autodesk.com/FUSION/en/Home/Index">Fusion 360 one</a> as well (they all have the support email:&#0160;<a href="mailto:fusion.apps@autodesk.com">fusion.apps@autodesk.com</a>)</p>
<p>The main purpose of those <strong>add-in</strong>&#39;s were to show how powerful <a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a>&#39;s can be, how it can help you automate boring tasks, e.g. moving parameter values from <strong>Fusion 360</strong>&#0160;to another application and back. When you select these <strong>add-in</strong>&#39;s in the <strong>Scripts and&#0160;Add-Ins </strong>dialog&#0160;of <strong>Fusion 360</strong>, then you can click &quot;<strong>Edit</strong>&quot; and see the source code. You are free to use that source code, modify it, and even use it to create a commercial app out of it :)<br />If you think that some of the functionality shown by those <strong>add-in</strong>&#39;s should be part of <strong>Fusion 360</strong>, then you can ask for that on the <a href="https://forums.autodesk.com/t5/ideastation-request-a-feature-or/idb-p/125">Fusion 360 IdeaStation</a> :) &#0160;</p>
<p>After that small intro, here are the two errors&#0160;that people contacted me about so far concerning the <a href="https://apps.autodesk.com/FUSION/en/Detail/Index?id=1801418194626000805&amp;appLang=en">Parameter I/O</a> add-in. I have not heard of other ones yet:</p>
<p><strong>1) Cannot import CSV file after editing it in Excel </strong></p>
<p>Maybe other apps could have this issue too, but I&#39;ve only heard of&#0160;<strong>Excel</strong>&#0160;in this context. <strong>Parameter I/O</strong> expects the <strong>CSV</strong> file&#39;s content in a given format. In each line of the file there should be values formatted like this: &lt;parameter name&gt;<strong>,</strong>&lt;unit&gt;<strong>,</strong>&lt;value&gt;<strong>,</strong>&lt;comment&gt;&#0160;<br />Please note that each value is separated by a <strong>comma</strong>, just like the meaning of <a href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a> suggests: <strong>CSV</strong> = <strong>C</strong>omma <strong>S</strong>eparated <strong>V</strong>alues. Any of the values could also be wrapped in quotation marks as well: <strong>&quot;MyParam&quot;,in,&quot;12.00&quot;,&quot;Some comment&quot;<br /></strong><br />Depending on your computer&#39;s&#0160;<strong>Regional</strong> or <strong>Locale</strong> settings, <strong>Excel</strong> might use another character (e.g. semi-colon &#39;<strong>;</strong>&#39;) to separate the values. <strong>Parameter I/O</strong> does not like that :(<br />So please open up the problem&#0160;<strong>CSV</strong> file in a <strong>Text editor</strong>&#0160;and make sure that the formatting is correct before trying to import the values from it. You can also find articles on the net about changing the character&#0160;<strong>Excel</strong> is using for value separation.</p>
<p><strong>2) Cannot move parameters from one model to another</strong></p>
<p>In other words, the workflow in question is: export parameters of one model, then import it in another model.&#0160;<br />You might run into issues when in your model one parameter is referencing another one, e.g. <strong>MyParam1 = MyParam2 * 3</strong>&#0160;<br />When you export the parameter values from your model, they might be saved in the <strong>CSV</strong> file in a way that a parameter is being referenced <span style="text-decoration: underline;">before</span> it&#39;s declared:</p>
<pre>MyParam1,in,<strong>MyParam2</strong>*3,Comments
<strong>MyParam2</strong>,in,12,Comments</pre>
<p>Unfortunately, if you leave the <strong>CSV</strong>&#0160;file like that and try to <strong>import</strong> it into a new model which does not have those parameters yet, then the program will throw an error during the import. That&#39;s because when creating <strong>MyParam1</strong>, the program is trying to set its value to something that does not make sense at that given moment:&#0160;<strong>MyParam2*3</strong>&#0160;<br />The problem with that is that&#0160;<strong>MyParam2</strong> does not exist in the new model <span style="text-decoration: underline;">just&#0160;yet</span>. &#0160;</p>
<p>You would have to reorganize the content of the <strong>CSV</strong> file in a way that <strong>MyParam2</strong> is declared <span style="text-decoration: underline;">before</span>&#0160;<strong>MyParam1</strong>.&#0160;&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steve
EMAIL: 
IP: 24.130.85.159
URL: http://profile.typepad.com/6p01b7c8fc42cc970b
DATE: 05/26/2017 06:06:35 PM
There are other problems with Parameter IO as I've discovered in the last 24 hours.

First, it throws an error if you try to use a reserved parameter NAME. One big problem with this (IMHO) is that I can find no list of reserved parameter names! The only way I've found to discover the offending name is to try entering them manually through "Change Parameters" in Fusion360. But this plugin exists to avoid manual entry!

Second, once it throws the error, it ALWAYS throws the same error when you try to import ANY .csv files intended as parameters! And this persists if you shut down and restart F360, if you reboot your computer, even if you un/re-install F360!

I'm hoping that the "Adam" who posted this is the same Adam at Autodesk I've been working with to try to resolve these problems.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: CNC Fun
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: cnc-fun
CATEGORY: Brian
CATEGORY: Fusion 360
CATEGORY: Utilities
CATEGORY: Woodworking

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/12/cnc-fun.html 
DATE: 12/13/2016 06:56:04 PM
-----
BODY:
<p>This past June for the <a href="http://gems.autodesk.com/events/autodesk-forge-devcon-2017/event-summary-da5182da21a9407795079f65da16c75d.aspx">Forge Developer Conference</a> I worked with some of the great folks at <a href="https://www.opendesk.cc/">opendesk</a> and <a href="http://www.shopbottools.com/">ShopBot</a> to put together a working demonstration using their furniture designs, machine tools, and Fusion 360.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bc69e9970b-pi"><img alt="Johann-Stool" border="0" height="357" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb095f50ea970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Johann-Stool" width="348" /></a></p>
<p>opendesk has a large catalog of furniture designs that are made locally on-demand from sheet stock. You should <a href="https://www.opendesk.cc/">check out their website</a> because itâ€™s an interesting concept.&#0160; ShopBot has a selection of CNC routers in all sizes from large 12 by 5 foot monsters down to the portable Handibot.&#0160; We decided to use the <a href="https://www.opendesk.cc/nouvelle-fabrique/johann-stool">Johann Stool</a> design from opendesk and allow attendees at the conference to design custom engravings for the top of the stool that would be cut at the conference using a ShopBot tool.&#0160;</p>
<p>I got involved to try and create a simple interface to allow non Fusion 360 users to easily create a design and send it to the router.&#0160; This consisted of two parts.&#0160; First I created a series of Fusion 360 custom commands that draw various designs as a sketch.&#0160; The picture below shows the new panel that the add-in creates in Fusion and its commands.&#0160; There are several different patterns that the commands allow you to create.&#0160; The one shown below creates a rectangular mesh with the grid positions randomized.&#0160; Thereâ€™s also a command that creates several polygons to create a flower pattern, one that creates circles in a random pattern, one that rectangles arranges randomly, and finally one that draws sin curves.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2461dc3970c-pi"><img alt="StoolDesign" border="0" height="549" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bc69ed970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="StoolDesign" width="618" /></a></p>
<p>&#0160;</p>
<p>The main thing to remember with all of these specialized commands is that theyâ€™re just automating the creation of sketch geometry.&#0160; Below is the result of using the custom sketch commands and a bit of manual editing on the resulting sketches to create a new design.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb095f50f0970d-pi"><img alt="CustomDesign" border="0" height="535" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb095f50f4970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="CustomDesign" width="451" /></a></p>
<p>The last custom command provided by the add-in sends the design to the CNC router.&#0160; To make the entire process easier, it doesnâ€™t use the NC capabilities of Fusion 360 but with a single button click it directly creates the g-code data from the sketch geometry and sends it to the CNC router.&#0160; The command gets the geometry information from the sketch and essentially treats the sketch geometry as the tool path to create a g-code file that will drive the cutter along the sketch geometry.&#0160; Splines and circles are stroked into small lines and text is also converted into lines so the g-code consists entirely of point-to-point directions. Below is an example of one of the stool seats that contains some text.&#0160; To reduce the time at the conference to create a stool the stools were already mostly cut out in panels of birch plywood and then only the custom pattern on top needed to be machined.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bc69f4970b-pi"><img alt="forgeExample" border="0" height="348" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2461dcb970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="forgeExample" width="582" /></a></p>
<p>&#0160;</p>
<p>Hereâ€™s Bill from ShopBot at the booth cutting a stool top. Bill also <a href="http://www.shopbotblog.com/2016/07/makelocal-forge-devcon/">reported on the experience</a> in his blog.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb095f50fd970d-pi"><img alt="Autodesk Forge DevCon 2016" border="0" height="442" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bc69fb970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Autodesk Forge DevCon 2016" width="663" /></a></p>
<p>&#0160;</p>
<p>Besides doing the stools, ShopBot also brought a couple of the portable <a href="https://handibot.com/">Handibot</a> CNC routers and we used the same process to machine small badges that people could design in the same way. If you havenâ€™t seen the Handibot before you should check out the website and look at some videos on YouTube to see what people are doing with it.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb095f5102970d-pi"><img alt="Shopbot2" border="0" height="386" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bc6a02970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Shopbot2" width="657" /></a>&#0160;</p>
<p><img height="372" src="http://www.shopbotblog.com/wp-content/uploads/2016/07/2016-06-15-17.52.55.jpg" style="float: none; margin-left: auto; display: block; margin-right: auto;" width="662" /></p>
<p>The whole process of getting ready for the Forge conference was a lot of fun and very educational for me.&#0160; CNC isnâ€™t new to me but I hadnâ€™t every directly written g-code before.&#0160; The entire Fusion stool add-in is currently available on <a href="https://github.com/brianekins/StoolDesign">github</a>.&#0160; This could easily be done with Inventor too but so far Iâ€™ve only needed it for some Fusion 360 events.</p>
<p>After the Forge conference, a couple of guys from Autodesk (Philippe and Lucas) wanted to do something interesting with a Handibot at another event.&#0160; They liked what we had done at the Forge conference and had the great idea of cutting chocolate. Philippe is a much more colorful writer than me and has written a report about their <a href="http://labs.blogs.com/its_alive_in_the_lab/2016/12/milling-for-chocolate-by-philippe-videau-and-lucas-prokopiak.html">adventure with chocolate</a>.</p>
<p><a href="http://labs.blogs.com/its_alive_in_the_lab/2016/12/milling-for-chocolate-by-philippe-videau-and-lucas-prokopiak.html"><img alt="millingForChocolate" border="0" height="297" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8bccac1970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="millingForChocolate" width="528" /></a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Updated Sheet Metal Extents Add-In
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: updated-sheet-metal-extents-add-in
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Sheet Metal
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/12/updated-sheet-metal-extents-add-in.html 
DATE: 12/13/2016 02:06:32 AM
-----
BODY:
<p>Kirk Arthur reminded me at Autodesk University about an <a href="http://modthemachine.typepad.com/my_weblog/2016/03/is-your-add-in-causing-problems-in-inventor-2017.html">issue with add-ins</a> that I had blogged about and asked if I had made the recommended change to the Sheet Metal Extents add-in.&#0160; I truthfully couldnâ€™t remember so Iâ€™ve gone ahead and bumped the version number, recompiled it, built the installer, and made the <a href="http://modthemachine.typepad.com/SheetMetalExtentsInstall.zip">new version</a> available.&#0160; As usual, please let me know if you run into any problems with it.&#0160; This is version 3.8 and should be compatible with Inventor 2013 and later.&#0160; Use this <a href="http://modthemachine.typepad.com/SheetMetalExtentsInstall.zip">link</a> to download a zip file that contains an installer that will install the add-in.</p>
<p>If youâ€™re unfamiliar with this add-in, hereâ€™s the text from the ReadMe with a brief description.</p>
<blockquote>
<p>This is an Add-In that when installed will automatically create and update three custom iProperties.&#0160; It should work for Inventor 2013 and later.&#0160; The iProperties created are:</p>
<p>SheetMetalLength - The length of the sheet metal flat pattern.<br />SheetMetalWidth - The width of the sheet metal flat pattern.<br />SheetMetalStyle - The active sheet metal style (or rule).</p>
<p>It also creates the following two reference parameters:</p>
<p>SheetMetalLength - The length of the sheet metal flat pattern.<br />SheetMetalWidth - The width of the sheet metal flat pattern.</p>
<p>The SheetMetalLength and SheetMetalWidth iProperties are the result of the two parameters being set to be exposed as iProperties.&#0160; The output format for these parameters can be edited to change the formatting of the associated iProperties.&#0160; The parameters should not be used as input to other parameters that control the shape of the part because this can result in cycles being created.</p>
</blockquote>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jef_E
EMAIL: jefeerdekens@hotmail.com
IP: 91.183.126.105
URL: 
DATE: 12/15/2016 10:15:26 AM
Brian,

Is it possible for me to view the source code of the Add-In? I'm constantly trying to learn and I have build a similar tool, now I would like to compare my code vs yours to see what you did, and what I can do better.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.72.146
URL: http://profile.typepad.com/1218580234s15464
DATE: 12/15/2016 04:49:30 PM
I used to package the source with each update but now I've gone ahead and published it to github.  You can find it here: <a href="https://github.com/brianekins/SheetMetalExtents">https://github.com/brianekins/SheetMetalExtents</a>
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: No log-in page on Mac when joining public WiFi
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: no-log-in-page-on-mac-when-joining-public-wifi
CATEGORY: Adam

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/12/no-log-in-page-on-mac-when-joining-public-wifi.html 
DATE: 12/04/2016 11:14:33 PM
-----
BODY:
<p>This has nothing to do with <strong>Autodesk</strong> software but thought I would write it down at least for my own benefit as I have not seen this solution mentioned anywhere else.</p>
<p>When joining the hotel <strong>WiFi</strong> with my <strong>Mac</strong> I&#39;m not redirected to any webpage, so I cannot log in, which means I don&#39;t have internet access. :(</p>
<p>When I was looking around in the <strong>System Preferences</strong>&#0160;&gt;&gt; <strong>Network</strong> settings to try one of the workarounds of removing <strong>DNS</strong> servers or adding the <strong>google</strong> ones, I saw&#0160;that a <strong>DNS</strong> server has automatically been added.</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2425f65970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="NetworkSettings" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d2425f65970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d2425f65970c-500wi" title="NetworkSettings" /></a></p>
<p>I went to that <strong>IP</strong> address in my browser, and voilÃ !, the log-in page came up :)&#0160;</p>
<p>Maybe this only works with this specific <strong>WiFi</strong>, but could be a generic solution. In case of many other&#0160;<strong>WiFi&#39;s</strong> the log-in page <strong>IP</strong>&#0160;was simply <strong>192.168.1.1</strong></p>
<p>-Adam</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Forge DevCon - Call For Proposals
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-devcon-call-for-proposals
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/11/forge-devcon-call-for-proposals.html 
DATE: 11/29/2016 10:58:46 PM
-----
BODY:
<p>Have you created something cool using&#0160;the&#0160;<a href="https://forge.autodesk.com/">Autodesk Forge</a> platform and want to share with others what you learnt? :)<br />Then why not do it at our next <a href="http://gems.autodesk.com/events/autodesk-forge-devcon-2017/event-summary-da5182da21a9407795079f65da16c75d.aspx">Autodesk Forge DevCon</a>&#0160;taking place at the <strong>Fort Mason Center</strong>, <strong>San Francisco</strong>,&#0160; <strong>June 27th to 28th, 2017</strong>?</p>
<p><a href="http://adndevblog.typepad.com/cloud_and_mobile/2016/11/forge-devcon-call-for-proposals.html">Call for proposals</a> is now open.</p>
<p>To submit your proposal, visit <a href="http://autode.sk/2fl3CeL" rel="noopener noreferrer" target="_blank">forge.autodesk.com/AttendDevCon</a> and click on the &#39;<strong>Call for Papers</strong>&#39; tab - or go straight to the <a href="http://autode.sk/2fkZThe" rel="noopener noreferrer" target="_blank">Call for Papers</a> site, where you&#39;ll find more information about the types of sessions we&#39;re looking for.</p>
<p>-Adam&#0160;(<a href="https://twitter.com/adamthenagy">@AdamTheNagy</a>)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Einladung Kindergeburtstag
EMAIL: galihants@gmail.com
IP: 115.178.216.129
URL: http://www.kindergeburtstagseinladungen.net/
DATE: 02/16/2017 03:17:47 PM
nice
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360: Oct. 5, 2016 Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360oct-5-2016-update
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/10/fusion-360oct-5-2016-update.html 
DATE: 10/06/2016 01:00:00 AM
-----
BODY:
<p>A new Fusion 360 update went out today and it has several new features in the API.</p>
<ol>
<li>
<p>The one I want to discuss first is one that has the potential of breaking some existing programs.&#0160; If you use C++ and have written a program that created sketch dimensions then your programs are affected.&#0160; Your source code is ok, but youâ€™ll need to compile to create a new dll or dylib file.&#0160; Whatâ€™s changed is that we added a new argument to all of the sketch dimension add methods so you can specify if you want to create a drive or driving dimension. When the API for this was first designed Fusion only supported driving dimensions, which means the dimension controls or drives the geometry. Fusion has since added support for driven dimensions which means the geometry controls the dimension.&#0160; The new argument is optional and defaults to creating a driving dimensions so existing Python and JavaScript programs will function the same as they always have.</p>
</li>
<li>
<p>One of the highlights of this release is the addition of the new table command input. This will allow a much nicer interface for many commands and provide the ability to create some commands that just werenâ€™t possible before.&#0160; What a table command input provides is the ability to arrange other command inputs within rows and columns.&#0160; Below are some examples where Fusion uses a table command input in commands. The first table in the Loft command has three columns where the first column is a read-only StringCommandInput, and the second and third are both DropDownCommandInputs.&#0160; The Properties command just uses read-only StringCommandInput objects to display text. And you can see that the Scene Settings dialog uses an ImageCommandInput so itâ€™s very flexible.</p>
<p>In addition to arranging command inputs in rows and columns it also supports the ability to have a toolbar that contains command inputs. Thatâ€™s how the â€œ+â€ and â€œxâ€ buttons are done in the Profiles and Lofts tables.<br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb093d8948970d-pi"><img alt="TableCommandInput1" border="0" height="768" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d223f00d970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="TableCommandInput1" width="720" /></a>&#0160;</p>
</li>
<li>Some additional Data Panel related functionality has been added to the API.&#0160; You now have access to all hubs and the projects within each hub. Additional functionality is also supported for files (copy, delete, getting child references, etc.).</li>
<li>
<p>You can now use the API to define, query, and enable contact sets.</p>
</li>
<li>
<p>One other thing thatâ€™s not really part of the API itself but is something that quite a few people use is the Spur Gear sample script and add-in. Iâ€™ve updated it to fix an issue it had with units but have also added quite a bit of functionality.&#0160; Below is a list of changes and enhancements that have been made.</p>
<ul>
<li>Supports English and Metric definition of gears.</li>
<li>Units are either inches or millimeters depending on whether &quot;English&quot; or &quot;Metric&quot; is chosen as the standard. The default standard is chosen based on the default units for the document.</li>
<li>All of the timeline items that were created as a result of building the gear are grouped into a single timeline node.</li>
<li>Draws a sketch circle in the model that represents the pitch diameter.</li>
<li>Models a fillet at the root of the tooth or no fillet if a radius of 0 is specified.</li>
<li>Models a hole at the center of the gear or no hole if a diameter of 0 is specified.</li>
<li>The dialog is initialized with the values used for the previous gear in the current design.</li>
<li>Supports specifying a backlash value. This is useful for both precise gears to help reduce wear so the tooth isnâ€™t in contact both on both sides.&#0160; Itâ€™s also very important when creating gears using imprecise manufacturing methods.&#0160; For example, because of how most parts are 3D printed that arenâ€™t a perfect copy of the original model because of how the printing process works.&#0160; This will allow you to provide some extra tolerance so that the gears can still function as needed.</li>
</ul>
</li>
</ol>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c89a18d3970b-pi"><img alt="SpurGear" border="0" height="554" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c89a18d7970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="SpurGear" width="290" /></a>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Einladung Kindergeburtstag
EMAIL: galihants@gmail.com
IP: 115.178.216.129
URL: http://www.kindergeburtstagseinladungen.net/
DATE: 02/16/2017 03:34:02 PM
nice 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating Construction Geometry in Assemblies in Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-construction-geometry-in-assemblies-in-inventor
CATEGORY: Assemblies
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/09/creating-construction-geometry-in-assemblies-in-inventor.html 
DATE: 10/01/2016 06:52:01 AM
-----
BODY:
<p>I was working on answering a question recently and put together a bit of code to make sure my answer was correct and thought it might be useful to some others so I want to share it here.</p> <p>The initial question was a good one. The question was how to create an offset work plane in an assembly using the API. The obvious thing is to use the AddByPlaneAndOffset method of the WorkPlanes collection but if you try it, it will fail and if you look at the help it will tell you that itâ€™s not supported in assemblies, but it also doesnâ€™t say how to do it.</p> <p>Assemblies and construction geometry are a bit strange. Working interactively with Inventor, work geometry seems to work just that same as when working in a part, but if you look close youâ€™ll see a big difference. If you create an offset work plane using the UI in an assembly and then look at the result in the browser youâ€™ll see the work plane in the browser just like you would in a part, except in an assembly the work plane browser node can be expanded and then youâ€™ll see that thereâ€™s a flush constraint.&nbsp; Work geometry in a part has intelligence within itself to know what itâ€™s related to and how itâ€™s related so if that geometry is modified it can correctly re-compute itself.&nbsp; Work geometry in an assembly isnâ€™t intelligent at all.&nbsp; It just exists in space and the intelligence to position it is done by adding constraints.&nbsp; </p> <p>The assembly work geometry commands have a lot of intelligence in them and will create the work geometry and automatically add the needed constraints to get the desired behavior.&nbsp; The API doesnâ€™t do this. You can create a work plane in space but then you need to add the flush constraint as a separate step. In an assembly, the only way you can create work geometry is to use the AddFixed methods on each of the work geometry collections.</p> <p>Below is the VBA code I wrote to test this. It demonstrates getting a selected face and then creating a work plane on that face. Iâ€™m using an offset of 0, but any offset could be used.&nbsp; A fair amount of the code is just figuring out the orientation of the work plane.&nbsp; Although the orientation doesnâ€™t really matter except for looks.&nbsp; To get a logical orientation it uses the longest linear edge on the selected face and if there arenâ€™t any linear edges then it aligns it with one of the primary model axes. The UI command also does some additional work to size the created work plane to fit the geometry, which the API and this sample doesnâ€™t do.&nbsp; The API does support setting the size of a work plane but I havenâ€™t attempted that here.<br></p> <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%"> <p>Public Sub CreateWorkPlane()<br>&nbsp;&nbsp;&nbsp; Dim asmDoc As AssemblyDocument<br>&nbsp;&nbsp;&nbsp; Set asmDoc = ThisApplication.ActiveDocument<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; Dim asmDef As AssemblyComponentDefinition<br>&nbsp;&nbsp;&nbsp; Set asmDef = asmDoc.ComponentDefinition<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <strong><font color="#0000ff">' Have a planar face selected.</font></strong><br>&nbsp;&nbsp;&nbsp; Dim selFace As Face<br>&nbsp;&nbsp;&nbsp; Set selFace = ThisApplication.CommandManager.Pick(kPartFacePlanarFilter, "Select planar face")<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Get the underlying plane geometry from the face.<br></strong></font>&nbsp;&nbsp;&nbsp; Dim facePlane As Plane<br>&nbsp;&nbsp;&nbsp; Set facePlane = selFace.Geometry<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; Dim tg As TransientGeometry<br>&nbsp;&nbsp;&nbsp; Set tg = ThisApplication.TransientGeometry<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Find the longest linear edge on the face and use it as the X axis.</strong></font><br>&nbsp;&nbsp;&nbsp; Dim testEdge As Edge<br>&nbsp;&nbsp;&nbsp; Dim longDir As UnitVector<br>&nbsp;&nbsp;&nbsp; Dim longLength As Double<br>&nbsp;&nbsp;&nbsp; longLength = 0<br>&nbsp;&nbsp;&nbsp; For Each testEdge In selFace.Edges<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If testEdge.GeometryType = kLineSegmentCurve Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim lengthVec As Vector<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set lengthVec = testEdge.StartVertex.Point.VectorTo(testEdge.StopVertex.Point)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If lengthVec.length &gt; longLength Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; longLength = lengthVec.length<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set longDir = lengthVec.AsUnitVector<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; Next<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; Dim xVec As UnitVector<br>&nbsp;&nbsp;&nbsp; Dim yVec As UnitVector<br>&nbsp;&nbsp;&nbsp; Dim pi As Double<br>&nbsp;&nbsp;&nbsp; pi = Atn(1) * 4<br>&nbsp;&nbsp;&nbsp; If Not longDir Is Nothing Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Use the longest edge as the x direction for the work plane.</strong></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set xVec = longDir<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set yVec = facePlane.Normal.CrossProduct(xVec)<br>&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' No linear edges was found so calculate another axis to use as the x axis.<br></strong></font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Use the model x, y, or z axis depending on which one is closest to 90 deg from the normal.</strong></font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim angleDiff As Double<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim testVec As UnitVector<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set testVec = tg.CreateUnitVector(1, 0, 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; angleDiff = Abs((pi / 2) - facePlane.Normal.AngleTo(testVec))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set xVec = testVec<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set testVec = tg.CreateUnitVector(0, 1, 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Abs((pi / 2) - facePlane.Normal.AngleTo(testVec)) &lt; angleDiff Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; angleDiff = Abs((pi / 2) - facePlane.Normal.AngleTo(testVec))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set xVec = testVec<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set testVec = tg.CreateUnitVector(0, 0, 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Abs((pi / 2) - facePlane.Normal.AngleTo(testVec)) &lt; angleDiff Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; angleDiff = Abs((pi / 2) - facePlane.Normal.AngleTo(testVec))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set xVec = testVec<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set yVec = facePlane.Normal.CrossProduct(xVec)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set xVec = yVec.CrossProduct(facePlane.Normal)<br>&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Create the "fixed" work plane.<br></strong></font>&nbsp;&nbsp;&nbsp; Dim wp As WorkPlane<br>&nbsp;&nbsp;&nbsp; Set wp = asmDef.WorkPlanes.AddFixed(facePlane.RootPoint, xVec, yVec)<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <font color="#0000ff"><strong>' Create a flush constraint between the face and the workplane with an offset of 0.</strong></font><br>&nbsp;&nbsp;&nbsp; Dim flush As FlushConstraint<br>&nbsp;&nbsp;&nbsp; Set flush = asmDef.Constraints.AddFlushConstraint(selFace, wp, 0, facePlane.RootPoint, facePlane.RootPoint)<br>End Sub</p></div> <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Forge Hackathon Webinars
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-hackathon-webinars
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/09/forge-hackathon-webinars.html 
DATE: 09/19/2016 11:10:23 PM
-----
BODY:
<p>I posted about the Forge Hackathon earlier but just want to remind everyone that the webinars begin tomorrow.&#0160; I know the majority of you probably aren&#39;t interested in participating in the hackathon itself but might be curious about what Forge is.&#0160; You can sign up and attend the webinars without participating in the hackathon.</p>
<p>You can learn more about the event at <a href="http://autodeskforge.devpost.com/">http://autodeskforge.devpost.com/</a></p>
<p>And more information specifically about the webinars is at <a href="http://autodeskforge.devpost.com/details/webinars">http://autodeskforge.devpost.com/details/webinars</a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360 August 7 Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-august-7-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/09/fusion-360-august-7-update.html 
DATE: 09/08/2016 07:01:27 PM
-----
BODY:
<p>Fusion 360 rolled out a new update yesterday and there are quite a few API enhancements.&#0160; For a complete list you can go to the <a href="http://help.autodesk.com/view/NINVFUS/ENU/?guid=GUID-36B1FFB5-5291-4532-8F11-90E912769B34">Fusion 360 API help</a>, but here are some of the highlights.</p>
<p><strong>Getting the Active Length Unit<br /></strong>Thereâ€™s been a problem since the beginning of the API that we just recently discovered and have fixed in this release, but itâ€™s possible that you may need to react to this change in your code.&#0160; If you want to find out what length units the user has chosen to use, (as shown below), you can use the defaultLengthUnits property of the UnitsManager object that you get from the Design object.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0934565c970d-pi"><img alt="FusionUnits" border="0" height="157" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c890e1bc970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="FusionUnits" width="207" /></a>&#0160;&#0160;&#0160;</p>
<p>&#0160;</p>
<p>This returns a string indicating what the current length units are.&#0160; The problem was that the string returned wasnâ€™t consistent and depended on the preference settings highlighted below.&#0160; So if the units were inch you could get back â€œinchâ€, â€œinâ€, or &quot; (a single double quote).&#0160; Itâ€™s likely that you didnâ€™t discover this in your testing because the preferences were always consistent on your machine but then when someone else uses your program it could break because they have a different setting.&#0160; The API now always returns the abbreviated form of the unit.&#0160; So you can now always expect one of the following â€œinâ€, â€œftâ€, â€œmmâ€, â€œcmâ€, or â€œmâ€.&#0160; If you were looking for other versions like â€œinchâ€ or â€œcentimeterâ€ in your code, youâ€™ll need to adjust for that.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d21a9cd2970c-pi"><img alt="FusionUnitDisplay" border="0" height="167" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0934563c970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="FusionUnitDisplay" width="598" /></a></p>
<p>&#0160;</p>
<p><strong>Additional Feature Creation</strong><br />The API now supports the creation of some additional features.&#0160; These are Loft and two different flavors of Delete Face; deleting a face in the Patch workspace (SurfaceDeleteFaceFeature) and deleting face in the Model workspace (DeleteFaceFeature).&#0160; If you hadnâ€™t noticed previously, these commands behave quite differently in the two workspaces.&#0160; When deleting faces in the Patch workspace faces are removed from the model.&#0160; When deleting faces in the Model workspace, the face is removed and then the model is â€œhealedâ€ to close the solid.</p>
<p>&#0160;</p>
<p><strong>Getting a Body as NURBS</strong><br />A body in Fusion can consist of a mix of surfaces of different geometry types.&#0160; For example, a box with a hole in it is made up of 6 planes and 1 cylinder.&#0160; Freeform surfaces in a body are represented by NURBS surfaces.&#0160; Some applications prefer to deal exclusively with NURBS rather than a mix of NURBS and analytic surfaces.&#0160; The new BRepBody.convert method creates a new transient body that is a copy of the original body but all of the geometry has been converted to NURBS surfaces.&#0160; New functionality is also provided through the new tempId property of the BRepFace, BrepEdge, and BRepVertex objects and the new findByTempId method of the BRepBody to find the vertices, edges, and faces, that match between the original body and the new body.</p>
<p>&#0160;</p>
<p>Weâ€™re working hard on some other API enhancements for the update currently scheduled for the end of September.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Robert F Rice
EMAIL: Rfrice97@yahoo.com
IP: 69.243.219.27
URL: 
DATE: 11/15/2016 03:04:38 PM
Hi! My Bf has the program but he does not have Facebook. He is having a problem,  he was out of town and had not sighted in for 2 weeks and now it won't let him sighn in. Please email him if possible he has been trying to contact for help for over a week and can't get any.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Forge and Fusion 360 Hackathon
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-and-fusion-360-hackathon
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/09/forge-and-fusion-360-hackathon.html 
DATE: 09/08/2016 12:45:30 AM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09340f6b970d-pi"><img alt="Hackathon" border="0" height="347" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d21a56d8970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Hackathon" width="802" /></a></p>
<p style="text-align: left">Autodesk is sponsoring another Hackathon this year for the new Forge platform and is also including the Fusion 360 client API.&#0160; The Fusion 360 Hackathon last year resulted in the development of a <a href="https://apps.autodesk.com/FUSION/en/Home/Index">lot of great apps</a>.&#0160; Most of the learning content from that Hackathon is now available on the <a href="https://autodeskfusion360.github.io/">Fusion 360 Github site</a>.&#0160; This year we wonâ€™t go into the same detail we did previously on Fusion 360 but there will be one overview seminar on Fusion 360â€™s API.&#0160; This year Autodesk is still providing the same $500 reward for apps that are submitted to the Autodesk App Store.</p>
<p>Most of the presentations for this Hackathon will be covering the various Forge APIâ€™s.&#0160; You donâ€™t have to have an app in mind or even be a developer to participate in or benefit from the Hackathon.&#0160; This is a great chance to just learn in more detail what Forge is and what you can do with it.&#0160; Forge applies to Inventor as much as it does to Fusion 360, so itâ€™s something that Inventor users can benefit by learning about it too.</p>
<p>The Hackathon officially started on Sept. 1, but the first seminar isnâ€™t until Sept. 20 so you havenâ€™t missed anything yet.&#0160; For more information about the Hackathon, including the seminar schedule and the rules for the $500 reward go to the <a href="http://autodeskforge.devpost.com/">Forge Hackathon official website</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Drive robot arm in Fusion - update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: drive-robot-arm-in-fusion-update
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion-update.html 
DATE: 08/22/2016 04:06:07 PM
-----
BODY:
<p>Actually, modifying the <strong>Alignment Angle</strong>&nbsp;wasn't the best thing to do in my <a href="http://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion.html">previous article</a>. I should have played with the&nbsp;<span class="s1"><strong>RevoluteJointMotion.</strong></span><span class="s1"><strong>rotationValue&nbsp;</strong>instead. That's what the "<strong>Drive Joints</strong>" command is modifying as well. And this way the <strong>Joint Limits</strong> will be honoured too :)</span></p>
<p><span class="s1"> <a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c88a8cc4970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c88a8cc4970b img-responsive" title="DriveJoints" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c88a8cc4970b-500wi" alt="DriveJoints" /></a></span></p>
<p>I also improved things a bit so that now you can select the two <strong>Revolute Joints</strong> that you want to drive using the command:</p>
<pre>#Author-
#Description-

import adsk.core, adsk.fusion, adsk.cam, traceback

# Global variable used to maintain a reference to all event handlers.
handlers = []

# Other global variables
commandName = "MoveRobot"
app = adsk.core.Application.get()
if app:
    ui = app.userInterface
    
revoluteJoint1 = None
revoluteJoint2 = None
isReverseUpDown = False
isReverseLeftRight = False
revolutionStep = 0.1

# Event handler for the keyDown event.
class MyKeyDownHandler(adsk.core.KeyboardEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        try:
            eventArgs = adsk.core.KeyboardEventArgs.cast(args)
            keyCode = eventArgs.keyCode    
                
            if keyCode == adsk.core.KeyCodes.UpKeyCode:
                if isReverseUpDown:
                    diffVal = -revolutionStep
                else:
                    diffVal = revolutionStep
                motion = revoluteJoint1.jointMotion
                motion.rotationValue = motion.rotationValue + diffVal
            elif keyCode == adsk.core.KeyCodes.DownKeyCode:
                if isReverseUpDown:
                    diffVal = revolutionStep
                else:
                    diffVal = -revolutionStep               
                motion = revoluteJoint1.jointMotion
                motion.rotationValue = motion.rotationValue + diffVal
            elif keyCode == adsk.core.KeyCodes.LeftKeyCode:
                if isReverseLeftRight:
                    diffVal = -revolutionStep
                else:
                    diffVal = revolutionStep                
                motion = revoluteJoint2.jointMotion
                motion.rotationValue = motion.rotationValue + diffVal
            elif keyCode == adsk.core.KeyCodes.RightKeyCode:
                if isReverseLeftRight:
                    diffVal = revolutionStep
                else:
                    diffVal = -revolutionStep                
                motion = revoluteJoint2.jointMotion
                motion.rotationValue = motion.rotationValue + diffVal
            
            # Refresh the view to show the change
            vp = app.activeViewport
            vp.refresh()
            
        except:
            ui.messageBox('Failed:\n{}'.format(traceback.format_exc()))              

# Event handler for the inputChanged event.
class MyInputChangedHandler(adsk.core.InputChangedEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        eventArgs = adsk.core.InputChangedEventArgs.cast(args)

        commandInput = eventArgs.input
        if commandInput.id == commandName + '_step':
            global revolutionStep
            revolutionStep = commandInput.value
        elif commandInput.id == commandName + '_reverseUpDown':
            global isReverseUpDown
            isReverseUpDown = commandInput.value
        elif commandInput.id == commandName + '_reverseLeftRight':
            global isReverseLeftRight
            isReverseLeftRight = commandInput.value
        
        
# Event handler for the executePreview event.
class MyExecutePreviewHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        eventArgs = adsk.core.CommandEventArgs.cast(args)
        
        # Make it accept the changes whatever happens
        eventArgs.isValidResult = True
        

class MyCommandCreatedHandler(adsk.core.CommandCreatedEventHandler):    
    def __init__(self):
        super().__init__()        
    def notify(self, args):
        try:
            command = adsk.core.Command.cast(args.command)
            
            # Subscribe to the various command events
            onInputChanged = MyInputChangedHandler()
            command.inputChanged.add(onInputChanged)
            handlers.append(onInputChanged)

            onExecutePreview = MyExecutePreviewHandler()
            command.executePreview.add(onExecutePreview)
            handlers.append(onExecutePreview)
        
            onKeyDown = MyKeyDownHandler()
            command.keyDown.add(onKeyDown)
            handlers.append(onKeyDown)
            
            onDestroy = MyCommandDestroyHandler()
            command.destroy.add(onDestroy)
            handlers.append(onDestroy)
            
            inputs = command.commandInputs
            inputs.addTextBoxCommandInput(
                commandName + '_usage', 
                'Usage:', 
                'Use the arrow buttons to drive the robot arm', 2, 
                True);
            inputs.addValueInput(
                commandName + '_step', 
                'Rotation step: ',
                'deg',
                adsk.core.ValueInput.createByReal(revolutionStep))                
            inputs.addBoolValueInput(
                commandName + '_reverseUpDown',
                'Reverse Up/Down direction',
                True,
                '',
                isReverseUpDown)
            inputs.addBoolValueInput(
                commandName + '_reverseLeftRight',
                'Reverse Left/Right direction',
                True,
                '',
                isReverseLeftRight) 
                
        except:
            ui.messageBox('Failed:\n{}'.format(traceback.format_exc()))              
            
            
class MyCommandDestroyHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        try:
            commandDefinitions = ui.commandDefinitions
            # Check the command exists or not
            cmdDef = commandDefinitions.itemById(commandName)
            if cmdDef:
                cmdDef.deleteMe                
                
            # When the command is done, terminate the script
            # this will release all globals which will remove all event handlers
            adsk.terminate()
            
        except:
            ui.messageBox('Failed:\n{}'.format(traceback.format_exc()))        
            
            
def run(context):
    try:
        product = app.activeProduct
        design = adsk.fusion.Design.cast(product)
        if not design:
            ui.messageBox('It is not supported in current workspace, please change to MODEL workspace and try again.')
            return
            
        # Get selected Revolute Joints to work on 
        selections = app.userInterface.activeSelections
        if selections.count != 2:
            ui.messageBox("The 2 revolute joints you want to control need to be selected before running the command!")
            return
        
        global revoluteJoint1, revoluteJoint2
        revoluteJoint1 = selections.item(0).entity
        revoluteJoint2 = selections.item(1).entity            
            
        commandDefinitions = ui.commandDefinitions
        # Check the command exists or not
        cmdDef = commandDefinitions.itemById(commandName)
        if not cmdDef:
            cmdDef = commandDefinitions.addButtonDefinition(
                commandName, commandName, commandName, '') 

        # Subscribe to events 
        onCommandCreated = MyCommandCreatedHandler()
        cmdDef.commandCreated.add(onCommandCreated)
        # Keep the handler referenced beyond this function
        handlers.append(onCommandCreated)
        
        # Run the command
        inputs = adsk.core.NamedValues.create()
        cmdDef.execute(inputs)

        # Prevent this module from being terminated when the script returns, 
        # because we are waiting for event handlers to fire
        adsk.autoTerminate(False)

    except:
        ui.messageBox('Failed:\n{}'.format(traceback.format_exc()))
</pre>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c88a8ce7970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c88a8ce7970b img-responsive" title="MoveRobotCommand" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c88a8ce7970b-500wi" alt="MoveRobotCommand" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Drive robot arm in Fusion
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: drive-robot-arm-in-fusion
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion.html 
DATE: 08/21/2016 07:56:42 PM
-----
BODY:
<p>Note: this article has an <a href="http://modthemachine.typepad.com/my_weblog/2016/08/drive-robot-arm-in-fusion-update.html">update</a></p>
<p>If you want to write a program that drives the model then you can do that&#0160;through driving parameters. I have the following <a href="http://a360.co/2b9PQGI">simple model</a> with <strong>Revolute Joints.&#0160;</strong>These types of joints also have an <strong>Alignment Angle</strong> parameter which we can modify programmatically as well :)</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb092d317b970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="RobotArmJoints" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb092d317b970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb092d317b970d-500wi" title="RobotArmJoints" /></a></p>
<p>I wanted to drive the model through the arrow buttons on the keyboard. <strong>Fusion API</strong> provides a <strong>keyDown</strong> event through the <strong>Command</strong> object. So in order to use it we need to define a command and run it. Since we are modifying the model before the user clicks &quot;<strong>OK</strong>&quot; on the command dialog, therefore we also need to listen to the <strong>executePreview</strong> event of the <strong>Command</strong>. There we can set the <strong>isValidResult</strong> to <strong>True</strong>. This way if the user clicks &quot;<strong>OK</strong>&quot; then the changes will be kept without us having to redo the changes inside the <strong>execute</strong> event handler. It&#39;s like so because each command automatically starts a transaction which gets undone by default&#0160;right before&#0160;the program creates the final model changes inside the <strong>execute</strong> event handler.&#0160;</p>
<p>See the <strong>Python</strong> code below:</p>
<pre>#Author-
#Description-

import adsk.core, adsk.fusion, adsk.cam, traceback

# Global variable used to maintain a reference to all event handlers.
handlers = []

# Other global variables
commandName = &quot;MoveRobot&quot;
app = adsk.core.Application.get()
if app:
    ui = app.userInterface
    

# Event handler for the keyDown event.
class MyKeyDownHandler(adsk.core.KeyboardEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        try:
            eventArgs = adsk.core.KeyboardEventArgs.cast(args)
            keyCode = eventArgs.keyCode    
                
            paramName = &quot;&quot;
            diffVal = 0
            if keyCode == adsk.core.KeyCodes.DownKeyCode:
                paramName = &quot;d41&quot;
                diffVal = -0.1
            elif keyCode == adsk.core.KeyCodes.UpKeyCode:
                paramName = &quot;d41&quot;
                diffVal = 0.1
            elif keyCode == adsk.core.KeyCodes.LeftKeyCode:
                paramName = &quot;d59&quot;
                diffVal = -0.1
            elif keyCode == adsk.core.KeyCodes.RightKeyCode:
                paramName = &quot;d59&quot;
                diffVal = 0.1
    
            design = app.activeProduct
            params = design.allParameters   
            
            param = params.itemByName(paramName)
            newVal = param.value + diffVal
            param.value = newVal
            
            adsk.doEvents() 
        except:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))              


# Event handler for the executePreview event.
class MyExecutePreviewHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        eventArgs = adsk.core.CommandEventArgs.cast(args)
        
        # Make it accept the changes whatever happens
        eventArgs.isValidResult = True
        

class MyCommandCreatedHandler(adsk.core.CommandCreatedEventHandler):    
    def __init__(self):
        super().__init__()        
    def notify(self, args):
        try:
            command = adsk.core.Command.cast(args.command)
            
            onExecutePreview = MyExecutePreviewHandler()
            command.executePreview.add(onExecutePreview)
            handlers.append(onExecutePreview)
        
            onKeyDown = MyKeyDownHandler()
            command.keyDown.add(onKeyDown)
            handlers.append(onKeyDown)
            
            onDestroy = MyCommandDestroyHandler()
            command.destroy.add(onDestroy)
            handlers.append(onDestroy)
            
            inputs = command.commandInputs
            inputs.addTextBoxCommandInput(
                commandName + &#39;_textBox&#39;, &#39;Usage:&#39;, 
                &#39;Use the arrow buttons to drive the robot arm&#39;, 2, 
                True);
        except:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))              
            
            
class MyCommandDestroyHandler(adsk.core.CommandEventHandler):
    def __init__(self):
        super().__init__()
    def notify(self, args):
        try:
            commandDefinitions = ui.commandDefinitions
            # Check the command exists or not
            cmdDef = commandDefinitions.itemById(commandName)
            if cmdDef:
                cmdDef.deleteMe                
                
            # When the command is done, terminate the script
            # this will release all globals which will remove all event handlers
            adsk.terminate()
        except:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))        
            
            
def run(context):
    try:
        product = app.activeProduct
        design = adsk.fusion.Design.cast(product)
        if not design:
            ui.messageBox(&#39;It is not supported in current workspace, please change to MODEL workspace and try again.&#39;)
            return
        commandDefinitions = ui.commandDefinitions
        # Check the command exists or not
        cmdDef = commandDefinitions.itemById(commandName)
        if not cmdDef:
            cmdDef = commandDefinitions.addButtonDefinition(
                commandName, commandName, commandName, &#39;&#39;) 

        onCommandCreated = MyCommandCreatedHandler()
        cmdDef.commandCreated.add(onCommandCreated)
        # Keep the handler referenced beyond this function
        handlers.append(onCommandCreated)
        inputs = adsk.core.NamedValues.create()
        cmdDef.execute(inputs)

        # Prevent this module from being terminated when the script returns, 
        # because we are waiting for event handlers to fire
        adsk.autoTerminate(False)

    except:
        ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))
</pre>
<p>Here is the script in action:</p>
<p><iframe allowfullscreen="" frameborder="0" height="315" src="https://www.youtube.com/embed/QeK2iHwpkc4" width="420"></iframe></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Projecting Points Onto a Solid
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: projecting-points-onto-a-solid
CATEGORY: Brian
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/06/projecting-points-onto-a-solid.html 
DATE: 06/30/2016 07:28:58 PM
-----
BODY:
<p>There was a recent Inventor question posted on <a href="https://stackoverflow.com/questions/38110160/get-the-points-coordinates-from-a-geometry-projection-over-a-solid-in-autodesk-i">stackoverflow</a> that I thought was interesting and decided to look at.&#0160; The question involved being able to project points from a sketch onto a solid.&#0160; Below is a picture of a sketch that contains many sketch center points.&#0160; In this case they were created by patterning a point to get a grid of points but they could be created in any way.&#0160; The goal is to project all of these points onto the solid.&#0160; For my program I chose to project them in the direction that is perpendicular (normal) to the sketch plane.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ff84db970c-pi"><img alt="ProjectPoints1" border="0" height="445" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09192705970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="ProjectPoints1" width="690" /></a>&#0160;</p>
<p>&#0160;</p>
<p>Hereâ€™s the result where the intersection points are created as work points.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c875b48a970b-pi"><img alt="ProjectPoints2" border="0" height="436" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c875b48e970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="ProjectPoints2" width="633" /></a></p>
<p>&#0160;</p>
<p>The sketch can be in any orientation in space, as shown in the picture below.&#0160; In this case the results were created as points within a 3D sketch.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ff84e3970c-pi"><img alt="ProjectPoints3" border="0" height="468" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c875b495970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="ProjectPoints3" width="626" /></a></p>
<p>&#0160;</p>
<p>And hereâ€™s the VBA code that I came up with to do this.&#0160; It asks for the selection of a sketch (which you need to pick in the browser) and for a body.&#0160; The next section of code is the most confusing but itâ€™s basically trying to determine where the selected sketch is relative to the selected body and then computing a value so that when it begins projecting the points, the point it projects is outside of the solid.&#0160; Thatâ€™s actually the largest chunk of the code.&#0160; Towards the bottom of the macro youâ€™ll see where the actual intersection work takes place.&#0160; It then prompts the user to select how to display the results where they can choose one of three ways; as work points, points in a 3D sketch, or written to a csv file.</p>
<div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">
<p>Public Sub ProjectPoints()<br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Have the sketch that contains the points selected.<br /></strong></span>&#0160;&#0160;&#0160; Dim sk As PlanarSketch<br />&#0160;&#0160;&#0160; Set sk = ThisApplication.CommandManager.Pick(kSketchObjectFilter, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Select the sketch&quot;)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Have the body to project onto selected.</strong></span><br />&#0160;&#0160;&#0160; Dim body As SurfaceBody<br />&#0160;&#0160;&#0160; Set body = ThisApplication.CommandManager.Pick(kPartBodyFilter, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Select the body&quot;)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Get the part component definition.</strong></span><br />&#0160;&#0160;&#0160; Dim compDef As PartComponentDefinition<br />&#0160;&#0160;&#0160; Set compDef = body.Parent<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; *** Determine the side of the solid the sketch is on and if the<br /></strong></span>&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; *** sketch is outside the solid.<br /></strong></span>&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Get the normal vector of the selected sketch.</strong></span><br />&#0160;&#0160;&#0160; Dim skNormal As UnitVector<br />&#0160;&#0160;&#0160; Set skNormal = sk.PlanarEntityGeometry.Normal<br />&#0160;&#0160;&#0160; Dim skRootPoint As Point<br />&#0160;&#0160;&#0160; Set skRootPoint = sk.PlanarEntityGeometry.RootPoint<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Get the corners of the range box.</strong></span><br />&#0160;&#0160;&#0160; Dim tg As TransientGeometry<br />&#0160;&#0160;&#0160; Set tg = ThisApplication.TransientGeometry<br />&#0160;&#0160;&#0160; Dim cornerPoints(7) As Point<br />&#0160;&#0160;&#0160; Dim range As Box<br />&#0160;&#0160;&#0160; Set range = body.RangeBox<br />&#0160;&#0160;&#0160; Set cornerPoints(0) = range.MinPoint<br />&#0160;&#0160;&#0160; Set cornerPoints(1) = tg.CreatePoint(range.MinPoint.x, range.MinPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set cornerPoints(2) = tg.CreatePoint(range.MinPoint.x, range.MaxPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MinPoint.Z)<br />&#0160;&#0160;&#0160; Set cornerPoints(3) = tg.CreatePoint(range.MinPoint.x, range.MaxPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set cornerPoints(4) = range.MaxPoint<br />&#0160;&#0160;&#0160; Set cornerPoints(5) = tg.CreatePoint(range.MaxPoint.x, range.MinPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MaxPoint.Z)<br />&#0160;&#0160;&#0160; Set cornerPoints(6) = tg.CreatePoint(range.MaxPoint.x, range.MinPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MinPoint.Z)<br />&#0160;&#0160;&#0160; Set cornerPoints(7) = tg.CreatePoint(range.MaxPoint.x, range.MaxPoint.y, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; range.MinPoint.Z)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Construct a matrix where the X axis is along the sketch plane normal.</strong></span><br />&#0160;&#0160;&#0160; Dim xAxis As Vector<br />&#0160;&#0160;&#0160; Set xAxis = skNormal.AsVector<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim yAxis As Vector<br />&#0160;&#0160;&#0160; Set yAxis = tg.CreateVector(xAxis.x + 1, xAxis.y + 1, xAxis.Z + 1)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim zAxis As Vector<br />&#0160;&#0160;&#0160; Set zAxis = xAxis.CrossProduct(yAxis)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Set yAxis = zAxis.CrossProduct(xAxis)<br />&#0160;&#0160;&#0160; xAxis.Normalize<br />&#0160;&#0160;&#0160; yAxis.Normalize<br />&#0160;&#0160;&#0160; zAxis.Normalize<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim transform As Matrix<br />&#0160;&#0160;&#0160; Set transform = tg.CreateMatrix<br />&#0160;&#0160;&#0160; Call transform.SetCoordinateSystem(skRootPoint, xAxis, yAxis, zAxis)<br />&#0160;&#0160;&#0160; transform.Invert<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Transform the range box points and compare them to sketch plane.<br /></strong></span>&#0160;&#0160;&#0160; Dim i As Integer<br />&#0160;&#0160;&#0160; Dim smallX As Double<br />&#0160;&#0160;&#0160; For i = 0 To 7<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call cornerPoints(i).TransformBy(transform)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If i = 0 Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallX = cornerPoints(i).x<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If cornerPoints(i).x &lt; smallX Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallX = cornerPoints(i).x<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Determine the offset needed to position the points outside the solid.</strong></span><br />&#0160;&#0160;&#0160; Dim offset As Double<br />&#0160;&#0160;&#0160; If smallX &lt; 0 Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; offset = -(smallX + 10)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim tempNormal As Vector<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set tempNormal = skNormal.AsVector<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call tempNormal.ScaleBy(-1)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set skNormal = tempNormal.AsUnitVector<br />&#0160;&#0160;&#0160; Else<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; offset = 0<br />&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim offsetVector As Vector<br />&#0160;&#0160;&#0160; Set offsetVector = skNormal.AsVector<br />&#0160;&#0160;&#0160; Call offsetVector.ScaleBy(offset)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; *** Perform the intersection calculation of every center point in the sketch.<br /></strong></span>&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim resultPoints As ObjectCollection<br />&#0160;&#0160;&#0160; Set resultPoints = ThisApplication.TransientObjects.CreateObjectCollection<br />&#0160;&#0160;&#0160; Dim skPoint As SketchPoint<br />&#0160;&#0160;&#0160; For Each skPoint In sk.SketchPoints<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Check to see if the point is a center point.</strong></span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If skPoint.HoleCenter Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Get the sketch point as a transient 3D point.</strong><br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim pnt As Point<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set pnt = skPoint.Geometry3d<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Move the point outside the solid.<br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call pnt.TranslateBy(offsetVector)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Intersect the point with the solid.<br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim foundEnts As ObjectsEnumerator<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim locPoints As ObjectsEnumerator<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call body.FindUsingRay(pnt, skNormal, 0.00001, foundEnts, locPoints, True)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; If an intersection was found, add it to the list.<br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If locPoints.count &gt; 0 Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call resultPoints.Add(locPoints.Item(1))<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Prompt the user for which type of output they want.</strong></span><br />&#0160;&#0160;&#0160; Dim result As String<br />&#0160;&#0160;&#0160; result = InputBox(&quot;Enter choice for output:&quot; &amp; vbCrLf &amp; &quot;1 - Work points&quot; &amp; _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf &amp; &quot;2 - 3D sketch&quot; &amp; vbCrLf &amp; &quot;3 - csv File&quot;, _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Enter output type&quot;, 3)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If result = &quot;1&quot; Or result = &quot;2&quot; Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Start a transaction so that the creation is grouped in a single undo.</strong><br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim trans As Transaction<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set trans = ThisApplication.TransactionManager.StartTransaction( _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument, &quot;Projected Points&quot;)<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If result = &quot;1&quot; Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Create work points.</strong></span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For i = 1 To resultPoints.count<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call compDef.WorkPoints.AddFixed(resultPoints.Item(i))<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If result = &quot;2&quot; Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Create a 3D sketch and points in the sketch.<br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim sk3D As Sketch3D<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set sk3D = compDef.Sketches3D.Add()<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For i = 1 To resultPoints.count<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call sk3D.SketchPoints3D.Add(resultPoints.Item(i))<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If<br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans.End<br />&#0160;&#0160;&#0160; ElseIf result = &quot;3&quot; Then<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Write the points out to a file.</strong></span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Open &quot;C:\Temp\Points.csv&quot; For Output As #1<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For i = 1 To resultPoints.count<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Print #1, Format(resultPoints.Item(i).x, &quot;0.00000000&quot;) &amp; &quot;,&quot; &amp; _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(resultPoints.Item(i).y, &quot;0.00000000&quot;) &amp; &quot;,&quot; &amp; _<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(resultPoints.Item(i).Z, &quot;0.00000000&quot;)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Close #1<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;File written to &quot;&quot;C:\Temp\Points.csv&quot;&quot;&quot;<br />&#0160;&#0160;&#0160; Else<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;Invalid Input&quot;<br />&#0160;&#0160;&#0160; End If<br />End Sub</p>
</div>
<p>Hopefully this is useful as a starting point for something you might want to do.&#0160; It at least demonstrates a couple of interesting things.</p>
<p>This is all Inventor but for those of you using Fusion, Fusion doesnâ€™t currently have the API functionality to fire a ray through the model so this canâ€™t be done in the same way.&#0160; I do expect that to be available at some point in the future though.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Is point on face
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: is-point-on-face
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/is-point-on-face.html 
DATE: 05/27/2016 06:02:37 PM
-----
BODY:
<p>To be more precise, the question should be &quot;Is Point3D on BRepFace?&quot; :)</p>
<p>There is no direct function to determine that but you can get to the answer by using other functions like the <span class="s1"><strong>isParameterOnFace&#0160;</strong>function of&#0160;<strong>SurfaceEvaluator</strong>.</span></p>
<p><span class="s1">In order to use that though we need to first get the parameters based on the point. Turns out the function we need to use,&#0160;</span><span class="s1"><strong>getParameterAtPoint</strong>, actually works like this: &quot;</span><span class="s1">If the point does not lie on the surface, the parameter of the nearest point on the surface will generally be returned.</span><span class="s1">&quot;<br />So we have to check for that too.</span></p>
<p><span class="s1">Here is the&#0160;<strong>Python</strong> code we can use:</span></p>
<pre>def isPointOnFace():
    app = adsk.core.Application.get()
    ui  = app.userInterface
    
    selections = app.userInterface.activeSelections
    sketchPoint = selections.item(0).entity
    face = selections.item(1).entity
    
    evaluator = face.evaluator
    point = sketchPoint.worldGeometry
    ui.messageBox(
        &quot;point, x=&quot; + str(point.x) + 
        &quot;; y=&quot; + str(point.y) + 
        &quot;; z=&quot; + str(point.z))
    (returnValue, parameter) = evaluator.getParameterAtPoint(point)
    ui.messageBox(
        &quot;parameter, u=&quot; + str(parameter.x) + 
        &quot;; v=&quot; + str(parameter.y))
    
    if not returnValue:
        # could not get the parameter for it so
        # it&#39;s probably not on the face
        ui.messageBox(&quot;Point not on face\n(Could not get parameter)&quot;)
        return
        
    (returnValue, projectedPoint) = evaluator.getPointAtParameter(parameter)
    ui.messageBox(
        &quot;projectedPoint, x=&quot; + str(projectedPoint.x) + 
        &quot;; y=&quot; + str(projectedPoint.y) + 
        &quot;; z=&quot; + str(projectedPoint.z))
    if not projectedPoint.isEqualTo(point):
        # the point has been projected in order to get 
        # a parameter so it&#39;s not on the face
        ui.messageBox(
            &quot;Point not on face\n(Point was projected in order to get parameter)&quot;)
        return
    
    returnValue = evaluator.isParameterOnFace(parameter)
    if not returnValue:
        ui.messageBox(&quot;Point not on face\n(isParameterOnFace says so)&quot;)
        return
    
    ui.messageBox(&quot;Point on face&quot;)</pre>
<p><span class="s1">You just have to select a <strong>SketchPoint</strong> and a <strong>BRepFace</strong> in the <strong>UI</strong> before running it:</span></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0907fbac970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="PointOnFace" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb0907fbac970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0907fbac970d-320wi" title="PointOnFace" /></a></p>
<p><span class="s1">-Adam &#0160;</span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Do You Know About the Forge DevCon Workshops?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: do-you-know-about-the-forge-devcon-workshops
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/do-you-know-about-the-forge-devcon-workshops.html 
DATE: 05/25/2016 04:20:44 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ecc100970c-pi"><img alt="forgeworkshop" border="0" height="248" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ecc13b970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="forgeworkshop" width="838" /></a></p>
<p>The <a href="http://forge.autodesk.com/conference/">Forge Devcon</a> is quickly approaching on June 15-16.&#0160; However, the day before on June 14, there are some workshops that youâ€™re invited to.&#0160; That fact that there are some workshops is a bit hidden on the website so I wanted to point them out so that if youâ€™re coming to conference you can schedule an extra day before the conference begins and attend.&#0160; The best place to learn more about the workshops is on the <a href="https://www.eventbrite.com/e/pre-forge-devcon-workshops-june-14-2016-tickets-25100444104">registration site</a>.&#0160; The workshops are free but you need to register because there is limited room.</p>
<p>Hereâ€™s a quick overview of the topics that will be covered, and the schedule:</p>
<blockquote>
<p><strong>Model Derivative and Viewing API Workshop - 10am-4pm.</strong></p>
<p>In this workshop, you will work through a tutorial of the basic steps you need to display a 2D or 3D design on your webpage. The basic tutorial will take approximately 2 hours, the remainder of the time will be spent expanding your knowledge of these&#0160; APIs by either working on your own project or working on one of our preset challenges â€“ with help from the instructors.</p>
<p><strong>Fusion 360 Client API Workshop - 10am-4pm</strong></p>
<p>In this workshop, you will learn the APIs and basic steps needed to create your first Fusion 360 API in the language of your choice (JavaScript, Python or C++). The basic tutorial will take approximately 2 hours. The remainder of the time will be spent expanding your knowledge of the Fusion 360 APIs by either working through one or more advanced tutorials or samples or working on your own projectâ€“ with help from the instructors.</p>
<p><strong>Design Automation (a.k.a. AutoCAD I/O) API Workshop - 10am-4pm</strong></p>
<p>In this workshop, you will learn the APIs and basic steps needed to create your first Design Automation application. The basic tutorial will take approximately 2 hours. The remainder of the time will be spent working on your own projectâ€“ with help from the instructors.</p>
<p><strong>Photo-To-3D (a.k.a. ReCap Photo API) Workshop - 6.00pm-9.00pm (</strong><strong><a href="https://www.google.com/maps/place/60+Spear+St,+San+Francisco,+CA+94105/@37.7925749,-122.3967638,17z/data=!3m1!4b1!4m5!3m4!1s0x808580646961d4cf:0xe5b59ca707b67eff!8m2!3d37.7925749!4d-122.3945751">Location - 60 Spear Street, San Francisco, CA</a>)</strong></p>
<p>In this workshop, you will learn the APIs and basic steps needed to incorporate 3D Photogrammetry into your application. The workshop will also include advice on achieving the best results.</p>
</blockquote>
<p>Iâ€™ll be hosting the <strong>Fusion 360 Client API Workshop </strong>and would be happy to see you there, although itâ€™s a great schedule and will be hard to choose which one to attend.</p>
<p>Here are some <a href="http://modthemachine.typepad.com/Files.zip">files for the workshop</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Pre-DevCon Workshops
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: pre-devcon-workshops
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/pre-devcon-workshops.html 
DATE: 05/25/2016 10:32:05 AM
-----
BODY:
<p>In case you did not spot this on the <a href="http://forge.autodesk.com/conference/">Forge DevCon site</a>, the day before the conference we are also organizing workshops that you&#39;re welcome to attend - including a <strong>Fusion 360 API</strong> workshop with <strong>Brian</strong>&#0160;and a few of us :)</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09064694970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DevConWorkshops" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb09064694970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb09064694970d-500wi" title="DevConWorkshops" /></a></p>
<p>See you there! :)</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Appearance properties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: appearance-properties
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/appearance-properties.html 
DATE: 05/24/2016 10:41:51 AM
-----
BODY:
<p>There is <a href="http://adndevblog.typepad.com/manufacturing/2016/04/fusion-api-change-appearance-of-body.html">an article</a> related to <strong>Appearance</strong>&#39;s and a sample script installed with <strong>Fusion 360</strong> that shows how to access <strong>Appearances</strong> from the libraries and assign them to objects&#0160;in the model: &quot;<strong>ApplyAppearanceToSelection.py</strong>&quot;</p>
<p>In some cases you may want to drill down into the properties of the&#0160;<strong>Appearance</strong>&#39;s which are used in the model, to find e.g. the texture that is being used by a given <strong>Appearance</strong>.<br />The following <strong>Python</strong> sample only shows how to access the <strong>name</strong> and <strong>value&#0160;</strong>of the properties, but there are more than that available. If you look at the <strong>Property</strong> object in the online help file, then in the &quot;<strong>Derived Classes</strong>&quot; section you&#39;ll see that quite a few other objects are derived from that. If you wanted to access all the properties then you&#39;d need to handle all of them and check all their properties:&#0160;<a href="http://help.autodesk.com/view/NINVFUS/ENU/?guid=GUID-db167e70-665f-4101-ba3c-3bcc88000fc7">http://help.autodesk.com/view/NINVFUS/ENU/?guid=GUID-db167e70-665f-4101-ba3c-3bcc88000fc7<br /></a></p>
<pre>import adsk.core, adsk.fusion, adsk.cam, traceback

def exportProperties(properties, indent, outputFile):
    for prop in properties:
        if type(prop) is adsk.core.AppearanceTextureProperty: 
            outputFile.writelines(indent + prop.name + &quot;\n&quot;)
            try:
                exportProperties(prop.value.properties, indent + &quot;  &quot;, outputFile)
            except:
                outputFile.writelines(indent + &quot;  Couldn&#39;t get sub properties\n&quot;)  
        elif type(prop) is adsk.core.ColorProperty:
            if prop.value:
                color = prop.value 
                outputFile.writelines(indent + 
                    &quot;red = &quot; + str(color.red) + 
                    &quot;; green = &quot; + str(color.green) + 
                    &quot;; blue = &quot; + str(color.blue) +&quot;\n&quot;)
        else:
            outputFile.writelines(indent + prop.name + &quot; = &quot; + str(prop.value) + &quot;\n&quot;)    

def run(context):
    ui = None
    try:
        app = adsk.core.Application.get()
        ui  = app.userInterface

        fileDialog = ui.createFileDialog()
        fileDialog.isMultiSelectEnabled = False
        fileDialog.title = &quot;Get the file to save to&quot;
        fileDialog.filter = &#39;Text files (*.txt)&#39;
        fileDialog.filterIndex = 0
        dialogResult = fileDialog.showSave()
             
        if dialogResult == adsk.core.DialogResults.DialogOK:
             fileName = fileDialog.filename
        else:
             return      
        
        design = app.activeProduct
        
        with open(fileName, &#39;w&#39;) as outputFile:
            for appearance in design.appearances:
                outputFile.writelines(&quot;&gt;&gt;&gt;&gt;&gt; &quot; + appearance.name + &quot; &lt;&lt;&lt;&lt;&lt;\n&quot;)
                exportProperties(appearance.appearanceProperties, &quot;  &quot;, outputFile)
            
    except:
        if ui:
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))
</pre>
<p>You will get something like this:</p>
<pre>&gt;&gt;&gt;&gt;&gt; Oak - Semigloss &lt;&lt;&lt;&lt;&lt;
  Material Type = 0
  URN = 
  Emission = False
  Reflectance = 0.06027025
  URN = 
  Emissive Luminance = 0.0
  red = 255; green = 255; blue = 255
  URN = 
  Depth = 0.5
  red = 255; green = 255; blue = 255
  URN = 
  Translucency = False
  red = 255; green = 255; blue = 255
  URN = 
  Anisotropy = 0.0
  URN = 
  Image
    Couldn&#39;t get sub properties
  URN = 
  NDF = surface_ndf_ggx
  Image
    Source = /Users/adamnagy/Library/Containers/com.autodesk.mas.fusion360/
Data/Library/Application Support/Autodesk/Common/Material Library/16021701/
slib/resource/1/Mats/wood_oak_bump.jpg
    URN = 
    Amount = 0.003
    Amount = 1.0
    Bump Type = bumpmap_height_map
    Sharing = common_shared
    red = 80; green = 80; blue = 80
    Tint = False
    Link texture transforms = False
    Map Channel = 1
    Map Channel = 1
    UVW Source = 0
    Offset Lock = False
    Offset = 0.0
    Offset Y = 0.0
    Sample Size = 18.0
    Size Y = 36.0
    Scale Lock = True
    U Offset = 0.0
    Horizontal = True
    U Scale = 1.0
    UV Scale = 1.0
    V Offset = 0.0
    Vertical = True
    V Scale = 1.0
    Rotation = 0.0
  URN = 
  Rotation = 0.0
  URN = 
  Roughness = 0.2
  URN = 
</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating Points at an Arbitrary XYZ Location in Fusion
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-points-at-an-arbitrary-xyz-location-in-fusion
CATEGORY: Brian
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/creating-points-at-an-arbitrary-xyz-location-in-fusion.html 
DATE: 05/10/2016 07:54:16 PM
-----
BODY:
<p>There was a <a href="http://forums.autodesk.com/t5/design-validate-document/enter-a-construction-point-using-xyz-coordinates/td-p/6306723">discussion on the Fusion forum</a> about being able to create a construction point thatâ€™s positioned at a specific X, Y, Z location.&#0160; There is also a <a href="https://forums.autodesk.com/t5/ideastation-request-a-feature-or/precision-input-needed-to-position-geometry/idi-p/5418141">post on the IdeaStation</a>.&#0160; Fusion doesnâ€™t currently support that capability but only supports the creation of construction points relative to existing geometry. When creating construction geometry, there are two situations to consider; capturing design history (parametric modeling) and not capturing design history (direct edit modeling).&#0160; You switch between the two modeling types using the command in the context menu on the root component node in the browser, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f3e970d-pi"><img alt="DirectModeling" border="0" height="514" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580edf970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="DirectModeling" width="420" /></a></p>
<p><strong>Direct Edit</strong><br />In a direct edit design, construction points donâ€™t remember their relationship to the original geometry used when creating them and they can be moved to any location after theyâ€™ve been created using the Move command.&#0160; Using the Move command it is possible to end up with a construction point at the desired X, Y, Z location but itâ€™s an inconvenient workflow to first create the point and then move it.</p>
<p><strong>Parametric Model<br /></strong>When working in a parametric model, all construction points are dependent on other geometry and canâ€™t exist anywhere in space so itâ€™s not possible to position a point at an arbitrary X, Y, Z location. However, parametric designs support something called a â€œBase Featureâ€. A base feature lets you create an â€œislandâ€ of direct edit data within your parametric design, so it ends up being the same workflow as in a direct modeling design, except that you also need to first create a base feature, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1e1d5e4970c-pi"><img alt="BaseFeature" border="0" height="670" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580ee2970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="BaseFeature" width="287" /></a></p>
<p>So, it is possible to create a construction point at a specific X, Y, Z location in both parametric and direct modeling designs, but itâ€™s inconvenient in both. With the recent May 7 Fusion update, the API now supports the creation and edit of base features.&#0160; With this capability itâ€™s now possible to write an add-in that will support the creation of a construction point at a specified X, Y, Z location.</p>
<p>Once the add-in is installed, youâ€™ll now see a new â€œPoint at Coordinateâ€ command in the CONSTRUCT menu, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580ee4970b-pi"><img alt="PointAtCoordinate" border="0" height="628" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580ee8970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="PointAtCoordinate" width="390" /></a></p>
<p>When you run the command when youâ€™re in a direct modeling design the dialog on the left is displayed and when youâ€™re in a parametric design, the dialog on the right is displayed.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580eea970b-pi"><img alt="PointAtCoordinateDialog" border="0" height="212" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8580eee970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="PointAtCoordinateDialog" width="526" /></a></p>
<p>Using the â€œNameâ€ field you can specify what the name of the new construction point will be.&#0160; The default is â€œXYZ Pointâ€ but sometimes, depending on how youâ€™re going to use the point, it can be useful to name it so you can easily identify which one is which when looking at the browser.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f42970d-pi"><img alt="PointNames" border="0" height="232" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f48970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="PointNames" width="229" /></a></p>
<p>The â€œX Positionâ€, â€œY Positionâ€, and â€œZ Positionâ€ fields are the X, Y, and Z values where the construction point will be created.&#0160; You can use any valid expression when specifying these values, including the use of parameter names.&#0160; For example, if you have a parameter named Length you can use â€œLength/2â€.&#0160; The default units are whatever the current design units are.&#0160; But you can also override that by specifying the units.&#0160; For example â€œ3 inâ€ will be interpreted as 3 inches.&#0160; Whatever you use as input, itâ€™s important to understand the point doesnâ€™t remember this relationship so that if you use a parameter name and then later change the parameter value, the point will not move.</p>
<p>When the command is run in a parametric design, the â€œBase featureâ€ dropdown at the top of the dialog is displayed. Because points at an arbitrary location must be created within a base feature when working in a parametric design, this lets you specify which base feature theyâ€™ll be created in.&#0160; If there isnâ€™t an existing base feature, a new one will be created and that will be the default base feature when you run the command again, although you have the option of choosing any existing base feature.</p>
<p>To use the add-in just unpack the <a href="http://modthemachine.typepad.com/PointAtCoord.zip">zip file</a> anywhere on your computer.&#0160; Run the â€œScripts and Add-Insâ€ command and click the green â€œ+â€, as shown below.&#0160; Browse to the location where you unpacked the zip file and choose the PointAtCoord.py file.&#0160; Youâ€™ll only need to do this once because Fusion will remember it for subsequent sessions.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1e1d5eb970c-pi"><img alt="AddAddIn" border="0" height="338" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f4a970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="AddAddIn" width="416" /></a></p>
<p>&#0160;</p>
<p>You can either shut down and restart Fusion to make the command available, or while in the same session you can start the add-in.&#0160; This is only needed when first enabling the add-in because it will load automatically in subsequent sessions of Fusion.&#0160; To start the add-in, choose the â€œAdd-Insâ€ tab on the â€œScripts and Add-Insâ€ dialog, select the â€œPointAtCoordâ€ add-in from the list, and click the â€œRunâ€ button.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f4c970d-pi"><img alt="EnablePointAddIn" border="0" height="338" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08fb9f50970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="EnablePointAddIn" width="416" /></a></p>
<p>&#0160;</p>
<p>Now, and in all sessions of Fusion the â€œPoint at Coordinateâ€ command will be available.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1e1d5f2970c-pi"><img alt="PointAtCoordinate" border="0" height="633" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1e1d5f4970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="PointAtCoordinate" width="390" /></a></p>
<p>You can find the source code for this add-in and a few others <a href="https://github.com/brianekins/FusionHackathonSamples">here on GitHub</a>.&#0160; Please let me know if you find any problems or have suggestions on improvements.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion May 7 Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: fusion-may-7-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/05/fusion-may-7-update.html 
DATE: 05/09/2016 09:50:17 PM
-----
BODY:
<p>This past Saturday a new Fusion update went out.&nbsp; There is some API functionality in that update that enables a lot more types of programs.&nbsp; These new capabilities are attributes and base features.</p> <p>The ability to associate data with any entity is now supported through attributes. Every object that supports attributes now has an 'attributes' property that returns an Attributes object.&nbsp; You can read more about this and why you might want to use it in the <a href="http://help.autodesk.com/cloudhelp/ENU/Fusion-360-API/files/Attributes_UM.htm">User Manual topic for attributes</a>.</p> <p>There is also now support to create base features and to create entities within a base feature. For example, you can use the new Sketches.addToBaseOrFormFeature method to create a new sketch in an existing base feature, or the MeshBody.add method now supports an argument to let you specify a base feature to create the mesh body within.&nbsp; Base features provide a way to create direct-modeling geometry within a parametric model.&nbsp; Itâ€™s like an â€œislandâ€ of direct modeling.&nbsp; This is useful in a few cases where certain types of creation are only supported in direct modeling mode but instead of converting the entire design and losing all of the modeling intelligence, you can create a base feature and create the direct modeling geometry within the base feature.</p> <p>One more thing thatâ€™s not new API functionality is that the <a href="http://help.autodesk.com/cloudhelp/ENU/Fusion-360-API/files/Commands_UM.htm">User Manual topic for Commands</a> has been re-written and better describes the full capability of creating custom commands.&nbsp; I know that the documentation for creating custom commands wasnâ€™t the best and people were struggling with commands.&nbsp; Hopefully this will help a lot of you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Apply for Forge Accelerator 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: apply-for-forge-accelerator-
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/04/apply-for-forge-accelerator-.html 
DATE: 04/29/2016 02:00:37 PM
-----
BODY:
<p>The week after the <a href="http://forge.autodesk.com/conference/">Forge DevCon</a>&#0160;we&#39;ll organize our next <a href="http://adndevblog.typepad.com/cloud_and_mobile/2016/04/forge-accelerator-call-for-proposals.html">Forge Accelerator</a>&#0160;on&#0160;<strong>June 19-24</strong> inclusive in our <strong>San Francisco</strong> office.&#0160;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08d6c7b3970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ForgeDevCon" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08d6c7b3970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08d6c7b3970d-500wi" title="ForgeDevCon" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1d78735970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Forgebanner" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1d78735970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1d78735970c-500wi" title="Forgebanner" /></a></p>
<p>You can start submitting your project ideas in order to take part in it.</p>
<p>Good luck! :)</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: It&rsquo;s Time for AU 2016
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: its-time-for-au-2016
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/04/its-time-for-au-2016.html 
DATE: 04/28/2016 07:30:31 AM
-----
BODY:
<p>Actually, itâ€™s time for proposals for classes. If you have some cool tips and techniques or an interesting project to share, you should think about submitting a proposal and maybe you can be a presenter as AU this year. As a presenter you get the satisfaction of sharing something thatâ€™s important to you with your peers. But you also get an AU event Pass, (conference only; does not include travel or hotel accommodations). And you will also receive a $400 cash honorarium for each additional session they lead.&#0160; You can learn more at the <a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals">â€Call for Proposalsâ€ AU site</a>.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c84bdea6970b-pi"><img alt="AU2016" border="0" height="151" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08efa453970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="AU2016" width="754" /></a></p>
<p>Whether or not you feel like youâ€™re up to the challenge of presenting, I would love to hear suggestions for topics on classes you would like to see related to both the Inventor and Fusion APIâ€™s. Remember, even if youâ€™re unable to attend AU in person, youâ€™re still able to benefit from the content from previous sessions.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion Meetups and Melting Butter
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: fusion-meetups-and-melting-butter
CATEGORY: Brian
CATEGORY: Fusion 360
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/04/fusion-meetups-and-melting-butter.html 
DATE: 04/21/2016 10:58:00 PM
-----
BODY:
<p>I had <a href="http://modthemachine.typepad.com/my_weblog/2016/02/fusion-360-meetups.html">posted</a> a few weeks about some upcoming meetups discussing the Fusion API. To generate some interest for the meetups I created a small animation of some butter melting and forming a puddle in a butter dish. Hereâ€™s the original animation.&nbsp; At the meetups I presented an introduction to Fusionâ€™s API and shared how the animation was created. The meetup in Seattle was hosted by Microsoft and <a href="http://codefoster.com/">Jeremy Foster</a>, from Microsoft, was kind enough to record it and post it on <a href="https://channel9.msdn.com/Shows/themakershow/f360api">Microsoftâ€™s Channel 9</a>.</p> <p align="center"><a class="asset-img-link" style="display: inline" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7517970c-pi"><img title="Butter" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d19b7517970c image-full img-responsive" border="0" alt="Butter" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7517970c-800wi"></a> </p> <p align="center">&nbsp;</p> <p>If youâ€™re wondering how I created the animation and are imagining something elaborate youâ€™re going to be a bit disappointed. The good news is that itâ€™s probably simpler to do than youâ€™re expecting. First, there are not any elaborate volume calculations to make sure the volume of the puddle matches the volume that has melted from the cube. I just tried to do what looked good. The melting of the cube and the formation of the puddle is done using parameters so the majority of the work is building the model, not writing the program. Although Iâ€™m using Fusion here, this is all possible with Inventor using the same concepts. What the program is doing is actually very simple; thereâ€™s a loop where in each iteration it changes the value of one or more parameters, updates the model, and captures the screen as an image. Thatâ€™s it. The challenge is building the model so you get the behavior you want by editing parameters.</p> <p>Letâ€™s look in more detail how the butter model works. There are three components that make up the model; the butter dish, the block of butter, and the puddle. Below, three sketches are shown that are the key to making it all work. The sketch at the bottom defines the shape of the puddle. The other two sketches are used to create a loft feature which is subtracted from the block of butter.</p> <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c841f7ef970b-pi"><img title="Butter2_thumb5" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="Butter2_thumb5" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1cc3e87970c-pi" width="800" height="478"></a></p><br> <p>Below is a detailed look at one of the sketches used to define the loft that cuts away the block of butter. The sketch consists of three lines and a spline. The vertical position of the points on the spline is being controlled through the use of dimension constraints. When you place a dimension in a sketch, a parameter is automatically created that controls the value of the dimension. By editing the parameters the points on the spline will move up and down. The program modifies the parameter values so that the points slowly move down, causing the block of butter to disappear.</p> <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1cc3e89970c-pi"><img title="Butter3_thumb2" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="Butter3_thumb2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1cc3e8f970c-pi" width="800" height="400"></a></p><br> <p>The puddle uses the same principal but is slightly more complicated because the points donâ€™t just move down but move in two directions. Below is the puddle sketch. To move the points in two directions there are two dimensions to each spline point, one controlling the horizontal (x) direction and another controlling the vertical (y) direction. To make the puddle grow, the parameters are edited to slowly move the points â€œoutâ€ away from the cube. I didnâ€™t worry about how the puddle intersects the butter dish. As it grows it will end up extending into the dish, but it looks ok because you canâ€™t see the overlap.</p> <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1cc3e98970c-pi"><img title="Butter4_thumb2" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="Butter4_thumb2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08e5c863970d-pi" width="800" height="433"></a></p><br> <p>Below is a snapshot of most of the parameters that are used to drive the model. Sketch7 is the puddle sketch and Sketch8 is one of the loft sketches. I named each of the parameters a name that made sense to me so I knew which parameter to edit to get the corresponding point to move in the way I wanted.</p> <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08e5c867970d-pi"><img title="Butter5_thumb3" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="Butter5_thumb3" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c841f7fb970b-pi" width="554" height="635"></a></p><br> <p>Below is a sample program that demonstrates the full basic workflow where it changes a parameter through a range of values and captures and image at each change. It has a loop where it continually changes the parameter named â€œToChangeâ€. In the example below, the loop goes until the parameter reaches a specified value but it could also go a pre-defined number of steps. It depends on what you need in your specific case.<br><br></p> <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%"><pre>import adsk.core, adsk.fusion, adsk.cam, traceback

<p>def run(context):<br />
    ui = None<br />
    try:<br />
        app = adsk.core.Application.get()<br />
        ui  = app.userInterface</p>

<p>        des = adsk.fusion.Design.cast(app.activeProduct)</p>

<p>        <font color="#0000ff"><strong># Define the values that control the stepping.</strong></font><br />
        startValue = 5<br />
        endValue = 10<br />
        increment = 0.1</p>

<p>        <font color="#0000ff"><strong># Get the parameter to change.</strong></font><br />
        param = des.allParameters.itemByName('ToChange')<br />
        <br />
        <font color="#0000ff"><strong># Iterate through the parameter changes.</strong></font><br />
        currentValue = startValue<br />
        frameCount = 0<br />
        while currentValue &lt; endValue:<br />
            param.value = currentValue<br />
            currentValue += increment<br />
            <br />
            <font color="#0000ff"><strong># Allow Fusion a chance to update.</strong></font><br />
            adsk.doEvents()</p>

<p>            <font color="#0000ff"><strong># Save the current viewport as an image.</strong></font><br />
            frameCount = frameCount + 1<br />
            filename = 'C:/Temp/Animate/Test' + str(frameCount).zfill(4)<br />
            app.activeViewport.saveAsImageFile(filename, 0, 0)<br />
        <br />
        ui.messageBox('Finished.')<br />
    except:<br />
        ui.messageBox('Failed:\n{}'.format(traceback.format_exc()))<br />
</pre></div><br />
<p>The code is really fairly simple. It's all a matter of how creative you get with your parametric model. You can use anything to determine the parameter value and you don't need to be limited to changing a single value. In the melting butter example, I change several values and use a random number so the butter melted and the puddle formed in a slightly random way.</p><br />
<p>The result is a directory containing a bunch of image files. There are many products that will let you combine the images into a video. For the gif file at the top of this post, I used <a href="http://www.gimp.org/">GIMP</a> (Gnu Image Manipulation Program).&nbsp; For a higher resolution, full color animation I used another free tool called <a href="https://www.ffmpeg.org/">FFmpeg</a> where I used the command line below to create the video:<br><br><code>ffmpeg.exe -i C:\Temp\Butter\Images\Butter%04d.png -b 5000k -r 30 output.avi<br><br></code>Here is the <a href="http://modthemachine.typepad.com/ButterMelt.zip">Fusion model and the Python program</a> for the melting butter example. When running the code it begins by displaying a message box to allow you to reset the parameter values back to the original starting values and then an option to run through the parameter changes and generate the images. If you look at the code youâ€™ll see that it does some work to reposition the history marker in the timeline to reduce the re-compute time because Fusion re-computes with every parameter change without an option to delay the re-compute. It moves the marker to just before the features that will re-compute, changes the parameters and then moves it to the end of the timeline so there is a single re-compute of the model with each set of parameter changes.</p><br />
<p>-Brian</p></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Forge DevCon Early Bird tickets ending this Firday! :)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: forge-devcon-early-bird-tickets-
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/04/forge-devcon-early-bird-tickets-.html 
DATE: 04/12/2016 09:31:27 AM
-----
BODY:
<p>You might have heard by now of the biggest ever Autodesk Developer Conference coming this June, <a href="http://forge.autodesk.com/conference/">Forge DevCon</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08d6c7b3970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ForgeDevCon" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08d6c7b3970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08d6c7b3970d-500wi" title="ForgeDevCon" /></a></p>
<p>The <strong>Early Bird tickets</strong> are running out <strong>this Friday</strong>, so you&#39;ll have to hurry up if you want to use them! :)</p>
<p>At the conference&#0160;you can learn everything there is to know about our <a href="http://forge.autodesk.com/platform/">Forge Platform</a> and how you can build on top of it.</p>
<p>Brian will be there to talk about <strong>Fusion API</strong>, and I will be there too explaining how&#0160;you will be able to take advantage of our translation services to get data out of pretty much any design file you have.</p>
<p>There will be many tracks with great topics: <a href="http://forge.autodesk.com/tracks-and-speakers/">http://forge.autodesk.com/tracks-and-speakers/</a>&#0160;</p>
<p>The same week we&#39;ll also have our 2nd <strong>3d Web Fest</strong>:&#0160;<a href="http://www.3dwebfest.com">http://www.3dwebfest.com</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1bcbcf7970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="3dWebFest" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1bcbcf7970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1bcbcf7970c-500wi" title="3dWebFest" /></a></p>
<p>Then the following week we&#39;ll also hold a <a href="http://autodeskcloudaccelerator.com/">Cloud Accelerator</a>, a program that we have run many times by now all around the world with great success. Here we work side-by-side with 3rd party developers to jump start their development on our cloud technologies.</p>
<p>It&#39;s looking to be a great couple of weeks that nobody should miss :)&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: bstewart1966@hotmail.com
EMAIL: bstewart1966@hotmail.com
IP: 209.146.252.226
URL: 
DATE: 04/26/2016 01:21:51 PM
...ending this Firday?  I think you mean Friday.
-----
COMMENT:
AUTHOR: Adam Nagy
EMAIL: 
IP: 213.104.245.142
URL: http://profile.typepad.com/1236098880s16462
DATE: 04/29/2016 12:27:28 PM
I posted the article on the 12th and originally the early bird ticket sales were ending on the 15th, then was extended to the 22nd. Now it's finished.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Forge DevCon Developer Conference
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: forge-devcon-developer-conference
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/04/forge-devcon-developer-conference.html 
DATE: 04/07/2016 10:34:55 PM
-----
BODY:
<p>The first ever Autodesk Forge Developer Conference will take place in San Francisco on June 15-16. This is a great opportunity to get up to speed with whatâ€™s been going on with Fusion and to get a good look at whatâ€™s coming with the new Forge platform.&#160; Weâ€™ll be talking about a lot of upcoming functionality and will be able to demonstrate some of it. Complete information about the conference is available by clicking the picture below.</p>  <p><a href="http://forge.autodesk.com/conference"><img title="ForgeDevCon" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="ForgeDevCon" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ba36c7970c-pi" width="804" height="195" /></a></p>  <p>Weâ€™re still working on the <a href="forge.autodesk.com/tracks-and-speakers">agenda</a> for the conference so check back often for updates. Besides the Forge conference itself, weâ€™re also planning a Fusion API workshop on either the 13th or 14th, so if Fusion is your primary interest you wonâ€™t want to miss that.&#160; Keep watching for updates on the website as we firm up details.&#160;&#160; </p>  <p>Early bird registration is due to end on April 15th, so you don't have much time to buy your ticket at the low cost of $499. If you're a student, you can come for free â€“ just sign up for a student ticket using an <em>.edu</em> email address.</p>  <p>The week following the Forge conference weâ€™ll also be holding a <a href="http://autodeskcloudaccelerator.com/">Forge Accelerator</a> in San Francisco.&#160; This is a chance for you to work on your product that uses Forge and get personal assistance from the experts at Autodesk.&#160; See the <a href="http://autodeskcloudaccelerator.com/">website</a> for information about how to apply for the accelerator.</p>  <p>I hope to see you at any or all of the upcoming events.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 and Forge at SaloneDelMobile.Milano
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-at-salonedelmobilemilano
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/03/fusion-360-at-salonedelmobilemilano.html 
DATE: 03/30/2016 03:07:33 PM
-----
BODY:
<p>As part of the <a href="https://www.salonemilano.it/">SaloneDelMobile.Milano</a> event which is on between <strong>12-17 April</strong>, we&#39;ll organize a <a href="http://www.meetup.com/I-love3Dmilano/events/229310354/">meetup</a> in our <a href="https://www.google.co.uk/maps/place/Autodesk+Spa/@45.4505316,9.1550359,17z/data=!3m1!4b1!4m2!3m1!1s0x4786c3e80d877201:0xaa720c99435d26d">Milano office</a> on&#0160;<strong>15th April</strong>.</p>
<p>Paul Sohi (<a href="https://twitter.com/fuseps">@fuseps</a>) will do a <a href="http://www.autodesk.com/products/fusion-360/overview">Fusion 360</a> workshop and I&#39;ll talk about <a href="http://autodeskfusion360.github.io/">its API</a> and the <a href="http://forge.autodesk.com/platform/">Forge</a> platform, including the <a href="https://developer.autodesk.com/api/view-and-data-api/">View and Data API</a>.&#0160;</p>
<p>You can sign up here:&#0160;<a href="http://www.meetup.com/I-love3Dmilano/events/229310354/">http://www.meetup.com/I-love3Dmilano/events/229310354/</a></p>
<p>If you&#39;re in Milano, do join us! :)</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1b65666970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="FusionMilano" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1b65666970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1b65666970c-500wi" title="FusionMilano" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 Answer Day! :)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-answer-day
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/03/fusion-360-answer-day.html 
DATE: 03/29/2016 01:14:54 PM
-----
BODY:
<p><strong>Fusion 360&#0160;Answer Day</strong> is coming and you&#39;re welcome to join :)<br />This, of course, will include <strong>API</strong> related questions as well.&#0160;</p>
<p>You&#39;ll find here all the info about it:&#0160;<br /><a href="http://forums.autodesk.com/t5/design-validate-document/fusion-360-answer-day-april-6th-2016/td-p/6051338">http://forums.autodesk.com/t5/design-validate-document/fusion-360-answer-day-april-6th-2016/td-p/6051338</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08cfeede970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="FusionAnswerDay" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08cfeede970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08cfeede970d-500wi" title="FusionAnswerDay" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Next Accelerator in Barcelona
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: next-accelerator-in-barcelona
CATEGORY: Adam
CATEGORY: Announcements

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/03/next-accelerator-in-barcelona.html 
DATE: 03/21/2016 04:20:26 PM
-----
BODY:
<p>We have organized quite a few <a href="http://autodeskcloudaccelerator.com/">accelerators</a> already where we are working along with partners to jump start&#0160;their application development.</p>
<p>The next one will be in <strong>Barcelona, Spain May 16 - 20</strong>.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1b1fcac970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Barcelona" class="asset  asset-image at-xid-6a0167607c2431970b01b8d1b1fcac970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1b1fcac970c-500wi" title="Barcelona" /></a></p>
<p>If you are planning to build on top of our <a href="http://forge.autodesk.com/">Forge</a>&#0160;platform and like the location then <a href="http://autodeskcloudaccelerator.com/apply/">apply now</a>! :)</p>
<p><a href="http://autodeskcloudaccelerator.com/">http://autodeskcloudaccelerator.com/</a></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08cc00a2970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Forgesite" class="asset  asset-image at-xid-6a0167607c2431970b01bb08cc00a2970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08cc00a2970d-500wi" title="Forgesite" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Is Your Add-In Causing Problems in Inventor 2017?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: is-your-add-in-causing-problems-in-inventor-2017
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/03/is-your-add-in-causing-problems-in-inventor-2017.html 
DATE: 03/08/2016 09:13:08 PM
-----
BODY:
<p>A problem was reported in the beta of Inventor 2017, where an error dialog is appearing when shutting down Inventor. The error was being thrown by one of the add-ins delivered with Inventor. However, the Autodesk team was unable to reproduce the problem and couldnâ€™t find any problems with the add-in.&#160; Someone suggested that maybe the cause was another add-in and after some testing an add-in on the Autodesk App Store could be used to reproduce the problem and using it the actual cause of the problem was found. Last week, I was notified that they identified the add-in that was causing the problem for the customer and it turned out to be my Sheet Metal Extents add-in. Not good. <img class="wlEmoticon wlEmoticon-sadsmile" style="border-top-style: none; border-bottom-style: none; border-right-style: none; border-left-style: none" alt="Sad smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1ab38fd970c-pi" /></p>  <p>My add-in has run fine for many releases now and I havenâ€™t changed anything but apparently something has changed in some Microsoft components that is causing the problem to appear. After understanding the problem, it really is an error in my add-in and Iâ€™ve just been lucky that it hasnâ€™t shown up before. The reason my Sheet Metal Extents add-in is causing the problem is because of how it is releasing the Inventor objects its referencing. Itâ€™s using the .NET function FinalReleaseComObject. Without going into a lot of COM details about object lifetimes and reference counting, this function forces an object to be released. At the time of the call everything seems fine, but the problem is that it might not be the only add-in using that Inventor object and when the other add-in tries to use that object the problem appears.&#160; </p>  <p>When we first started supporting .NET for writing add-ins, there was quite a bit of discussion about how to make it all work.&#160; With Visual Basic 6, when a variable goes out of scope or you explicitly set it to Nothing, the reference to the internal Inventor object is immediately released (actually the reference count is decremented by one and if it goes to zero then itâ€™s released). With .NET, this doesnâ€™t happen immediately but relies on the Garbage Collector to clean things up. Thatâ€™s fine, but the Garbage Collector runs at an indeterminate time.&#160; Usually thatâ€™s ok but in the case of add-ins it was preventing Inventor from shutting down because Inventor thought there were still active external references to Inventor objects.&#160; .NET supports some functions to force the release of references and to force garbage collection.&#160; The functions FinalReleaseComObject and ReleaseComObject will do an explicit release.&#160; ReleaseCOMObject being the safer because it just decrements the reference count so if others are using the object it will still be available to them.</p>  <p>So, after seeing this I was planning to change my add-in to use ReleaseComObject instead of FinalReleaseComObject.&#160; However, I did a bit more research and found a <a href="https://blogs.msdn.microsoft.com/visualstudio/2010/03/01/marshal-releasecomobject-considered-dangerous/">very interesting article</a>.&#160; It also made me feel better to see that Microsoft was struggling with some of the same problems. They strongly recommend to not use FinalReleaseComObject or ReleaseComObject but to allow the Garbage Collector to do itâ€™s job.&#160; There were also some changes made in Inventor some time ago so that it wonâ€™t let an add-in keep it from shutting down.</p>  <p><strong><font size="4"></font></strong></p>  <p><strong><font size="4">What You Need to Do</font></strong></p>  <p>In summary, you need to check your add-ins for any calls to FinalReleaseComObject and either change them to ReleaseComObject or even better is to remove them and just make sure youâ€™re setting that reference to Nothing (null) so that the Garbage Collector can handle it correctly. If youâ€™ve used the Inventor Add-In Template thatâ€™s delivered as part of the Inventor SDK, you should be in good shape because itâ€™s already doing the correct thing. In the Deactivate method of the the add-in, Itâ€™s setting the variable that reference global Inventor objects to Nothing and then calls the Collect method of the garbage collection to force a collection. Let us know if you find any problems after making this change.&#160; Iâ€™ve removed the FinalReleaseComObject call from my Sheet Metal Extents add-in and everything seems to be working fine.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Kirk Arthur
EMAIL: karthur@fmi-solutions.com
IP: 12.236.116.18
URL: 
DATE: 04/29/2016 01:21:47 PM
Brian,
Thanks for update to the add-in. Is the updated version posted here on the blog? I found the blog "Latest Update to Sheet Metal Extents Add-In" (<a href="http://modthemachine.typepad.com/my_weblog/2015/03/latest-update-to-sheet-metal-extents-add-in.html)">http://modthemachine.typepad.com/my_weblog/2015/03/latest-update-to-sheet-metal-extents-add-in.html)</a> and downloaded the "Sheet Metal Extents 3.5" found there, but it still gives the error when I exit Inventor 2017.  I could not find it on in the Inventor app store.  Could you tell us where to find the update for 2017? 

Thanks
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion Add-In with .NET (C++ & CLR)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-add-in-with-net-c-clr
CATEGORY: Adam
CATEGORY: Add-In Creation
CATEGORY: C++
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/02/fusion-add-in-with-net-c-clr.html 
DATE: 02/27/2016 12:44:09 AM
-----
BODY:
<p>I&#39;ve&#0160;written about <a href="http://modthemachine.typepad.com/my_weblog/2016/02/fusion-add-in-with-mfc.html">using <strong>MFC</strong> from a <strong>C++</strong> <strong>Fusion</strong> add-in</a>. You could also use .<strong>NET</strong> from your add-in, and it&#39;s even simpler to set up.</p>
<p>1) Create a <strong>C++</strong> add-in inside the&#0160;&quot;<strong>Scripts and Add-Ins</strong>&quot; <strong>Fusion&#0160;</strong>dialog:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f5a6970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateAddIn" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f5a6970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f5a6970c-500wi" title="CreateAddIn" /></a></p>
<p>I&#39;m leaving&#0160;&quot;<strong>Run on&#0160;Startup</strong>&quot; option&#0160;above <strong>unchecked</strong>,&#0160;because it would not be a good idea to pop up a modal dialog while <strong>Fusion</strong> is starting up. That would halt the startup process.</p>
<p>2) Open it for edit:</p>
<p><a class="asset-img-link" href="http://a2.typepad.com/6a0112791b8fe628a401bb08bfa202970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="EditAddIn" class="asset  asset-image at-xid-6a0112791b8fe628a401bb08bfa202970d img-responsive" src="https://a2.typepad.com/6a0112791b8fe628a401bb08bfa202970d-320wi" title="EditAddIn" /></a></p>
<p>3) Add &quot;<strong>Common Language Runtime Support</strong>&quot; in your <strong>C++</strong> project&#39;s <strong>Properties</strong> dialog</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bf9f67970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ClrSupport" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bf9f67970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bf9f67970d-500wi" title="ClrSupport" /></a></p>
<p>4) Place the <strong>Fusion</strong> related code inside a&#0160;<span style="background: #ffffff; color: #0000ff;">#pragma</span> <span style="background: #ffffff; color: #0000ff;">unmanaged</span>&#0160;/<span style="background: #ffffff; color: #0000ff;">#pragma</span> <span style="background: #ffffff; color: #0000ff;">managed&#0160;</span>block</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa0b1970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="PragmaUnmanaged" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bfa0b1970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa0b1970d-500wi" title="PragmaUnmanaged" /></a></p>
<p>5) Add a &quot;<strong>Windows Form</strong>&quot; through &quot;<strong>PROJECT</strong>&quot; &gt;&gt; &quot;<strong>Add New Item...</strong>&quot;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa110970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="WindowsForm" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bfa110970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa110970d-500wi" title="WindowsForm" /></a></p>
<p>Note: You can add any of the <strong>.NET Form</strong> controls to it as in case of a <strong>C#</strong> or <strong>VB.NET</strong> project. I&#39;ve just added a list box for testing and filled it with items.</p>
<p>6) Create a function to show this dialog</p>
<p>a) In &quot;<strong>MyForm.h</strong>&quot; declare&#0160;<strong>showDialog</strong>()</p>
<p><a class="asset-img-link" href="http://a3.typepad.com/6a0112791b8fe628a401bb08bfa213970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyFormH" class="asset  asset-image at-xid-6a0112791b8fe628a401bb08bfa213970d img-responsive" src="https://a3.typepad.com/6a0112791b8fe628a401bb08bfa213970d-500wi" title="MyFormH" /></a></p>
<p>b) In &quot;<strong>MyForm.cpp</strong>&quot; implement the function</p>
<p><a class="asset-img-link" href="http://a0.typepad.com/6a0112791b8fe628a401b8d1a4f7b8970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyFormCpp" class="asset  asset-image at-xid-6a0112791b8fe628a401b8d1a4f7b8970c img-responsive" src="https://a0.typepad.com/6a0112791b8fe628a401b8d1a4f7b8970c-500wi" title="MyFormCpp" /></a></p>
<p>7) Now we can call it from the&#0160;startup function called <strong>run</strong>()</p>
<p>a) Add&#0160;<span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">&quot;MyForm.h&quot;</span>&#0160;to the top of &quot;<strong>CustomNetUi.cpp</strong>&quot;</p>
<p>b) Call <strong>showDialog</strong>() from <strong>run</strong>()</p>
<div style="line-height: 120%; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #a31515;">&quot;C&quot;</span> <span style="background: #ffffff; color: #6f008a;">XI_EXPORT</span> <span style="background: #ffffff; color: #0000ff;">bool</span><span style="background: #ffffff; color: #000000;"> run(</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">char</span><span style="background: #ffffff; color: #000000;">* </span><span style="background: #ffffff; color: #808080;">context</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; app = </span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">::get();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!app)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; ui = app-&gt;userInterface();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!ui)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; showDialog();</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>8) Test the&#0160;app by running it from the&#0160;&quot;<strong>Scripts and Add-Ins</strong>&quot; <strong>Fusion&#0160;</strong>dialog:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f96f970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="RunAddIn" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f96f970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f96f970c-320wi" title="RunAddIn" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f976970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="AddInForm" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f976970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f976970c-320wi" title="AddInForm" /></a></p>
<p>The sample project can be found here:<br /><a href="https://github.com/AutodeskFusion360/NativeUI">https://github.com/AutodeskFusion360/NativeUI</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Attribute Helper 2.5
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: attribute-helper-25
CATEGORY: Brian
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/02/attribute-helper-25.html 
DATE: 02/22/2016 07:47:45 PM
-----
BODY:
<p>A problem was reported and Iâ€™ve made a fix and have created a new version of the Attribute Helper utility.&#0160; If youâ€™re unfamiliar with it, itâ€™s a little utility that lets you create, view, and edit attributes within a document. If youâ€™re relatively new to the Inventor API and are wondering what attributes are, hereâ€™s a <a href="http://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html">post giving a quick introduction</a>.</p>
<p>If you already have a version of â€œAttribute Helperâ€ installed, you should first uninstall the version you have, which you can do using the standard Windows uninstall utility where you should see â€œAttribute Helperâ€ listed as one of the installed programs, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d146b5ef970c-pi"><img alt="UninstallAttributeHelper" border="0" height="349" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0860fe9c970d-pi" title="UninstallAttributeHelper" width="450" /></a></p>
<p>Once itâ€™s uninstalled, you can install the <a href="http://modthemachine.typepad.com/AttributeHelperSetup_2.5.exe">2.5 version of Attribute Helper</a>.&#0160; There is some help documentation delivered with the utility with instructions on how to use it and you can quickly determine if it was installed correctly by checking to see if the Attribute Helper command is now available in the Tools panel when you have a document open.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d146b5f3970c-pi"><img alt="AttributeHelperCommand" border="0" height="70" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7bcd881970b-pi" title="AttributeHelperCommand" width="450" /></a></p>
<p>And when you run the Attribute Helper command, you should see the dialog below with the version displayed being â€œ2.5â€, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a30d45970c-pi"><img alt="AttributeHelper2_5" border="0" height="504" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c818ec41970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="AttributeHelper2_5" width="354" /></a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: MechMachineMan
EMAIL: justin.konecsni@gmail.com
IP: 142.165.62.251
URL: 
DATE: 02/24/2016 01:51:19 PM
Does this utility allow access to object attributes?

I've been looking for a better way to "connect" section views and sketched symbols for the various needs I have in my code, and attributes sound promising. If this allows easy editting of that, it would great! (Ie; adding sketch/sketched symbol attributes that are the same across all connected objects)
-----
COMMENT:
AUTHOR: Kari Holgarsson
EMAIL: kh@bwe.dk
IP: 10.20.33.116
URL: 
DATE: 05/18/2016 08:49:15 AM
Hi
As we have changed to Symantec Antivirus we are no longer able to install this add-in as it is seen as a threat.

The attributehelpersetup_2.5[1].exe is automatically removed...
Detected As:SAPE.Heur.B0034

Any suggestion?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion Add-In with MFC
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: fusion-add-in-with-mfc
CATEGORY: Adam
CATEGORY: Add-In Creation
CATEGORY: C++
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/02/fusion-add-in-with-mfc.html 
DATE: 02/20/2016 06:54:47 PM
-----
BODY:
<p>It is possible to&nbsp;use <strong>MFC</strong> functionality inside your <strong>Fusion</strong> add-in on <strong>Windows</strong>. <br />First I tried going down the path of creating a <strong>C++</strong>&nbsp;add-in inside the "<strong>Scripts and Add-Ins</strong>" <strong>Fusion</strong> dialog and then add <strong>MFC</strong> support to the created <strong>Visual Studio C++</strong> project. However, that&nbsp;proved quite difficult and I just gave up and went the other way: created an <strong>MFC DLL</strong>&nbsp;project and turned it into a <strong>Fusion</strong> add-in. That was much simpler.&nbsp;</p>
<p>1) Create an&nbsp;<strong>MFC DLL</strong> project</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c818179a970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c818179a970b img-responsive" title="MfcCreate1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c818179a970b-500wi" alt="MfcCreate1" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bce21c970d-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bce21c970d img-responsive" title="MfcCreate2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bce21c970d-500wi" alt="MfcCreate2" /></a></p>
<p>2) Add a <strong>Dialog</strong> resource to it</p>
<p>Open <strong>CustomMfcUi.rc</strong>, right-click and choose "<strong>Add Resource...</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a23cfa970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a23cfa970c img-responsive" title="MfcResource" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a23cfa970c-320wi" alt="MfcResource" /></a></p>
<p>... then select "<strong>Dialog</strong>" and click "<strong>New</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181859970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181859970b img-responsive" title="MfcResourceNew" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181859970b-320wi" alt="MfcResourceNew" /></a></p>
<p>3) Double-click the "<strong>OK</strong>" button of the newly added <strong>Dialog</strong> so that the "<strong>MFC Add Class Wizard</strong>" dialog will pop up:&nbsp;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c818189f970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c818189f970b img-responsive" title="MfcWizard" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c818189f970b-500wi" alt="MfcWizard" /></a></p>
<p>Fill it in and click "<strong>Finish</strong>"</p>
<p>4) Rename <strong>IDD_DIALOG1</strong>&nbsp;to <strong>IDD_MYDIALOG</strong> just to keep things tidy</p>
<p>You can use the "<strong>Find and Replace</strong>" dialog of <strong>Visual Studio</strong> for that:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181a52970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181a52970b img-responsive" title="MfcFind1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181a52970b-320wi" alt="MfcFind1" /></a></p>
<p>There should be <strong>4</strong> instances replaced at the end:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a23f3c970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a23f3c970c img-responsive" title="MfcFind2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a23f3c970c-320wi" alt="MfcFind2" /></a></p>
<p>5) Add a function to show our dialog</p>
<p>a) Inside <strong>CustomMfcUi.cpp</strong> add this code:</p>
<div style="line-height: 110%; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> showDialog()</span><br /> <span style="background: #ffffff; color: #000000;">{&nbsp;&nbsp;</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #008000;">// Always call this macro first thing in any function that</span><br /><span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #008000;">// will use MFC functionality </span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #6f008a;">AFX_MANAGE_STATE</span><span style="background: #ffffff; color: #000000;">(AfxGetStaticModuleState());</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #2b91af;">CMyDialog</span><span style="background: #ffffff; color: #000000;"> myDialog; </span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;myDialog.DoModal();</span><br /> <span style="background: #ffffff; color: #000000;">};</span></div>
</div>
<p>b) Inside&nbsp;<strong>CustomMfcUi.h</strong>&nbsp;add this code at the top:</p>
<div style="line-height: 110%; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">"MyDialog.h"</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> showDialog();</span></div>
</div>
<p>6) Add <strong>Fusion</strong> functionality&nbsp;</p>
<p>Add&nbsp;a new <strong>C++</strong> file to the project called <strong>FusionCode.cpp</strong>&nbsp;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bce611970d-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bce611970d img-responsive" title="FusionCode" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bce611970d-500wi" alt="FusionCode" /></a></p>
<p>Fill it with this code:</p>
<div style="line-height: 110%; color: #000; font-family: 'Courier New', Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">"stdafx.h"</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">&lt;Core/CoreAll.h&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">&lt;Fusion/FusionAll.h&gt;</span><br /> <br /> <span style="background: #ffffff; color: #008000;">// XI_WIN is a macro added by Fusion headers</span><br /><span style="background: #ffffff; color: #008000;">// to show if the project is a Windows project</span><br /><span style="background: #ffffff; color: #0000ff;">#ifdef</span><span style="background: #ffffff; color: #000000;"> XI_WIN</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">"CustomMfcUi.h"</span><br /> <span style="background: #ffffff; color: #0000ff;">#endif</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> adsk::core;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> adsk::fusion;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">Ptr&lt;Application&gt; app;</span><br /> <span style="background: #ffffff; color: #000000;">Ptr&lt;UserInterface&gt; ui;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #a31515;">"C"</span><span style="background: #ffffff; color: #000000;"> XI_EXPORT </span><span style="background: #ffffff; color: #0000ff;">bool</span><span style="background: #ffffff; color: #000000;"> run(</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">char</span><span style="background: #ffffff; color: #000000;">* context)</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;app = Application::get();</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!app)</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;ui = app-&gt;userInterface();</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!ui)</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;showDialog();</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">}</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #a31515;">"C"</span><span style="background: #ffffff; color: #000000;"> XI_EXPORT </span><span style="background: #ffffff; color: #0000ff;">bool</span><span style="background: #ffffff; color: #000000;"> stop(</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">char</span><span style="background: #ffffff; color: #000000;">* context)</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (ui)</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;{</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;ui-&gt;messageBox(</span><span style="background: #ffffff; color: #a31515;">"in stop"</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;ui = </span><span style="background: #ffffff; color: #0000ff;">nullptr</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&nbsp;&nbsp;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>7) Make the project compile as <strong>64 bit</strong> since <strong>Fusion 360</strong> is <strong>64 bit&nbsp;</strong>too</p>
<p>Inside the<strong>&nbsp;</strong>"<strong>Configuration Manager</strong>" dialog, under "<strong>Active solution platform</strong>" select "<strong>&lt;New...&gt;</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181e35970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181e35970b img-responsive" title="Config1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181e35970b-500wi" alt="Config1" /></a></p>
<p>... and add the "<strong>x64</strong>" platform</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181e42970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181e42970b img-responsive" title="Config2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181e42970b-320wi" alt="Config2" /></a></p>
<p>8) Add references to <strong>Fusion</strong> <strong>headers</strong> and <strong>libraries</strong> so that our project will compile</p>
<p>a) Inside the project settings, under "<strong>C/C++</strong>"&nbsp;&gt;&gt; "<strong>Additional Include Directories</strong>" add "<strong>$(APPDATA)/Autodesk/Autodesk Fusion 360/API/CPP/include</strong>"&nbsp;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181c37970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181c37970b img-responsive" title="MfcProject1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181c37970b-500wi" alt="MfcProject1" /></a></p>
<p>b) Under "<strong>Linker</strong>" &gt;&gt; "<strong>Additional Library Directories</strong>" add "<strong>$(APPDATA)/Autodesk/Autodesk Fusion 360/API/CPP/lib</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a241cf970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a241cf970c img-responsive" title="MfcProject2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a241cf970c-500wi" alt="MfcProject2" /></a></p>
<p>c) Under "<strong>Linker</strong>" &gt;&gt; "<strong>Additional Dependencies</strong>" add "<strong>core.lib;fusion.lib;</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181d1f970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8181d1f970b img-responsive" title="MfcProject3" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8181d1f970b-500wi" alt="MfcProject3" /></a></p>
<p>9) Let <strong>Fusion</strong>&nbsp;find our project</p>
<p>a) Under "<strong>$(APPDATA)\Autodesk\Autodesk Fusion 360\API\AddIns</strong>" create a folder named the same as our <strong>dll</strong>&nbsp;"<strong>CustomMfcUi</strong>"&nbsp;</p>
<p>Add to that folder a <strong>manifest file</strong> with the same name, i.e. "<strong>CustomMfcUi.manifest</strong>" and add the following content to it in any text editor:</p>
<pre>{
"autodeskProduct":"Fusion360",
"type":"addin",
"author":"",
"description":{"":""},
"supportedOS":"windows",
"editEnabled":false,
"id":"38EE9339-591A-4F72-AFFF-7B20111CC10C",
"version":"1.0.0",
"runOnStartup":false
}</pre>
<p>The "<strong>id</strong>" part in the above text needs to be <strong>unique</strong>. You could use e.g.&nbsp;<strong>Visual Studio</strong>'s "<strong>Create GUID</strong>" dialog for that. Just remove the curly braces from the generated string</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a24620970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a24620970c img-responsive" title="Guid" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a24620970c-320wi" alt="Guid" /></a></p>
<p>I'm setting the&nbsp;"<strong>runOnStartup</strong>" option&nbsp;above to <strong>false</strong> because it would not be a good idea to pop up a modal dialog while <strong>Fusion</strong> is starting up. That would halt the startup process.</p>
<p>b) Make our project output the created <strong>dll</strong> into the <strong>Add-In</strong> folder we just created. Inside the project settings under "<strong>General</strong>" &gt;&gt; "<strong>Output Directory</strong>" add the path of our&nbsp;folder "<strong>$(APPDATA)\Autodesk\Autodesk Fusion 360\API\AddIns\CustomMfcUi</strong>" &nbsp;&nbsp;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8182155970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8182155970b img-responsive" title="Output" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8182155970b-500wi" alt="Output" /></a></p>
<p>10) Test it</p>
<p><strong>Compile</strong> the project and inside the&nbsp;"<strong>Scripts and Add-Ins</strong>" dialog of <strong>Fusion</strong>, select our <strong>add-in</strong> and click "<strong>Run</strong>"</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bceeea970d-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bceeea970d img-responsive" title="MfcTest" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bceeea970d-500wi" alt="MfcTest" /></a></p>
<p>Our dialog should pop up</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8182452970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" style="display: inline;"><img class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c8182452970b img-responsive" title="MfcTest2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8182452970b-500wi" alt="MfcTest2" /></a></p>
<p>The sample project can be found here:<br /><a href="https://github.com/AutodeskFusion360/NativeUI">https://github.com/AutodeskFusion360/NativeUI</a></p>
<p>-Adam&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating a Button for a VBA Macro
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-a-button-for-a-vba-macro
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/02/creating-a-button-for-a-vba-macro.html 
DATE: 02/10/2016 01:45:20 AM
-----
BODY:
<p>I had written a <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">post many years ago</a> describing the process to do this but it was before the existence of the ribbon user interface and a few things have changed so I thought I would create a new post.</p>  <p>Itâ€™s fairly easy to create a button within the ribbon that will execute an existing VBA macro.&#160; In Inventor, have the ribbon that you want to insert your button displayed, right-click on the ribbon, and choose the â€œCustomize User Commandsâ€¦â€. This will display the Customize dialog shown below. Choose â€œMacrosâ€ from the drop-down at the top of the command list. This will display all of your macros. Pick your macro and then click the â€œ&gt;&gt;â€ button in the middle of the dialog. This will move that macro over to the right-hand side of the dialog. You can then choose if text should be displayed and if a large or small icon should be used. A new panel called â€œUser Commandsâ€ will be added to the ribbon and it will contain buttons for the macros youâ€™ve selected to give you one-click easy access to your program.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8138102970b-pi"><img title="CustomizeRibbon" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="CustomizeRibbon" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19da351970c-pi" width="749" height="419" /></a></p>  <p>When you do this a default icon is used. If you want a custom icon you need to create a 16x16 image for a small icon or a 32x32 image for a large icon. This currently must be a bmp type of image. The name of the image is important. In this example, my macro is called â€œTitleBlockâ€&#160; and the images for it are:</p>  <p>&#160;&#160;&#160; Module1.TitleBlock.Small.bmp</p>  <p>&#160;&#160;&#160; Module1.TitleBlock.Large.bmp </p>  <p>Where the name is â€œ<i>ModuleName</i>.<i>MacroName</i>.<i>IconSize</i>.bmpâ€ where IconSize can be â€œSmallâ€ or â€œLargeâ€. The files need to be in the same directory as the VBA project file. You can find out that location on your system by looking at the â€œFileâ€ tab of the â€œApplication Optionsâ€ dialog, as shown below. On my computer this is â€œC:\Users\Public\Documents\Autodesk\Inventor 2016â€.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19da357970c-pi"><img title="DefaultVBAProject" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="DefaultVBAProject" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19da35b970c-pi" width="516" height="61" /></a></p>  <p>The other option to making your program easily accessible is to convert it to an add-in. This makes it very easy to share your program. You can deliver a set of files, or even an installer, and the receiver either copies the files to a specified location or just runs the installer. The next time they start Inventor theyâ€™ll see the new commands. If you get serious about writing programs youâ€™ll want to start writing add-ins.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360 Meetups
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-meetups
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/02/fusion-360-meetups.html 
DATE: 02/04/2016 11:11:30 PM
-----
BODY:
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">Later this month Iâ€™ll be attending and presenting the Fusion 360 API at several Fusion 360 Meetups along the west coast. The list below contains links to the Meetup site where you can get more information about times and specific locations.</span></p>
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><a href="http://www.meetup.com/San-Francisco-Fusion-360-Meetup/">Tuesday Feb. 16th â€“ San Francisco</a></span></p>
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><a href="http://www.meetup.com/Seattle-Autodesk-Fusion-360-Meetup-Group">Thursday Feb. 18th â€“ Seattle</a></span></p>
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;"><a href="http://www.meetup.com/Portland-Fusion-360-Meetup">Tuesday Feb. 23rd â€“ Portland</a></span></p>
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">At the Meetup here in Portland last month they had a couple of modeling challenges. One of them was a butter dish.&#0160; As a teaser for this upcoming Meetup I created the animation below using my butter dish and the API. If youâ€™re curious how this was done, Iâ€™ll discuss it at the Meetup.&#0160;<a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7b37970c-pi" style="display: inline;"><img alt="Smiley" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d19b7b37970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7b37970c-50wi" style="width: 19px;" title="Smiley" /></a>&#0160;And for those that canâ€™t attend, Iâ€™ll post something here at the end of the month.</span></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7517970c-pi" style="display: inline;"><img alt="Butter" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d19b7517970c image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19b7517970c-800wi" title="Butter" /></a><br /><a href="$Butter[4].gif"></a></p>
<p><span style="font-family: arial,helvetica,sans-serif; font-size: 12pt;">-Brian</span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor Answer Day
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-answer-day-1
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/inventor-answer-day-1.html 
DATE: 01/26/2016 06:30:33 PM
-----
BODY:
<p>I know Adam already posted about Answer Day but I just want to give one more reminder and to let everyone know that API questions are included in this.&#0160; Thereâ€™s a <a href="http://autode.sk/answerdays">special forum</a> thatâ€™s been created just for Answer Day.&#0160; If you go there now it explains about Answer Day but tomorrow it will become active at 6am Pacific time and youâ€™ll be able to start posting questions. Depending on the quantity of new questions coming in there, weâ€™ll also be going back through any open questions on the <a href="http://forums.autodesk.com/t5/inventor-customization/bd-p/120">Inventor Customization Forum</a>.&#0160; It should be a great event and a chance to get over any hurdles on the project youâ€™ve been working on or jump start the project youâ€™ve been wanting to get started.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Insert external component
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: insert-external-component
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/insert-external-component.html 
DATE: 01/26/2016 10:48:37 AM
-----
BODY:
<p>The <strong>Fusion API</strong> provides access to your <strong>A360</strong> projects and the files as well. Through that you can insert an external component if you want.</p>
<p>The following sample lists your projects and the files in their root folder, and then lets you insert the selected one in the root component of your current model.</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d196e180970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DataAPI" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d196e180970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d196e180970c-320wi" title="DataAPI" /></a></p>
<p>When testing the script you need to give a bit of time for the command window to pop up and the file drop down to update when you are changing the project.</p>
<p>Source: <a href="https://github.com/AutodeskFusion360/InsertExternalComponent">https://github.com/AutodeskFusion360/InsertExternalComponent</a>&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Selection object properties become invalid
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: selection-object-properties-become-invalid
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/selection-object-properties-become-invalid.html 
DATE: 01/20/2016 03:02:50 PM
-----
BODY:
<p>In your commands you can use <a href="http://help.autodesk.com/cloudhelp/ENU/Fusion-360-API/files/SelectionCommandInput.htm">SelectionCommandInput</a>&#0160;objects and they work fine. However, if you do certain modifications on the model, e.g. create a new sketch, then the&#0160;<strong>Selection</strong> object of the last used&#0160;<strong>SelectionCommandInput</strong> will become invalid:</p>
<pre>var onCommandExecuted = function(args) {
    try {
        var command = adsk.core.Command(args.firingEvent.sender);
        var inputs = command.commandInputs;

        // both are filtered for vertex selection
        var selection1 = inputs.itemById(&#39;selection1&#39;).selection(0);
        var selection2 = inputs.itemById(&#39;selection2&#39;).selection(0);

        var design = app.activeProduct;
        var root = design.rootComponent;
        var sketches = root.sketches;
        var xyPlane = root.xYConstructionPlane;

        // Monitor selection1 and selection2 in the object 
        // window. As soon as we create a new sketch the 
        // variable to the last selected entity will become
        // unavailable &gt;&gt; &lt;not available&gt;
        sketches.add(xyPlane);
        ui.messageBox(&quot;selection1 &gt;&gt; &quot; + selection1.<strong>entity</strong>.edges.count.toString()); // this succeeds
        ui.messageBox(&quot;selection2 &gt;&gt; &quot; + selection2.<strong>entity</strong>.edges.count.toString()); // this does not
     } 
     catch (e) {        
        ui.messageBox(&#39;Failed to run command : &#39; + (e.description ? e.description : e));
    }
};</pre>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c80a38f1970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="SelectionIssue" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c80a38f1970b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c80a38f1970b-320wi" title="SelectionIssue" /></a></p>
<p>This should not really affect you though, since you can get all the information out of the <strong>Selection</strong> objects <span style="text-decoration: underline;">before</span> doing any manipulation on the model:</p>
<pre>var onCommandExecuted = function(args) {
    try {
        var command = adsk.core.Command(args.firingEvent.sender);
        var inputs = command.commandInputs;

        // both are filtered for vertex selection
        var selectedEntity1 = inputs.itemById(&#39;selection1&#39;).selection(0).<strong>entity</strong>;
        var selectedEntity2 = inputs.itemById(&#39;selection2&#39;).selection(0).<strong>entity</strong>;

        var design = app.activeProduct;
        var root = design.rootComponent;
        var sketches = root.sketches;
        var xyPlane = root.xYConstructionPlane;

        sketches.add(xyPlane);
        ui.messageBox(&quot;selection1 &gt;&gt; &quot; + selectedEntity1.edges.count.toString()); 
        ui.messageBox(&quot;selection2 &gt;&gt; &quot; + selectedEntity2.edges.count.toString()); 
     } 
     catch (e) {        
        ui.messageBox(&#39;Failed to run command : &#39; + (e.description ? e.description : e));
    }
};</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Open Drawing from a Part or Assembly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: open-drawing-from-a-part-or-assembly
CATEGORY: Brian
CATEGORY: Drawings
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/open-drawing-from-a-part-or-assembly.html 
DATE: 01/13/2016 10:51:42 PM
-----
BODY:
<p>Inventor supports the â€œOpen Drawingâ€ command that you can access from the context menu when clicking on a part or assembly node in the browser.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c807155b970b-pi"><img title="FindDrawing" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="FindDrawing" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c807155f970b-pi" width="247" height="350" /></a></p>  <p>&#160;</p>  <p>The equivalent functionality is not available through the Inventor API. However, the logic behind the command is very simple and not difficult to do on your own using Inventorâ€™s API and features built into your programming language. A part or assembly doesnâ€™t know if there are any drawings referencing it so the command just takes the filename of the part or assembly and looks for a file within the project of the same name as the part or assembly but with a .idw or .dwg extension.</p>  <p>Below is a VBA Sub that passes in the active part or assembly document to a function that either returns the full filename to the found drawing or an empty string if it canâ€™t find a drawing.</p>  <br />  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub FindDrawingTest()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument&#160; <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Call the function to get the drawing.</font></strong>&#160; <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = FindDrawingFile(partDoc)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Display the result.</font></strong>       <br />&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The drawing for &quot;&quot;&quot; &amp; partDoc.fullFilename &amp; &quot;&quot;&quot; was found: &quot; &amp; vbCr &amp; drawingFilename       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;No drawing was found for &quot;&quot;&quot; &amp; partDoc.fullFilename &amp; &quot;&quot;&quot;&quot;       <br />&#160;&#160;&#160; End If       <br />End Sub      <br />      <br />      <br /><font color="#0000ff"><strong>' Find the drawing for the specified part of assembly.          <br /></strong></font>Private Function FindDrawingFile(PartOrAssemblyDoc As Document)       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = PartOrAssemblyDoc.fullFilename       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the path from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim path As String       <br />&#160;&#160;&#160; path = Left$(fullFilename, InStrRev(fullFilename, &quot;\&quot;))       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the filename from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = Right$(fullFilename, Len(fullFilename) - InStrRev(fullFilename, &quot;\&quot;))       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Replace the extension with &quot;dwg&quot;</strong></font>       <br />&#160;&#160;&#160; filename = Left$(filename, InStrRev(filename, &quot;.&quot;)) &amp; &quot;dwg&quot;       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the drawing exists.</strong></font>       <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = ThisApplication.DesignProjectManager.ResolveFile(path, filename)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename = &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Try again with idw extension.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Left$(filename, InStrRev(filename, &quot;.&quot;)) &amp; &quot;idw&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the drawing exists.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawingFilename = ThisApplication.DesignProjectManager.ResolveFile(path, filename)       <br />&#160;&#160;&#160; <br /><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Return the result.</font>         <br /></strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = drawingFilename       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = &quot;&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = drawingFilename       <br />&#160;&#160;&#160; End If       <br />End Function</p> </div>  <br />  <p>And hereâ€™s the same thing implemented in Visual Basic .NET</p>  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Private Sub btnFindDrawing_Click(sender As Object, e As EventArgs) Handles btnFindDrawing.Click      <br />&#160;&#160;&#160; Dim invApp As Inventor.Application = GetObject(, &quot;Inventor.Application&quot;)       <br />&#160;&#160;&#160; Dim partDoc As Inventor.PartDocument = invApp.ActiveDocument      <br />      <br /></p>&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>'&#160; Call the function to get the drawing.</strong></font>&#160; <br />    <p>&#160;&#160;&#160; Dim drawingFilename As String = FindDrawingFile(partDoc)     <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Display the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;The drawing for &quot;&quot;&quot; &amp; partDoc.FullFileName &amp; &quot;&quot;&quot; was found: &quot; &amp; vbCr &amp; drawingFilename)       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;No drawing was found for &quot;&quot;&quot; &amp; partDoc.FullFileName &amp; &quot;&quot;&quot;&quot;)       <br />&#160;&#160;&#160; End If       <br />End Sub       <br />      <br />      <br /><font color="#0000ff"><strong>' Find the drawing for the specified part of assembly.</strong></font>       <br />Private Function FindDrawingFile(PartOrAssemblyDoc As Inventor.Document)       <br />&#160;&#160;&#160; Dim fullFilename As String = PartOrAssemblyDoc.FullFileName      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the path from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim path As String = System.IO.Path.GetFullPath(fullFilename)      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the filename from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim filename As String = System.IO.Path.GetFileNameWithoutExtension(fullFilename)      <br />&#160;&#160;&#160; Dim invApp As Inventor.Application = PartOrAssemblyDoc.Parent      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the dwg exists.</strong></font>       <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = invApp.DesignProjectManager.ResolveFile(path, filename &amp; &quot;.dwg&quot;)      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename = &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Try again with idw extension.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawingFilename = invApp.DesignProjectManager.ResolveFile(path, filename &amp; &quot;.idw&quot;)      <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return drawingFilename       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return &quot;&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return drawingFilename       <br />&#160;&#160;&#160; End If       <br />End Function</p> </div>  <br />-Brian   
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Leon
EMAIL: leviatandemon@gmail.com
IP: 200.118.193.226
URL: 
DATE: 06/25/2016 12:13:43 PM
Hello, thank you for this blog, but i canÂ´t figure out how to block a ui button, like  Â¨ipropertiesÂ¨ , can you guide me?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Forge Accelerator
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-forge-accelerator
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/autodesk-forge-accelerator.html 
DATE: 01/13/2016 01:12:05 AM
-----
BODY:
<div class="entry-content">
<div class="entry-body">
<p style="text-align: justify;"><br /><a class="asset-img-link" href="http://forge.autodesk.com" rel="noopener noreferrer" style="display: inline;" target="_blank"><img alt="Forge" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d1873ac7970c image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1873ac7970c-800wi" title="Forge" /></a></p>
<p><span style="font-size: large;">At Autodesk University this past December, Autodesk announced the </span><a href="http://forge.autodesk.com/"><span style="font-size: large;">Forge</span></a><span style="font-size: large;"> platform.&#0160; Forge is a set of cloud services, APIs, and SDKs, that allows developers to quickly create the data, apps, experiences, and services that power the future of making things.</span></p>
<p><span style="font-size: large;">If this sounds interesting to you, the date for our next Autodesk Forge Accelerator has been set (formerly known as the </span><a href="http://autodeskcloudaccelerator.com/" rel="noopener noreferrer" target="_blank"><span style="font-size: large;">Autodesk Cloud Accelerator</span></a><span style="font-size: large;">). The Forge Accelerator will be held in our San Francisco office from March 14th to 18th inclusive. If your application to attend is accepted, you will be invited to spend the week in our office working on your projects that make use of Autodesk Forge APIs - with the help of the </span><a href="http://www.autodesk.com/developers"><span style="font-size: large;">ADN</span></a><span style="font-size: large;"> DevTech team and members of the Autodesk engineering teams. The Autodesk Forge APIs include the View &amp; Data, AutoCAD I/O, BIM 360, ReCap Photo and Fusion 360 APIs.</span></p>
<p><span style="font-size: large;">To apply for this program, you will need to submit a proposal of not more than 2000 words describing the project you&#39;d like to work on and how it will make use of the Autodesk Forge APIs. More information on how to apply is available here - </span><a href="http://autodeskcloudaccelerator.com/apply/" rel="noopener noreferrer" target="_blank"><span style="font-size: large;">http://autodeskcloudaccelerator.com/apply/</span></a><span style="font-size: large;">. (Note that this page hasn&#39;t yet been updated to include this latest event - that&#39;s how &#39;hot off the press&#39; this announcement is :-)).</span></p>
<p><span style="font-size: large;">If your application is successful, we will provide you with accommodation at an Autodesk designated hotel. All other travel and living costs are at your own expense.</span></p>
<p><span style="font-size: large;">The deadline for submitting proposals is January 31st 2016. It would be great to work with you on your application.</span></p>
</div>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Inventor Answer Day! :)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-answer-day
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/inventor-answer-day.html 
DATE: 01/12/2016 02:59:00 PM
-----
BODY:
<p><strong>Inventor Answer Day</strong> is coming and you&#39;re welcome to join :)</p>
<p>You&#39;ll find here all the info about it:&#0160;<br /><a href="http://forums.autodesk.com/t5/inventor-answer-day/inventor-answer-day-january-27th-2016/td-p/5956903">http://forums.autodesk.com/t5/inventor-answer-day/inventor-answer-day-january-27th-2016/td-p/5956903</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d18fe549970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Inventor_promographic-square" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d18fe549970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d18fe549970c-320wi" title="Inventor_promographic-square" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Run Fusion commands
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: run-fusion-commands
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2016/01/run-fusion-commands.html 
DATE: 01/11/2016 11:15:23 AM
-----
BODY:
<p>The <a href="http://fusion360.autodesk.com/resources/programminginterface">online help</a>&#0160;already has a sample on <a href="http://help.autodesk.com/cloudhelp/ENU/Fusion-360-API/files/WriteUserInterfaceToFile_Sample.htm">listing all the controls in the user interface</a>&#0160;which also provides the <strong>id</strong> of &#0160;the <strong>CommandDefinition</strong> that the various controls reference. &#0160;You can also get to the sample from many help topics, including &quot;UserInterface.toolbars&quot;</p>
<p class="p1"><span class="s1">This sample is very useful when positioning your controls within existing <strong>Fusion</strong> toolbars and panels and positioning your command adjacent to an existing command</span></p>
<p>However, if you are only interested in the command <strong>names</strong> and their <strong>id</strong>&#39;s then you can get them much simpler.</p>
<p>When you create your command then you create a <strong>CommandDefinition</strong> object and add it to the <strong>UserInterface</strong>.<strong>commandDefinitions</strong> collection.<br />This collection contains the internal command definitions as well. So you can just iterate through it to get the info you want. In <strong>Python</strong> it could be:</p>
<pre>app = adsk.core.Application.get()
ui = app.userInterface

fileDialog = ui.createFileDialog()
fileDialog.isMultiSelectEnabled = False
fileDialog.title = &quot;Specify result filename&quot;
fileDialog.filter = &#39;Text files (*.txt)&#39;
fileDialog.filterIndex = 0
dialogResult = fileDialog.showSave()
if dialogResult == adsk.core.DialogResults.DialogOK:
    filename = fileDialog.filename
else:
    return
    
commandDefinitions = ui.commandDefinitions
result = &quot;&quot;

for commandDefinition in commandDefinitions:
    result += &quot;id = &quot; + commandDefinition.id + &quot;; name = &quot; + commandDefinition.name + &quot;\n&quot;
    
output = open(filename, &#39;w&#39;)
output.writelines(result)
output.close()</pre>
<p>You can search the content of the created file to find the <strong>id</strong> of the <strong>CommandDefinition</strong> you need. Once you have it you can <strong>Execute</strong> it - e.g. in <strong>Python </strong>running the<strong> Export </strong>command:</p>
<pre>cmdDef = ui.commandDefinitions.itemById(&quot;ExportCommand&quot;)
cmdDef.execute()</pre>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d18f94cf970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Exportcommand" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d18f94cf970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d18f94cf970c-500wi" title="Exportcommand" /></a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Happy Holidays
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: happy-holidays
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/12/happy-holidays.html 
DATE: 12/23/2015 11:16:02 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d188126b970c-pi"><img alt="HappyHolidays" height="224" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08a2c9bb970d-pi" style="float: none; margin-left: auto; display: block; margin-right: auto;" title="HappyHolidays" width="664" /></a></p>
<p>I wish the best for you and your family for the upcoming new year.</p>
<p>For a little fun I wrote a Fusion script in Python that has two options.&#0160; For the first option it creates an extrusion of the words â€œHappy Holidaysâ€ and then creates a box that completely covers the â€œHappy Holidaysâ€ bodies where the bottom of the box is defined by a spline. The box entirely consumes the â€œHappy Holidaysâ€ so nothing is visible in the model at this point.&#0160; The second option modifies the spline points and randomly moves them upwards so the â€œHappy Holidaysâ€ slowly appears.&#0160; After each modification of the spline the program saves the current view as a png file and then I manually used GIMP to create the animated gif you see above.&#0160; Hereâ€™s the <a href="http://modthemachine.typepad.com/HappyHolidays.zip">Python script</a> in case youâ€™re interested in how it works.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Placing a Part in Inventor with User Interaction
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: placing-a-part-in-inventor-with-user-interaction
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/12/placing-a-part-in-inventor-with-user-interaction.html 
DATE: 12/22/2015 06:34:55 PM
-----
BODY:
<p>The various add methods of the ComponentOccurrences objects let you place new parts or assemblies into an assembly, but in all cases you have to specify the position as part of the placement. There are times when you donâ€™t know where it should be positioned and want to give the user the ability to position it. This can be done using a little known capability of the API.</p>  <p>The <strong>Place Component</strong> command has a special API behavior.&#160; When the command is invoked, it typically displays the dialog to allow you to choose which part or assembly to place and then puts you in a mode where that part or assembly is attached to the cursor and each click creates a new occurrence.&#160; The special behavior of the command is that it can bypass the dialog and go directly to the placement. Itâ€™s possible through the API to post the filename to a queue and when the command is executed it checks to see if there is a filename in the queue and if there is it uses it and skips the dialog.</p>  <p>The VBA sample below demonstrates this. It uses the PostPrivateEvent of the CommandManager object to post the filename to the private event queue. It then executes the <strong>Place Component</strong> command.&#160; Calling Execute on a control definition is exactly the same as executing the command in the user interface. In fact if you comment out the last line in the program below and run it and then run the <strong>Place Component</strong> command in the user interface it will still skip the dialog step of the command. Once the filename is read from the queue, the queue is cleared so the next time the <strong>Place Component</strong> command is run it will run in the normal way and display the file dialog.</p>  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub PlacePartInteractive()&#160; <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Define the filename to place.         <br /></font></strong>&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = &quot;C:\Temp\PartTest_2016.ipt&quot;&#160; <br />      <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Post the filename to the private event queue.         <br /></font></strong>&#160;&#160;&#160; Dim cmdMgr As CommandManager       <br />&#160;&#160;&#160; Set cmdMgr = ThisApplication.CommandManager       <br />&#160;&#160;&#160; Call cmdMgr.PostPrivateEvent(kFileNameEvent, filename)      <br />      <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Execute the &quot;Place Component&quot; command.</font></strong>      <br />&#160;&#160;&#160; cmdMgr.ControlDefinitions.Item(&quot;AssemblyPlaceComponentCmd&quot;).Execute       <br />End Sub</p> </div>  <br />  <p>There is a downside to using this technique. With the typical Add methods, the occurrence is created and then passed back to your program where you now have control and can continue whatever processing you need to do. By executing a standard command you've essentially turned control of Inventor back to the user. If you're finished with whatever you need to do then this works great because you're done and don't need to get back control. Otherwise it gets more complicated because you'll also need to watch events to catch when new occurrences are placed and do whatever processing might be needed. I'll save that discussion for another time.    <br />    <br />-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion add-in path
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-add-in-path
CATEGORY: Adam
CATEGORY: C++
CATEGORY: Fusion 360
CATEGORY: JavaScript
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/11/fusion-add-in-path.html 
DATE: 11/02/2015 05:51:46 PM
-----
BODY:
<p>Some functions might require the full path to a given file. If you know it&#39;s relative path to the add-in then the following could help. The below samples show how to get the add-in folder in different programming languages - these samples are based on the <strong>API</strong>&#0160;online help sample: <a href="http://fusion360.autodesk.com/learning/learning.html?caaskey=caas/CloudHelp/cloudhelp/ENU/Fusion-360-API/files/ExportManager-Sample-htm.html" target="_self" title="">http://fusion360.autodesk.com/learning/learning.html?caaskey=caas/CloudHelp/cloudhelp/ENU/Fusion-360-API/files/ExportManager-Sample-htm.html</a></p>
<p><strong>Python</strong></p>
<pre>def getAddInFolder():
    import os
    folderPath = os.path.dirname(os.path.realpath(__file__))
    
    return folderPath</pre>
<p><strong>JavaScript</strong></p>
<pre>function getAddInFolder() {<br />
    var url = window.location.pathname;
    var des = decodeURI(url);

    // remove the / at beginning
    if (navigator.platform.match(&#39;Win&#39;)) {
        des = des.substr(1);
    }<br />
    var index = des.lastIndexOf(&#39;/&#39;);
    var dir = des.substring(0, index);<br />
    return dir;
}</pre>
<p><strong>C++</strong></p>
<pre>std::string getAddInFolder()
{
#if defined(_WINDOWS) || defined(_WIN32) || defined(_WIN64)
    HMODULE hModule = NULL;
    if (!GetModuleHandleExA(
        GET_MODULE_HANDLE_EX_FLAG_FROM_ADDRESS | 
        GET_MODULE_HANDLE_EX_FLAG_UNCHANGED_REFCOUNT,
        (LPCSTR) â‰¥tDllPath, 
        &amp;hModule))
        return &quot;&quot;;

    char winTempPath[2048];
    ::GetModuleFileNameA (hModule, winTempPath, 2048);

    std::string strPath = winTempPath;
    size_t stPos = strPath.rfind(&#39;\\&#39;);
    return strPath.substr(0, stPos);
#else
    Dl_info info;
    dladdr((void*) getDllPath, âˆˆfo);

    std::string strPath = info.dli_fname;
    int stPos = (int)strPath.rfind(&#39;/&#39;);
    if(stPos != -1)
        return strPath.substr(0, stPos);
    else
        return &quot;&quot;;
#endif
}</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Call web services from a Fusion add-in 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: call-web-services-from-fusion-add-in
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Python

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/10/call-web-services-from-fusion-add-in.html 
DATE: 10/28/2015 12:06:36 PM
-----
BODY:
<p>There are more and more web services available out there on the net and integration with those can bring real value to your product. Sometimes the <strong>web service</strong>&#0160;in itself is the real value provided by the add-in in which case you do not really need to protect the <a href="https://en.wikipedia.org/wiki/Intellectual_property" target="_self"><strong>IP</strong></a> of your add-in and might as well use open&#0160;<strong>JavaScript</strong> or <strong>Python</strong> instead of a compiled <strong>C++</strong> project.</p>
<p>The following sample script is written in <strong>Python</strong> and it simply lists all the repositories inside our <strong>Fusion 360 GitHub</strong> account:&#0160;<a href="https://github.com/AutodeskFusion360" target="_self" title="">https://github.com/AutodeskFusion360</a></p>
<p>When the user selects a repository from the drop-down combo box then the description field will get updated inside the command dialog. If the user clicks <strong>OK</strong> then the browser will jump to the <strong>URL</strong> of the selected repository.</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0887ec5b970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="HttpSample" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb0887ec5b970d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0887ec5b970d-800wi" title="HttpSample" /></a></p>
<p>&#0160;</p>
<p>It&#39;s fairly easy to implement such a thing in <strong>Python</strong>. I could use the <strong>http.client</strong> library for the <strong>HTTP</strong> communication, <strong>json</strong> library to turn the <strong>JSON</strong> response strings into arrays and dictionaries which make it much easier to get the data out of them, and the&#0160;<strong>webbrowser</strong> library to start the default web browser on the system and show a given <strong>URL</strong>.</p>
<p>You can find the source code here:&#0160;<a href="https://github.com/AutodeskFusion360/HttpSample" target="_self" title="">https://github.com/AutodeskFusion360/HttpSample</a></p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Use Entitlement API from Fusion add-in
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: use-entitlement-api-from-fusion
CATEGORY: Adam
CATEGORY: Beginning API
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/10/use-entitlement-api-from-fusion.html 
DATE: 10/27/2015 05:38:25 PM
-----
BODY:
<p>If you have an app on the <a href="https://apps.autodesk.com/en" target="_self">Autodesk App Store</a> then you might want to check if the user actually paid for and downloaded your app from the store or just copied it from someone else&#39;s computer. This what the <a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=24243865" target="_self">Entitlement API</a> can help you with.&#0160;</p>
<p>In the September release the <strong>Fusion API</strong> exposed two new user specific properties under the <strong>Application</strong> object: <strong>userName</strong> and <strong>userId</strong>. The latter is needed to take advantage of the <strong>Entitlement API.</strong></p>
<p>Probably it makes most sense to use this <strong>API</strong> from a <strong>C++</strong> add-in since that is much better protected because of compilation. So that&#39;s what this article will focus on.</p>
<p>The <strong>Entitlement API</strong> is a simple <strong>RESTful API</strong> where you just need to send an <strong>HTTP</strong>&#0160;<strong>GET</strong> request to the <strong>App Store</strong> server to find out what you need. It&#39;s up to you what library you use for that as there are many options. I was looking into using a cross-platform library since <strong>Fusion</strong> is supporting both <strong>Mac</strong> and <strong>Windows</strong>, however the ones I tried were not straight-forward to use at all. In the end I decided to go with the <a href="http://curl.haxx.se/libcurl/c/libcurl.html" target="_self">cURL</a> library which is really simple to use from a <strong>MacOS</strong> add-in.</p>
<p>The steps I needed to take:</p>
<p><strong>1)</strong> Create a new <strong>C++ Fusion</strong> add-in:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d16d78e0970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateAddIn" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d16d78e0970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d16d78e0970c-320wi" title="CreateAddIn" /></a></p>
<p><a class="asset-img-link" href="http://a6.typepad.com/6a0112791b8fe628a401b8d16d78f6970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateAndEdit" border="0" class="asset  asset-image at-xid-6a0112791b8fe628a401b8d16d78f6970c image-full img-responsive" src="https://a6.typepad.com/6a0112791b8fe628a401b8d16d78f6970c-800wi" title="CreateAndEdit" /></a></p>
<p><strong>2)</strong> Add <strong>cURL</strong> support to your add-in:</p>
<p>Once you&#39;re in <strong>Xcode</strong>, go into the <strong>Project</strong> settings and under &quot;<strong>Build Settings</strong> &gt;&gt; <strong>Linking</strong> &gt;&gt; <strong>Other Linker Flags</strong>&quot; add &quot;<strong>-lcurl</strong>&quot;</p>
<p><a class="asset-img-link" href="http://a6.typepad.com/6a0112791b8fe628a401b7c7e3ae2e970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CURL" border="0" class="asset  asset-image at-xid-6a0112791b8fe628a401b7c7e3ae2e970b image-full img-responsive" src="https://a6.typepad.com/6a0112791b8fe628a401b7c7e3ae2e970b-800wi" title="CURL" /></a></p>
<p><strong>3)</strong> Add the following statements at the top of the <strong>C++</strong> file:</p>
<pre>#include &lt;curl/curl.h&gt;
#include &lt;regex&gt;

using namespace std;</pre>
<p><strong>4)</strong> Also add this code which is using the <a href="https://en.wikipedia.org/wiki/Regular_expression" target="_self">Regular Expressions</a> library:<br />(there are quite a few <strong>RegEx</strong> testers on the web that you can use - I played with this:&#0160;<a href="https://www.myregextester.com/index.php" target="_self" title="">https://www.myregextester.com/index.php</a>)</p>
<pre>// Fetch the value of a given property
// inside a json text
string GetValue(string text, string find)
{
  regex IsValid(&quot;\\s*\&quot;&quot; + find + &quot;\&quot;\\s*:\\s*(.+?)[\\s,]&quot;);
  smatch m;
  
  if (regex_search(text, m, IsValid))
  {
    if (m.size() &gt; 1)
      return m[1];
  }
  
  return &quot;&quot;;
}

size_t callback_func(void *ptr, size_t size, size_t count, void *stream)
{
  // ptr - your string variable.
  // stream - data chunck you received
  
  string reply((char*)ptr);
  string ret = GetValue(reply, &quot;IsValid&quot;);
  
  // If the app is not valid
  if (ret != &quot;true&quot;)
    ui-&gt;messageBox(&quot;IsValid = false&quot;);
  else
    ui-&gt;messageBox(&quot;IsValid = true&quot;);
    
  return 0;
}

// Using Entitlement API to check if the
// app usage is valid
void CheckValidity()
{
  // e.g. the URL for Voronoi Sketch generator is:
  // https://apps.autodesk.com/FUSION/en/Detail/Index?id=appstore.exchange.autodesk.com%3avoronoisketchgenerator_macos%3aen
  // This cotains the &quot;id&quot;:
  // &quot;appstore.exchange.autodesk.com%3avoronoisketchgenerator_macos%3aen&quot;
  // so we can use that
  string userId = app-&gt;userId();
  string userName = app-&gt;userName();
  string appId =
    &quot;appstore.exchange.autodesk.com%3aaddinrename_windows32and64%3aen&quot;;
  string url =
    string(&quot;https://apps.exchange.autodesk.com/webservices/checkentitlement&quot;) +
    string(&quot;?userid=&quot;) + userId +
    string(&quot;&amp;appid=&quot;) + appId;
  
  CURL * curl = curl_easy_init();
  if(curl) {
    CURLcode res;
    curl_easy_setopt(curl, CURLOPT_URL, url.c_str());
    curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, callback_func);
    res = curl_easy_perform(curl);
    curl_easy_cleanup(curl);
  }
}</pre>
<p><strong>5)</strong> Now you can call <strong>CheckValidity()</strong> from inside your <strong>run()</strong> function</p>
<p>You can easily figure out the <strong>id</strong> of your app by finding it on the <strong>App Store</strong> and then checking the <strong>URL</strong> in the browser. That will contain an <strong>id</strong> parameter which is what you need. E.g. the&#0160;<strong>MacOS</strong> <strong>English</strong> version of the <strong>Voronoi Sketch Generator</strong> has this <strong>URL</strong> and I highlighted the important part with the <strong>id</strong>:<br /><a href="https://apps.autodesk.com/FUSION/en/Detail/Index?id=appstore.exchange.autodesk.com%3avoronoisketchgenerator_macos%3aen%20" target="_self">https://apps.autodesk.com/FUSION/en/Detail/Index?id=<strong>appstore.exchange.autodesk.com%3avoronoisketchgenerator_macos%3aen</strong>&#0160;</a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7e3bdaa970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Voronoionappstore" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c7e3bdaa970b image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7e3bdaa970b-800wi" title="Voronoionappstore" /></a></p>
<p>Worth noting that the <strong>Entitlement API</strong> only provides information on if the user paid for your app or not, it does not tell you in case of a <strong>Free</strong> app if it has been downloaded by the given user from the store or not.&#0160;</p>
<p>So when I use this functionality with a free app then <strong>IsValid</strong> will always return <strong>false</strong>:</p>
<p><a class="asset-img-link" href="http://a2.typepad.com/6a0112791b8fe628a401b7c7e3afea970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Isvalidfalse" class="asset  asset-image at-xid-6a0112791b8fe628a401b7c7e3afea970b img-responsive" src="https://a2.typepad.com/6a0112791b8fe628a401b7c7e3afea970b-120wi" title="Isvalidfalse" /></a></p>
<p>But if I test it with a priced app which I paid for then I get <strong>true</strong>:</p>
<p><a class="asset-img-link" href="http://a5.typepad.com/6a0112791b8fe628a401bb088781fd970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Isvalidtrue" class="asset  asset-image at-xid-6a0112791b8fe628a401bb088781fd970d img-responsive" src="https://a5.typepad.com/6a0112791b8fe628a401bb088781fd970d-120wi" title="Isvalidtrue" /></a></p>
<p>Since the <strong>Entitlement</strong> <strong>API</strong> is based on simple <strong>HTTP</strong> requests, therefore you can easily test it in utilities like the <a href="https://addons.mozilla.org/en-GB/firefox/addon/restclient/" target="_self"><strong>RESTClient</strong></a> for <strong>Firefox</strong>.</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08879026970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Restclient" border="0" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08879026970d image-full img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08879026970d-800wi" title="Restclient" /></a></p>
<p>You can find the full source code here:&#0160;<a href="https://github.com/AutodeskFusion360/EntitlementAPI" target="_self" title="">https://github.com/AutodeskFusion360/EntitlementAPI</a><br />At the moment the sample only contains code for <strong>MacOS</strong>, but will likely add a <strong>Windows</strong> version as well later.</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: AU 2015 classes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-2015-classes
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/10/au-2015-classes.html 
DATE: 10/13/2015 11:49:16 PM
-----
BODY:
<p><img alt="Auvegas" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08813ef7970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08813ef7970d-320wi" title="Auvegas" /></p>
<p>If you are coming to <a href="http://au.autodesk.com" target="_self">AU</a> and interested in <strong>Inventor</strong> or <strong>Fusion 360</strong> programming then you might want to consider the following classes.</p>
<p><a href="http://modthemachine.typepad.com/my_weblog/about-the-author.html" target="_self">Brian</a> is doing an <strong>Inventor API lab</strong>:<br /><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=10601&amp;tclass=popup" target="_self"><strong>IM10601-L - You Can Do Itâ€”How to Write Programs for Inventor</strong></a><br />Also will talk about <strong>Fusion 360 programming</strong>:<br /><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=10574&amp;tclass=popup" target="_self"><strong>CP10574 - Customizing Fusion 360 Using Its Programming Interface</strong></a><br />Plus head a follow up <strong>round table</strong> session after lunch in case you have anything to discuss:<br /><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=10599&amp;tclass=popup" target="_self"><strong>CP10599-R - Customizing Fusion 360 Using Its Programming Interface Roundtable</strong></a></p>
<p>I will also have a class on&#0160;<strong>Fusion 360 programming</strong> but from the point of view of the <a href="https://apps.autodesk.com/FUSION/en/Home/Index" target="_self">App Store apps</a> we created for <strong>Fusion</strong>:&#0160;<br /><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=11981&amp;tclass=popup" target="_self"><strong>SD11981 - Cool Sample Apps for Fusion 360</strong></a></p>
<p>If you&#39;re more interested in <strong>iOS programming</strong> - not much to do with <strong>Inventor</strong> and <strong>Fusion 360</strong> :) - then I have a class for that too:<br /><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=10162&amp;tclass=popup" target="_self"><strong>SD10162 - Introduction to Appleâ€™s iOS Mobile Development</strong></a></p>
<p>See you there! :)</p>
<p>-Adam&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 Hackathon - Q&A #7 #8 #9 #10
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-hackathon-qa-7-8-9-10
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/10/fusion-360-hackathon-qa-7-8-9-10.html 
DATE: 10/09/2015 01:45:22 AM
-----
BODY:
<p>Here are the questions we got this week so far:&#0160;&#0160;</p>
<p><strong>Q: Is there a method to get the sketch to model transform (like in Inventor)?&#0160;</strong></p>
<p>A: Yes, the <strong>Sketch</strong> object has a <strong>transform</strong> property that provides the transformation matrix for exactly that.&#0160;</p>
<p><strong>Q: xyConstructionPlane. Where does it belong on the chart?&#0160;</strong></p>
<p>A: The chart isnâ€™t able to show every connection to every object. The <strong>xyConstructionPlane</strong> is a property supported by the <strong>Component</strong> object that returns a <strong>ConstructionPlane</strong> object.&#0160;</p>
<p><strong>Q: How do you create a collection in case I need a specific group of objects to use as input to another command? For example in the UI to create a split button in the navigation toolbar the second argument is a â€œCollectionâ€ of command definitions. It does not seem to accept [cmdDef1, cmdDef2, cmdDef3] as the argument. Do you have to explicitly create a â€œcollectionâ€ of command definitions?&#0160;</strong>&#0160;&#0160;</p>
<p>A: You can create a collection using <strong>adsk.core.ObjectCollection.create</strong>() function. Then you can add items to this collection using its <strong>add</strong>() method.&#0160;&#0160;</p>
<p><strong>Q: How to activate intelli-sense / auto-complete in Spyder on Mac?&#0160;</strong></p>
<p>A: It should be working by default, but it seems there is an issue with this in case of the MAS (Mac App Store) version of Fusion. Web install version for both Windows and Mac seem to work fine.&#0160;&#0160;The issue is logged and will be investigated.&#0160;</p>
<p><strong>Q: Since ImageCommandInputs display PNGâ€™s at their native size â€“ what happens on a hiDPI screen? Is the image automatically doubled in size?&#0160;</strong></p>
<p>A: This works similar to how you provide the images for your buttons. High definition images should be named in a way that they end with <strong>â€œ@2x</strong>â€, e.g. <strong>MyImage@2x.png</strong><a href="mailto:MyImage@2x.png"><br /></a></p>
<p>If you pass in <strong>MyImage.png</strong> as the parameter for the <strong>addImageCommandInput</strong>() function on a high definition display (e.g. <strong>MacBook</strong> with <strong>Retina</strong> display) <strong>Fusion</strong> will look for a file name ending with â€œ@2xâ€ (i.e. <strong>MyImage@2x.png</strong>) and if it exists it will use that. If it does not, then the low quality image will be scaled up.&#0160;</p>
<p>As an example, if I have these files in my <strong>resources</strong> folder:&#0160;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb087ee54f970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Imageinput1" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb087ee54f970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb087ee54f970d-320wi" title="Imageinput1" /></a></p>
<p>â€¦ and I have this code&#0160;</p>
<pre>inputs.addImageCommandInput(&#39;imageInput&#39;, &#39;&#39;, &#39;./resources/<strong>32x32.png</strong>&#39;)&#0160;</pre>
<p>... and Iâ€™m running <strong>Fusion</strong> on a computer with high definition display, then &#39;<strong>./resources/32x32@2x.png</strong>&#39; will be used:&#0160;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d164d5c2970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Imageinput2" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d164d5c2970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d164d5c2970c-320wi" title="Imageinput2" /></a></p>
<p>If the high definition image cannot be found then the low quality image will be stretched to the same size:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d164d5d2970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Imageinput3" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d164d5d2970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d164d5d2970c-320wi" title="Imageinput3" /></a></p>
<p><strong>Q: Can we use HTML styled text in message boxes?</strong>&#0160;</p>
<p>A: No. Message boxes do not support HTML for the contents. For more advanced formatting you will need to use a command dialog where the <strong>TextBoxCommandInput</strong> does support basic HTML formatting. Look for the <strong>TextBoxCommandInput</strong> section in the&#0160;<a href="http://help.autodesk.com/view/NINVFUS/ENU/?guid=GUID-3922697A-7BF1-4799-9A5B-C8539DF57051" target="_self">help topic for commands</a>&#0160;</p>
<p><strong>Q: Is there a way to retrieve the Fusion userâ€™s email address registered with Autodesk?</strong></p>
<p>A: Not programmatically. But if you published your app on the Autodesk App Store, and&#0160;a user buys your app then you&#39;ll get an email with the user&#39;s email address in it. You can&#0160;also access this information later on from the &quot;Publisher Corner&quot; where you can get the download records emailed to you.</p>
<p><strong>Q: How to create a cone?</strong></p>
<p>A: There is no primitive for cones inside Fusion. You can create cone geometry in multiple ways.&#0160;One of which could be extruding a circle with a taper angle. No matter how the geometry&#0160;got created, when investigating it using the BREP API you should find the same things if&#0160;the created geometry is the same.&#0160;&#0160;</p>
<p><strong>Q: How to create the plugging-holes-with-corks sample shown during the webcast?</strong></p>
<p>A: Iâ€™m still working on this sample and will post the completed code when itâ€™s finished.</p>
<p><strong>Q: How to get the modified JavaScript code to run in Fusion after editing it in Brackets?</strong></p>
<p>A: There is an issue on the Mac with the Apple web component we are using, because it&#0160;caches the original JavaScript file and keeps using that instead of the modified version. Apple said&#0160;they will work on fixing this issue. &#0160;</p>
<p><strong>Q: Does Fusion support compiled Python files (*.pyc)?</strong></p>
<p>A: Yes, it does.</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 Hackathon - Q&A #3 #4 #5 #6
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-hackathon-qa-3-4-5-6
CATEGORY: Adam
CATEGORY: Announcements
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/10/fusion-360-hackathon-qa-3-4-5-6.html 
DATE: 10/02/2015 08:00:23 PM
-----
BODY:
<p>The rest of this week the Q&amp;A sessions were not very busy - as you can tell from the number of questions below.&#0160;I hope it&#39;s because everyone is working heads-down on their product to finish them by the end of the hackathon. :)</p>
<p>Here are the questions and Brian&#39;s answers to them:</p>
<div>
<p><strong>Q: Is there an ExportManager? - i.e. the same thing as ImportManager, but for&#0160;exporting</strong></p>
<p>A: Yes, the API supports the same capabilities as the UI for exporting the design, or&#0160;portions of the design in different formats.</p>
<p><strong>Q: Is it possible to Export documents without having to individually open each one?</strong></p>
<p>A: A document has to be open in order to export it.</p>
<p><strong>Q: When is the next update (release)?</strong></p>
<p>A: The new major update is currently planned for November.</p>
<p><strong>Q: Where can we find the list of static functions in F360 webpage?</strong></p>
<p>A: There isnâ€™t a complete list of all static functions, but the â€œSyntaxâ€ portion of each&#0160;function in the API help indicates if it is a static function or not.</p>
<p><strong>Q: Any status bar to put a message in?</strong></p>
<p>A: Fusion doesnâ€™t support a status bar, but there are plans to expose a progress dialog.</p>
<p><strong>Q: What are these transient Line2D and Line3D and Arc2D things used for?</strong></p>
<p>A: Transient geometry is used in several ways with the primary use being able to query&#0160;the shape of an existing model. &#0160;An edge of a solid can be any shape and the geometry&#0160;property of the BRepEdge object will return one of the transient geometry objects that&#0160;describes the shape of the face. &#0160;For example, it can return a Plane, Cylinder, etc.</p>
<p>The 2D transient geometry is also used in querying existing geometry but is used to&#0160;return information back in the parameter space of a surface. &#0160;This isnâ€™t commonly used&#0160;by most applications. &#0160;Because sketches in Fusion are always 3D, 2D geometry is not&#0160;used for sketches.</p>
<p><strong>Q: How do I put up a wait cursor?</strong></p>
<p>A: Itâ€™s not currently possible to display a wait cursor.</p>
<p>-Adam</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Extrude profile with hole
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extrude-profile-with-hole
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/extrude-profile-with-hole.html 
DATE: 09/30/2015 11:37:08 AM
-----
BODY:
<p>During the <a href="http://fusion360hackathon.com/" target="_self">hackathon</a> we got the following question that Brian answered. I added a picture to make it even easier to understand :)</p>
<p><strong>Q:</strong>&#0160;Iâ€™m having a problem extruding a sketch with multiple profiles. I can never seem to create holes.&#0160; What am I missing?</p>
<p><strong>A:&#0160;</strong>In your case, there are two profiles. <br />The first consists of the rectangle with the hole (<strong>1</strong>) and the second is just the hole (<strong>2</strong>).&#0160; Itâ€™s the same thing you would see in the <strong>UI</strong> if you draw the sketch and then manually create an extrusion. When you move the mouse within the rectangle, but outside of the circle it will highlight one of the profiles.&#0160; Moving the mouse into the circle will highlight the other profile.&#0160; By adding both of them to the collection you were essentially filling the hole. The <strong>C++</strong> code below uses some simple logic based on knowledge about the sketch geometry to pick the outer profile (with two <strong>ProfileLoop</strong>&#39;s: <strong>a</strong> and <strong>b</strong>). This logic will also work if there are multiple holes.</p>
<p><a class="asset-img-link" href="http://a0.typepad.com/6a0112791b8fe628a401b7c7d617e8970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Hole_profile" class="asset  asset-image at-xid-6a0112791b8fe628a401b7c7d617e8970b img-responsive" src="https://a0.typepad.com/6a0112791b8fe628a401b7c7d617e8970b-500wi" title="Hole_profile" /></a></p>
<p>Note: the order of the profiles could be different from the one shown in the picture.</p>
<pre>// Put all the profiles in an object collection
// Get the Profiles collection
Ptr&lt;Profiles&gt; pProfiles = sketch-&gt;profiles();
Ptr&lt;ObjectCollection&gt; objectsForExtrude = ObjectCollection::create();
for each (Ptr&lt;Profile&gt; pProfile in pProfiles)
{
  // Check to see if this is the outer rectangular profile or not
  // by checking the number of loops.  The outer profile will have two
  // loops, one for the rectangle and one for the circle. 
  Ptr&lt;ProfileLoops&gt; loops = pProfile-&gt;profileLoops();
             
  if (loops-&gt;count() &gt; 1)
    objectsForExtrude-&gt;add(pProfile);
}</pre>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion 360 Hackathon - Q&A #1 #2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-hackathon-qa-1-2
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/fusion-360-hackathon-qa-1-2.html 
DATE: 09/29/2015 10:15:29 AM
-----
BODY:
<p>So far we had two online presentations and two 1 hour Q&amp;A sessions where developers could come and ask about anything related to Fusion 360 API.</p>
<p>Here is a concise version of the discussions from the first 2 Q&amp;A sessions Brian and I had.&#0160;</p>
<p><em>Keep in mind that Fusion has a new release every months or so, and therefore if you&#39;re reading this article at a later time, some of the missing functionalities might be available.&#0160;</em></p>
<p><strong>Q: In case I develop in C++ on Windows, can you publish the application for the Mac platform too?</strong>&#0160;</p>
<p>A: We cannot for two reasons: &#0160;<br /> 1) we would need your source code to compile it on our side and that could cause legal issues&#0160;<br /> 2) we would probably break Apple/Xcode EULA by compiling projects for someone else using our developer account&#0160;&#0160;&#0160;&#0160;</p>
<p><strong>Q: Can I do the same geometry queries on sketch features as on BREP elements, e.g. asking for area and inner points?</strong>&#0160;</p>
<p>A: The sketch related object that could have area properties is the Profile object since it defines a closed planar area.&#0160; Currently this object only supports topology information and doesnâ€™t expose any area functionality.&#0160;</p>
<p><strong>Q: Can I check whether a point is an inner point of a geometry (so somewhat the inverse of getting an inner point)?</strong>&#0160;</p>
<p>A: For BRepFace it is possible to find out if a point lies on the face.&#0160; This is done using the isParameterOnFace method of the SurfaceEvalutator that you can get from a face.&#0160;&#0160;&#0160;</p>
<p><strong>Q: Is there any object equivalent to the RegionProperties object in the Inventor API?</strong>&#0160;</p>
<p>A: No there is not.&#0160;&#0160;</p>
<p><strong>Q: Is there some sort of UI guideline when creating apps?</strong>&#0160;</p>
<p>A: It is work-in-progress. Brian will also add a section to the help file on where to place your command buttons on the toolbar depending on the functionality they provide.&#0160;&#0160;&#0160;</p>
<p><strong>Q: Is there a simple way of sorting the browser tree?</strong>&#0160;</p>
<p>A: No, and there is no direct access to the browser tree at all.&#0160;</p>
<p><strong>Q: Which tool could be recommended to display calculated scalar and vector fields in the Fusion 360 API (like client graphics in the Inventor API)?</strong>&#0160;</p>
<p>A: There is nothing for that at the moment as there is no client graphics API in Fusion yet.&#0160;&#0160;&#0160;</p>
<p><strong>Q: Can I add buttons to places other than the toolbar - e.g. to the browser?&#0160;</strong>&#0160;</p>
<p>A: No.&#0160;</p>
<p><strong>Q: Is a custom command automatically linked to the &quot;edit feature&quot; in the history bar (timeline), so it relaunches with the last settings when a user wants to do changes (like e.g. with press/pull command)</strong>&#0160;</p>
<p>A: The timeline only shows features, which means that what you would need is a client feature, but that is not available at the moment.&#0160;&#0160;</p>
<p><strong>Q: Is there any way to display set of triangles, e.g. for a mesh?</strong>&#0160;</p>
<p>A: The only way is sketch lines at the moment, but depending on the amount of those, it could be costly.&#0160;</p>
<p><strong>Q: Can I do Boolean operations on the solid bodies?</strong>&#0160;</p>
<p>A: You would need to use the combine feature for that. You could not do it just in-memory using transient objects.&#0160;</p>
<p><strong>Q: Is it possible to access non fusion files (e.g. xml or json) from the data panel project or do they have to be stored locally (e.g. with the installation).&#0160;</strong>&#0160;</p>
<p>A: You can only open design files and only in the UI - i.e. you cannot open them in the background just to read some information from them. Locally stored files can be read in the background as well - see &quot;<strong>Parameter I/O</strong>&quot; from <a href="https://apps.autodesk.com/FUSION/en/Detail/Index?id=appstore.exchange.autodesk.com%3aparameterio_macos%3aen">https://apps.autodesk.com/FUSION/en/Detail/Index?id=appstore.exchange.autodesk.com%3aparameterio_macos%3aen</a>&#0160;&#0160;&#0160;</p>
<p><strong>Q: Can I include extra files with the installation package of the app?</strong>&#0160;</p>
<p>A: Yes you can. We have sample apps on the Autodesk Exchange store which do that too, e.g. &quot;<strong>Parameter I/O</strong>&quot; sample. &#0160;</p>
<p><strong>Q: Can you get the data from a different project than the one the user is currently using. (something like setting up a library with components and metadata that I than want to share with others)</strong>&#0160;</p>
<p>A: The API currently only provides access to your own projects but this should be available in the future so you have access to all of the same data as you see in the Data Panel.&#0160;&#0160;&#0160;</p>
<p><strong>Q: Could you explain the purpose of text commands bar in the workspace? Can we use it to add points, sketches?</strong>&#0160;&#0160;</p>
<p>A: These are for internal testing.&#0160; Currently itâ€™s not possible to access API created commands through the text commands.&#0160;</p>
<p><strong>Q: Are there any plans for more advanced support of external render engines? I mean event system, ability to draw in render workspace, more organized material API, etc</strong>&#0160;</p>
<p>A: We want to continue to expose through the API the functionality you see in the user-interface.&#0160; There are some areas related to rendering where the API is incomplete.&#0160; Beyond that, there has not been any discussion of additional API only functionality to expose.&#0160;</p>
<p><strong>Q: How to turn on &#39;do not capture design history&#39;?</strong>&#0160;</p>
<p>A: The Python code below sets the preference to create a Direct Modeling design, creates a new design, and then sets it back to the original value.&#0160;</p>
<pre>def createDirectModelDocument(): 
    ui = None 
    try: 
        app = adsk.core.Application.get() 
        ui  = app.userInterface 
 
        # Get the Fusion specific Design preferences.         
        desPrefs = app.preferences.productPreferences.itemByName(&#39;Design&#39;) 
 
        # Save the current value of the setting. 
        initialValue = desPrefs.defaultDesignType 
 
        # Set the value to create a direct edit design.         
        desPrefs.defaultDesignType = \ 
                 adsk.fusion.DefaultDesignTypeOptions.DirectDesignTypeOption 
 
        # Create a new document. 
        app.documents.add(adsk.core.DocumentTypes.FusionDesignDocumentType) 
 
        # Set the preference back to the initial value.         
        desPrefs.defaultDesignType = initialValue 
         
        ui.messageBox(&#39;Success&#39;) 
    except: 
        if ui: 
            ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))</pre>
<p><strong>Q: What happens if you turn on 3D sketches (FusionProductPreferences is3DSketchingAllowed)?</strong>&#0160;</p>
<p>A: The preference to allow 3D sketches is controlling the UI and doesnâ€™t have any impact on the API.&#0160; Sketches in Fusion are always 3D and if these setting this preference to not allow 3D forces the user to always draw in the X-Y plane of the active sketch.&#0160;</p>
<p><strong>Note:</strong> Brian will have a presentation <a href="http://fusion360hackathon.com/webinars" target="_self">today as well</a>. Today&#39;s topic is &quot;<strong>Introduction to the Fusion object model</strong>&quot;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Understanding Reference Keys in Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: understanding-reference-keys-in-inventor
CATEGORY: Attributes
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/understanding-reference-keys-in-inventor.html 
DATE: 09/25/2015 07:53:33 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0877f799970d-pi"><img title="RefKeys01" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="RefKeys01" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0877f79d970d-pi" width="234" align="right" height="156" /></a>Reference keys is a topic that not many people know about or understand and is an area Iâ€™ve seen people struggle with and misuse. Reference keys are not something youâ€™ll use often in your programs but can be very handy in certain cases.</p>  <p>&#160;</p>  <p><strong><font size="5">What is a Reference Key?        <br /></font></strong>A reference key is the ID of an object within Inventor. You use the GetReferenceKey method of an object to get its ID, or â€œkeyâ€. You save the ID and at a later time use it to get the same object back. A reference key doesnâ€™t have any time limits, which means you can get the reference key from an object, and the document can go through many changes and versions, and you can still use the reference key to find the same object, even though the object may have changed from when you originally got its reference key. Of course, this assumes the object still exists and hasnâ€™t been deleted or removed through some edit operation.</p>  <p>Below is some sample code that gets the reference key from a selected assembly occurrence. By changing the selection filter the code below will work with any object that supports reference keys except for B-Rep objects (SurfaceBody, FaceShell, Face, Edge, Vertex, EdgeLoop, and EdgeUse) which are discussed later.</p>  <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub GetRefKey()      <br /><b><i><font color="#0000ff">&#160;&#160;&#160; ' Get the active document.            <br />&#160;&#160;&#160; </font></i></b>Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />      <br />&#160;&#160;&#160; <b><i><font color="#0000ff">' Have an object selected.</font>           <br />&#160;&#160;&#160; </i></b>Dim selection As Object       <br />&#160;&#160;&#160; Set selection = ThisApplication.CommandManager.Pick( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAssemblyOccurrenceFilter, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select an occurrence.&quot;)       <br />      <br /><b><i><font color="#0000ff">&#160;&#160;&#160; ' Get a reference key from the selected entity. This will            <br /></font></i></b><b><i><font color="#0000ff">&#160;&#160;&#160; ' fail if the selected object doesn't support reference keys.            <br /></font>&#160;&#160;&#160; </i></b>Dim refKey() As Byte       <br />&#160;&#160;&#160; Call selection.GetReferenceKey(refKey)       <br />      <br /><font color="#0000ff">&#160;&#160;&#160; </font><b><i><font color="#0000ff">' Convert the reference key to a string to make saving it easier.            <br /></font>&#160;&#160;&#160; </i></b>Dim strKey As String       <br />&#160;&#160;&#160; strKey = doc.ReferenceKeyManager.KeyToString(refKey)       <br />      <br /><font color="#0000ff">&#160;&#160;&#160; </font><b><i><font color="#0000ff">' Print out the reference key string.            <br /></font>&#160;&#160;&#160; </i></b>Debug.Print &quot;RefKey: &quot;&quot;&quot; &amp; strKey &amp; &quot;&quot;&quot;&quot;       <br />End Sub</p> </div>  <p>   <br />There are a couple of interesting things to note in the above sample. First, a reference key is an array of bytes. A byte is a number between 0 and 255 so a reference key is just a list of small numbers. Second, Inventor creates the reference key and returns it but itâ€™s up to you to save it somewhere so you can use it later. If youâ€™ll be writing out the reference key to a file itâ€™s easier to deal with a String instead of an array of numbers. The KeyToString method does this for you by converting the array of bytes into a String. Later, when you need to use the key, you can use the StringToKey method to convert the String back into an array of bytes.&#160; The sample above just prints the result to the immediate window, which in my test resulted in: â€œAgEBAAQAAAABAAAAâ€.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d15da607970c-pi"><img title="RefKeys03" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="RefKeys03" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7d3d469970b-pi" width="176" align="right" height="55" /></a>General reference key functionality is exposed through the ReferenceKeyManager object which is obtained from a Document object. Every object that supports reference keys has the GetReferenceKey method.</p>  <p>Now that you have a reference key you can use it at any time, with the same document, to get back the same object. The sample below demonstrates this.</p>  <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub BindRefKey()      <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Get the active document.</font></strong>       <br />&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Convert the string back into an array of bytes.</font></strong>       <br />&#160;&#160;&#160; Dim refKey() As Byte       <br />&#160;&#160;&#160; Call doc.ReferenceKeyManager.StringToKey(&quot;AgEBAAQAAAABAAAA&quot;, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; refKey)</p>    <p>&#160;&#160;&#160; <font color="#0000ff"><strong>' Bind the key back to the object.</strong></font>       <br />&#160;&#160;&#160; Dim obj As Object       <br />&#160;&#160;&#160; Set obj = doc.ReferenceKeyManager.BindKeyToObject(refKey)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Select the object to be able to see the found object.</strong></font>       <br />&#160;&#160;&#160; doc.SelectSet.Clear       <br />&#160;&#160;&#160; Call doc.SelectSet.Select(obj)       <br />End Sub</p> </div>  <p>&#160;</p> <strong><font size="3"><font size="5">Basic Reference Key Workflow</font>&#160; <br /></font></strong>The concept of a reference key is fairly simple. The steps are:   <ol>   <li>Get a reference key from an object. </li>    <li>Save the reference key. </li>    <li>Use the reference key at a later time to get back the same object. </li> </ol>  <p>&#160;</p>  <p><strong><font size="5">Common Problems        <br /></font></strong>There are a few gotchas to be aware of that Iâ€™ve seen people struggle with before.</p>  <ul>   <li>A reference key is only good with the same document you originally got it from. </li>    <li>You should ignore the actual value of a reference key. You shouldnâ€™t compare reference keys themselves to check if two reference keys came for the same object. Itâ€™s possible that reference keys with different values will bind back to the same object. Because of this you should always bind both reference keys back to their objects and then compare the objects to see if theyâ€™re the same. </li>    <li>You must use a reference key context when working with B-Rep entities. This is discussed below. Itâ€™s not needed with other types of objects. </li> </ul>  <p>&#160;</p>  <p><strong><font size="4"><font size="5">B-Rep Entities and Reference Keys</font>         <br /></font></strong>When using reference keys with B-Rep entities the concepts shown above still apply but there is some additional work that you need to do. B-Rep entities donâ€™t have a simple internal identifier like other objects. Itâ€™s much more complicated for Inventor to be able to find a specific B-Rep entity because they can go through significant changes as modeling operations are performed. A way to visualize how Inventor can find a specific B-Rep entity is to think of the reference key as a set of instructions that identify a particular entity. For example a specific edge might be identified as the intersection of two faces and the faces might be identified by which sketch line was used to create that face as part of an extrusion. Because of the large amount of information that could be in these instructions, a reference key to a B-Rep entity can be quite large. In order to minimize the size of B-Rep reference keys and also improve performance, the idea of a <i>reference key context</i> was introduced. You can think of the context as a table where the instructions are saved. Several reference keys might use one or more of the same instructions.&#160; Having this information in a table allows individual instructions to be re-used. What this means is that a B-Rep reference key isnâ€™t the full set of instructions but is a set of references into this table. This significantly reduces the size of each reference key.</p>  <p>Here is the process of using reference keys for a B-Rep entity, where the new steps are in bold.</p>  <ol>   <li><strong>Create a reference key context.</strong> </li>    <li>Ask an object for its reference key and also <strong>providing the key context</strong>. </li>    <li>Continue to get reference keys from other objects, <strong>using the same key context</strong>. </li>    <li>Save the reference keys. </li>    <li><strong>Save the key context</strong>. </li>    <li>Use the reference key <strong>and the key context</strong> at a later time to get back the same object. </li> </ol>  <p>The process is essentially the same as described above for non B-Rep entities except for when you ask an object for a reference key or bind back a reference key to an object you also need to provide the key context. The program below is similar to the previous sample except it works for B-Rep entities.</p>  <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub GetBRepRefKey()      <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Get the active document.</font></strong>       <br />&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Have a face and edge selected.</font></strong>       <br />&#160;&#160;&#160; Dim selFace As Face       <br />&#160;&#160;&#160; Set selFace = ThisApplication.CommandManager.Pick( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kPartFaceFilter, &quot;Select face.&quot;)       <br />&#160;&#160;&#160; Dim selEdge As Edge       <br />&#160;&#160;&#160; Set selEdge = ThisApplication.CommandManager.Pick( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kPartEdgeFilter, &quot;Select edge.&quot;)</p>    <p>&#160;&#160;&#160; <font color="#0000ff"><strong>' Set a reference to the ReferenceKeyManager object.</strong></font>       <br />&#160;&#160;&#160; Dim refKeyMgr As ReferenceKeyManager       <br />&#160;&#160;&#160; Set refKeyMgr = doc.ReferenceKeyManager</p>    <p>&#160;&#160;&#160; <font color="#0000ff"><strong>' Create a key context.</strong></font>       <br />&#160;&#160;&#160; Dim keyContext As Long       <br />&#160;&#160;&#160; keyContext = refKeyMgr.CreateKeyContext       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get reference keys from the selected entities.</strong></font>       <br />&#160;&#160;&#160; Dim faceRefKey() As Byte       <br />&#160;&#160;&#160; Call selFace.GetReferenceKey(faceRefKey, keyContext)       <br />&#160;&#160;&#160; Dim edgeRefKey() As Byte       <br />&#160;&#160;&#160; Call selEdge.GetReferenceKey(edgeRefKey, keyContext)</p>    <p><strong><font color="#0000ff">&#160;&#160;&#160; ' Get the key context as an array of bytes and          <br />&#160;&#160;&#160; ' convert it to a string.           <br /></font></strong>&#160;&#160;&#160; Dim contextArray() As Byte       <br />&#160;&#160;&#160; Call refKeyMgr.SaveContextToArray(keyContext, contextArray)       <br />&#160;&#160;&#160; Dim strContext As String       <br />&#160;&#160;&#160; strContext = refKeyMgr.KeyToString(contextArray)       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Convert the reference keys to strings to make saving it easier.          <br /></strong></font>&#160;&#160;&#160; Dim strFaceKey As String       <br />&#160;&#160;&#160; strFaceKey = doc.ReferenceKeyManager.KeyToString(faceRefKey)       <br />&#160;&#160;&#160; Dim strEdgeKey As String       <br />&#160;&#160;&#160; strEdgeKey = doc.ReferenceKeyManager.KeyToString(edgeRefKey)       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save the results to a file.          <br /></strong></font>&#160;&#160;&#160; Open &quot;C:\Temp\RefKeys.txt&quot; For Output As #1       <br />&#160;&#160;&#160; Print #1, strContext       <br />&#160;&#160;&#160; Print #1, strEdgeKey       <br />&#160;&#160;&#160; Print #1, strFaceKey       <br />&#160;&#160;&#160; Close #1       <br />End Sub</p> </div>  <p>&#160;</p>  <p>You may have noticed in the last sample that the variable used for the key context is typed as a Long. Of course, this value isnâ€™t the key context table but is a pointer to the context. Whenever a key context is needed you pass the pointer to the context and when you create a context, a pointer is returned for you to use. When you save the key context along with the reference keys you need to save the full table, not the pointer. The SaveContextToArray method returns an array of bytes that is the full table. This is the data that you need to save, along with any reference keys that were created. The code below binds back to the B-Rep entities.</p>  <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub BindBRepRefKey()      <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Get the active document.          <br /></font></strong>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the reference key manager.          <br /></strong></font>&#160;&#160;&#160; Dim refKeyMgr As ReferenceKeyManager       <br />&#160;&#160;&#160; Set refKeyMgr = doc.ReferenceKeyManager       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Read the reference key strings from the file.          <br /></strong></font>&#160;&#160;&#160; Dim context As String       <br />&#160;&#160;&#160; Dim edgeKey As String       <br />&#160;&#160;&#160; Dim faceKey As String       <br />&#160;&#160;&#160; Open &quot;C:\Temp\RefKeys.txt&quot; For Input As #1       <br />&#160;&#160;&#160; Line Input #1, context       <br />&#160;&#160;&#160; Line Input #1, edgeKey       <br />&#160;&#160;&#160; Line Input #1, faceKey       <br />&#160;&#160;&#160; Close #1       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Convert the string to byte arrays.          <br /></strong></font>&#160;&#160;&#160; Dim edgeRefKey() As Byte       <br />&#160;&#160;&#160; Dim faceRefKey() As Byte       <br />&#160;&#160;&#160; Dim contextArray() As Byte       <br />&#160;&#160;&#160; Call refKeyMgr.StringToKey(edgeKey, edgeRefKey)       <br />&#160;&#160;&#160; Call refKeyMgr.StringToKey(faceKey, faceRefKey)       <br />&#160;&#160;&#160; Call refKeyMgr.StringToKey(context, contextArray)</p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create the context by loading the data.          <br /></strong></font>&#160;&#160;&#160; Dim refKeyContext As Long       <br />&#160;&#160;&#160; refKeyContext = refKeyMgr.LoadContextFromArray(contextArray)       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Bind back the face and edge.          <br /></strong></font>&#160;&#160;&#160; Dim foundFace As Face       <br />&#160;&#160;&#160; Dim foundEdge As Edge       <br />&#160;&#160;&#160; Set foundFace = refKeyMgr.BindKeyToObject(faceRefKey, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; refKeyContext)       <br />&#160;&#160;&#160; Set foundEdge = refKeyMgr.BindKeyToObject(edgeRefKey, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; refKeyContext)       <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Highlight the found entities.          <br /></strong></font>&#160;&#160;&#160; doc.SelectSet.Clear       <br />&#160;&#160;&#160; doc.SelectSet.Select foundFace       <br />&#160;&#160;&#160; doc.SelectSet.Select foundEdge       <br />End Sub</p> </div>  <p>&#160;</p>  <p><b><font size="5">Differences with B-Rep Entities when Binding Back        <br /></font></b>Thereâ€™s a difference when binding back B-Rep entities from other types of entities. The BindKeyToObject method can return an ObjectCollection in the case where the original B-Rep entity has been split into two or more pieces. The picture below shows the progression of a model and the changes that can take place to a face. In the last step face 2 is split into two pieces by an extrude feature. When binding back, both faces will be returned in an ObjectCollection.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0877f7a1970d-pi"><img title="RefKeys02" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="RefKeys02" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7d3d46d970b-pi" width="488" height="192" /></a></p>  <p>Below is some modified code from the sample above that handles this case. When multiples are returned the first one in the collection is considered the â€œbestâ€ match with no priority for the rest of the entities.</p>  <div style="font-size: 9pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p><font color="#0000ff"><strong>' Bind back the face and edge.</strong></font>       <br />Dim foundFaces As Object       <br />Dim foundEdges As Object       <br />Set foundFaces = refKeyMgr.BindKeyToObject(faceRefKey, refKeyContext)       <br />Set foundEdges = refKeyMgr.BindKeyToObject(edgeRefKey, refKeyContext)</p>    <p><font color="#0000ff"><strong>' Highlight the found entities, special casing for the case where          <br />' more than one might have been returned</strong></font>       <br />doc.SelectSet.Clear       <br />If TypeOf foundFaces Is ObjectCollection Then       <br />&#160;&#160;&#160; Dim obj As Object       <br />&#160;&#160;&#160; For Each obj In foundFaces       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.SelectSet.Select obj       <br />&#160;&#160;&#160; Next       <br />Else       <br />&#160;&#160;&#160; doc.SelectSet.Select foundFaces       <br />End If </p> </div>  <br />  <p><strong><font size="5">Important Points        <br /></font></strong>Here are a few points that I want to emphasize when using reference keys with B-Rep entities.</p>  <ul>   <li>A single context can be used, and is intended to be used, for multiple reference keys.&#160; Thatâ€™s the reason that the concept of the reference key context was created; so that multiple keys can share the same set of instructions for finding specific entities. </li>    <li>A reference key context and reference keys will only work with the same document they were originally obtained from. </li>    <li>Reference keys will only work with the same reference key context they were originally created with. </li>    <li>When working with B-Rep entities, write code that can handle the return of either a single object or an ObjectCollection. </li>    <li>The BindKeyToObject method can fail if the entity is not available.&#160; The CanBindKeyToObject method can be used to first check to see if the key can bind back. </li> </ul>  <p>&#160;</p>  <p><strong><font size="5">Why Use Reference Keys?        <br /></font></strong>An expected question at this point might be why would anyone want to use reference keys? Theyâ€™re a generic tool that can be used in many ways but here are some examples.</p>  <p><b>Support associativity in an external read-only application      <br /></b>This is one of the more common uses of reference keys. Applications are able to use Apprentice to read B-Rep data and display the model in their application. When the user selects geometry in their applications theyâ€™re able to get the corresponding geometry in Apprentice and get the reference key. For example, the geometry might used for a tool path or to position a load or constraint for analysis. Getting reference keys from objects does not require write access to the model. When the model is edited in Inventor they can read in the new geometry and use the reference keys to find the geometry and update their data if the geometry has changed.</p>  <p><b>Maintaining a reference over a re-compute      <br /></b>This is one of the more common general uses of the functionality. An example of this is if you want to write a program that finds all of the circular planar faces in a model and places a hole feature at the center of each one. The first part of your programs finds all of the circular planar faces and then it begins placing holes on each one. The problem is that any references to B-Rep entities are no longer valid after any change has been made to the model. Creating the first hole invalidated all of the references you have to the circular faces. You donâ€™t want to do the analysis again to find circular faces because youâ€™ve potentially added new circular faces by placing the new feature.</p>  <p>Reference keys can help you solve this. Instead of maintaining a reference to a Face object you can get the reference key of each circular planar face. Reference keys are still valid after a compute, so after you create the first hole you can find the next circular planar face by using the saved reference key.</p>  <p><b>Attributes      <br /></b>Attributes can be used in some cases to solve the same issues that reference keys do by providing a way of adding information to an object to find it later. Attributes have the advantage that theyâ€™re self-contained and you donâ€™t have to save any information. They also have the advantage of supporting a more powerful search mechanism. They have the disadvantage that they require write access to the file and will require the document to be saved. They also have the disadvantage that they donâ€™t return multiple objects in the case where B-Rep entities have been split.</p>  <p>&#160;</p> <strong><font size="5">What Are Transient Keys?      <br /></font></strong>Thereâ€™s one more thing that I want to quickly touch on, which is <i>transient keys</i>. Transient key functionality is only available with B-Rep entities. Each of the B-Rep entities supports the TransientKey property which returns a Long value. This is a simple identifier for that specific B-Rep entity. You can bind back to the B-Rep entity with the transient key using the BindTransientKeyToObject method on the SurfaceBody object. This is much simpler than reference keys because itâ€™s just a single Long and you donâ€™t need a key context. However, thereâ€™s a BIG limitation with transient keys. Theyâ€™re only good as long as the model has not been modified. Theyâ€™re similar to a live reference to a B-Rep entity in that it doesnâ€™t survive through a model compute.   <p>The purpose of transient keys is to provide the ability to match up B-Rep entities when copying bodies. For example, the AlternateBody property of the SurfaceBody returns a copy of the body it was called on. The new body may even be slightly different than the original body, (for example, some faces may have been split into two). The new body has transient keys that you can get from each B-Rep entity. You can use the BindTransientKeyToObject method to find the equivalent B-Rep entity on the original body. Itâ€™s also possible to write out a body as SAT where the transient keys are also output as attributes on the SAT data. This again allows you to match up the B-Rep entities from this output model to the original Inventor model, <u>as long as the model has not been edited</u> since the copy was created.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: MegaJerk
EMAIL: GarbageDonkey@gmail.com
IP: 70.61.45.30
URL: https://forums.autodesk.com/t5/forums/recentpostspage/post-type/message/user-id/725444
DATE: 09/30/2015 05:24:10 PM
Thank you for writing this one up! Very informative! 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Add control to toolbar panel
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: add-control-to-toolbar-panel
CATEGORY: Adam
CATEGORY: Add-In Creation
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/add-control-to-toolbar-panel.html 
DATE: 09/22/2015 09:50:41 AM
-----
BODY:
<p>It&#39;s worth downloading existing apps from the <a href="https://apps.autodesk.com/FUSION/en/Home/Index" target="_self">Fusion 360 exchange store</a>&#0160;even just to see if they already implement a certain functionality that you are interested in. In which case you can look at the source code (if it&#39;s a <strong>JavaScript</strong> or <strong>Python</strong> add-in) and see how things are done.</p>
<p>E.g. the <strong>ExactFlat</strong> add-in creates its own toolbar panel and promotes its single button control to that panel.</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7d1f098970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Exactflat" class="asset  asset-image at-xid-6a00e553fcbfc6883401b7c7d1f098970b img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7d1f098970b-320wi" title="Exactflat" /></a></p>
<p>It&#39;s done using this part of the <strong>Python</strong> code:</p>
<pre># &quot;toolbarControlPanel_&quot; is the button control added to the panel 
toolbarControlPanel_.isPromoted = True
toolbarControlPanel_.isPromotedByDefault = True</pre>
<p><strong>isPromoted = True</strong> will make the control show up on the panel - just like when clicking the curved arrow (<strong>Add to toolbar</strong>) on a control in a panel menu:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d15bc423970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Addtotoolbar" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d15bc423970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d15bc423970c-320wi" title="Addtotoolbar" /></a></p>
<p>But if the user clicks <strong>Reset Panel Customization</strong> on the given panel or <strong>Reset All Toolbar Customization</strong> anywhere on the toolbar then the button will disappear from the panel. &#0160;&#0160;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb087620fc970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Reset_toolbar" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb087620fc970d img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb087620fc970d-320wi" title="Reset_toolbar" /></a></p>
<p><strong>isPromotedByDefault = True</strong> will make sure that the button stays on the panel even if the toolbar is reset using either of the above mentioned ways.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: The Fusion 360 Hackathon is Near
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: the-fusion-360-hackathon-is-near
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/the-fusion-360-hackathon-is-near.html 
DATE: 09/16/2015 08:06:23 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1590d8e970c-pi"><img alt="FusionHackathonModels" border="0" height="240" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7cf282e970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="FusionHackathonModels" width="604" /></a></p>
<p>One week from today the Fusion 360 Hackathon will start and it will be great if you can join us.&#0160; Iâ€™ve <a href="http://modthemachine.typepad.com/my_weblog/2015/08/youre-invited-to-the-fusion-360-hackathon.html">already posted</a> some general information about the Hackathon but if you have any interest at all in Fusion 360 would like to encourage you to sign up by visiting the official <a href="http://fusion360hackathon.com/">Fusion 360 Hackathon</a> site.&#0160;</p>
<p>And for those of you that have signed up and possibly already have been playing with the API, I would love to hear any suggestions about topics you would like to have covered during the training sessions.&#0160; This event is for you and want to spend the time covering topics that will benefit you.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Improving Your Program&rsquo;s Performance
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: improving-your-programs-performance
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/09/improving-your-programs-performance.html 
DATE: 09/01/2015 06:38:11 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d151669a970c-pi"><img title="Stopwatch" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Stopwatch" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7c7771b970b-pi" width="154" align="right" height="154" /></a>Very few programs run as fast as we would like them to. The fact is that it takes processing time to do the required work and in many cases thereâ€™s not much we can do to shorten that time. When your program asks Inventor to perform a compute intensive task, i.e. create a complex feature, itâ€™s going to take a certain amount of time for Inventor to compute and create the feature. However, there are cases where you can significantly speed up performance by using some general programming principles and taking advantage of some often neglected capabilities in the API.</p>  <p><strong></strong></p>  <p><strong><font size="3"></font></strong></p>  <p><strong><font size="3">Timing Your Program</font></strong>     <br />The first thing to consider when looking at your programâ€™s performance is measuring the current performance. You want to be able to determine possible areas of improvement and if your changes help the performance. If youâ€™re using .Net you can use the StopWatch class from System.Diagnostics. Below is an example of it in use.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p><b><i><font color="#0000ff">' Use the .Net StopWatch class to time an action.            <br /></font></i></b>Dim stopwatch As New System.Diagnostics.Stopwatch       <br />stopwatch.Start()</p>    <p><b><i><font color="#0000ff">' Do some things.</font>           <br />          <br /></i></b></p>   <b><i><font color="#0000ff">' Get the time taken</font>.         <br />M</i></b>essageBox.Show(&quot;Elapsed time: &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; stopwatch.ElapsedMilliseconds / 1000 &amp; &quot; seconds&quot;)</div>  <p>For timing in VBA I used to use some built-in VBA functions but I noticed some problems with the results and later read about some accuracy issues. I now use the class below. To use this, copy and paste the code below into a new class module. I name the class module â€œclsTimerâ€.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p><strong><font color="#0000ff">' clsTimer Definition.</font></strong>       <br />Private Declare PtrSafe Function QueryPerformanceFrequency _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Lib &quot;kernel32&quot; (lpFrequency As Currency) As LongPtr       <br />Private Declare PtrSafe Function QueryPerformanceCounter _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Lib &quot;kernel32&quot; (lpPerformanceCount As Currency) As LongPtr</p>    <p>Private ConversionFactor As Currency      <br />Private CurrentStartTime As Currency</p>    <p>Public Sub Start()      <br />&#160;&#160;&#160; Dim iReturn As LongPtr       <br />&#160;&#160;&#160; iReturn = QueryPerformanceCounter(CurrentStartTime)       <br />End Sub</p>    <p>Public Function GetTime() As Double      <br />&#160;&#160;&#160; Dim NewTime As Currency       <br />&#160;&#160;&#160; Dim iReturn As LongPtr       <br />&#160;&#160;&#160; iReturn = QueryPerformanceCounter(NewTime)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim TotalTime As Currency       <br />&#160;&#160;&#160; TotalTime = NewTime - CurrentStartTime       <br />&#160;&#160;&#160; GetTime = TotalTime / ConversionFactor       <br />End Function</p>    <p>Private Sub Class_Initialize()      <br />&#160;&#160;&#160; Dim iReturn As LongPtr       <br />&#160;&#160;&#160; iReturn = QueryPerformanceFrequency(ConversionFactor)       <br />End Sub</p> </div>  <p>You can then add the code below into your program to time sections of your program.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p><b><i><font color="#0000ff">' Use the timer class to time an action.            <br /></font></i></b>Dim timer As New clsTimer       <br />timer.Start       <br />      <br /><b><i><font color="#0000ff">' Do some things.            <br /></font>          <br /></i></b></p>   <b><i><font color="#0000ff">' Get the time taken</font>.         <br /></i></b>MsgBox &quot;Elapsed time: &quot; &amp; Format(timer.GetTime, &quot;0.00000&quot;) &amp; &quot; seconds&quot;</div>  <p>&#160;</p>  <p><b><font size="3">Running In-Process vs. Out-of-Process        <br /></font></b>One thing that significantly impacts performance is if your program is running inside Inventor or not. When your program is running within Inventorâ€™s process itâ€™s referred to as <i>in-process.</i> When your program is running in another process it referred to as <i>out-of-process</i>. Add-ins and VBA macros, (as of Inventor 2014), run in-process.&#160; Exeâ€™s and programs that run from within other products (i.e. Excel VBA macros) all run in a process outside of Inventor. When running out-of-process Windows has to package the API calls for inter-process communication which adds additional overhead to every API call.</p>  <p>Below is a test program that makes a simple API call. This call was chosen because it doesnâ€™t take any processing on Inventorâ€™s side to respond since itâ€™s simply returning a known value. It makes 100,000 calls of this property and without any optimizations takes 74.8 seconds to run out-of-process. The same program running in-process takes 0.24 seconds or 312 times faster.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub CallCost()      <br />&#160;&#160;&#160; Dim timer As New clsTimer       <br />&#160;&#160;&#160; timer.Start       <br />      <br />&#160;&#160;&#160; Dim i As Long       <br />&#160;&#160;&#160; For i = 1 To 100000       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim code As Long       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; code = ThisApplication.Locale       <br />&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Total time: &quot; &amp; Format(timer.GetTime, &quot;0.00000&quot;)       <br />End Sub </p> </div>  <p>Donâ€™t expect your programs to run 312 times faster by changing them to run in-process. This test was designed to test the overhead of making out-of-process calls and doesnâ€™t represent real use of the API. Remember that itâ€™s making 100,000 calls so even with the slow time in the out-of- process test it is still making over 5400 calls per second. The reason you wonâ€™t see big time improvements is that typical programs are making calls that require Inventor to do some work. The time that it takes for Inventor to do the work is the same regardless of in-process or out-of-process. The difference is in the overhead of packaging to make the call land return the results. However, in most cases there will be a noticeable difference between running in-process and out-of-process, so ideally you want to run in-process.</p>  <p>You donâ€™t always have the option to run in-process though. Sometimes your program might be some type of batch processor that needs to start Inventor and then perform some action. Or it might be an Excel VBA macro that uses values from Excel to perform some action in Inventor. When youâ€™re forced to run out-of-process there are also some things you can do to speed up the processing.</p>  <p>Besides the overhead of packaging the API calls for inter-process communication, another reason for the performance difference between in-process and out-of-process is that Inventor is servicing the out-of-process calls while itâ€™s also servicing the user-interface. It gives priority to the user-interface and then out-of-process API calls slip in when they can. For in-process programs, Inventor dedicates all of its processing to the API calls. For out-of-process programs, you can get this dedicated processing by using the UserInteractionDisabled property available on the UserInterfaceManager object. Setting the property to True will lock the user-interface. This is typically what you want anyway because you donâ€™t want the user doing things in Inventor while your program is running. It also has the side effect of allowing Inventor to focus on handling API calls instead of watching the user-interface. The code below shows the test program with this optimization and drops the execution time from 74.8 seconds to 61.32 seconds. Iâ€™ve seen much bigger differences in other programs.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub CallCost()      <br />&#160;&#160;&#160; Dim timer As New clsTimer       <br />&#160;&#160;&#160; timer.Start       <br />      <br />&#160;&#160;&#160; app.UserInterfaceManager.UserInteractionDisabled = True       <br />      <br />&#160;&#160;&#160; Dim i As Long       <br />&#160;&#160;&#160; For i = 1 To 100000       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim code As Long       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; code = ThisApplication.Locale       <br />&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; app.UserInterfaceManager.UserInteractionDisabled = False       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Total time: &quot; &amp; Format(timer.GetTime, &quot;0.00000&quot;)       <br />End Sub</p> </div>  <p>When using this property you want make sure to add error handling to your program so that if an error does occur and your program stops, youâ€™ll handle the error so you can turn interaction back on. Otherwise Inventor will remain frozen and you wonâ€™t be able to work with it.</p>  <p>&#160;</p>  <p><b><font size="3">Optimizing Inventor VBA Macros        <br /></font></b>Hereâ€™s an optimization thatâ€™s limited to Inventorâ€™s VBA. In Inventorâ€™s VBA you access the Inventor Application object using the global ThisApplication property. There is some cost to using this property. The code below calls the Locale property of the Application object 100,000 times and takes 74.8 seconds when running out-of-process.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub CallCost()      <br />&#160;&#160;&#160; Dim timer As New clsTimer       <br />&#160;&#160;&#160; timer.Start       <br />      <br />&#160;&#160;&#160; Dim i As Long       <br />&#160;&#160;&#160; For i = 1 To 100000       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim code As Long       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; code = ThisApplication.Locale       <br />&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Total time: &quot; &amp; Format(timer.GetTime, &quot;0.00000&quot;)       <br />End Sub </p> </div>  <p>Making the small change highlighted below reduced the run time to 18.8 seconds, which is about 4 times faster. You can see the change gets the Application object, assigns it to a variable, and then uses that reference for the rest of the program. Itâ€™s a big improvement for a small change.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub CallCost()      <br />&#160;&#160;&#160; Dim timer As New clsTimer       <br />&#160;&#160;&#160; timer.Start       <br />      <br />&#160;&#160;&#160; <font style="background-color: #ffff00">Dim app As Inventor.Application</font>       <br />&#160;&#160;&#160; <font style="background-color: #ffff00">Set app = ThisApplication</font>       <br />      <br />&#160;&#160;&#160; Dim i As Long       <br />&#160;&#160;&#160; For i = 1 To 100000       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim code As Long       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; code = <font style="background-color: #ffff00">app</font>.Locale       <br />&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Total time: &quot; &amp; Format(timer.GetTime, &quot;0.00000&quot;)       <br />End Sub </p> </div>  <p>&#160;</p>  <p><font size="3"><strong>Use References Instead of Inline Calls        <br /></strong></font>An optimization similar to the previous one is to get and save any objects that youâ€™re going to use multiple times. The program below Iterates through all of the occurrences in an assembly and gets the name and filename of each one. Calling this function 10 times takes 22.5 seconds in an assembly of 500 occurrences.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub GetOccurrences1()      <br />&#160;&#160;&#160; Dim asmDoc As AssemblyDocument       <br />&#160;&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument       <br />      <br />&#160;&#160;&#160; Dim i As Integer       <br />&#160;&#160;&#160; For i = 1 To asmDoc.ComponentDefinition.Occurrences.Count       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim Name As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Name = asmDoc.ComponentDefinition.Occurrences.Item(i).Name       <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = asmDoc.ComponentDefinition.Occurrences.Item(i). _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReferencedDocumentDescriptor. _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReferencedFileDescriptor.FullFileName       <br />&#160;&#160;&#160; Next       <br />End Sub</p> </div>  <p>Hereâ€™s a slightly different version of the previous program with the differences highlighted. Calling this program 10 times takes less than half the time at 9.7 seconds. The difference is that this gets the ComponentOccurrences object and the ComponentOccurrence objects and assigns them to variables that it uses later. This significantly reduces the number of API calls. A single line of code like</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">asmDoc.ComponentDefinition.Occurrences.Item(i).Name</div>  <p>results in several API calls and each call takes some time. If you can make those calls once and save and re-use the result you can improve the performance of your programs.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub GetOccurrences2()      <br />&#160;&#160;&#160; Dim asmDoc As AssemblyDocument       <br />&#160;&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument       <br />      <br />&#160;&#160;&#160; <font style="background-color: #ffff00">Dim occs As ComponentOccurrences</font>       <br />&#160;&#160;&#160; <font style="background-color: #ffff00">Set occs = asmDoc.ComponentDefinition.Occurrences</font>       <br />      <br />&#160;&#160;&#160; Dim i As Integer       <br />&#160;&#160;&#160; For i = 1 To <font style="background-color: #ffff00">occs</font>.Count       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font style="background-color: #ffff00">Dim Occ As ComponentOccurrence</font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font style="background-color: #ffff00">Set Occ = occs.Item(i)</font>       <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim Name As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Name = <font style="background-color: #ffff00">Occ</font>.Name       <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = <font style="background-color: #ffff00">Occ</font>.ReferencedDocumentDescriptor. _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReferencedFileDescriptor.FullFileName       <br />&#160;&#160;&#160; Next       <br />End Sub</p> </div>  <p><strong><font size="3"></font></strong></p>  <p><strong><font size="3"></font></strong></p>  <p><strong><font size="3">Use For Each instead of Count and Item        <br /></font></strong>Another optimization is to use the For Each statement when iterating over the contents of a collection. Below is a version of the same test program that uses For Each. Besides being more efficient it also makes the code easier to read. The time for this function to run 10 times was 9.4 seconds. Not a big difference from the previous sample, but the time saved will vary depending on which collection is being iterated through.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub GetOccurrences3()      <br />&#160;&#160;&#160; Dim asmDoc As AssemblyDocument       <br />&#160;&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument       <br />      <br />&#160;&#160;&#160; Dim occs As ComponentOccurrences       <br />&#160;&#160;&#160; Set occs = asmDoc.ComponentDefinition.Occurrences       <br />      <br />&#160;&#160;&#160; Dim Occ As ComponentOccurrence       <br />&#160;&#160;&#160; <font style="background-color: #ffff00">For Each Occ In occs</font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim Name As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Name = Occ.Name       <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Occ.ReferencedDocumentDescriptor. _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReferencedFileDescriptor.FullFileName       <br />&#160;&#160;&#160; Next       <br />End Sub</p> </div>  <p>The reason using a For Each statement is faster is because Inventor knows youâ€™ll be iterating over the collection so it can do some internal optimization to improve the performance. When using the Item property Inventor doesnâ€™t know if you just want a single item or will be iterating over multiple items. Some collections are better optimized to return single items, like the ComponentOccurrences collection so you wonâ€™t see big improvements, but others will be significantly faster using a For Each statement.</p>  <p>&#160;</p>  <p><strong><font size="3">Get Items By Name        <br /></font></strong>Another optimization associated with collections is to use the capability of many of the collections to get an object in the collection by name instead of iterating through the collection looking for an object with a specific name. The Item property of many of the collections will take either an index or the name of the object within the collection you want. In a few cases there is an additional Item property that is specifically for the name. In either case using these is much more efficient that iterating over the entire collection looking for an object with a specific name.</p>  <p>Below is a code example straight from the Inventor Customization newsgroup that is looking for the DXF translator add-in.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Dim dxfAddIn As TranslatorAddIn      <br />For i = 1 To addIns.Count       <br />&#160;&#160;&#160; If addIns(i).AddInType = kTranslationApplicationAddIn Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim desc As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; desc = addIns(i).Description&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If desc = &quot;Autodesk Internal DXF Translator&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set dxfAddIn = addIns.Item(i)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit For       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End If       <br />Next</p> </div>  <p>Hereâ€™s the equivalent code using the ItemById property of the ApplicationAddIns object. As you can see the code is much simpler but it also much more efficient because Inventor is doing the look-up instead and is able to it in a much more optimized way than looking through the objects one-by-one.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Dim dxfAddIn As TranslatorAddIn      <br />Set dxfAddIn = addIns. _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ItemById(&quot;{C24E3AC4-122E-11D5-8E91-0010B541CD80}&quot;)</p> </div>  <p><b></b></p>  <p><b><font size="3"></font></b></p>  <p><b><font size="3"></font></b></p>  <p><b><font size="3">Donâ€™t Use Constraints and Defer Updates When Possible</font>       <br /></b>When working with assemblies, Inventor solves the constraints in order to determine the occurrences positions and orientations. This constraint solving takes time and the more constraints there are the longer it will take to solve. Often, when constructing an assembly with the API, you position the occurrences exactly so you donâ€™t need constraints to position the occurrences.</p>  <p>The first optimization you can do when working with assemblies is to not use constraints at all. If your program positions everything precisely and the assembly wonâ€™t be edited by the user, you can place the occurrences and leave out the constraints. You can optionally ground the occurrences so the user doesnâ€™t accidentally reposition them. A program that runs in-process and places 500 occurrences of the same part without any constraints takes 5.32 seconds to run. Compare that to the same final assembly with constraints that takes 699 seconds (11 m 39 s). There are additional API calls to create the constraints but the time Inventor takes to solve the assembly with each new constraint is the big difference.</p>  <p>There is something you can do to so you can still use constraints but get reasonable performance. You can defer assembly updates. Youâ€™re essentially turning off the compute until you either turn it back on or explicitly update the assembly. This setting is available in the user-interface as an application option, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d151669e970c-pi"><img title="DeferUpdate" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="DeferUpdate" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb086bc636970d-pi" width="450" height="163" /></a></p>  <p>This setting is also available through the API as the Application.AssemblyOptions.DeferUpdate property. After setting this property to True and placing the 500 occurrences with constraints the total processing time drops down to 54 seconds. It was trimmed down to 49 seconds by also using the Application.ScreenUpdating property. This freezes the screen so Inventor doesnâ€™t try to update the graphics while the program is running.</p>  <p><b></b></p>  <p><b><font size="3"></font></b></p>  <p><b><font size="3">Use Defer When Creating Sketches</font>       <br /></b>Sketches also solve as you add additional sketch entities and constraints. When working with sketches you canâ€™t choose to not use constraints because itâ€™s constraints that connect the entities. If the sketch wonâ€™t be edited by the user you can minimize the number of constraints used but you can never eliminate them.</p>  <p>A sample that that runs in-process and creates 500 lines with the minimum amount of constraints takes 18.5 seconds to complete. Sketches support the ability to defer compute through the Sketch.DeferUpdates property. Setting this to True for the program that creates the 500 lines reduced the run time to 1.6 seconds, which is a huge difference.</p>  <p><b></b></p>  <p><b><font size="3"></font></b></p>  <p><b><font size="3">Minimize API Calls        <br /></font></b>An obvious way to improve performance is to minimize the number of API calls made. Usually this isnâ€™t possible because there are a fixed number of calls you need to make to accomplish a specific objective. However, there are a few cases where you might be using the API as a general programming library, rather than creating or querying things in Inventor.</p>  <p>An example of this is the Facet Enabler add-in I wrote a few years ago. It allows you to read in STL files and supports sectioning of the data. Initially I was using the Inventor API Point object for all of the coordinates and the Matrix object to do transformations. There often are hundreds of thousands of points in an STL file so there were a <u>lot</u> of API calls being made and the program was quite slow. I changed this to use my own data and functions to do the point manipulation and the program sped up several times. This is a fringe case but in cases where you are making many thousands of calls you should look at whether there are alternatives to do some of the processing outside of Inventor to avoid the API call overhead.</p>  <p>&#160;</p>  <p><b><font size="3">Global Transactions        <br /></font></b>An overhead in Inventor any time you create or edit anything is transactions. A transaction is how Inventor wraps actions so they can be undone. Anything you do that is undoable is wrapped within a transaction. It takes some time for Inventor to do the work to support transactions. You canâ€™t perform work in Inventor without it being wrapped in a transaction, but it is possible to minimize the number of transactions that occur. Trying to minimize the transaction overhead will only help in cases where you are doing a lot of creation or edit. Query operations arenâ€™t impacted at all because they donâ€™t participate in undo and a few transactions arenâ€™t going to have enough impact to matter.</p>  <p>The Inventor API supports the ability for you to wrap multiple actions into a single transaction, which means it will result in a single undo. This makes is nice for the user if they want to undo the action of your program. The simple way to do this is shown below. You start a transaction, do whatever your command does, and then end the transaction. Now the user will be able to undo everything the command did in a single undo.</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub SampleCommand()&#160; <br />&#160;&#160; Dim partDoc As PartDocument&#160; <br />&#160;&#160; Set partDoc = ThisApplication.ActiveDocument&#160; <br />      <br />&#160;&#160; <b><i><font color="#0000ff">' Start a transaction.</font>&#160; <br />&#160;&#160; </i></b>Dim trans As Transaction&#160; <br />&#160;&#160; Set trans = ThisApplication.TransactionManager. _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StartTransaction( partDoc, &quot;My Command&quot;)       <br />      <br />&#160;&#160;&#160; <b><i><font color="#0000ff">' ** Do stuff that creates or edits the model.</font>           <br />          <br />&#160;&#160;&#160; </i></b><b><i><font color="#0000ff">' End the transaction.</font>           <br />&#160;&#160;&#160; </i></b>trans.End       <br />End Sub</p> </div>  <p>The above is convenient for the user but it doesnâ€™t improve performance because there are just as many transactions. This creates a custom transaction that wraps all of the transactions that are created between the time it was started and ends. There is another type of transaction that will block the individual transactions from being created and the commands will rely on the outer custom transaction. This capability is accessed by using the hidden StartGlobalTransaction method. This is used in exactly the same as the standard StartTransaction and is shown below. The downside of using this, and the reason itâ€™s hidden, is that you need to be very careful to make sure you always end a global transaction or you can leave Inventor in a bad state that will most likely result in a crash as you or the user continues to do work. Youâ€™ll want to wrap the code thatâ€™s doing the work in an error handler so that if an error occurs you can either end, or more typically, abort the transaction. </p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p><b><i>&#160;&#160;&#160; <font color="#0000ff">' Start a transaction.</font>           <br />&#160;&#160;&#160; </i></b>Dim trans As Transaction       <br />&#160;&#160;&#160; Set trans = ThisApplication.TransactionManager. _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StartGlobalTransaction(partDoc, &quot;My Command&quot;)       <br />      <br />&#160;&#160;&#160; <b><i><font color="#0000ff">' ** Do stuff that creates or edits the model.</font>           <br />          <br />&#160;&#160;&#160; </i></b><b><i><font color="#0000ff">' End the transaction.</font>           <br />&#160;&#160;&#160; </i></b>trans.End</p> </div>  <p>The assembly test described previously that creates 500 occurrences with constraints was taking about 50 seconds. By wrapping that code in a global transaction itâ€™s down to about 40 seconds. The other example that creates 500 sketch lines goes from 1.6 seconds to 1 second.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Katie Miller
EMAIL: kmiller@coldspringusa.com
IP: 69.40.72.114
URL: 
DATE: 09/10/2015 08:22:21 PM
In regards to the Application.ScreenUpdating call.  If a program is performing a loop of processes in a drawing, some including graphical changes.  Does this affect activedocument.update function at all?

Particularly..The program I have with drawing document open, some iproperty information is processed, an image on the document is added or modified, then a copy of the modified document is saved creating a new file (save copy as functionality).  This can loop for as many times as user needs it too. Constantly modifying the original and then saving a new copy until the original is closed (aka - program finishes)  Would turning off the ScreenUpdating property affect the overall file output if turned off?

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.71.11
URL: http://profile.typepad.com/1218580234s15464
DATE: 09/10/2015 08:34:55 PM
Hi Katie,

The only way to know for sure is to try it. :)

I would expect that the actual drawing data is unaffected by this.  There's a chance that the thumbnail that's created for the document won't be up to date.  You can also turn the ScreenUpdating off while you do the majority of the processing and then turn of back on before the save.  But to know for sure, it would take some testing.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: You&rsquo;re Invited to the Fusion 360 Hackathon
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: youre-invited-to-the-fusion-360-hackathon
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/08/youre-invited-to-the-fusion-360-hackathon.html 
DATE: 08/28/2015 06:12:55 PM
-----
BODY:
<p>On September 23rd, the Fusion 360 Hackathon will be begin. If youâ€™ve heard of Hackathons before this one is slightly different in that youâ€™ll be able to get some sleep at night.&#0160; Instead of an intense couple of days this one is spread out over five weeks with the goal of you being able to learn about the Fusion 360 API, write your custom app, and share it with others via the <a href="https://apps.exchange.autodesk.com/en">Autodesk App Store</a>. And if you submit your app by October 30th youâ€™ll get $500.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7c5ac75970b-pi"><img alt="FusionHackathon" border="0" height="187" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7c5ac79970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="FusionHackathon" width="450" /></a></p>
<p>&#0160;</p>
<p>You can learn all the details about the Hackathon and sign up on the official <a href="http://fusion360hackathon.com/">Fusion 360 Hackathon site</a>. Even if you donâ€™t have an idea for an app, this is a great chance to learn about the API and get started writing your own utilities.&#0160; The Hackathon will consist of several presentations and also scheduled time where you can get help with your specific issues.</p>
<p>Learning more about the API is a great way to better understand the internals of Fusion and how it works which can help you in your day-to-day use of Fusion.&#0160; The API also allows you to do things that you wouldnâ€™t consider doing interactively because of how tedious the work would be.&#0160; And itâ€™s fun. <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14f9223970c-pi" />&#0160;</p>
<p>For example, hereâ€™s something Iâ€™ve been playing with the last couple of days that I would never consider doing interactively.&#0160; Itâ€™s nothing special as far as features in thatâ€™s it just a bunch of combine features but positioning the tool bodies like this would not be fun through the user interface.&#0160; Once the program was written now itâ€™s just a matter of a couple of minutes to run the program to generate this geometry.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0869fe4b970d-pi"><img alt="Gouges" border="0" height="380" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7c5ac84970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="Gouges" width="454" /></a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Use the Old Fusion 360 Help Format
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: use-the-old-fusion-360-help-format
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/08/use-the-old-fusion-360-help-format.html 
DATE: 08/27/2015 05:26:21 AM
-----
BODY:
<p>If youâ€™re a little frustrated using the <a href="http://fusion360.autodesk.com/learning/index.html">new layout</a> of the Fusion help, it turns out that you can still access the updated content through the <a href="http://help.autodesk.com/view/NINVFUS/ENU/">old layout</a>.&#160; If you forget the link you can also Google search for a Fusion API term, for example â€œFusion BRepFaceâ€ and the search result will also take you to the topic in the older help format and youâ€™ll have access to the full help through the table of contents.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7c4fb8d970b-pi"><img title="OldHelp" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="OldHelp" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14edf98970c-pi" width="450" height="218" /></a></p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Attribute Helper Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: attribute-helper-update
CATEGORY: Attributes
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Utilities

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/08/attribute-helper-update.html 
DATE: 08/10/2015 05:34:06 PM
-----
BODY:
<p>Quite a few years ago I wrote a little utility that lets you create, view, and edit attributes within a document.&#0160; If youâ€™re relatively new to the Inventor API and are wondering what attributes are, hereâ€™s a <a href="http://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html">post giving a quick introduction</a>.&#0160;</p>
<p>Iâ€™ve used the utility quite a bit over the years and havenâ€™t had any problems but someone recently reported a problem they were having and I had a hard time believing that the problem could exist.&#0160; I was finally able to reproduce the problem and found out it could be a fairly common problem, itâ€™s just that I happened to always use a certain workflow that avoided it.&#0160; Thatâ€™s why itâ€™s always good to get someone else to help test your programs. <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0860fe9a970d-pi" />&#0160;</p>
<p>Iâ€™ve fixed the problem and have a new version available.&#0160; If you already have a version of â€œAttribute Helperâ€ installed, you should first uninstall the version you have, which you can do using the standard Windows uninstall utility where you should see â€œAttribute Helperâ€ listed as one of the installed programs, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d146b5ef970c-pi"><img alt="UninstallAttributeHelper" border="0" height="349" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0860fe9c970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="UninstallAttributeHelper" width="450" /></a></p>
<p><br />Once itâ€™s uninstalled, you can install the <a href="http://modthemachine.typepad.com/AttributeHelperSetup.exe">new version of Attribute Helper</a>.&#0160; There is some help documentation delivered with the utility with instructions on how to use it and you can quickly determine if it was installed correctly by checking to see if the Attribute Helper command is now available in the Tools panel when you have a document open.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d146b5f3970c-pi"><img alt="AttributeHelperCommand" border="0" height="70" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7bcd881970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="AttributeHelperCommand" width="450" /></a></p>
<p><br />And when you run the Attribute Helper command, you should see the dialog below with the version displayed being â€œ2.4â€, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d146b5f9970c-pi"><img alt="AttributeHelper2_4" border="0" height="500" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7bcd885970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="AttributeHelper2_4" width="350" /></a></p>
<p>&#0160;</p>
<p>Iâ€™ve also made the <a href="https://github.com/brianekins/AttributeHelper">source code</a> available on <a href="https://github.com/">GitHub</a></p>
<p>As always, please let me know if you find any problems or have suggestions for improvement.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Modified parameters of event handler ignored
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: modified-parameters-of-event-handler-ignored
CATEGORY: Adam
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/08/modified-parameters-of-event-handler-ignored.html 
DATE: 08/05/2015 08:35:06 PM
-----
BODY:
<p>A developer just ran into an issue with&#0160;<strong>OnFileResolution</strong> when handled inside an application using <strong>Inventor</strong> <strong>Apprentice</strong>. No matter what value they set the&#0160;<strong>FullFileName</strong> parameter to, it got ignored.</p>
<p><a href="http://modthemachine.typepad.com/my_weblog/wayne-brill.html" target="_self">Wayne</a> already blogged about <a href="http://modthemachine.typepad.com/my_weblog/2012/07/set-embed-interop-types-to-false-to-avoid-problems-with-events.html" target="_self">running into issues with events</a>, but I&#39;ve only experienced it in a way that the event was not caught at all. This time it is caught but the parameter change has no effect. The same trick helps here too though: make sure that <strong>Embed Interop Types</strong> is set to <strong>False</strong>. &#0160;</p>
<p>-Adam&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: New API Help Format
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: new-api-help-format
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/07/new-api-help-format.html 
DATE: 07/31/2015 04:44:00 PM
-----
BODY:
<p>With the latest release of Fusion, a new format for the syntax in the help has been introduced.&#160; Although this change has been made for the Fusion help, the same help system is also used for Inventor so these changes can also be fairly easily made for the Inventor API help too.&#160; Because of that I would like to get feedback from both Inventor and Fusion users about this new format.</p>  <p>In the old help, the syntax was shown using a pseudo Python or Javascript syntax that represented that function as if you were writing the function.&#160; In Inventor it uses a VBA style syntax.&#160; It was pseudo code because it also included argument types which arenâ€™t actually needed in Python or JavaScript but were include because they help to provide the full description.&#160; </p>  <p>&#160;</p>  <p><strong><font size="3">Old Style        <br /></font></strong>Below is an example showing the MirrorFeatures.createInput method in both Python and JavaScript.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd6a970b-pi"><img title="SyntaxSampleOldPython" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxSampleOldPython" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182c7970c-pi" width="450" height="98" /></a>&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd6c970b-pi"><img title="SyntaxSampleOldJavaScript" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxSampleOldJavaScript" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182cb970c-pi" width="450" height="112" /></a></p>  <p>   <br />And hereâ€™s an example of how properties were represented using the isSuppressed property of the MirrorFeature.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd6e970b-pi"><img title="SyntaxSampleOldPythonProperty" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxSampleOldPythonProperty" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182cd970c-pi" width="450" height="93" /></a></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be36e970d-pi"><img title="SyntaxSampleOldJavaScriptProperty" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxSampleOldJavaScriptProperty" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be370970d-pi" width="450" height="95" /></a></p>  <p>&#160;</p>  <p><strong><font size="3">New Style        <br /></font></strong>With the new syntax style it attempts to show how you would actually use the method, property, or event in your code.&#160; So instead of showing the format for the person developing the API, itâ€™s showing the format for the person using it. Itâ€™s not really a runnable sample but in many cases is very close.&#160; Below is&#160; the new format for the same method and property illustrated above. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd74970b-pi"><img title="SyntaxNewMethodPython" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewMethodPython" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182d1970c-pi" width="450" height="127" /></a></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd76970b-pi"><img title="SyntaxNewMethodJavaScript" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewMethodJavaScript" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be372970d-pi" width="450" height="127" /></a></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be374970d-pi"><img title="SyntaxNewMethodC  " style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewMethodC  " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd80970b-pi" width="450" height="148" /></a></p>  <p>&#160;</p>  <p>And hereâ€™s the syntax for the isSuppressed property.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182d5970c-pi"><img title="SyntaxNewPropPython" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewPropPython" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd82970b-pi" width="450" height="225" /></a></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be376970d-pi"><img title="SyntaxNewPropJavaScript" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewPropJavaScript" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be378970d-pi" width="450" height="224" /></a></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182d7970c-pi"><img title="SyntaxNewPropC  " style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxNewPropC  " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182d9970c-pi" width="450" height="229" /></a></p>  <p>&#160;</p>  <p>There is also event specific syntax.&#160; A Python example is shown below.&#160; This illustrates fully whatâ€™s needed in order to implement that event.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb085be37a970d-pi"><img title="SyntaxEvent" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="SyntaxEvent" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182db970c-pi" width="450" height="377" /></a></p>  <p>&#160;</p>  <p>You can see all of the new help at the <a href="http://fusion360.autodesk.com/learning/index.html">Fusion Learning Site</a>.&#160; Click the â€œProgramming Interfaceâ€ link and then use the table of contents to access the â€œFusion 360 API Reference Manualâ€ section, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d14182dd970c-pi"><img title="ReferenceManual" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="ReferenceManual" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b7dd86970b-pi" width="252" height="531" /></a></p>  <p>&#160;</p>  <p><strong><font size="3">I Need Your Help        <br /></font></strong>I can use your help with honest opinions about whether this new format is better than the old and then, with whatever format we continue with, suggestions about how to improve it.&#160; I know there is still a lot of room for improvement.&#160; Every time I use and look at the help I see some things that could be improved and I work on some of them in each release, but Iâ€™m sure some of you have some other and better ideas.&#160; Feel free to post comments here or you can also send them directly to me at <a href="mailto:brian.ekins@autodesk.com">brian.ekins@autodesk.com</a>. </p>  <p>-Brian</p>  <p><strong><font size="3"></font></strong></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: MechMachineMan
EMAIL: justin.konecsni@gmail.com
IP: 142.165.62.251
URL: 
DATE: 07/31/2015 05:14:15 PM
I definitely like the old style how it shows the type; it's useful for programming in VBA and VB.net for an "Inventor / WorkFlow-related only" programmer like myself.

Maybe a combination of both would be best? You can't really go wrong with too much information in a topic like, IMO. That being said, it is sometimes difficult to work with samples from the API, and there are a lot of things that don't have samples, so that could be improved.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360 Hackathon (Earn $500)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360-hackathon-earn-500
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/07/fusion-360-hackathon-earn-500.html 
DATE: 07/30/2015 02:30:08 AM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b675f1970b-pi"><img alt="Fusion360Hackathon" border="0" height="234" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7b675f5970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Fusion360Hackathon" width="450" /></a></p>
<p>Weâ€™re still putting the specific details together but I wanted to give some advance warning for a Fusion 360 Hackathon coming up in September.&#0160; This will be an&#0160; online Hackathon that spans several weeks and consists of presentations and lots of online mentoring to help you get your Fusion 360 apps developed and on the <a href="https://apps.exchange.autodesk.com/FUSION/en/Home/Index">Fusion Exchange Store</a>.&#0160; To help encourage you a bit more, if you publish your app on the Exchange store by a defined deadline youâ€™ll get $500.</p>
<p>With the Fusion 360 API supporting add-ins and now with the latest release also supporting C++, and with a $500 incentive, itâ€™s now a great time to begin investigating Fusion to see if Fusion is a viable platform for your app.&#0160; These donâ€™t have to be large full-scale applications but can also be smaller utilities that enhance the use of Fusion 360.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: C++ is Here for Fusion
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-is-here-for-fusion
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/07/c-is-here-for-fusion.html 
DATE: 07/27/2015 10:42:15 PM
-----
BODY:
<p>The latest update for Fusion went out this past weekend so if youâ€™ve run Fusion since then you have it.&#0160; Youâ€™ll now see a new â€œC++â€ option when you create a new script or add-in, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d13e54a5970c-pi"><img alt="FusionC  " border="0" height="401" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0858fe07970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="FusionC  " width="350" /></a></p>
<p>That will create a new C++ project.&#0160; A C++ project consists of a .manifest file, (the same as Python and JavaScript), but also a .cpp file and two project files; a .vcxproj file for Windows and Visual Studio and a .xcodeproj file for Mac and XCode.</p>
<p>The API is the same as whatâ€™s been exposed for Python and JavaScript.&#0160; In fact the Python and JavaScript interfaces are layers on top of the C++ interface.&#0160; Each language has itâ€™s own quirks so the API is used a bit differently for each one but it is the same API. You can read all about the C++ quirks in the <a href="http://fusion360.autodesk.com/learning/learning.html?guid=GUID-ECC0A398-4D89-4776-A054-F7B432F7FCF6">C++ Specific Issues</a> topic in the <strong>Fusion 360 API Userâ€™s Manual.</strong></p>
<p>Some highlights of the C++ API are:</p>
<ul>
<li>You can now deliver your applications as a binary file instead of source code.</li>
<li>You now have a typed language which means youâ€™ll be able to user reliable Intellisense (code hints) when writing your program.&#0160; This is a huge benefit and means youâ€™ll spend a lot less time in the documentation looking to see what methods and properties a certain object supports and what the arguments are for a particular function.</li>
<li>Performance is much better than Python and JavaScript.</li>
<li>You get to use a development environment youâ€™re already familiar with.</li>
</ul>
<p>Probably the biggest downside is that because youâ€™re delivering the runtime binary, you have to compile your code separately for Windows and Mac.&#0160; Except in cases where youâ€™re using Windows or Mac specific libraries you should be able to have a single set of source but youâ€™ll need to compile it on Windows to create the Windows compatible .dll file and then also compile it on a Mac to create a Mac compatible .dylib file.</p>
<p>You can post any comments (positive or negative) or problems you have to the <a href="http://forums.autodesk.com/t5/api-and-scripts/bd-p/22">Fusion 360 API forum</a>, where Iâ€™ll be watching.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Tracking API wishes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: tracking-api-wishes
CATEGORY: Adam
CATEGORY: Fusion 360
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/07/tracking-api-wishes.html 
DATE: 07/25/2015 02:22:24 AM
-----
BODY:
<p><strong>IdeaStation</strong>&#39;s are&#0160;a good idea for tracking wishes. This way people can also see ideas that they too thought of, but did not actually log in the end thinking that not many people would care about them. Now they just have to give a thumbs up :)<br />- <a href="http://forums.autodesk.com/t5/ideas/v2/ideaexchangepage/blog-id/v1232/" target="_self"><strong>Inventor</strong> IdeaStation<br /></a>- <a href="http://forums.autodesk.com/t5/fusion-360-ideastation-request-a/idb-p/125" target="_self"><strong>Fusion</strong> IdeaStation</a></p>
<p>Though they were mainly created for product wishes, I do not see why they could not also be used for <strong>API</strong> wishes - and some people are using them for that already.</p>
<p>If you plan to log there an <strong>API</strong> wish then please use the <strong>API-iLogic</strong> category add a <strong>tag</strong> that would make it easier to track those kinds of wishes: <strong>InventorApi</strong> for <strong>Inventor</strong> <strong>API</strong> wishes, and <strong>FusionApi</strong> for <strong>Fusion</strong> <strong>API</strong> wishes. If it simply has an <strong>API</strong> tag and you click on it then it shows the wishes for all the products.<br />Note: I use <strong>InventorApi</strong> instead of <strong>InventorAPI</strong>, because for some reason the system automatically turns the tag name into that. :-/</p>
<p>I already added those tags to most <strong>API</strong> wishes:<br />- <a href="http://forums.autodesk.com/t5/tag/InventorApi/tg-p" target="_self" title="">http://forums.autodesk.com/t5/tag/InventorApi/tg-p</a><br />- <a href="http://forums.autodesk.com/t5/tag/FusionApi/tg-p/board-id/125" target="_self" title="">http://forums.autodesk.com/t5/tag/FusionApi/tg-p/board-id/125</a>&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Adam Nagy
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adam-nagy

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/adam-nagy.html 
DATE: 07/21/2015 07:13:35 PM
-----
BODY:
<p>Adam joined Autodesk back in 2005 and has been providing programming support, consulting, training and evangelism to external developers.</p>
<p>He started his career in Budapest, then worked in Prague for 3 years and now lives in South England, UK.</p>
<p>At the moment focusing on the MFG products, plus cloud and mobile related technologies.</p>
<p>Adam has a degree in Software Engineering and has been working in that area since even before leaving college.</p>
<p>If you don't find him in front of the computer then he's most likely playing the piano, doing some sports or dancing argentine tango somewhere.</p>
<p>View posts by <a href="http://modthemachine.typepad.com/adam-nagy/">Adam</a>.</p>
<p><a title="https://twitter.com/AdamTheNagy" class="asset-img-link" style="display: inline;" href="https://twitter.com/AdamTheNagy" target="_self"><img class="asset  asset-image at-xid-6a0167607c2431970b01a73d99353a970d img-responsive" title="Jpeg" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d99353a970d-800wi" alt="Jpeg" border="0" /></a>&nbsp; <a title="http://www.linkedin.com/in/adamnagy" class="asset-img-link" style="display: inline;" href="http://www.linkedin.com/in/adamnagy" target="_self"><img class="asset  asset-image at-xid-6a0167607c2431970b01a73d99354f970d img-responsive" title="Jpeg-2" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d99354f970d-800wi" alt="Jpeg-2" border="0" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
akn_exclude
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adam.nagy@autodesk.com
TITLE: Fusion app paths
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-app-paths
CATEGORY: Adam
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/07/fusion-app-paths.html 
DATE: 07/21/2015 12:54:43 PM
-----
BODY:
<p>If you are developing apps for the&#0160;<a href="https://apps.exchange.autodesk.com/FUSION/en/Home/Index" target="_self">Fusion app store</a> then it could be useful to know where exactly <strong>Fusion</strong> is looking for add-in bundles to load, so that you can test the loading on your side. To see what a <strong>.bundle</strong> should contain you can just download any of the free apps&#0160;from the Fusion app store.&#0160;<br /><strong>Note</strong>: on <strong>MacOS</strong> you have to right-click the <strong>.bundle</strong> folder and select <strong>Show Package Contents</strong> to see what&#39;s inside it:<br /><br /> <a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d13ad9f1970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Bundle" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d13ad9f1970c img-responsive" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d13ad9f1970c-320wi" title="Bundle" /></a></p>
<p>The <strong>Windows</strong> and <strong>MacOS</strong> file structure is different so the <strong>add-in</strong> folder locations will be different. But on&#0160;<strong>MacOS</strong> we also have two install types of <strong>Fusion</strong>:<br />- web install<br />- Mac App Store (<strong>MAS</strong>) install</p>
<p>All <strong>MAS</strong> apps run in a sandbox environment, and they cannot load additional modules from outside their folder structure without user interaction. That&#39;s why the <strong>MAS</strong> version of <strong>Fusion</strong> is using a different path for <strong>Fusion</strong> apps.</p>
<p><strong>Windows</strong>: <br />%APPDATA%\Autodesk\ApplicationPlugins<br /><br /><strong>MacOS web install</strong>:<br />~/Library/Application Support/Autodesk/ApplicationPlugins&#0160;</p>
<p><strong>MacOS MAS install</strong>: <br />~/Library/Containers/com.autodesk.mas.fusion360/Data/Library/Application Support/Autodesk/ApplicationPlugins&#0160;</p>
<p><strong>Note</strong>: if you want to use the above paths inside a script on <strong>MacOS</strong>, you need to deal with the spaces in folder names - e.g. in <strong>/Application Support/</strong>. Unlike in <strong>Windows</strong>, here you cannot put the whole string between apostrophes, because then the special character &#39;<strong>~</strong>&#39;&#0160;(which means the current user&#39;s folder) would not get resolved. So either you can just escape each space character in the string with a backslash &#39;<strong>\</strong>&#39; e.g.:<br />~/Library/<strong>Application\ Support</strong>/Autodesk/ApplicationPlugins<br />... or put the part after the &#39;<strong>~</strong>&#39; character between apostrophes: &#0160;<br />~&#39;<strong>/Library/Application Support/Autodesk/ApplicationPlugins</strong>&#39;&#0160;</p>
<p>-Adam</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: One Million Downloads on Autodesk Exchange
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: one-million-downloads-on-autodesk-exchange
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/06/one-million-downloads-on-autodesk-exchange.html 
DATE: 07/01/2015 02:27:08 AM
-----
BODY:
<p><a href="http://inthefold.autodesk.com/in_the_fold/2015/06/autodesk-exchange-apps-store-reaches-1-million-downloads.html"><img alt="OneMillion" border="0" height="110" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb084b68bc970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="OneMillion" width="483" /></a></p>
<p>The <a href="https://apps.exchange.autodesk.com/en">Autodesk Exchange</a> store has now had over one million apps downloaded.&#0160; By chance, the one millionth app happened to be for Inventor.&#0160; You can read more about it and how customers are using the store in the <a href="http://inthefold.autodesk.com/in_the_fold/2015/06/autodesk-exchange-apps-store-reaches-1-million-downloads.html">official announcement</a>.</p>
<p>The <a href="https://apps.exchange.autodesk.com/INVNTOR/en/Home/Index">Inventor store</a> now has 206 apps available.&#0160; With the continued work on Fusion 360 and itâ€™s API, itâ€™s now also feasible to begin writing apps for Fusion.&#0160; The first few are now available on the <a href="https://apps.exchange.autodesk.com/FUSION/en/Home/Index">Fusion 360 store</a>.</p>
<p>Many of these apps have been developed by readers of this blog and I want to thank you for helping to make Autodesk Exchange a success and would like to encourage you to keep creating apps that will help to make Inventor and Fusion 360 customers more successful.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Jump Start your Fusion Development
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: jump-start-your-fusion-development
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/04/jump-start-your-fusion-development.html 
DATE: 04/14/2015 09:24:34 PM
-----
BODY:
<p>Autodesk recently finished the first ever Cloud Accelerator where several companies were selected to come into the San Francisco office to work on their applications, which use the Autodesk cloud technology in some way.&#0160; They were able to work directly with the ADN and clout teams to accelerate the development of their applications.&#0160;</p>
<p>The first event was so successful, there has been another one scheduled for June 1-12.&#0160; With the addition of add-ins, itâ€™s now possible to create applications for Fusion and this is a great opportunity for you to quickly get up to speed.&#0160; The deadline for applications is April 19th, so itâ€™s quickly approaching.&#0160; It would be great to work with some Fusion developers during the event.</p>
<p>You can learn more at the <a href="http://autodeskcloudaccelerator.com/">Autodesk Cloud Accelerator</a> site.</p>
<p>Here are some highlights from the last event.</p>
<p><iframe allowfullscreen="allowfullscreen" frameborder="0" height="315" src="https://www.youtube.com/embed/a8Y5aF5RbTA" width="560"></iframe></p>
<p>And a link to <a href="https://www.youtube.com/channel/UC6Fl_1mFNt0rBqa068Vaxcg">several more videos</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Looking for a Vacation? How about Myanmar?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: looking-for-a-vacation-how-about-myanmar
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/04/looking-for-a-vacation-how-about-myanmar.html 
DATE: 04/03/2015 11:15:30 PM
-----
BODY:
<p>This is totally off the topic of the Inventor or Fusion APIâ€™s but I wanted to let you know about one of the best vacations Iâ€™ve ever had.&#0160; In February of 2014, I spent almost three weeks with my wife touring around Myanmar.&#0160; Myanmar used to be called Burma and is in Southeast Asia bordering Thailand, China, Bangladesh, India, and Laos.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0815e77f970d-pi"><img alt="Myanmar" border="0" height="269" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0815e785970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Myanmar" width="454" /></a></p>
<p>The country has had an <a href="http://en.wikipedia.org/wiki/Burma">interesting history</a> and now appears to be emerging from a 50 year military dictatorship although the military still has a lot of control.&#0160; Tourism has just opened up in the past few years and the people there are very happy for people from outside to visit and see their country.&#0160; The people are extremely gracious and interacting with and getting to know some of them was a major highlight of the trip.&#0160;</p>
<p>I planned the trip based on information I got from books, the internet, and a friend who had recently been.&#0160; We traveled on our own and went with a fairly flexible itinerary and adjusted a few things as we went along.&#0160; I put together a video to help remind us of the highlights of the trip but hopefully it lets you see what an interesting country this is.&#0160; I highly recommend a visit.&#0160; There arenâ€™t too many places you can go in the world anymore and not see a McDonalds or Starbucks.</p>
<p><iframe allowfullscreen="allowfullscreen" frameborder="0" height="315" src="https://www.youtube.com/embed/rOc0RpFd2JE" width="560"></iframe></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Maria
EMAIL: mariastefen00@yahoo.in
IP: 115.118.151.234
URL: http://bathroomideasdesignsdecors.com/
DATE: 05/07/2015 02:13:56 PM
 Good that its a tourist friendly country now. Its not easy travelling without planning especially in days where we have very less time.
-----
COMMENT:
AUTHOR: David Gustavson
EMAIL: dbg@SCIzzL.com
IP: 24.6.171.33
URL: 
DATE: 06/03/2015 12:54:48 AM
You sound like someone who would enjoy the Friendship Force. It's based on exchanges where you stay with a family for a week, long enough to get to know one another. There are hundreds of FF clubs around the world, and exchanges are between pairs of clubs, so you're in a small group rather than completely alone. That's got both pluses and minuses, of course, but I think the pluses dominate. The SF Bay Area club (mine) is at <a href="http://FFSFBA.org,">http://FFSFBA.org,</a> and the international organization that does the scheduling is at <a href="http://friendshipforce.org/">http://friendshipforce.org/</a>
Thanks for telling about Myanmar!
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Corrections/Clarification to Webinar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: correctionsclarification-to-webinar
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/correctionsclarification-to-webinar.html 
DATE: 03/31/2015 05:40:02 PM
-----
BODY:
<p>I recently posted about the <a href="http://modthemachine.typepad.com/my_weblog/2015/03/fusion-360s-api-webinar.html">Fusion API Webinar</a> and want to correct and clarify a few things I said during the presentation and in the questions after.</p>
<ol>
<li>When showing the slides comparing the JavaScript and Python code I mentioned that JavaScript is pickier about types and sometimes requires type casting.&#0160; This is not true.&#0160; There was an issue in a very early version of the API where it did require type casting but that was a Fusion API issue and not a JavaScript issue and has long since been addressed.&#0160; Iâ€™ve updated the PowerPoint slides to remove the casting line.</li>
<li>It was asked if you could begin a debug session into a running JavaScript add-in and replied that I didnâ€™t believe it was possible.&#0160; Iâ€™ve since learned about a capability that I didnâ€™t know about that does allow you to debug into a running JavaScript add-in or script.&#0160; From the <strong>Scripts and Add-Ins</strong> dialog you can see which scripts and add-ins are currently running by looking for the running symbol next to the name as Iâ€™ve highlighted below.&#0160; When you select a running JavaScript program, the Debug button will be enabled, as shown below.&#0160; This will open a window and allow you to begin debugging the running script. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c76f5f08970b-pi"><img alt="EditJavaScript" border="0" height="342" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb081354b8970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="EditJavaScript" width="420" /></a></li>
<li>I also mentioned TkInter as a way to create custom dialogs when using Python but that there are currently problems when using it on a Mac.&#0160; This is true but I want to clarify that itâ€™s not a Fusion 360 API issue in this case but is a <a href="https://www.python.org/download/mac/tcltk/">general problem with TkInter (Tcl/Tk specifically) on Mac</a>.&#0160; Weâ€™ve attempted to find a combination of libraries that works but so far have been unsuccessful.</li>
</ol>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fusion 360&rsquo;s API Webinar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fusion-360s-api-webinar
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/fusion-360s-api-webinar.html 
DATE: 03/25/2015 10:05:13 PM
-----
BODY:
<p>This morning, here in slightly rainy Oregon, I presented a webinar about the Fusion 360 API.&#0160; For those of you that missed it, the entire presentation is now available on YouTube and you can also download the <a href="http://modthemachine.typepad.com/FusionAPI.pptx">PowerPoint slides</a> that I used for the presentation.&#0160;</p>
<p><iframe allowfullscreen="allowfullscreen" frameborder="0" height="259" src="https://www.youtube.com/embed/g0xWqLen7gI" width="460"></iframe></p>
<p>&#0160;</p>
<p>You can learn more about the <a href="http://fusion360.autodesk.com/">Fusion 360</a> product and also install it to get a better understanding of how it works and what it can do. I welcome any comments about the API at the <a href="http://forums.autodesk.com/t5/api-and-scripts/bd-p/22">Fusion 360 API and Scripts forum</a>.</p>
<p>There are also <a href="http://modthemachine.typepad.com/my_weblog/2015/03/correctionsclarification-to-webinar.html">corrections and additional information</a> available about this webinar.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Bathroom Vanity
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: bathroom-vanity
CATEGORY: Brian
CATEGORY: Woodworking

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/bathroom-vanity.html 
DATE: 03/24/2015 03:00:00 PM
-----
BODY:
<p>I previously made a <a href="http://modthemachine.typepad.com/my_weblog/2010/02/woodworking-board-layout.html">post</a> about a some VBA code I had written to help layout the boards from a woodworking project so I could create cut sheets.&#0160; I just looked up that post and couldnâ€™t believe it was almost five years ago.&#0160;</p>
<p>In that post I had an image of a bathroom vanity that I had started to design and used as the example.&#0160; I did complete the design in Inventor and finally finished building it a few months ago.&#0160; Here are some images of the final project.&#0160; Having the CAD model helped a lot in laying out the curved legs and matching the curves on the door and drawer fronts.&#0160; I didnâ€™t do anything in Inventor for the handles but sketched them out and hand carved them.&#0160; These pictures arenâ€™t the greatest, but Iâ€™m happy with how it turned out.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f23c02970c-pi"><img alt="IMG_4659" border="0" height="604" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c768ace4970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="IMG_4659" width="454" /></a></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f23c07970c-pi"><img alt="IMG_4660" border="0" height="363" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c768ace8970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="IMG_4660" width="454" /></a></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f23c0b970c-pi"><img alt="IMG_4655" border="0" height="604" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c768acec970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="IMG_4655" width="454" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Luke Davenport
EMAIL: luke.davenport@cadline.co.uk
IP: 62.232.45.170
URL: http://www.cadlinecommunity.co.uk
DATE: 03/25/2015 09:12:07 AM
Very nice Brian. Good skills
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: 
IP: 195.230.112.224
URL: http://profile.typepad.com/6p017c31afd964970b
DATE: 03/26/2015 04:35:34 PM
What a great model of water-mixer!
Could you share model number?
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.72.146
URL: http://profile.typepad.com/1218580234s15464
DATE: 03/26/2015 04:51:26 PM
The brand of the sink and faucet is Kraus.  I believe this is a link to the model I used but they have many different styles.

<a href="http://www.kraususa.com/c-gv-100-12mm-10ch-crystal-clear-glass-vessel-sink-and-waterfall-faucet-chrome-1.html">http://www.kraususa.com/c-gv-100-12mm-10ch-crystal-clear-glass-vessel-sink-and-waterfall-faucet-chrome-1.html</a>
-----
COMMENT:
AUTHOR: Dances With Elephants
EMAIL: jim.quanci@autodesk.com
IP: 132.188.64.149
URL: http://profile.typepad.com/6p014e8bc6e339970d
DATE: 03/27/2015 06:38:09 PM
Its beautiful!  When technology meets craftmanship... in the hands of a software engineer who is also a craftsman... :-)
-----
COMMENT:
AUTHOR: Dru
EMAIL: tonofsteel@hotmail.com
IP: 184.70.60.166
URL: 
DATE: 04/07/2015 05:26:44 PM
This looks great!  Good job!

I have been looking into modelling woodworking projects with Inventor and other than the CadSetterOut blog I have not been able to find too many detailed posts on the actual process.

Since you modeled this in Inventor would it be at all possible to have a ModTheMachine post with some details on how to go about creating something similar (including the types of joints etc. that would be applicable?)

That may be asking a lot but it would be very informative and useful!  (Please?)
-----
COMMENT:
AUTHOR: Maria
EMAIL: mariastefen00@yahoo.in
IP: 115.118.177.37
URL: http://bathroomideasdesignsdecors.com/
DATE: 05/05/2015 05:08:10 PM

Nicely done bathroom vanity, good craftsmanship!!. Made from a blueprint your had previously. The platform is also having good texture, the basin looks different, a good functional vanity, cool it is!!

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.149
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/13/2015 02:29:22 AM
I definitely don't claim to be a woodworking expert so I'm not sure what I've done is the best example.  I've found that I learn a lot with each project and there are also things I would change with each one if I could do it over again.

One of the main joints I used in connecting the cabinet together was pocket holes.  I've used those and biscuit joints in quite a bit of work that I've done.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Join Me for the Fusion 360 API Webinar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: join-me-for-the-fusion-360-api-webinar
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/join-me-for-the-fusion-360-api-webinar.html 
DATE: 03/23/2015 06:14:37 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7697678970b-pi"><img alt="WebinarImage" border="0" height="329" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb080d700f970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="WebinarImage" width="470" /></a></p>
<p>The webinar is coming up later this week and I hope youâ€™ll join me for a brief introduction to the Fusion 360 API.&#0160; Here are some of the things Iâ€™ll be explaining and demonstrating:</p>
<ul>
<li>The languages supported and choosing a language</li>
<li>Scripts and the new add-in functionality</li>
<li>Creating a new script or add-in</li>
<li>The Fusion 360 Object Model</li>
<li>Debugging scripts and add-ins</li>
<li>Fusion 360 API Documentation</li>
</ul>
<p>The webinar is on March 25 at 9:00 AM Pacific time and thereâ€™s still time to register.&#0160; To attend , please register for <strong>Get started with Fusion 360 API</strong> at: <br /><a href="https://attendee.gotowebinar.com/register/7034449259570533633">https://attendee.gotowebinar.com/register/7034449259570533633</a> <br />After registering, you will receive a confirmation email containing information about joining the webinar.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Latest Update to Sheet Metal Extents Add-In
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: latest-update-to-sheet-metal-extents-add-in
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Sheet Metal

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/latest-update-to-sheet-metal-extents-add-in.html 
DATE: 03/21/2015 12:39:17 AM
-----
BODY:
<p>Several years ago I wrote an add-in that creates custom iProperties and parameters that contain the length and width of the flat pattern.&#0160; (Actually it creates the parameters and sets the â€œExport Parameterâ€ setting so Inventor will automatically created the iProperties.)&#0160; It also creates an iProperty with the name of the sheet metal style.&#0160; There had been a couple of problems reported and everything that Iâ€™m aware of has now been fixed.</p>
<p>I know there are several people making use of this add-in but since I originally wrote it Inventor has added additional new native capabilities that should eliminate the need for my add-in in many cases.&#0160; One of these capabilities, thatâ€™s not widely known, is the ability to define expressions for parameter values.&#0160; This is demonstrated in the picture below where the value of the iProperty named â€œSheetMetalWidthâ€œ has the value â€œ=&lt;Sheet Metal Width&gt;â€.&#0160; The name can be anything but the value is important. The â€œ=â€ sign signifies that the iProperty value is an expression and the â€œ&lt;&gt;â€ sign wraps around a known name.&#0160; In this example Iâ€™m using â€œSheet Metal Widthâ€ and â€œSheet Metal Lengthâ€ as the known names.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c767be4b970b-pi"><img alt="SheetMetalWidth" border="0" height="324" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c767be4f970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="SheetMetalWidth" width="461" /></a></p>
<p>&#0160;</p>
<p>You can also create a single parameter that combines several values in the expression such as â€œ=&lt;Sheet Metal Length&gt; x &lt;Sheet Metal Width&gt;â€, which results in the value of the iProperty named â€œFull Sizeâ€ as shown below.&#0160; You can also use the names of iProperties in expressions to create the other example shown below where Iâ€™ve used the iProperties â€œTitleâ€ and â€œAuthorâ€ to create the iProperty named â€œNew Titleâ€.&#0160; The value of the Title property in that document is â€œExtent Sampleâ€ and Author is my name.&#0160; When you edit iProperties that use a function, by default the result is shown in the Value field but clicking the â€œfxâ€ button to the right of the field will display the original expression and allow you to edit it.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f1539b970c-pi"><img alt="SheetMetalExtents" border="0" height="338" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f1539f970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="SheetMetalExtents" width="462" /></a></p>
<p>&#0160;</p>
<p><span style="font-size: medium;"><strong>Installing Sheet Metal Extents Add-In</strong></span></p>
<p>If you still want to use my add-in you should first uninstall any existing Sheet Metal Extents add-ins you might have installed.&#0160; If you installed it using an installer then you can uninstall it using the standard uninstall tool.&#0160; If it was installed some other way you can manually delete it.&#0160; To know what to delete, open the Add-In Manager, choose the Sheet Metal Extents add-in and look at the folder in the location field at the bottom, as shown below.&#0160; You can delete the entire â€œSheet Metal Extentsâ€ folder in the ApplicationPlugins folder.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c767be51970b-pi"><img alt="SheetMetalExtentsDelete" border="0" height="419" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c767be55970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="SheetMetalExtentsDelete" width="426" /></a></p>
<p>&#0160;</p>
<p>To install the new add-in download and install the add-in from the link below:</p>
<blockquote>
<p><a href="http://modthemachine.typepad.com/SheetMetalExtentsInstall.exe">Sheet Metal Extents 3.5</a></p>
</blockquote>
<p>After youâ€™ve installed the new add-in you can verify you have the latest version by looking in the Add-In Manager again and checking that the add-in has the name â€œSheet Metal Extents 3.5â€ as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0f153a1970c-pi"><img alt="SheetMetalVersion" border="0" height="208" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb080bb430970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="SheetMetalVersion" width="426" /></a></p>
<p>&#0160;</p>
<p>If you find any problems or have suggestions for improvement, please let me know at <a href="mailto:brian.ekins@autodesk.com">brian.ekins@autodesk.com</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Latest Version of Fusion Introduces Add-Ins
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: latest-version-of-fusion-introduces-add-ins
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/03/latest-version-of-fusion-introduces-add-ins.html 
DATE: 03/16/2015 10:49:37 PM
-----
BODY:
<p>The version of Fusion that went out this past weekend has a lot of new features but for the API the most important is the introduction of add-in support.&#0160; Previously there was only support for scripts.&#0160; Thereâ€™s not a big difference between a script and an add-in but that small difference makes a huge difference in how itâ€™s seen and used by the user.</p>
<p>A script is run by the user by executing the â€œScripts and Add-Insâ€ command from the File menu, choosing the script they want to run, and clicking the â€œRunâ€ button.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08085797970d-pi"><img alt="ScriptRunning" border="0" height="313" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0edc8c6970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="ScriptRunning" width="377" /></a></p>
<p>&#0160;</p>
<p>An add-in has the option to be loaded automatically when Fusion starts.&#0160; Taking advantage of this small difference, an add-in can use the API to create commands and add them to the Fusion user-interface.&#0160; The add-inâ€™s commands appear to the user like any other Fusion command.&#0160; Unless explicitly unloaded by the user, the add-in remains running in the background throughout the Fusion session so it can respond whenever any of its commands are run and do whatever that command is supposed to do.</p>
<p>The dialog below shows the new dialog for creating a new add-in or script.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0808579b970d-pi"><img alt="NewAddIn" border="0" height="447" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7644e6d970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="NewAddIn" width="410" /></a>&#0160;</p>
<p>For this release there are four new topics in the <a href="http://fusion360.autodesk.com/resources">Fusion API help</a> that discuss add-ins and some related technology, that although isnâ€™t exclusive to add-ins is more important for a typical add-in workflow.&#0160; These new topics are shown in the picture below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7644e71970b-pi"><img alt="FusionNewHelp" border="0" height="719" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c7644e79970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="FusionNewHelp" width="314" /></a></p>
<p>&#0160;</p>
<p>Add-ins also make it easier to give your program to someone else, either by giving them the add-in files or package it into an installer.&#0160; The files can simply be copied to the correct location on the users machine and Fusion will automatically find the add-in and load it the next time is starts.&#0160; An installer does the same thing but simplifies the copy process.&#0160; The next time Fusion is started, the new commands added by the add-in are immediately available to the user.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Scott Moyse
EMAIL: Scott.M@cadpro.co.nz
IP: 203.109.145.2
URL: 
DATE: 03/17/2015 01:15:03 AM
VERY COOL! I wonder if this would be possible if Fusion 360 was ran within a browser?
-----
COMMENT:
AUTHOR: Bisnis Ibu Rumah Tangga
EMAIL: 
IP: 199.115.117.235
URL: http://profile.typepad.com/6p01b7c7864be8970b
DATE: 05/07/2015 06:50:34 AM
This is very cool blog!

Bisnis ibu rumah tangga
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Upcoming Fusion 360 API Webinar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: upcoming-fusion-360-api-webinar
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/02/upcoming-fusion-360-api-webinar.html 
DATE: 02/17/2015 06:37:43 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb07f28cc6970d-pi"><img alt="FusionWebinar" border="0" height="379" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c74edc9f970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="FusionWebinar" width="488" /></a></p>
<p>Are you using Fusion 360 or just curious about it?&#0160; Itâ€™s API is still relatively new and is growing significantly with each frequent release.&#0160; This webinar will discuss the programming capabilities of Fusion, including the new Add-In functionality that is coming and will be available by the Webinar.</p>
<p>The webinar is on March 25 at 9:00 AM Pacific time.&#0160; To attend the webinar, please register for <strong>Get started with Fusion 360 API</strong> at: <br /> <br /><a href="https://attendee.gotowebinar.com/register/7034449259570533633">https://attendee.gotowebinar.com/register/7034449259570533633</a> <br /> <br />After registering, you will receive a confirmation email containing information about joining the webinar.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Meningkatkan Percaya Diri
EMAIL: wipud@landmail.co
IP: 202.62.16.131
URL: http://pondokperubahan.com/category/cara-percaya-diri/
DATE: 05/07/2015 04:36:32 AM
Wow, already late for the webinar. Thanks anyway for this info.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Keep Your Interop Up to Date
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: keep-your-interop-up-to-date
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/01/keep-your-interop-up-to-date.html 
DATE: 01/22/2015 06:19:42 PM
-----
BODY:
<p>I just finished working with a customer that was having a problem accessing certain functionality in the API.&#0160; He had written an initial prototype in VBA that worked as expected but then when he started to convert the program to .Net some of the Inventor API objects he was using werenâ€™t available.&#0160; The reason is that he was using an old .Net <em>interop</em>.</p>
<p>The Inventor API is exposed using Microsoftâ€™s COM technology.&#0160; The contents of the API (itâ€™s objects, methods, properties, and events) are described in a file known as a type library.&#0160; When you use VBA it directly references this type library to know whatâ€™s in Inventorâ€™s API and uses this to support Intellisense and to be able to compile and run the program.&#0160; VB.Net and C# are .Net based languages and donâ€™t support directly calling a COM API.&#0160; To provide support for COM APIâ€™s .Net supports the creation of an interop library that serves as a translation layer between COM and .Net. The Interop provides the same functionality to VB.Net or C# that the type library does to VBA.&#0160; It describes all of the objects and functions in the Inventor API and converts the .Net API call into a native COM call.&#0160; As of the last few .Net releases this technology works very good and in almost all cases makes it completely transparent that youâ€™re not working directly with the COM API.</p>
<p>When you create a new .Net or C# program to work with Inventor you need to add a reference to Inventorâ€™s COM interop in order to have access to the API.&#0160; You do this by using the <strong>References</strong> command in Visual Studio.&#0160; In the dialog, use the â€œBrowseâ€ option to the left and then click the â€œBrowseâ€¦â€ button at the bottom of the dialog.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb07e0469e970d-pi"><img alt="InteropAddReference" border="0" height="194" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0c62153970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="InteropAddReference" width="504" /></a>&#0160;</p>
<p>Browse to â€œC:\Programs Files\Autodesk\Inventor XXXX\Bin\Public Assembliesâ€, (where XXXX is the version of Inventor you want to use) and select â€œautodesk.inventor.interop.dllâ€.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0c62157970c-pi"><img alt="InteropPickAssembly" border="0" height="272" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c73c8e93970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="InteropPickAssembly" width="504" /></a></p>
<p>&#0160;</p>
<p>Your program is now dependent on the interop for that version of Inventor.&#0160; Letâ€™s say that you create a reference to Inventor 2014 and then later you uninstall Inventor and install Inventor 2015.&#0160; The API is backward compatible so when you installed Inventor 2015 it installed the interop for 2015 but also installed interops for several previous versions so programs dependent on those older version will still continue to work.&#0160; But it your program needs to use some functionality that is new in Inventor 2015 you need to change the reference to the newer interop where this new functionality is defined.</p>
<p>You can see what references an existing program has in the Solution Explorer in Visual Studio.&#0160; By default theyâ€™re not shown but by clicking the â€œShow All Filesâ€ button a new â€œReferencesâ€ folder will appear in the tree, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb07e046a7970d-pi"><img alt="InteropShowReferences" border="0" height="395" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c73c8e97970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="InteropShowReferences" width="282" /></a></p>
<p>&#0160;</p>
<p>You can see more information about a specific reference by selecting it and looking in the Properties window, as shown below.&#0160; In this case Iâ€™ve selected the â€œautodesk.inventor.interopâ€ and itâ€™s showing me that itâ€™s version 19.0.0.0.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb07e046ae970d-pi"><img alt="InteropShowVersion" border="0" height="340" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c73c8e9b970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="InteropShowVersion" width="504" /></a></p>
<p>&#0160;</p>
<p>The version numbers are confusing because they donâ€™t directly correlate with the public version of Inventor.&#0160; Hereâ€™s a table showing the public version, the corresponding software version, and the internal development name.</p>
<div style="text-align: center;">
<table align="center" border="1" cellpadding="2" cellspacing="0" width="399">
<tbody>
<tr>
<td align="center" valign="top" width="137"><strong>Public Version</strong></td>
<td align="center" valign="top" width="142"><strong>Software Version</strong></td>
<td align="center" valign="top" width="118"><strong>Internal Name</strong></td>
</tr>
<tr>
<td align="center" valign="top" width="137">2011</td>
<td align="center" valign="top" width="142">15</td>
<td align="center" valign="top" width="119">Sikorsky</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2012</td>
<td align="center" valign="top" width="142">16</td>
<td align="center" valign="top" width="120">Brunel</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2013</td>
<td align="center" valign="top" width="141">17</td>
<td align="center" valign="top" width="120">Goodyear</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2014</td>
<td align="center" valign="top" width="141">18</td>
<td align="center" valign="top" width="120">Franklin</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2015</td>
<td align="center" valign="top" width="141">19</td>
<td align="center" valign="top" width="120">Dyson</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2016</td>
<td align="center" valign="top" width="142">20</td>
<td align="center" valign="top" width="121">Shelby</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2017</td>
<td align="center" valign="top" width="142">21</td>
<td align="center" valign="top" width="121">Enzo</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2018</td>
<td align="center" valign="top" width="142">22</td>
<td align="center" valign="top" width="121">Elon</td>
</tr>
<tr>
<td align="center" valign="top" width="136">2019</td>
<td align="center" valign="top" width="142">23</td>
<td align="center" valign="top" width="121">Zora</td>
</tr>
</tbody>
</table>
</div>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: David Truyens
EMAIL: 
IP: 84.196.109.79
URL: http://profile.typepad.com/truyens
DATE: 01/23/2015 08:13:16 AM
Thanks Brian,

Your the master!! It's working now :-)
-----
COMMENT:
AUTHOR: Katie Miller
EMAIL: kmiller@coldspringusa.com
IP: 24.56.144.131
URL: 
DATE: 05/07/2015 10:18:48 PM
I would like to know what the difference is between linking to the interop under Program files or the interop under C:\Windows\Microsoft.NET\..\... etc.. and should we use one over the other?
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.149
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/13/2015 12:32:55 AM
The interops in the GAC (C:\Windows\Microsft.NET\Assembly\...) are intended to be private and you should always reference the one in the "Inventor\Public Assemblies" directory.  Previously, Visual Studio wouldn't allow you to directly reference interops in the GAC but it doesn't block it anymore.  When you reference a primary interop outside the GAC but it also exists in the GAC, .NET is able to find the one in the GAC and use it.  So for example, let's say you create a program using Inventor 2015 and reference the interop in its "Public Assemblies" folder.  Then someone uses that program on a machine that only has Inventor 2016.  You're program will still work because .NET finds the 2015 version in the GAC and uses it.  Inventor installs several version of the primary interop into the GAC to support programs written against older versions of Inventor.
-----
COMMENT:
AUTHOR: Katie Miller
EMAIL: kmiller@coldspringusa.com
IP: 69.40.72.114
URL: 
DATE: 05/13/2015 01:37:18 PM
Awesome!  Thanks for the Guidance!  Always great chatting with you!
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Intern Wanted
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: intern-wanted
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2015/01/intern-wanted.html 
DATE: 01/08/2015 08:12:53 PM
-----
BODY:
<p>Are you or someone you know currently pursuing a bachelorâ€™s or masterâ€™s in Computer science or a discipline with a strong computing component? Are you looking for a life changing Internship experience during your summer? Look no more, Autodesk Developer Network is looking for an enthusiastic intern evangelist for this summer in the Bay Area. If youâ€™re excited by design, and by working with 3D on the web then keep reading.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c731d400970b-pi"><img alt="internshipworddle" border="0" height="297" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c731d402970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="internshipworddle" width="438" /></a></p>
<p>You&#0160; will start by learning the API and developing a plan for writing your sample application(s), which you will then implement. As you progress you will be blogging about your experiences using the API so others can follow in your steps. The finished samples will be posted to our public GitHub account and used by our Developer Evangelists around the world to showcase the API capabilities. There may be opportunities to attend hackathons, meetups and conferences as a sponsor to help spread the word about these amazing APIs.</p>
<p>In short, your task will be to have as much fun as possible doing cool things with our APIs â€“ and then telling other people about the cool stuff youâ€™ve done.</p>
<p>If you are up for the challenge and this sounds like you, <a href="https://autodesk.taleo.net/careersection/adsk_cmp/jobdetail.ftl?job=14WD17104">APPLY TODAY</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: DevDays 2014
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: devdays-2014
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/11/devdays-2014.html 
DATE: 11/06/2014 06:34:26 PM
-----
BODY:
<p>The ADN team has already started the 2014 series of worldwide ADN conferences. There are presentations at 16 cities around the world beginning now and continuing through January.&#0160;</p>
<p>Iâ€™ll be at the DevDays conference the Monday before Autodesk University at Las Vegas and welcome the opportunity to meet you and see what youâ€™ve been working on.&#0160; Besides the event on Monday there is also a DevHack programming workshop on Tuesday from 1:00 pm â€“ 5:30 pm.&#0160; You can spend an afternoon or a few hours getting help with your code or programming with Autodesk staff and fellow ADN members.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d08bc0f1970c-pi"><img alt="DevDays2b" border="0" height="307" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d08bc0f5970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="DevDays2b" width="500" /></a></p>
<p>The theme this year is <span style="color: #ffc000;"><strong>10x</strong></span></p>
<p>&#0160;</p>
<p>Join us at DevDays 2014 to learn how you can take advantage of new technologies to grow your business reach by a factor of ten.</p>
<p>Our annual DevDays events have always been the best way that our Autodesk Developer Network partners keep up to date with new and upcoming technology and features. This time we&#39;re showing you how to leverage what Autodesk is doing so that you can expand your customer base with new technology and new customers.</p>
<p>If you are serious about developing on Autodesk platform technologies and have not yet attended an Autodesk Developer Network Conference, join us for a deep dive into a whole range of products and services. We&#39;ll be covering Autodesk Cloud and Mobile APIs, including quick reviews of the View and Data API, Fusion 360, BIM 360, Infraworks 360, AutoCAD 360, and AutoCAD Core Engine Services APIs. Of course, we will be covering new features and APIs for our upcoming desktop products too.</p>
<p>DevDays is a traditional road show to 16 cities worldwide for the benefit of members of the Autodesk Developer Network. However, we&#39;re happy to hear from â€“ and help â€“ innovators, forward thinkers and companies just getting started, so even if you are not an ADN member and are interested in this event, we invite you view the information, locations and schedule at <a href="http://www.autodeskdevdays.com/">www.autodeskdevdays.com</a>. ADN members can register via that website. Non-ADN members can contact us at <a href="mailto:devdaysinfo@autodesk.com">devdaysinfo@autodesk.com</a>. Material demonstrated and discussed at DevDays is highly confidential and under Non-disclosure Agreement.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Please Join Me at Autodesk University
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: please-join-me-at-autodesk-university
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/10/please-join-me-at-autodesk-university.html 
DATE: 10/08/2014 07:36:23 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d079cbf7970c-pi"><img alt="au-new-logo-187x32" border="0" height="32" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c6efd614970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="au-new-logo-187x32" width="187" /></a></p>
<p>Iâ€™ll be at <a href="http://au.autodesk.com/">Autodesk University</a> this year and would love the chance to meet you and see what youâ€™re doing with the various Autodesk APIâ€™s and try to help with any questions or problems youâ€™re having. Iâ€™ve never talked to anyone that regretted going. Youâ€™ll learn a lot from the classes and especially the networking of working with people from Autodesk and fellow customers and developers.&#0160; You can learn more about the benefits and even get some help on convincing your manager how useful it will be at this <a href="http://au.autodesk.com/las-vegas/benefits">link</a>.</p>
<p>Hereâ€™s some of whatâ€™s happening this year:</p>
<ul>
<li><a href="http://au.autodesk.com/las-vegas/schedule">650 classes</a> for designers and engineers, plus special Monday events and networking receptions</li>
<li><a href="http://au.autodesk.com/plan/keynotes-forums">Exhibit Hall</a> featuring more than 160 Autodesk authorized developers, solution providers, and our trusted partners.</li>
<li><a href="http://au.autodesk.com/plan/keynotes-forums">Innovation forums</a>&#0160; and <a href="http://au.typepad.com/au/2014/06/whats-coming-to-au-2014-more-tailored-experiences-1.html">tailored experiences</a></li>
<li><a href="http://au.autodesk.com/las-vegas/sustainability/contest">Sustainable design contest</a></li>
</ul>
<p>Autodesk University is Dec. 2-4 in Las Vegas.&#0160; On Dec.1st there is also the ADN DevDays conference where you can learn about whatâ€™s coming in future releases with a focus on the APIâ€™s. If you sign up for AU by Oct. 19th youâ€™ll save $500.</p>
<p>Iâ€™ll be presenting at the DevDays conference and will also be teaching two classes at Autodesk University:</p>
<ul>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=5543"><strong>SD5543</strong></a> â€“ Tips and Tricks when Working with Inventor Softwareâ€™s API</li>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=5529"><strong>CD5529</strong></a> â€“ Customizing Fusion 360 Using its Programming Interface</li>
</ul>
<p>Several of my colleagues from Autodesk will also be teaching programming classes:</p>
<ul>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=6310"><strong>SD6310</strong></a> â€“ Bring on the Cloud and Mobilize Your Media &amp; Entertainment Workflows Through Programming â€“ Kevin Vandecar</li>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=6432"><strong>SD6432</strong></a> â€“ Are You Having a Pythonic 3ds Max Experience? No? Come Join the Revolution. â€“ Kevin Vandecar</li>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=5752"><strong>SD5752</strong></a> â€“ OAuth 1.0 Versus OAuth 2.0 and Use Case â€“ Cyrille Fauvel</li>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=6230"><strong>SD6230</strong></a> â€“ Add 3D Photogrammetry to Your Desktop and Mobile Apps using ReCap Photo API â€“ Philippe Leefsma</li>
<li><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=5931"><strong>SD5931</strong></a> â€“ Creating Commercial Applications for Mobile Devices Using AutoCAD OEM â€“ David Grieve</li>
</ul>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Fast Booleans Using the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: fast-booleans-using-the-api
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/09/fast-booleans-using-the-api.html 
DATE: 09/23/2014 10:26:16 PM
-----
BODY:
<p>The Inventor API supports some functionality thatâ€™s relatively new (since Inventor 2009) and is not very well known.&#0160; Itâ€™s called Transient B-Rep and is accessed through the TransientBRep property on the Application object.&#0160; It supports some relatively simple functionality and also some of the more complicated capabilities provided by the API.&#0160; Luckily you donâ€™t have to understand the complicated in order to use the simple.&#0160;</p>
<p>There was a question on the Inventor Customization Forum recently that asked about being able to quickly perform many Boolean operations on a body by repeatedly moving another body and doing a difference operation.&#0160; They didnâ€™t need the resulting model to have any intelligence (i.e. be parametric) but just needed accurate geometry.&#0160; The TransientBRep object supports functionality that makes this possible.</p>
<p>The Inventor API uses the term <em>Transient</em> to mean data that is not seen or saved in the document.&#0160; Itâ€™s data that exists outside of the model.&#0160; The TransientBRep object provides functions that are a very light wrapper over the Autodesk Shape Manager (ASM) modeling core.&#0160; When you create a feature in Inventor, itâ€™s also using ASM to do the actual model computations but it is also doing a lot more work to remember all of the feature input, adding additional information to the resulting model to allow for associativity, creating data in the browser to represent the feature, and updating the graphics to display the modified model.&#0160; Although a key part of the process, the actual modeling is just a piece of all of the work thatâ€™s done.&#0160; Using the TransientBRep functionality allows you to do just the modeling work without all of the overhead of creating a standard feature.</p>
<p>Iâ€™ve created a small sample to demonstrate the concept and illustrate how to use the API.&#0160; I have a part model that contains two bodies.&#0160; The yellow body will be used as the base or main part material.&#0160; The red part is used as the tool.&#0160; In this case it can be thought of as a punch that will be used to remove material from the base part.&#0160; The punch has been built relative to the model origin, as can be seen by the base work planes.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06fd15c970c-pi"><img alt="TransBRep1" border="0" height="328" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c6e5d9f2970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="TransBRep1" width="504" /></a></p>
<p>In addition to the two bodies you can also see several work points that have been created. Theyâ€™re normal work points except theyâ€™ve been named â€œPunch#â€. as shown below. The points are used to specify locations where the tool is to be subtracted from the base.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb078af267970d-pi"><img alt="TransBRep2" border="0" height="354" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06fd163970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="TransBRep2" width="224" /></a></p>
<p>When the macro is run it prompts you to select the base and tool bodies and then uses the TransientBrep functionality to create transient copies of those and then performs multiple Boolean operations by moving the tool and subtracting it from the base.&#0160; Finally it creates a base feature using the modified base body and turns off the display of the tool and the base body so the result can be seen, which is shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06fd167970c-pi"><img alt="TransBRep3" border="0" height="415" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06fd16b970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="TransBRep3" width="504" /></a></p>
<p>Below is the sample macro and here is the <a href="http://modthemachine.typepad.com/PunchBooleanExample.ipt">sample part</a> that I used to test it.&#0160; The part is an Inventor 2015 model, but this macro will work in previous versions of Inventor too.</p>
<div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">
<p>Public Sub SampleBoolean() <br />&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; Dim partDef As PartComponentDefinition <br />&#0160;&#0160;&#0160; Set partDef = partDoc.ComponentDefinition <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim tg As TransientGeometry <br />&#0160;&#0160;&#0160; Set tg = ThisApplication.TransientGeometry <br />&#0160;&#0160;&#0160; Dim tb As TransientBRep <br />&#0160;&#0160;&#0160; Set tb = ThisApplication.TransientBRep <br />&#0160;&#0160;&#0160; Dim tObjs As TransientObjects <br />&#0160;&#0160;&#0160; Set tObjs = ThisApplication.TransientObjects <br />&#0160;&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Have the bodies selected. <br /></strong></span>&#0160;&#0160;&#0160; Dim baseBody As SurfaceBody <br />&#0160;&#0160;&#0160; Set baseBody = ThisApplication.CommandManager.Pick( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kPartBodyFilter, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Select the base body&quot;) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim toolBody As SurfaceBody <br />&#0160;&#0160;&#0160; Set toolBody = ThisApplication.CommandManager.Pick( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kPartBodyFilter, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Select the tool body&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Copy the two bodies to create transient copies. <br /></strong></span>&#0160;&#0160;&#0160; Dim transBase As SurfaceBody <br />&#0160;&#0160;&#0160; Set transBase = tb.Copy(baseBody) <br />&#0160;&#0160;&#0160; Dim transTool As SurfaceBody <br />&#0160;&#0160;&#0160; Set transTool = tb.Copy(toolBody) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Create a matrix and a point to use in positioning <br />&#0160;&#0160;&#0160; &#39; the punch.&#0160; The matrix is initialized to an identity <br />&#0160;&#0160;&#0160; &#39; matrix the point is (0,0,0). <br /></strong></span>&#0160;&#0160;&#0160; Dim trans As Matrix <br />&#0160;&#0160;&#0160; Set trans = tg.CreateMatrix <br />&#0160;&#0160;&#0160; Dim lastPosition As Point <br />&#0160;&#0160;&#0160; Set lastPosition = tg.CreatePoint <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Process each work point whose name starts with &quot;Punch&quot; <br />&#0160;&#0160;&#0160; &#39; by performing a boolean with the tool at that location. <br /></strong></span>&#0160;&#0160;&#0160; Dim wp As WorkPoint <br />&#0160;&#0160;&#0160; For Each wp In partDef.WorkPoints <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Left$(UCase(wp.Name), 5) = &quot;PUNCH&quot; Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Transform the tool body to the position of the x and <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; y coordinates work point, leaving the z as-is.&#0160; The&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; punch is at the last punch so the transform defines <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; the difference between the last and the current. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans.Cell(1, 4) = wp.Point.X - lastPosition.X <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans.Cell(2, 4) = wp.Point.Y - lastPosition.Y <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call tb.Transform(transTool, trans) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Do the boolean operation. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call tb.DoBoolean(transBase, transTool, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kBooleanTypeDifference) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Save the last position. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set lastPosition = wp.Point <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Create a base body feature of the result. <br /></strong></span>&#0160;&#0160;&#0160; Dim nonParamFeatures As NonParametricBaseFeatures <br />&#0160;&#0160;&#0160; Set nonParamFeatures = partDef.Features.NonParametricBaseFeatures <br />&#0160;&#0160;&#0160; Dim nonParamDef As NonParametricBaseFeatureDefinition <br />&#0160;&#0160;&#0160; Set nonParamDef = nonParamFeatures.CreateDefinition <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim objs As ObjectCollection <br />&#0160;&#0160;&#0160; Set objs = tObjs.CreateObjectCollection <br />&#0160;&#0160;&#0160; Call objs.Add(transBase) <br />&#0160;&#0160;&#0160; nonParamDef.BRepEntities = objs <br />&#0160;&#0160;&#0160; nonParamDef.OutputType = kSolidOutputType <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Call nonParamFeatures.AddByDefinition(nonParamDef) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Turn off the display of the original two <br />&#0160;&#0160;&#0160; &#39; features to see the result.</strong></span> <br />&#0160;&#0160;&#0160; baseBody.Visible = False <br />&#0160;&#0160;&#0160; toolBody.Visible = False <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Force a refresh of the view. <br /></strong></span>&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update <br />End Sub</p>
</div>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Designing T-Shirts with Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: designing-t-shirts-with-inventor
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/09/designing-t-shirts-with-inventor.html 
DATE: 09/22/2014 05:23:18 AM
-----
BODY:
<p>This has nothing to do with the API but is just something fun that Iâ€™ve been able to do with Inventor.</p>
<p><a href="http://www.hoodtocoast.com">Hood to Coast</a> is a large running relay race here in Portland each August that covers almost 200 miles and has over 1000 twelve-member teams.&#0160; You can get a small idea what the race is like from the <a href="http://vimeo.com/9732600">trailer of a documentary</a> that came out a few years ago.</p>
<p>Iâ€™ve been on a few teams over the last several years but for the last two years Iâ€™ve designed the team T-shirts using Inventor.&#0160; The first one was for an Autodesk sponsored team named â€œSole of the Machineâ€.&#0160; Actually it started out as â€œSoul of the Machineâ€ but after the foot design we changed the name to match.&#0160; I took advantage of the new T-Spline functionality before it was officially released to design the foot model.&#0160; I also used the ray tracing in Inventor to render the final image.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0789ae72970d-pi"><img alt="SoleMachine" border="0" height="512" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06e9974970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="SoleMachine" width="512" /></a></p>
<p>Here is the final rendering of the model.&#0160; You can click on the image to see a higher resolution picture.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06e9977970c-pi"><img alt="FootRender" border="0" height="358" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c6e4a682970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="FootRender" width="400" /></a></p>
<p>&#0160;</p>
<p>This past August I was back with my usual team and the team name was the â€œSupersonic Slugsâ€.&#0160; Hereâ€™s the T-Shirt design I modeled this year.&#0160; Again, using T-Splines and the ray tracing in Inventor.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06e997c970c-pi"><img alt="SlugAll" border="0" height="259" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb0789ae77970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="SlugAll" width="450" /></a></p>
<p>Here are larger views of the front and back images and clicking them will open a higher resolution image.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c6e4a68a970b-pi"><img alt="FrontSmallSlug" border="0" height="325" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06e9984970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="FrontSmallSlug" width="350" /></a></p>
<p>&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d06e9988970c-pi"><img alt="BestHighResSuperSonic" border="0" height="597" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c6e4a68e970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="BestHighResSuperSonic" width="450" /></a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Discussion about Fusion 360 API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: discussion-about-fusion-360-api
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/09/discussion-about-fusion-360-api.html 
DATE: 09/10/2014 07:34:14 PM
-----
BODY:
<p>Since I made the initial post about the Fusion 360 API a discussion forum has been created.&#0160; If you have questions or comments about the API, that would be the best place to post them.&#0160;</p>
<p><a href="http://forums.autodesk.com/t5/preview-api-and-scripts/bd-p/22">http://forums.autodesk.com/t5/preview-api-and-scripts/bd-p/22</a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: I&rsquo;m Back and Have Some Fusion 360 News
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: im-back-and-have-some-fusion-360-news
CATEGORY: Brian
CATEGORY: Fusion 360

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/09/im-back-and-have-some-fusion-360-news.html 
DATE: 09/08/2014 05:52:24 AM
-----
BODY:
<p>Itâ€™s been a long time since my last post and Iâ€™m hoping this post is the beginning of ending the dry spell, but Iâ€™m not making any promises <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73e117a6c970d-pi" style="border-style: none;" />.&#0160; Itâ€™s been a very busy past year.&#0160; Professionally, It began by transferring from the Inventor development team into the <a href="http://www.autodesk.com/developer">ADN</a> group that supports developers using the the APIâ€™s of all of the various Autodesk products. As part of that transfer I was hoping to be able to spend more time with you and others that are using the APIâ€™s to make the Autodesk products better.&#0160; Soon after this transition I was loaned back to the development group but this time Iâ€™m working with the Fusion development team to help with the design of the Fusion API.</p>
<p>Earlier this week a new version of Fusion 360 was released and it contains a preview of the API (Application Programming Interface) weâ€™ve been working on. Itâ€™s rare that any off-the-shelf product will do everything you need it to do in the way you would like it to. This applies to Fusion too but now by writing scripts that use the new API, you can drive Fusion to automate repetitive tasks and create new capabilities.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0658abd970c-pi"><img alt="SpurGear" border="0" height="350" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0658ac1970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="SpurGear" width="479" /></a></p>
<p>This release of the API is a preview so thereâ€™s still a lot that we need to do but there is also quite a bit of functionality as you can see demonstrated in the picture above. If you have Fusion installed you have access to the functionality and can try running some of the samples and look at the documentation.&#0160; The API documentation is available on the web along with all of the Fusion product help, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73e117a70970d-pi"><img alt="FusionHelp" border="0" height="484" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73e117a74970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="FusionHelp" width="473" /></a></p>
<p>The <strong>Fusion 360 API Userâ€™s Manual</strong> contains some overview documents to help get you started and there are some sample programs that are part of help and also some that are delivered with Fusion.&#0160; The available programs, or scripts, are accessible through the <strong>Scripts Manager</strong>, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73e117a7a970d-pi"><img alt="ScriptsDialog" border="0" height="427" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d0658ac5970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="ScriptsDialog" width="479" /></a></p>
<p>We would very much like to hear your comments about the API, both about whatâ€™s in this preview release and what functionality you would like to see exposed next in upcoming releases.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Fusion 360 Meetup in San Francisco
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-fusion-360-meetup-in-san-francisco
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/08/autodesk-fusion-360-meetup-in-san-francisco.html 
DATE: 08/18/2014 03:13:24 AM
-----
BODY:
<p>Have you been wondering what Fusion 360 is all about? If you are in the Bay area, now is your chance to find out. The San Francisco Fusion 360 Meetup group is holding a Meetup the evening of Thursday, August 21st at Pier 9. Lots of networking, food, beverages, lively presentations and awesome demos from Autodesk and Fusion 360 community members.</p>
<p>Sign up <a href="http://www.meetup.com/San-Francisco-Fusion-360-Meetup/">here</a> to stay in touch or attend the event. Oh, did I mention? Free beer!</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Sneak Peek - New Autodesk 360 Viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: sneak-peek-new-autodesk-360-viewer
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/05/sneak-peek-new-autodesk-360-viewer.html 
DATE: 05/30/2014 01:18:44 AM
-----
BODY:
<p>Kean Walmsley recently presented the first sneak peek at the <a href="http://click.typepad.com/api/click?format=go&amp;jsonp=vglnk_jsonp_14014047399988&amp;key=7626aa89b5cdca8c8b5ad715622cd669&amp;libId=f3649e15-6a55-4183-8d5e-96642f6d0e5a&amp;loc=http%3A%2F%2Fthebuildingcoder.typepad.com%2Fblog%2F2014%2F05%2Fupdated-sdk-devtv-bim-360-news-and-viewer.html%236&amp;v=1&amp;out=http%3A%2F%2Fthrough-the-interface.typepad.com%2Fthrough_the_interface%2F2014%2F05%2Fa-sneak-peek-at-the-new-autodesk-360-viewer.html&amp;title=The%20Building%20Coder%3A%20Updated%20SDK%2C%20DevTV%2C%20BIM%20360%20News%20and%20Viewer&amp;txt=%0Asneak%20peek%20at%20the%20new%20Autodesk%20360%20viewer" target="_blank">new Autodesk 360 viewer</a>.</p>
<p>The new 3D viewer is really cool. To try it out you use your Autodesk 360 account. You can upload your files (by folder if you want) and then view them using the new viewing web service. (it does a lot more than just viewing) The viewer is in Tech Preview but it is working very well. Also you will need a WebGL-enabled browser. You can use this <a href="http://doesmybrowsersupportwebgl.com/" target="_blank">site</a> to test. </p>
<p>Here is a model of a front loader using the viewer. (Model courtesy of Engineering Center) This model is being served up by a demo service that takes care authentication. For more information, please refer to <a href="http://through-the-interface.typepad.com/through_the_interface/2014/05/a-sneak-peek-at-the-new-autodesk-360-viewer.html">Kean&#39;s original post</a>&#0160;</p>
<p><iframe frameborder="0" height="264" id="MFG-viewer" name="mfg_viewer" src="https://s3.amazonaws.com/FastViewer/index.html?file=frontloader/0.svf" title="Front Loader" width="470"></iframe></p>
<p>&#0160;</p>
<p>Aside from the standard zoom, pan and orbit, in this model, you can press the <strong>structure</strong> button <img alt="Structure button" border="0" height="27" src="https://through-the-interface.typepad.com/.a/6a00d83452464869e201a73dccce59970d-pi" title="Structure button" width="27" /> to browse down through the model&#39;s assembly structure or component hierarchy. You can use this to isolate specific components in your model, hiding everything else.</p>
<p>Double click an individual building component to highlight it, list its identity and other properties.</p>
<p>After hitting reset <img alt="Reset button" border="0" height="26" src="https://through-the-interface.typepad.com/.a/6a00d83452464869e201a73dccce5b970d-pi" title="Reset button" width="26" />, now try the <strong>explode</strong> button <img alt="Explode button" border="0" height="27" src="https://through-the-interface.typepad.com/.a/6a00d83452464869e201a511c19e91970c-pi" title="Explode button" width="28" /> and then manipulate the slider that appears at the top of the window to move the various model components outwards from the center to form an exploded view.</p>
<p>Please note that these super-simple single-line embedded viewers do not immediately support all the possible functionality. It is â€“ or will be soon, we hope â€“ really easy to implement that in a slightly more full-fledged context, though.</p>
<p>Aside from the need to support a huge array of formats, the viewer is really good at streaming large models â€“ displaying them at appropriate levels of detail â€“ and allowing you to get in and work with the structure of these models.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Matt
EMAIL: iphoenix@gmail.com
IP: 38.122.110.10
URL: 
DATE: 06/09/2014 03:06:30 PM
Can you embed it in a website without uploading it to autodesk 360 similar to the way freewheel used to work? eg..

<a href="http://pastie.org/private/boqgqd91dxvpl3inechoza">http://pastie.org/private/boqgqd91dxvpl3inechoza</a>
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 50.34.43.155
URL: 
DATE: 06/17/2014 05:56:54 PM
Hi Matt,

The viewer uses a streaming format, and you have to upload the files to our service to translate those files to that format. I wouldnâ€™t say "you have to upload to A360" â€“ the upload API is independent of A360.

Thanks,
Wayne


-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor 2015 API Enhancements
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2015-api-enhancements
CATEGORY: Assemblies
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Sheet Metal
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/04/inventor-2015-api-enhancements.html 
DATE: 04/08/2014 08:32:40 PM
-----
BODY:
<p>Inventor 2015 will soon be shipping. Most of the API enhancements are keeping up with the new Inventor 2015 functionality and some of the enhancements are catching up to things that have been&#0160; available from the Inventor user interface in previous releases.&#0160;</p>
<p><strong>Enhancements in the API for Parts</strong></p>
<p><em>Sweep Feature.</em></p>
<p>The <em>SweepFeature</em> has a new option for twist angle and now&#0160; instead of having a method call that takes all the arguments to create a sweep you create a definition object and set all the properties on that object and provide definition as input to create the sweep. In the UI when you click the sweep command the dialog comes up it gathers all of the inputs needed to create the sweep but the sweep is not actually created until you click ok. You can consider the definition object as similar to the dialog.</p>
<p>&#0160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a3fcea4c9a970b-pi"><img alt="image" border="0" height="221" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a3fcea4ca1970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="490" /></a></p>
<p>&#0160;</p>
<p><em>Work plane.</em></p>
<p>Previous to Inventor 2015 you could create a mid plane between two parallel planes. Inventor now supports the creation of a plane between any two planes and they do not have to be parallel. An example of this is bisecting two perpendicular planes. A new point argument that defines which quadrant to use needs to be provided because if the planes are not parallel there are two possible solutions.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50104970d-pi"><img alt="image" border="0" height="459" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f41d970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="481" /></a></p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>Work plane created using WorkPlanes.AddByTwoPlanes()</p>
<p>&#0160;</p>
<p><em>DirectEditFeature</em></p>
<p>In the UI the direct edit feature lets you push and pull features. The API has read support and allows you to find information such as&#0160; which operations were defined.</p>
<p><em>FreeformFeature</em></p>
<p>Another enhancement in the user interface is T-Spline capabilities. In the product it is referred to as a Freeform. The 2015 API has minimal support for this but should change in the future. In this release you can find the <em>FreeformFeature</em> and do basic feature operations such as getting its name, suppressing it or reordering it in the tree.</p>
<p><em>Sketch</em></p>
<p>Inventor 2015 has changes to sketching that makes it more intuitive to use. The API has been updated because there are quite a few new settings.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50109970d-pi"><img alt="image" border="0" height="248" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f424970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="547" /></a></p>
<p>These settings are exposed through the API.</p>
<p>&#0160;</p>
<p><strong>Enhancements in the API for Sheet metal</strong></p>
<p><em>Punch â€“ cut across bend</em></p>
<p>Now when you do a punch you have an option to have the punch cut across a bend.</p>
<p style="text-align: left;"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da5010d970d-pi"><img alt="image" border="0" height="313" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50113970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="443" /></a></p>
<p style="text-align: left;">Punch on the right used cut across bend</p>
<p style="text-align: left;"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50117970d-pi"><img alt="image" border="0" height="381" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da5011b970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="441" /></a></p>
<p style="text-align: left;">You can think of it as unfolding the part and doing the punch and then folding it back. (the edges are normal to the flat)</p>
<p><em>Punch â€“ cut normal to the flat pattern</em></p>
<p>In this case the edges will be perpendicular to the flat. Instead of being perpendicular to the sketch. This will make it easier to fabricate the part.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f42f970c-pi"><img alt="image" border="0" height="384" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50120970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="418" /></a></p>
<p>Cut on the left is normal to the flat</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f438970c-pi"><img alt="image" border="0" height="299" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a3fcea4cbd970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="381" /></a></p>
<p>How it looks in the flat pattern.</p>
<p><em>Flat pattern orientation</em></p>
<p>You now have more control over the flat pattern orientation.&#0160; In the UI there is a new dialog where you can pre define multiple orientations and switch between those and the API provides full access.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f448970c-pi"><img alt="image" border="0" height="338" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da50126970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="435" /></a></p>
<p>&#0160;</p>
<p><strong>Enhancements in API for Assemblies</strong></p>
<p><em>BOM Structure</em></p>
<p>There are new methods to import and export the BOM customization file. The API has some support for the BOM but it does not support defining the BOM structure. A solution is to interactively create the BOM structure that you want and export it. Using the API you can import that to have a custom BOM structure.</p>
<p><em>AssemblySymmetryConstraint</em></p>
<p>The assembly symmetry constraint has a new option to control the orientation and the API was enhanced to provide that capability.</p>
<p><strong>Enhancements in API for Drawings</strong></p>
<p><em>Hole table title</em></p>
<p>In this release you have control over hole table title.</p>
<p><em>Foreshortened dimensions</em></p>
<p>Foreshortened drawing dimensions are linear, angular, and arc length dimensions.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73da5012d970d-pi"><img alt="image" border="0" height="259" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51199f44c970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="450" /></a></p>
<p>&#0160;</p>
<p><strong>Miscellaneous Enhancements</strong></p>
<p><em>FileManager</em></p>
<p>The FileManager object now has a method <em>ReferencedDocumentCount</em> that will allow you to get the number of referenced documents. The WillOpenExpressDefault method will allow you to find out whether the input assembly will open in Express mode by default. To use these methods you just pass in a file name and it returns the information.</p>
<p>&#0160;</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Chrissoathe
EMAIL: 
IP: 2.100.18.198
URL: http://profile.typepad.com/chrissoathe
DATE: 04/09/2014 09:28:44 PM
Bom structure updates are always welcome!
-----
COMMENT:
AUTHOR: Dave Whiteley
EMAIL: dave@envisageuk.com
IP: 81.151.168.187
URL: http://www.envisageuk.com
DATE: 09/16/2014 04:05:30 PM
I'm sorry to see that "Break Member" from the frame generator is not available in the API - this would have been useful to track in order to rename the new member's file name that has been created in numbering systems etc.
-----
COMMENT:
AUTHOR: Tikeshware
EMAIL: tikeshwar.prasad@gmail.com
IP: 122.169.94.12
URL: 
DATE: 10/01/2014 04:43:08 PM
Thanks for the update.
When can we expect Direct Editing API to be exposed for the user ?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: April Fools Fun
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: april-fools-fun
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/04/april-fools-fun.html 
DATE: 04/02/2014 06:16:51 PM
-----
BODY:
<p>Yesterday, several of us working with the various Autodesk APIâ€™s here at Autodesk created April Fools posts as part of a friendly competition.&#0160; I hope no one took my <a href="http://modthemachine.typepad.com/my_weblog/2014/04/new-age-of-cad-interaction.html">post from yesterday</a> seriously.&#0160; You can read a bit more about it and read the other posts here: <a href="http://adndevblog.typepad.com/autocad/2014/04/feeling-foolish.html">http://adndevblog.typepad.com/autocad/2014/04/feeling-foolish.html</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jed
EMAIL: mechejf88@gmail.com
IP: 134.74.21.77
URL: 
DATE: 04/07/2014 11:22:26 PM
Hi,
I would like to learn more about writing vba code, and possibly learning to develop inventor addins. I have been using ilogic since the first beta versions were relased. Currently I work for a bridge design firm and I would like to try and persuade my bosses of the power of using 3D versus 2D for bridge and structural design. I am interesting in finding online courses, but if there are classes or training centers where I could become certified and what not, please advise. Also, if possible I'd like to know how to email this blog.
Thanks.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: New Age of CAD Interaction
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: new-age-of-cad-interaction
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2014/04/new-age-of-cad-interaction.html 
DATE: 04/01/2014 08:04:37 AM
-----
BODY:
<p>A lot of people have been experimenting with the Leap Motion device which allows you to track hand movements and convert that into some type of CAD interaction.&#0160; I did some <a href="https://www.youtube.com/watch?v=YWFFnQ3gGwM">experimenting in Inventor</a> and Kean Walmsley posted about some of his <a href="https://www.youtube.com/watch?v=fp9G6hx9Fts">work with AutoCAD</a>. As cool as the Leap Motion device is, it sometimes leaves you wanting for a bit more.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a3fce41af8970b-pi"><img alt="IMG_4299" border="0" height="360" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51193d8b2970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="IMG_4299" width="480" /></a></p>
<p>A nice addition is 3D video so instead of trying to understand how your 3D hand motions translate into the flat screen, the CAD model pops out of the screen making it much more intuitive to interact with.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51193d8b6970c-pi"><img alt="Glasses" border="0" height="277" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a73d9ee3e6970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Glasses" width="480" /></a></p>
<p>Another addition to this mix of technology is a new prototype touch feedback glove.&#0160; This is different than force feedback in that it doesn&#39;t push back but instead just &quot;touches&quot; you.&#0160; Their are a few hundred small magnetically activated pistons at each fingertip.&#0160; They can be programmed to push against your finger at various depths.&#0160; When using the glove you get the feedback that you&#39;re touching something and with the fine granularity of the pistons can even feel the shape of the object.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a51193d8ba970c-pi"><img alt="IMG_4300" border="0" height="360" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401a3fce41b01970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="IMG_4300" width="480" /></a></p>
<p>By combining these three technologies you get a very immersive experience when interacting with your CAD model. The video below shows an early prototype of &quot;grabbing&quot; a bolt in Inventor and inserting it into a hole.</p>
<div class="wlWriterEditableSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:6284aff9-8441-4758-93ed-1f63149d15b3" style="float: none; margin: 0px; display: inline; padding: 0px;">
<div><object height="264" width="471"><param name="movie" value="http://www.youtube.com/v/dAGtIswrp2E?hl=en&amp;hd=1" /></object></div>
</div>
<p>A future improvement is to add voice recognition. This can especially be useful to activate commands and provide input while one hand is occupied with the touch feedback glove.</p>
<p>Please read this <a href="http://modthemachine.typepad.com/my_weblog/2014/04/april-fools-fun.html">post</a> for more information.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: You&rsquo;re Invited to DevDays 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: youre-invited-to-devdays-2013
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/youre-invited-to-devdays-2013.html 
DATE: 09/24/2013 09:40:34 PM
-----
BODY:
<p>Whatâ€™s DevDays you ask? Itâ€™s an event that the Autodesk Developer Network (ADN)team puts together every year to introduce the upcoming product releases and their new API functionality. It consists of presentations, demonstrations, and a chance to ask the experts your questions. In a few cities there are also DevLabâ€™s scheduled which is a full day reserved for you to get 1-on-1 help with your questions about Autodeskâ€™s various APIâ€™s.</p>
<p>In the past this event has always been an exclusive event for ADN members but this year itâ€™s being opened up for others to attend. Below are the locations and dates for the sessions. Iâ€™ll be attending the conference and the DevLab in Las Vegas in December and would like to meet and see what youâ€™ve been doing with Inventorâ€™s API and help with programming questions you might have.</p>
<p><strong>Asia and Australia</strong> <br />November 7, 2013 â€“ Developer Day, Beijing, China <br />November 8, 2013 â€“ <strong>DevLab</strong>, Beijing, China <br />November 11, 2013 â€“ Developer Day, Shanghai, China <br />November 12, 2013 â€“ <strong>DevLab</strong>, Shanghai, China <br />November 13, 2013 â€“ Developer Day, Seoul, South Korea <br />November 15, 2013 â€“ Developer Day, Tokyo, Japan <br />November 18, 2013 â€“ Developer Day, Melbourne, Australia <br />November 19, 2013 â€“ Developer Day, Osaka, Japan <br />November 20, 2013 â€“ Developer Day, Singapore, Singapore <br />November 22, 2013 â€“ Developer Day, Bangalore, India <br /> <br /><strong>North America</strong> <br />December 2, 2013 â€“ AutodeskÂ® Developer Network Conference, Las Vegas, USA <br />December 3, 2013 â€“ <strong>DevLab</strong>, Las Vegas, USA <br /> <br /><strong>Europe</strong> <br />December 9, 2013 â€“ Developer Day, Paris, France <br />December 10, 2013 â€“ Developer Day, Milan, Italy <br />December 11, 2013 â€“ Developer Day, Farnborough, United Kingdom <br />December 12, 2013 â€“ Developer Day, Munich, Germany <br />December 13, 2013 â€“ <strong>DevLab</strong>, Munich, Germany <br />December 16, 2013 â€“ Developer Day, Gothenburg, Sweden <br />December 18, 2013 â€“ Developer Day, Moscow, Russia <br /> <br /><strong>South America <br /></strong>February 5, 2014 â€“ Developer Day, SÃ£o Paulo, Brazil <br />February 12, 2014 â€“ Developer Day, Mexico City, Mexico</p>
<p>You can learn more about the logistics of the conference at the <a href="http://developer-days.autodesk-services.com/">registration page</a>.&#0160; Below is the information from the ADN team about the event:</p>
<hr />
<p><img align="right" alt="rEvolution" border="0" height="196" hspace="12" src="https://through-the-interface.typepad.com/.a/6a00d83452464869e2019aff8e582a970d-pi" title="rEvolution" width="196" /><strong><em>rEvolution</em></strong></p>
<p><em><strong>Where Desktop meets the Cloud</strong></em></p>
<p><em>Got great ideas for cloud and mobile apps? Want to learn where Autodesk is taking the convergence of desktop computing and cloud technology?</em></p>
<p><em>If youâ€™re an innovator developing on Autodesk platform technology and have not yet attended an Autodesk Developer Network Conference join us for a deep dive as we take an in-depth look at Autodeskâ€™s newest technologies and the next generation of products coming in 2014. The Autodesk Developer Network is holding its annual, worldwide Developer Day Conference and DevLab in cities around the world from November 2013 through February 2014.</em></p>
<p><em>Called Autodesk DevDays 2013, the theme for this yearâ€™s event is rEvolution â€“ Where Desktop meets the Cloud.&#0160; Come and learn about upcoming releases of several new web service APIs from Autodesk.&#0160; Youâ€™ll see how these new web services extend the power of the desktop: delivering easy collaboration, limitless compute power and big data â€“ and are platforms that can deliver the same to you and your customers.&#0160; Itâ€™s an opportunity to learn about a range of â€œ360 basedâ€ web service APIs delivering you Cloud based platforms for a number of industries - Manufacturing, AEC, Infrastructure and more. And, we will of course also cover whatâ€™s new in the next releases of our desktop products (AutoCADÂ®, AutodeskÂ® RevitÂ®, AutodeskÂ® InventorÂ®, AutoCADÂ® Civil 3DÂ® and so on)!</em></p>
<p><em>Note that material at Developer Days is forward-looking and highly confidential so ADN membership is required. Maybe you are using ADN Open and forums and would like to attend DevDays? Visit </em><a href="http://www.autodesk.com/joinadn"><em>www.autodesk.com/joinadn</em></a><em> or send an email to your </em><a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=473880"><em>local ADN representative</em></a><em> and letâ€™s talk. We like to hear from â€” and help â€” interested parties, innovators and companies just getting started.</em></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Processing a Directory of Files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: processing-a-directory-of-files
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: VB.NET

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/processing-a-directory-of-files.html 
DATE: 09/21/2013 01:40:05 AM
-----
BODY:
<p>I was recently asked a question about the best way to create a PDF file for every drawing in a specified directory and itâ€™s subdirectories.&#0160; My answer is to write a small Visual Basic application to do it.&#0160; Visual Basic Express (which is free) is fully capable of creating an application like this.&#0160;</p>
<p>Below is the minimal code to get all of the files within a directory and perform some type of process on each one. The first line calls the .Net GetFiles function and passes in the directory name, a search pattern, and an argument indicating that all subdirectories should also be searched. This used to be a lot of work in VBA and is now a single line with .Net. Next it iterates over the list of filenames that were found and opens each one in Inventor, calls the SaveAsPDF function, and then closes the document.&#0160; The SaveAsPDF function is a function I wrote thatâ€™s not shown below but it calls the PDF translator and exports the drawing to PDF.&#0160; By simply replacing the SaveAsPDF call with a call to a different function you can change this program to do any type of processing you want.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;"><strong><span style="color: #0000ff;">&#39; Get all of the drawing files in the directory and subdirectories. <br /></span></strong>Dim drawings() As String = System.IO.Directory.GetFiles( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; txtPath.Text, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;*.idw&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.IO.SearchOption.AllDirectories) <br /> <br /><span style="color: #0000ff;"><strong>&#39; Iterate through the found drawings. <br /></strong></span>For Each drawing As String In drawings <br />&#0160;&#0160;&#0160; Dim drawDoc As Inventor.DrawingDocument <br />&#0160;&#0160;&#0160; drawDoc = invApp.Documents.Open(drawing) <br /> <br />&#0160;&#0160;&#0160; <strong><span style="color: #0000ff;">&#39; Save the PDF.</span></strong> <br />&#0160;&#0160;&#0160; SaveAsPDF(drawDoc, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.IO.Path.ChangeExtension(drawing, &quot;pdf&quot;)) <br /> <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;"><strong>&#39; Close the drawing.</strong></span> <br />&#0160;&#0160;&#0160; drawDoc.Close(True) <br />Next</div>
<p>The above code doesnâ€™t have any error handling or any user interface. Once you add that and a couple of bells and whistles the code grows a bit. Iâ€™ve created a full application in Visual Basic Express 2010 that has a user interface and the bells and whistles. The user interface is shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff83fab3970d-pi"><img alt="SaveAsPDF" border="0" height="349" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff8354fb970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="SaveAsPDF" width="480" /></a></p>
<p>You can see in the image above that some files failed to process.&#0160; This is because they were created in a later version of Inventor so the version of Inventor Iâ€™m using is unable to open them. The good news is that the program handles that case correctly and reports it.</p>
<p>The program is written to work with Inventor 2013 and later. You can download the executable here: <a href="http://modthemachine.typepad.com/SaveAsPDF_Exe.zip">SaveAsPDF_Exe.zip (28.5K)</a></p>
<p>And you can download the complete source code of the Visual Basic Express 2010 project here: <a href="http://modthemachine.typepad.com/SaveAsPDF_Source.zip">SaveAsPDF_Source.zip (13.9K)</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Nick
EMAIL: Nix@nix.da
IP: 79.220.219.81
URL: 
DATE: 09/27/2013 11:53:16 AM
Is it possible to get a version for dwgs? That would be great. Thanks
-----
COMMENT:
AUTHOR: akosi
EMAIL: paulolec21@sympatico.ca
IP: 208.4.56.251
URL: 
DATE: 09/27/2013 02:52:44 PM
im getting error on the first line..>>txtPath<<
so ive replace it with the folder path but still error.

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with Cameras (Part 2)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: working-with-cameras-part-2
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/working-with-cameras-part-2.html 
DATE: 09/09/2013 07:22:53 PM
-----
BODY:
<p>This is a continuation of a <a href="http://modthemachine.typepad.com/my_weblog/2013/09/working-with-cameras-part-1.html">previous post</a> introducing cameras.</p>
<p><strong>A Camera Gotcha</strong> <br />When working with cameras associated with a graphics view you use the Camera property of the View object. Typically youâ€™ll get the View object using the Application.ActiveView property. The behavior of the View.Camera property is that every time you call it, it returns a new camera. This behavior makes it easy to run into a very common problem when working with cameras. The code below illustrates the problem. It calls the Camera property of the View object and then calls the ViewOrientationType property of the Camera object, setting the camera position to be a standard isometric view. Once it does this it calls the cameraâ€™s Apply method. The result is that nothing happens.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p><span style="color: #0000ff;"><strong>&#39; Set the camera orientation to an iso view.</strong></span> <br />invApp.ActiveView.Camera.ViewOrientationType = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IsoTopLeftViewOrientation <br /><span style="color: #0000ff;"><strong>&#39; Apply the camera changes to the view.</strong></span> <br />invApp.ActiveView.Camera.Apply</p>
</div>
<p>The reason that nothing happens is that in the first line the Camera property is called and a camera is created and returned. On this camera the isometric view is specified. On the next line the Camera property is called again and another camera is created and returned. On this camera the Apply method is called, but this camera hasnâ€™t had the view orientation set but is the same as the current view so you donâ€™t see any visible change. The code below illustrates the correct procedure and does create the desired result. In this case the Camera property is called and the camera is returned. The orientation for that camera is defined as an isometric view and the Apply method on the same camera is called. The view then updates to reflect the new camera position.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p><span style="color: #0000ff;"><strong>&#39; Get the camera from the view. <br /></strong></span>Dim cam As Camera <br />Set cam = invApp.ActiveView.Camera <br /> </p>
<span style="color: #0000ff;"><strong>&#39; Set the camera orientation to an iso view. <br /></strong></span>cam.ViewOrientationType = kIsoTopLeftViewOrientation <br /> <br /><span style="color: #0000ff;"><strong>&#39; Apply the camera changes to the view. <br /></strong></span>cam.Apply</div>
<p><strong>Applying Camera Changes</strong> <br />Setting a property on a camera doesnâ€™t have an immediate effect. This is because typically youâ€™ll want to make several changes to the camera before you force the view to update. For example you might want to change both the eye and target points and then update the camera. There are two methods that cause changes to the camera take effect. They are Apply and ApplyWithoutTransition. The Apply method uses the same transition technique that inventor uses when you change to a new view orientation; it smoothly transitions from one position to another. The ApplyWithoutTransition immediately shows the new camera position without any transition. The ApplyWithoutTransition is used when youâ€™re doing your own camera animation because youâ€™ll be computing all of the camera positions yourself and donâ€™t want the delay as Inventor transitions from one camera position to another.</p>
<p><strong>Modifying the Camera <br /></strong>There are three properties on the camera that control the position and orientation of the camera; the Eye, Target, and UpVector properties. There are other properties that let you control the cameraâ€™s field of view. the Perspective property lets you toggle the camera from perspective to parallel. When the camera is a perspective camera you can use the PerspectiveAngle property to control the field of view. When itâ€™s a parallel camera you can use the GetExtents and SetExtents methods to get and set the field of view. In addition to these functions that let you directly get and set the underlying properties of a camera there are also some convenience functions that make it easier to manipulate the camera. For example, the ViewOrientationType lets you specify standard view positions, (i.e. top, front, top-left iso, etc.) and Inventor will modify the eye, target, and up vector as-needed. The Fit method takes into account the size of the model and modifies the camera so the entire model is visible. There is also a function that takes mouse input and modifies the camera to reflect the mouse movement or scrolling.</p>
<p>Below is some VBA code that will fly the camera around the model. To simplify the code, the target is hard coded at the origin and the up vector is the positive Z.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub RotateCamera() <br /><strong>&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the active camera.</span></strong> <br />&#0160;&#0160; Dim cam As Camera <br />&#0160;&#0160; Set cam = ThisApplication.ActiveView.Camera <br />&#0160;&#0160; Dim tg As TransientGeometry <br />&#0160;&#0160; Set tg = ThisApplication.TransientGeometry <br /> <br /><strong>&#0160;&#0160; <span style="color: #0000ff;">&#39; Define the number of steps in the animation.</span></strong> <br />&#0160;&#0160; Dim steps As Integer <br />&#0160;&#0160; steps = 360 <br /> <br /><strong>&#0160;&#0160; <span style="color: #0000ff;">&#39; Define the distance between the eye and target.</span></strong> <br />&#0160;&#0160; Dim eyeDistance As Double <br />&#0160;&#0160; eyeDistance = 15 <br /> <br /><strong>&#0160;&#0160; <span style="color: #0000ff;">&#39; Calculate pi.</span></strong> <br />&#0160;&#0160; Dim pi As Double <br />&#0160;&#0160; pi = Atn(1) * 4 <br /> <br /><strong>&#0160;&#0160; <span style="color: #0000ff;">&#39; Iterate the specified number of steps.</span></strong> <br />&#0160;&#0160; Dim i As Integer&#0160; <br />&#0160;&#0160; For i = 1 To steps&#0160; <br /><strong>&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Calculate the x and y coordinates of the eye.</span></strong> <br />&#0160;&#0160;&#0160;&#0160;&#0160; Dim x As Double <br />&#0160;&#0160;&#0160;&#0160;&#0160; Dim y As Double <br />&#0160;&#0160;&#0160;&#0160;&#0160; x = eyeDistance * Cos(i / steps * (2 * pi)) <br />&#0160;&#0160;&#0160;&#0160;&#0160; y = eyeDistance * Sin(i / steps * (2 * pi)) <br /> <br /><strong>&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Set the eye using calculated x, y and a hard coded z value.</span></strong> <br />&#0160;&#0160;&#0160;&#0160;&#0160; cam.Eye = tg.CreatePoint(x, y, 3) <br /><strong> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Define the up vector as positive z.</span></strong> <br />&#0160;&#0160;&#0160;&#0160;&#0160; cam.UpVector = tg.CreateUnitVector(0, 0, 1) <br /> <br /><strong>&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Apply the current camera definition to the view.</span></strong> <br />&#0160;&#0160;&#0160;&#0160;&#0160; cam.ApplyWithoutTransition <br />&#0160;&#0160; Next <br />End Sub</p>
</div>
<p><strong>Why Use the Camera?</strong> <br />There are several reasons you might want to use the Camera object. The first is that you have a need to control the view within Inventor. For example, you can create a custom fly-trough of an assembly or write some utilities that allow you to quickly go to certain views. The sample code above demonstrates the procedure to set the camera properties and apply it to a view. Watch for another post about how to make the camera follow a curve like what was demonstrated in the video in this earlier <a href="http://modthemachine.typepad.com/my_weblog/2013/08/high-school-interns-at-autodesk.html">post</a>.</p>
<p>A camera is also used to create non-standard drawing views. Using a camera you can create any view orientation you want. The following code illustrates using a camera to create a custom drawing view that is a perspective isometric view.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p><strong><span style="color: #0000ff;">&#39; Create a camera to be used to define the view orientation.</span></strong> <br />Dim cam As Camera <br />Set cam = ThisApplication.TransientObjects.CreateCamera <br /><strong> <br /><span style="color: #0000ff;">&#39; Set up the camera.</span></strong> <br />cam.Perspective = True <br />cam.ViewOrientationType = kIsoTopRightViewOrientation <br /><strong> <br /><span style="color: #0000ff;">&#39; Create a drawing view using the camera.</span></strong> <br />Dim viewPnt As Point2d <br />Set viewPnt = ThisApplication.TransientGeometry.CreatePoint2d(12, 12) <br />Dim drawView As DrawingView <br />Set drawView = drawSheet.DrawingViews.AddBaseView(doc, viewPnt, 1, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kArbitraryViewOrientation, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kHiddenLineRemovedDrawingViewStyle, , _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oCamera) </p>
</div>
<p>The Camera object can also be used to save an image as a file. You essentially capture whatever the camera is currently seeing and save that as an image file. The format of the file can be any of several popular image types, (i.e. jpg, bmp, png, gif, and tiff). This can be useful within Inventor but is particularly useful with Apprentice because Apprentice doesnâ€™t have a visible graphics window. You can use a camera to create images for parts, assemblies, and drawings. The VB.Net code below demonstrates creating an image of a part or assembly using Apprentice. It assumes youâ€™ve already created an instance of Apprentice and have opened the part or assembly, which are both passed into this sub, along with the filename to use for the image. The type of image created is dependent on the extension of the filename.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Private Sub CreateImage( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apprentice As Inventor.ApprenticeServerComponent, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; PartOrAssembly As Inventor.ApprenticeServerDocument, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Filename As String) <br /><strong>&#0160;&#0160; &#39; Create a new camera.</strong> <br />&#0160;&#0160; Dim cam As Inventor.Camera <br />&#0160;&#0160; cam = Apprentice.TransientObjects.CreateCamera <br /><strong> <br />&#0160;&#0160; &#39; Associate the document with the camera.</strong> <br />&#0160;&#0160; cam.SceneObject = PartOrAssembly.ComponentDefinition <br /><strong> <br />&#0160;&#0160; &#39; Define the camera and apply the changes.</strong> <br />&#0160;&#0160; cam.ViewOrientationType = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.ViewOrientationTypeEnum.kIsoTopRightViewOrientation <br />&#0160;&#0160; cam.Fit() <br />&#0160;&#0160; cam.ApplyWithoutTransition() <br /><strong> <br />&#0160;&#0160; &#39; Save the result, defining the background color of the image.</strong> <br />&#0160;&#0160; cam.SaveAsBitmap(Filename, 800, 600, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apprentice.TransientObjects.CreateColor(255, 255, 0), _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apprentice.TransientObjects.CreateColor(15, 15, 15)) <br />End Sub</p>
</div>
<p>The resulting image is shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff492167970c-pi"><img alt="Camera07" border="0" height="237" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff490375970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera07" width="315" /></a></p>
<p>Thatâ€™s the basics of using cameras. Watch for an upcoming post where weâ€™ll look at a tool to better visualize the camera and how to use geometry in the model to control the camera.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: The &ldquo;Portathon&rdquo; is Happening Soon!!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: the-portathon-is-happening-soon
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/the-portathon-is-happening-soon.html 
DATE: 09/06/2013 05:46:48 PM
-----
BODY:
<p>Hereâ€™s the latest update on the upcoming Portathon.</p>
<p><strong>App developers can still register and </strong><strong>receive</strong><strong>US$100 per app published!</strong></p>
<p>The 48 hour virtual web based coding event runs through September 13 and 14, 2013.&#0160;&#0160; There&#39;s still time to register and to participate early if you wish.&#0160; You can even submit your apps before the event.&#0160; In fact, over 100 apps have already been submitted for this event.&#0160; If you&#39;re a developer of apps for Autodesk products, there is no better way to reach Autodesk customers worldwide than Autodesk Exchange Apps.&#0160; Customers are active and engaged with Autodesk Exchange Apps as evidenced by comments: &quot;Very grateful for this tool it is saving me a huge amount of time and the tedious task of doing it via the block editor&quot; or &quot;This one is a no-brainer. I have been searching for an app like this. Easy to use, and does what it says.&quot;</p>
<p>Don&#39;t delay - join well over 100 developers in getting the help you may need to get your apps published.&#0160; If you submit your apps by midnight on September 14, 2013 and if they are accepted for publication in the store by October 31, 2013, you will receive US$ 100 per app (for up to 5 apps â€“ US$ 500 total).</p>
<p>For details visit: <a href="http://autode.sk/15DjZpq">http://autode.sk/15DjZpq</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Using MS Access Databases with Inventor 2014 VBA
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-ms-access-databases-with-inventor-2014-vba
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/using-ms-access-databases-with-inventor-2014-vba.html 
DATE: 09/05/2013 11:51:15 PM
-----
BODY:
<p>Several people have had problems with existing VBA programs when they made the transition to Inventor 2014 from an earlier release. The problem they were having is that the portion of their program that tried to connect to an Access database was failing. Below is a description of whatâ€™s really going on.</p>
<p><strong>History</strong> <br />For a long time Inventor was only available as a 32-bit application. It still is available as 32-bit but most people use the 64-bit version, primarily because of the ability to use much more memory.&#0160; Until fairly recently VBA was only available as a 32-bit component.&#0160; As a component it doesnâ€™t run on its own but needs to be hosted within another process. In this case it runs within the Inventor process. To connect to an Access database you need to use the OLEDB Provider component. Just the same as the VBA component, it needs to run within another process, which in the case of Inventor VBA is running within the Inventor process. The picture below represents whatâ€™s happening with a 32-bit version of Inventor. When a component runs within another process it <strong><span style="text-decoration: underline;">MUST</span></strong> be the same bitness.&#0160; That is 32 bit components <strong><span style="text-decoration: underline;">MUST</span></strong> run within an 32 bit process and 64 bit components <strong><span style="text-decoration: underline;">MUST</span></strong> run within a 64 bit process. There are no exceptions. By running in-process the speed of VBA is very good because the communication between VBA and Inventor is within the same process and is essentially a direct call.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3667d0970d-pi"><img alt="OLEDB01" border="0" height="201" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3667d4970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="OLEDB01" width="251" /></a></p>
<p>&#0160;</p>
<p>When a 64-bit version of Inventor was being developed we had a problem; VBA was only available as a 32-bit component.&#0160; This meant that VBA could no longer run within Inventor. A lot of customers had written macros and were dependent on the functionality they provided so we didnâ€™t want to abandon VBA. A workaround to the problem was invented, which is illustrated below. When you run VBA from a 64-bit installation of Inventor 2013 or earlier, a separate process is started called Inventor32bitHost.exe, (which you can see in Windows Task Manager). This is a small executable whoâ€™s purpose is to serve as the 32-bit host for the VBA component.&#0160; When the OLEDB Provider component is used by VBA it is also loaded within the Inventor32bitHost.exe process and everything works since itâ€™s all 32-bit.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3610de970c-pi"><img alt="OLEDB03" border="0" height="187" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3667dd970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="OLEDB03" width="480" /></a></p>
<p>&#0160;</p>
<p>There are some definite drawbacks to the Inventor32bitHost.exe approach:</p>
<ol>
<li>An extra process is being started. This is the reason for the slow start-up time when you first run VBA after starting Inventor. The Inventor32bitHost.exe process isnâ€™t started until itâ€™s needed but you pay the price then.</li>
<li>Running VBA in a separate process outside of Inventor means that the Inventor API calls are being made between two processes. Out of process API calls are much more expensive since each call needs to be wrapped to pass the call information between the two processes.</li>
<li>API calls that use certain argument types are not supported when using a COM Automation interface between two processes. For example, getting the thumbnail image of a document is not possible because it passes the image through the API.</li>
<li>There were also other issues and we had a list of reported issues that we really couldnâ€™t do much about because of the architecture.</li>
</ol>
<p>Initially we were told that there would only ever be a 32-bit version of VBA available and thought we would have to live with the Inventor32bitHost solution. We looked at possible alternatives, including VSTA (Visual Studio Tools for Applications) and Python but they didnâ€™t have the same ease of use that VBA has and would have forced customers to migrate all of their existing programs. At some point Microsoft changed their minds and released a 64-bit version of VBA and we were able to incorporate this into the Inventor 2014 release.</p>
<p><strong>Inventor 2014 <br /></strong>The picture below illustrates whatâ€™s happening now. Youâ€™ll notice the architecture is exactly the same as with a 32-bit version of Inventor except everything is 64-bit. This solves all of the problems we were having with the 32-bit workaround; we now have fast VBA startup, fast program execution, and no limitations on API calls.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3610e3970c-pi"><img alt="OLEDB02" border="0" height="202" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff3667e4970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="OLEDB02" width="253" /></a></p>
<p>&#0160;</p>
<p><strong>Issues</strong> <br />After the release of Inventor 2014 and thinking all of our problems were solved we started to get some reports from customers having problems with their VBA programs that use an Access database. The cause of the problem is that they were using the 32-bit version of the OLEDB Provider component. This probably should have been a fairly obvious cause of the problem but there are some side issues that made this a bit more of a difficult issue to diagnose.</p>
<p>The most common way to get the the 64-bit OLEDB Provider component is to install 64-bit Microsoft Office. I believe the first version of Office where you had the option of a native 64-bit install was Office 2010.</p>
<p><strong>Issue 1 <br /></strong>After some testing and some communication with Microsoft itâ€™s been verified that when you install MS Office only one bitness (32 or 64 bit) of the OLEDB Provider is installed; the one that matches the bitness of Office thatâ€™s installed. Ideally, when installing Microsoft Office on a 64-bit machine it would be good if it installed both the 32 and 64 bit versions of the OLEDB Provider component whether you install the 32 or 64 bit version of Office.</p>
<p>The other thing we learned is that itâ€™s not possible to have both the 32 and 64 bit versions of the component installed at the same time on a machine.</p>
<p>The following MSDN article discusses this.&#0160; <a href="http://msdn.microsoft.com/en-us/library/office/ff965871(v=office.14).aspx#DataProgrammingWithAccess2010_using32vs64ace">Data Programming with Microsoft Access 2010: Using 32-bit and 64-bit ACE Providers</a></p>
<p>Where this can be a problem is if you have both 32 and 64 bit applications that use the OLEDB Provider component.&#0160; With this limitation itâ€™s not possible that both of them can work.</p>
<p><strong>Issue 2 <br /></strong>As I said above, the typical way to install the OLEDB Provider component is to install MS Office. Thereâ€™s a problem with this if youâ€™re using MS Office 365. When it installs the OLEDB Provider component, it registers it in a way that itâ€™s accessible from within the Office applications but not from other applications. So that means itâ€™s not usable from Inventorâ€™s VBA. Microsoft has verified this and is investigating the problem.</p>
<p><strong>Possible Solutions </strong></p>
<ol>
<li>Install a 64-bit version of Office (but not Office 365 because of Issue 2 described above). Installing Office will also install the OLEDB Provide component.</li>
<li>If youâ€™ve installed MS Office 365, you can install the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=13255">Microsoft Access Database Engine 2010 Redistributable</a>. Make sure you select the file â€œAccessDatabaseEngine_x64.exeâ€ for download to get the 64-bit version.&#0160; Be aware that this still doesnâ€™t solve the issue of having both the 32 and 64 bit versions of the component installed at the same time.</li>
</ol>
<p><strong>Issues <br /></strong>In all cases the solution is not compatible with a 32-bit version of Office since it has installed the 32 bit version of the OLEDB Provider component.&#0160; Because of issue 1 described above you have to have either 32 or 64 bit and canâ€™t mix the two as far as the OLEDB Provider component. This means to use the OLEDB Provider component in Inventor 2014 you will need to have a 64-bit version of Inventor.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jimmy Bergmark - JTB World
EMAIL: info@jtbworld.com
IP: 85.228.240.13
URL: http://profile.typepad.com/jtbworld
DATE: 09/06/2013 06:48:35 PM
Only problem with the solution is that AccessDatabaseEngine_x64.exe cannot be installed if you already have 32-bit Office installed.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.218
URL: http://profile.typepad.com/1218580234s15464
DATE: 09/06/2013 06:58:52 PM
You are correct and it's something I should have mentioned.  You'll need to have 64-bit Office installed.  Installing that, other than with Office 365, will also install the correct database component.
-----
COMMENT:
AUTHOR: Jimmy Bergmark - JTB World
EMAIL: info@jtbworld.com
IP: 85.228.240.13
URL: http://profile.typepad.com/jtbworld
DATE: 09/06/2013 07:03:03 PM
Unfortunately many companies still need Office 32-bit installed for different reasons.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.218
URL: http://profile.typepad.com/1218580234s15464
DATE: 09/06/2013 11:27:29 PM
You're correct here too, but unfortunately because of the current limitations of the OLEDB Provider component there aren't any alternatives.  I've updated the post to talk about these issues.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with Cameras (Part 1)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: working-with-cameras-part-1
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/09/working-with-cameras-part-1.html 
DATE: 09/04/2013 12:38:03 AM
-----
BODY:
<p>In my previous <a href="http://modthemachine.typepad.com/my_weblog/2013/08/high-school-interns-at-autodesk.html">post</a> I linked to an animation that a high school intern created using Inventor. A critical piece required to create the animation is the ability to control the camera within Inventor.</p>
<p>First, what is a camera within Inventor?&#0160; You can consider Inventor cameras to be the equivalent of a real-world camera. If youâ€™re holding a camera you can move to any location, point that camera in a certain direction, tilt the camera in any orientation, and take a picture.&#0160; All of that is the same with an Inventor camera except itâ€™s a virtual camera that only lives within an Inventor document.&#0160; When you use Inventor interactively to zoom in/out, pan, and rotate the view youâ€™re actually manipulating the camera and seeing the result of what the camera sees in the graphics view. The model always remains fixed in model space but as you rotate, pan, and zoom the view youâ€™re just moving the camera around the model. The pictures below illustrate this. The picture on the left shows the model in model space and a camera. The picture on the right shows what the camera is seeing and what is displayed in the graphics window. By moving the camera around the model, the picture in the graphics window changes.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b35970d-pi"><img alt="Camera02" border="0" height="177" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2c4b64970b-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera02" width="480" /></a></p>
<p>In the API, a View object represents a graphics window in the Inventor user-interface. The view can be sized, collapsed, maximized, and deleted. Additional views can also be created. The Camera API object is an API only concept thatâ€™s not directly seen in the user-interface since all of the user-interaction to manipulate the camera is done through the view. The camera controls what is displayed in the view.</p>
<p>There are two types of cameras; perspective and orthographic (parallel). Iâ€™ll begin by discussing perspective cameras because theyâ€™re easier to understand since they behave in much the same way as a real-world camera. In Inventor you can switch between an orthographic or perspective camera using the command in the View tab of the ribbon or the context menu of the view cube.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b3b970d-pi"><img alt="Camera10" border="0" height="280" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b41970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera10" width="408" /></a></p>
<p>There are three basic properties that apply to all cameras (perspective and orthographic); eye point, target point, and up vector. The eye point is the position of the camera in model space. With just the eye point defined the camera is fixed at a specific location but can be pointed anywhere and rotated to any angle. The target point is the location in space that the camera is pointed. With the eye and target point defined the camera can still be rotated to get a landscape, portrait, or anything in between orientation. The up vector defines a direction in model space that defines the direction the top of camera is pointed. With these three properties defined the camera is fully positioned.</p>
<p>For a perspective camera the other property you can define is the perspective angle. A camera sees a certain area in front of it, which is referred to as its <em>field of view</em>. The field of view of a perspective camera is represented by a view pyramid and the angle of the pyramid that controls this field of view is called the perspective angle. Changing the perspective angle of a camera is the same as zooming with a real camera. By narrowing the field of view you see less of the model, effectively zooming in on a smaller area, as shown below where the perspective angle has been narrowed in the picture on the right.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b47970d-pi"><img alt="Camera03" border="0" height="183" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2cac7e970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera03" width="480" /></a></p>
<p>With a perspective camera thereâ€™s also a second way to zoom in on the part. Just like with a real camera you can just move closer to the object, as illustrated below. As you zoom in and out in Inventor with a perspective camera, this is what Inventor is doing; moving the camera closer or further away from the model.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2cac83970c-pi"><img alt="Camera04" border="0" height="185" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b53970d-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera04" width="234" /></a></p>
<p>Another behavior of a perspective camera is objects that are further away from the camera appear smaller, just as they do in the real world. You can see why that is because something that is further away takes up less of the field of view, since the size of the field of view gets bigger the further away from the camera it is. Things closer fill more of the field of view and appear larger.&#0160; In the picture below all of the boxes are the same physical size but because theyâ€™re different distances from the camera they appear as different sizes.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2c4b7c970b-pi"><img alt="Camera08" border="0" height="191" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b5b970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Camera08" width="480" /></a></p>
<p>I said earlier that when you zoom in and out with a perspective view Inventor moves the eye point to position the camera closer or further away from the model.&#0160; This is true but itâ€™s also possible to leave the camera positioned at the same location and change the perspective angle.&#0160; To do this, first make sure Inventor is using a perspective camera and then press and hold the Shift and Ctrl keys while rolling the mouse wheel (middle button).&#0160; As the field of view narrows the view looks more like an orthographic view (the picture on the left) and as it widens you get more of a contrast between objects close and far away from the camera (the picture on the right).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b60970d-pi"><img alt="Camera11" border="0" height="98" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2d0b65970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Camera11" width="480" /></a></p>
<p>Orthographic or parallel cameras donâ€™t follow any of these natural behaviors that weâ€™re used to. Instead of a view pyramid, parallel cameras have a rectangular box and the camera sees everything within the box. One of the effects of this is that everything appears the same size regardless of how close it is to the camera. This is because everything takes up the same area in the field of view regardless of how close it is to the camera. The second big difference is that moving the camera closer to the object doesnâ€™t zoom in. This is illustrated below. The model still takes up the same amount of area in the field of view no matter how close the camera is to the object.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2cac99970c-pi"><img alt="Camera05" border="0" height="198" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2cac9d970c-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Camera05" width="480" /></a></p>
<p>To zoom in with a parallel camera the size of the viewing box is changed, reducing the field of view.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2caca6970c-pi"><img alt="Camera06" border="0" height="183" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff2cacad970c-pi" style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="Camera06" width="266" /></a></p>
<p>In the next post weâ€™ll start looking at how to use the API to control the camera.</p>
<p>See the <a href="http://modthemachine.typepad.com/my_weblog/2013/09/working-with-cameras-part-2.html">next post</a> in this series.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: High School Interns at Autodesk
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: high-school-interns-at-autodesk
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/08/high-school-interns-at-autodesk.html 
DATE: 08/30/2013 01:01:59 AM
-----
BODY:
<p>This summer we had nine high school interns working here in the Lake Oswego office, (just outside of Portland, Oregon).&#0160; They were assigned to different groups within the manufacturing division where they spent half their time working on a project specific for that group.&#0160; The other half of their time was spent on a group project.&#0160; The common denominator for all of the students is that theyâ€™re active in the <a href="http://www.usfirst.org/roboticsprograms/frc">FIRST Robotics Competition</a>, where high schools have teams that design and build robots to perform certain tasks and compete against robots from other schools.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff13f4ba970b-pi"><img alt="Interns2013" border="0" height="322" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019aff13f4bf970b-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Interns2013" width="484" /></a></p>
<p>I was fortunate enough to be a mentor for Kevin, (second from the right on the back row), and worked with him on his individual project. Even though Kevin has participated in the FIRST program, he hadnâ€™t worked with Inventor.&#0160; However, Kevin did have some programming experience which is why we was assigned to the Inventor framework group. It was a bit of a challenge coming up with a project that can be finished in a short amount of time and provides a good learning experience.&#0160; We had one false start but then came up with another project that I believe turned out very good.&#0160; Kevin was able to learn some basics about Inventor and the API and was also able to use and expand his programming skills.</p>
<p>As a result of Kevinâ€™s work and research we now know that the goal we were working towards is not currently possible without some additional work being done inside Inventor.&#0160; I was hoping we could implement the entire project using the API.&#0160; I donâ€™t want to describe in detail what Kevin was working on because Iâ€™m still hopeful it will show up in Inventor one day but it was something I believe will make the API a little more accessible for those that arenâ€™t comfortable programming and navigating Inventorâ€™s API.</p>
<p>Once we realized there were some road blocks to finishing up the main project, Kevin wrapped up the project the best he could and then started playing with Inventor and the API.&#0160; Below is a video that he produced.&#0160; Itâ€™s done completely with Inventor except for the use of <a href="http://ffmpeg.org/">FFmpeg</a> to create a video from a series of images.</p>
<div class="wlWriterEditableSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:d8848c38-abf5-438c-9e8b-a7c0f3fe04f8" style="float: none; margin: 0px; display: inline; padding: 0px;">
<div><object height="262" width="467"><param name="movie" value="http://www.youtube.com/v/CYYr3gO4fbI?hl=en&amp;hd=1" /></object></div>
</div>
<p>The camera is following a curve and using the curvature of the curve to control the roll.&#0160; Keep an eye out for additional postings here where Iâ€™ll discuss the portions of the API that were used to create the video.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Exchange Apps Portathon
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-apps-portathon
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/08/autodesk-exchange-apps-portathon.html 
DATE: 08/20/2013 06:42:32 PM
-----
BODY:
<p>Have you written any add-ins that you think should be on the Autodesk Exchange Store? The Autodesk Exchange Apps Portathon is designed to help you convert your add-ins into Autodesk Exchange Apps quickly and easily.&#0160; The event runs for 48 hours on&#0160; September 13 and 14, 2013.&#0160; Autodesk Exchange Apps has become the number one way for partners and developers to reach Autodesk customers - around the globe and in local languages.&#0160; Over 100 developers working on over 250 apps have already signed up.&#0160; There&#39;s still time to join this coding festival.&#0160;</p>
<p>If you submit your apps by midnight on September 14, 2013 and if they are accepted for publication in the store by October 31, 2013, you will receive US$ 100 per app (for up to 5 apps â€“ US$ 500 total).</p>
<p>For a video introduction see <a href="http://youtu.be/zLKZB2sdxyA">http://youtu.be/zLKZB2sdxyA</a> and details about the event visit <a href="http://autode.sk/15DjZpq">http://autode.sk/15DjZpq</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Attribute Helper Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: attribute-helper-update
CATEGORY: Attributes
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/08/attribute-helper-update.html 
DATE: 08/20/2013 05:28:12 PM
-----
BODY:
<p>One of the most useful utilities Iâ€™ve written has been the Attribute Helper add-in which I first discussed <a href="http://modthemachine.typepad.com/my_weblog/2009/09/attribute-utility.html">here</a>. Iâ€™ve updated it and fixed a few problems. The new version is now available. Itâ€™s for Inventor 2013 and later. To install it, just download the zip file, unpack it and run AttributeHelperSetup.exe which will install it on your machine.&#0160; You should now see the Attribute Helper command in the Tools tab of the ribbon as shown below.&#0160; There is some documentation delivered with the utility that describes in more detail how to use it.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901ee4b0b9970b-pi"><img alt="AttribHelper" border="0" height="369" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340192aca4020a970d-pi" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="AttribHelper" width="479" /></a></p>
<p>If you ever want to use attributes you should install this utility because it makes working with them much easier. <a href="http://modthemachine.typepad.com/AttributeHelperSetup.zip">Download AttributeHelperSetup.zip (823.5K)</a></p>
<p>To learn more about attributes see this previous <a href="http://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html">post</a>.</p>
<p>Please let me know if you find any problems or have suggestions for enhancements.</p>
<p>-Brian</p>
<p><span style="color: #bf005f;"><strong>Update (August 10, 2015)</strong></span>: This post is now out of date because a newer update is now available.&#0160; You can learn more about it and get it <a href="http://modthemachine.typepad.com/my_weblog/2015/08/attribute-helper-update.html" target="_self" title="here">here</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: sky
EMAIL: starboy12@hotmail.com
IP: 208.54.45.138
URL: 
DATE: 08/20/2013 09:03:02 PM
Hi, I dont see the link for updated version. Please point it out. Thanks.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.219
URL: http://profile.typepad.com/1218580234s15464
DATE: 08/20/2013 09:09:25 PM
Thanks for pointing that out.  I've updated the post.
-----
COMMENT:
AUTHOR: sky
EMAIL: starboy12@hotmail.com
IP: 71.190.5.235
URL: 
DATE: 08/21/2013 04:47:40 AM
this is great. thanks again.
-----
COMMENT:
AUTHOR: Amoolya Deeven Nuthalapati
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 08/22/2013 02:15:28 AM
great stuff. cheers
-----
COMMENT:
AUTHOR: sky
EMAIL: starboy12@hotmail.com
IP: 71.190.6.195
URL: 
DATE: 08/23/2013 05:24:23 AM
hi,
after the addin is loaded, I lost menu from inventor when I did left mouse click. is it possible to get it back? it seems to me that this addin replace left mouse click menu.

thanks
-----
COMMENT:
AUTHOR: Marco
EMAIL: suurlant@ziggo.nl
IP: 84.26.121.190
URL: 
DATE: 10/06/2013 01:08:42 PM
Hi Brain,

Is it possible to provide the source code as in the last blog of the attribute, so that I can modify it for Inventor 2012.

Thanks Marco.

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Updating Parts Through an Assembly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: updating-parts-through-an-assembly
CATEGORY: Assemblies
CATEGORY: Brian
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/08/updating-parts-through-an-assembly.html 
DATE: 08/16/2013 12:48:56 AM
-----
BODY:
<p>Have you written some code to do some type of operation on a part, (i.e. create/update a parameter, create/update an iProperty, etc.), and now would like to perform that update on every part thatâ€™s used within a particular assembly?&#0160; I have good news, if youâ€™ve already figured out how to do the work for a single part, doing it for all of the parts in an assembly is a simple step away.&#0160; Letâ€™s look at updating a single part first and the progression of that program to updating a complete assembly.</p>
<p>Below is a typical VBA macro that creates or updates a parameter in a part.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateParameter() <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the active part. <br /></strong></span>&#0160;&#0160;&#0160; Dim part As PartDocument <br />&#0160;&#0160;&#0160; Set part = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the user parameters collection. <br /></strong></span>&#0160;&#0160;&#0160; Dim userParams As UserParameters <br />&#0160;&#0160;&#0160; Set userParams = _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; part.ComponentDefinition.Parameters.UserParameters <br /> <br /><strong><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Check to see if the parameter already exists. <br /></span></strong>&#0160;&#0160;&#0160; Dim param As Parameter <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set param = userParams.Item(&quot;SomeValue&quot;) <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If param Is Nothing Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; The parameter doesn&#39;t exist so add it. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set param = userParams.AddByExpression(&quot;SomeValue&quot;, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;2 inch&quot;, kDefaultDisplayLengthUnits) <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
</div>
<p>Hereâ€™s a variation of the macro above converted into a Sub that gets the part document through an argument. The additional code for the argument is highlighted below and the first portion of the code where it got the active document in the sample above has been removed since the document is now passed to it.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateParameter(<span style="background-color: #ffff00;">part As PartDocument</span>) <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the user parameters collection. <br /></strong></span>&#0160;&#0160;&#0160; Dim userParams As UserParameters <br />&#0160;&#0160;&#0160; Set userParams = _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; part.ComponentDefinition.Parameters.UserParameters <br /> <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Check to see if the parameter already exists. <br /></strong></span>&#0160;&#0160;&#0160; Dim param As Parameter <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set param = userParams.Item(&quot;SomeValue&quot;) <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If param Is Nothing Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; The parameter doesn&#39;t exist so add it. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set param = userParams.AddByExpression(&quot;SomeValue&quot;, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;2 inch&quot;, kDefaultDisplayLengthUnits) <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
</div>
<p>Hereâ€™s the macro that calls the sub above.&#0160; It gets the active part document and calls the Sub, passing it the part document.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdatePart() <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the active part. <br /></strong></span>&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Call the function to update the part. <br /></strong></span>&#0160;&#0160;&#0160; Call AddParameter(partDoc) <br />End Sub</p>
</div>
<p>Now we want to perform this same update to every part in the active assembly.&#0160; The code to do that is below.&#0160; It gets the active document, which in this case is an assembly and then uses the AllReferencedDocuments property of the assembly document to get the documents referenced by the assembly.&#0160; It then looks for the parts, to skip any referenced subassemblies, and calls the AddParameter sub just the same as before, passing in the part document.&#0160; This is the same PartDocument object you would get if you opened the part by itself and used the Application.ActiveDocument property.&#0160; The only difference is how you got the PartDocument object which in this case is through the assembly. </p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateAssembly() <br />&#0160;&#0160;&#0160; Dim asmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set asmDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Iterate through all of the referenced documents at <br />&#0160;&#0160;&#0160; &#39; all levels of the assembly. <br /></strong></span>&#0160;&#0160;&#0160; Dim doc As Document <br />&#0160;&#0160;&#0160; For Each doc In asmDoc.AllReferencedDocuments <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check for part documents. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If doc.DocumentType = kPartDocumentObject Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Call the function to update the part. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call AddParameter(doc) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br />End Sub</p>
</div>
<p>The function getting the part document can do anything to the part because it is a full PartDocument object.&#0160; It doesnâ€™t even know how the reference was obtained.&#0160; There are no limitations. </p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: ioannis_gkiokas@hotmail.com
EMAIL: ioannis_gkiokas@hotmail.com
IP: 138.246.55.63
URL: 
DATE: 09/24/2013 03:10:32 PM
could you write please the corresponding code in C#?
-----
COMMENT:
AUTHOR: Philip Lyles
EMAIL: toohansam@gmail.com
IP: 112.198.90.99
URL: http://www.brinksmachine.com/
DATE: 12/12/2013 10:41:21 AM
Wonderful article. I got a lot of great information from it that can really be useful. Thanks a lot for sharing. Please keep posting more.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Comparing Floating Point Numbers
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: comparing-floating-point-numbers
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/08/comparing-floating-point-numbers.html 
DATE: 08/12/2013 10:26:00 PM
-----
BODY:
<p>What Iâ€™m going to discuss isnâ€™t anything specific to Inventor but is a general issue to be aware of when working with computers and floating point numbers. The thing you need to understand is that floating point numbers are not always exact.&#0160; Theyâ€™re very very close to the expected number and close enough for computations but you can run into problems when comparing numbers.&#0160; Below is a VBA sample that illustrates the problem.&#0160; I want to emphasize that the issue is not limited to VBA but can be seen with any programming language.</p>
<p style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">Public Sub CompareNumbers()&#0160; <br />&#0160;&#0160;&#0160; Dim val1 As Double&#0160; <br />&#0160;&#0160;&#0160; val1 = 0.1 + 0.1 + 0.1 <br /> <br />&#0160;&#0160;&#0160; Dim val2 As Double&#0160; <br />&#0160;&#0160;&#0160; val2 = 0.3 <br /> <br />&#0160;&#0160;&#0160; Debug.Print &quot;val1 = &quot; &amp; CStr(val1) &amp; &quot;, val2 = &quot; &amp; CStr(val2) <br /> <br />&#0160;&#0160;&#0160; If val1 = val2 Then&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values match&quot; <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values do not match&quot; <br />&#0160;&#0160;&#0160; End If <br /> <br />&#0160;&#0160;&#0160; Debug.Print &quot;Difference = &quot; &amp; val1 â€“ val2 <br />End Sub</p>
<p>When I run the program above I get the following results in the Immediate window.</p>
<blockquote>
<p><span style="font-family: &#39;Courier New&#39;;">val1 = 0.3, val2 = 0.3 <br />Values do not match <br />Difference = 5.55111512312578E-17</span></p>
</blockquote>
<p>The first line is what you would expect but the second and third lines are a bit of a surprise.&#0160; You would expect the two variables to have the same value but the comparison shows that they are not equal and the last line shows by how much they are different; 0.0000000000000000555111512.&#0160; That value is close enough to being equal that in almost all cases you donâ€™t need to care about the difference but when using the â€œ=â€ comparison they must match exactly.</p>
<p>More than you ever wanted to know about why this happens can be found at <a href="http://en.wikipedia.org/wiki/Floating_point">http://en.wikipedia.org/wiki/Floating_point</a>.&#0160; A simpler explanation can be found here: <a href="http://floating-point-gui.de/" title="http://floating-point-gui.de/">http://floating-point-gui.de/</a>&#0160;</p>
<p><strong>The Solution</strong> <br />The solution to this problem is to not ever expect floating point numbers to be exactly equal but instead allow for them to be equal within a tolerance.&#0160; This is described in one of the links I provided above (<a href="http://floating-point-gui.de/errors/comparison/" title="http://floating-point-gui.de/errors/comparison/">http://floating-point-gui.de/errors/comparison/</a>).&#0160; Hereâ€™s my simple solution which according to the link is not the right way to do it, but I think in my case it works because I know the range of values that Iâ€™m working with.&#0160; Anyone working with Inventor is limited to sizes and tolerances that Inventor can handle so we know weâ€™re not working with sizes in light years or nanometers.&#0160; When comparing two points, Inventor considers them to be the same if theyâ€™re within 0.0000000001 centimeters.</p>
<p>The code below is a modified version of the previous Sub that uses a function to do the value comparison.</p>
<p style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">Public Sub CompareNumbers2() <br />&#0160;&#0160;&#0160; Dim val1 As Double <br />&#0160;&#0160;&#0160; val1 = 0.1 + 0.1 + 0.1 <br /> <br />&#0160;&#0160;&#0160; Dim val2 As Double <br />&#0160;&#0160;&#0160; val2 = 0.3 <br /> <br />&#0160;&#0160;&#0160; Debug.Print &quot;val1 = &quot; &amp; CStr(val1) &amp; &quot;, val2 = &quot; &amp; CStr(val2) <br /> <br />&#0160;&#0160;&#0160; If <span style="background-color: #ffff00;">IsEqual(val1, val2)</span> Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values match&quot; <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values do not match&quot; <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
<p>Below is the IsEqual function that compares to the two values within the specified tolerance.</p>
<p style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">Public Function IsEqual(Value1 As Double, Value2 As Double, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Optional Tolerance As Double = 0.000000000001) As Boolean <br />&#0160;&#0160;&#0160; If Abs(Value1 - Value2) &lt; Tolerance Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IsEqual = True <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IsEqual = False <br />&#0160;&#0160;&#0160; End If <br />End Function</p>
<p>Below is a more elaborate version of the IsEqual function that supports various types of comparisons.</p>
<p style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;"><span style="color: #0000ff;">&#39; Compares two numbers to see if they meet the comparison condition </span> <br /><span style="color: #0000ff;">&#39; within the specified tolerance. </span> <br /><span style="color: #0000ff;">&#39; Valid comparison operators are, &quot;=&quot; &quot;&lt;&quot;, &quot;&gt;&quot;, &quot;&lt;=&quot;, and &quot;&gt;=&quot;. </span> <br />Public Function NumbersCompare(Value1 As Double, Value2 As Double, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; operator As String, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Optional Tolerance As Double = 0.000000000001) As Boolean <br />&#0160;&#0160;&#0160; Dim difference As Double <br />&#0160;&#0160;&#0160; difference = Abs(Value1 - Value2) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim comparison As String <br />&#0160;&#0160;&#0160; comparison = &quot;&quot; <br />&#0160;&#0160;&#0160; Dim equals As Boolean <br />&#0160;&#0160;&#0160; equals = False <br />&#0160;&#0160;&#0160; If Len(operator) = 2 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Determine if the operator is greater or less than. </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Mid(operator, 1, 1) = &quot;&gt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; comparison = &quot;&gt;&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ElseIf Mid(operator, 1, 1) = &quot;&lt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; comparison = &quot;&lt;&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;Bad comparison operator: &quot; &amp; operator <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Determine if equals to is specified. </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Mid(operator, 2, 1) = &quot;=&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; equals = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;Bad comparison operator: &quot; &amp; operator <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; ElseIf Len(operator) = 1 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Determine if the operator is greater than, </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; less than, or equals to. </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If operator = &quot;&gt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; comparison = &quot;&gt;&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ElseIf operator = &quot;&lt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; comparison = &quot;&lt;&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ElseIf operator = &quot;=&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; equals = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;Bad comparison operator: &quot; &amp; operator <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;Bad comparison operator: &quot; &amp; comparison <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Do the actual comparisons. </span> <br />&#0160;&#0160;&#0160; If operator = &quot;&gt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Check if the value is greater than, using the tolerance. </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Value1 + Tolerance &gt; Value2 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; ElseIf operator = &quot;&lt;&quot; Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Check if the value is less than, using the tolerance. </span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Value1 - Tolerance &lt; Value2 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; End If <br /> <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Check if the numbers are equal, within the tolerance. </span> <br />&#0160;&#0160;&#0160; If equals Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If difference &lt;= Tolerance Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NumbersCompare = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; End If <br />End Function</p>
<p>Hereâ€™s an example of the function above in use.</p>
<p style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%;">Public Sub CompareNumbers3() <br />&#0160;&#0160;&#0160; Dim val1 As Double <br />&#0160;&#0160;&#0160; val1 = 0.1 + 0.1 + 0.1 <br /> <br />&#0160;&#0160;&#0160; Dim val2 As Double <br />&#0160;&#0160;&#0160; val2 = 0.3 <br /> <br />&#0160;&#0160;&#0160; Debug.Print &quot;val1 = &quot; &amp; CStr(val1) &amp; &quot;, val2 = &quot; &amp; CStr(val2) <br /> <br />&#0160;&#0160;&#0160; If <span style="background-color: #ffff00;">NumbersCompare(val1, val2, &quot;&lt;=&quot;)</span> Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values compare&quot; <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Values do not compare&quot; <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
<p>This is only a problem when working with floating point numbers.&#0160; Integers and strings are always exact and exact comparisons will work as expected.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Amoolya Deeven Nuthalapati
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 08/13/2013 01:11:21 AM
Very usefull !!!
Thanks Indeed...
-----
COMMENT:
AUTHOR: Amoolya Deeven Nuthalapati
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 08/13/2013 01:25:15 AM
Brian..

Can how do we compare AlphaNumeric Values??
If we have an array Like
100A
900
1200
1000
1235
2040

we expect array to sort out like

100A
900
1000
1200
1235
2040

How to get this sorting?? can we use same logic as you showed in your blog??
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.219
URL: http://profile.typepad.com/1218580234s15464
DATE: 08/13/2013 05:59:01 PM
What I discussed in this post doesn't apply to your specific issue.  Floating point accuracy is a completely different issue.

What's happening in your case is that you need to sort a series of strings in a particular way.  I recommend doing a search on sorting algorithms.  Depending on what your application is you might also be able to take advantage of sorting capabilities built into some of the Microsoft controls. 
-----
COMMENT:
AUTHOR: Amoolya Deeven Nuthalapati
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 08/14/2013 03:53:46 AM
Thanks Brian for the reply.

I got my head around floating point concept when writing export scripts for production.
And with sorting, I found Quick sort and bubble sort as quick and easy to use.
But, when sorting, how to compare alphanumeric values(they have to be declared as variant)???

For i = lngMin To lngMax - 1
    For j = i + 1 To lngMax
      If arr(i)) > arr(j)) Then
        strTemp = arr(i)
        arr(i) = arr(j)
        arr(j) = strTemp
      End If
    Next j
 Next i

any objects like Cstr,If IsNumeric are there to compare?? 
It wil be very helpful if we got around this.
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Add-In with event example to replace auto-run macros in 2014
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: add-in-with-event-example-to-replace-auto-run-macros-in-2014
CATEGORY: Add-In Creation
CATEGORY: Beginning API
CATEGORY: Inventor
CATEGORY: iProperties
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/07/add-in-with-event-example-to-replace-auto-run-macros-in-2014.html 
DATE: 07/26/2013 10:46:37 PM
-----
BODY:
<p>Inventor 2014 no longer supports VBA auto-run macros. Here is an excerpt from the Inventor API help file:</p>
<p><em>Autodesk Inventor 2014 removes support for VBA auto-run macros that are embedded in Autodesk Inventor documents. The VBA macros are AutoOpen, AutoNew, AutoSave, AutoClose, and AutoEdit. They can severely impact Autodesk Inventor performance, and pose a possible security risk. The suggested alternative to auto macros is an add-in. Add-ins don&#39;t have the performance and security issues of auto macros and provide much better source control.</em></p>
<p>If you are using VBA auto-run Macros you will need to start using events to get the same functionality. In one case the AutoSave macro was being used to add the time and day to custom iProperties. This stopped working in Inventor 2014. To get the behavior back an Add-In with an OnSaveDocument event needed to be used. Here is the VB.NET (VS 2010) project that creates an Add-In that that can be used to replace the behavior of the AutoSave VBA macro.</p>
<p><span class="asset  asset-generic at-xid-6a00e553fcbfc688340192ac355b4c970d"><a href="http://modthemachine.typepad.com/files/addin_with_saved_event.zip">Download AddIn_With_Saved_Event</a></span>&#0160;</p>
<p>There are instructions for creating an Add-In in the API help file.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340191046c12a9970c-pi"><img alt="image" border="0" height="350" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191046c12ba970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="514" /></a></p>
<p>.</p>
<p><strong>Here is the event callback:</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> m_ApplicationEvents_OnSaveDocument _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: blue;">ByVal</span> DocumentObject <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">_Document</span>,</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">ByVal</span> BeforeOrAfter <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">EventTimingEnum</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">ByVal</span> Context <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">NameValueMap</span>,</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">ByRef</span> HandlingCode <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">HandlingCodeEnum</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> BeforeOrAfter = <span style="color: #2b91af;">EventTimingEnum</span>.kBefore <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Ensure active document is a Drawing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> m_inventorApplication.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ActiveDocumentType = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">DocumentTypeEnum</span>.kDrawingDocumentObject <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get the custom iProperties</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPropSet <span style="color: blue;">As</span> <span style="color: #2b91af;">PropertySet</span> = _</p>
<p style="margin: 0px;">m_inventorApplication.ActiveDocument.PropertySets _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;{D5CDD505-2E9C-101B-9397-08002B2CF9AE}&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> bDateAdded <span style="color: blue;">As</span> <span style="color: blue;">Boolean</span> = <span style="color: blue;">False</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> bTimeAdded <span style="color: blue;">As</span> <span style="color: blue;">Boolean</span> = <span style="color: blue;">False</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> prop <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> prop <span style="color: blue;">In</span> oPropSet</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> prop.Name = <span style="color: #a31515;">&quot;SysDate&quot;</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; prop.Value = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(<span style="color: blue;">Date</span>.Now, <span style="color: #a31515;">&quot;MMM-d-yy&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bDateAdded = <span style="color: blue;">True</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> prop.Name = <span style="color: #a31515;">&quot;SysTime&quot;</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; prop.Value = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(<span style="color: blue;">Date</span>.Now, <span style="color: #a31515;">&quot;hh:mm:ss tt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bTimeAdded = <span style="color: blue;">True</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; If the drawing does not have the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; SysDate custom property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> bDateAdded = <span style="color: blue;">False</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPropSet.Add(Format(<span style="color: blue;">Date</span>.Now, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;MMM-d-yy&quot;</span>), <span style="color: #a31515;">&quot;SysDate&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; If the drawing does not have the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; SysTime custom property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> bTimeAdded = <span style="color: blue;">False</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPropSet.Add(Format(<span style="color: blue;">Date</span>.Now, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;hh:mm:ss tt&quot;</span>), <span style="color: #a31515;">&quot;SysTime&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span> <span style="color: green;">&#39; if document is a drawing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> <span style="color: #2b91af;">Exception</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox(ex.ToString())</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span> <span style="color: green;">&#39;if before save</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><em>&#0160;</em></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sanjay
EMAIL: sanjaysy@yahoo.com
IP: 121.241.185.130
URL: 
DATE: 08/07/2013 06:20:48 AM
Hello,

Can you please send me the vb.net 2010 template for inventor 2013 add-in. i have one but it is not loading into inventor properly.

thanks & regards,
Sanjay
-----
COMMENT:
AUTHOR: Adriano
EMAIL: adriano.c.bastos@gmail.com
IP: 200.242.218.140
URL: 
DATE: 10/07/2013 10:41:09 PM
Please help me. Drawing I had a file with a macro in VBA in Inventor, but the 2014 version it does not work. This Macro pulled the name, date and time of the moment he would do the printing.
Could you help me?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.60
URL: 
DATE: 10/07/2013 11:14:35 PM
Hello Adriano,

Perhaps you could use a command event. This blog article is about Vault but the idea of using the event would be similar.   
<a href="http://adndevblog.typepad.com/manufacturing/2012/05/printing-watermark-on-inventor-file-while-checking-it-in-vault.html">http://adndevblog.typepad.com/manufacturing/2012/05/printing-watermark-on-inventor-file-while-checking-it-in-vault.html</a>

You could also ask this question on the discussion group:
<a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/bd-p/120">http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/bd-p/120</a>

The community could have a good suggestion for this. Also my colleagues and I do answer questions there. (upload a file with the macro that works in 2013) 

I am not finding a working example to provide at this time.

Thanks,
Wayne 
-----
COMMENT:
AUTHOR: RenÃ©
EMAIL: rvanderstarre@polem.nl
IP: 195.73.172.58
URL: 
DATE: 01/13/2014 09:50:32 AM
In 2007 there was a download link for templates 'VB 2008' and 'C++ 2008'. Is VB 2008 still supported in Inventor 2014, or is there already an 'inventor add-in template' for VB 2010?

Thanks in advance
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.60
URL: 
DATE: 01/13/2014 05:23:16 PM
Hi Rene,

Here is an excerpt from the 2014 Readme.txt for the Wizard. This is in this directory on my system:
C:\Users\Public\Documents\Autodesk\Inventor 2014\SDK\DeveloperTools\Tools\Wizards 

>> >>
Visual Basic.NET, Visual C#.NET:
**********************************************************************************************************

1- Introduction
---------------

This wizard implements the templates for VC#.NET and VB.NET that help in generating Inventor AddIn 
applications. The wizard is integrated into Microsoft Visual Studio .NET (8.0, 9.0 and 10.0). In order to 
use the wizard, you would need to have one of these versions of Microsoft Visual Studio installed. 
<< <<


According to this the Inventor 2014 Add-In Wizard should install on Visual Studio 2010. (VS 10) 


If the wizard does not install please make a post on the Inventor Discussion group. My team does try to ensure that every post in this disucssion group gets an answer.


<a href="http://forums.autodesk.com/t5/Inventor-Customization/bd-p/120">http://forums.autodesk.com/t5/Inventor-Customization/bd-p/120</a>


Thanks,
Wayne 
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.60
URL: 
DATE: 01/13/2014 05:28:30 PM
For some reason my reply is missing this. 


If the wizard does not install please make a post on the Inventor Discussion group. My team does try to ensure that every post in this disucssion group gets an answer.

<a href="http://forums.autodesk.com/t5/Inventor-Customization/bd-p/120">http://forums.autodesk.com/t5/Inventor-Customization/bd-p/120</a>

Thanks,
Wayne 

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor Events using .NET&ndash; 3 examples
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-events-using-net-3-examples
CATEGORY: Beginning API
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: VB.NET
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/07/inventor-events-using-net-3-examples.html 
DATE: 07/18/2013 09:59:44 PM
-----
BODY:
<p>If you are getting started with the Inventor API and you need some examples for adding an event in an Inventor AddIn take a look at these examples. The code snippets below show how to handle ApplicationEvents.OnActivateDocument event using VB.Net and C#. The VB.Net allows use of traditional event handling using WithEvents statement, but also supports .NET style using delegates. There are 3 samples attached covering these ways to add events. The samples display the name of the document after the document is activated. The samples were created using Visual Studio .NET 2010. Please see this Topic in the Inventor API help file if you need instructions on how to get Inventor to load the dll files.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340191044a59ca970c-pi"><img alt="image" border="0" height="258" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e544e64970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="481" /></a></p>
<p>&#0160;</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc688340192ac139ed5970d"><a href="http://modthemachine.typepad.com/files/inventor_events_examples..zip">Download Inventor_Events_Examples.</a></span></p>
<p><strong>VB.Net - WithEvents</strong> <br />1. Declare member variable of type ApplicationEvents.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Class</span> <span style="color: #2b91af;">StandardAddInServer</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Implements</span> Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Inventor application object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Private</span> m_inventorApplication <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Application</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> <span style="color: blue;">WithEvents</span> m_AppEvents <span style="color: blue;">As</span> <span style="color: #2b91af;">ApplicationEvents</span></p>
</div>
<p>&#0160; <br />2. In the Activate method of your AddInServer class, assign ApplicationEvents to member variable:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> Activate(<span style="color: blue;">ByVal</span> addInSiteObject <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApplicationAddInSite</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">ByVal</span> firstTime <span style="color: blue;">As</span> <span style="color: blue;">Boolean</span>) _</p>
<p style="margin: 0px;"><span style="color: blue;">Implements</span> Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span>.Activate</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; This method is called by Inventor when it </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; loads the AddIn.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; The AddInSiteObject provides access to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Inventor Application object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; The FirstTime flag indicates if the AddIn </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; is loaded for the first time.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Initialize AddIn members.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_inventorApplication =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; addInSiteObject.Application</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; TODO:&#0160; Add ApplicationAddInServer.Activate</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; implementation. e.g. event initialization, </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;command creation etc.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_AppEvents =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.ApplicationEvents</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>&#0160; <br />3. Define event handler method. In Visual Studio IDE it&#39;s possible to use Class and Method combo boxes (at the top of open document) to automatically generate it.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> m_AppEvents_OnActivateDocument _</p>
<p style="margin: 0px;">(<span style="color: blue;">ByVal</span> DocumentObject <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">_Document</span>, _</p>
<p style="margin: 0px;"><span style="color: blue;">ByVal</span> BeforeOrAfter <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">EventTimingEnum</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160; <span style="color: blue;">ByVal</span> Context <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">NameValueMap</span>, _</p>
<p style="margin: 0px;"><span style="color: blue;">ByRef</span> HandlingCode <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">HandlingCodeEnum</span>) _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Handles</span> m_AppEvents.OnActivateDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> BeforeOrAfter &lt;&gt;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">EventTimingEnum</span>.kAfter <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (DocumentObject.DisplayName, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;OnActivateDocument VB - WithEvents)&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxButtons</span>.OK, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxIcon</span>.Information)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>&#0160;</strong></p>
<p><strong>&#0160;</strong></p>
<p><strong>VB.Net â€“ Delegates</strong></p>
<p>1. Declare member variable of type ApplicationEvents.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Class</span> <span style="color: #2b91af;">StandardAddInServer</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Implements</span> Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Inventor application object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Private</span> m_inventorApplication <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">Application</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> m_AppEvents <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApplicationEvents</span></p>
</div>
<p>&#0160; <br />2. In the Activate method of your AddInServer class, add delegate to handle ApplicationEvents.OnActivateDocument event:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> Activate(<span style="color: blue;">ByVal</span> addInSiteObject <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApplicationAddInSite</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">ByVal</span> firstTime <span style="color: blue;">As</span> <span style="color: blue;">Boolean</span>) _</p>
<p style="margin: 0px;">&#0160;<span style="color: blue;">Implements</span> Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span>.Activate</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Initialize AddIn members.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_inventorApplication =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; addInSiteObject.Application</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_AppEvents =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.ApplicationEvents</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">AddHandler</span> m_AppEvents.OnActivateDocument,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">AddressOf</span> ApplicationEvents_OnActivateDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>3. Remove the event in the Deactivate method.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> Deactivate() <span style="color: blue;">Implements</span> _</p>
<p style="margin: 0px;">Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span>.Deactivate</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; This method is called by Inventor </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; when the AddIn is unloaded.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; The AddIn will be unloaded either </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; manually by the user or</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; when the Inventor session is terminated.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; TODO:&#0160; Add ApplicationAddInServer.Deactivate </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; implementation()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Release objects.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_inventorApplication = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">RemoveHandler</span> m_AppEvents.OnActivateDocument,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">AddressOf</span> ApplicationEvents_OnActivateDocument</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_AppEvents = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">GC</span>.Collect()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">GC</span>.WaitForPendingFinalizers()</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>&#0160;</p>
<p>4. Define event handler method. It&#39;s possible to use TAB key to automatically generate it.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> ApplicationEvents_OnActivateDocument _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: blue;">ByVal</span> DocumentObject <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">_Document</span>, _</p>
<p style="margin: 0px;"><span style="color: blue;">ByVal</span> BeforeOrAfter <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">EventTimingEnum</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">ByVal</span> Context <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">NameValueMap</span>, _</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">ByRef</span> HandlingCode <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">HandlingCodeEnum</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> BeforeOrAfter &lt;&gt; <span style="color: #2b91af;">EventTimingEnum</span>.kAfter <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show(DocumentObject.DisplayName, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;OnActivateDocument VB Delegates)&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxButtons</span>.OK, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxIcon</span>.Information)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>&#0160; <br /><strong>C# - Delegates</strong> <br />1. Declare member variable of type ApplicationEvents.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">class</span> <span style="color: #2b91af;">StandardAddInServer</span> :</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApplicationAddInServer</span></p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Inventor application object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">private</span> Inventor.<span style="color: #2b91af;">Application</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">private</span> Inventor.<span style="color: #2b91af;">ApplicationEvents</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_appEvents;</p>
</div>
<p>&#0160; <br />2. In the Activate method of your AddInServer class, add delegate to handle ApplicationEvents.OnActivateDocument event:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> Activate(Inventor.<span style="color: #2b91af;">ApplicationAddInSite</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; addInSiteObject, <span style="color: blue;">bool</span> firstTime)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// This method is called by Inventor when it </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//loads the addin. The AddInSiteObject provides</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// access to the Inventor Application object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// The FirstTime flag indicates if the addin </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// is loaded for the first time.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Initialize AddIn members.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_inventorApplication =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; addInSiteObject.Application;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// TODO: Add ApplicationAddInServer.Activate </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// implementation. e.g. event initialization, </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//command creation etc.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_appEvents =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.ApplicationEvents;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_appEvents.OnActivateDocument +=&#0160; <span style="color: blue;">new</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">ApplicationEventsSink_OnActivateDocumentEventHandler</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ApplicationEvents_OnActivateDocument);</p>
<p style="margin: 0px;">}</p>
</div>
<p>3. Remove the event in the Deactivate method</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: blue;">public</span> <span style="color: blue;">void</span> Deactivate()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Release objects.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_appEvents.OnActivateDocument -= <span style="color: blue;">new</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">ApplicationEventsSink_OnActivateDocumentEventHandler</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ApplicationEvents_OnActivateDocument);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_appEvents = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">GC</span>.Collect();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">GC</span>.WaitForPendingFinalizers();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
</div>
<p>4. Define event handler method. It&#39;s possible to use TAB key to automatically generate it.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">private</span> <span style="color: blue;">void</span> ApplicationEvents_OnActivateDocument</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">_Document</span> DocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">EventTimingEnum</span> BeforeOrAfter,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">NameValueMap</span> Context,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">out</span> <span style="color: #2b91af;">HandlingCodeEnum</span> HandlingCode)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; HandlingCode =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">HandlingCodeEnum</span>.kEventNotHandled;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (BeforeOrAfter !=</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">EventTimingEnum</span>.kAfter)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; HandlingCode =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">HandlingCodeEnum</span>.kEventHandled;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show(DocumentObject.DisplayName,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;C# - OnActivateDocument&quot;</span>,</p>
<p style="margin: 0px;"><span style="color: #2b91af;">MessageBoxButtons</span>.OK, <span style="color: #2b91af;">MessageBoxIcon</span>.Information);</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Wishlist 2013 - Survey results
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-wishlist-2013-survey-results
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/07/inventor-api-wishlist-2013-survey-results.html 
DATE: 07/11/2013 04:55:49 PM
-----
BODY:
<p>Thanks to everyone who participated in the 2013 API survey. Your input is very valuable to the engineering team. The screenshots below show the results for the main questions on the survey. The survey also had individual suggestions that are not listed here.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e38162d970b-pi"><img alt="image" border="0" height="720" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191042e3d54970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="479" /></a></p>
<p><strong>API Language:</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf74cac970d-pi"><img alt="image" border="0" height="336" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191042e3d61970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="473" /></a></p>
<p><strong>Inventor Version:</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e381649970b-pi"><img alt="image" border="0" height="318" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf74cba970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="474" /></a></p>
<p><strong>Cloud</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e381653970b-pi"><img alt="image" border="0" height="346" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e38165b970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="480" /></a></p>
<p><strong>Mobile</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf74cca970d-pi"><img alt="image" border="0" height="332" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191042e3d86970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="485" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jon Kriek
EMAIL: 
IP: 198.210.1.3
URL: http://profile.typepad.com/jdkriek
DATE: 07/11/2013 05:49:06 PM
Thanks for posting this Wayne.
-----
COMMENT:
AUTHOR: Farren
EMAIL: farren.young@d3tech.net
IP: 67.231.38.66
URL: 
DATE: 07/11/2013 06:32:50 PM
Thank you!
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Autodesk Configurator 360 now available
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: autodesk-configurator-360-now-available
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/07/autodesk-configurator-360-now-available.html 
DATE: 07/10/2013 08:41:00 PM
-----
BODY:
<p>Autodesk has a new cloud product called Configurator 360. (Currently available only as a 90 day free special offer) </p>  <p>You can upload your Inventor assemblies or parts and it will allow your customers to configure the model based on Inventor parameters, iLogic rules or ETO designs. You donâ€™t need to work with the Inventor API to use Configurator 360 but I thought it may be of interest to explore this new cloud capability for Inventor models.</p>  <p>This YouTube <a href="http://www.youtube.com/watch?v=5IQvr87YX54" target="_blank">video</a> provides a quick high level overview.</p>  <p>You can get more information and sign up for a free trial here: </p>  <p><a href="http://www.autodesk.com/products/autodesk-configurator-360/overview">Autodesk Configurator 360</a></p>  <p>It is really easy to try it. Here is a screenshot where I uploaded my Inventor part. I selected the pencil icon to display a page where I could control the behavior of the parameters. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf48f99970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191042b8527970c-pi" width="469" height="343" /></a>&#160; <br /></p>  <p>On this page select the Parameters Tab. (this is one thing that may not be easy to find). On the Parameters tab I set the Max and Min value of the Parameters. (If I set the parameter value to zero an error occurred so having a minimum avoids that condition)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf48fb4970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf48fc6970d-pi" width="481" height="388" /></a></p>  <p>In this screenshot you see the part file that can be modified. You can try this part from <a href="https://configurator360.autodesk.com/1111333993707359432/5bbh6b9cwggg" target="_blank">here</a>. This is just a simple ipt I used to test. The three parameters control the size of extrude features. (limit is .25 to 3.0)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abf43429970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901e34ff77970b-pi" width="478" height="369" /></a></p>  <p>This â€œIn the foldâ€ blog post on has information on other Autodesk cloud products related to manufacturing that have been released recently:</p>  <p><a title="http://inthefold.typepad.com/in_the_fold/2013/07/autodesk-expands-next-generation-cloud-services-for-manufacturers.html" href="http://inthefold.typepad.com/in_the_fold/2013/07/autodesk-expands-next-generation-cloud-services-for-manufacturers.html">http://inthefold.typepad.com/in_the_fold/2013/07/autodesk-expands-next-generation-cloud-services-for-manufacturers.html</a></p>  <p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sergio Duran
EMAIL: sduran@solidcad.ca
IP: 24.150.10.151
URL: 
DATE: 07/18/2013 07:27:30 PM
I tested it and found out that there is no way to see properties. Am I correct?
-----
COMMENT:
AUTHOR: Sergio Duran
EMAIL: sduran@solidcad.ca
IP: 24.150.10.151
URL: 
DATE: 07/18/2013 07:35:39 PM
Does it have a link with the Inventor file once you uploaded it? I uploaded an Inventor part, then I modified the part in Inventor but when I went back to Autodesk Configurator 360, my Inventor file didn't update. Is there any way to update designs on Autodesk Configurator 360 after having changed them in Inventor?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.18
URL: 
DATE: 07/18/2013 07:59:55 PM
Hi Sergio,

I believe you are asking if Inventor iProperties are available in C360. They are not displayed by C360 that I have seen. It just uses parameters.
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.18
URL: 
DATE: 07/18/2013 08:03:02 PM
Hi Sergio,

There is not a link to the local Inventor File once you have uploaded it. I believe you need to create a new design and delete the old one. (that is what I did). I am not an expert on C360 however.
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.18
URL: 
DATE: 07/18/2013 09:30:39 PM
Hi Sergio,

Here is a suggestion:
 " If I understand what youâ€™re looking for -- It does not show iProperties directly at this time. You can set up a parameter to get the value of the property, using iLogic, perhaps with an â€œevent triggerâ€, and then display the parameter in Configurator 360 as read-only. You need to use the â€œParametersâ€ tab (click on the Pencil icon). Make sure the read-only check-box â€œtakesâ€ â€¦ itâ€™s temperamental. " 

Also questions on C360 can be posted to this newsgroup:
 <a href="https://forums.autodesk.com/t5/Autodesk-Configurator-360/bd-p/3541">https://forums.autodesk.com/t5/Autodesk-Configurator-360/bd-p/3541</a>


-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor 2014 API - Solid Imprinting
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2014-api-solid-imprinting
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/07/inventor-2014-api-solid-imprinting.html 
DATE: 07/01/2013 09:05:36 PM
-----
BODY:
<p>The 2014 API supports new functionality to do solid imprinting. (This functionality is only available in the API). The new method is:</p>
<p><em>TransientBRep.ImprintBodies </em></p>
<p>This method takes two bodies and modified versions of the bodies are output. The functions finds coincident faces on the bodies and splits the coincident faces where the faces overlap. Imprinting will primarily be useful to applications that perform their own meshing for some form of analysis. By splitting the faces where the bodies connect, theyâ€™re guaranteed to get mesh nodes along these boundaries.</p>
<p><strong>C# example:</strong></p>
<p><span class="asset  asset-generic at-xid-6a00e553fcbfc6883401901e11f671970b"><a href="http://modthemachine.typepad.com/files/inventor_2014_imprinting_example.zip">Download Inventor_2014_Imprinting_Example</a></span>&#0160;</p>
<p>This example has these VBA examples converted from the Inventor API help file:&#0160;</p>
<p><em>CreateImprintFromAssembly()</em></p>
<p><em>SampleImprintMatching2()</em></p>
<p>This screenshot shows two parts in assembly. When you run CreateImprintFromAssembly() you will prompted to select two parts that have a coincident face. (need to have an assembly active or an error occurs)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abd12193970d-pi"><img alt="image" border="0" height="375" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401910407ea8b970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="432" /></a></p>
<p>&#0160;</p>
<p>When the function completes a new part with two bodies will be created. The two bodies have edges where the edge in the other part was coincident. Here you can see these edges on one of the parts:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401910407ea93970c-pi"><img alt="image" border="0" height="366" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340192abd121ad970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="428" /></a></p>
<p><strong>Here is CreateImprintFromAssembly():</strong>&#0160;</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">// Imprint bodies within an assembly </span></p>
<p style="margin: 0px;"><span style="color: green;">// This sample demonstrates creating imprinted bodies </span></p>
<p style="margin: 0px;"><span style="color: green;">// from two selected occurrences in an assembly.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> CreateImprintFromAssembly()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the active assembly document </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// and its definition.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyDocument</span> asmDoc = (<span style="color: #2b91af;">AssemblyDocument</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Have two parts selected in the assembly.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ComponentOccurrence</span> part1 = (<span style="color: #2b91af;">ComponentOccurrence</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.CommandManager.Pick</p>
<p style="margin: 0px;">&#0160; (<span style="color: #2b91af;">SelectionFilterEnum</span>.kAssemblyLeafOccurrenceFilter,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;Select part 1&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ComponentOccurrence</span> part2 = (<span style="color: #2b91af;">ComponentOccurrence</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.CommandManager.Pick</p>
<p style="margin: 0px;">&#0160; (<span style="color: #2b91af;">SelectionFilterEnum</span>.kAssemblyLeafOccurrenceFilter,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;Select part 2&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the bodies associated with the occurrences. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Because of a problem when this sample was </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// written the ImprintBodies method fails when </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// used with SurfaceBodyProxy objects. The code </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// below works around this by creating new </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// transformed bodies that will provide the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// equivalent result.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the bodies in part space </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// as transient bodies.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientBRep</span> transBrep =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">TransientBRep</span>)ThisApplication.TransientBRep;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceBody</span> body1 = (<span style="color: #2b91af;">SurfaceBody</span>)transBrep.Copy</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (part1.Definition.SurfaceBodies[1]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceBody</span> body2 = (<span style="color: #2b91af;">SurfaceBody</span>)transBrep.Copy</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (part2.Definition.SurfaceBodies[1]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Transform the bodies to be in the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// location represented in the assembly.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; transBrep.Transform(body1, part1.Transformation);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; transBrep.Transform(body2, part2.Transformation);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Imprint the bodies.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceBody</span> newBody1 = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceBody</span> newBody2 = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Faces</span> body1OverlapFaces = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Faces</span> body2OverlapFaces = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edges</span> body1OverlapEdges = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edges</span> body2OverlapEdges = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.TransientBRep.ImprintBodies</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (body1, body2, <span style="color: blue;">true</span>, <span style="color: blue;">out</span> newBody1,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">out</span> newBody2, <span style="color: blue;">out</span> body1OverlapFaces,</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">out</span> body2OverlapFaces, <span style="color: blue;">out</span> body1OverlapEdges,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">out</span> body2OverlapEdges);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new part document to show the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// resulting bodies in.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> partDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PartDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> partDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PartComponentDefinition</span>)partDoc.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new feature from the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// first imprinted body.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">NonParametricBaseFeature</span> non1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">NonParametricBaseFeature</span>)partDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NonParametricBaseFeatures.Add(newBody1);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; newBody1 = non1.SurfaceBodies[1];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new feature from the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// second imprinted body.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">NonParametricBaseFeature</span> non2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">NonParametricBaseFeature</span>)partDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NonParametricBaseFeatures.Add(newBody2);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; newBody2 = non2.SurfaceBodies[1];</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Several tips for ETO
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: several-tips-for-eto
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/05/several-tips-for-eto.html 
DATE: 05/31/2013 10:59:34 PM
-----
BODY:
<p><strong>DirectoryNotFoundException using ETO Server R2</strong></p>
<p>1. If you get a System.IO.DirectoryNotFoundException when using&#0160; ETO Server 2013 R2. Check to see if this directory exists: </p>
<p><em>C:\Users\InventorETOServices\Documents\Inventor Server x64 Inventor ETO Server      <br /></em>&#0160;&#0160;&#0160; <br /><strong>Note:</strong> If the InventorETOServices user has been deleted and recreated, there may be multiple user directories for it, such as:     <br />&#0160; <br /><em>C:\users\InventorETOServices.&lt;MachineName&gt;.000\Docâ€‹uments\Inventor Server x64 Inventor ETO Server</em>     <br />&#0160; <br /><em>C:\users\InventorETOServices.&lt;MachineName&gt;.001\Docâ€‹uments\Inventor Server x64 Inventor ETO Server      <br /></em>&#0160;&#0160; <br />In this case, add the directory in the newest one. This issue has been reported to Autodesk Engineering.     </p>
<p><strong>After installing ETO 2013 Server R2 - cannot establish a client connection.</strong> </p>
<p>The start of the error message is:    <br /><em>â€The message with Action &#39;</em><a href="http://www.autodesk.com/IntentServices/2012/02/IIntentServices/SetInteger&#39;"><em>http://www.autodesk.com/IntentServices/2012/02/IIntentServices/SetInteger&#39;</em></a><em> cannot be processed at the receiver, due to a ContractFilter mismatch at the EndpointDispatcherâ€.</em>     </p>
<p>This happens when there is a mismatch between the contract used by the client and the contract used by the server. In this case the server is R2 but the client is using the R1 contracts (&#39;<a href="http://www.autodesk.com/IntentServices/2012/02/IIntentServices&#39;)">http://www.autodesk.com/IntentServices/2012/02/IIntentServices&#39;)</a>. </p>
<p>This can happen when the client project is being built with ETO Series 2013 R1 but trying to target ETO Server 2013 R2. Generally the version of Series used when building the client project should match the version of Server targeted. The solution is to update the reference to Autodesk.Intent.Services.dll in the client project so it is the same version the server is using. This can be done by installing ETO Series 2013 R2 if itâ€™s not already installed, removing the reference, and re-adding the reference by browsing to the â€œ&lt;Series 2013 R2 install&gt;\Bin\Public Assembliesâ€ directory.    <br />An alternative, in this case, since ETO Server is on the same machine as the client is to update the reference to the Autodesk.Intent.Services.dll to point to the one in the ETO Server Bin directory.     </p>
<p><strong>Quickly narrow down the location of a crash.</strong> </p>
<p>In one case a crash was occurring in a custom dll. It looked like it was an ETO specific problem. By using IntentTracer to determine the Part/Design and â€œ%%iv_message()â€ we were able to narrow down the location of the crash which was occurring somewhere in the custom dll. The help toipic for IntentTracer is here:</p>
<p><a href="http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/0001-Inventor1/0160-Inventor160/0177-Tools_fo177/0182-Intent_T182/0183-Intent_T183">http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/0001-Inventor1/0160-Inventor160/0177-Tools_fo177/0182-Intent_T182/0183-Intent_T183</a></p>
<p>After finding the design you can use a message box style technique to further narrow down the place of a crash.</p>
<p>%%iv_message(&quot;Tracing777Before&quot;, show := true)   <br /> Call to custom dll was here.    <br /> The crash occurred before this message was displayed.    <br />%%iv_message(&quot;Tracing777After&quot;, show := true)</p>
<p>Note: ETO 2013 R2 allows you to debug rules in Visual Studio</p>
<p><strong>Sphere Design fails after install R2 Hotfix (build 202)</strong></p>
<p>To resolve this problem download this iks file and put it in this directory.&#0160; (Back up the existing xxhostSphere.iks)</p>
<p><em>â€œC:\Program Files\Autodesk\Inventor ETO Components 2013\Library\Inventor\ivhostlibâ€</em></p>
<p>&#0160;
<span class="asset  asset-generic at-xid-6a00e553fcbfc6883401901cd238ac970b"><a href="http://modthemachine.typepad.com/files/xxhostsphere.iks">Download XxhostSphere</a></span></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Webinar - Autodesk Exchange Apps store
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: webinar-autodesk-exchange-apps-store
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/05/webinar-autodesk-exchange-apps-store.html 
DATE: 05/30/2013 10:04:02 PM
-----
BODY:
<p>Register and mark your calendars now for this upcoming webcast on making the most of the Autodesk Exchange Apps store ...</p>
<p><strong>&quot;How developers can ride and profit from the adoption wave of Autodesk Exchange Apps&quot;</strong></p>
<p>The Autodesk Exchange Apps stores (currently there are 15 stores) are a huge opportunity for developers to gain direct access to the growing number of Autodesk customers using Exchange Apps. In just one year thereâ€™s been over one million visits and over 250,000 downloads. With comments like â€œ<em>one of my most useful toolsâ€, â€œlove this app, saved me hours of workâ€ </em>thereâ€™s no doubt that Exchange Apps has become a resource that Autodesk customers rely on to find useful apps of all types.</p>
<p>If you develop apps and want to reach more customers quickly, easily and inexpensively but havenâ€™t yet put your toe in the water with Exchange Apps, the Autodesk Developer Network (ADN) team is ready to help you. Youâ€™re invited to attend a webinar on June 13<sup>th</sup>hosted by Jim Quanci and Stephen Preston to learn how you can catch the wave and accelerating growth of Exchange Apps.</p>
<p>Youâ€™ll learn the tricks of the trade when publishing on Exchange Apps, get ideas on how to be successful and learn about the ability to publish localized apps. Hereâ€™s what you need to know:</p>
<p><strong>Webinar details:</strong></p>
<p>Date: Thursday, June 13<sup>th</sup>, 2013 <br />Time: 8 a.m. PDT (4 p.m. BST; 5 p.m. CET; 11 a.m. EDT) <br />Duration: Approximately one hour</p>
<p>Open to anyone interested in publishing apps on Autodesk Exchange Apps (i.e. ADN membership is not required :-).</p>
<p><strong>Registration:</strong> Reserve your place by June 11 by sending an email to <a href="mailto: adn-training-worldwide@autodesk.com?subject=Exchange_Apps_webinar">adn-training-worldwide@autodesk.com</a> with <em>Exchange Apps webinar</em> as the subject. Please make sure you include your full name, company name and email address.</p>
<p><em>And visit</em><em> <a href="http://www.autodesk.com/developapps">www.autodesk.com/developapps</a></em><em> now if you want a head start in learning how to publish apps.</em></p>
<p>-Wayne (original text by Stephen Preston)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: 2013 Inventor API Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 2013-inventor-api-survey
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/05/2013-inventor-api-survey.html 
DATE: 05/20/2013 08:09:41 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834019102597258970c-pi"><img alt="SNAGHTMLe8d8f5" border="0" height="168" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834019102597263970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="SNAGHTMLe8d8f5" width="479" /></a></p>
<p>Itâ€™s time again for the annual API survey. <span style="text-decoration: underline;">Please</span> help us help you by taking a few minutes and filling out the survey. Everyone is welcome to respond. Your answers help us to determine what to work on in upcoming releases of Inventor and help us to justify resources to work on API enhancements. The more responses we get the more we know people care about the API and the more accurate the results will be so we can work on the areas that will best benefit the majority of those using the API.</p>
<p>In question 5 you have a virtual $100 to spend on different API enhancements. Hereâ€™s the link to the survey and thank you for taking the time to respond.</p>
<p><a href="https://www.surveymonkey.com/s/Autodesk-Inventor-API-Wishlist-Survey-2013" rel="noopener noreferrer" target="_blank">Click here to take survey</a></p>
<p>Note: The survey is ending on the 16th of June.</p>
<p>See this <a href="http://modthemachine.typepad.com/my_weblog/2012/07/inventor-api-wishlist-2012-survey-results.html" rel="noopener noreferrer" target="_blank">post</a> to see the results from the 2012 survey.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor 2014 new API for sketch creation
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2014-new-api-for-sketch-creation
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/05/inventor-2014-new-api-for-sketch-creation.html 
DATE: 05/15/2013 11:41:08 PM
-----
BODY:
<p>There are four new API enhancements for sketches. Three of them create sketch curves that could be created from the UI in previous releases. One of the enhancements is new in the UI too.</p>
<p><strong>Slots</strong></p>
<p>In the 2014 release you can now easily create slots.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340191022e36eb970c-pi"><img alt="image" border="0" height="181" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340191022e3713970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="402" /></a>&#0160;</p>
<p>Creating slots in the API is accomplished by calling one of these Add methods that are on several different sketch objects:</p>
<p><em>AddArcSlotByCenterPointArc <br />AddArcSlotByThreePointArc <br />AddStraightSlotByCenterToCenter <br />AddStraightSlotByOverall</em></p>
<p>Here is the signature for <em>AddArcSlotByCenterPointArc:</em></p>
<p><em>Sketch.AddArcSlotByCenterPointArc( CenterPoint As Object, StartPoint As Object, SweepAngle As Double, Width As Double )</em></p>
<p><strong>Equation curves</strong></p>
<p>Inventor 2013 added the ability to create sketch curves using equations. Now you can create curves using equations with the API. The SketchEquationCurve object represents an equation curve within a sketch. Different sketch objects have a SketchEquationCurves collection and you use the Add method to create a SketchEquationCurve. If you have not used equation curves before I would suggest looking at the Inventor help file to see how to create these from the UI. Once you understand how these curves are created in the user interface the arguments in the SketchEquationCurves.Add method will be easier to understand. Here is the signature :</p>
<p><em>SketchEquationCurves.Add( EquationType As CurveEquationTypeEnum, CoordinateSystemType As CoordinateSystemTypeEnum, XValueOrRadius As String, YValueOrTheta As String, MinValue As Variant, MaxValue As Variant ) <br /></em></p>
<p><strong>Intersection Curves</strong></p>
<p>This is another API enhancement that is catching up to the UI. The IntersectionCurve object represents the results of creating an intersection between different types of geometry. The Sketch3d and Sketch3dProxy now have an IntersectionCurves collection. You use the Add method to create an IntersectionCurve.&#0160; Here is the signature:</p>
<p><em>IntersectionCurves.Add( EntityOne As Object, EntityTwo As Object )</em></p>
<p><strong>Control point splines</strong></p>
<p>Inventor 2013 introduced the ability to create splines using control points. The 2014 API can now create this type of spline. Both 2D and 3D sketch objects have a SketchControlPointSplines collection. (SketchControlPointSplines3D) Use the Add method to create these splines. Here is the signature:</p>
<p><em>SketchControlPointSplines.Add( ControlPoints As ObjectCollection )</em></p>
<p><strong>C# example:</strong></p>
<p>Below is one of the functions from this C# project which was translated from the VBA example in the help file. The c# project also has a CreateSlots() function that creates sketch curves by calling the four different methods for creating slots.</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc6883401901c384154970b"><a href="http://modthemachine.typepad.com/files/inventor_2014_sketch_examples.zip">Download Inventor_2014_Sketch_Examples</a></span></p>
<p>SketchCurves does the following:</p>
<p>1. Creates a sketch and adds a SketchControlPointSpline</p>
<p>2. Creates another sketch and adds a SketchEquationCurve</p>
<p>3. Creates a Sketch3D and adds a SketchControlPointSpline3D</p>
<p>4. Adds a SketchEquationCurve3D to the Sketch3D</p>
<p>5. Adds a surface feature using a profile created using the SketchControlPointSpline from sketch. (step 1)</p>
<p>6. Adds a surface feature using a profile created using the SketchEquationCurve from sketch2. (step 2)</p>
<p>7. Creates another Sketch3D named interSketch, This sketch uses IntersectionCurves.Add</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401901c3835fe970b-pi"><img alt="image" border="0" height="358" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017eeb359e02970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="465" /></a></p>
<p>After running the code a new part is created with the geometry</p>
<p>&#0160;</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> SketchCurves()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new part.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> partDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PartDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> partDef =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">PartComponentDefinition</span>)partDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a 2D sketch on the X-Y plane.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> sketch1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PlanarSketch</span>)partDef.Sketches.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (partDef.WorkPlanes[3]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientGeometry</span> tg =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">TransientGeometry</span>)ThisApplication.TransientGeometry;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a spline based on control points.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectCollection</span> pnts =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">ObjectCollection</span>)ThisApplication.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TransientObjects.CreateObjectCollection();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint2d(2, 0));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint2d(4, 1));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint2d(4, 2));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint2d(6, 3));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint2d(8, 1));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchControlPointSpline</span> controlPointSpline =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SketchControlPointSpline</span>)sketch1.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SketchControlPointSplines.Add(pnts);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a 2D sketch on the Y-Z plane.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> sketch2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PlanarSketch</span>)partDef.Sketches.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (partDef.WorkPlanes[1]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a spline based on an equation.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchEquationCurve</span> equationCurve =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">SketchEquationCurve</span>)sketch2.SketchEquationCurves.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(<span style="color: #2b91af;">CurveEquationTypeEnum</span>.kParametric,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">CoordinateSystemTypeEnum</span>.kCartesian,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;.001*t * cos(t)&quot;</span>, <span style="color: #a31515;">&quot;.001*t * sin(t)&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 0.1, 360 * 3);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a 3D sketch.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Sketch3D</span> sketch3 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Sketch3D</span>)partDef.Sketches3D.Add();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a 3D spline based on control points.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts = ThisApplication.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateObjectCollection();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint(10, 0, 0));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint(12, 1, 3));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint(12, 2, -5));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint(14, 3, 2));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pnts.Add(tg.CreatePoint(16, 1, -3));</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">SketchControlPointSpline3D</span> controlPointSpline2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SketchControlPointSpline3D</span>)sketch3.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SketchControlPointSplines3D.Add(pnts);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a 3D spline based on an equation.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchEquationCurve3D</span> equationCurve2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SketchEquationCurve3D</span>)sketch3.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SketchEquationCurves3D.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">CoordinateSystemTypeEnum</span>.kCartesian,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;.001*t * cos(t) + 8&quot;</span>, <span style="color: #a31515;">&quot;.001*t * sin(t)&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;0.002*t&quot;</span>, 0, 360 * 3);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.ActiveView.Fit();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Extrude the 2d curves.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Profile</span> prof = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Profile</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; prof = sketch1.Profiles.AddForSurface</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (controlPointSpline);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeDefinition</span> extrudeDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">ExtrudeDefinition</span>)partDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ExtrudeFeatures.CreateExtrudeDefinition</p>
<p style="margin: 0px;">(prof, <span style="color: #2b91af;">PartFeatureOperationEnum</span>.kSurfaceOperation);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; extrudeDef.SetDistanceExtent(6,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartFeatureExtentDirectionEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kSymmetricExtentDirection);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeFeature</span> extrude1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">ExtrudeFeature</span>)partDef.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Features.ExtrudeFeatures.Add(extrudeDef);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Change the work surface to </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// not be transparent.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">WorkSurface</span> surf = <span style="color: blue;">default</span>(<span style="color: #2b91af;">WorkSurface</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; surf = extrude1.SurfaceBodies[1].Parent;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; surf.Translucent = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; prof = sketch2.Profiles.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddForSurface(equationCurve);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; extrudeDef = partDef.Features.ExtrudeFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateExtrudeDefinition</p>
<p style="margin: 0px;">(prof, <span style="color: #2b91af;">PartFeatureOperationEnum</span>.kSurfaceOperation);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; extrudeDef.SetDistanceExtent(9,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartFeatureExtentDirectionEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kPositiveExtentDirection);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeFeature</span> extrude2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">ExtrudeFeature</span>)partDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ExtrudeFeatures.Add(extrudeDef);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new sketch and an </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//intersection curve.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Sketch3D</span> interSketch =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Sketch3D</span>)partDef.Sketches3D.Add();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; interSketch.IntersectionCurves.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (extrude1.SurfaceBodies[1],</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; extrude2.SurfaceBodies[1]);</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor 2014 API for the new Joint feature
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2014-api-for-the-new-joint-feature
CATEGORY: Assemblies
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/04/inventor-2014-api-for-the-new-joint-feature.html 
DATE: 04/13/2013 02:16:05 AM
-----
BODY:
<p>One focus of the 2014 release is â€œEase of useâ€. An example of this is the new Joint command that will definitely make it easier to make relationships between parts in an assembly. This command is on the Assemble tab next to Constrain.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017eea34f1b6970d-pi"><img alt="image" border="0" height="107" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017eea34f1c7970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="452" /></a></p>
<p>When you run this command new graphic feedback shows you where the joints could be added before you add the joint.</p>
<p><strong>API Support for Joints</strong></p>
<p>The API also supports Joints. Here are several of the new classes, new method and an enum related to Joints.</p>
<p><em>AssemblyJoint, </em><em>AssemblyJointDefinition</em></p>
<p><em>AssemblyComponentDefinition.Joints</em> (collection)</p>
<p><em>AssemblyJointTypeEnum, <em>CreateAssemblyJointDefinition</em></em></p>
<p>You use an <em>AssemblyJointDefinition</em> as input to create a joint. To create this use the <em>CreateAssemblyJointDefinition</em> method of the Joints collection. (Property of the <em>AssemblyComponentDefinition)</em> This method takes a Joint Type and two <em>GeometryIntent</em> objects. If you have used the API to create drawing annotations you will be familiar with<em> GeometryIntent objects.</em> To create the joint use the Add method of the Joints collection.</p>
<p>Below are the functions from this <a href="http://modthemachine.typepad.com/Inventor_2014_Joints_Example.zip" target="_blank">C# example</a> that create a joint. (zip includes the ipt) This example was converted to C# from the VBA example in the help file. After you run the example you will see a new assembly with two components that share a joint.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3891a6ca970b-pi"><img alt="image" border="0" height="274" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d42c0bdeb970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="414" /></a></p>
<p>I dragged the part (rotated) to show the joint.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017eea34f1e2970d-pi"><img alt="image" border="0" height="271" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017eea34f1ee970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="412" /></a></p>
<p><strong>C# functions:</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> AssemblyJoint()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new assembly document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyDocument</span> asmDoc =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">AssemblyDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kAssemblyDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kAssemblyDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyComponentDefinition</span> asmDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Matrix</span> trans =</p>
<p style="margin: 0px;">ThisApplication.TransientGeometry.CreateMatrix();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Place an occurrence into the assembly.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ComponentOccurrence</span> occ1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.Occurrences.Add</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;C:\\Inventor2014APISamples\\SamplePart.ipt&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Place a second occurrence with the matrix </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//adjusted so it fits correctly with the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//first occurrence.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; trans.Cell[1, 4] = 6 * 2.54;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ComponentOccurrence</span> occ2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.Occurrences.Add</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;C:\\Inventor2014APISamples\\SamplePart.ipt&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get Face 1 from occ1 and </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// create a FaceProxy.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Face</span> face1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Face</span>)GetNamedEntity(occ1, <span style="color: #a31515;">&quot;Face1&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get Face 2 from occ2 and </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// create a FaceProxy.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Face</span> face2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Face</span>)GetNamedEntity(occ2, <span style="color: #a31515;">&quot;Face2&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get Edge 1 from occ2 and&#0160; </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// create an EdgeProxy.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> Edge1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Edge</span>)GetNamedEntity(occ2, <span style="color: #a31515;">&quot;Edge1&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get Edge 3 from occ1 and </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// create an EdgeProxy.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> Edge3 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Edge</span>)GetNamedEntity(occ1, <span style="color: #a31515;">&quot;Edge3&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an intent to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// center of Edge1.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">GeometryIntent</span> edge1Intent =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.CreateGeometryIntent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (Edge1, <span style="color: #2b91af;">PointIntentEnum</span>.kMidPointIntent);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an intent to the center of Edge3.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">GeometryIntent</span> edge3Intent =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.CreateGeometryIntent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (Edge3, <span style="color: #2b91af;">PointIntentEnum</span>.kMidPointIntent);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create two intents to define </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// the geometry for the joint.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">GeometryIntent</span> intentOne =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.CreateGeometryIntent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (face2, edge1Intent);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">GeometryIntent</span> intentTwo =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.CreateGeometryIntent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (face1, edge3Intent);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a rotation joint between the two parts.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyJointDefinition</span> jointDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.Joints.CreateAssemblyJointDefinition</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">AssemblyJointTypeEnum</span>.kRotationalJointType,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; intentOne, intentTwo);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; jointDef.FlipAlignmentDirection = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; jointDef.FlipOriginDirection = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyJoint</span> joint =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; asmDef.Joints.Add(jointDef);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Make the joint visible.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.Visible = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Drive the joint to animate it.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.DriveSettings.StartValue = <span style="color: #a31515;">&quot;0 deg&quot;</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.DriveSettings.EndValue = <span style="color: #a31515;">&quot;180 deg&quot;</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.DriveSettings.GoToStart();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.DriveSettings.PlayForward();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; joint.DriveSettings.PlayReverse();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">}</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">// This finds the entity associated with </span></p>
<p style="margin: 0px;"><span style="color: green;">// an iMate of a specified name.&#0160; This</span></p>
<p style="margin: 0px;"><span style="color: green;">// allows iMates to be used as a generic </span></p>
<p style="margin: 0px;"><span style="color: green;">// naming mechansim.</span></p>
<p style="margin: 0px;"><span style="color: blue;">private</span> <span style="color: blue;">object</span> GetNamedEntity</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">ComponentOccurrence</span> Occurrence, <span style="color: blue;">string</span> Name)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Look for the iMate that has the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// specified name in the referenced file.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> partDef =</p>
<p style="margin: 0px;">&#0160;&#0160; (<span style="color: #2b91af;">PartComponentDefinition</span>)Occurrence.Definition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">object</span> resultEntity = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; resultEntity = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">iMateDefinition</span> iMate</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">in</span> partDef.iMateDefinitions)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Check to see if this iMate has </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// the correct name</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (iMate.Name.ToUpper() ==</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Name.ToUpper())</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Get the geometry associated </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// with the iMate. Using InvokeMember</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// because the iMateDefinition is the</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// base class and does not have an </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Entity property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">object</span> entity = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity = iMate.GetType().InvokeMember</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Entity&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BindingFlags</span>.GetProperty,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">null</span>, iMate, <span style="color: blue;">null</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create a proxy.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Occurrence.CreateGeometryProxy</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (entity, <span style="color: blue;">out</span> resultEntity);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">break</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Return the found entity, or Nothing&#0160; </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// if a match wasn&#39;t found.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span> resultEntity;</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Control feature creation based on user defined boundary
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: control-feature-creation-based-on-user-defined-boundary
CATEGORY: iLogic
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: VB.NET
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/03/control-feature-creation-based-on-user-defined-boundary.html 
DATE: 03/29/2013 10:25:59 PM
-----
BODY:
<p><em>Thanks to DevTech engineer Vladimir Ananyev for providing this post and great example.</em></p>
<p>Recently we were asked if the Inventor API could help by suppressing elements of holes in a rectangular pattern which are not completely inside a user-defined boundary.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9d6d017970d-pi"><img alt="image" border="0" height="145" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d4262bede970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="488" /></a> </p>
<p>The algorithm needs to suppress holes that have centers located outside the boundary at a distance greater than the hole radius from the boundary. The boundary could be complex geometry and the most difficult problem was to determine if the hole was completely inside or outside the boundary. This problem was solved by using Inventor API objects involved in the creation of profiles for solid geometry.</p>
<p>In the screenshots below you see a sketch and the extrusion that is created using the profile created with the AddForSolid() method.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: blue;">Dim</span> oProfile <span style="color: blue;">As</span> <span style="color: #2b91af;">Profile</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; = oSketch.Profiles.AddForSolid(<span style="color: blue;">True</span>)</p>
</div>
<p>The result is shown in Fig. 2.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3833a603970b-pi"><img alt="image" border="0" height="172" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d4262bee8970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="474" /></a></p>
<p>If a circular profile path crosses the ellipse (boundary) or is located completely outside then it adds material to the solid body. Otherwise it subtracts material.</p>
<p>Figures 3 and 4 show that this rule works for profile paths of any other geometry as well.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3833a616970b-pi"><img alt="image" border="0" height="169" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d4262bef0970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="488" /></a></p>
<p><br />This powerful built-in topology analyzer of the AddForSolid method you can be used to easily identify pattern elements that are completely inside the specified boundary. (Fortunately there are not any restrictions on the geometry of the profile paths).</p>
<p>To demonstrate this approach I used an iLogic rule. (Any language that can access the Inventor API could have been used too). In figure 5 you see the full rectangular pattern. After the rule is run, the holes outside of the boundary are suppressed. (figure 6)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3833a62c970b-pi"><img alt="image" border="0" height="226" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d4262bf00970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="475" /></a></p>
<p><strong>The steps are as follows. </strong><strong> <br /></strong>1. The Main function projects the boundary geometry from the planar sketch â€œBoundaryâ€ and all the elements of the holes pattern into the created on-the-fly transient planar sketch. (For simplicity the rule works with the first rectangular pattern in its parent part document).&#0160; </p>
<p>2. It then calls the <em>AddForSolid</em> method to create a profile object based on the combined projected geometry in the transient sketch.&#0160; </p>
<p>3.&#0160; The rule analyses every profile path in the profile object. If the path represents a projected holeâ€™s pattern element and its property <em>AddsMaterial</em> returns True, then the corresponding pattern element is suppressed. The search for <em>FeaturePatternElem</em>ent is based on the reference to the projected sketch circle is performed by the function <em>GetEltByGreenCircle</em>.</p>
<p><strong>Note</strong>:&#0160; The parent hole feature cannot be suppressed otherwise all the pattern will be suppressed as well, that is why our code ignores the parent feature.</p>
<p>An Inventor part file with the iLogic rule can be downloaded <a href="http://modthemachine.typepad.com/Pattern.ipt" target="_blank">here</a>.</p>
<p><strong>Here are the two iLogic rules</strong>:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Sub</span> Main()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">PartDocument</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">TryCast</span>(ThisDoc.Document, <span style="color: #2b91af;">PartDocument</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oDoc <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;This rule works with part documents only.&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;iLogic Rule&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxButtons</span>.OK,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxIcon</span>.Warning)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDef <span style="color: blue;">As</span> <span style="color: #2b91af;">PartComponentDefinition</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc.ComponentDefinition</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;this rule works with only one rect. pattern only</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;provided directly by item number</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPattern <span style="color: blue;">As</span> <span style="color: #2b91af;">RectangularPatternFeature</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; oDef.Features.RectangularPatternFeatures.Item(1)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;restore all pattern elements in order to </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;get access to their faces</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oElt <span style="color: blue;">As</span> <span style="color: #2b91af;">FeaturePatternElement</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">In</span> oPattern.PatternElements</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oElt.Suppressed <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oElt.Suppressed = <span style="color: blue;">False</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.Update()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Beep()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oBoundarySketch <span style="color: blue;">As</span> <span style="color: #2b91af;">PlanarSketch</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDef.Sketches.Item(<span style="color: #a31515;">&quot;Boundary&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;temporary sketch for profile</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oSketch <span style="color: blue;">As</span> <span style="color: #2b91af;">PlanarSketch</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; oDef.Sketches.Add _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oBoundarySketch.PlanarEntity, <span style="color: blue;">False</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.Visible = <span style="color: blue;">False</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;project boundary</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oE <span style="color: blue;">As</span> <span style="color: #2b91af;">SketchEntity</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">In</span> oBoundarySketch.SketchEntities</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Call</span> oSketch.AddByProjectingEntity(oE)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;project parent hole</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oHole <span style="color: blue;">As</span> <span style="color: #2b91af;">HoleFeature</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">TryCast</span>(oPattern.ParentFeatures.Item(1),</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">HoleFeature</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oHole <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show _</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;This rule works with hole feature pattern only.&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;iLogic Rule&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBoxButtons</span>.OK, <span style="color: #2b91af;">MessageBoxIcon</span>.Warning)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oEdge <span style="color: blue;">As</span> <span style="color: #2b91af;">Edge</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oHole.SideFaces.Item(1).Edges.Item(1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Call</span> oSketch.AddByProjectingEntity(oEdge)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;project holes pattern</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oElt <span style="color: blue;">As</span> <span style="color: #2b91af;">FeaturePatternElement</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">In</span> oPattern.PatternElements</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oElt.Faces.Count &gt; 0 <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdge = oElt.Faces.Item(1).Edges.Item(1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Call</span> oSketch.AddByProjectingEntity(oEdge)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create a profile.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oProfile <span style="color: blue;">As</span> <span style="color: #2b91af;">Profile</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSketch.Profiles.AddForSolid(<span style="color: blue;">True</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oPath <span style="color: blue;">As</span> <span style="color: #2b91af;">ProfilePath</span> <span style="color: blue;">In</span> oProfile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oPath.Count = 1 <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPE <span style="color: blue;">As</span> <span style="color: #2b91af;">ProfileEntity</span> = oPath.Item(1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oPE.CurveType =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Curve2dTypeEnum</span>.kCircleCurve2d <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oSkE <span style="color: blue;">As</span> <span style="color: #2b91af;">SketchEntity</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPE.SketchEntity</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oGreenCircle <span style="color: blue;">As</span> <span style="color: #2b91af;">SketchCircle</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">CType</span>(oSkE, <span style="color: #2b91af;">SketchCircle</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oFPE <span style="color: blue;">As</span> <span style="color: #2b91af;">FeaturePatternElement</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetEltByGreenCircle(oGreenCircle)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oFPE <span style="color: blue;">IsNot</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oPath.AddsMaterial = <span style="color: blue;">True</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;should be suppressed</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFPE.Suppressed = <span style="color: blue;">True</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;delete temporary sketch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.Delete()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.Update()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Beep()</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">Function</span> GetEltByGreenCircle( _</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">ByRef</span> oGreenCircle <span style="color: blue;">As</span> <span style="color: #2b91af;">SketchCircle</span>) _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">As</span> <span style="color: #2b91af;">FeaturePatternElement</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;returns FPE corresponding to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;given SketchCircle object</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oGreenCircle <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span> <span style="color: blue;">Return</span> <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oEdge <span style="color: blue;">As</span> <span style="color: #2b91af;">Edge</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdge = <span style="color: blue;">CType</span>(oGreenCircle. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ReferencedEntity, <span style="color: #2b91af;">Edges</span>).Item(1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> <span style="color: #2b91af;">Exception</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Return</span> <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oFace <span style="color: blue;">As</span> <span style="color: #2b91af;">Face</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oEdge.Faces.Item(1).SurfaceType =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceTypeEnum</span>.kCylinderSurface <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFace = oEdge.Faces.Item(1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFace = oEdge.Faces.Item(2)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oFace.CreatedByFeature.Type =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectTypeEnum</span>.kHoleFeatureObject <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Return</span> <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> lKey <span style="color: blue;">As</span> <span style="color: blue;">Long</span> = oFace.TransientKey</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPattern <span style="color: blue;">As</span> <span style="color: #2b91af;">RectangularPatternFeature</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = <span style="color: blue;">CType</span>(oFace.CreatedByFeature,&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">RectangularPatternFeature</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oElt <span style="color: blue;">As</span> <span style="color: #2b91af;">FeaturePatternElement</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">In</span> oPattern.PatternElements</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oElt.Faces.Count &gt; 0 <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> lKey = oElt.Faces.Item(1). _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TransientKey <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Return</span> oElt</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Return</span> <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Function</span> <span style="color: green;">&#39;GetEltByGreenCircle</span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>(Thanks! to Vladimir)</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: R. Krieg
EMAIL: r.krieg@metawell.com
IP: 87.149.197.243
URL: 
DATE: 03/31/2013 10:20:11 AM
Hello

Nice code, but real world would need a bit more.
Would it be possible to use a boundary of e.g. 2 concentric circles, so that the resulting pattern would be a "ring" of holes? Think of a baseplate that has a cut out and holes should only surround it, but not "touch" the edge? 
Is it possible to let user select the pattern element by using pick-method and let user pick the set of areas where pattern elements should not be suppressed?

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor 2014 API Enhancements
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2014-api-enhancements
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/03/inventor-2014-api-enhancements.html 
DATE: 03/27/2013 08:55:04 PM
-----
BODY:
<p>Inventor 2014 was officially released yesterday.&#0160; Hereâ€™s a quick overview of the API enhancements for this release.&#0160; Iâ€™ll go into more detail of some of them in later posts.</p>
<ul>
<li>Support for dimension styles.&#0160; The API previously had minimal support for all of the settings associated with a dimension style.&#0160; This was also one of the highest requested enhancements from the yearly API survey.&#0160; With Inventor 2014 all of the settings are now available from the API, with the exception of those on the â€œNotes and Leadersâ€ tab. The notes and leaders settings are quite a bit more complicated and will need to wait until later. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a690970b-pi"><img alt="Inventor2014DimStyles" border="0" height="212" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a69a970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014DimStyles" width="400" /></a> </li>
<li>API support for the new types of sketch curves.&#0160; Inventor 2013 introduced two new curve types; control point and equation curves in both 2D and 3D sketches.&#0160; There is now full API support for both types in both 2D and 3D sketches. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d1dd970d-pi"><img alt="Inventor2014Curves" border="0" height="370" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d1e2970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014Curves" width="400" /></a> </li>
<li>API support for 3D intersection curves.&#0160; Inventor has supported the ability to create an intersection curve between two surfaces for a long time.&#0160; This capability is now also supported through the API. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a4e2970b-pi"><img alt="Inventor2014IntersectionCurve" border="0" height="382" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a4ea970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014IntersectionCurve" width="400" /></a> </li>
<li>Inventor 2014 introduces some new sketch command for drawing slots.&#0160; There are also API methods that provide the equivalent capability to the commands. <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d1f7970d-pi"><img alt="Inventor2014Slots" border="0" height="212" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a4fa970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014Slots" width="400" /></a> </li>
<li>Inventor 2014 introduces a new feature that can significantly improve performance for very large assemblies called assembly <em>Express Mode.</em> There is full API support for this. </li>
<li>Another new feature in Inventor 2014 is assembly joints. Joints are a more user-friendly type of constraint. An assembly can use both the traditional constraints and joints to define the relationships between parts.&#0160; There is full API support for joints. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3826a504970b-pi"><img alt="Inventor2014Joints" border="0" height="328" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d20a970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014Joints" width="400" /></a> </li>
<li>Inventor and the API now support creating work points at the centers of spheres. </li>
<li>The API supports a new enhancement to the boundary patch feature where the weight, or smoothness, can be controlled for each selected edge. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d4255c67f970c-pi"><img alt="Inventor2014BoundaryPatch" border="0" height="228" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d215970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014BoundaryPatch" width="400" /></a> </li>
<li>The API now supports the ability to <em>imprint</em> solids. This takes two bodies as input and creates two new bodies where the faces on the new bodies have been split where any of the faces were overlapping between the bodies.&#0160; This is important for analysis applications to control where nodes on their mesh are created. </li>
<li>The API now fully supports consistent materials.&#0160; Consistent materials was introduced with Inventor 2013.&#0160; There wasnâ€™t time to do the equivalent API work at the time but there was some work done so the Material and RenderStyle objects would work with consistent materials.&#0160; This works ok but has some issues because the old Material and RenderStyle objects are not a one-for-one match to the new consistent material functionality.&#0160; With Inventor 2014 new API functionality has been introduced that fully supports consistent materials. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d221970d-pi"><img alt="Inventor2014CM" border="0" height="377" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9c9d22d970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Inventor2014CM" width="400" /></a> </li>
<li>There is now API support for Pack &amp; Go. </li>
<li>A few updates were made to the BIM exchange API in reaction to some enhancements made in the product. </li>
<li>Inventor now supports VBA 7.&#0160; VBA 7 is able to run natively on both 32 and 64-bit Windows.&#0160; The previous VBA only supported 32-bit Windows, so this is great news for those running 64-bit Windows.&#0160; With earlier version of Inventor on a 64-bit system, in order to support VBA at all, Inventor would spawn a separate 32-bit process that would host VBA. This is no longer required and as a result there is no longer any delay when accessing VBA and your macros will also run much faster.&#0160; As a side benefit, the scroll button now scrolls the code window.</li>
</ul>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Farren
EMAIL: farren.young@d3tech.net
IP: 67.231.38.66
URL: 
DATE: 03/28/2013 04:02:44 PM
Very happy with the 2014 enhancements!  Thank you
-----
COMMENT:
AUTHOR: Brandon
EMAIL: brandon.see@thyssenkrupp.com
IP: 74.204.94.114
URL: 
DATE: 04/08/2013 07:14:40 PM
Any chance Inventor is thread safe?  I have 8 cores and I'd like to be able to use more than one...
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: DevTech Team Meeting in San Rafael CA
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: devtech-team-meeting-in-san-rafael-ca
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/03/devtech-team-meeting-in-san-rafael-ca.html 
DATE: 03/18/2013 08:52:42 PM
-----
BODY:
<p>I work for an organization at Autodesk named Developer Technical services. (We support the Autodesk Developer Network). This last week the DevTech Americas team had a meeting at one of the Autodesk offices in San Rafael California. (Colleagues from Europe and the Media and Entertainment team where there too.) We had one and a half days of presentations. Some of the presentations centered around what we have been doing lately to learn cloud and mobile. My favorite presentation was by Philippe Leefsma on HTML 5. Philippe had many examples of what you can do using this technology. (I really liked the one on voice recognition) He has made several posts recently on the Cloud &amp; Mobile DevBlog such as this one:</p>
<p><a href="http://adndevblog.typepad.com/cloud_and_mobile/2013/01/first-try-at-windows-8-programming-with-javascript-html5.html" rel="noopener noreferrer" target="_blank">First try at Windows 8 programming with JavaScript &amp; HTML5</a></p>
<p>I thought the presentation by Gopinath Taget on what he has been doing to learn cloud security was also very interesting. He talks about this on the Cloud &amp; Mobile DevBlog as well:</p>
<p><a href="http://adndevblog.typepad.com/cloud_and_mobile/2013/03/cloud-security-securing-with-ssl-using-fiddler.html" rel="noopener noreferrer" target="_blank">Cloud Security: Securing with SSL â€“ Using Fiddler</a></p>
<p>The other presentations were great too. My short presentation was on my experiences getting up to speed on Python.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c37de82c8970b-pi"><img alt="image" border="0" height="302" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c37de8321970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="465" /></a></p>
<blockquote>
<p>&#0160;&#0160;&#0160;&#0160; Jim Quanci leading one of the presentations</p>
</blockquote>
<p><strong>Fun and Interesting</strong></p>
<p>Monday night we had a DevTech grand prix. (electric Go-Carts) We all tried our best to get to the winners circle but in the end Fenton Webbâ€™s experience with high speed maneuvers allowed him to take the top prize.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d420db287970c-pi"><img alt="image" border="0" height="337" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9818e50970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="441" /></a>&#0160;</p>
<blockquote>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The race is on</p>
</blockquote>
<p>Tuesday afternoon we were fortunate to get a tour of the <a href="http://www.calacademy.org/academy/building/sustainable_design/" rel="noopener noreferrer" target="_blank">California Academy of Sciences</a> building in San Francisco. The building is a great example of how the design of the building effects energy usage.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c37de846a970b-pi"><img alt="image" border="0" height="337" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee9818f0f970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="448" /></a></p>
<p>This is the roof of the museum. The top is six inches of dirt and all of the plants are native to California. The windows open depending on the heat inside.</p>
<p>&#0160;</p>
<p>Team meetings like this are one reason I appreciate working for Autodesk.</p>
<p>-Wayne&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor API Training &ndash; Lesson 12
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-training-lesson-12
CATEGORY: Inventor
CATEGORY: Training Material
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/03/inventor-api-training-lesson-12.html 
DATE: 03/07/2013 01:51:49 AM
-----
BODY:
<p>Here is section twelve of the Inventor API training where you see how Apprentice is used to access Inventor Data without having to use Inventor. You also learn about the Inventor viewer control. This is the fourth post with the Inventor API training material. (<a href="http://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-1.html">Section one is here</a>).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c375e7135970b-pi"><img alt="image" border="0" height="292" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c375e715a970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="391" /></a></p>
<p>Here is the agenda for this section. Be sure to see the Lab instructions at the end of this section. (completed samples in VB.NET and C# are available)</p>
<p><em>Apprentice Definition <br />Apprentice Functionalities <br />Apprentice Guidelines <br />Apprentice vs. Inventor: Differences <br />Saving Files with Apprentice</em></p>
<p><em>Inventor View Control</em></p>
<p><strong>Apprentice Definition</strong></p>
<p>This diagram shows where the API for Apprentice fits in . You use a stand alone client application, reference the Inventor API and use the apprentice classes to access Inventor data.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee90187c2970d-pi"><img alt="image" border="0" height="297" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c375e717b970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="392" /></a></p>
<p>Apprentice provides a subset of the Inventor API and is&#0160; <br />free as it is installed as part of <a href="http://usa.autodesk.com/adsk/servlet/pc/item?siteID=123112&amp;id=18585712" target="_blank">Inventor View</a>. A simple way to think of Apprentice is that it&#39;s a smaller version of Autodesk Inventor that does not have a user interface. Because there is not a user interface the only way to access its functionality is by using its API. Apprentice can be very efficient for certain applications because it&#39;s smaller than the complete Autodesk Inventor application and because it runs in the same process as your application. </p>
<p><strong>Apprentice Functionalities</strong></p>
<p>Apprentice provides <em>read-only</em> access to the following:</p>
<blockquote>
<p>Assembly structure <br />B-Rep <br />Drawing sheets and views (limited access) <br />iParts <br />iAssemblies <br />BOM</p>
</blockquote>
<p>Apprentice provides <em>read / write</em> access to the following:</p>
<blockquote>
<p>iProperties <br />attributes <br />file references</p>
<p>&#0160;</p>
</blockquote>
<p><strong>Apprentice â€“ Guidelines</strong></p>
<p>Apprentice should NOT be used in-process with Inventor such as in an Add-In or through Inventorâ€™s VBA. (If the Add-In is an exe type then it is ok).</p>
<p>In past releases a type library specifically for Apprentice was delivered with both Autodesk Inventor and Apprentice. This type library contained the limited set of objects supported only by Apprentice. Now the Autodesk Inventor type library contains all of the Apprentice functionality and is used to access Apprentice. (You add a reference to Inventor.Interop for an Apprentice project). A version of the old Apprentice type library is still supplied for legacy reasons, but this will likely be discontinued in future releases.</p>
<p><strong>Apprentice vs. Inventor: differences</strong></p>
<p>Apprentice is instantiated using a â€œnew ApprenticeServerComponentâ€. (Instantiating Inventor would be done using something like CreateObject)&#0160;</p>
<p>The ApprenticeServerComponent supports a few methods and properties that are unique to Apprentice.</p>
<blockquote>
<p>Open and Close methods, which are used to open and close documents within Apprentice</p>
</blockquote>
<blockquote>
<p>DisplayAffinity, which is used to optimize the behavior of Apprentice for viewer applications</p>
<p>MinimizeFileSize, which compresses files by removing versions</p>
<p>FileSaveAs, used to save files</p>
</blockquote>
<p>The document objects used within Apprentice are different from the document objects used in Autodesk Inventor. (Apprentice does not have a Documents collection) In Inventor there are the PartDocument, AssemblyDocument, DrawingDocument, and PresentationDocument objects. In Apprentice, the <em>ApprenticeServerDocument</em> object represents the part, assembly, and presentation documents and the <em>ApprenticeServerDrawingDocument </em>represents the drawing document.</p>
<p>Note: Apprentice cannot save a file from a previous version. You would need to migrate the file prior to saving it with Apprentice. (To migrate a file, open it with Inventor, save it and close it).</p>
<p><strong><em>VB.NET Example that uses Apprentice to open an ipt file</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> ApprenticeSample()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create Apprentice.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oApprentice <span style="color: blue;">As</span> <span style="color: #2b91af;">ApprenticeServerComponent</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oApprentice = <span style="color: blue;">New</span> <span style="color: #2b91af;">ApprenticeServerComponent</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Open a document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">ApprenticeServerDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = oApprentice.Open(<span style="color: #a31515;">&quot;C:\Temp\Part1.ipt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; MsgBox(<span style="color: #a31515;">&quot;Opened: &quot;</span> &amp; oDoc.DisplayName)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>Saving Files with Apprentice</strong></p>
<p>Use <em>FlushToFile</em> if the code is only modifying iProperties. This is&#0160;&#0160; more efficient because the document is not written back.</p>
<p><strong><em>VB.NET Example that uses FlushToFile after changing iProps</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> SetProperty(<span style="color: blue;">ByVal</span> author <span style="color: blue;">As</span> <span style="color: blue;">String</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oApprenticeDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">ApprenticeServerDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oApprenticeDoc = mApprenticeServer.Open _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;c:\Temp\MyPart.ipt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get &quot;Inventor Summary Information&quot; PropertySet</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPropertySet <span style="color: blue;">As</span> <span style="color: #2b91af;">PropertySet</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPropertySet = oApprenticeDoc.PropertySets _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;{F29F85E0-4FF9-1068-AB91-08002B27B3D9}&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get Author property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oProperty <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Property</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPropertySet.Item(<span style="color: #a31515;">&quot;Author&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oProperty.Value = author</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oApprenticeDoc.PropertySets.FlushToFile()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oApprenticeDoc.Close()</p>
<p style="margin: 0px;"><span style="color: #0000ff;">End Sub</span></p>
</div>
<p><strong>VB.NET Example that uses the FileSaveAs to make a copy</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> saveToNewFile()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create an instance of Apprentice.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> apprentice <span style="color: blue;">As</span> <span style="color: blue;">New</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApprenticeServerComponent</span>()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Open a part</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> appDoc <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApprenticeServerDocument</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; = apprentice.Open _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;C:\Temp\Part1.ipt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Save the file to a new name</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> myFileSaveAs <span style="color: blue;">As</span> <span style="color: #2b91af;">FileSaveAs</span> =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; apprentice.FileSaveAs</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; myFileSaveAs.AddFileToSave _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (appDoc, <span style="color: #a31515;">&quot;C:\Temp\Part1_update.ipt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; myFileSaveAs.ExecuteSaveCopyAs()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; appDoc.Close()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><em>Transient Camera</em></p>
<p>You can create image files by getting the camera from the <em>TransientObjects</em> of the <em>ApprenticeServerComponent </em>CreateCamera method.</p>
<p><strong>VB.NET example that opens a part and creates a jpg file</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> saveMyImage()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create an instance of Apprentice.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> apprentice <span style="color: blue;">As</span> <span style="color: blue;">New</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApprenticeServerComponent</span>()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Open the specified file.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> appDoc <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ApprenticeServerDocument</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; = apprentice.Open(<span style="color: #a31515;">&quot;C:\Temp\Part1.ipt&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create a camera.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> cam <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Camera</span> =</p>
<p style="margin: 0px;">&#0160; apprentice.TransientObjects.CreateCamera</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Associate the camera with the part&#39;s</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; component definition.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; cam.SceneObject =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; appDoc.ComponentDefinition</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Set the camera to the desired </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; orientation and position.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; cam.ViewOrientationType =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">ViewOrientationTypeEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kIsoTopRightViewOrientation</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; cam.Fit()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; cam.ApplyWithoutTransition()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;cam.Apply()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oTOs <span style="color: blue;">As</span> <span style="color: #2b91af;">TransientObjects</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTOs = apprentice.TransientObjects</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oTopColor <span style="color: blue;">As</span> <span style="color: #2b91af;">Color</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTopColor =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTOs.CreateColor(255, 0, 0)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oBottomColor <span style="color: blue;">As</span> <span style="color: #2b91af;">Color</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oBottomColor =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTOs.CreateColor(255, 255, 255)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Create an jpg file</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; cam.SaveAsBitmap(<span style="color: #a31515;">&quot;C:\Temp\Part1.jpg&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 800, 600, oTopColor, oBottomColor)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>Inventor View Control</strong></p>
<p>You can use a control that is installed with Inventor View to view Inventor files in your own application. The control is named InventorViewCtrl.ocx. To add it to your project in Visual Studio right click on the Toolbox and select â€œChoose&#0160; Itemsâ€¦â€ On the COM Components tab select it. Once it is in the Toolbox select it and place it on your form. <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee90187e5970d-pi"><img alt="image" border="0" height="201" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee90187fc970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="463" /></a></p>
<p>&#0160;</p>
<p>Note: To work with Inventor View control of 2013 use .NET framework 3.5</p>
<p>Before Inventor 2012, InventorViewCtrl.ocx was registered automatically with product. Starting from 2012, the registry-free was introduced. So plug-in developers have to link the corresponding manifest files to their application if they want to use the OCX.</p>
<p>Two options: <br />1. Use mt.exe to generate manifest file by yourself and link the manifest file to your application. <br />2. Use old style. But you have to register InventorViewCtrl.ocx manually by running â€œRegsvr32 InventorViewCtrl.ocxâ€.</p>
<p>See the post here for more information about this:</p>
<p><a href="http://adndevblog.typepad.com/manufacturing/2012/05/inventor-view-control-is-not-registered-on-inventor-2012.html" title="http://adndevblog.typepad.com/manufacturing/2012/05/inventor-view-control-is-not-registered-on-inventor-2012.html">http://adndevblog.typepad.com/manufacturing/2012/05/inventor-view-control-is-not-registered-on-inventor-2012.html</a></p>
<p><strong>Lab work with Apprentice API</strong></p>
<p>Create a Windows Forms application that has two buttons a label and a TextBox. When one of the buttons is clicked, provide the user with a way to select a part file (ipt). Once the file is selected create a jpg from the file. When the other button is selected open a file and update the Author iProperty with the value in the TextBox.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d418db0e9970c-pi"><img alt="image" border="0" height="304" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c375e71c5970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="299" /></a></p>
<p><strong>Lab â€“ use the view control</strong></p>
<p>Create a Windows Forms application that has the viewer control and a button. When the user clicks the button display the file in the viewer control.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee901881f970d-pi"><img alt="image" border="0" height="310" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d418db106970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="306" /></a></p>
<p>Here are examples of the completed Labs. (VB.NET and C#) The zip also contains the ppt we use for the training.&#0160;</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc68834017ee9018cb5970d"><a href="http://modthemachine.typepad.com/files/inventor_training_module_12_samples.zip">Download Inventor_Training_Module_12_Samples</a></span></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor API Training &ndash; Lesson 2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-training-lesson-2
CATEGORY: Beginning API
CATEGORY: Inventor
CATEGORY: Training Material
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-2.html 
DATE: 02/25/2013 10:56:53 PM
-----
BODY:
<p>Here is section two of the Inventor API training where you see how the API is used to create and access Inventor documents. This section also covers iProperties, working with units, and parameters. This is the third post with the Inventor API training material. (<a href="http://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-1.html">Section one is here</a>).&#0160;</p>
<p><strong>Common Document Functionalities</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470ae6970c-pi"><img alt="image" border="0" height="287" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf03f970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="383" /></a></p>
<p>Here is the agenda for this section. Be sure to see the Lab instructions at the end of this section. (completed samples in VB.NET and C# are available)</p>
<p><em>Document Types <br />Working with Documents <br />Document Settings <br />iProperties <br />Units of Measure <br />Parameters <br /></em></p>
<p><strong>Document Types</strong></p>
<p>Inventor has unique document types for different types of data.</p>
<p>Part Documents (*.ipt) <br />Assembly Documents (*.iam) <br />Drawing Documents (*.idw) <br />Presentation Documents (*.ipn)</p>
<p>The API represents each document type using a different type of object for each type of document.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf21970b-pi"><img alt="image" border="0" height="277" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf04c970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="315" /></a></p>
<p>&#0160;</p>
<p><strong><em>Accessing Documents</em></strong></p>
<p><em>Documents.Add()</em> </p>
<p>To create a new document use the Add method of the Documents collection. This method takes a <em>DocumentTypeEnum</em> which determines which type of document to create. (first argument) You can have a file that you can use as a template. To use that file, you provide a string that is a path to the file. (second argument). The third argument of the Add method is a boolean that determines if the file is opened visible or not. The GetTemplateFile method of the FileManager object allows you to use the default template and change settings for the file that is being created. (You can use this for the second argument of the Add method)</p>
<p><em>Documents.Open()</em> </p>
<p>The Open method of the documents collection will open existing documents. The first argument is a string with the file path of the document and the second is a boolean that controls the visibility.</p>
<p><em>Documents.Item()</em> </p>
<p>You use the Item property to access currently open documents. The ActiveDocument property of the Application will get you the current document.&#0160;</p>
<p><strong><em>Opening and Creating Documents VB.NET examples</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">&#39;Opens an existing document.assume part1.ipt exists</span></p>
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> OpenDoc()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">Document</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = _InvApplication.Documents.Open _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;C:\Temp\Part1.ipt&quot;</span>)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">&#39;Creates a new document using a specified template.</span></p>
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> CreateDoc()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">PartDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = _InvApplication.Documents.Add _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; _InvApplication.FileManager.GetTemplateFile _</p>
<p style="margin: 0px;">&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject), <span style="color: blue;">True</span>)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">&#39;Creates a new document using internally </span></p>
<p style="margin: 0px;"><span style="color: green;">&#39;defined template. (Can be done in the UI by </span></p>
<p style="margin: 0px;"><span style="color: green;">&#39;using Ctrl-Shift when creating new document.)</span></p>
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> CreateDoc2()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">PartDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = _InvApplication.Documents.Add _</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject, , <span style="color: blue;">True</span>)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong><em>&#0160;</em></strong></p>
<p><strong><em>Saving Documents</em></strong></p>
<p>The first time a new document is saved you should use the SaveAs method with the SaveCopyAs flag set to False.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">PartDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = _InvApplication.Documents.Add _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.SaveAs(<span style="color: #a31515;">&quot;C:\Temp\SaveTest.ipt&quot;</span>, <span style="color: blue;"><strong>False</strong></span>)</p>
</div>
<p>For documents that have been saved to disk you can use the Save method or the SaveAs with the SaveCopyAs flag set to True to create a copy. An error will occur if the file name parameter is the same as the open document. (keep in mind that the method will overwrite existing files).</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.Save()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.SaveAs(<span style="color: #a31515;">&quot;C:\Temp\SaveTest2.ipt&quot;</span>, <span style="color: blue;"><strong>True</strong></span>)</p>
</div>
<p>You can use the <em>FileSaveCounter</em> property of the document to determine if the document has been saved.</p>
<p><strong><em>Closing Documents</em></strong></p>
<p>To close a document call the Close method. You can use the SkipSave parameter to close it without saving.</p>
<p><em>Document.Close([SkipSave As Boolean = False])</em></p>
<p>Using the SkipSave argument you can bypass the dialog asking to save the changes and force the document to close without saving.&#0160; This is useful in cases where you use a file as a template by opening the file, modifying it in some way, and using SaveCopyAs to save it as a new file. Using this you can close the original without saving and without forcing the user to interact with a dialog.</p>
<p>The API has a way to close all documents. Using this method will not save any changes to documents.</p>
<p><em>Documents.CloseAll([UnreferencedOnly As Boolean = False])</em></p>
<p><strong><em>Document Settings</em></strong></p>
<p>Document settings are exposed from various objects obtained from the document.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf056970d-pi"><img alt="image" border="0" height="296" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf062970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="412" /></a></p>
<p>In this excerpt from the object model diagram you can see the objects that will allow you to get and update document settings.&#0160; Notice that these objects are accessed by using properties of the document.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf3a970b-pi"><img alt="image" border="0" height="92" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf4a970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="470" /></a></p>
<p><strong>iProperties</strong></p>
<p><strong><em>iProperties in the User Interface</em></strong></p>
<p>iProperties are used to associate information with a document. There are a predefined set of properties are available through the iProperties dialog. End-users can create additional properties using the â€œCustomâ€ tab of the iProperties dialog. These properties are supported by both Inventor and Apprentice.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf06c970d-pi"><img alt="image" border="0" height="324" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf58970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="319" /></a></p>
<p><strong><em>iProperties â€“ Property Sets</em></strong></p>
<p>The PropertySets object acts as the container for all of the properties.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf5f970b-pi"><img alt="image" border="0" height="320" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf69970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="335" /></a></p>
<p>The PropertySets object provides access to the individual PropertySet objects using the Item property.</p>
<p><strong><em>iProperties â€“ Property Set</em></strong></p>
<p>The PropertySet object contains a group of properties.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf72970b-pi"><img alt="image" border="0" height="358" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf07f970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="199" /></a></p>
<p>Most PropertySet objects roughly correspond to the tabs in the iProperties dialog. PropertySet objects are identified by the following: <br />InternalName (consistent) <br />Name (consistent) <br />DisplayName (may change)</p>
<p><strong><em>iProperties - Property</em></strong></p>
<p>Properties are named values and they are identified by: <br />ID (consistent) <br />Name (consistent) <br />DisplayName (may change)</p>
<p><strong><em>Property values</em>&#0160;</strong></p>
<p>Property values are stored internally as Variants. The following types are supported: Integer, Long, Double, String, Date, and Boolean. (With the exception of the thumbnail image which is IPictureDisp.)</p>
<p>PropIdâ€™s are defined in the various property related enums.</p>
<p><strong><em>&#0160;</em></strong></p>
<p><strong><em>iProperty Names</em></strong> <br /><span style="color: #0000ff;">Name</span> and <span style="color: #ffc000;">Internal Name</span> of Inventor defined property sets:</p>
<blockquote>
<p><span style="color: #0000ff;">Inventor Summary Information</span></p>
</blockquote>
<p><span style="color: #ffc000;">{F29F85E0-4FF9-1068-AB91-08002B27B3D9}</span></p>
<blockquote>
<p><span style="color: #0000ff;">Inventor Document Summary Information</span></p>
</blockquote>
<p><span style="color: #ffc000;">{D5CDD502-2E9C-101B-9397-08002B2CF9AE}</span></p>
<blockquote>
<p><span style="color: #0000ff;">Design Tracking Properties</span></p>
</blockquote>
<p><span style="color: #ffc000;">{32853F0F-3444-11D1-9E93-0060B03C1CA6}</span></p>
<blockquote>
<p><span style="color: #0000ff;">Inventor User Defined Properties</span></p>
</blockquote>
<p><span style="color: #ffc000;">{D5CDD505-2E9C-101B-9397-08002B2CF9AE}</span></p>
<p>InternalNames can be found using the Object Browser and in SDK\Include\PropFMTIDs.h</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470b52970c-pi"><img alt="image" border="0" height="316" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf098970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="402" /></a></p>
<p><strong>VB.NET Example of changing an iProperty</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">&#39; Access &quot;Design Tracking Properties&quot; </span></p>
<p style="margin: 0px;"><span style="color: green;">&#39; &quot;Designer&quot; and change its value</span></p>
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> iPropAccess()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">Document</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = _InvApplication.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Access a particular property set.&#0160; </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Design tracking property set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDTProps <span style="color: blue;">As</span> <span style="color: #2b91af;">PropertySet</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDTProps = oDoc.PropertySets.Item _</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;{32853F0F-3444-11d1-9E93-0060B03C1CA6}&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Access the same property set using</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; the display name or name. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; DisplayName is not dependable </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; because it can be localized, so </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;the internal name or name is preferred.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDTProps = oDoc.PropertySets.Item _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Design Tracking Properties&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Get a specific property, in this case</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; the designer property.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDesignerProp <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Property</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDesignerProp = oDTProps.ItemByPropId( _</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">PropertiesForDesignTrackingPropertiesEnum</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .kDesignerDesignTrackingProperties)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; You can also use the name or display name</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; the display name has the problem that </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; it can be changed.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDesignerProp = oDTProps.Item(<span style="color: #a31515;">&quot;Designer&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Show the display name and value.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(oDesignerProp.DisplayName _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &amp; <span style="color: #a31515;">&quot; = &quot;</span> &amp; oDesignerProp.Value)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Change the designer name.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDesignerProp.Value = <span style="color: #a31515;">&quot;Bill &amp; Ted&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong><em>iProperties - Creation</em></strong></p>
<p>To create new property set use the Add method of the PropertySets collection. (Name and InternalName must be unique with respect to other property sets in the document).</p>
<p><em>PropertySets.Add(Name As String, [InternalName]) As PropertySet <br /></em></p>
<p>To create and add new properties to the PropertySet use the Add method. Keep in mind that properties cannot be added to the predefined sets, except for the custom property set. Also the&#0160; <br />name and PropId must be unique with respect to other properties in the property set. The value type can be most Variant types except arrays and objects.</p>
<p><em>PropertySet.Add(PropValue, [Name], [PropId]) As Property <br /></em></p>
<p>Note: PropertySets and Properties can be created as hidden by using a name that begins with an underscore.&#0160; These will not be returned by indexing through a collection.&#0160; They can only be retrieved by asking for them by name.</p>
<p><strong>Units of Measure</strong></p>
<p>When you use Inventor manually there is a setting that controls the units that are used. When using the API numbers are always in the same internal units and your code needs to convert between units to get the correct behavior. (unless the document settings are using the same internal units).</p>
<p>All Inventor documents use these internal units. <br />Length: Centimeters <br />Angle: Radians <br />Time: Second <br />Mass: Kilogram</p>
<p>The units specified by the end-user in the Document Settings dialog are used to convert internal units to/from the units the end-user wants to use.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf0a8970d-pi"><img alt="image" border="0" height="294" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470b6a970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="390" /></a></p>
<p><strong><em>UnitsOfMeasure object</em></strong></p>
<p>The<em> UnitsOfMeasure</em> object allows you to work with different units. It provides utilities to help with unit handling, primarily the conversion between strings and values. If you are working with numbers you will most likely need to use UnitsOfMeasure to get the results you expect.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cf98970b-pi"><img alt="image" border="0" height="74" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470b73970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="359" /></a></p>
<p>&#0160;</p>
<p>A unique UnitsOfMeasure object can be obtained from each document. The UnitsOfMeasure object obtained from a document can be used for unit conversion and also provides a way to control unit settings for the document. The UnitsOfMeasure obtained from the Application object can be used for unit conversion.</p>
<p><strong><em>Units of Measure - Unit Types <br /></em></strong>Whenever a unit type is specified within the API, it can be defined in two different ways:</p>
<p>1. As a value from UnitsTypeEnum with a specific unit type such as:</p>
<p><em>kInchLengthUnits, kMillimeterLengthUnits, kDegreeAngleUnits</em>.</p>
<p>The current default type specified by the end-user: <em>kDefaultDisplayLengthUnits, kDefaultDisplayAngleUnits</em>. <br />The internal base units: kDatabaseLengthUnits, kDatabaseAngleUnits.</p>
<p>2. As a string, i.e. â€œinâ€, â€œmm mm mmâ€, â€œm ^ 3â€, â€œm /(s s)â€</p>
<p><strong><em>Units of Measure â€“ Internal Units</em></strong></p>
<p>Internally, Inventor uses a consistent set of units regardless of what the user has specified as the document default and the precision is always double-precision floating point,</p>
<p>Internal units used by Inventor for the various types of units</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf0c2970d-pi"><img alt="image" border="0" height="221" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470b7c970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="309" /></a></p>
<p><strong><em>VB.NET - UnitsOfMeasure to get valid input from the user</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> m_oUOM <span style="color: blue;">As</span> <span style="color: #2b91af;">UnitsOfMeasure</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> UserForm_Initialize()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; get the UnitsOfMeasure of the</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; current document</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; m_oUOM = _InvApplication.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ActiveDocument.UnitsOfMeasure</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> TextBox1_Change()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Check if the input string defines </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;a valid length.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> <span style="color: blue;">Not</span> m_oUOM.IsExpressionValid _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (TextBox1.Text, _</p>
<p style="margin: 0px;"><span style="color: #2b91af;">&#0160;&#0160; UnitsTypeEnum</span>.kDefaultDisplayLengthUnits) <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; The string is not valid so change</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; the text color to red.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TextBox1.ForeColor =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Drawing.<span style="color: #2b91af;">Color</span>.Red</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; The string is&#0160; valid so change </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;the text color to the default color.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TextBox1.ForeColor =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Drawing.<span style="color: #2b91af;">Color</span>.Black</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>VB.NET â€“ UnitsOfMeasure - Using user Input</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: green;">&#39; Get the real value of the input string.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> dValue <span style="color: blue;">As</span> <span style="color: blue;">Double</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; dValue = m_oUOM.GetValueFromExpression _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (txtInput.Text, _</p>
<p style="margin: 0px;">&#0160;&#0160; <span style="color: #2b91af;">UnitsTypeEnum</span>.kDefaultDisplayLengthUnits)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Compare the value with the length of </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; a sketch line.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> System.<span style="color: #2b91af;">Math</span>.Abs)</p>
<p style="margin: 0px;">(oSketchLine.Length - dValue)_ &lt; 0.00001 <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Line is equal to the input value&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Line is not equal to the input value&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
</div>
<p><strong>VB.NET UnitsOfMeasure - Displaying Values</strong></p>
<p>In this example a double (centimeters) is passed into a function&#0160; that gets the value of the double in the units that are current and returns it as a string.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> TestLength()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ShowLength(6.5)</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> ShowLength(<span style="color: blue;">ByVal</span> dLength <span style="color: blue;">As</span> <span style="color: blue;">Double</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Get the string representation of the length.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> strLength <span style="color: blue;">As</span> <span style="color: blue;">String</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; strLength = m_oUOM.GetStringFromValue _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (dLength, _</p>
<p style="margin: 0px;">&#0160;&#0160; <span style="color: #2b91af;">UnitsTypeEnum</span>.kDefaultDisplayLengthUnits)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; MsgBox(<span style="color: #a31515;">&quot;The Length is: &quot;</span> &amp; strLength)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>&#0160;</strong></p>
<p><strong>Parameters</strong></p>
<p><strong><em>Component Definition</em></strong></p>
<p>The Component definition will be discussed in following lessons. However we need to introduce it here because parameters are obtained form properties of the component definition. This excerpt from the Object Model diagram shows the property that will allow you to get the Component Definition of a document. (Drawings donâ€™t have a ComponentDefinition).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf0ce970d-pi"><img alt="image" border="0" height="150" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf0da970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="485" /></a></p>
<p><strong><em>Parameters - In the User Interface</em></strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cfb6970b-pi"><img alt="image" border="0" height="322" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470b9b970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="469" /></a></p>
<p><strong><em>Parameters â€“ In the API</em></strong></p>
<p>Notice how the Parameters collection is obtained from a PartComponentDefinition or AssemblyComponentDefinition</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cfc7970b-pi"><img alt="image" border="0" height="77" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cfcc970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="466" /></a></p>
<p>In this VB.NET code snippet the Parameters are accessed.</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: green;">&#39; Get the Parameters collection object. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oParameters <span style="color: blue;">As</span> <span style="color: #2b91af;">Parameters</span> = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; _InvApplication.ActiveDocument.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition.Parameters</p>
</div>
<p><strong><em>Parameters â€“ UI vs. API</em></strong></p>
<p>On the left in this picture you can see settings from the parameters dialog. The text on the right shows how a similar setting would be made using the API.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf110970d-pi"><img alt="image" border="0" height="320" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf121970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="497" /></a></p>
<p><strong><em>VB.NET - Parameters - Setting Values</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> SetParameter()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Get the Parameters object. Assumes </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;a part or assembly document is active.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oParameters <span style="color: blue;">As</span> <span style="color: #2b91af;">Parameters</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParameters = _InvApplication.</p>
<p style="margin: 0px;">&#0160;&#0160; ActiveDocument.ComponentDefinition.Parameters</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Get the parameter named &quot;Length&quot;.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oLengthParam <span style="color: blue;">As</span> <span style="color: #2b91af;">Parameter</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oLengthParam = oParameters.Item _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Length&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Change the equation of the parameter.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oLengthParam.Expression = <span style="color: #a31515;">&quot;3.5 in&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Update the document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; _InvApplication.ActiveDocument.Update()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong><em>Parameters â€“ Units</em></strong></p>
<p>The Unit property can be set using either a String or a value from <em>UnitsTypeEnum</em>. This enum is an API equivalent to the pre-defined unit types displayed in the Unit Type dialog.</p>
<p>Setting the unit type using a String is the same as defining a unit in the Unit Type dialog and allows you to define custom unit types by combining known unit types.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cfe3970b-pi"><img alt="image" border="0" height="444" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470bc5970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="398" /></a></p>
<p><strong><em>Parameters â€“ Values</em></strong></p>
<p>Unlike in the user-interface, the API allows you to directly set the value of a parameter. The Value property sets the actual value of the parameter and will overwrite any existing equation.</p>
<p><span style="color: #ff0000;"><span style="color: #000000;"><strong>Note</strong>: <em>In API, Parameter values are always defined using internal units.</em></span><em> <span style="color: #000000;">(use UnitsOfMeasure to convert)</span> <br /></em></span>Length â€“ Centimeters <br />Angle â€“ Radians&#0160; <br />Ï€ radians = 180 degrees <br />Ï€ = Atn(1) * 4</p>
<p><strong><em>Parameters - Tolerances</em></strong> <br />Tolerances can be defined for Model parameters. The Tolerance object exposes functionalities of the Tolerance dialog.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470bcd970c-pi"><img alt="image" border="0" height="60" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470bd3970c-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="127" /></a></p>
<p>The SetToDefault, SetToDeviation, SetToLimits, etcâ€¦ methods of the Parameter object allow you to define the parameterâ€™s tolerance. <br />&#0160;&#0160;&#0160; Call oParam.Tolerance.SetToDeviation(&quot;0.125 in&quot;, â€œ-0.0625 in&quot;) <br />&#0160;&#0160;&#0160; Call oParam.Tolerance.SetToDeviation(2.54 / 8, -2.54 / 16)</p>
<p>The ModelValueType property sets which tolerance to use when computing the model value.The Precision property sets the number of decimal places to display.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470bde970c-pi"><img alt="image" border="0" height="319" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470be6970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="293" /></a></p>
<p>The SetAllToMax, SetAllToMedian, SetAllToMin, SetAllToNominal methods of the Parameters object provides the equivalent of the Parameter dialogâ€™s â€œReset Toleranceâ€.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41470bee970c-pi"><img alt="image" border="0" height="85" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717cfff970b-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="187" /></a></p>
<p><strong><em>Parameters â€“ Parameter Types</em></strong></p>
<p>The Parameters collection returns all Parameter objects regardless of the type. The ModelParameters, ParameterTables, ReferenceParameters, and UserParameters objects provide access to specific types of parameters.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c3717d005970b-pi"><img alt="image" border="0" height="429" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf143970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="236" /></a></p>
<p><strong><em>Parameters â€“ Parameter Creation</em></strong></p>
<p>Parameters are created by using methods on the collection for the specific type of parameter you want to create. In the user-interface you can only create user parameters.&#0160; All other types are indirectly created as a result of other actions. In the API you can directly create user, model, and reference parameters. TableParameters are created by importing an Excel worksheet. Parameters are created using either the AddByExpression or AddByValue methods</p>
<p><strong><em>VB.NET - Creating Parameters</em></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;<span style="color: green;">&#39; add user parameters</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oUserParams <span style="color: blue;">As</span> <span style="color: #2b91af;">UserParameters</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oUserParams = oCompDef.Parameters.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UserParameters</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oParam <span style="color: blue;">As</span> <span style="color: #2b91af;">Parameter</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParam = oUserParams.AddByExpression _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;NewParam1&quot;</span>, <span style="color: #a31515;">&quot;3&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitsTypeEnum</span>.kInchLengthUnits)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParam = oUserParams.AddByExpression _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;NewParam1&quot;</span>, <span style="color: #a31515;">&quot;3&quot;</span>, <span style="color: #a31515;">&quot;in&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParam = oUserParams.AddByExpression _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;NewParam2&quot;</span>, <span style="color: #a31515;">&quot;3&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">UnitsTypeEnum</span>.kDefaultDisplayLengthUnits)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParam = oUserParams.AddByExpression _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;NewParam2&quot;</span>, <span style="color: #a31515;">&quot;3 in&quot;</span>, _</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">UnitsTypeEnum</span>.kDefaultDisplayLengthUnits)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oParam = oUserParams.AddByValue _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;NewParam3&quot;</span>, 3 * 2.54, _</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">UnitsTypeEnum</span>.kDefaultDisplayLengthUnits)</p>
</div>
<p><strong><em>Parameters â€“ API Only Functionality</em></strong></p>
<p>Creation of Model and Reference parameters. <br />Delete unused Model and Referenced Parameters. <br />DisabledActionTypes â€“ Prohibit deletion of user parameters. <br />Dependents, DrivenBy â€“ Provides dependency information between parameters. <br />Creation of custom parameter groups. <br />Change the type of a parameter.&#0160;</p>
<blockquote>
<p>Model to Reference <br />Reference to Model <br />User to Model <br />User to Reference</p>
</blockquote>
<p><strong>&#0160;</strong></p>
<p><strong>Lab: iProperties</strong></p>
<p>Write a .Net program that performs the following steps: <br />1. Create a new part document. <br />2. Edit the value of the author property to contain your name. <br />3. Create a new custom (user-defined) property</p>
<p>4. Save the document</p>
<p>5. Close the document.</p>
<p><strong>Lab: Parameters and UOM</strong> <br />1. Interactively create a simple part that contains a parameter named â€œLengthâ€ to control the size of the part.</p>
<p>2. Create a .Net program that contains a dialog that looks similar to this:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf14b970d-pi"><img alt="image" border="0" height="128" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee8baf156970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="331" /></a></p>
<p>3. The end-user should have created a parameter named â€œLengthâ€ which is a numeric. By this code, he is able to enter any valid expression.&#0160; The text field should provide feedback when an invalid expression has been defined.</p>
<p>4. When the â€œUpdateâ€ button is pressed the entered value should be assigned to the parameter</p>
<p>Here are examples of the completed Labs. (VB.NET and C#) It also contains the ppt we use for the training and another project with some sample code.</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc68834017c3717d58e970b"><a href="http://modthemachine.typepad.com/files/inventor_training_module_02_samples.zip">Download Inventor_Training_Module_02_Samples</a></span></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor API Training &ndash; Lesson 11
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-training-lesson-11
CATEGORY: Inventor
CATEGORY: Training Material
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-11.html 
DATE: 02/18/2013 06:47:49 PM
-----
BODY:
<p>Here is section eleven of the Inventor API training. In this section we cover how to use the API to print and translate files. There are&#0160; 21 sections to this training and we decided that they did not need to be posted in order. (<a href="http://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-1.html" target="_blank">Section one is here</a>). I am going to alternate posts between sections 1-10 and 10-21.</p>
<p><strong>Printing and Translating Files</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d412423de970c-pi"><img alt="image" border="0" height="260" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36f4d4cc970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="344" /></a></p>
<p>Here is the agenda for this section. Be sure to see the Lab instructions at the end of this section. (completed sample is available)</p>
<p><em>PrintManager Object <br />DrawingPrintManager <br />Printing Example <br />File Translation <br />Accessing Translators Options <br />DataIO Object</em></p>
<p><strong>PrintManager Object</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee897fce6970d-pi"><img alt="image" border="0" height="327" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36f4d4e0970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="441" /></a></p>
<p>The PrintManager object can be accessed from the different types of documents such as an part or assembly. Also Drawings and Apprentice support special print managers that provide additional printing capabilities.These PrintManager objects provide that same settings that are available in the Print command dialogs in the user interface.</p>
<p><strong>PrintManager - Main Properties <br /></strong>Here are the main properties and methods of the PrintManager object.</p>
<p><em>NumberOfCopies</em>: Default value to 1 <br /><em>PaperHeight / PaperWidth</em>: Sets the paper dimensions. This property is only used when the PaperSize property is set to kPaperSizeCustom <br /><em>Printer</em>:&#0160; gets and sets the name of the printing device</p>
<p><em>PrintToFile</em>(String FileName): Prints to the specified file using the current property settings <br /><em>SubmitPrint</em>: Prints the file using the current property settings</p>
<p><br /><strong>DrawingPrintManager Object</strong> <br />The DrawingPrintManager object derives from PrintManager and has some additional properties and methods specific to drawing documents.</p>
<p><em>AllColorsAsBlack:</em> No colors in the print <br /><em>PrintRange</em>: Can be set to kPrintCurrentSheet, kPrintAllSheets, kPrintSheetRange. <br /><em>ScaleMode / Scale</em>:&#0160; Gets and sets how the scale of the print is defined. <br /><em>RemoveLineWeights:</em> All lines will have the same default width</p>
<p><em>GetSheetRange / SetSheetRange</em>:&#0160; Gets/sets the sheet range to print.</p>
<p><strong>Print Sample VB.NET</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> PrintSample()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDrawDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">DrawingDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDrawDoc = mApp.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPrintMgr <span style="color: blue;">As</span> <span style="color: #2b91af;">DrawingPrintManager</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPrintMgr = oDrawDoc.PrintManager</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">With</span> oPrintMgr</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Printer = <span style="color: #a31515;">&quot;\\ADSOREPS1\oreprn001&quot;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .NumberOfCopies = 1</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .ScaleMode = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PrintScaleModeEnum</span>.kPrintFullScale</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .PaperSize = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PaperSizeEnum</span>.kPaperSize11x17</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .SubmitPrint()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">With</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>&#0160;</strong></p>
<p><strong>File Translation </strong></p>
<p><strong>Simple Translation using Open and SaveAs</strong> <br />You can use the Document.SaveAs and Documents.Open methods to translate documents in and out of Inventor. The extension of the filename supplied will be used to determine which translator to use. With this approach default settings are used. The default settings are the settings last used when interactively translating a file. In this code snippet an stp file is opened and a document is saved as and AutoCAD dwg file.</p>
<p><em>Documents.Open( â€œC:\Temp\Test.stpâ€ ) <br />Document.SaveAs( â€œC:\Temp\New.dwgâ€, True )</em></p>
<p><strong>File Translation using the translator Add-Ins</strong> <br />If you want to control the settings when translating files you use the Translator Add-Ins. The main properties and methods of translator add-ins are these:</p>
<p><em>HasOpenOptions</em>: Returns whether or not the translator has options available for opening files. The three arguments (DataMedium, TranslationContext, NameValueMap ) contain settings you can use.</p>
<p><em>Open</em>: Opens (translates) a file. This method takes four objects as arguments that control how the open will work.</p>
<blockquote>
<p><em>DataMedium</em>: Use the FileName property to set the file name to open.</p>
</blockquote>
<blockquote>
<p><em>TranslationContext</em>: For file, set Type to kFileBrowseIOMechanism you can place the translated file into an existing document with the OpenIntoExisting property</p>
</blockquote>
<blockquote>
<p><em>NameValueMap</em>: Use this to set the options for the open</p>
</blockquote>
<blockquote>
<p><em>Object</em>: The object that will be created - usually a document</p>
</blockquote>
<p><em>HasSaveCopyAsOptions</em>: Returns whether or not the translator has options available for saving files. The three arguments (Object, TranslationContext, NameValueMap ) will contain settings you can use.</p>
<p><em>SaveCopyAs</em>: Save the document to the specified data-source. This method takes the following arguments:</p>
<blockquote>
<p><em>Object</em>: The document to be saved <br /><em>TranslationContext</em>: For file set Type to&#0160; kFileBrowseIOMechanism&#0160;</p>
</blockquote>
<blockquote>
<p><em>NameValueMap</em>: Use this to set the options for the translation <br /><em>DataMedium</em>: Use the FileName property to set the file name to save</p>
<p>&#0160;</p>
</blockquote>
<p>Each of the translator Add-Ins have a GUID. You can use this identifier (String) with the <em>ItemById</em> method of the <em>ApplicationAddIns</em> property of the Inventor Application object to instantiate the translator. The following example gets the STEP translator and uses the HasOpenOptions() method to print the options (that could be set before using the Open method) to the immediate window.</p>
<p><strong>Accessing Translatorâ€™s Open Options â€“ VB.NET</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> GetTranslatorOpenOptions()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Using the GUID of the STEP Translator</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> clsId <span style="color: blue;">As</span> <span style="color: blue;">String</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; clsId = <span style="color: #a31515;">&quot;{90AF7F40-0C01-11D5-8E83-0010B541CD80}&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oTranslator <span style="color: blue;">As</span> <span style="color: #2b91af;">TranslatorAddIn</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTranslator = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mApp.ApplicationAddIns.ItemById(clsId)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> medium <span style="color: blue;">As</span> <span style="color: #2b91af;">DataMedium</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; medium = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mApp.TransientObjects.CreateDataMedium</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; medium.FileName = &quot;C:\MyInventorDoc.xxx&quot;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; medium.MediumType = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MediumTypeEnum</span>.kFileNameMedium</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> context <span style="color: blue;">As</span> <span style="color: #2b91af;">TranslationContext</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; context = mApp.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateTranslationContext</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> options <span style="color: blue;">As</span> <span style="color: #2b91af;">NameValueMap</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; options = mApp.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateNameValueMap</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> index <span style="color: blue;">As</span> <span style="color: blue;">Integer</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oTranslator.HasOpenOptions _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (medium, context, options) <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">For</span> index = 1 <span style="color: blue;">To</span> options.Count</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(options.Name(index) _</p>
<p style="margin: 0px;">&amp; <span style="color: #a31515;">&quot; = &quot;</span> &amp; options.Value(options.Name(index)))</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>Accessing Translatorâ€™s Save Options - VB.NET</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> GetTranslatorSaveAsOptions()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39; Using GUID of the DWF Translator</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> clsId <span style="color: blue;">As</span> <span style="color: blue;">String</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; clsId = <span style="color: #a31515;">&quot;{0AC6FD95-2F4D-42CE-8BE0-8AEA580399E4}&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oTranslator <span style="color: blue;">As</span> <span style="color: #2b91af;">TranslatorAddIn</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTranslator =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mApp.ApplicationAddIns.ItemById(clsId)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> context <span style="color: blue;">As</span> <span style="color: #2b91af;">TranslationContext</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; context =</p>
<p style="margin: 0px;">&#0160;&#0160; mApp.TransientObjects.CreateTranslationContext</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; context.Type =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">IOMechanismEnum</span>.kUnspecifiedIOMechanism</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> options <span style="color: blue;">As</span> <span style="color: #2b91af;">NameValueMap</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; options =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mApp.TransientObjects.CreateNameValueMap</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> SourceObject <span style="color: blue;">As</span> <span style="color: blue;">Object</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; SourceObject = mApp.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> index <span style="color: blue;">As</span> <span style="color: blue;">Integer</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oTranslator.HasSaveCopyAsOptions _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (SourceObject, context, options) <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">For</span> index = 1 <span style="color: blue;">To</span> options.Count</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(options.Name(index) &amp;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot; = &quot;</span> &amp; options.Value(options.Name(index)))</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>Inventor 2013: Built-in Translator Add-Ins GUIDs</strong></p>
<p>DWF:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {0AC6FD95-2F4D-42CE-8BE0-8AEA580399E4} <br />PDF:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4} <br />DWFx:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {0AC6FD97-2F4D-42CE-8BE0-8AEA580399E4} <br />JT:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {16625A0E-F58C-4488-A969-E7EC4F99CACD} <br />i-drop:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {21DB88B0-BFBF-11D4-8DE6-0010B541CAA8} <br />CATIA Part:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {2FEE4AE5-36D3-4392-89C7-58A9CD14D305} <br />SolidWorks:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {402BE503-725D-41CB-B746-D557AB83BAF1} <br />Pro/E:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {46D96B7A-CF8A-49C9-8703-2F40CFBDF547} <br />STL:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {533E9A98-FC3B-11D4-8E7E-0010B541CD80} <br />DWF:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {55EBD0FA-EF60-4028-A350-502CA148B499} <br />Pro/E Granite:&#0160;&#0160;&#0160; {66CB2667-73AD-401C-A531-64EC701825A1} <br />IDF:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {6C5BBC04-5D6F-4353-94B1-060CD6554444} <br />SAT:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {89162634-02B6-11D5-8E80-0010B541CD80} <br />CATIA Product: {8A88FC01-0C32-4B3E-BE12-DDC8DF6FFF18} <br />Pro/E Neutral&#0160;&#0160;&#0160;&#0160; {8CEC09E3-D638-4E8F-A6E1-0D1E1A5FC8E3} <br />CATIA Import:&#0160;&#0160;&#0160; {8D1717FA-EB24-473C-8B0F-0F810C4FC5A8}Parasolid Text:&#0160;&#0160; {8F9D3571-3CB8-42F7-8AFF-2DB2779C8465} <br />STEP:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {90AF7F40-0C01-11D5-8E83-0010B541CD80} <br />IGES:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {90AF7F44-0C01-11D5-8E83-0010B541CD80} <br />UGS NX:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {93D506C4-8355-4E28-9C4E-C2B5F1EDC6AE} <br />Content Center&#0160;&#0160; {A547F528-D239-475F-8FC6-8F97C4DB6746} <br />Parasolid Binary:{A8F8F8E5-BBAB-4F74-8B1B-AC011251F8AC} <br />Drag &amp; Drop&#0160;&#0160;&#0160;&#0160;&#0160; {B95D705C-E915-4A5B-A498-E73AC98923A2} <br />DWG:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {C24E3AC2-122E-11D5-8E91-0010B541CD80} <br />DXF:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {C24E3AC4-122E-11D5-8E91-0010B541CD80} <br />Alias:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {DC5CD10A-F6D1-4CA3-A6E3-42A6D646B03E}</p>
<p><strong>DataIO Object <br /></strong>Some Inventor objects support a DataIO object. You can use this object to get input and output of formatted data. Use the GetInputFormats / GetOutputFormats methods to get the list of formats supported by a DataIO objects (ex DXF, DWG for sketches, FlatPattern, XML for iProperties, SAT for worksurfaces,â€¦)</p>
<p><strong>DataIO VB.NET examples</strong></p>
<p>&#0160;</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> ExportWorkSurface()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oWorkSurfaces <span style="color: blue;">As</span> <span style="color: #2b91af;">WorkSurfaces</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oWorkSurfaces = mApp.ActiveDocument.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition.WorkSurfaces</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDataIO <span style="color: blue;">As</span> <span style="color: #2b91af;">DataIO</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDataIO = oWorkSurfaces(1).</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SurfaceBodies(1).DataIO</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDataIO.WriteDataToFile _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;ACIS SAT&quot;</span>, <span style="color: #a31515;">&quot;C:\Temp\result.sat&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> ExportSketchDXF()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oSketch <span style="color: blue;">As</span> <span style="color: #2b91af;">PlanarSketch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSketch = mApp.ActiveDocument.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition.Sketches(1)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDataIO <span style="color: blue;">As</span> <span style="color: #2b91af;">DataIO</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDataIO = oSketch.DataIO</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Call</span> oDataIO.WriteDataToFile _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;DXF&quot;</span>, <span style="color: #a31515;">&quot;C:\Temp\dxfout.dxf&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p><strong>Lab: Access the Translator Add-In options</strong> <br />Create a windows forms application. On the form have a ListView, a ComboBox and a Button. In the ComboBox allow the user to select the name of a Translator. When the button is clicked populate the ListView with the open options and save options for the selected Translator Add-In. Here are examples of the completed Lab. (VB.NET and C#)&#0160;</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc68834017c36f4d914970b"><a href="http://modthemachine.typepad.com/files/inventor_training_module_11_samples.zip">Download Inventor_Training_Module_11_Samples</a></span></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Pieter
EMAIL: pieter@mgfx.co.za
IP: 105.236.150.251
URL: http://www.mgfx.co.za
DATE: 02/20/2013 07:01:18 AM
Hi Wayne,

Thanks for the great post. This is going to help us quite a lot with what we are currently doing with customizing Inventor. I am looking forward to your next post and topic!
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: ETO 2013 R2 &ndash; Add-In template, VS Add-Ins can impact ETO Studio &amp; InventorApplication global rule
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: eto-2013-r2-add-in-template-vs-add-ins-can-impact-eto-studio-inventorapplication-global-rule
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/02/eto-2013-r2-add-in-template-vs-add-ins-can-impact-eto-studio-inventorapplication-global-rule.html 
DATE: 02/12/2013 11:05:17 PM
-----
BODY:
<p>Here are a couple of things about ETO 2013 R2 that I have found recently.&#0160;</p>
<p>1. If you have used the Inventor ETO Add-In template you may find that the ribbon tab for the Add-In does not display properly when Inventor is launched through ETO Studio. When Intent is started from Visual Studio, it does extensive processing in its OnReady handler. It reads command-line arguments and they tell it to load or create a model and establish communications with VS. Because of this the event handlers in the Add-In can be called later compared to when they are called when Inventor is started normally.&#0160;</p>
<p>To avoid this behavior you can call the code that creates the ribbon in the IntentInitialized function. Here is a slightly modified version of the Add-In code. (In IntentModel.cs) This change fixed the problem in one case. (Keep in mind that the the Add-In template should be considered as a starting point).</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">// This will be called if and when Intent </span></p>
<p style="margin: 0px;"><span style="color: green;">//gets initialized by the host.</span></p>
<p style="margin: 0px;"><span style="color: blue;">void</span> IntentInitialized</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">IntentAPI</span> intentAPI, <span style="color: blue;">object</span> hostAPI)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;<span style="color: green;">// Set up model event handlers if desired.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">IHostAPI</span> host = (<span style="color: #2b91af;">IHostAPI</span>)hostAPI;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ModelEvents</span> ModelEvent =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; intentAPI.ModelEvents;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; host.Events.BeforeModelLoad +=</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">new</span> <span style="color: #2b91af;">EventHandler</span>(Events_BeforeModelLoad);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ModelEvent.BeforeRender +=</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">new</span> <span style="color: #2b91af;">EventHandler</span>&lt;<span style="color: #2b91af;">BeforeModelRenderArgs</span>&gt;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ModelEvent_BeforeRender);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ModelEvent.AfterRender +=</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">new</span> <span style="color: #2b91af;">EventHandler</span>&lt;<span style="color: #2b91af;">AfterModelRenderedArgs</span>&gt;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ModelEvent_AfterRender);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Added to resolve problem with AddIn </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// ribbon when debugging</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (intentAPI.Models.Count &gt; 0)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_gui.Activate();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">}</p>
</div>
<p>&#0160;</p>
<p>2. We have found in one case that ETO Studio is adversely effected by the Visual Studio Add-In named ReSharper. Some of the symptoms are the following:</p>
<blockquote>
<p><em>Error Message when opening the ETO Studio project: â€œThe parameter is incorrectâ€. </em></p>
</blockquote>
<blockquote>
<p><em>Edit Rule Error - â€œDesign for selected part not loaded in Visual Studio Environment. Please make sure the project containing the design is openâ€ </em></p>
</blockquote>
<blockquote>
<p><em>ETO Model browser sees the designs under root, but cannot open them. Clicking â€œEdit Designâ€ gives the same error as above. </em></p>
</blockquote>
<blockquote>
<p><em>Design Navigator shows no User Designs</em></p>
<p>&#0160;</p>
</blockquote>
<p>The behavior has been reported to Autodesk ETO engineering. For now the suggestion is to disable the Visual Studio Add-In.</p>
<p>&#0160;</p>
<p>3. There is now an InventorApplication global Rule. Before that, you had to use hidden %%InventorApplication. Here you see the ETO Console in Visual Studio using the Inventor API:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d41026dca970c-pi"><img alt="image" border="0" height="126" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36d3ba4a970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="463" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor API Training &ndash; Lesson 1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-training-lesson-1
CATEGORY: Beginning API
CATEGORY: Inventor
CATEGORY: Training Material
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/02/inventor-api-training-lesson-1.html 
DATE: 02/09/2013 12:57:36 AM
-----
BODY:
<p>Developer Technical Services delivers Inventor API training and we have course material that we use. We thought it would be a good idea to post each section from the course. Here is the first one. (there are 21 sections)</p>
<p>If you are just getting started with the API these lessons will be good to go through after doing the <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=16459234" target="_blank">My First Plug-in</a> training. Also there are recordings of webcasts available that cover the first 10 sections. (On the <a href="http://adndevblog.typepad.com/manufacturing/2013/05/api-webcast-archive.html" target="_blank">webcast archive</a> - spring of 2010)</p>
<p><strong>Basic concepts of the Inventor API</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc11970d-pi"><img alt="image" border="0" height="225" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40e436a4970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="301" /></a></p>
<p>In this section an overview of the Inventor API is provided and you learn about the Application object. Be sure to see the Lab instructions at the end of this section. (completed sample is available) Here is the agenda:</p>
<p><em>API COM model <br />How do I access the API? <br />&#0160; The Object model <br />&#0160; Object model tools: <br />&#0160;&#0160;&#0160; Object browser, VBA debugger <br />&#0160;&#0160;&#0160; Collection, Enumerator, Inheritance <br />&#0160; The Application Object <br />&#0160; How to access the Application Object?</em></p>
<p>&#0160;</p>
<p><strong>Inventor COM API Model:</strong></p>
<p>The Inventor API is based on COM. (Component Object Model) In this diagram we see how the Inventor COM API is between the Inventor Application and custom applications. You can see that the API can be used from many different programming languages.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc35970d-pi"><img alt="image" border="0" height="319" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36b5a66f970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="436" /></a></p>
<p>&#0160;</p>
<p><strong>How to access the Inventor API</strong>&#0160;</p>
<p>The white boxes represent components that provide the API. These are Autodesk Inventor and &quot;Apprentice Server.&quot; The blue cylinder at the bottom represents the Autodesk Inventor data you&#39;re accessing, i.e. parts, assemblies, etc. All of the yellow boxes represent programs that you write. When one box encloses another box this indicates that the enclosed box is running in the same process as the box enclosing it.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc4d970d-pi"><img alt="image" border="0" height="334" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc5d970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="444" /></a></p>
<p><em>VBA: <br /></em>When deciding which method to use when programming Autodesk Inventor, there are a few advantages of using VBA to consider. First, VBA is delivered with Autodesk Inventor and does not require you to purchase an additional programming language. Second, you are able to embed programs within Autodesk Inventor documents. <br />If you have a program that is data-specific, this is a convenient way to keep the program with the data it is designed to use. Third, VBA runs in the same process as Autodesk Inventor so you gain the performance advantages of being in the same process.</p>
<p>Note: In the picture VBA has an X through it. This is there because we only recommend using VBA for quick prototyping or for small macros.</p>
<p><em>AddIn:</em> <br />Add-Ins are a special type of Autodesk Inventor program. An Add-In is able to do two things that none of the other methods of accessing the API is able to do. First, Autodesk Inventor starts the Add-In automatically whenever Autodesk Inventor is run. Second, an Add-In is able to create commands. Other than these two features, it has the same access and uses the API in the same way as programs written using any of the other API access methods. <br />You&#39;ll notice in the diagram above that Add-In is listed twice: once as a DLL and once as an EXE. With an Add-In, you have the choice of creating a DLL, which will run in the same process as Autodesk Inventor, or an EXE, which will run in a separate process. Almost all Add-Ins will be written as DLLs for increased performance benefits. The ability to have Add-Ins that are EXEs is primarily beneficial for debugging. <br />Add-Ins can be written using any language that supports the creation of ActiveX EXEs or DLLs, such as Visual C++ and .NET languages such as C# or VB.NET. Add-Ins cannot be created with VBA.</p>
<p><em>Exe:</em> <br />A standalone EXE is a program that runs on its own and connects to Autodesk Inventor. This type of program is typically used in the case where you have a program that uses Autodesk Inventor but has its own interface and doesn&#39;t require the user to interactively work with Autodesk Inventor. For example, a batch plot utility is typically a standalone EXE. The plot utility can be an EXE that runs independently of Autodesk Inventor and might monitor a database watching for new records to be added. <br />Standalone EXEs run out-of-process to Autodesk Inventor, so there is some performance penalty, but since they are not usually used for interactive processes it&#39;s rarely an issue.</p>
<p><em>Apprentice: <br /></em>Apprentice is an ActiveX server that can be used within other applications to provide access to Autodesk Inventor data. Apprentice is essentially a subset of Inventor that runs in process with other applications. Apprentice doesn&#39;t have a user interface. The only way to interact with Apprentice is through its API. Apprentice provides access to the assembly structure, B-Rep, geometry, and file properties. Most access to information through Apprentice is read-only; (a couple of exceptions to this are document properties and file references). <br />Apprentice Server is also available at no cost since it is delivered as part of <a href="http://usa.autodesk.com/adsk/servlet/pc/index?id=10535296&amp;siteID=123112" target="_blank">Autodesk Inventor View</a>, which is available on the public Autodesk website.</p>
<p><strong>Inventor SDK</strong></p>
<p>The Inventor SDK (Software Development Kit) Contains C++ header files, samples of C++, VB.NET and C#. The SDK is available for install when Inventor is installed. To install the SDK run the DeveloperTools.msi and UserTools.msi. See the SDK_Readme.htm for more information. Here are the location of the SDK install files:</p>
<p>Windows XP:&#0160; &lt;Inventor install folder&gt;\SDK</p>
<p>Windows Vista:&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; C:\Users\Public\Documents\Autodesk\Inventor &lt;version&gt;\SDK Windows 7:&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160; C:\Users\Public\Documents\Autodesk\Inventor &lt;version&gt;\SDK</p>
<p><strong>API help reference</strong> <br />The API help will be very useful. Here are the locations of the .chm file:</p>
<p>Before 2013: &lt;Inventor install folder *&gt;\Help_Lite\admapi_*_0.chm</p>
<p>2013: &lt;Inventor install folder *&gt;\Local Help\admapi_*_0.chm <br />Where * is the version number</p>
<p><strong>API Objects and the Object Model</strong></p>
<p>In a COM Automation API the functionality is exposed as objects, where each object corresponds to something within the application. Each object supports various methods, properties, and possibly events. The objects are accessed through the object model. The top most object is the Application object</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc6b970d-pi"><img alt="image" border="0" height="157" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc71970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="446" /></a></p>
<p><strong>Basics of Object Oriented Programming</strong></p>
<p>We can use a chair and a chair order form to help explain object oriented programming. (Class, Object, Property, Method, Event)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc80970d-pi"><img alt="image" border="0" height="244" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36b5a6ac970b-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="212" /></a></p>
<p>An object represents a logical object.&#0160; A finished physical chair would be an example of an object. A <em>property</em> would be an attribute of the chair such as the Style, Color, and Size. A <em>method </em>is an action performed on the chair; move, fold, throw away. An <em>event</em> is a notification sent when something happens to the chair. A class is a template of an object. In this example you could think of the class as an order form for a chair.</p>
<p><strong>Inventor Object Model Example</strong></p>
<p>Inventorâ€™s objects are accessed through the Object Model</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36b5a6b8970b-pi"><img alt="image" border="0" height="246" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fc9d970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="384" /></a></p>
<p>In this VB.NET example below notice how the hierarchy of the Object Model is used:</p>
<p>Application&gt;PartDocument&gt;PartComponentDefinition&gt;Features&gt;ExtrudeFeatures</p>
<p>This code uses properties of Objects that are shortcuts such as ActiveDocument. (m_inventorApp is an Application Object)</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> GetExtrudeFeature()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPartDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">PartDocument</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPartDoc = m_inventorApp.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oExtrude <span style="color: blue;">As</span> <span style="color: #2b91af;">ExtrudeFeature</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrude = oPartDoc.ComponentDefinition.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Features.ExtrudeFeatures(<span style="color: #a31515;">&quot;Extrusion1&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; MsgBox(<span style="color: #a31515;">&quot;Extrusion &quot;</span> &amp; oExtrude.Name &amp;</p>
<p style="margin: 0px;">&#0160;<span style="color: #a31515;">&quot; is suppressed: &quot;</span> &amp; oExtrude.Suppressed)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>&#0160;</p>
<p><strong>&#0160;</strong></p>
<p><strong>Object Model Tools â€“ Object Browser</strong> <br />The Object Browser provides a user-interface to the contents of the type library. (Object Model)&#0160; <br />In VBA the Object Browser is accessed using the F2 function key. It is also the Object Browser command in the View menu. In .NET&#0160; using Ctrl+Alt+J, or the Object Browser command in the View menu will launch this utility. <br /><strong>&#0160;</strong></p>
<p><strong>Object Model Tools - VBA Debugger</strong></p>
<p>The VBA debugger provides a â€œliveâ€ view of the object model. <br />You can see the values of an objects properties at runtime. <br />The VBA debugger provides more information that .Net debugger. To use the debugger add a Watch to a variable and place a break point.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fcb0970d-pi"><img alt="image" border="0" height="332" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36b5a6eb970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="440" /></a></p>
<p><strong>Object Model Tools - .NET Debugger</strong></p>
<p>Provides a â€œliveâ€ view of the object model. <br />Shows the values of an object properties. <br />Shows the contents of collections.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fcdd970d-pi"><img alt="image" border="0" height="222" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fcf2970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="486" /></a></p>
<p>&#0160;</p>
<p><strong>Collection Objects</strong></p>
<p>A collection is a special object that provides access to a list of objects. The count property of a collection returns number of objects that are in the collection. The Item property returns a specific object in the collection. You can specify the index of the object within the collection and the first item in the collection will be at an index of 1. This is true for all collections within Inventor API. (You may have experience with some other API that uses zero for the index of the the first item in a collection). In some cases you can specify the name of the object within the collection. (use a string instead of an number). In this diagram the collections are Documents, PartFeatures and ExtrudeFeatures.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c36b5a718970b-pi"><img alt="image" border="0" height="222" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40e43755970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="353" /></a></p>
<p><strong>Collection vs. Enumerator Objects</strong></p>
<p>Some collections support the functionality to create new objects. <br />Enumerators are also collections but only support the Count and Item properties.</p>
<p><strong>Iterating Through a Collection</strong></p>
<p>This VB.NET example Iterates through a collection using Count and Item:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oExtrude <span style="color: blue;">As</span> <span style="color: #2b91af;">ExtrudeFeature</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> i <span style="color: blue;">As</span> <span style="color: blue;">Long</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> i = 1 <span style="color: blue;">To</span> oExtrudeFeatures.Count</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(oExtrudeFeatures.Item(i).Name)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
</div>
<p>This example uses a For Each statement (more efficient):</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Dim</span> oExtrude <span style="color: blue;">As</span> <span style="color: #2b91af;">ExtrudeFeature</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">For</span> <span style="color: blue;">Each</span> oExtrude <span style="color: blue;">In</span> oExtrudeFeatures</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(oExtrude.Name)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Next</span></p>
</div>
<p><br /><strong>Derived Objects</strong> <br />This is similar to animal taxonomy or classification. All items under a specific classification share common traits. In this chart you can see that Cat, Dog and Human are all classified as Mammals. This means that they share things in common. In the same way AssemblyDocument, PartDocument, DrawingDocument and PresentationDocument have things in common, such as a DisplayName. (a property of any Document)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40e43765970c-pi"><img alt="image" border="0" height="401" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40e43776970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="488" /></a></p>
<p><strong>Derived Objects â€“ Example</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> SaveDoc()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get ActiveDocument, could be Part, </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Assembly or Drawing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">Document</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = m_inventorApp.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Call the Save method on the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;generic() &#39;Document&#39; object</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc.Save()</p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
</div>
<p>&#0160;</p>
<p><strong>&#0160;</strong></p>
<p><strong>The Application Object</strong> <br />This top level object represents the Inventor Application and provides access to the other API objects. Properties, methods and events of the Application object support general functionality not specific to a document.</p>
<p><strong>Application Window</strong> <br />The Application object provides access to the main window through various methods and properties such as:&#0160; <br />Caption,Left, Top, Width, Height, GetAppFrameExtents, Move <br />WindowState, Visible, MainFrameHwnd</p>
<p><strong>Utility Objects</strong> <br />SoftwareVersion â€“ Provides information about the version of Inventor. <br />ChangeManager, CommandManager, FileManager, HelpManager, TransactionManager, MeasureTools, UserInterfaceManager â€“ Provide access to functions related to a particular area. <br />TransientGeometry â€“ Temporary geometry objects. <br />TransientObjects â€“ Temporary utility objects <br />TransientBrep â€“ Temporary Boundary Representation objects</p>
<p><strong>&#0160;</strong></p>
<p><strong>Shortcuts to â€œActiveâ€ Objects</strong> <br />Properties that provide direct access to various â€œActiveâ€ objects. <br />ActiveColorScheme, ActiveDocument, ActiveView <br />ActiveEnvironment, <br />ActiveEditObject â€“ Returns the object currently being edited.&#0160; This can be a document thatâ€™s been opened, a document thatâ€™s been in-place edited, a sketch, a sheet, and a flat pattern. <br />ActiveEditDocument â€“ Returns the document currently be edited</p>
<p><strong>Application Options <br /></strong>Provides access to objects that expose the various application options. <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee858fd1c970d-pi"><img alt="image" border="0" height="434" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40e437a3970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="405" /></a></p>
<p><strong>Application Level Objects</strong></p>
<p>Documents â€“ All currently open documents, including those that are referenced by other documents. <br />ApplicationAddIns â€“ The available Add-Ins. <br />VBAProjects â€“ VBA related objects.</p>
<p><strong>Events</strong> <br />Provides access to several different sets of events: <br />ApplicationEvents, AssemblyEvents, <br />FileAccessEvents, FileUIEvents <br />ModelingEvents, RepresentationEvents <br />SketchEvents, StyleEvents</p>
<p><strong>Miscellaneous</strong> <br />SilentOperation â€“ Causes all dialogs to be suppressed and take the default behavior.&#0160; Useful for batch processing operations where warning dialogs would normally be displayed as files are opened, processed, and closed.</p>
<p>LanguageName, Locale â€“ Language information.</p>
<p>MRUEnabled, MRUDisplay â€“ Controls display of most recently used file list at the bottom of the File menu.</p>
<p>Ready â€“ Indicates if Inventor is fully initialized.</p>
<p>StatusBarText â€“ Text shown in the status bar.</p>
<p><strong>How to access the Application Object? <br /></strong>In Inventorâ€™s VBA you can use the ThisApplication shortcut. <br />From&#0160; an AddIn: an application object is passed to the AddIn when the AddIn is loaded by Inventor. In a Standalone exe you can use the GetObject or CreateObject methods as in this VB.NET example:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Try</span> <span style="color: green;">&#39; Try to get an active instance of Inventor</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp = System.Runtime.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InteropServices.<span style="color: #2b91af;">Marshal</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetActiveObject(<span style="color: #a31515;">&quot;Inventor.Application&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span> <span style="color: green;">&#39; If not active, create a new </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; Inventor session</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> inventorAppType <span style="color: blue;">As</span> <span style="color: #2b91af;">Type</span> = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">Type</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetTypeFromProgID(<span style="color: #a31515;">&quot;Inventor.Application&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">Activator</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateInstance(inventorAppType)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Must be set visible explicitly</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp.Visible = <span style="color: blue;">True</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms.<span style="color: #2b91af;">MessageBox</span>.Show _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Error: couldn&#39;t create Inventor instance&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
</div>
<p>&#0160; <br /><strong>How to access the Application Object? â€“ C# <br /></strong>Similar to VB.NET, access from outside Inventor using either the GetObject or CreateObject methods:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">try</span> <span style="color: green;">//Try to get an active instance of Inventor</span></p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp = System.Runtime.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InteropServices.<span style="color: #2b91af;">Marshal</span>.GetActiveObject</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Inventor.Application&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">as</span> Inventor.<span style="color: #2b91af;">Application</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Type</span> inventorAppType =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">Type</span>.GetTypeFromProgID</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Inventor.Application&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp = System.<span style="color: #2b91af;">Activator</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateInstance(inventorAppType)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">as</span> Inventor.<span style="color: #2b91af;">Application</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//Must be set visible explicitly</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp.Visible = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">}</p>
<p style="margin: 0px;"><span style="color: blue;">catch</span></p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; System.Windows.Forms.<span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;Error: couldn&#39;t create Inventor instance&quot;</span>);</p>
<p style="margin: 0px;">}</p>
</div>
<p>&#0160;</p>
<p><strong>Lab: Access the Application Object</strong> <br />Create an external Exe that tries to access the Inventor Application object at startup. If a running instance of Inventor is not found, then create a new instance using â€œCreateInstanceâ€ <br />Create some controls in order to:&#0160; <br />Ask user for Height and Width values and set the ActiveView to the entered values. Ask user for the Application caption and set it.</p>
<p>Here is a completed Lab if you need an example to help find something that is not working right.</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a00e553fcbfc68834017ee8590207970d"><a href="http://modthemachine.typepad.com/files/inventor_training_module_01_samples.zip">Download Inventor_Training_Module_01_Samples</a></span></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for General Miscellaneous
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-general-miscellaneous
CATEGORY: Beginning API
CATEGORY: C#
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/01/c-help-examples-for-general-miscellaneous.html 
DATE: 01/29/2013 07:06:39 PM
-----
BODY:
<p>This section of VBA procedures converted from the help file are related to various topics. A couple of the VBA examples in this section use an InputBox to get values from the user. The C# code uses a form instead. The form is used with the attribute and units of measure example. Also The C# code does have the thumbnail example but it is not on the dropdown because using iPictureDisp needs to run in process. If you need to do change the thumbnail of a document you can copy the code to an Inventor AddIn. The PictureDispConverter class is a C# version of the VB code example on this <a href="http://modthemachine.typepad.com/my_weblog/2012/02/bitmaps-without-vb6-icontoipicture.html" target="_blank">post</a>.</p>
<p>Even though the name of this section is Miscellaneous the classes that these examples demonstrate will be used in many Inventor applications. (This is the eleventh post with VBA examples converted to C#).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d40921991970c-pi"><img alt="image" border="0" height="334" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d409219a6970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="297" /></a></p>
<p>You can find details about how the C# projects can be used in this <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">post</a>. This project has the following functions:</p>
<p><span class="asset  asset-generic at-xid-6a00e553fcbfc68834017c3663ad6d970b"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_general_miscellaneous.zip">Download InventorHelpExamples_General_Miscellaneous</a></span>&#0160;</p>
<p>SetAndGetAttribute <br />ExplodeClientFeature <br />ExportToSat <br />PlaceContentCenterPart <br />addAppEvents <br />removeAppEvents <br />OpenDocumentWithRepresentations <br />PrintEnvironmentNames <br />ReferenceKeyFromFace <br />FaceFromReferenceKey <br />InventorUOM <br />InventorUOMConvert <br />CreateUCSBy3Points <br />CreateUCSByTransformationMatrix</p>
<p><strong>Here is the SetAndGetAttribute function:</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160;&#0160;&#0160; Dynamic Attributes API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the basic concept of </span></p>
<p style="margin: 0px;"><span style="color: green;">//dynamic attributes. For a selected entity, it</span></p>
<p style="margin: 0px;"><span style="color: green;">//creates an attribute set and an attribute. If</span></p>
<p style="margin: 0px;"><span style="color: green;">//the selected entity already has the attribute</span></p>
<p style="margin: 0px;"><span style="color: green;">//set, it allows you to edit the value.</span></p>
<p style="margin: 0px;"><span style="color: green;">//To use this sample select an entity and run.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> SetAndGetAttribute()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Check to make sure a single item is in </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//the select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span>(ThisApplication.ActiveDocument.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SelectSet.Count != 1)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;A single entity must be selected.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the item from the select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">object</span> oSelectedObject = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSelectedObject =</p>
<p style="margin: 0px;">ThisApplication.ActiveDocument.SelectSet[1];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Make sure the selected object </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//supports attributes.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AttributeSets</span> oAttribSets =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">AttributeSets</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttribSets =&#0160; (<span style="color: #2b91af;">AttributeSets</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; oSelectedObject.GetType().InvokeMember</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;AttributeSets&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BindingFlags</span>.GetProperty,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">null</span>, oSelectedObject, <span style="color: blue;">null</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">&#0160;&#0160; (<span style="color: #a31515;">&quot;Object does not support attributes.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">string</span> sNewValue = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AttributeSet</span> oAttribSet =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">AttributeSet</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">Attribute</span> oAttrib =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(Inventor.<span style="color: #2b91af;">Attribute</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Check to see if the object already</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//has attribute set named &quot;AttribTest&quot;.</span></p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">if</span> (oAttribSets.NameIsUsed[<span style="color: #a31515;">&quot;AttribTest&quot;</span>])</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Get a reference to the existing </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//attribute set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttribSet =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttribSets[<span style="color: #a31515;">&quot;AttribTest&quot;</span>];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Get the existing attribute.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttrib = oAttribSet[<span style="color: #a31515;">&quot;Attrib&quot;</span>];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">using</span>(<span style="color: #2b91af;">myInputForm</span> myForm =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">new</span> <span style="color: #2b91af;">myInputForm</span>())</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; myForm.textBox1.Text =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttrib.Value;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span>(myForm.ShowDialog(<span style="color: blue;">this</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; == <span style="color: #2b91af;">DialogResult</span>.OK)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sNewValue =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; myForm.textBox1.Text;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// If the value&#39;s different, change</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//the value of the attribute.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (!<span style="color: blue;">string</span>.IsNullOrEmpty(sNewValue)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &amp; sNewValue != oAttrib.Value)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttrib.Value = sNewValue;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//Get value to assign to attribute.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">using</span> (<span style="color: #2b91af;">myInputForm</span> myForm =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">new</span> <span style="color: #2b91af;">myInputForm</span>())</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (myForm.ShowDialog(<span style="color: blue;">this</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; == <span style="color: #2b91af;">DialogResult</span>.OK)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sNewValue =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; myForm.textBox1.Text;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// If a value was entered, create </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//new attribute set and attribute.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (!<span style="color: blue;">string</span>.IsNullOrEmpty(sNewValue))</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create a new attribute set </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//with the name &quot;AttribTest&quot;.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttribSet =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttribSets.Add(<span style="color: #a31515;">&quot;AttribTest&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create new attribute named</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//&quot;Attrib&quot; and assign value</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oAttrib = oAttribSet.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Attrib&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">ValueTypeEnum</span>.kStringType,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sNewValue);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: ETO 2013 R2 now available
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: eto-2013-r2-now-available
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/01/eto-2013-r2-now-available.html 
DATE: 01/17/2013 07:35:16 PM
-----
BODY:
<p>The Inventor Engineer-To-Order 2013 release 2 shipped this week and I am excited to started with it. One of the main enhancements is the Visual Studio Add-In called ETO Studio. Using Visual Studio to create Inventor ETO applications will be a nice change for ETO application developers. The previous release did have a preview of ETO Studio but with this release it is ready for â€œprime timeâ€. I am sure the ability to debug rules will be very welcome. The other main enhancements are quality and performance enhancements. You can download a webcast about what is new in the R2 release from this <a href="http://modthemachine.typepad.com/my_weblog/2013/01/eto-potlatch-recordings.html" rel="noopener noreferrer" target="_blank">post</a>.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Subscriber
EMAIL: chris.rogers@d3tech.net
IP: 67.231.38.66
URL: 
DATE: 01/22/2013 06:40:35 PM
Maybe it is just me, but it seems this Inventor API blog has become an Inventor ETO blog.  The updates are rare and all about Inventor ETO now.  I understand the bloggers are probably focusing on Inventor ETO now.  I was just thinking maybe it's time to create a new blog specific to Inventor ETO and get some new bloggers in here for Mod the Machine.

Thoughts?
-----
COMMENT:
AUTHOR: scott
EMAIL: scott_moyse1@hotmail.com
IP: 180.222.65.87
URL: 
DATE: 01/25/2013 12:32:04 PM
That would be handy please. ETO is cool and everything but not what most 'mainstream' users will ever be playing with.

I do appreciate the time you take to blog all the same. I'm just giving some constructive feedback
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.29
URL: 
DATE: 01/29/2013 07:18:48 PM
Thanks for your interest in this blog. I understand your point and I have sent your comments to my colleages here at Autodesk. 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: ETO Potlatch recordings
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: eto-potlatch-recordings
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/01/eto-potlatch-recordings.html 
DATE: 01/11/2013 06:12:52 PM
-----
BODY:
<p>Over the past several months there have been webcasts on Engineer-To-Order topics. I was able to get the recordings of these sessions and will post them. The focus of the first session is â€œFrame-Based Positioningâ€ and includes a comparison to â€œConstraint-Based Positioning. At the end there is a question and answer session that should also be useful.</p>
<p><em>&quot;Comparison of Positioning Techniques&quot; Volume 1 -&#0160;6-Sep-2012</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_FBP.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_FBP.zip</a></p>
<p>Here are the other Webcast recordings.</p>
<p><em>â€œUsing .NET with ETOâ€ Volume 2 -&#0160;11-Oct-2012</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_dotNet.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_dotNet.zip</a></p>
<p><em>â€œBuilding Regression Testing into ETO Modelsâ€&#0160; Volume 3 - 13-Nov-2012</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Regression_Test.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_Regression_Test.zip</a></p>
<p><em>â€œImplementing Large Scale ETO Applications - A Case Studyâ€&#0160; Volume 4 - 13-Dec-2012</em></p>
<p>&#0160;<a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Large_Apps.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_Large_Apps.zip</a></p>
<p><em>â€œWhat&#39;s New in Inventor ETO 2013 R2â€ Volume 5 - 16-Jan-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_ETO_2013_R2.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_ETO_2013_R2.zip</a></p>
<p><em>â€œSimple Strategies for UI and Drawingsâ€ Volume 6 - 19-Feb-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Strategies_UI_Drawings.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_Recording_Strategies_UI_Drawings</a></p>
<p><em>â€œProject Architecture Best Practicesâ€ &#0160;Volume 7 - 19-Mar-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Project_Architecture.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_Recording__Project_Architecture_Best_Practices</a></p>
<p><em>â€œETO Integration with Vaultâ€&#0160; Volume 8 - 18-Apr-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Vault_Integration.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_Vault_Integration</a></p>
<p><em>â€œSpeed Optimization with Large Modelsâ€ Volume 9 - 28-May-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Optimize_Large_Models.zip" rel="noopener noreferrer" target="_blank">ETO_Potlatch_recording_Optimize_Large_Models</a></p>
<p><em>&quot;Creating customized, branded applications with Inventor OEM&quot; Volume 10 - 18-June-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_Inventor_OEM.zip" rel="noopener noreferrer" target="_blank">ETO Potlatch recording Inventor OEM</a></p>
<p><em>&quot;Entering the brave new world of cloud with Configurator 360 - Volume 11 - 16-July-2013&quot;</em></p>
<p><em><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_11_Configurator_360.zip" target="_self" title="">ETO_Potlatch_recording_Configurator_360</a></em></p>
<p><em>&quot;Do&#39;s and Don&#39;ts of an ETO Server deployment setup&quot; Volume 12 - 24-Sep-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_12_ETO_Server_Deployment.zip" target="_self" title="ETO_Potlatch_recording_ETO_Server_Deployment">ETO_Potlatch_recording_ETO_Server_deployment</a></p>
<p><em>â€œGetting the most out of UI Tools: Basic and Advanced conceptsâ€ Volume 13 - 17-Oct-2013</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_13_ETO_UI_Tools_Basic_Advanced.zip" rel="noopener noreferrer" target="_blank">ETO Potlatch recording UI Tools</a></p>
<p><a href="http://modthemachine.typepad.com/Potlatch%20-%20UITools.zip" rel="noopener noreferrer" target="_blank">Demo projects shown in the UI Tools Potlatch</a></p>
<p><em>&quot;Customer presentation - Anvil International&quot; &#0160;Volume 14 - 16-Jan-2014</em></p>
<p>&#0160;<a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_14_Anvil_International.zip" target="_self" title="">ETO_Potlatch_recording_Anvil_International</a></p>
<p><em>&quot;From Revit to Inventor and back with ETO&quot; Volume 15 - 25-Feb-2014</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_15_Revit_To_Inventor.zip" target="_self" title="Potlatch_Revit_To_Inventor">ETO_Potlatch_recording_Revit_To_Inventor</a></p>
<p><em>&quot;Digging Deeper Into .Net&quot; Volume 16 - 25-March-2014</em></p>
<p>&#0160;<a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_16_Digging_Deeper_DotNet.zip" target="_self">ETO_Potlatch_recording_Digging_Deeper_Into_DotNet</a></p>
<p><em>&#0160;&quot;ETO Actions in Configurator 360&quot; Volume 17 - 24-April-2014</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_17_ETO_Actions_in_C360.zip" target="_self"><em>ETO_Potlatch_recording_17_ETO_Actions_in_C360</em></a></p>
<p><em>&quot;Creating a Simple ETO App for Configurator 360&quot; Volume 18 - 26-June-2014</em></p>
<p><a href="href=&quot;http://modthemachine.typepad.com/ETO_Potlatch_Recordings/ETO_Potlatch_recording_18_Simple_ETO_App_for_C360.zip" target="_self"><em>&#0160;</em></a><a href="http://modthemachine.typepad.com/ETO_Potlatch_Recordings/ETO_Potlatch_recording_18_Simple_ETO_App_for_C360.zip" target="_self"><em>ETO_Potlatch_recording_18_Simple_ETO_App_for_C360</em></a></p>
<p><em>&quot;Streamlining Sales and Marketing with Inventor ETO Volume 19 - 20-August-2014&quot;&#0160;</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_19_Streamlining_Sales_Marketing_ETO.zip" target="_self"><em>ETO_Potlatch_recording_19_Streamlining_Sales_Marketing_ETO</em></a></p>
<p><em>&quot;Batch Processing using Inventor ETO Volume - 20 - 21 October 2014&quot;</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_20_Batch_Processing.zip" target="_self">ETO_Potlatch_recording_20_Batch_Processing</a>&#0160;</p>
<p>&quot;<em>Configurator360 - iLogic - drawings of configurable assemblies Volume - 21 - 28 January 2015&quot;</em></p>
<p>&#0160;<a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_21_iLogic_Drawing_Dimensionss.zip" target="_self">ETO_Potlatch_recording_21_iLogic_Drawing_Dimensions</a></p>
<p><span class="asset  asset-generic at-xid-6a00e553fcbfc6883401b8d0cb14a2970c img-responsive">Example assembly used in ETO Potlatch 21 -&#0160;<a href="http://modthemachine.typepad.com/files/simpletable.zip">Download SimpleTable</a></span></p>
<p><em>&#0160;&quot;Configurator360 - Dynamic UI - Using ETO Rules Volume - 22 - 11 March 2015&quot;</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_22_Dynamic_C360_UI_ETO_Rules.zip" target="_self">ETO_Potlatch_recording_22_C360_UI_ETO_Rules</a></p>
<p><em>&quot;Licensing and Packaging changes Volume - 23 - 20 May 2015&quot;</em></p>
<p><a href="http://modthemachine.typepad.com/ETO_Potlatch_recording_23_Licensing_Packaging_Changes.zip" target="_self"><em>ETO_Potlatch_recording_23_Licensing_and_Packaging_Changes</em></a></p>
<p>&#0160;</p>
<p>I thought it was interesting that theses sessions were a called a potlatch. Here is the definition from <a href="http://en.wikipedia.org/wiki/Potlatch" rel="noopener noreferrer" target="_blank">Wikipedia</a>&#0160;</p>
<p>â€œA potlatch is a gift-giving festival and primary economic system practiced by indigenous peoples of the Pacific Northwest Coast of Canada and United States. This includes Heiltsuk Nation, Haida, Nuxalk, Tlingit, Makah, Tsimshian,Nuu-chah-nulth, Kwakwaka&#39;wakw,and Coast Salish cultures. The word comes from the Chinook Jargon, meaning &quot;to give away&quot; or &quot;a gift&quot;; originally from the Nuu-chah-nulth word pÌ“aÄiÆ›, to make a ceremonial gift in a potlatch.â€</p>
<p>For someone getting started with ETO these sessions are a nice gift. The person leading the discussion in the first recording is Jon Balgley who works for Autodesk Engineering.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Branson
EMAIL: brandon.see@thyssenkrupp.com
IP: 74.204.94.114
URL: 
DATE: 01/11/2013 07:06:43 PM
Thank you for posting a downloadable copy.  The videos are all very informative, but I always have trouble streaming them.  I look forward to you posting the rest of them. 
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: 
IP: 31.40.204.163
URL: http://profile.typepad.com/6p017c31afd964970b
DATE: 01/13/2013 12:41:07 PM
Any chances to get it done with a bit more popular codec?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.33
URL: 
DATE: 01/17/2013 07:16:40 PM
The other webcasts are now available for download.
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.33
URL: 
DATE: 01/17/2013 07:18:09 PM
I am just getting the recordings saved from the Web session. 
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: 
IP: 
URL: http://profile.typepad.com/6p017c31afd964970b
DATE: 01/18/2013 10:43:14 AM
Wayne, unfortunately the same problem - unknown codec. Voice is the only available part of the the video...
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: 
IP: 195.230.112.10
URL: http://profile.typepad.com/6p017c31afd964970b
DATE: 01/18/2013 01:16:14 PM
Ok just in case someone else suffer difficulties - install <a href="https://www3.gotomeeting.com/codec?P...otomeeting.com">https://www3.gotomeeting.com/codec?P...otomeeting.com</a> codec and open file with Windows Media Player
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Sheet metal
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-sheet-metal
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2013/01/c-help-examples-for-sheet-metal.html 
DATE: 01/11/2013 03:25:55 AM
-----
BODY:
<p>Here is another section of VBA procedures from the help file converted to C#. These examples are related to sheet metal. These examples will be helpful if you are getting started using the Inventor API to work with sheet metal parts and want to use C#. This is the tenth post with converted help samples.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee7357d83970d-pi"><img alt="image" border="0" height="396" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee7357da4970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="393" /></a></p>
<p>You can find details about how the C# projects can be used in this <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">post</a>. This project has the following functions:</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017ee73584c6970d"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_sheetmetal.zip">Download InventorHelpExamples_SheetMetal</a></span></p>
<p>WriteSheetMetalDXF <br />EditFlangeWidths <br />FlangeWidthsCreation <br />BendExtentEdges <br />FaceAndFoldFeatureCreation <br />LoftedFeatureCreation <br />PunchFeatureReport <br />PlacePunchFeature <br />RipFeatureCreation <br />SheetMetalFeatureDisplay <br />FaceAndCutFeatureCreation <br />FaceAndFlangeFeatureCreation <br />SheetMetalStyleDisplay <br />SetSheetMetalThickness <br />CreateSheetMetalStyle</p>
<p>Here is the FaceAndFoldFeatureCreation function:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">// Create sheet metal face and fold features</span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of</span></p>
<p style="margin: 0px;"><span style="color: green;">// sheet metal face and fold features.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> FaceAndFoldFeatureCreation()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new sheet metal document, using the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//default sheet metal template.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> oSheetMetalDoc =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">PartDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">SystemOfMeasureEnum</span>.kDefaultSystemOfMeasure,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DraftingStandardEnum</span>.kDefault_DraftingStandard,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;{9C464203-9BAE-11D3-8BAD-0060B0CE6BB4}&quot;</span>));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the component definition.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SheetMetalComponentDefinition</span> oCompDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SheetMetalComponentDefinition</span>)oSheetMetalDoc.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the sheet </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// metal features collection.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SheetMetalFeatures</span> oSheetMetalFeatures =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SheetMetalFeatures</span>)oCompDef.Features;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new sketch on the X-Y work plane.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> oSketch = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PlanarSketch</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch = oCompDef.Sketches.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oCompDef.WorkPlanes[3]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the transient </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// geometry object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientGeometry</span> oTransGeom =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">TransientGeometry</span>)ThisApplication.TransientGeometry;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Draw a 4cm x 3cm rectangle with the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// corner at (0,0)</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.SketchLines.AddAsTwoPointRectangle</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oTransGeom.CreatePoint2d(0, 0),</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTransGeom.CreatePoint2d(4, 3));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a profile.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Profile</span> oProfile =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Profile</span>)oSketch.Profiles.AddForSolid();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">FaceFeatureDefinition</span> oFaceFeatureDefinition =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">FaceFeatureDefinition</span>)oSheetMetalFeatures.</p>
<p style="margin: 0px;">FaceFeatures.CreateFaceFeatureDefinition(oProfile);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a face feature.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">FaceFeature</span> oFaceFeature = <span style="color: blue;">default</span>(<span style="color: #2b91af;">FaceFeature</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oFaceFeature = oSheetMetalFeatures.FaceFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(oFaceFeatureDefinition);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the top face for creating the new sketch.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// assume that the 6th face is the top face.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Face</span> oFrontFace = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Face</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oFrontFace = oFaceFeature.Faces[6];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new sketch on the top face.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> oFoldLineSketch =</p>
<p style="margin: 0px;">&#0160;&#0160; (<span style="color: #2b91af;">PlanarSketch</span>)oCompDef.Sketches.Add(oFrontFace);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// The end points of the sketch line must </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//lie on an edge</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">Point</span> oEdge1MidPoint =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (Inventor.<span style="color: #2b91af;">Point</span>)oFrontFace.Edges[1].</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Geometry.MidPoint;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oSketchPoint1 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Point2d</span>)oFoldLineSketch.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ModelToSketchSpace(oEdge1MidPoint);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">Point</span> oEdge2MidPoint =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (Inventor.<span style="color: #2b91af;">Point</span>)oFrontFace.Edges[3].</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Geometry.MidPoint;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oSketchPoint2 =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Point2d</span>)oFoldLineSketch.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ModelToSketchSpace(oEdge2MidPoint);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the fold line between the midpoint </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// of two opposite edges on the face</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchLine</span> oFoldLine =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">SketchLine</span>)oFoldLineSketch.SketchLines.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; AddByTwoPoints(oSketchPoint1, oSketchPoint2);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">FoldDefinition</span> oFoldDefinition =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">FoldDefinition</span>)oSheetMetalFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; FoldFeatures.CreateFoldDefinition</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oFoldLine, <span style="color: #a31515;">&quot;60 deg&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a fold feature</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">FoldFeature</span> oFoldFeature =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">FoldFeature</span>)oSheetMetalFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; FoldFeatures.Add(oFoldDefinition);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.ActiveView.GoHome();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Using Inventor ETO Server Configurator &ndash;ensure the Design name is correct
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-inventor-eto-server-configurator-ensure-the-design-name-is-correct
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/12/using-inventor-eto-server-configurator-ensure-the-design-name-is-correct.html 
DATE: 12/19/2012 09:45:17 PM
-----
BODY:
<p>In this <a href="http://modthemachine.typepad.com/my_weblog/2012/10/using-inventor-eto-server-configurator.html" target="_blank">post</a> you can find a discussion on using the ETO server configurator. Recently I had a case where ETO server was being used and an error â€œNo Such Designâ€ was occurring when&#0160; AddDynamicChildRule() was called. (One of the parameters is the name of a design). The design was available in the application and the code worked on my system. After looking at the behavior on the developerâ€™s system we found that the design set in the ETO server configurator was not a name of an available design. In this screenshot the Design is set to FloorSystem and the problem occurred because the actual name of the design was FloorSystems.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee66d5413970d-pi"><img alt="image" border="0" height="337" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3ef8ca58970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="482" /></a></p>
<p>I have logged a wish list with engineering to have the configurator pop up a warning if the design set for the application is not available.</p>
<p>-Wayne&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Drawing Views
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-drawing-views
CATEGORY: C#
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/11/c-help-examples-for-drawing-views.html 
DATE: 11/29/2012 09:30:32 PM
-----
BODY:
<p>Here is another section of VBA procedures from the help file converted to C#. These examples are related to drawing views. There was one example that already had a C# version.&#0160;&#0160;&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3e4aa827970c-pi"><img alt="image" border="0" height="275" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee5bf7c5a970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="368" /></a></p>
<p>You can find details about how the C# projects can be used in this <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">post</a>. This project has the following functions:</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017d3e4aab33970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_drawing_views.zip">Download InventorHelpExamples_Drawing_Views</a></span></p>
<p>CreateBreakoperationInDrawingView <br />ModifyDrawingSketchEntityProperties <br />DrawingSketchFill <br />CreateDrawingSketchInView <br />AddBaseViewWithRepresentations <br />AddFlatPatternDrawingView <br />CreateDetailView <br />CreateDraftView <br />Layer <br />BreakAlignment <br />AddUsingSheetFormat</p>
<p><strong>Here is CreateBreakoperationInDrawingView <br /></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//Creation of a break operation in a drawing view </span></p>
<p style="margin: 0px;"><span style="color: green;">//Demonstrates the creation of a break operation.</span></p>
<p style="margin: 0px;"><span style="color: green;">//Before running this sample, select a drawing </span></p>
<p style="margin: 0px;"><span style="color: green;">//view in the active drawing.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> CreateBreakoperationInDrawingView()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the drawing document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// This assumes a drawing document is active.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingDocument</span> oDrawDoc =</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">DrawingDocument</span>)ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//Set a reference to the active sheet.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Sheet</span> oSheet = (<span style="color: #2b91af;">Sheet</span>)oDrawDoc.ActiveSheet;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingView</span> oDrawingView = <span style="color: blue;">default</span>(<span style="color: #2b91af;">DrawingView</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Check to make sure a drawing view is selected.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the selected drawing.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// This assumes that the selected view is</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// not a draft view.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDrawingView =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DrawingView</span>)oDrawDoc.SelectSet[1];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;A drawing view must be selected.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//center of the base view.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oCenter =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">Point2d</span>)oDrawingView.Center;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Define the start point of the break</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oStartPoint = ThisApplication.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TransientGeometry.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreatePoint2d(oCenter.X - 1, oCenter.Y);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Define the end point of the break</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oEndPoint = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Point2d</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oEndPoint = ThisApplication.TransientGeometry.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreatePoint2d(oCenter.X + 1, oCenter.Y);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">BreakOperation</span> oBreakOperation =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">BreakOperation</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oBreakOperation = oDrawingView.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; BreakOperations.Add</p>
<p style="margin: 0px;">(<span style="color: #2b91af;">BreakOrientationEnum</span>.kHorizontalBreakOrientation,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oStartPoint, oEndPoint,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BreakStyleEnum</span>.kRectangularBreakStyle, 5);</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Drawing Annotations, part two
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-drawing-annotations-part-two
CATEGORY: C#
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/11/c-help-examples-for-drawing-annotations-part-two.html 
DATE: 11/25/2012 09:32:44 PM
-----
BODY:
<p>Here is the second section of VBA procedures related to drawing annotations in the help file converted to C#. In this project you will find the rest of the 29 examples in this section. These examples create annotations such as feature control frames and stacked text. There is also an example that creates a title block with prompted text an an example that shows how to insert the title block on a sheet.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c33f8b687970b-pi"><img alt="image" border="0" height="298" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3e278e55970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="325" /></a></p>
<p>You can find details about how the C# projects can be used in this <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">post</a>. This project has the following functions:</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017c33f8b961970b"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_drawing_annotations_2.zip">Download InventorHelpExamples_Drawing_Annotations_2</a></span></p>
<p>AddFeatureControlFrame <br />SheetTextAdd <br />StackedText <br />CreateHoleTables <br />AddThreadNote <br />AddLeaderNote <br />CreateOrdinateDimensions <br />CreatePartsList <br />PartListEdit <br />PartListQuery <br />AddPunchNote <br />RevisionTableQuery <br />AddSurfaceTextureSymbol <br />CreateTitleBlockDefinition <br />InsertTitleBlockOnSheet <br />TitleBlockCopy</p>
<p><strong>Here is AddFeatureControlFrame</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160; Create a feature control frame symbol API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of a feature </span></p>
<p style="margin: 0px;"><span style="color: green;">//control frame symbol.</span></p>
<p style="margin: 0px;"><span style="color: green;">//Select a linear drawing curve and run the sample.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> AddFeatureControlFrame()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the drawing document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// This assumes a drawing document is active.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingDocument</span> oDrawDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DrawingDocument</span>)ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the active sheet.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Sheet</span> oActiveSheet = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Sheet</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oActiveSheet = oDrawDoc.ActiveSheet;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the drawing </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//curve segment. This assumes that a drwaing</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//curve is selected.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingCurveSegment</span> oDrawingCurveSegment =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">DrawingCurveSegment</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDrawingCurveSegment =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDrawDoc.SelectSet[1];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the drawing curve.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingCurve</span> oDrawingCurve =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">DrawingCurve</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDrawingCurve =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDrawingCurveSegment.Parent;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Get the mid point of the selected curve</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// assuming that the selection curve </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//is linear</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oMidPoint = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Point2d</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMidPoint = oDrawingCurve.MidPoint;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// TransientGeometry object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientGeometry</span> oTG =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">TransientGeometry</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTG = ThisApplication.TransientGeometry;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectCollection</span> oLeaderPoints =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ObjectCollection</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oLeaderPoints =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateObjectCollection();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create a few leader points.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oLeaderPoints.Add</p>
<p style="margin: 0px;">&#0160; (oTG.CreatePoint2d(oMidPoint.X + 10,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMidPoint.Y + 10));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oLeaderPoints.Add</p>
<p style="margin: 0px;">&#0160; (oTG.CreatePoint2d(oMidPoint.X + 10,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMidPoint.Y + 5));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create an intent and add to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// leader points collection.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// This is the geometry that the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// symbol will attach to.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">GeometryIntent</span> oGeometryIntent =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">GeometryIntent</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeometryIntent = oActiveSheet.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateGeometryIntent(oDrawingCurve);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oLeaderPoints.Add(oGeometryIntent);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create a FeatureControlFrameRows object to </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//define the symbol&#39;s rows</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">FeatureControlFrameRows</span> oRows =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">FeatureControlFrameRows</span>)oActiveSheet.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; FeatureControlFrames.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateFeatureControlFrameRows();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Add a row</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">FeatureControlFrameRow</span> oRow =&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">FeatureControlFrameRow</span>)oRows.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">GeometricCharacteristicEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kProfileOfAnySurface,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;0.20&quot;</span>, <span style="color: #a31515;">&quot;&quot;</span>, <span style="color: #a31515;">&quot;A&quot;</span>, <span style="color: #a31515;">&quot;B&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Create the feature control frame </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//symbol with a leader</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">FeatureControlFrame</span> oSymbol =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">FeatureControlFrame</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSymbol = oActiveSheet.FeatureControlFrames.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(oLeaderPoints, oRows);</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Drawing Annotations, part one
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-drawing-annotations-part-one
CATEGORY: C#
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/11/c-help-examples-for-drawing-annotations-part-one.html 
DATE: 11/06/2012 03:12:57 AM
-----
BODY:
<p>There are a many VBA procedures related to drawings in the help file. In this project you will find 14 of the examples related to&#0160; drawing annotations converted to C#.</p>
<p>This section in the help has has 29 VBA demos.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3d54341b970c-pi"><img alt="image" border="0" height="383" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c33259db7970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="446" /></a></p>
<p>You can find details about how the C# projects can be used in this&#0160; <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html">post</a>. This project has the following functions:</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017ee4c999b7970d"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_drawing_annotations_1.zip">Download InventorHelpExamples_Drawing_Annotations_1</a></span></p>
<p>CenterAllDimensions <br />EditBalloons <br />CreateBalloon <br />GetComponentReferencedByBalloon <br />CreateBaselineDimensionSet <br />AddBendNote <br />CreateChainDimensionSet <br />CreateCustomTable <br />CreateBendTable <br />CreateConfigurationTable <br />CreateDrawingExcelTable <br />EditDrawingDimensions <br />DeleteUnattachedDimensions <br />DimensionAlign</p>
<p><strong>Here is DimensionAlign:</strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160;&#0160;&#0160; Aligning drawing dimensions API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates aligning the selected </span></p>
<p style="margin: 0px;"><span style="color: green;">//drawing dimensions along a horizontal or vertical</span></p>
<p style="margin: 0px;"><span style="color: green;">//axis. The first dimension selected defines the </span></p>
<p style="margin: 0px;"><span style="color: green;">//origin of the axis. A drawing document must be </span></p>
<p style="margin: 0px;"><span style="color: green;">//open and at least two dimensions selected.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> DimensionAlign()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingDocument</span> oDrawDoc =</p>
<p style="margin: 0px;">&#0160;&#0160; (<span style="color: #2b91af;">DrawingDocument</span>)ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Determine if there are any dimensions </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//in the select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SelectSet</span> oSelectSet = <span style="color: blue;">default</span>(<span style="color: #2b91af;">SelectSet</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSelectSet = oDrawDoc.SelectSet;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; <span style="color: blue;">var</span> colDimensions = <span style="color: blue;">new</span> <span style="color: #2b91af;">List</span>&lt;<span style="color: #2b91af;">DrawingDimension</span>&gt;();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// long i = 0;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 1; i &lt;= oSelectSet.Count; i++)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (oSelectSet[i] <span style="color: blue;">is</span> <span style="color: #2b91af;">DrawingDimension</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Add any dimensions to the collection.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//We need to save them</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// in something besides the selection </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//set because once we start</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// manipulating them, the select set </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//will be cleared.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; colDimensions.Add(oSelectSet[i]);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (colDimensions.Count != 2)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;Select at least 2 dimensions for this operation.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Ask the user if he/she wants vertical </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//or horizontal alignment.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">bool</span> bHorizontal = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DialogResult</span> diagRes = <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;Horizontal alignment? No = vertical alignment)&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;Align Dimensions&quot;</span>, <span style="color: #2b91af;">MessageBoxButtons</span>.YesNo);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (diagRes == <span style="color: #2b91af;">DialogResult</span>.Yes)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bHorizontal = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bHorizontal = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">double</span> dPosition = 0;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; i &lt;= colDimensions.Count - 1;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; i++)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">DrawingDimension</span> oDimension =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">DrawingDimension</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDimension = colDimensions[i];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (i == 0)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Get the position of the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//first dimension text. This is</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// the position the other </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//dimensions will be aligned to.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (bHorizontal)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dPosition = oDimension.Text.Origin.Y;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dPosition = oDimension.Text.Origin.X;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// Change the position of the dimension.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oPosition = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Point2d</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPosition = oDimension.Text.Origin;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (bHorizontal)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// oPosition.Y = dPosition;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPosition.Y = dPosition;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// oPosition.X = dPosition;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPosition.X = dPosition;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDimension.Text.Origin = oPosition;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor Engineer-To-Order using frame based positioning - rotation example
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-engineer-to-order-using-frame-based-positioning-rotation-example
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/11/inventor-engineer-to-order-using-frame-based-positioning-rotation-example.html 
DATE: 11/03/2012 01:33:03 AM
-----
BODY:
<p>The most common way used to control the position of parts in ETO is the use of constraints. In some cases however it can be more advantageous to use frame based positioning to control the position. When using frame based positioning the trickiest thing is controlling the rotation. This example can be used to help you understand how to get the rotation you need.</p>
<p>The design below creates three parts:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3d3a133d970c-pi"><img alt="image" border="0" height="252" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c330b96e9970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="272" /></a></p>
<p>Design Assembly1_1 : ETO_WB_TestingRoot _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IvAssemblyDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39;Used to set the angle for myPart1_test <br />&#0160;&#0160;&#0160; &#39; and myPart1_test2 <br /></span>&#0160;&#0160;&#0160; Parameter Rule angleToRotate = 0 <br />&#0160;&#0160; <br />&#0160; <span style="color: #0000ff;">&#0160; &#39;Create a vector that is the X axis <br />&#0160;&#0160;&#0160; &#39; Rotated around Z Axis by the angle <br />&#0160;&#0160;&#0160; &#39; set in angleToRotate <br /></span>&#0160;&#0160;&#0160; Rule myRotatedVecX_z As Vector = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RotateVector(UnitX, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; angleToRotate, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UnitZ) <br />&#0160; <span style="color: #0000ff;">&#0160; &#39;Use the cross product to get a <br />&#0160;&#0160;&#0160; &#39; a vector for the Y direction <br /></span>&#0160;&#0160;&#0160; Rule myRotatedVecY_z As Vector = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UnitZ * MyRotatedVecX_z <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Create the part that will rotate <br />&#0160;&#0160;&#0160; &#39;around the Z Axis <br /></span>&#0160;&#0160;&#0160; Child myPart1_test As :Part1_Test <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDirection = myRotatedVecX_z <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yDirection = myRotatedVecY_z</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ignorePosition? = False <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; End Child <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#0160; &#39;Create a vector that is the X axis <br />&#0160;&#0160;&#0160; &#39; Rotated around Y Axis by the angle <br />&#0160;&#0160;&#0160; &#39; set in angleToRotate <br /></span>&#0160;&#0160;&#0160; Rule myRotatedVecX_y As Vector = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RotateVector(UnitX, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; angleToRotate, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UnitY) <br />&#0160; <span style="color: #0000ff;">&#0160; &#39;Use the cross product to get a <br />&#0160;&#0160;&#0160; &#39; a vector for the Y direction <br /></span>&#0160;&#0160;&#0160; Rule myRotatedVecY_y As Vector = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UnitY * MyRotatedVecX_y <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Create the part that will rotate <br />&#0160;&#0160;&#0160; &#39;around the Y Axis <br /></span>&#0160;&#0160;&#0160; Child myPart1_test2 As :Part1_Test <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDirection = myRotatedVecX_y <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yDirection = myRotatedVecY_y <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; origin=Point(4,0,0) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ignorePosition? = False <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; End Child <br />&#0160;&#0160;&#0160;</p>
<p>&#0160;&#0160;&#0160; <span style="color: #0000ff;">â€˜Parameters to control the rotation of the third part using frames</span></p>
<p>&#0160;&#0160;&#0160; Parameter Rule primaryRotationAngle = 0 <br />&#0160;&#0160;&#0160; Parameter Rule secondaryRotationAngle = 0 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160; <span style="color: #0000ff;">&#0160; &#39; This Frame is the world frame rotated <br />&#0160;&#0160;&#0160; &#39; by the parameter primaryRotationAngle <br />&#0160;&#0160;&#0160; &#39; around the Z Axis <br />&#0160;&#0160;&#0160; &#39; localFrame is the frame that was used <br />&#0160;&#0160;&#0160; &#39; to position the parent. In this simple <br />&#0160;&#0160;&#0160; &#39; example, worldframe = localFrame <br /></span>&#0160;&#0160;&#0160; Rule myFrame_1 As Frame = RotateFrame _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (localFrame, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; primaryRotationAngle, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Origin, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UnitZ) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39;This Frame is myFrame_1 rotated around <br />&#0160;&#0160;&#0160; &#39; the X axis in myFrame_1 <br />&#0160;&#0160;&#0160; &#39; â€œvector_â€ creates a vector relative to <br />&#0160;&#0160;&#0160; &#39; a given Frame <br /></span>&#0160;&#0160;&#0160; Rule myFrame_2 As Frame = RotateFrame _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (myFrame_1, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; secondaryRotationAngle, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Origin, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vector_(1, 0, 0, myFrame_1))</p>
<p>&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39;Create a part that will rotate around <br />&#0160;&#0160;&#0160; &#39; two axes by using the Frame created by <br />&#0160;&#0160;&#0160; &#39; using RotateFrame <br /></span>&#0160;&#0160;&#0160; Child myPart1_test3 As :Part1_Test <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ReferenceFrame = myFrame_2 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ignorePosition? = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; origin = Point(0,4,0) <br />&#0160;&#0160;&#0160; End Child</p>
<p>End Design</p>
<p>Here is the Edit Parameters dialog and the parts in the Inventor Model. Here all of the parameters are zero.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3d3a1353970c-pi"><img alt="image" border="0" height="662" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee4afb32d970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="401" /></a></p>
<p>After changing the angleToRotate to 90 notice the change in rotation for the parts in the lower area. The part on the left rotates around the Z axis. The part on the right rotates around the Y axis. The part on the top is not effected by a change to angleToRotate.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3d3a1376970c-pi"><img alt="image" border="0" height="590" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c330b9736970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="400" /></a></p>
<p>The top part is changed by the parameters primaryRotationAngle and&#0160; secondaryRotationAngle. Notice that the Z rotation is similar to the part below it, but the secondaryRotationAngle has rotated the part in in the Y direction as well. (Y direction in the part)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c330b9750970b-pi"><img alt="image" border="0" height="647" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c330b9776970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="395" /></a></p>
<p>Using a design like this you can experiment with different values in the parameters and see the results the rotation angle has on the parts.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor and Inventor View Service Packs now available
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-and-inventor-view-service-packs-now-available
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/11/inventor-and-inventor-view-service-packs-now-available.html 
DATE: 11/01/2012 06:04:26 PM
-----
BODY:
<p>Service packs for Inventor 2013 and the standalone version of AutodeskÂ® InventorÂ® View 2013 have recently been released. If you have an application that uses Apprentice on systems without having Inventor installed be sure to have your users get the service pack for the standalone version of Inventor View. Several issues have been addressed that effected Apprentice.</p>
<p>Here is the link to the page where Service Pack 1.1 for the standalone version of AutodeskÂ® InventorÂ® View 2013 can be downloaded:</p>
<p><a href="http://usa.autodesk.com/adsk/servlet/pc/item?siteID=123112&amp;id=20462274">http://usa.autodesk.com/adsk/servlet/pc/item?siteID=123112&amp;id=20462274</a></p>
<p>Here is the link to the page where you can download the Inventor 2013 Service Pack 1.1:</p>
<p><a href="http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=20442029&amp;linkID=9242019" title="http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=20442029&amp;linkID=9242019">http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=20442029&amp;linkID=9242019</a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Assemblies&ndash;General &amp; Constraints
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-assembliesgeneral-constraints
CATEGORY: Assemblies
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/c-help-examples-for-assembliesgeneral-constraints.html 
DATE: 10/29/2012 11:11:41 PM
-----
BODY:
<p>Here are two more sections of VBA examples converted to C#. These functions are related to constraints and other demos for assemblies that did not fit in one of the other sections. This is the seventh post with converted Help examples.</p>
<p>Note: One of the VBA examples caused a serious error and I logged a Change Request for it. The converted code for this macro is in the C# project but the function name is not added to the combo box. See this <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">post</a> for more information about these projects.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3d198734970c-pi"><img alt="image" border="0" height="356" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c32eafdd5970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="433" /></a></p>
<p>This project has the following functions:</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017c32eb0071970b"><a href="http://modthemachine.typepad.com/files/inventor_help_examples_csharp_asmb_gen_constraints.zip">Download Inventor_Help_Examples_CSharp_Asmb_Gen_Constraints</a></span></p>
<p>FixAllOccurrences <br />CreateShrinkwrapSubstitute <br />AssociativeBodyCopy <br />InsertConstraint <br />MateConstraint <br />MateConstraintOfWorkPlanes <br />MateConstraintWithLimits <br />CreateiMateDefinitionSample <br />iMateResultCreationSample</p>
<p>&#0160;</p>
<p><strong>Here is the InsertConstraint function <br /></strong></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160;&#0160;&#0160; Assembly Insert Constraint Add API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of an </span></p>
<p style="margin: 0px;"><span style="color: green;">//assembly insert constraint.</span></p>
<p style="margin: 0px;"><span style="color: green;">//Before running the sample, you need to open an</span></p>
<p style="margin: 0px;"><span style="color: green;">//assembly that contains at least two parts. </span></p>
<p style="margin: 0px;"><span style="color: green;">// Select circular edges on the two parts that </span></p>
<p style="margin: 0px;"><span style="color: green;">//will be used for the constraint and run the </span></p>
<p style="margin: 0px;"><span style="color: green;">//sample code. (Set the priority of the Select</span></p>
<p style="margin: 0px;"><span style="color: green;">//command and use the Shift-Select to select </span></p>
<p style="margin: 0px;"><span style="color: green;">//multiple edges.)</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> InsertConstraint()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the active assembly</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyDocument</span> oDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">AssemblyDocument</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyComponentDefinition</span> oAsmCompDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">AssemblyComponentDefinition</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SelectSet</span> oSelectSet = <span style="color: blue;">default</span>(<span style="color: #2b91af;">SelectSet</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSelectSet =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument.SelectSet;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Validate the correct data is in the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (oSelectSet.Count != 2)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;Select two circular edges for the insert.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the two edges from the select set.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> oEdge1 = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> oEdge2 = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdge1 = (<span style="color: #2b91af;">Edge</span>)oSelectSet[1];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdge2 = (<span style="color: #2b91af;">Edge</span>)oSelectSet[2];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show</p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;Select two circular edges for the insert.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//Note: this code does not test to see if </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//the edges are circular edges (they need to be)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the insert constraint </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//between the parts.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">InsertConstraint</span> oInsert =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">InsertConstraint</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oInsert = oAsmCompDef.Constraints.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddInsertConstraint</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oEdge1, oEdge2, <span style="color: blue;">true</span>, 0);</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor ETO Server with Sub projects &ndash; &ldquo;No Such design&rdquo;
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-eto-server-with-sub-projects-no-such-design
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/inventor-eto-server-with-sub-projects-no-such-design.html 
DATE: 10/24/2012 11:02:41 PM
-----
BODY:
<p>Here is a solution for a problem that can occur with ETO Server with a project that has sub projects. You can get a â€œNo such designâ€ error just using the â€œTest Application Services&quot; button in the Inventor ETO Server Configurator. When the designs are in one project with no sub projects the error does not occur.</p>
<p>To use the IPJ with subprojects from ETO Server, the following two things need to be done:</p>
<p>1. Ensure that the Main.IPJ contains the valid paths. It can be achieved with the XML editor (or notepad)</p>
<blockquote>
<p>a. Find this node in the ipj file:</p>
<p>InventorProject\AddInConfigs\AutodeskIntent\Dependents</p>
</blockquote>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3cf64264970c-pi"><img alt="clip_image002" border="0" height="171" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c32c7bb9c970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image002" width="482" /></a></p>
<blockquote>
<p>b. Update the paths in the &lt;string&gt; sub-nodes to point to <strong>existing</strong> <strong>IPJ files</strong> on the server.</p>
</blockquote>
<blockquote>
<p>c. Save Main.IPJ</p>
</blockquote>
<p>2. Ensure that shortcuts to these IPJ files are created</p>
<p>&#0160;&#0160;&#0160; a. You have to do that on behalf of <strong>InventorETOServices</strong> user<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c32c7bba9970b-pi"><img alt="clip_image002[5]" border="0" height="185" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3cf64279970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image002[5]" width="487" /></a></p>
<blockquote>
<p>b. In the DOS window, enter the command:</p>
</blockquote>
<blockquote>
<p>RunAS /user:InventorETOServices cmd</p>
</blockquote>
<blockquote>
<p>c. You will need to enter the valid password for the InventorETOServices user</p>
</blockquote>
<blockquote>
<p>[default is:&#0160; &quot;ETOServices123!@#&quot; with no quotes, see the <a href="http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/1240-Inventor1240/1248-Intent_S1248/1250-IntentSe1250">wiki help</a> for more info]</p>
</blockquote>
<blockquote>
<p>d. The new DOS window will appear</p>
</blockquote>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3cf6428a970c-pi"><img alt="clip_image004" border="0" height="227" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee46b860f970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image004" width="447" /></a></p>
<blockquote>
<p>e. Change directory to c:\Program Files\Autodesk\Inventor ETO Server 2013\Bin</p>
</blockquote>
<blockquote>
<p>f. <strong>For each dependent IPJ,</strong> enter the command, similar to the following:</p>
</blockquote>
<blockquote>
<p>InventorETOServer.exe -p &quot;c:\_someDir\xxxx\DataFiles\Directory of ipj files\some-name.ipj&quot;</p>
</blockquote>
<blockquote>
<p>That will create a shortcut in the Inventor Server Documents folder for the InventorETOServices user.</p>
</blockquote>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3cf642a6970c-pi"><img alt="clip_image006" border="0" height="172" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c32c7bbd2970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image006" width="472" /></a></p>
<p>&#0160;</p>
<p>This issue is under review by engineering and the problem should be handled in a more graceful manner in one of the future releases.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Amool
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 10/25/2012 01:50:29 AM
Hello Wayne,

Why you have started writing Macros in C# ????

Does Autodesk changing its platform from VBA to C# ????


-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 50.125.92.156
URL: 
DATE: 10/25/2012 04:51:17 PM
Hi Amool,

The API for Inventor is a COM automation API. VBA is one way to access it. One reason for making the C# examples is because some developer's want to use that language. (And it was a request on the the API survey). Cheers,
Wayne
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor ETO with Vault - set &ldquo;Embed Interop Types&rdquo; to False for Autodesk.Inventor.Interop
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-eto-with-vault-set-embed-interop-types-to-false-for-autodeskinventorinterop
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/inventor-eto-with-vault-set-embed-interop-types-to-false-for-autodeskinventorinterop.html 
DATE: 10/18/2012 05:47:52 PM
-----
BODY:
<p>Recently I had a case where using the Vault Designs in Inventor Engineer-To-Order would cause this error and fail:</p>
<p>&quot;<em>The invoked member is not supported in a dynamic assembly</em>&quot;</p>
<p>I was unable to recreate the problem on my machine. By the process of elimination we found that it was an custom AddIn that was related to the error occurring. The solution was to simply change the setting in Visual Studio for â€œEmbed Interop Typesâ€ to False. This screenshot shows the setting that needed to be changed in the AddIn:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee4429839970d-pi"><img alt="image" border="0" height="391" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c329eb8dd970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="408" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor OEM now available
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-oem-now-available
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/inventor-oem-now-available.html 
DATE: 10/17/2012 08:21:00 PM
-----
BODY:
<p>Inventor OEM is part of Engineer-To-Order series but now it is available as a stand alone product. See the Tech Soft 3D site for more information. You can try Inventor OEM for yourself with the free evaluation version.&#0160; <br /><a href="http://www.techsoft3d.com/our-products/autodesk-inventor-oem">http://www.techsoft3d.com/our-products/autodesk-inventor-oem</a></p>
<p>&#0160;</p>
<p><span style="font-weight: bold;"><a href="http://www.techsoft3d.com/getting-started/autodesk-inventor-oem/what-is-autodesk-inventor-oem" rel="noopener noreferrer" target="_blank">What is Autodesk Inventor OEM?</a></span></p>
<p>Autodesk Inventor OEM is a development platform that allows you to create a stand-alone application built on Autodesk Inventor technology. To your customers it will appear as your custom application since it is installed using your installer, licensed with your licensing, and is branded as your product (application name, splash screen, and various other icons).</p>
<p>You can choose to include Inventor commands as-is or create your own commands. The interface into the platform functionality is the Inventor API. Your functionality is supplied through an add-in.</p>
<p>Autodesk Inventor OEM is essentially Inventor with a few changes, listed below:</p>
<ol>
<li>It is modular. You can choose to have an application that only needs part functionality, part and assembly functionality, or part, assembly, and drawing functionality.</li>
<li>The branding is configurable so you can define your own application name, splash screen, application icons, executable name, etc.</li>
<li>It is fully independent of Inventor with regards to shared files and registry entries. This means it can be installed on a machine that has Inventor or another OEM application and run side-by-side.</li>
<li>It is independent of Autodesk licensing, allowing you to incorporate your own licensing.</li>
</ol>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Using Inventor ETO Server Configurator
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-inventor-eto-server-configurator
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/using-inventor-eto-server-configurator.html 
DATE: 10/10/2012 12:21:15 AM
-----
BODY:
<p>One of the tools you use when setting up an ETO application to use with ETO server is the â€œInventor ETO Server Configuratorâ€. The user interface for this utility is under review by engineering. One thing that may not be obvious is that you need to hit Enter after filling out the four fields required to add the application.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c326cc438970b-pi"><img alt="image" border="0" height="299" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee410921f970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="483" /></a></p>
<p>If you donâ€™t Enter and click on â€œTest Application Servicesâ€ you will probably get this error:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee4109228970d-pi"><img alt="image" border="0" height="227" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c9b3995970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="500" /></a></p>
<p>You can get more information by following the directions in the error:&#0160;</p>
<p>â€œturn on IncludeExceptionDetailInFaults from the &lt;serviceDebug&gt; configuration behavior on the server in order to send the exception information back to the clientâ€</p>
<p>To do this, see line 125 in {install location}\Inventor ETO Server 2013\Bin\IntentSessionManager.exe.config.</p>
<p>From the config file:</p>
<p>&lt;!-- To receive exception details in faults for debugging purposes, set the value below to true. Set to false before deployment to avoid disclosing exception information â€“&gt;</p>
<p>&lt;serviceDebug includeExceptionDetailInFaults=&quot;False&quot;/&gt;</p>
<p>You will have to restart the service for the change to take effect. Either reboot the machine or restart the service from the Services control panel.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee4109240970d-pi"><img alt="image" border="0" height="333" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c326cc49b970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="453" /></a></p>
<p>After making this change, the error when clicking â€œTest Application Servicesâ€ will change to this error:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee410925c970d-pi"><img alt="image" border="0" height="197" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c9b39b0970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="406" /></a></p>
<p>This error occurs because even though you have added the four required fields for the application, the configuration doesnâ€™t actually get committed to the configuration file unless you select the row in the grid and hit the â€œEnterâ€ key. You can check this config file to see if the application was committed.</p>
<p>%ProgramData%\Autodesk\Inventor ETO Server 2013 R1\IntentServices.config</p>
<p>This was a problem I recently worked on. In the end the solution was so simple â€“ â€œjust hit enterâ€!</p>
<p>Here is the link to the help topic on the Inventor ETO Server Configurator:</p>
<p><a href="http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/1240-Inventor1240/1253-Configur1253" title="http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/1240-Inventor1240/1253-Configur1253">http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/1240-Inventor1240/1253-Configur1253</a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Amool
EMAIL: amoolyas@gmail.com
IP: 203.217.28.152
URL: 
DATE: 10/11/2012 02:17:05 AM
Hello Wayne,
 
 
I am writing another macro to turn on and off A particular sketch which is in sub-assembly in Main assembly, with name includes "F". So I used Instr.

Code is running fine without errors, but sketches are not turning on.
Please have a look to the code and feel free to suggest any changes:
 
Sub ToggleSketchVisibilityOn()
' Set a reference to the Sketches collection. This assumes
' that a part document containing a sketch is active.
Dim oAsmDoc As AssemblyDocument
Set oAsmDoc = ThisApplication.ActiveDocument
Dim oCompDef As ComponentDefinition
Set oCompDef = oAsmDoc.ComponentDefinition
Dim oOcc As ComponentOccurrences
Dim oOccDoc As Document
Dim oSketchname As String
oSketchname = "F"
Dim i As Integer
For i = 1 To oCompDef.occurrences.Count
If oAsmDoc.ComponentDefinition.occurrences(i).Definition.Type = kPartComponentDefinitionObject Then
Exit Sub
Else
If oAsmDoc.ComponentDefinition.occurrences(i).Definition.Type = kAssemblyComponentDefinitionObject Then
Set oOccDoc = oAsmDoc.ComponentDefinition.occurrences(i).Definition.Document
End If
End If
Dim oSketches As PlanarSketches
Set oSketches = ThisApplication.ActiveDocument.ComponentDefinition.Sketches
Dim oSketch As PlanarSketch

Set oSketches = oOccDoc.ComponentDefinition.Sketches

For Each oSketch In oSketches
If InStr(oSketch.name, oSketchname) Then
oSketch.Visible = True
End If
Next
Next
End Sub
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Assemblies Occurences
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-assemblies-occurences
CATEGORY: Assemblies
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/10/c-help-examples-for-assemblies-occurences.html 
DATE: 10/06/2012 02:12:00 AM
-----
BODY:
<p>Here is another section of VBA examples converted to C#. These functions are related to using occurrences in assemblies. This group was fairly easy to migrate compared to some of the other sections I did for previous posts. Also there were several C# examples already in the help file. I added them to the project for completeness.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c877425970c-pi"><img alt="image" border="0" height="379" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee3fcc303970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="365" /></a></p>
<p>This project has the following functions.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017d3c8775e1970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_assembly_occ.zip">Download InventorHelpExamples_Assembly_Occ</a></span></p>
<p>AddOccurrencesToFolder <br />Demote <br />Promote <br />ReplaceContentCenterPart <br />AssemblyCount <br />MoveOccurrence <br />AddOccurrence <br />AddiAssemblyOccurrence <br />AddiPartOccurrence <br />iMateDuringOccurrencePlacementSample <br />AddOccurrenceWithRepresentations</p>
<p>&#0160;</p>
<p>Here is the AddOccurrencesToFolder function:&quot;</p>
<p><span style="color: green;">// Add assembly occurrences to a new folder API Sample </span></p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//Demonstrates assembly occurrences to a new folder</span></p>
<p style="margin: 0px;"><span style="color: green;">//Have an assembly with at least one occurrence in it </span></p>
<p style="margin: 0px;"><span style="color: green;">//and run the sample.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> AddOccurrencesToFolder()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyDocument</span> oDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">AssemblyDocument</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDoc = (<span style="color: #2b91af;">AssemblyDocument</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">AssemblyComponentDefinition</span> oDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">AssemblyComponentDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDef = oDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">BrowserPane</span> oPane = <span style="color: blue;">default</span>(<span style="color: #2b91af;">BrowserPane</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPane = oDoc.BrowserPanes.ActivePane;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectCollection</span> oOccurrenceNodes =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ObjectCollection</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oOccurrenceNodes = (<span style="color: #2b91af;">ObjectCollection</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateObjectCollection();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;<span style="color: blue;">foreach</span> (<span style="color: #2b91af;">ComponentOccurrence</span> oOcc</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">in</span> oDef.Occurrences)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BrowserNode</span> oNode = <span style="color: blue;">default</span>(<span style="color: #2b91af;">BrowserNode</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oNode = oPane.GetBrowserNodeFromObject(oOcc);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oOccurrenceNodes.Add(oNode);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">BrowserFolder</span> oFolder = <span style="color: blue;">default</span>(<span style="color: #2b91af;">BrowserFolder</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFolder = oPane.AddBrowserFolder</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;My Occurrence Folder&quot;</span>, oOccurrenceNodes);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">}</p>
</div>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: My first attempt with Cloud and Mobile programming
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: my-first-attempt-with-cloud-and-mobile-programming
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/my-first-attempt-with-cloud-and-mobile-programming.html 
DATE: 09/28/2012 01:31:58 AM
-----
BODY:
<p>The DevTech team here at Autodesk is working on becoming experts with cloud and mobile technologies. I am happy to say that recently I was able to spend some time working towards this goal. (For many years we have been mostly supporting desktop applications).&#0160; As a training exercise I got an <a href="http://aws.amazon.com/console/" target="_blank">account on Amazon</a>&#0160; and set up a Windows 2008 server with IIS installed. (Other DevTech engineers have used Azure).</p>
<p>The idea was to get ETO Server running on this Amazon server and to access it using a WCF Service from a Windows phone application. Along the way I would publish the <a href="http://etosamples.autodesk.com/" target="_blank">ETO Web Samples</a> and make it a web site on my cloud server. (I also used the ETO Staircase application with the WCF service).</p>
<p>This screenshot shows the different parts of this experiment:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee3d2ca2f970d-pi"><img alt="clip_image002" border="0" height="378" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c5d6404970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image002" width="583" /></a></p>
<p>I am happy to say that it is all working now. Here are some of the training resources I used:</p>
<p><a href="http://www.iis.net/learn">http://www.iis.net/learn</a></p>
<p><a href="http://msdn.microsoft.com/en-us/library/ms735119(v=vs.90).aspx">http://msdn.microsoft.com/en-us/library/ms735119(v=vs.90).aspx</a></p>
<p><a href="http://channel9.msdn.com/Series/Windows-Phone-7-Development-for-Absolute-Beginners">http://channel9.msdn.com/Series/Windows-Phone-7-Development-for-Absolute-Beginners</a></p>
<p><a href="http://www.asp.net/mvc">http://www.asp.net/mvc</a></p>
<p>I got the <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=18361292" target="_blank">ETO Web sample source</a> from Autodesk com, built and published it. To get the published files to the amazon server I used Dropbox. After I moved the folder to my Dropbox folder on my local machine it appeared on the server. (of course I needed to install Dropbox on the server).</p>
<p>A couple of other things I needed to do on the server was to use IIS to enable the Web site and the Web service. Accessing the server was easy using Remote Desktop. Using IIS was straight forward as well after I completed a tutorial on it. I also needed to use the <a href="http://wikihelp.autodesk.com/Inventor_ETO/enu/2013/Help/1240-Inventor1240/1253-Configur1253" target="_blank">Intent Services Configurator</a> to make the ETO applications&#0160; on that cloud system available to ETO server.</p>
<p>I used the WCF Application wizard in Visual Studio to create my project that would be the Service that I could use from a Windows phone application. I spent some time learning the basics of WCF and then added a function that connects to the ETO server using the ETO Server API. Here is the code:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">string</span> GetNumberOfSteps</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: blue;">double</span> newFlToFlrHt, <span style="color: blue;">double</span> newTreadRise)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">IntentServicesClient</span> client = <span style="color: blue;">new</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">IntentServicesClient</span>(<span style="color: blue;">new</span>&#0160; <span style="color: #2b91af;">Uri</span></p>
<p style="margin: 0px;">(<span style="color: #a31515;">&quot;net.pipe://localhost/Autodesk/Intent/Services&quot;</span>));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; client.SetApplication(<span style="color: #a31515;">&quot;stairCase&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">string</span> prtRefChain = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//Change the distance setting between </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">//the floors</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; client.SetValue(prtRefChain,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;FloorToFloorHeight&quot;</span>, newFlToFlrHt);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// set the new value for new tread rise</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; client.SetValue</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (prtRefChain, <span style="color: #a31515;">&quot;TreadRise&quot;</span>, newTreadRise);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">string</span> sTreadCountReport =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: blue;">string</span>)client.GetValue</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (prtRefChain, <span style="color: #a31515;">&quot;TreadCountReport&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span> sTreadCountReport;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span> (<span style="color: #2b91af;">Exception</span> ex)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Debug</span>.Print(ex.ToString());</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span> ex.ToString();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">}</p>
</div>
<p>After building and publishing the WCF Application I copied the published files to the Amazon server. I was able to add a reference to my service in a Windows phone application. When I tested it in the Win phone emulator I am able to get back the number of stairs that would be created for the new floor to floor height and the new tread rise. Here is a screen shot of Inventor and ETO to help explain what the code in the WCF service is doing:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c5d6419970c-pi"><img alt="image" border="0" height="400" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c322f3331970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="440" /></a></p>
<p>Below you can see the rule that is used to get this string. This is in Inventor with ETO. The WCF service is accessing ETO server (does not have a UI) to get this string:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c322f333c970b-pi"><img alt="image" border="0" height="236" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c5d6439970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="450" /></a></p>
<p>Here it is in the Windows Phone emulator:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c322f335e970b-pi"><img alt="image" border="0" height="617" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017ee3d2ca8d970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="377" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Scott Moyse
EMAIL: scott@smigroup.co.nz
IP: 180.222.65.87
URL: 
DATE: 09/30/2012 11:18:48 PM
I'm loving the fact you have done this with Windows Phone instead of Android or iOS. Any particular reason why? Is it just because thats the phone you have?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: 
IP: 72.52.96.29
URL: http://profile.typepad.com/6p0168e6040ecb970c
DATE: 10/04/2012 10:26:15 PM
Hi Scott,
One of the reasons is that I do have a Windows phone. Also other members of my team have done some programming for the iPad and Android so I thought it would be good to do something different. 
Cheers,
Wayne  
-----
COMMENT:
AUTHOR: Web development
EMAIL: rise.technology@yahoo.in
IP: 122.175.178.208
URL: http://risetechnology.com.au/
DATE: 01/31/2013 10:30:07 AM
I personally think that platform specific coding isn't necessary unless you need very low level access for high performance applications like 3d games.
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Parts General
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-parts-general
CATEGORY: Beginning API
CATEGORY: C#
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/c-help-examples-for-parts-general.html 
DATE: 09/22/2012 06:37:58 PM
-----
BODY:
<p>Here are the VBA examples in this section of samples for parts converted to C#. This group of examples includes an example for an event (TestSelection) that allows you to get an entity from the user using events. It also has some parameter and brep examples. The WorkPointAtMassCenter c# example was already in the help file. (Saved me some time converting it).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017c320f0c11970b-pi"><img alt="image" border="0" height="338" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3c3d3c5b970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="421" /></a></p>
<p>This project has the following functions.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017d3c3d3eed970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_part_general.zip">Download InventorHelpExamples_Part_General</a></span></p>
<p>CreateParametersAndGroup <br />MoldBaseSample <br />SelectivelyLinkParams <br />QueryAndShowFeatureDimensions <br />TestSelection <br />IsCylindricalFaceInterior <br />GetPartMassProps <br />GetPartMassPropsWithoutDirtying <br />WorkPointAtMassCenter <br />CreateMaterial <br />ShowMaterials <br />ModelParameters <br />TableParameters <br />CreateRectangleFace</p>
<p>&#0160;</p>
<p>Here is the CreateParametersAndGroup function:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">// Creating a new parameter group API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of model, </span></p>
<p style="margin: 0px;"><span style="color: green;">//reference and user parameters and </span></p>
<p style="margin: 0px;"><span style="color: green;">//copying these parameters to a newly created group.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> CreateParametersAndGroup()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new Part document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> oPartDoc = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartDocument</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPartDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PartDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the compdef.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> oCompDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartComponentDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCompDef = oPartDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a model parameter</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ModelParameter</span> oModelParam =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ModelParameter</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oModelParam = oCompDef.Parameters.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ModelParameters.AddByValue</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (2, <span style="color: #2b91af;">UnitsTypeEnum</span>.kCentimeterLengthUnits);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a reference parameter</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ReferenceParameter</span> oReferenceParam =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ReferenceParameter</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oReferenceParam = oCompDef.Parameters.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ReferenceParameters.AddByValue</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (4, <span style="color: #2b91af;">UnitsTypeEnum</span>.kCentimeterLengthUnits);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a user parameter</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">UserParameter</span> oUserParam =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">UserParameter</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oUserParam = oCompDef.Parameters.UserParameters.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddByValue(<span style="color: #a31515;">&quot;length&quot;</span>, 6,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitsTypeEnum</span>.kCentimeterLengthUnits);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new custom parameter group</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">CustomParameterGroup</span> oCustomParamGroup =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">CustomParameterGroup</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCustomParamGroup = oCompDef.Parameters.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CustomParameterGroups.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #a31515;">&quot;Custom Group&quot;</span>, <span style="color: #a31515;">&quot;CustomGroup1&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Add the created parameters to this group</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Note that adding the parameters to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//custom group does not remove it from the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// original group.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCustomParamGroup.Add((<span style="color: #2b91af;">Parameter</span>)oModelParam);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCustomParamGroup.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ((<span style="color: #2b91af;">Parameter</span>)oReferenceParam);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCustomParamGroup.Add((<span style="color: #2b91af;">Parameter</span>)oUserParam);</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: iViews - Inventor Custom application of the month
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: iviews-inventor-custom-application-of-the-month
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/iviews-inventor-custom-application-of-the-month.html 
DATE: 09/19/2012 06:53:57 PM
-----
BODY:
<p><br />One of the Inventor custom applications on the <a href="http://apps.exchange.autodesk.com/INVNTOR/Home/Index" target="_blank">Autodesk Exchange store</a> was featured as the product of the month for September on the <a href="http://www.facebook.com/adskinventor" target="_blank">Autodesk Inventor facebook page</a>. The video demonstrating the application will quickly show you the enhancements the AddIn provides for drawing views.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017744d9cfe2970d-pi"><img alt="image" border="0" height="423" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017744d9cff0970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="449" /></a></p>
<p>This type of promotion is a great thing for custom application developerâ€™s and the exchange store is one of the best ways to let potential customers know about your company and your applications. For more information on how to get your application on the exchange store see this <a href="http://adndevblog.typepad.com/manufacturing/2012/07/publishing-on-the-autodesk-exchange-store.html" target="_blank">post</a> on the Manufacturing DevBlog.</p>
<p>I installed this application and found it very easy to use and I can see how this could save a lot of time by allow you to easily change the size and scale of drawing views.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jhon Hermosa
EMAIL: larry.hermosa@enka.com.co
IP: 190.248.13.106
URL: http://www.youtube.com/user/jhonlarry?feature=watch
DATE: 09/20/2012 05:15:04 PM
Its like a macro that is post in <a href="http://www.youtube.com/watch?v=qafEUbXBCUI&list=UUs9IE2l3HNZRkcHztjhsoDw&index=16&feature=plcp.">http://www.youtube.com/watch?v=qafEUbXBCUI&list=UUs9IE2l3HNZRkcHztjhsoDw&index=16&feature=plcp.</a>
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: ETO &ndash; Use Inventor API to create a rendered image from a design
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: eto-use-inventor-api-to-create-a-rendered-image-from-a-design
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/eto-use-inventor-api-to-create-a-rendered-image-from-a-design.html 
DATE: 09/14/2012 08:42:32 PM
-----
BODY:
<p>Here is another suggestion for Inventor Engineer-To-Order. In some cases using Inventor Studio from Intent (IvStudioRenderedImage) to create an image is not working correctly. A solution is to use the Inventor API. Here is a method that shows how this can be done using SaveAsBitmap() of the active view.</p>
<p>Method createReportImage(outputFile As String) As String <br />&#0160; Dim view = %%inventorApplication.ActiveView <br />&#0160; <br />&#0160; Dim hasGnomon As Boolean = _ <br />&#0160; %%inventorApplication.DisplayOptions.Show3DIndicator <br />&#0160; Dim displayMode = view.DisplayMode <br />&#0160; Dim hasGroundShadow As Boolean = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; view.ShowGroundShadows <br />&#0160; Dim hasAmbientShadow As Boolean = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; view.ShowAmbientShadows <br />&#0160; Dim hasObjectShadows As Boolean = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; view.ShowObjectShadows <br />&#0160; Dim hasShowGroundReflections As Boolean = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; view.ShowGroundReflections <br />&#39;&#0160; <br />&#0160; %%inventorApplication.DisplayOptions. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Show3DIndicator = False <br />&#0160; view.ShowGroundReflections = True <br />&#0160; view.ShowGroundShadows = True <br />&#0160; view.ShowAmbientShadows = True <br />&#0160; view.ShowObjectShadows = True <br />&#0160; view.DisplayMode = _ <br />&#0160; Inventor.DisplayModeEnum.kRealisticRendering <br />&#0160; view.RayTracingQuality= _ <br />&#0160;&#0160; Inventor.RayTracingQualityEnum. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kInteractiveRayTracingQuality&#0160; <br />&#0160; <br />&#0160; Try <br />&#0160;&#0160; view.SaveAsBitmap(outputFile, 1200, 800) <br />&#0160; Finally <br />&#0160;&#0160; %%inventorApplication.DisplayOptions. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Show3DIndicator = hasGnomon <br />&#0160;&#0160; view.DisplayMode = displayMode <br />&#0160;&#0160; view.ShowGroundShadows = hasGroundShadow <br />&#0160;&#0160; view.ShowAmbientShadows = hasAmbientShadow <br />&#0160;&#0160; view.ShowObjectShadows = hasObjectShadows <br />&#0160;&#0160; view.ShowGroundReflections = hasShowGroundReflections <br />&#0160; End Try <br />&#0160; <br />&#0160; Return outputFile <br />End Method</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: ETO - Override GetNewPartNumber() to update iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: eto-override-getnewpartnumber-to-update-iproperties
CATEGORY: Engineer-To-Order
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/eto-override-getnewpartnumber-to-update-iproperties.html 
DATE: 09/13/2012 10:39:59 PM
-----
BODY:
<p>One of the products I am supporting currently is â€œEngineer-To-Orderâ€ (ETO). When I see a good tip or solution that applies to ETO for Inventor I am going to post it here. Here is the first post for this product and it shows a way to create a custom iProperty when the member file is saved.</p>
<p>When a member document is about to be saved the GetNewPartNumber() method is called. You can override this method and get and set data. (This is exactly the right time to do this). Geometry-wise the document is in a good shape, because it contains the required values of Inventor Parameters, sheet metal defaults, etc.&#0160;&#0160;&#0160; <br />&#0160; <br />The example below was used for a sheet metal part. The highlighted lines do the following:</p>
<p><br />1.&#0160;&#0160;&#0160; Extract the â€œlengthsâ€ of the Flat Pattern as an Intent List <br />2.&#0160;&#0160;&#0160; Formats a string from the List <br />3.&#0160;&#0160;&#0160; Creates the custom iProperty FlatPatternSize in the member IPT document</p>
<p>&#0160;</p>
<p>&lt; %%category(&quot;Inventor&quot;) &gt; _ <br />Method GetNewPartNumber( docHandle As String) As String <br />&#0160; <br /><span style="background-color: #cccccc;">&#0160;&#0160;&#0160;&#0160; Dim fpLengths As List =&#0160; _ <br />&#0160;&#0160;&#0160;&#0160;&#0160; IvExtGetFlatPatternLenghts _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ( Parent,False,&quot;in&quot;, docHandle:=docHandle)&#0160; <br />&#0160;&#0160;&#0160;&#0160; Dim strList As String = &quot;FP Lengths: &quot; _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + StringValueEx( fpLengths, :AsFormula)&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; iv_documentPropertyPut _ <br />&#0160;&#0160;&#0160;&#0160; ( docHandle, &quot;FlatPatternSize&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strList, createNew?:=True)&#0160; <br /></span>&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; the rest is original implementation from <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; %%IvAdoptedPart Design <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim iPropertiesPN As String = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iv_ExtractPartNumber( iProperties) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If( length(iPropertiesPN) &gt; 0) Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Return iPropertiesPN <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; If UseFactoryPartNumber? Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Return &quot;&quot; <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Return iv_pathFileNameOnly( %%cacheFilePath) <br />End Method</p>
<p>- Wayne&#0160;&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Features &ndash; Part 2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-features-part-2
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/09/c-help-examples-for-features-part-2.html 
DATE: 09/09/2012 04:34:33 PM
-----
BODY:
<p>Here is the second group of VBA examples in this section of samples for features converted to C#. The project with the first set of converted samples for features is <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-features-part-1.html" target="_blank">here</a>.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177449ddfb1970d-pi"><img alt="image" border="0" height="309" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017d3bee78c6970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="366" /></a></p>
<p>This project has the following functions.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc68834017d3bee7aca970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_features_2.zip">Download InventorHelpExamples_Features_2</a></span></p>
<p>HoleFeatureLinearPlacement <br />StitchFeatureCreate <br />CreateNonPlanarSectionLoft <br />EditExtrudeFeature <br />SweepFeature <br />TrueSweepLength <br />ThreadSample <br />EditThread <br />test_threadinfo</p>
<p>Here is HoleFeatureLinearPlacement function:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160;&#0160;&#0160; Hole feature linear placement API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of a </span></p>
<p style="margin: 0px;"><span style="color: green;">//hole feature using the linear placement type.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> HoleFeatureLinearPlacement()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new part document, using the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//default part template.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> oPartDoc = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartDocument</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPartDoc = (<span style="color: #2b91af;">PartDocument</span>)ThisApplication.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the component definition.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> oCompDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartComponentDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCompDef = oPartDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new sketch on the X-Y work plane.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> oSketch = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PlanarSketch</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch = oCompDef.Sketches.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oCompDef.WorkPlanes[3]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//transient geometry object.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientGeometry</span> oTransGeom =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">TransientGeometry</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTransGeom = ThisApplication.TransientGeometry;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a square on the sketch.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.SketchLines.AddAsTwoPointRectangle</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oTransGeom.CreatePoint2d(0, 0),</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTransGeom.CreatePoint2d(6, 6));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the profile.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Profile</span> oProfile = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Profile</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oProfile = oSketch.Profiles.AddForSolid();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an extrusion.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeDefinition</span> oExtrudeDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ExtrudeDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrudeDef = oCompDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ExtrudeFeatures.CreateExtrudeDefinition</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oProfile,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartFeatureOperationEnum</span>.kJoinOperation);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrudeDef.SetDistanceExtent(<span style="color: #a31515;">&quot;2 cm&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartFeatureExtentDirectionEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kNegativeExtentDirection);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeFeature</span> oExtrude =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ExtrudeFeature</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrude = oCompDef.Features.ExtrudeFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(oExtrudeDef);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the start face of the extrude.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Face</span> oFace = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Face</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oFace = oExtrude.StartFaces[1];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get two adjacent edges on the start face.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> oEdge1 = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Edge</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Edge</span> oEdge2 = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Edge</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oEdge1 = oFace.Edges[1];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oEdge2 = oFace.Edges[2];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a bias point for hole placement to </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//place it at the expected location. This is </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//the model point corresponding to the center</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//of the square in the sketch.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Inventor.<span style="color: #2b91af;">Point</span> oBiasPoint =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(Inventor.<span style="color: #2b91af;">Point</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oBiasPoint = oSketch.SketchToModelSpace</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oTransGeom.CreatePoint2d(1.5, 1.5));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the hole feature placement definition.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">LinearHolePlacementDefinition</span> oLinearPlacementDef</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = <span style="color: blue;">default</span>(<span style="color: #2b91af;">LinearHolePlacementDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oLinearPlacementDef = oCompDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; HoleFeatures.CreateLinearPlacementDefinition</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oFace, oEdge1, <span style="color: #a31515;">&quot;2 cm&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdge2, <span style="color: #a31515;">&quot;2 cm&quot;</span>, oBiasPoint);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the hole feature.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCompDef.Features.HoleFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddDrilledByThroughAllExtent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oLinearPlacementDef, <span style="color: #a31515;">&quot;1 cm&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartFeatureExtentDirectionEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kPositiveExtentDirection);</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 09/11/2012 12:45:21 PM
Wayne,can you attach the parameters generated by default in the inventor application (d1,d2...) in C# code?


Thanks,David
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for Features &ndash; Part 1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-features-part-1
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-features-part-1.html 
DATE: 08/31/2012 05:23:24 PM
-----
BODY:
<p>Here is the first group of VBA examples in this section of samples for Features converted to C#.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774470b274970d-pi"><img alt="image" border="0" height="270" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774470b27e970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="388" /></a></p>
<p>This project has the following functions.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc688340176178a19ee970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_features_1.zip">Download InventorHelpExamples_Features_1</a></span></p>
<p>BoundaryPatchFeature <br />DecalFeature <br />DrawBlockWithPocket <br />EditFeatureProfile <br />ExtrudeSketchText <br />CreateAllRoundsFillet <br />CreateFilletComplex <br />CreateSimpleFillet <br />HighlightFeatureFaces <br />ClearHighlight</p>
<p>Here is CreateSimpleFillet</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160;&#0160;&#0160; Fillet Feature (Simple) API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates using the AddSimple method </span></p>
<p style="margin: 0px;"><span style="color: green;">//of the FilletFeatures collection</span></p>
<p style="margin: 0px;"><span style="color: green;">// to create a constant radius fillet.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> CreateSimpleFillet()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new Part document.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartDocument</span> oPartDoc = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartDocument</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oPartDoc =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">PartDocument</span>)ThisApplication.Documents.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160; ThisApplication.FileManager.GetTemplateFile</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">DocumentTypeEnum</span>.kPartDocumentObject));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the compdef.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PartComponentDefinition</span> oCompDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">PartComponentDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCompDef = oPartDoc.ComponentDefinition;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a sketch on the xy work plane.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> oSketch = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PlanarSketch</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch = oCompDef.Sketches.Add</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oCompDef.WorkPlanes[3]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Draw a rectangle.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.SketchLines.AddAsTwoPointRectangle</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; (ThisApplication.TransientGeometry.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreatePoint2d(-6, -4),</p>
<p style="margin: 0px;">&#0160;&#0160; ThisApplication.TransientGeometry.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreatePoint2d(6, 4));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Profile</span> oProfile = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Profile</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oProfile = oSketch.Profiles.AddForSolid();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an extrusion.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeDefinition</span> oExtrudeDef =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ExtrudeDefinition</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrudeDef = oCompDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ExtrudeFeatures.CreateExtrudeDefinition</p>
<p style="margin: 0px;">(oProfile, <span style="color: #2b91af;">PartFeatureOperationEnum</span>.kJoinOperation);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrudeDef.SetDistanceExtent</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (5, <span style="color: #2b91af;">PartFeatureExtentDirectionEnum</span>.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kSymmetricExtentDirection);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ExtrudeFeature</span> oExtrude =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ExtrudeFeature</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oExtrude = oCompDef.Features.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ExtrudeFeatures.Add(oExtrudeDef);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Define the set of edges that are for the start </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">//and end faces of the solid.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">EdgeCollection</span> oEdges =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">EdgeCollection</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oEdges = ThisApplication.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateEdgeCollection();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">Edge</span> oEdge <span style="color: blue;">in</span> oExtrude.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; StartFaces[1].Edges)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdges.Add(oEdge);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">Edge</span> oEdge <span style="color: blue;">in</span> oExtrude.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; EndFaces[1].Edges)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEdges.Add(oEdge);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create the fillet feature.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">FilletFeature</span> oFillet = <span style="color: blue;">default</span>(<span style="color: #2b91af;">FilletFeature</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oFillet = oCompDef.Features.FilletFeatures.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddSimple(oEdges, 1);</p>
<p style="margin: 0px;">}</p>
</div>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Diegoandrade
EMAIL: 
IP: 151.201.134.155
URL: http://profile.typepad.com/diegoandrade
DATE: 10/03/2012 01:22:24 AM
Thank you for the post you just help me out a lot with it. I hope I understood it properly I will sent a link to my project. Thanks again

D
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Announcing &ldquo;ADN Open&rdquo;
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: announcing-adn-open
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/announcing-adn-open.html 
DATE: 08/30/2012 10:41:19 PM
-----
BODY:
<p>There is a new place for anyone who needs to find information about customizing Autodesk products. This new level of free support is called <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=19118898" rel="noopener noreferrer" target="_blank">ADN Open</a> and will be a great resource for people who can get by without the benefits of a full ADN membership.</p>
<p>You may have already experienced part of ADN Open by visiting one of the DevBlogs, such as this <a href="http://adndevblog.typepad.com/manufacturing/" rel="noopener noreferrer" target="_blank">DevBlog</a> that focuses on customizing manufacturing products. Part of the work my team has been doing lately is migrating DevNotes to the DevBlogs. These DevNotes make up a knowledge base of API examples that used to only be available to ADN members. Also all new technical articles that we create will be posted on the DevBlog.</p>
<p>The <a href="http://adndevblog.typepad.com/manufacturing/2012/08/introducing-adn-open.html" rel="noopener noreferrer" target="_blank">post</a> by Stephen Preston has more details about ADN Open.&#0160;</p>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for sketch &ndash; Part 2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-sketch-part-2
CATEGORY: Beginning API
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-2.html 
DATE: 08/25/2012 12:03:49 AM
-----
BODY:
<p>Here is the second installment of VBA examples converted to C#. This project has the following functions. (converted from VBA&#0160;&#0160; procedures in the help file). This <a href="http://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html" target="_blank">blog post</a> has the other examples in the help section on 2D Sketches.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a00e553fcbfc688340176176bd45a970c"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_sketch_2.zip">Download InventorHelpExamples_Sketch_2</a></span></p>
<p>Offset <br />DrawSketchLine <br />ToggleSketchVisibility <br />CreateSketchBlockDefinition <br />InsertSketchBlockDefinition <br />CreateSketchBlock <br />CreateSketchedSymbolDefinition <br />InsertSketchedSymbolOnSheet <br />AddSymbolWithLeader <br />DrawSketchEllipticalArc <br />SketchEntities <br />SplineByDefinition <br />DrawSketchSpline <br />CopyBodyFromPartToPart</p>
<p>Here is the Offset example:</p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: green;">//&#0160; Offset a 2D sketch API Sample </span></p>
<p style="margin: 0px;"><span style="color: green;">//Description </span></p>
<p style="margin: 0px;"><span style="color: green;">//This sample demonstrates the creation of offsets</span></p>
<p style="margin: 0px;"><span style="color: green;">//in 2d sketches. Two ways of creating the offset </span></p>
<p style="margin: 0px;"><span style="color: green;">//are shown - one uses a distance and the other </span></p>
<p style="margin: 0px;"><span style="color: green;">//uses the input point.</span></p>
<p style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">void</span> Offset()</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Check to make sure a sketch is open.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Set a reference to the active sketch.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">PlanarSketch</span> oSketch = <span style="color: blue;">default</span>(<span style="color: #2b91af;">PlanarSketch</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Object</span> actObj =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveEditObject;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSketch = (<span style="color: #2b91af;">PlanarSketch</span>)actObj;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show(<span style="color: #a31515;">&quot;A sketch must be active.&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Reference the transient geometry collection.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TransientGeometry</span> oTransGeom =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">TransientGeometry</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oTransGeom = ThisApplication.TransientGeometry;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a rectangle</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchEntitiesEnumerator</span> oRectangleLines =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">SketchEntitiesEnumerator</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oRectangleLines = oSketch.SketchLines.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddAsTwoPointRectangle(oTransGeom.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreatePoint2d(0, 0),</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTransGeom.CreatePoint2d(10, -10));</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a new object collection</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectCollection</span> oCollection =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">default</span>(<span style="color: #2b91af;">ObjectCollection</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCollection = ThisApplication.TransientObjects.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateObjectCollection();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Add the first sketch line of the rectangle </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// to the collection</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oCollection.Add(oRectangleLines[1]);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create a point at (0,3). The entity resulting</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// from the offset of the first sketch line must</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// pass thru this point.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point2d</span> oOffsetPoint = <span style="color: blue;">default</span>(<span style="color: #2b91af;">Point2d</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oOffsetPoint = oTransGeom.CreatePoint2d(0, 3);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an offset rectangle using the </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// offset point.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.OffsetSketchEntitiesUsingPoint</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oCollection, oOffsetPoint, <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the sketch normal</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitVector</span> oNormalVector = <span style="color: blue;">default</span>(<span style="color: #2b91af;">UnitVector</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oNormalVector = oSketch.PlanarEntityGeometry.Normal;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the direction of sketch line being offset</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SketchEntity</span> oSkEnt = oRectangleLines[1];</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the geometry associated with the sketch </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// entity. Since the Geometry property will </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// return one of various types of objects,</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// we need to use late binding here</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// which C# doesn&#39;t </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// handle very nicely. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">object</span> geom = oSkEnt.GetType().</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InvokeMember(<span style="color: #a31515;">&quot;Geometry&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BindingFlags</span>.GetProperty,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">null</span>, oSkEnt, <span style="color: blue;">null</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitVector2d</span> oLineDir =</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: #2b91af;">UnitVector2d</span>)geom.GetType().</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InvokeMember(<span style="color: #a31515;">&quot;Direction&quot;</span>,</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BindingFlags</span>.GetProperty, <span style="color: blue;">null</span>, geom, <span style="color: blue;">null</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitVector</span> oLineVector = <span style="color: blue;">default</span>(<span style="color: #2b91af;">UnitVector</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oLineVector = oTransGeom.CreateUnitVector</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oLineDir.X, oLineDir.Y, 0);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// The cross product of these vectors is the</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// natural offset direction for the sketch line.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitVector</span> oOffsetVector = <span style="color: blue;">default</span>(<span style="color: #2b91af;">UnitVector</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oOffsetVector = oLineVector.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CrossProduct(oNormalVector);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Get the desired offset vector (the +ve y-axis)</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">UnitVector</span> oDesiredVector = <span style="color: blue;">default</span>(<span style="color: #2b91af;">UnitVector</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oDesiredVector = oTransGeom.</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateUnitVector(0, 1, 0);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">bool</span> bNaturalOffsetDir = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (oOffsetVector.IsEqualTo(oDesiredVector))</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bNaturalOffsetDir = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bNaturalOffsetDir = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// Create an offset at a distance of 6 cms.</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; oSketch.OffsetSketchEntitiesUsingDistance</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oCollection, 6, bNaturalOffsetDir, <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">}</p>
</div>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 08/31/2012 01:18:49 PM
Wayne, will you be showing how to attach parmeter values in C# code?

Thanks, David
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.29
URL: 
DATE: 08/31/2012 04:46:43 PM
Hi David,

I am just converting the VBA examples in the help file.  Here is one of the VBA examples translated to C# that creates parameters. I am not sure if this is what you are looking for though.

        //    Creating a new parameter group API Sample 
        //Description 
        //This sample demonstrates the creation of model, 
        //reference and user parameters and 
        //copying these parameters to a newly created group.
        public void CreateParametersAndGroup()
        {
            // Create a new Part document.
            PartDocument oPartDoc = default(PartDocument);
            oPartDoc = (PartDocument)ThisApplication.Documents.Add
                (DocumentTypeEnum.kPartDocumentObject, 
                ThisApplication.FileManager.GetTemplateFile
                (DocumentTypeEnum.kPartDocumentObject));

            // Set a reference to the compdef.
            PartComponentDefinition oCompDef = default
                                        (PartComponentDefinition);
            oCompDef = oPartDoc.ComponentDefinition;

            // Create a model parameter
            ModelParameter oModelParam = default(ModelParameter);
            oModelParam = oCompDef.Parameters.
                  ModelParameters.AddByValue
                       (2, UnitsTypeEnum.kCentimeterLengthUnits);

            // Create a reference parameter
            ReferenceParameter oReferenceParam = 
                                   default(ReferenceParameter);
            oReferenceParam = oCompDef.Parameters.
                ReferenceParameters.AddByValue
                (4, UnitsTypeEnum.kCentimeterLengthUnits);

            // Create a user parameter
            UserParameter oUserParam = default(UserParameter);
            oUserParam = oCompDef.Parameters.UserParameters.
               AddByValue("length", 6, UnitsTypeEnum.kCentimeterLengthUnits);

            // Create a new custom parameter group
            CustomParameterGroup oCustomParamGroup = 
                          default(CustomParameterGroup);
            oCustomParamGroup = oCompDef.Parameters.
                CustomParameterGroups.Add("Custom Group", "CustomGroup1");

            // Add the created parameters to this group
            // Note that adding the parameters to the custom group
            // does not remove it from the original group.
            oCustomParamGroup.Add((Parameter)oModelParam);
            oCustomParamGroup.Add((Parameter)oReferenceParam);
            oCustomParamGroup.Add((Parameter)oUserParam);
        }

Cheers,
Wayne

-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 09/04/2012 09:52:08 PM
Thanks Wayne, going to give this a try.
-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 09/13/2012 06:22:54 PM
Wayne, sorry to bug you again. Can you attach the default parameters assigned by Inventor in C# code? They are named d1,d2,d3 and so on
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.29
URL: 
DATE: 09/14/2012 12:07:39 AM
Hi David,

Please explain more about what you need to do. I am not fully understanding "attach the default parameters". Is the problem related to C# ? (or just a general Inventor API issue)

Thanks,
Wayne
-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 09/14/2012 12:26:49 PM
Wayne, what I am working with is building a C# program that I can enter values for an inventor model. When you sketch and build the model the parameters are listed as d1,d2 and so on. You can name them as you want after that. I have used your code to create a user parmeter but what I would like is to be able to modify the values through input. For example: paramLength = value of length.txt (textbox).I need my program to "see" the vales I input. I have been able to do this in VBA but it is so antiquated and we are working with more advanced feature reconition software here.Thanks again for your time and help.

David L.
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.29
URL: 
DATE: 09/18/2012 10:05:26 PM
Hi David,

Could you post the VBA code that is working for you? In C# are you getting an error when you try to assign a value to the model parameter? If so let me know what it is and I will try to find a solution for it. The API should allow you to change the value of a model parameter.

Thanks,
Wayne
-----
COMMENT:
AUTHOR: David
EMAIL: lifeson_d@yahoo.com
IP: 70.88.3.209
URL: 
DATE: 09/19/2012 12:39:07 PM
Wayne, this is an example of one of the parameters in the program:

Dim oParameters As Parameters
Set oParameters = ThisApplication.ActiveDocument.ComponentDefinition.Parameters
''' Declare parameters
Dim tlocParam As Parameter

''' Set parameters to values
Set tlocParam = oParameters.Item("tloc")

'''' Attach parameter values to text box values
tlocParam.Expression = txt_tloc.Text

'' Update Data
ThisApplication.ActiveDocument.Update

â€œtlocâ€ is the name I have given the parameter in the display grid in the inventor application

Thanks again for your help, David
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: C# Help Examples for sketch &ndash; Part 1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: c-help-examples-for-sketch-part-1
CATEGORY: Beginning API
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/c-help-examples-for-sketch-part-1.html 
DATE: 08/22/2012 09:27:53 PM
-----
BODY:
<p>One of the takeaways from the <a href="http://modthemachine.typepad.com/my_weblog/2012/07/inventor-api-wishlist-2012-survey-results.html" target="_blank">Inventor API survey results</a> this year was the request for help file examples in other languages besides VBA. To help address this, I am planning on converting the samples to C# over the next several months. Here is the first installment.</p>
<p><span class="asset  asset-generic at-xid-6a00e553fcbfc6883401774448b158970d"><a href="http://modthemachine.typepad.com/files/inventorhelpexamples_sketch_1.zip">Download InventorHelpExamples_Sketch_1</a></span>&#0160;</p>
<p>In this project you will find these VBA Procedures converted to C# functions:</p>
<p>CopySketch <br />SilhouetteSample <br />ChangeSketchPlane <br />MakeSketchShared <br />AddSketch <br />AddOrientedSketch <br />GetProfileRegionProperties <br />SketchProfileControl <br />CopySketchContents <br />DeferSketchUpdate <br />DeleteSketch <br />StartSketchEdit&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />MoveSketchObjects</p>
<p>This is 13 out of the 26 examples in this group of examples on Sketches. (The next post on this topic will be the others in this section).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774448ad84970d-pi"><img alt="image" border="0" height="326" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774448ad9a970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="513" /></a></p>
<p>When you run this stand alone Windows Forms project you will see a combo box with a list of the examples. Click on one you want to run.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017617623a67970c-pi"><img alt="image" border="0" height="454" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017617623a74970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="513" /></a>&#0160;</p>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Discussion on Client Graphics &ndash; Segment 4
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: discussion-on-client-graphics-segment-4
CATEGORY: Assemblies
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics-segment-4.html 
DATE: 08/17/2012 09:37:52 PM
-----
BODY:
<p>Here is the last of four articles on Client Graphics. This was originally in a technical paper written by Autodesk Developer Network engineer Xiaodong Liang.</p>
<p>Note: Segment 3 is <a href="http://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics-segment-3.html" target="_blank">here</a>.</p>
<p><strong>This zip file has a VB.NET project with the examples discussed in this section.</strong></p>
<p><strong><span class="asset  asset-generic at-xid-6a00e553fcbfc6883401676956114b970b"><a href="http://modthemachine.typepad.com/files/clientgraphics_segment_4.zip">Download ClientGraphics_Segment_4</a></span></strong></p>
<p><strong>Start of segment 4</strong></p>
<p><strong>Interaction Client Graphics <br /></strong>Interaction Client Graphics operate in a similar manner to regular ClientGraphics, except that it all happens in the context of InteractionEvents. ClientGraphics created via InteractionGraphics are optimized for this environment, and run much faster. They are well suited to real-time feedback during a command. As the client graphics are displayed in the context of an InteractionEvents object, they can take advantage of mouse movement information, selection information, in fact, any events supported by the InteractionEvents objects. These graphics are automatically removed once the associated InteractionEvents object stops.</p>
<p>The interaction graphics can be Preview or Overlay. Preview graphics are equivalent to regular Client Graphics. The only difference between Overlay and Preview graphics is that Overlay graphics can be drawn independently, in a single view (window), and then merged with the last full redraw of the scene by drawing the graphics in a special &quot;overlay&quot; plane. It doesn&#39;t mean that the graphics are always drawn on top. You can position them anywhere you want and you can toggle the &quot;burn through&quot; option. In short, anything you can do with preview graphics you can do with overlay graphics.</p>
<p>The creation of interaction graphics is not transacted. This is done for performance reasons, and to avoid some side effects, like clearing of the selection set. This also means that transacting operations cannot be mixed with preview graphics.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769560f80970b-pi"><img alt="image" border="0" height="273" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340176174a5ec0970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="479" /></a></p>
<p>&#0160;</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: interaction events (Overlay)&gt; <br /></span>â€˜start interaction event and get the overlay graphics <br />Dim oIE As InteractionEvents <br />Set oIE = ThisApplication.CommandManager.CreateInteractionEvents <br />oIE.Start <br /><br />Dim oClientGraphics As ClientGraphics <br />Set oClientGraphics = oIG.OverlayClientGraphics <br /><br /><span style="color: #0000ff;">â€˜create line strip graphics <br /></span>Dim oLineStrip As LineStripGraphics <br />Set oLineStrip = oLineStripNode.AddLineStripGraphics <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#39; Assign the same coordinate set to the line strip. <br /></span>oLineStrip.CoordinateSet = oCoordSet <br /><br /><span style="color: #0000ff;">&#39; Update the view to see the resulting spiral. <br /></span>oIG.UpdateOverlayGraphics ThisApplication.ActiveView</p>
<p><strong>&#0160;</strong></p>
<p><strong>Store Client Graphics <br /></strong>In general, ClientGraphics will be maintained and transformed by Inventor for the duration of the session only. Using the GraphicsDataSetsCollection.Add method will allow the data to be saved with the file. When the document is opened, the ClientGraphics are persisted, and are still available to be further manipulated.</p>
<p>In Part or Assembly documents, you can attach client graphics to ClientFeature objects, so the graphics will be stored with document. The presumption is the graphics data is created by GraphicsDataSetsCollection.Add. In Drawing documents only the data can be saved. A developerâ€™s application has to redraw the graphics using the client graphics data after the Drawing document has been re-opened. <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340176174a5ec8970c-pi"><img alt="image" border="0" height="272" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340176174a5ed1970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="464" /></a></p>
<p>&#0160;</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: store client graphics with client feature&gt; <br /></span>Dim invCF As ClientFeature <br /><span style="color: #0000ff;">â€˜get/create ClientFeature <br /></span>Dim invCFD As ClientFeatureDefinition <br />invCFD = invCF.Definition <br /><br /><span style="color: #0000ff;">â€˜Create &amp; store graphics data <br /></span>Dim oGraphicsData As GraphicsDataSets <br />Set oGraphicsData = oDoc.GraphicsDataSetsCollection.Add2(&quot;TestCG_StoreData&quot;, True) <br /><br />&#0160;<span style="color: #0000ff;">â€˜create graphics in the ClientFeature <br /></span>Dim oClientGraphics As Inventor.ClientGraphics <br />Set oClientGraphics = invCFD.ClientGraphicsCollection(&quot;ClientFeatureTest&quot;) <br /><br /><br /><span style="color: #0000ff;">â€˜create graphics node <br /></span>Dim oGraphicsNode As GraphicsNode <br />Set oGraphicsNode = oClientGraphics.AddNode(oClientGraphics.count + 1) <br /><br />Dim oPointCoords(11) As Double &#39;create 4 points <br />&#0160; oPointCoords(0) = 0: oPointCoords(1) = 0: oPointCoords(2) = 0 <br />&#0160; oPointCoords(3) = 1: oPointCoords(4) = 1: oPointCoords(5) = 0 <br />&#0160; oPointCoords(6) = 2: oPointCoords(7) = 0: oPointCoords(8) = 0 <br />&#0160; oPointCoords(9) = 3: oPointCoords(10) = 1: oPointCoords(11) = 0 <br />&#0160; Call oCoordSet.PutCoordinates(oPointCoords) <br /><br />&#0160;&#0160; &#39;Lines: totally, 2 lines <br />&#0160; Dim oGraphic As LineGraphics <br />&#0160; Set oGraphic = oGraphicsNode.AddLineGraphics&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160; oGraphic.CoordinateSet = oCoordSet</p>
<p>&#0160;</p>
<p><strong>Advanced Functionality <br /><em>Slice <br /></em></strong>This provides the functionality that slices the graphics based on the input planes and optionally caps the sliced end. <br /><strong><em>Texture mapping <br /></em></strong>Texture mapping provides the ability to more accurately define color mapping to the model.&#0160; For example, with the previous functionality you were limited to assigning colors to vertices and then relying on Inventor to interpolate the color across the triangle.&#0160; If you had a plane constructed of two triangles you would not be able to define any intermediate colors between the vertices.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340176174a5edd970c-pi"><img alt="image" border="0" height="283" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774430f3ab970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="493" /></a></p>
<p>This is the end of this series. These posts will also be of interest:</p>
<p><a href="http://au.autodesk.com/?nd=class&amp;session_id=9027" target="_blank">AU Session - Client Graphics API Exposed</a></p>
<p>MFG DevBlog post - <a href="http://adndevblog.typepad.com/manufacturing/2012/07/complete-clientfeature-example-in-c.html" target="_blank">Complete ClientFeature example in C#</a></p>
<p>The <a href="http://adndevblog.typepad.com/manufacturing/" target="_blank">Manufacturing DevBlog</a> has other posts on Client Graphics as well. Also donâ€™t forget the help file. It has examples for ClientGraphics too.</p>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Discussion on Client Graphics &ndash; Segment 3
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: discussion-on-client-graphics-segment-3
CATEGORY: Assemblies
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics-segment-3.html 
DATE: 08/14/2012 09:34:12 PM
-----
BODY:
<p>Here is the third of four articles on Client Graphics. This was originally in a technical paper written by Autodesk Developer Network engineer Xiaodong Liang.</p>
<p>Note: Segment 2 is <a href="http://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics-segment-2.html" target="_blank">here</a>.</p>
<p>This zip file has a VB.NET project with the examples discussed in this section.</p>
<p><strong><span class="asset  asset-generic at-xid-6a00e553fcbfc68834016769555aff970b"><a href="http://modthemachine.typepad.com/files/clientgraphics_segment_3.zip">Download ClientGraphics_Segment_3</a></span></strong></p>
<p><strong>Start of segment 3 </strong></p>
<p><strong>Using Index Sets <br /></strong>The Index Set provides a flexible way to arrange the coordinate set, color set and normal set (for triangles). For example, with the same coordinate data, the figure below, on the left, creates the line graphics from 1-2-3-4 where all lines have the same color, while the figure on the right creates the line from 1-3-2-4 and each line has a different color defined using an index set. <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401774421914b970d-pi"><img alt="image" border="0" height="209" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676946852f970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="481" /></a></p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Line, With Coordinate Index Set and Color Set&gt; <br /></span>&#0160;&#0160;&#0160;&#0160; Dim oPointCoords(11) As Double &#39;create 4 points <br />&#0160;&#0160;&#0160; oPointCoords(0) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(1) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(2) = 0 <br />&#0160;&#0160;&#0160; oPointCoords(3) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(4) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(5) = 0 <br />&#0160;&#0160;&#0160; oPointCoords(6) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(7) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(8) = 0 <br />&#0160;&#0160;&#0160; oPointCoords(9) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(10) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(11) = 0 <br />&#0160;&#0160;&#0160; Call oCoordSet.PutCoordinates(oPointCoords) <br />&#0160; <br />&#0160; <span style="color: #0000ff;">&#0160; &#39;Line strip: totally, 3 lines <br /></span>&#0160;&#0160;&#0160; Dim oGraphic As LineGraphics <br />&#0160;&#0160;&#0160; Set oGraphic = oGraphicsNode.AddLineGraphics&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; oGraphic.LineWeight = 5 <br /><br />&#0160; <span style="color: #0000ff;">&#0160; â€˜Create Coordinate Index Set <br /></span>&#0160;&#0160;&#0160; Dim oCoordinateIndex As GraphicsIndexSet <br />&#0160;&#0160;&#0160; Set oCoordinateIndex = oDataSets.CreateIndexSet(oDataSets.count + 1) <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 1, 1&#0160; &#39;from point 1 <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 2, 3&#0160; &#39;connect to point 3 <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 3, 3&#0160; &#39;from point 3 <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 4, 2&#0160; &#39;connect to point 2 <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 5, 2&#0160; &#39;from point 2 <br />&#0160;&#0160;&#0160; oCoordinateIndex.Add 6, 4&#0160; &#39;connect to point 4&#0160;&#0160; <br />&#0160;&#0160;&#0160; <br />&#0160; <span style="color: #0000ff;">&#0160; &#39;Create the color set: two colors. <br /></span>&#0160;&#0160;&#0160; Dim oColorSet As GraphicsColorSet <br />&#0160;&#0160;&#0160; Set oColorSet = oDataSets.CreateColorSet(oDataSets.count + 1) <br />&#0160;&#0160;&#0160; Call oColorSet.Add(1, 255, 0, 0) <br />&#0160;&#0160;&#0160; Call oColorSet.Add(2, 0, 255, 0) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160; &#39; Create the index set for color <br /></span>&#0160;&#0160;&#0160; Dim oColorIndex As GraphicsIndexSet <br />&#0160;&#0160;&#0160; Set oColorIndex = oDataSets.CreateIndexSet(oDataSets.count + 1) <br />&#0160;&#0160;&#0160; oColorIndex.Add 1, 2&#0160; &#39;line 1 uses color 2 <br />&#0160;&#0160;&#0160; oColorIndex.Add 2, 1&#0160; &#39;line 2 uses color 1 <br />&#0160;&#0160;&#0160; oColorIndex.Add 3, 2&#0160; &#39;line 3 uses color 2&#0160; <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; oGraphic.CoordinateSet = oCoordSet <br />&#0160;&#0160;&#0160; oGraphic.CoordinateIndexSet = oCoordinateIndex</p>
<p><strong>Using â€˜Stripâ€™ graphics <br /></strong>Strip Graphics are used to group the coordinates associated with a series of connected graphics objects and are only available with LineStrip, TriangleStrip or TriangleFan. You can specify the strip length. e.g. in the code below, points 1,2,3 are defined as one triangle strip, while points 4,5,6,7 are defined as another strip. Each strip is independent of the other strips. You can also specify the color for each.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676946853a970b-pi"><img alt="image" border="0" height="181" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769468541970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="491" /></a></p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Triangle Strip, Set Strip&gt; <br /></span>Dim oPointCoords(20) As Double&#0160;&#0160;&#0160; â€˜create 7 points, <br />oPointCoords(0) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(1) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(2) = 0 <br />oPointCoords(3) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(4) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(5) = 0 <br />oPointCoords(6) = 2:&#0160;&#0160;&#0160;&#0160; oPointCoords(7) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(8) = 0 <br />oPointCoords(9) = 3:&#0160;&#0160;&#0160;&#0160; oPointCoords(10) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(11) = 0 <br />oPointCoords(12) = 4:&#0160;&#0160;&#0160;&#0160; oPointCoords(13) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(14) = 0 <br />oPointCoords(15) = 5:&#0160;&#0160;&#0160;&#0160; oPointCoords(16) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(17) = 0 <br />oPointCoords(15) = 5:&#0160;&#0160;&#0160;&#0160; oPointCoords(16) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(17) = 0 <br />oPointCoords(18) = 6:&#0160;&#0160;&#0160;&#0160; oPointCoords(19) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(20) = 0 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />Call oCoordSet.PutCoordinates(oPointCoords) <br />&#0160; <br /><span style="color: #0000ff;">â€˜or Triangle Strip: totally 5 triangles <br /></span>Dim oGraphic As TriangleStripGraphics <br />Set oGraphic = oGraphicsNode.AddTriangleStripGraphics <br />&#0160; <br />Dim oStrip(1) As Long <br />oStrip(0) = 3&#0160; â€˜ point 1,2,3&#0160;&#0160; for strip 1 <br />oStrip(1) = 4&#0160; â€˜ point 4,5,6,7 for strip 2 <br />oGraphic.PutStripLengths oStrip <br /><br /><span style="color: #0000ff;">&#39;Create the color set: two colors. <br /></span>Dim oColorIndex As GraphicsIndexSet <br />Set oColorIndex = oDataSets.CreateIndexSet(oDataSets.count + 1) <br />oColorIndex.Add 1, 1 <br />oColorIndex.Add 2, 2 <br />oColorIndex.Add 3, 1 <br />oColorIndex.Add 4, 2 <br />oColorIndex.Add 5, 1&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160; &#39; Create the index set for color <br /></span>Dim oColorSet As GraphicsColorSet <br />Set oColorSet = oDataSets.CreateColorSet(oDataSets.count + 1) <br />Call oColorSet.Add(1, 255, 0, 0) <br />Call oColorSet.Add(2, 0, 255, 0) <br /><br />oGraphic.CoordinateSet = oCoordSet <br />oGraphic.ColorIndexSet = oColorIndex <br />oGraphic.ColorSet = oColorSet <br />oGraphic.ColorBinding = kPerStripColors</p>
<p><strong>Using Model Native Data <br /></strong>Most scenarios where Client Graphics are required are based on the models native geometry. It is quite easy to get the data using Inventor API objects. e.g. SurfaceBody, Face, Edge, Vertex in Part or Assembly Documents, and DrawingCurve in drawing documents. The code below creates and transforms a surface using an existing SurfaceBody from the model.</p>
<p>It is also possible to obtain a coordinate data set from the existing SurfaceBody, Edge or Face objects using the CalculateStrokes method. You determine the tolerance (the number of points you need) by first calling GetExistingStrokeTolerances. You may need to do this multiple times in order to assess the average tolerance for the model. Similarly, obtain triangular facets from a SurfaceBody or Face using CalculateFacets. <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340176173b244b970c-pi"><img alt="image" border="0" height="302" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340176173b2453970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="475" /></a></p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Using model native data&gt; <br /></span>Dim oPartDef As PartComponentDefinition <br />Set oPartDef = ThisApplication.ActiveDocument.ComponentDefinition&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />Dim oTransientBRep As TransientBRep <br />Set oTransientBRep = ThisApplication.TransientBRep <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;<span style="color: #0000ff;">â€˜by Transient Brep class to copy the surface body <br /></span>&#0160; Dim oBody As SurfaceBody <br />&#0160; Set oBody = oTransientBRep.Copy(oCompDef.SurfaceBodies.Item(1)) <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160; <span style="color: #0000ff;">&#39; Create client graphics based on the transient body <br /></span>&#0160; Dim oSurfaceGraphics As SurfaceGraphics <br />&#0160; Set oSurfaceGraphics = oSurfacesNode.AddSurfaceGraphics(oBody) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">â€˜move the graphics to a new location <br /></span>&#0160; Dim oMatrix As Matrix <br />&#0160; Set oMatrix = ThisApplication.TransientGeometry.CreateMatrix <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160; oMatrix.SetTranslation ThisApplication.TransientGeometry.CreateVector(0, 0, 100)</p>
<p><strong>Basic Properties <br /></strong>Graphics has some properties to control the basic behavior. <br /><strong><em>Render Style <br /></em></strong>By default, the linetype, lineweight and color will use the settings on RenderStyle until they are overridden by LineType, LineWeight, Color (for Curve and Surface objects), and ColorSet (for Line, Triangle and TriangleFan objects). <br /><strong><em>Point Style <br /></em></strong>Specific to Point objects only, and controls the point style. <br /><strong><em>Visibility <br /></em></strong>Controls whether or not the graphics are visible. <br /><strong><em>Selectable <br /></em></strong>Specifies whether client graphics can be selected when the Select command is running. <br /><strong><em>Burn Through <br /></em></strong>This specifies whether or not graphics are always visible even if they are blocked by other objects. <br /><strong><em>Transformation <br /></em></strong>This property is used to transform a graphics node. <br /><strong><em>Transform Behavior <br /></em></strong>Two special transform behaviors: front facing and pixel scaling. <br />â€¢&#0160;&#0160;&#0160; Front Facing <br />Client graphics with this property do not rotate as the view is rotated but maintain the same orientation on the screen. They are positioned at a specified location within model space and their position on the screen will change as the view is zoomed in and out and scrolled, but their orientation will not change. <br />â€¢&#0160;&#0160;&#0160; Pixel Scaling <br />Here client graphics maintain the same size and position relative to the screen. As the user zooms in and out in the graphic window, these objects remain static. <br />Any graphics object can also have no transform behavior (which means it&#39;s size, position, and orientation are maintained relative to model space), front facing, pixel scaling, or front facing &amp; pixel scaling. By default an object has no transform behavior, with the exception of text. Text always has front facing behavior regardless of the behavior type set through this method. <br /><strong><em>Anchor Behavior <br /></em></strong>This will anchor the primitive in view space so that the graphics will display in one fixed position, no matter how the view changes.</p>
<p>End of Segment 3</p>
<p>- Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Discussion on Client Graphics &ndash; segment 2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: discussion-on-client-graphics-segment-2
CATEGORY: Assemblies
CATEGORY: Drawings
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics-segment-2.html 
DATE: 08/10/2012 09:19:20 PM
-----
BODY:
<p>Here is the second of four articles on Client Graphics. This was originally in a technical paper written by Autodesk Developer Network engineer Xiaodong Liang.</p>
<p>Note: Segment 1 is <a href="http://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics.html" target="_blank">here</a></p>
<p><strong>This zip file has a VB.NET project with the examples discussed in this section.</strong></p>
<p><strong><span class="asset  asset-generic at-xid-6a00e553fcbfc688340176173b0196970c"><a href="http://modthemachine.typepad.com/files/clientgraphics_segment_2.zip">Download ClientGraphics_Segment_2</a></span></strong></p>
<p><strong>Start of segment 2</strong></p>
<p><strong>Graphic Primitives</strong></p>
<p><strong><em>Point</em></strong></p>
<p>Point is the simplest graphics object available. You could change the point style such as circular dot, a cross etc, and from Inventor 2011, a Point can be displayed with an image. (This section uses VBA code snippets. In 64 bit using iPictureDisp from&#0160;out of process is a known limitation. In 64 bit VBA is out of process)</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">&#39; &lt;code snippet : Point&gt; <br /></span>Dim oPointCoords(8) As Double <br />oPointCoords(0) = 0:&#0160;&#0160; oPointCoords(1) = 0: oPointCoords(2) = 0 <br />oPointCoords(3) = 0:&#0160;&#0160; oPointCoords(4) = 1: oPointCoords(5) = 0 <br />oPointCoords(6) = 1:&#0160;&#0160; oPointCoords(7) = 1: oPointCoords(8) = 1 <br /><br /><span style="color: #0000ff;">&#39; Create an image set <br /></span>Dim oImageSet As GraphicsImageSet <br />Set oImageSet = oDataSets.CreateImageSet(oDataSets.count + 1) <br />Dim oImage As IPictureDisp <br />Set oImage = LoadPicture(&quot;C:\Temp\MyImage.bmp&quot;) <br />Call oImageSet.Add(1,oImage) <br /><br /><span style="color: #0000ff;">â€˜add point graphics and assign the data <br /></span>Call oCoordSet.PutCoordinates(oPointCoords)&#0160; <br />Dim oPointGraphics As PointGraphics <br />Set oPointGraphics = oPointNode.AddPointGraphics oPointGraphics.PointRenderStyle = kFilledCrossPointStyle <br />oPointGraphics.CoordinateSet = oCoordSet <br />oPointGraphics.BurnThrough = True</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017617261271970c-pi"><img alt="image" border="0" height="342" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167693116f0970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="297" /></a></p>
<p><strong><em>&#0160;</em></strong></p>
<p><strong><em>Line <br /></em></strong>These are individual line segments. Line graphics use two coordinates to define a line, and then the next two coordinates to define the next line, and so on through the defined coordinates.</p>
<p><strong><em>Line Strip <br /></em></strong>These are a connected set of lines. Line strips use the first two coordinates to define the first line and then the last point of the first line becomes the first point of the second line and the next coordinate is used as the end point of the second line. This results in the set of points being connected by a continuous set of lines, drawing a continuous curve. So to define 2 connected lines, just 3 coordinates would be required.</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Line or LineStrip&gt;</span> Dim oPointCoords(11) As Double â€˜create 4 points&#0160;&#0160;&#0160; <br />oPointCoords(0) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(1) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(2) = 0 <br />oPointCoords(3) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(4) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(5) = 0 <br />oPointCoords(6) = 2:&#0160;&#0160;&#0160;&#0160; oPointCoords(7) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(8) = 0 <br />oPointCoords(9) = 3:&#0160;&#0160;&#0160;&#0160; oPointCoords(10) = 1:&#0160; oPointCoords(11) = 0&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />Call oCoordSet.PutCoordinates(oPointCoords) <span style="color: #0000ff;"><br /><br />â€˜Line: every 2 points for 1 Line <br /></span>Dim oGraphic As LineGraphics <br />Set oGraphic = oGraphicsNode.AddLineGraphics <br /><br /><span style="color: #0000ff;">â€˜Line strip: totally, 3 lines <br />â€˜Dim oGraphic As LineStripGraphics <br />â€˜Set oGraphic = oGraphicsNode.AddLineStripGraphics&#0160; </span></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177440c2442970d-pi"><img alt="image" border="0" height="157" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340176172612b8970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="493" /></a></p>
<p>&#0160;</p>
<p><strong><em>Triangle <br /></em></strong>These are used to define individual triangles. Each set of three coordinates defines a triangle. The next three coordinates then define the next triangle, and so on through all of the coordinates that are provided.</p>
<p><strong><em>Triangle Strip <br /></em></strong>These provide a connected set of triangles. The first three coordinates define a triangle and the next coordinate defines another triangle using the previous two coordinates. You could also specify the strip length. This is provided for performance reasons.&#0160;&#0160;&#0160;</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Triangle or Triangle Strip&gt; <br /></span>Dim oPointCoords(20) As Double&#0160;&#0160;&#0160; â€˜create 7 points, <br />oPointCoords(0) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(1) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(2) = 0 <br />oPointCoords(3) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(4) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(5) = 0 <br />oPointCoords(6) = 2:&#0160;&#0160;&#0160;&#0160; oPointCoords(7) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(8) = 0 <br />oPointCoords(9) = 3:&#0160;&#0160;&#0160;&#0160; oPointCoords(10) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(11) = 0 <br />oPointCoords(12) = 4:&#0160;&#0160;&#0160;&#0160; oPointCoords(13) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(14) = 0 <br />oPointCoords(15) = 5:&#0160;&#0160;&#0160;&#0160; oPointCoords(16) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(17) = 0 <br />oPointCoords(15) = 5:&#0160;&#0160;&#0160;&#0160; oPointCoords(16) = 1:&#0160;&#0160;&#0160;&#0160; oPointCoords(17) = 0 <br />oPointCoords(18) = 6:&#0160;&#0160;&#0160;&#0160; oPointCoords(19) = 0:&#0160;&#0160;&#0160;&#0160; oPointCoords(20) = 0 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />Call oCoordSet.PutCoordinates(oPointCoords) <span style="color: #0000ff;"><br /><br />â€˜Triangle: every 3 points for 1 triangle <br /></span>Dim oGraphic As TriangleGraphics <br />Set oGraphic = oGraphicsNode.AddTriangleGraphics <br /><br /><span style="color: #0000ff;">â€˜or Triangle Strip: totally 5 triangles <br />â€˜Dim oGraphic As TriangleStripGraphics <br />â€˜Set oGraphic = oGraphicsNode.AddTriangleStripGraphics </span><br /><br />oGraphic.CoordinateSet = oCoordSet</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340176172612c5970c-pi"><img alt="image" border="0" height="141" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676931170b970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="481" /></a></p>
<p><strong>Graphics</strong></p>
<p><strong><em>Triangle Fan <br /></em></strong>This defines a set of connected triangles. The first coordinate is shared in all triangles. The first three coordinates define a triangle. And the next coordinate defines another triangle using the previous coordinates: one of which is the first coordinate. If all the coordinates surround the first point, then the resulting graphics looks like a fan. Again this facility is provided primarily for performance reasons.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769311710970b-pi"><img alt="image" border="0" height="244" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340176172612d6970c-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="211" /></a></p>
<p><strong><em>&#0160;</em></strong></p>
<p><strong><em>TextGraphics</em></strong></p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Text&gt; <br /></span>Dim oTG As TransientGeometry <br />Set oTG = ThisApplication.TransientGeometry <br /><br />Dim oTextGraphics As TextGraphics <br />Set oTextGraphics = oNode.AddTextGraphics <br /><br />oTextGraphics.Text = Text <br />oTextGraphics.Anchor = oPosition <br />oTextGraphics.Bold = True <br />oTextGraphics.Font = &quot;Arial&quot; <br />oTextGraphics.FontSize = 40 <br />oTextGraphics.HorizontalAlignment = kAlignTextLeft <br />oTextGraphics.Italic = True <br />Call oTextGraphics.PutTextColor(0, 255, 0)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177440c2465970d-pi"><img alt="image" border="0" height="244" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769311725970b-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="237" /></a></p>
<p>&#0160;</p>
<p><strong><em>Curve <br /></em></strong>Curves include the following objects: LineSegment, Circle, Arc3d, EllipseFull, EllipticalArc and BSplineCurve. The object TransientGeometry is used to create the geometry and client graphics then uses this geometry as input. You can also use the geometry from a modelâ€™s native data too.</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Curve&gt; <br /></span>Dim oTG As TransientGeometry <br />Set oTG = ThisApplication.TransientGeometry <br /><br />Dim oCircle As Inventor.Circle <br />Set oCircle = oTG.CreateCircle(oTG.CreatePoint(0, 0, 0), <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTG.CreateUnitVector(0, 0, 1), 5#) <br />&#0160;&#0160;&#0160; <br />Dim oGraphic As CurveGraphics <br />Set oGraphic = oGraphicsNode.AddCurveGraphics(oCircle)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177440c2478970d-pi"><img alt="image" border="0" height="235" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769311730970b-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="244" /></a></p>
<p>&#0160;</p>
<p><strong><em>Surface <br /></em></strong>TransientBrep is used to create the underlying geometry data, and client graphics objects then use this geometry. Again you can use the modelâ€™s native data: face, faces or face collection too.</p>
<p style="line-height: 140%; font-family: arial; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">â€˜&lt;code snippet: Surface&gt; <br /></span>Dim oTransientBRep As TransientBRep <br />Set oTransientBRep = ThisApplication.TransientBRep <br />&#0160;&#0160;&#0160; <br />Dim oTG As TransientGeometry <br />Set oTG = ThisApplication.TransientGeometry <br /><br /><br />Dim oBody As SurfaceBody <br />Set oBody = oTransientBRep.CreateSolidCylinderCone _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oTG.CreatePoint(0, 0, 0), _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTG.CreatePoint(0, 10, 0), _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 5, 5, 0) Dim oSurfaceGraphics As SurfaceGraphics <br />Set oSurfaceGraphics = oSurfacesNode. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddSurfaceGraphics(oBody)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016769311738970b-pi"><img alt="image" border="0" height="244" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340177440c2490970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="240" /></a></p>
<p>&#0160;</p>
<p>End of Segment 2</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: My First Inventor Plug-in Training C#
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: my-first-inventor-plug-in-training-c
CATEGORY: Announcements
CATEGORY: Beginning API
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/my-first-inventor-plug-in-training-c.html 
DATE: 08/08/2012 06:06:34 PM
-----
BODY:
<p>Due to popular demand, we have added C# code downloads for each lesson in My First Inventor Plug-in Training Content, the explanations are still for VB.NET, but now if someone prefers C# they can now follow along with the NEW C# labs!</p>
<p><a href="http://www.autodesk.com/myfirstinventorplugin">www.autodesk.com/myfirstinventorplugin</a></p>
<p>This guide is designed for those of you that are new to programming and doesnâ€™t assume any previous programming experience.&#0160; Most of the content discusses basic programming concepts and then lets you put them into practice utilizing Inventorâ€™s API (Application Programming Interface) to create a simple program to control the display of occurrences within an assembly.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017743ffd443970d-pi"><img alt="image" border="0" height="188" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676924c769970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="450" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Discussion on Client Graphics
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: discussion-on-client-graphics
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/08/discussion-on-client-graphics.html 
DATE: 08/03/2012 07:52:41 PM
-----
BODY:
<p>My colleague Xiaodong Liang created a technical paper focusing on client graphics. I thought it would be interesting to present this material. Here is the first installment.</p>
<p><strong>Client Graphics â€“ Introduction</strong></p>
<p>Client graphics provide the ability to draw custom graphics in the InventorÂ® modeling window. Some common uses of client graphics are to represent custom objects and to create interactive previews during commands, displaying the results of various analyses and for creating custom manipulators within the command. An example is a milling application in CAM, where the toolpath is shown using client graphics. Another example is to show the results of a finite element analysis. </p>
<p>The Inventor API allows you to create these graphics (referred to as Client Graphics) using primitives (points, lines, triangles, text, etc). Client Graphics allow the developer to provide visual cues. Inventor uses this feature itself in many scenarios, for instance, when the user creates an extrusion, a preview of the extruded part is displayed. While defining the extrude feature, a visual cue indicates how the final result will display.&#0160; A developer can provide similar visual cues within their own application.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017616fcc135970c-pi"><img alt="image" border="0" height="226" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017743e2f820970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="464" /></a></p>
<p>&#0160;</p>
<p><strong>API Object Model:</strong></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017743e2f82c970d-pi"><img alt="image" border="0" height="336" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017743e2f83d970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="462" /></a></p>
<p>&#0160;</p>
<p><strong>Types of Client Graphics: <br /></strong></p>
<p><em><strong>Regular Client Graphics <br /></strong></em>This type of client graphics is associated with a document. They are transient unless associated with a client feature. One document/sheet/drawing view can have more than one client graphics object associated with it. Each client graphics object can have many graphics nodes. Each node can contain any number and any type of graphic primitives. </p>
<p><em><strong>Interaction Client Graphics <br /></strong></em>This type of client graphics is available when using Interaction Events. It is always transient. The InteractionEvents object can have any number of nodes and graphics primitives, like Regular Client Graphics. </p>
<p><strong>Graphics Data:</strong></p>
<p>In Inventor, most client graphics are defined using two different types of objects; graphics data, and graphic primitives. The graphics data defines the low-level information that can be used to define primitives.&#0160; By separating the data from the primitives, the data can be re-used by multiple primitives.</p>
<p><em><strong>Data Objects <br /></strong></em>For Point, Line, LineStrip, Triangle, TriangleStrip, and TriangleFans, the data object provides the list of coordinates that your graphics will be based upon, and other necessary data sets such as the color and normals.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676907ddee970b-pi"><img alt="image" border="0" height="304" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834017743e2f853970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="468" /></a></p>
<p><strong>Definitions</strong></p>
<p><strong>Coordinate Sets:</strong> The coordinates used to specify the vertices for the graphic sets. <br /><strong>Color Sets:</strong> A set of colors used by a graphic set. It overrides any other color information assigned to the set. Colors in the color set can be bound to the entire graphic set, each individual primitive in the set (e.g. each triangle in a triangle strip), or each vertex in the set (i.e. interpolated color). <br /><strong>Normal Sets:</strong> Contains a set of normal vectors to define how the lighting is calculated for the triangles. <br /><strong>Index Sets:</strong> Each graphics primitive can access this set to more efficiently use an associated coordinate or color set.</p>
<p><strong>Subsidiary Objects</strong></p>
<p><strong>TransientGeometry</strong>: The TransientGeoemtry object is a utility object you use to create various points, curves, surfaces, and mathematical objects like vectors, and matrices. In association with client graphics, the ability to create different types of curves is useful because you can use these as input to define Curve graphics. <br /><strong>TransientBrep:</strong> The TransientBRep object is used to create transient surface and solid models. These can be used to create Surface graphics </p>
<p><strong>General Procedure <br /></strong>Creation of Client Graphics follows the general procedure: <br />1. Get the GraphicsDataSetsCollection object from the Document <br />2. Add GraphicsDataSets object and create graphics data <br />(for Curve or Surface, create graphics data by TransientGeometry and Transient) <br />3. Get the ClientGraphicsCollection from the graphics owner:&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Component in part/assembly&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; View/Sheet in drawing <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InteractionEvents for Interaction Client Graphics <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientFeatureDefintion for Client Feature <br />4.&#0160;&#0160;&#0160; Add a ClientGraphics object to ClientGraphicsCollection <br />5.&#0160;&#0160;&#0160; Add as many GraphicsNodes as you need <br />6.&#0160;&#0160;&#0160; Add GraphicsPrimitive objects to the node(s) <br />7.&#0160;&#0160;&#0160; Assign graphics data to the primitives <br />8.&#0160;&#0160;&#0160; Update the view(s) </p>
<p><strong>VB.NET Example: <br /></strong>This example will create a simple client graphic using LineGraphics. See the comments in the code for more details:&#0160; </p>
<div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt;">
<p style="margin: 0px;"><span style="color: blue;">Imports</span> Inventor</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">Public</span> <span style="color: blue;">Class</span> <span style="color: #2b91af;">Form1</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> m_inventorApp <span style="color: blue;">As</span> Inventor.<span style="color: #2b91af;">Application</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Private</span> <span style="color: blue;">Sub</span> Button1_Click(<span style="color: blue;">ByVal</span> sender <span style="color: blue;">As</span>&#0160; _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.<span style="color: #2b91af;">Object</span>, _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">ByVal</span> e <span style="color: blue;">As</span> System.<span style="color: #2b91af;">EventArgs</span>) _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Handles</span> Button1.Click</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; Get an active instance of Inventor</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp = System.Runtime. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; InteropServices.<span style="color: #2b91af;">Marshal</span>. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetActiveObject(<span style="color: #a31515;">&quot;Inventor.Application&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span> <span style="color: green;">&#39;Inventor not started</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms.<span style="color: #2b91af;">MessageBox</span>. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Show(<span style="color: #a31515;">&quot;Start an Inventor session&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Call the Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DrawLineGraphics()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">&#39;Draw LineGraphics (two points)</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">Public</span> <span style="color: blue;">Sub</span> DrawLineGraphics()</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> m_inventorApp.Documents.Count _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt; 1 <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms.<span style="color: #2b91af;">MessageBox</span>. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Show(<span style="color: #a31515;">&quot;Make Assembly or Part current&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDoc <span style="color: blue;">As</span> <span style="color: #2b91af;">Document</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc = m_inventorApp.ActiveDocument</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">If</span> oDoc.DocumentType = <span style="color: #2b91af;">DocumentTypeEnum</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .kPartDocumentObject <span style="color: blue;">Or</span> _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc.DocumentType = _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">DocumentTypeEnum</span>.kAssemblyDocumentObject <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get GraphicsDataSetsCollection</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39; object from the Document. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Add a GraphicsDataSets object</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oDataSets <span style="color: blue;">As</span> <span style="color: #2b91af;">GraphicsDataSets</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDataSets = oDoc. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GraphicsDataSetsCollection.Add(<span style="color: #a31515;">&quot;TestCG&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oCompDef <span style="color: blue;">As</span> <span style="color: #2b91af;">ComponentDefinition</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oCompDef = oDoc.ComponentDefinition</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Get the ClientGraphicsCollection </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;from the graphics owner. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Add a ClientGraphics</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oClientGraphics <span style="color: blue;">As</span> <span style="color: #2b91af;">ClientGraphics</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oClientGraphics = oCompDef. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientGraphicsCollection.Add(<span style="color: #a31515;">&quot;TestCG&quot;</span>)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> coordSet <span style="color: blue;">As</span> <span style="color: #2b91af;">GraphicsCoordinateSet</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; coordSet = oDataSets. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateCoordinateSet(1)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Create graphics data.&#0160; </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;In this case, prepare two points </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;for line graphics</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oPointCoords(5) <span style="color: blue;">As</span> <span style="color: blue;">Double</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPointCoords(0) = 0 _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : oPointCoords(1) = 0 _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : oPointCoords(2) = 0&#0160;&#0160; <span style="color: green;">&#39;point 1</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPointCoords(3) = 1 _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : oPointCoords(4) = 0 _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : oPointCoords(5) = 0&#0160;&#0160; <span style="color: green;">&#39;point 2</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Call</span> coordSet.PutCoordinates _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (oPointCoords)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Add GraphicsNodes</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oGraphicsNode <span style="color: blue;">As</span> <span style="color: #2b91af;">GraphicsNode</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGraphicsNode = oClientGraphics. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddNode(1)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Add GraphicsPrimitive to node</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Dim</span> oGraphic <span style="color: blue;">As</span> <span style="color: #2b91af;">LineGraphics</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGraphic = oGraphicsNode. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddLineGraphics</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;Assign graphics data </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;to the primitives</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGraphic.CoordinateSet = coordSet</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">&#39;update the view</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApp.ActiveView.Update()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> <span style="color: #2b91af;">Exception</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms. _</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show(ex.ToString())</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms. _</p>
<p style="margin: 0px;">&#0160;<span style="color: #2b91af;">MessageBox</span>.Show(<span style="color: #a31515;">&quot;Prob creating Client Graphics&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">Else</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms. _</p>
<p style="margin: 0px;">&#0160;&#0160; <span style="color: #2b91af;">MessageBox</span>.Show(<span style="color: #a31515;">&quot;Make Assembly or Part Active&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">End</span> <span style="color: blue;">Sub</span></p>
<p style="margin: 0px;"><span style="color: blue;">End</span> <span style="color: blue;">Class</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Farren Young
EMAIL: farren.young@d3tech.net
IP: 67.231.38.66
URL: 
DATE: 08/06/2012 07:16:01 PM
Thanks guys, great info!
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Exchange Store
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-store
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/07/autodesk-exchange-store.html 
DATE: 07/20/2012 11:05:13 PM
-----
BODY:
<p>Good news if you want to get your application on the <a href="http://apps.exchange.autodesk.com">Autodesk Exchange</a> store. Anyone can now submit a product to be published on the store. <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen Preston</a> has posted several articles explaining the full details:</p>
<ul>
<li><a href="http://adndevblog.typepad.com/manufacturing/2012/07/autodesk-exchange-apps-summary-information.html">Summary information</a></li>
<li><a href="http://adndevblog.typepad.com/manufacturing/2012/07/exchange-apps-information-for-inventor-developers.html">Information for Inventor developers</a></li>
<li><a href="http://adndevblog.typepad.com/manufacturing/2012/07/publishing-on-the-autodesk-exchange-store.html">Publishing an app</a></li>
</ul>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Set &ldquo;Embed Interop Types&rdquo; to False to avoid problems with events
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: set-embed-interop-types-to-false-to-avoid-problems-with-events
CATEGORY: C#
CATEGORY: Inventor
CATEGORY: VB.NET
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/07/set-embed-interop-types-to-false-to-avoid-problems-with-events.html 
DATE: 07/17/2012 08:41:12 PM
-----
BODY:
<p>We have had several cases recently where events such as OnFileSaveAsDialog were not working properly. Problems with events can occur if the property â€œEmbeding Interop Typesâ€ of the referenced Inventor Interop is set to True. This setting is new in Visual Studio 2010 with .NET 4 and it defaults to True. If you change the setting to False and rebuild the events work normally.</p>
<p>Here is a screenshot of the properties window in VB.NET.&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177436dfabf970d-pi"><img alt="image" border="0" height="270" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167689301c4970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="503" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: API support for the creation and edit of a Move Body feature
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: api-support-for-the-creation-and-edit-of-a-move-body-feature
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Visual Basic for Applications (VBA)
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/07/api-support-for-the-creation-and-edit-of-a-move-body-feature.html 
DATE: 07/07/2012 03:39:24 PM
-----
BODY:
<p>The Inventor 2013 API now fully supports Move Body Features.&#0160; A move body feature allows you to manipulate the location and orientation of a body and is listed in the feature tree. There are different ways you can manipulate the body using methods of the new MoveDefinition object. You can rotate it, move it along a vector or do a free drag by specifying the xyz offset.</p>
<p><strong>New 2013 Object &amp; Methods:&#0160; </strong></p>
<p>MoveFeatures.CreateMoveDefinition Method </p>
<p>MoveDefinition Object</p>
<ul>
<li>AddRotateAboutAxis</li>
<li>AddMoveAlongRay</li>
<li>AddFreeDrag</li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production.</p>
<p>To use this example have a part that has a multiple solid bodies. When you run the code select one of the bodies. This screenshot shows a solid body before running the code:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401761637fff1970c-pi"><img alt="image" border="0" height="318" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016768430114970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="455" /></a></p>
<p>After the procedure is run a Move Body feature has been created. This feature changes the location of the body.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340177431e156d970d-pi"><img alt="image" border="0" height="323" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340177431e1575970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="454" /></a></p>
<p><strong>VBA Code:</strong></p>
<p><span style="color: #0000ff;">&#39; Demonstrates using the API to create a <br />&#39; Move Body feature. You must have a part <br />&#39; open that contains at least one body. <br /></span>Public Sub MoveBody() <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the active part document. <br /></span>&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim partDef As PartComponentDefinition <br />&#0160;&#0160;&#0160; Set partDef = partDoc.ComponentDefinition</p>
<p>&#0160; <span style="color: #0000ff;">&#0160; &#39; Have the user select a body. <br /></span>&#0160;&#0160;&#0160; Dim body As SurfaceBody <br />&#0160;&#0160;&#0160; Set body = ThisApplication.CommandManager.Pick _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (kPartBodyFilter, &quot;Select the body to move.&quot;) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If Not body Is Nothing Then <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#0160; &#39; Create a collection containing the body to move. <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim bodyCollection As ObjectCollection <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set bodyCollection = ThisApplication. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; TransientObjects.CreateObjectCollection <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call bodyCollection.Add(body) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create a move definition. <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim moveDef As MoveDefinition <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set moveDef = partDef.Features.MoveFeatures _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .CreateMoveDefinition(bodyCollection) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Define a rotate, move, and free drag. <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call moveDef.AddRotateAboutAxis _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (partDef.WorkAxes.Item(3), True, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 3.14159265358979 / 4) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call moveDef.AddMoveAlongRay _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (partDef.WorkAxes.Item(1), True, 3) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call moveDef.AddFreeDrag(0.5, 6, 3) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create the move feature. <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim move As MoveFeature <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set move = partDef.Features.MoveFeatures _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Add(moveDef) <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Wishlist 2012 - Survey results
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-wishlist-2012-survey-results
CATEGORY: Announcements
CATEGORY: Inventor
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/07/inventor-api-wishlist-2012-survey-results.html 
DATE: 07/03/2012 10:37:10 PM
-----
BODY:
<p>Thanks to everyone who participated in the survey. Your input is very valuable to the engineering team. The three tables below have the results for the three main questions on the survey. The survey also has many individual suggestions that are not listed here.</p>
<p>It is apparent that continuing to enhance the API help should be a top priority. I sure agree with this. The 2013 API help file has some welcome improvements but more examples in multiple languages would be great.</p>
<p><strong>Inventor API recommended enhancements:</strong></p>
<table border="1" cellpadding="0" cellspacing="0" width="440">
<tbody>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Creation and edit support for datum symbols</p>
</td>
<td valign="bottom" width="73">
<p>3%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Creation and edit support for weld symbols</p>
</td>
<td valign="bottom" width="73">
<p>3%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Creation and edit support for hatching</p>
</td>
<td valign="bottom" width="73">
<p>11%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Creation and edit support for slice views</p>
</td>
<td valign="bottom" width="73">
<p>0%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Creation and edit support for cropped views</p>
</td>
<td valign="bottom" width="73">
<p>4%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Support for auto-balloon</p>
</td>
<td valign="bottom" width="73">
<p>10%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Drawings - Full dimension style support</p>
</td>
<td valign="bottom" width="73">
<p>19%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Grill feature</p>
</td>
<td valign="bottom" width="73">
<p>1%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Boss feature</p>
</td>
<td valign="bottom" width="73">
<p>3%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Rest feature</p>
</td>
<td valign="bottom" width="73">
<p>3%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Snap Fit feature</p>
</td>
<td valign="bottom" width="73">
<p>1%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Lip feature</p>
</td>
<td valign="bottom" width="73">
<p>0%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Creation and edit support for the Rule Fillet feature</p>
</td>
<td valign="bottom" width="73">
<p>0%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Part - Ability to nest work features within a 3D sketch, as you can through the user interface</p>
</td>
<td valign="bottom" width="73">
<p>5%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Verticals - API support for Cable &amp; Harness</p>
</td>
<td valign="bottom" width="73">
<p>5%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Verticals - API support for Tube &amp; Pipe</p>
</td>
<td valign="bottom" width="73">
<p>5%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Verticals - API support for Dynamic Simulation</p>
</td>
<td valign="bottom" width="73">
<p>5%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Verticals - API support for FEA</p>
</td>
<td valign="bottom" width="73">
<p>4%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Verticals - API support for Frame Generator</p>
</td>
<td valign="bottom" width="73">
<p>18%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Improved API support for presentation documents</p>
</td>
<td valign="bottom" width="73">
<p>9%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API support to re-use graphical widgets (such as in the Extrude and Move Face features in Inventor) in custom commands</p>
</td>
<td valign="bottom" width="73">
<p>8%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API support for Pack &amp; Go</p>
</td>
<td valign="bottom" width="73">
<p>20%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>VBA Record and Playback capability</p>
</td>
<td valign="bottom" width="73">
<p>15%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API Help - Samples for every method and property</p>
</td>
<td valign="bottom" width="73">
<p>41%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API Help - More samples in languages other than VBA (E.g. C++, C#, VB.NET)</p>
</td>
<td valign="bottom" width="73">
<p>27%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API Help - Improved function descriptions</p>
</td>
<td valign="bottom" width="73">
<p>25%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>API Help - More/better overviews</p>
</td>
<td valign="bottom" width="73">
<p>9%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="365">
<p>Other, please specify</p>
</td>
<td valign="bottom" width="75">
<p>24%</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>&#0160;</p>
<p><strong>Preferred development tools used with the Inventor API:</strong>&#0160;</p>
<table border="1" cellpadding="0" cellspacing="0" width="443">
<tbody>
<tr>
<td valign="top" width="377">
<p>C++</p>
</td>
<td align="right" width="64">
<p>18%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="375">
<p>VBA</p>
</td>
<td align="right" valign="bottom" width="66">
<p>26%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="374">
<p>Visual Basic 6</p>
</td>
<td align="right" valign="bottom" width="67">
<p>4%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="373">
<p>VB.NET â€“ Visual Studio</p>
</td>
<td align="right" valign="bottom" width="68">
<p>40%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="372">
<p>VB.NET â€“ Visual Basic Express</p>
</td>
<td align="right" valign="bottom" width="69">
<p>24%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="371">
<p>C# â€“ Visual Studio</p>
</td>
<td align="right" valign="bottom" width="70">
<p>44%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="370">
<p>C# â€“ Visual C# Express</p>
</td>
<td align="right" valign="bottom" width="71">
<p>6%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="369">
<p>Other</p>
</td>
<td align="right" valign="bottom" width="72">
<p>8%</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Newest version of Inventor you have used for development:</strong></p>
<table border="1" cellpadding="0" cellspacing="0" width="443">
<tbody>
<tr>
<td valign="bottom" width="383">
<p>Inventor 2010 or previous</p>
</td>
<td align="right" valign="bottom" width="58">
<p>3%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="382">
<p>Inventor 2011</p>
</td>
<td align="right" valign="bottom" width="59">
<p>11%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="381">
<p>Inventor 2012</p>
</td>
<td align="right" valign="bottom" width="60">
<p>43%</p>
</td>
</tr>
<tr>
<td valign="bottom" width="380">
<p>Inventor 2013</p>
</td>
<td align="right" valign="bottom" width="62">
<p>43%</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: ADN Cloud and Mobile DevBlog
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adn-cloud-and-mobile-devblog
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/adn-cloud-and-mobile-devblog.html 
DATE: 06/28/2012 08:28:10 PM
-----
BODY:
<p>The engineers who support the Autodesk Developer Network are getting quite good with cloud and mobile technologies. You can see this for yourself by checking out the articles on this new blog:</p>
<p><a href="http://adndevblog.typepad.com/cloud_and_mobile/">Cloud &amp; Mobile DevBlog</a></p>
<p>This blog focuses on Autodesk cloud and mobile technologies as well as generic cloud and mobile technologies. This post by&#0160; Philippe Leefsma who supports Autodesk Manufacturing products should be very interesting to anyone developing on Android.</p>
<p><a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/06/android.html" rel="noopener noreferrer" target="_blank" title="http://adndevblog.typepad.com/cloud_and_mobile/2012/06/android.html">Fast debugging of Android applications</a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: MFG DevCamp 2012 Material &ndash; zip file
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mfg-devcamp-2012-material-zip-file
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/mfg-devcamp-2012-material-zip-file.html 
DATE: 06/28/2012 08:15:09 PM
-----
BODY:
<p>The DevCamp 2012 project site on Buzzsaw which we have used during the event will be closed on July 2nd. If you want to take a look at the presentations you can download this file which contains all of the DevCamp material:&#0160; <a href="http://download.autodesk.com/media/adn/Autodesk_MFG_DevCamp_2012.zip" rel="noopener noreferrer" target="_blank">Autodesk_MFG_DevCamp_2012.zip</a></p>
<p>This screenshot shows the contents of the this file. You can find a&#0160; brief description of the courses in the pdf file.&#0160;&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016767f346b4970b-pi"><img alt="image" border="0" height="208" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016767f346c7970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="466" /></a></p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: MFG DevCamp 2012 Material
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mfg-devcamp-2012-material
CATEGORY: Announcements
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/mfg-devcamp-2012-material.html 
DATE: 06/19/2012 08:09:35 PM
-----
BODY:
<p>The Manufacturing <a href="https://projectpoint.buzzsaw.com/DevCamp2012/MFG?public" rel="noopener noreferrer" target="_blank">DevCamp 2012 material</a> is now publicly available. The top-level node provides access to the overviews and the six main tracks:</p>
<ul>
<li>Autodesk Inventor App Development for Beginners</li>
<li>Autodesk Inventor App Development for Experts</li>
<li>Autodesk PLM</li>
<li>Cloud and Mobile Technologies</li>
<li>Business Development</li>
<li>Autodesk Engineer To Order (ETO)</li>
</ul>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016306bc3fb3970d-pi"><img alt="image" border="0" height="289" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016306bc3fc2970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="473" /></a></p>
<p>&#0160;</p>
<p><strong>Mancakes Prevail:</strong></p>
<p>One of the things I enjoy about DevCamp is the chance to get together with colleagues. Friday evening after the DevLab, several Autodesk MFG colleagues had dinner at a small restaurant in Portland called Stepping Stone cafÃ©. Here you see Gary giving a go at eating the mancakes. He gave a gallant performance but in the end, the cakes won out.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017615a5274b970c-pi"><img alt="image" border="0" height="357" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016306bc40b7970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="472" /></a></p>
<p>From left to right: Philippe Leefsma, Gary Wassell, Wayne Brill, Adam Nagy, Brian Ekins.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017615a5280b970c-pi"><img alt="image" border="0" height="368" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016306bc4153970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="476" /></a></p>
<p>Just a few more bites to go.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: MFG DevLab
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mfg-devlab
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/mfg-devlab.html 
DATE: 06/16/2012 12:15:16 AM
-----
BODY:
<p>So weâ€™re just reaching the end of the day, and the end of a very busy week for the ADN team here in Lake Oswego. Proceedings were capped off by the hugely popular DevLab, which appears to have been very productive for everyone that managed to come along.</p>
<p>We were all holed up in the Customer Briefing Center, where laptops, pizza and a lot of coffee were the order of the day!</p>
<p>&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163069cb70b970d-pi"><img alt="photo (3)" border="0" height="385" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167679044c3970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="photo (3)" width="513" /></a></p>
<p>&#0160;</p>
<p>Several developers were very interested in getting their ideas published as apps in the Inventor and Vault Exchange Stores, it was great to see Gary who manages our DevTech manufacturing workgroup discussing this opportunity with them, and offer hints and tips so they can get published as quickly as possible.</p>
<p>Some developers came along with some long standing issues theyâ€™d been having, and went away with big smiles on their faces when our in-house experts could suggest solutions they could try.</p>
<p>Thereâ€™s no doubt that for many event attendees, the DevLab on its own justified the entire trip to US West Coast.</p>
<p>As for me â€“ Iâ€™m looking forward to a road trip to Mt St Helens with Gary and Philippe over the weekend for a bit of fresh air and sunshine!</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tom McKeand
EMAIL: tmckeand@cellxion.com
IP: 208.88.70.82
URL: 
DATE: 06/18/2012 02:51:06 PM
The last day was worth the whole trip. It would have been great to have had the lab for the whole 3 days. I would of paid more for that. It was good meeting you Wayne and thanks for your help.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: MFG DevCamp Day Two
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mfg-devcamp-day-two
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/mfg-devcamp-day-two.html 
DATE: 06/15/2012 07:01:53 PM
-----
BODY:
<p>Buzz Kross kicked off day 2 (Buzz is Autodeskâ€™s Senior Vice President responsible for all of our manufacturing related products). His keynote address outlined the huge successes the company, our partners and our customers have been having â€“ and all this despite the challenging economic climate weâ€™re experiencing. Itâ€™s clear that opportunities for manufacturers and for our developer partners operating in this industry abound.</p>
<p>Buzz reinforced our message with Cloud and Mobile â€“ outlining just how important it is for everyone to understand the impact these technologies are already having on the world. There is no doubt the world is changing, and many of our ADN partners are already operating on this emerging and very exciting frontier.</p>
<p>The rest of the day continued with more in-depth presentations on Inventor API, Data Management, our Engineering To Order, â€˜ETOâ€™ product, Advanced API and Cloud and Mobile technologies, all mixed in with a lot of wide ranging discussions on technical issues, business &amp; collaboration, and a fair amount of brainstorming.</p>
<p>Now Iâ€™m sitting in on the DevLab back at the Lake Oswego office taking a few minutes breather to write up this post in between helping a room full of partners with some detailed and very specific programming problems theyâ€™re having. Itâ€™s going to be a very busy day! (For those of you who donâ€™t know â€“ the ADN team runs DevLabs as often as possible, and invite anyone along who is working with our APIs, who also needs to spend a bit of time with one of our engineers to work through a coding problem. Itâ€™s a great opportunity to get some really good quality â€˜face timeâ€™ with an expert!).</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: MFG DevCamp Day One
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: mfg-devcamp-day-one
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/mfg-devcamp-day-one.html 
DATE: 06/14/2012 06:05:35 PM
-----
BODY:
<p>Cloud Cloud Cloud! Mobile Mobile Mobile!</p>
<p>The message is coming loud and clear that Autodesk is focusing massively on Cloud and Mobile related technologies and the huge opportunities they represent to our customers and partners.</p>
<p>This yearâ€™s Manufacturing DevCamp, which is taking place right now near our Manufacturing headquarters in Lake Oswego - Oregon, is dedicating an entire track of 8 sessions to Cloud and Mobile related content and workshops. Our first keynote speech was by Kevin Schneider, the Senior Product line manager Autodesk Fusion who outlined many of the exciting projects we are already engaged with that are taking advantage of these exciting emerging technologies.</p>
<p>Gopinath Taget (our DevTech Cloud and Mobile technical lead) presented a series of tutorials overviewing Cloud technologies, and some examples of Cloud based applications that Autodesk has already pubished on the web!</p>
<p>Philippe Leefsma Demoâ€™d a really cool app he developed that allows Inventor models to be uploaded to a cloud based service, which can then be accessed from mobile phone and tablet devices to review the models. He then went on to present a session outlining all the technical steps heâ€™d been through to get the system working. Amazingly this was all achieved with about 1 months work from a point of absolutely zero knowledge about the Cloud and Mobile specific elements of the project â€“ clearly illustrating just how easy this technology is to learn for anyone with a background in software design.</p>
<p>Adam Nagy then presented a project heâ€™s been working on integrating Navisworks into a Cloud AND Mobile environment, taking advantage of the skills that Philippe had developed. Adam managed to build his project in a matter of days! Just having someone close by who could explain some of the details of this technology made the whole process more than easy â€“ it became almost trivial!</p>
<p>Gary Wassell presented the beginners Inventor API track, which attracted a lot of interest from partners wanting to expand their business into Inventor related opportunities. The popularity of the track was very refreshing, the attendees consisted of both seasoned developers wanting to apply their skills to Inventor development, and also engineers really wanting to explore the opportunities presented by a highly customisable product.</p>
<p>Doug Redmond and Jared Sund presented an entire track on Data and Product Life Cycle Management. PLM360 is a new Cloud based technology from Autodesk, and Jared outlined the technology to a room full of partners who were keen to find out what the technology was all about.</p>
<p>Jim Quanci ran a business development track, helping business owners understand how Autodesk behaves as an entity that many people interact with on both a tactical and strategic basis.</p>
<p>My co-author, Brian Ekins, presented a series of Advanced Inventor API classes discussing Cameras, Proxies, Reference Keys and the Apprentice server APIs. Brianâ€™s classes proved popular and as informative as ever!</p>
<p>The day was finished off with a â€˜beer bustâ€™ in the Lake Oswego office, where everyone could chill out, relax, chew over and discuss all of the topics that had been raised during the day.</p>
<p>Day 2 promises to be just as interesting with a Keynote from Buzz Kross, our Manufacturing Senior Vice President, and a continuation of all the classes started on day 1!</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: 3D equivalent of a 2d curve on a surface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 3d-equivalent-of-a-2d-curve-on-a-surface
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Visual Basic for Applications (VBA)
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/3d-equivalent-of-a-2d-curve-on-a-surface.html 
DATE: 06/12/2012 02:31:09 AM
-----
BODY:
<p>The Inventor 2013 API has several new methods for SurfaceEvaluator. One of these new methods allows you to get the equivalent 3D curve for a 2D curve defined in the parametric space of the surface.</p>
<p><strong>New 2013 method:&#0160; </strong></p>
<ul>
<li>SurfaceEvaluator.Get3dCurveFrom2dCurve()</li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production.</p>
<p>To use this example have a part file open and run the code. First it will prompt you to select a face. (The second time the code is run it will prompt to find out if you want to keep the existing client graphics).</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163066d5bce970d-pi"><img alt="image" border="0" height="319" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167676114fc970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="436" /></a></p>
<p>It will then create several curves in the 2d parametric space. Then it gets the equivalent 3D curves, and creates those as client graphics to allow you to view the results. You can see the curves lie on the surface now, but they were originally defined as circle and five lines, but they came back as curves, because the surface is curved.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834017615568f5c970c-pi"><img alt="image" border="0" height="266" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163066d5c18970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="423" /></a></p>
<p>&#0160;</p>
<p><strong>VBA Code:</strong></p>
<p><span style="color: #0000ff;">&#39; Demonstrates the conversion of a 2d parameteric <br />&#39; space curve into the &#39; equivalent 3d model space <br />&#39; curve.&#0160; To use this sample you must have a part <br />&#39; open.&#0160; You can select any face and 3D curves <br />&#39; will be drawn on the face using client graphics</span> <br />Public Sub ParamCurveto3D() <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Have the user select a face whose parametric <br />&#0160;&#0160;&#0160; &#39; space will be used</span> <br />&#0160;&#0160;&#0160; Dim testFace As Face <br />&#0160;&#0160;&#0160; Set testFace = ThisApplication. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CommandManager.Pick _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (kPartFaceFilter, &quot;Select a face&quot;) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the surface evaluator from the face</span> <br />&#0160;&#0160;&#0160; Dim surfEval As SurfaceEvaluator <br />&#0160;&#0160;&#0160; Set surfEval = testFace.Evaluator <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the parametric range of the face</span> <br />&#0160;&#0160;&#0160; Dim paramRange As Box2d <br />&#0160;&#0160;&#0160; Set paramRange = surfEval.ParamRangeRect <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the transient geometry object</span> <br />&#0160;&#0160;&#0160; Dim tg As TransientGeometry <br />&#0160;&#0160;&#0160; Set tg = ThisApplication.TransientGeometry <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the active document.&#0160; This assumes <br />&#0160;&#0160;&#0160; &#39; a part is active <br /></span>&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Create a client graphics object.&#0160; If one <br />&#0160;&#0160;&#0160; &#39; already exists, give the user <br />&#0160;&#0160;&#0160; &#39; the option of re-using it, or creating <br />&#0160;&#0160;&#0160; &#39; a new one. <br /></span>&#0160;&#0160;&#0160; Dim graphics As ClientGraphics <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set graphics = partDoc.ComponentDefinition. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientGraphicsCollection.Item(&quot;Test&quot;) <br />&#0160;&#0160;&#0160; If Err Then <br />&#0160;&#0160;&#0160;&#0160; Set graphics = partDoc.ComponentDefinition. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientGraphicsCollection.Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If MsgBox(&quot;Yes add to existing graphics No = new&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbYesNo + vbQuestion) = vbNo Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; graphics.Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphics = partDoc.ComponentDefinition. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientGraphicsCollection.Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Create a new graphics node. <br /></span>&#0160;&#0160;&#0160; Dim node As GraphicsNode <br />&#0160;&#0160;&#0160; Set node = graphics.AddNode(1)</p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Do a loop that creates 5 lines that go <br />&#0160;&#0160;&#0160; &#39; from the minimum range point to <br />&#0160;&#0160;&#0160; &#39; five points along the maximum u parameter. <br /></span>&#0160;&#0160;&#0160; Dim startPnt As Point2d <br />&#0160;&#0160;&#0160; Set startPnt = paramRange.MinPoint <br />&#0160;&#0160;&#0160; Dim endPnt As Point2d <br />&#0160;&#0160;&#0160; Dim i As Integer <br />&#0160;&#0160;&#0160; For i = 1 To 5 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create the 2d line in parametric space <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set endPnt = tg.CreatePoint2d _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (paramRange.MaxPoint.X, (((paramRange. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MaxPoint.y - paramRange.MinPoint.y) _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; / 4) * (i - 1)) + paramRange.MinPoint.y) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim surfCurve As LineSegment2d <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set surfCurve = tg.CreateLineSegment2d _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startPnt, endPnt) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the equivalent 3d curve in model space</span> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim resultCurve As Object <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set resultCurve = surfEval. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Get3dCurveFrom2dCurve(surfCurve) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create client graphics for this curve <br /></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim crvGraphics As CurveGraphics <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set crvGraphics = node.AddCurveGraphics _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (resultCurve) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; crvGraphics.DepthPriority = 2 <br />&#0160;&#0160;&#0160; Next <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Create a 2d circle in parametric space</span> <br />&#0160;&#0160;&#0160; Dim center As Point2d <br />&#0160;&#0160;&#0160; Set center = tg.CreatePoint2d _ <br />&#0160;&#0160;&#0160;&#0160;&#0160; ((paramRange.MaxPoint.X + paramRange.MinPoint.X) _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; / 2, (paramRange.MaxPoint.y + _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; paramRange.MinPoint.y) / 2) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim radius As Double <br />&#0160;&#0160;&#0160; radius = (paramRange.MaxPoint.X - _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; paramRange.MinPoint.X) * 0.25 <br />&#0160;&#0160;&#0160; Dim paramCircle As Circle2d <br />&#0160;&#0160;&#0160; Set paramCircle = tg.CreateCircle2d(center, radius) <br />&#0160;&#0160;&#0160; <br />&#0160; <span style="color: #0000ff;">&#0160; &#39; Get the equivalent 3d curve in model space</span> <br />&#0160;&#0160;&#0160; Set resultCurve = surfEval. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Get3dCurveFrom2dCurve(paramCircle) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Create client graphics for this curve</span> <br />&#0160;&#0160;&#0160; Set crvGraphics = node.AddCurveGraphics(resultCurve) <br />&#0160;&#0160;&#0160; crvGraphics.DepthPriority = 2 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update <br />&#0160;&#0160;&#0160; ThisApplication.ActiveView.Fit <br />End Sub</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Manufacturing DevCamp next week
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: manufacturing-devcamp-next-week
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/manufacturing-devcamp-next-week.html 
DATE: 06/07/2012 12:17:28 AM
-----
BODY:
<p>I am really excited about DevCamp next Wednesday and Thursday in Portland Oregon. It will be two days of insightful presentations and a great chance to meet other people who are customizing Autodesk manufacturing products.</p>
<p>I am also looking forward to seeing colleagues from different geos&#0160; flying in from Europe to do their presentations. Other teammates are traveling from California and Michigan. I guess I am one of the lucky ones in that I do not have to travel very far to attend. I will be driving from the Seattle area. (~4Hour drive).</p>
<p>The two presentations I have focus on Inventor ETO and are scheduled for Thursday. On Wednesday I will have time to attend a few other sessions. If I could be in many places at once I would attend them all.&#0160;&#0160;&#0160;</p>
<p>There will be keynote presentations starting off each day and at past DevCamps these have been my favorite sessions. It is inspiring to hear about what is being planned for the future of Autodesk Manufacturing.</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: 2012 Inventor API Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: 2012-inventor-api-survey
CATEGORY: Announcements
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/2012-inventor-api-survey.html 
DATE: 06/04/2012 06:52:37 PM
-----
BODY:
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163061d7a67970d-pi"><img alt="Survey" border="0" height="167" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016767111584970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Survey" width="475" /></a></p>
<p>Itâ€™s time again for the annual API survey.&#0160; <span style="text-decoration: underline;">Please</span> help us help you by taking a few minutes and filling out the survey.&#0160; Everyone is welcome to respond.&#0160; Your answers help us to determine what to work on in upcoming releases of Inventor and help us to justify resources to work on API enhancements.&#0160; The more responses we get the more we know people care about the API and the more accurate the results will be so we can work on the areas that will best benefit the majority of those using the API.</p>
<p>In question 5 you can choose up to three items that are important to you.&#0160; If only one or two of those items is important to you then only check those one or two item.&#0160; If you only pick one then your full vote will be for that single item.&#0160; If you pick two or three then it is split between those two or three items.</p>
<p>Hereâ€™s the link to the survey and thank you for help out and taking the time to respond.</p>
<p><a href="http://www.zoomerang.com/Survey/WEB22FVZCJTCQN">http://www.zoomerang.com/Survey/WEB22FVZCJTCQN</a></p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: John Wood
EMAIL: 
IP: 118.103.230.108
URL: http://profile.typepad.com/johnwood2
DATE: 06/19/2012 09:55:54 PM
Informative and interesting survey.
<a href="http://www.surveyreport.com/">http://www.surveyreport.com/</a>

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Extract partial curves from 2d and 3d transient geometry
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extract-partial-curves-from-2d-and-3d-transient-geometry
CATEGORY: Inventor
CATEGORY: Parts
CATEGORY: Visual Basic for Applications (VBA)
CATEGORY: Wayne

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/06/extract-partial-curves-from-2d-and-3d-transient-geometry.html 
DATE: 06/01/2012 06:20:07 PM
-----
BODY:
<p>Another enhancement in the Inventor 2013 API related to transient geometry allows you to get partial curves from splines. You will find two new methods called ExtractPartial and Split on the BSplineCurve and BSplineCurve2d objects. These new methods make it easier to create new curves based on existing curves. Using ExtractPartial you can extract any portion of the curve as a new transient geometry spline. Using Split will get two transient curves from the original.</p>
<p><br /><strong>New 2013 methods used to extract a partial curve from a Spline</strong></p>
<ul>
<li>BSplineCurve.ExtractPartial</li>
<li>BSplineCurve.Split</li>
<li>BSplineCurve2d.ExtractPartial</li>
<li>BSplineCurve2d.Split</li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production.</p>
<p>Note: This example is only using ExtractPartial. (Not Split)</p>
<p>Before running this procedure create a Sketch with a spline. When you run this example it will prompt you to select a â€œ2d&#0160; splineâ€. If you select a spline the selected entity will be a SketchSpline and the BSplineCurve2d is returned from the Geometry property of that object. <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebff553e970c-pi"><img alt="image" border="0" height="380" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebff5564970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="451" /></a></p>
<p>&#0160;</p>
<p>Remember that these methods are creating transient geometry so it is not affecting the real Inventor geometry. This example uses that transient geometry to create real Inventor geometry (3 splines) using Sketch.SketchFixedSplines.Add(). The code deletes the original spline. After running the procedure notice the three new splines:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebff5583970c-pi"><img alt="image" border="0" height="424" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630609fb26970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="462" /></a></p>
<p><strong>VBA Code:</strong></p>
<p><span style="color: #0000ff;">&#39; Demonstrates the ability to extract partial <br />&#39; curves from a transient geometry curve.&#0160; This <br />&#39; sample has you select an existing sketch <br />&#39; spline and extracts three curves from the curve. <br />&#39; It then creates real curves using the extracted <br />&#39; curves and deletes the original sketch curve. <br /></span>Public Sub ExtractPartialCurves2D() <br />&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim spline As Object <br />&#0160;&#0160;&#0160; Set spline = ThisApplication.CommandManager _ <br />&#0160;&#0160;&#0160; .Pick(kSketchCurveSplineFilter, &quot;Select 2d spline&quot;) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the spline geometry from the entity. <br /></span>&#0160;&#0160;&#0160; Dim splineCurve As BSplineCurve2d <br />&#0160;&#0160;&#0160; Set splineCurve = spline.Geometry <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Get the parameter bounds of the curve. <br /></span>&#0160;&#0160;&#0160; Dim startParam As Double <br />&#0160;&#0160;&#0160; Dim endParam As Double <br />&#0160;&#0160;&#0160; Call splineCurve.Evaluator.GetParamExtents _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startParam, endParam) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Extract three curves where they are in <br />&#0160;&#0160;&#0160; &#39; thirds of the original <br />&#0160;&#0160;&#0160; &#39; relative to the curves parameter space. <br /></span>&#0160;&#0160;&#0160; Dim curves(2) As BSplineCurve2d <br />&#0160;&#0160;&#0160; Set curves(0) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startParam, (startParam + endParam) / 3) <br />&#0160;&#0160;&#0160; Set curves(1) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ((startParam + endParam) / 3, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ((startParam + endParam) / 3) * 2) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Set curves(2) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (((startParam + endParam) / 3) * 2, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; endParam) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Create new sketch curves using <br />&#0160;&#0160;&#0160; &#39; the extracted splines. <br /></span>&#0160;&#0160;&#0160; Dim splineSketch As sketch <br />&#0160;&#0160;&#0160; Set splineSketch = spline.Parent <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(0)) <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(1)) <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(2))</p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Delete the original curve. <br /></span>&#0160;&#0160;&#0160; spline.Delete <br />End Sub</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Get strokes for 2d and 3d transient wireframe geometry
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: get-strokes-for-2d-and-3d-transient-wireframe-geometry
CATEGORY: Parts

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/get-strokes-for-2d-and-3d-transient-wireframe-geometry.html 
DATE: 05/31/2012 07:02:27 PM
-----
BODY:
<p>An enhancement in the Inventor 2013 API allows you to get strokes for 2d and 3d transient geometry. One reason why you may want to do this is to approximate sketch geometry. The new method is GetStrokes of the CurveEvaluator and Curve2dEvaluator objects. To get the transient geometry (CurveEvaluator) from the sketch entity, use the Geometry.Evaluator property.</p>
<p><strong>New 2013 method used to get strokes</strong></p>
<ul>
<li>CurveEvaluator.GetStrokes </li>
<li>Curve2dEvaluator.GetStrokes </li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Please keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production.</p>
<p>To try out this example create a 3D Sketch. I used a helical curve as you can see in the screenshot. When you run the Approximate3DSketchGeometry procedure it prompts you to select a 3d entity and then displays an InputBox asking for the chord height tolerance. This value will be used as the maximum of deviation. (How far off can these line segments be to the curve). I used .25. This will be centimeters in database units.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016766f66780970b-pi"><img alt="image" border="0" height="356" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016766f6678b970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="456" /></a></p>
<p>A MsgBox is used to ask if you want to use existing client graphics, create new client graphics or just cancel. The lines that you see that approximate the curve, are drawn using client graphics. Here is the result after running the procedure:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebf7e6a4970c-pi"><img alt="image" border="0" height="277" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163060297ab970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="466" /></a></p>
<p><strong>VBA Code:</strong></p>
<p><span style="background-color: #ffffff;">&#39;<span style="color: #0000ff;"> Draws client graphics that is an approximation <br />&#39; of the selected curve. <br />&#39; To use this have a part open that contains <br />&#39; a 3D skech that contains curves. <br /></span></span>Public Sub Approximate3DSketchGeometry() <br />&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Have the user select a sketch entity. <br /></span>&#0160;&#0160;&#0160; Dim selectObj As SketchEntity3D <br />&#0160;&#0160;&#0160; Set selectObj = ThisApplication. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CommandManager.Pick _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (kSketch3DCurveFilter, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Select 3D sketch entity&quot;) <br />&#0160;&#0160;&#0160; If selectObj Is Nothing Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call partDoc.ComponentDefinition _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .ClientGraphicsCollection.Item _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (&quot;Test&quot;).Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call partDoc.GraphicsDataSetsCollection _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Item(&quot;Test&quot;).Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the tolerance to approximate with. <br /></span>&#0160;&#0160;&#0160; Dim tolerance As Double <br />&#0160;&#0160;&#0160; tolerance = Val(InputBox _ <br />&#0160;&#0160;&#0160;&#0160; (&quot;Enter the chord height tolerance:&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;Tolerance&quot;, &quot;0.25&quot;)) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the evaluator from the curve. <br /></span>&#0160;&#0160;&#0160; Dim eval As CurveEvaluator <br />&#0160;&#0160;&#0160; Set eval = selectObj.Geometry.Evaluator <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the parameter extents. <br /></span>&#0160;&#0160;&#0160; Dim startParam As Double <br />&#0160;&#0160;&#0160; Dim endParam As Double <br />&#0160;&#0160;&#0160; Call eval.GetParamExtents _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startParam, endParam) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim vertexCount As Long <br />&#0160;&#0160;&#0160; Dim vertexCoords() As Double <br />&#0160;&#0160;&#0160; Call eval.GetStrokes(startParam, endParam, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tolerance, vertexCount, vertexCoords) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; &#39; <span style="color: #0000ff;">Create a client graphics object. <br />&#0160;&#0160;&#0160; &#39; If one already exists, give the user <br />&#0160;&#0160;&#0160; &#39; the option of re-using it, or creating <br />&#0160;&#0160;&#0160; &#39; a new one. <br /></span>&#0160;&#0160;&#0160; Dim graphics As ClientGraphics <br />&#0160;&#0160;&#0160; Dim graphicsData As GraphicsDataSets <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set graphics = partDoc.ComponentDefinition. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientGraphicsCollection.Item(&quot;Test&quot;) <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160; If graphics Is Nothing Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphics = partDoc. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160; ComponentDefinition.ClientGraphicsCollection _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphicsData = partDoc. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GraphicsDataSetsCollection.Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160; Else <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim answer As VbMsgBoxResult <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; answer = MsgBox _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (&quot;Yes = existing. No = new Cancel. = quit.&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbYesNoCancel + vbQuestion) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If answer = vbNo Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; graphics.Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; partDoc.GraphicsDataSetsCollection _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Item(&quot;Test&quot;).Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphics = partDoc.ComponentDefinition _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .ClientGraphicsCollection.Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphicsData = partDoc. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GraphicsDataSetsCollection.Add(&quot;Test&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ElseIf answer = vbYes Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set graphicsData = partDoc. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GraphicsDataSetsCollection.Item(&quot;Test&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ElseIf answer = vbCancel Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Not graphics Is Nothing Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; graphics.Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; partDoc.GraphicsDataSetsCollection _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Item(&quot;Test&quot;).Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim coordSet As GraphicsCoordinateSet <br />&#0160;&#0160;&#0160; Set coordSet = graphicsData.CreateCoordinateSet(1) <br />&#0160;&#0160;&#0160; Call coordSet.PutCoordinates(vertexCoords)</p>
<p>&#0160;&#0160; <span style="color: #0000ff;">&#39; Create a graphics node. <br /></span>&#0160;&#0160;&#0160; Dim node As GraphicsNode <br />&#0160;&#0160;&#0160; Set node = graphics.AddNode(1) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Create a line strip using the calculated coordinates.</span> <br />&#0160;&#0160;&#0160; Dim lineStrip As LineStripGraphics <br />&#0160;&#0160;&#0160; Set lineStrip = node.AddLineStripGraphics <br />&#0160;&#0160;&#0160; lineStrip.CoordinateSet = coordSet <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; ThisApplication.ActiveView.Update <br />End Sub</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Transient wire body &ndash; Create ruled surface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: transient-wire-body-create-ruled-surface

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/transient-wire-body-create-ruled-surface.html 
DATE: 05/23/2012 10:24:22 PM
-----
BODY:
<p>Transient B-Rep allows you to define B-Rep data from scratch and one of the enhancements to the Inventor 2013 API allows you to define a new wire body. In the previous release you could only build surfaces and solids. One reason to create a wire body is for input to other modeling operations.</p>
<p><span style="color: #232323;"><strong>New 2013 object, properties and method used to create a wire body ruled surface:</strong></span></p>
<ul>
<li>WireDefinition Object </li>
<li>FaceShellDefinition.WireDefinitions Property </li>
<li>WireDefinition.WireEdgeDefinitions Property </li>
<li>TransientBRep.CreateRuledSurface Method </li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Please keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production).</p>
<p>This example shows how to use this new functionality to create a ruled surface. After running this procedure a NonParametricBaseFeature will be added to the part file.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016766ba11ef970b-pi"><img alt="image" border="0" height="298" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016305c60b91970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="578" /></a></p>
<p><strong>VBA Code:</strong></p>
<p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 9pt;"><span style="color: #0000ff;">&#39; Demonstrate creating a transient ruled surface.      <br />&#39; This sample uses all straight line segments       <br />&#39; for each of the sections.       <br />&#39; A part document must be open.       <br /></span>Public Sub RuledSurf()     <br /> <span style="color: #0000ff;">&#39; Get the transient B-Rep and Geometry objects.</span> <br /> Dim tBRep As TransientBRep     <br /> Set tBRep = ThisApplication.TransientBRep     <br /> <br /> Dim tg As TransientGeometry     <br /> Set tg = ThisApplication.TransientGeometry     <br /> <br /> <span style="color: #0000ff;">&#39; Create a new surface body definition.</span> <br /> Dim bodyDef As SurfaceBodyDefinition     <br /> Set bodyDef = tBRep.CreateSurfaceBodyDefinition     <br /> <br /> &#39;<span style="color: #0000ff;"> Add a lump, shell, and wire.</span> <br /> Dim lumpDef As LumpDefinition     <br /> Set lumpDef = bodyDef.LumpDefinitions.Add     <br /> <br /> Dim shellDef As FaceShellDefinition     <br /> Set shellDef = lumpDef.FaceShellDefinitions.Add     <br /> <br /> Dim wireDef As WireDefinition     <br /> Set wireDef = shellDef.WireDefinitions.Add     <br /> <br /> <span style="color: #0000ff;">&#39; Create coordinate points and use those      <br /> &#39; to create vertex definitions.       <br /></span> Dim pnts(2) As Point     <br /> Set pnts(0) = tg.CreatePoint(0, 0, 0)     <br /> Set pnts(1) = tg.CreatePoint(10, 3, 0)     <br /> Set pnts(2) = tg.CreatePoint(20, 0, 0)     <br /> Dim vertexDefs(2) As VertexDefinition     <br /> Set vertexDefs(0) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(0))     <br /> Set vertexDefs(1) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(1))     <br /> Set vertexDefs(2) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(2))     <br /> <br /> <span style="color: #0000ff;">&#39; Create two wire edges, passing through the      <br /> &#39; three vertices.       <br /></span> Call wireDef.WireEdgeDefinitions.Add _     <br /> (vertexDefs(0), vertexDefs(1), _     <br /> tg.CreateLineSegment(pnts(0), pnts(1)))     <br /> Call wireDef.WireEdgeDefinitions.Add _     <br /> (vertexDefs(1), vertexDefs(2), _     <br /> tg.CreateLineSegment(pnts(1), pnts(2)))     <br /> <br /> <span style="color: #0000ff;">&#39; Create a second wire definition.      <br /></span> Dim wireDef2 As WireDefinition     <br /> Set wireDef2 = shellDef.WireDefinitions.Add     <br /> <br /> <span style="color: #0000ff;">&#39; Create coordinate points and use those to      <br /> &#39; create vertex definitions.       <br /></span> Set pnts(0) = tg.CreatePoint(-5, 0, 10)     <br /> Set pnts(1) = tg.CreatePoint(10, 6, 10)     <br /> Set pnts(2) = tg.CreatePoint(25, 0, 10)     <br /> <br /> Set vertexDefs(0) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(0))     <br /> Set vertexDefs(1) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(1))     <br /> Set vertexDefs(2) = _     <br /> bodyDef.VertexDefinitions.Add(pnts(2))     <br /> <br /> <span style="color: #0000ff;">&#39; Create two edges, passing through the      <br /> &#39; three vertices.       <br /></span> Call wireDef2.WireEdgeDefinitions.Add _     <br /> (vertexDefs(0), vertexDefs(1), _     <br /> tg.CreateLineSegment(pnts(0), pnts(1)))     <br /> Call wireDef2.WireEdgeDefinitions.Add _     <br /> (vertexDefs(1), vertexDefs(2), _     <br /> tg.CreateLineSegment(pnts(1), pnts(2)))     <br /> <br /> <span style="color: #0000ff;">&#39; Create a body using the defined wires.      <br /></span> Dim errors As NameValueMap     <br /> Set errors = ThisApplication.TransientObjects. _     <br /> CreateNameValueMap     <br /> Dim body1 As SurfaceBody     <br /> Set body1 = bodyDef. _     <br /> CreateTransientSurfaceBody(errors)     <br /> <br /> <span style="color: #0000ff;">&#39; Create a ruled surface between the two      <br /> &#39; wire bodies.</span> <br /> Dim ruled As SurfaceBody     <br /> Set ruled = tBRep.CreateRuledSurface _     <br /> (body1.Wires.Item(1), body1.Wires.Item(2))     <br /> <br /> <span style="color: #0000ff;">&#39; Get the part component definition of the      <br /> &#39; active document.       <br /></span> Dim partDoc As PartDocument     <br /> Set partDoc = ThisApplication.ActiveDocument     <br /> Dim partDef As PartComponentDefinition     <br /> Set partDef = partDoc.ComponentDefinition     <br /> <br /> <span style="color: #0000ff;">&#39; Create a base body feature of the      <br /> &#39; transient body.</span> <br /> Dim baseBody As NonParametricBaseFeature     <br /> Set baseBody = _     <br /> partDef.Features. _     <br /> NonParametricBaseFeatures.Add(ruled)     <br /> <br /> <span style="color: #0000ff;">&#39; Change the result work surface so      <br /> &#39; it&#39;s not translucent.       <br /></span> baseBody.SurfaceBodies.Item(1). _     <br /> Parent.Translucent = False     <br /> <br /> ThisApplication.ActiveView.Fit     <br />End Sub</p>
<p>-Wayne</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Manufacturing DevCamp and DevLab
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-manufacturing-devcamp-and-devlab

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/autodesk-manufacturing-devcamp-and-devlab.html 
DATE: 05/21/2012 08:17:47 PM
-----
BODY:
<p>Thereâ€™s less than a month to go till the Autodesk Manufacturing DevCamp being held in Portland June 13-14.&#0160; A highlight for me is the DevLab on the 15th.&#0160; This is an opportunity for you to bring your code and get one-on-one help.&#0160; I hope to see you at DevCamp, DevLab, or both.&#0160; Hereâ€™s the official blurb:</p>
<blockquote>
<p>Whether you are a beginner interested in getting started extending <strong>Inventor, Inventor ETO, PLM 360 or Vault</strong> through their APIs, or an expert developer looking to gain insights directly from Autodesk Engineers and Product Managers, the Manufacturing DevCamp will get you there.&#0160; There are classes for getting started developing Cloud and Mobile apps too!&#0160; Check out the class offering at <strong><a href="http://tinyurl.com/7zdp77p">http://tinyurl.com/7zdp77p</a></strong></p>
</blockquote>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: ADN Manufacturing DevBlog
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adn-manufacturing-devblog
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/adn-manufacturing-devblog.html 
DATE: 05/18/2012 04:15:13 PM
-----
BODY:
<p><a href="http://adndevblog.typepad.com/manufacturing/"><img alt="DevBlog" border="0" height="96" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676695b9b4970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="DevBlog" width="494" /></a></p>
<p>Autodesk has a program to help developers working with Autodesk technology called the Autodesk Developer Network (ADN).&#0160; Members of ADN receive access to software, individual support with their problems, and access to exclusive events each year discussing the new features in the upcoming releases.&#0160; You can read more about ADN <a href="http://www.autodesk.com/developers">here</a>.&#0160; In addition to those benefits, members of ADN have access to a large pool of answers to previous common questions.&#0160;</p>
<p>Good news for everyone else is that theyâ€™ve decided to make these answers open to everyone and have begun transferring them over into a blog format.&#0160; Answers to new questions will also be posted into the blog.&#0160; You can access this blog at: <a href="http://adndevblog.typepad.com/manufacturing/">http://adndevblog.typepad.com/manufacturing/</a>.&#0160; You can quickly access the initial welcome page <a href="http://adndevblog.typepad.com/manufacturing/2012/03/welcome.html">here</a>.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor 2013 SDK and API Help Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: inventor-2013-sdk-and-api-help-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/inventor-2013-sdk-and-api-help-update.html 
DATE: 05/17/2012 07:04:45 PM
-----
BODY:
<p>The SDK and API Help that went out with Inventor 2013 were found to have a few issues that we want to correct.&#160; </p>  <p><strong><font size="3">SDK</font></strong>     <br />The initial SDK that was delivered with Inventor 2013 tried to remain compatible with Visual Studio 2008.&#160; However, to best develop for Inventor 2013 you need to be using Visual Studio 2010.&#160; The Add-In wizards provided as part of the SDK have been updated so they now use Visual Studio 2010.&#160; The primary reason for needing Visual Studio 2010 is that Inventor 2013 is now based on .Net Framework 4.&#160; The interop library for Inventor is built with .Net Framework 4 and to use it your project needs to target .Net Framework 4.</p>  <p>As part of this work to update the wizards we also cleaned up their installation.&#160; In previous releases of Inventor you needed to perform two steps to install the wizards.&#160; First you had to install DeveloperTools.msi to install the various samples and programming tools.&#160; Then you needed to install InventorWizards.msi to install the add-in wizards.&#160; This second step is no longer needed as the wizards are now installed as part of the Developer Tools installation.</p>  <p>To use this update youâ€™ll need to download the new DeveloperTools.msi from <a href="http://www.autodesk.com/developinventor">www.autodesk.com/developinventor</a>.&#160; Itâ€™s about two-thirds of the way down the page, as shown below.&#160; To use the update, follow the directions as outlined in the picture below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb92f974970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DeveloperToolsUpdate" border="0" alt="DeveloperToolsUpdate" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163059d604c970d-pi" width="490" height="532" /></a></p>  <p><strong><font size="3">API Help       <br /></font></strong>Besides updating the SDK, there have also been some fixes made to the API help.&#160; No big enhancements from what was delivered with Inventor 2013 but a lot of smaller fixes and enhancements, including the â€œWhatâ€™s Newâ€ section.&#160; You can download the update from the same location as the SDK, <a href="http://www.autodesk.com/developinventor">www.autodesk.com/developinventor</a>.&#160; Itâ€™s near the top of the page, along with instructions of where to put the file on your system to replace the original help, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163059d6058970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="HelpUpdate" border="0" alt="HelpUpdate" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016766913a81970b-pi" width="490" height="251" /></a>&#160; </p>      <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Pietet
EMAIL: Pieter@mgfx.co.za
IP: 196.210.209.249
URL: http://www.mgfx.co.za
DATE: 05/19/2012 08:38:55 AM
Thanks Brian i am looking forward to start using the new 2013 api!
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 05/23/2012 07:38:05 AM
Brian, we do suffer problems with ColorSchemeEditor (SDK/UserTools). After first its application.
When it is run next time (and on some other actions) the error pops:
Microsoft .NET Framework.
Value of '1280000040' is not valid for 'alpha'. 'alpha' should be greater than or equal to 0 and less than or equal to 255....
Coould it be so that UserTools need to be updated also?
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 05/23/2012 08:00:51 AM
Analysing registry backup I see that decimal symbol used is wrong (point is expected but the comma is used).
Example:
The expected value of "ScreenColor" is 
"0,0.301960,0.592156,1"
Value after CSE first application is
"0,0,3019608,0,5921569,1"


-----
COMMENT:
AUTHOR: Allan C
EMAIL: allan.chalmers@me.com
IP: 124.148.132.11
URL: 
DATE: 05/23/2012 10:04:35 AM
Hi Brian,
Does the developer tools msi work with the Visual Studio 2010 express versions? I have Visual Basic Express 2010 installed and are receiving an error that it is unable to find an install of Visual Studio.
Regards,
Allan
-----
COMMENT:
AUTHOR: Detlef Ballack
EMAIL: detlef.ballack@cideon.com
IP: 95.91.71.159
URL: http://www.cideon-software.com
DATE: 05/23/2012 10:18:56 AM
Hi Brian,

it looks like the inventor_2013_api.zip contains wrong files.

Best regards

Detlef

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 72.52.96.9
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/23/2012 08:54:00 PM
Hi Detlef,

I pulled the zip file and see four files, with the primary files being

Inventor 2013 API.pptx
Inventor2013.ivb

the other two are part files just for convenience in running a couple of the samples.  Are you seeing something else, or problems with this files?

-Brian
-----
COMMENT:
AUTHOR: darlanbecker@yahoo.com.br
EMAIL: darlanbecker@yahoo.com.br
IP: 189.32.19.216
URL: 
DATE: 05/25/2012 01:09:40 AM
Allan, 
You need to install VC++ and VC# too. It worked here.
-----
COMMENT:
AUTHOR: Allan C
EMAIL: nalla@ozemail.com.au
IP: 124.148.132.11
URL: 
DATE: 05/25/2012 07:19:03 AM
Dear darlanbecker,
Many thanks this has fixed my issue and 
allowed me to install the developer tools msi :)
regards
Allan C
-----
COMMENT:
AUTHOR: MaxU77
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 06/01/2012 09:24:19 AM
What about my question (22 May)?

Just in case: OS is Win7 64bit Pro RUSSIAN.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: New Inventor API Help
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: new-inventor-api-help
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/new-inventor-api-help.html 
DATE: 05/16/2012 08:44:32 PM
-----
BODY:
<p>You may have noticed that the Inventor API help has had some issues over the past several releases.&#160; We were using a commercial product for creating the help that didnâ€™t work very well with the type of API that Inventor has.&#160; It forced us to do things in certain ways that werenâ€™t really what we wanted and made it difficult to add some of the features that we wanted.</p>  <p>Inventor 2013 introduces an entirely new help system.&#160; Both the system that generates the help and the result is quite different from what we had before.&#160; I hope you see it as an improvement but would like very much to hear your suggestions on what will make it better.&#160; We are using a new help generation system and no longer have the same limitations.&#160; The new help is shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb8cfe65970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="HelpIntro" border="0" alt="HelpIntro" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167668b38d1970b-pi" width="479" height="312" /></a></p>  <p>The transition from the old to the new help doesnâ€™t come without some hiccups.&#160; The old help system used a proprietary database and the translator that converted it into the new help wasnâ€™t 100% accurate.&#160; Weâ€™ve identified and fixed many of the issues but Iâ€™m sure there are still a lot more out there.&#160; With over 21,500 help topics itâ€™s difficult to check every one.&#160; At the bottom of every topic youâ€™ll see the link shown below and as you notice any problems or have any suggestions on improving the help please feel free to use it.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016305976753970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="HelpComment" border="0" alt="HelpComment" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016305976762970d-pi" width="240" height="104" /></a></p>  <p>One feature that was in the previous help and is missing in the new help is the index.&#160; Itâ€™s missing because we ran out of time before the release was due.&#160; Plan on seeing the index return in the future.&#160; Even though the index is missing, the search capability does work and will find things the index wonâ€™t.&#160; There were a few other things that we ran out of time on too, so there are plans for future improvements but I would like to hear your ideas too.</p>  <p>I think one big improvement over the previous help is how the code samples are presented.&#160; Any topic thatâ€™s demonstrated in any of the samples now has a <strong>Samples</strong> section in the topic that lists the samples along with links to each one.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630597676e970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="HelpLink" border="0" alt="HelpLink" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb8cfe86970c-pi" width="479" height="361" /></a></p>  <p>&#160;</p>  <p>The samples are no longer included in the contents of the various object, method, or property topics but are topics by themselves.&#160; This allows them to be categorized and supports the linking as shown above.&#160; I think the current categorization needs some work so please let me know if you have any suggestions.&#160; The new help system also now supports samples in multiple languages and itâ€™s easy for us to find out which topics donâ€™t have samples so we can concentrate on adding samples to demonstrate more functionality.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016305976779970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="HelpSamples" border="0" alt="HelpSamples" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016305976780970d-pi" width="479" height="309" /></a></p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Pieter
EMAIL: pieter@mgfx.co.za
IP: 196.210.209.249
URL: http://www.mgfx.co.za
DATE: 05/19/2012 04:14:50 PM
Thanks for the great work guys! I look forward to all your new topics all the time!!!

Pieter
www.mgfx.co.za
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating Geometric Constraints in a Sketch
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-geometric-constraints-in-a-sketch
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/creating-geometric-constraints-in-a-sketch.html 
DATE: 05/12/2012 12:22:21 AM
-----
BODY:
<p>In the <a href="http://modthemachine.typepad.com/my_weblog/2012/04/drawing-in-a-sketch.html">previous post</a> in this series I discussed creating sketch geometry.&#160; The last post ended by showing how to create lines and arcs that define the shape of a slot.&#160; It also illustrated that the lines and arcs didnâ€™t behave quite like expected because of missing constraints.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167666f844e970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="ModifiedSlotResult" border="0" alt="ModifiedSlotResult" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167666f8451970b-pi" width="346" height="167" /></a></p>  <p>In this post weâ€™ll look at how to create geometric sketch constraints using the API. There are two types of sketch constraints; geometric and dimension.&#160; Iâ€™ll focus on geometric constraints for this post.</p>  <p>Geometric sketch constraints are used extensively within Inventor, probably in more ways than you would initially think.&#160; Below is a portion of the sketch ribbon, where Iâ€™ve highlighted the commands you typically think of as the geometric constraint commands.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb029970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SketchConstraintCommands" border="0" alt="SketchConstraintCommands" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb716519970c-pi" width="479" height="94" /></a></p>  <p>&#160;</p>  <p>These constraints define the behavior of sketch geometry.&#160; There are two types of geometric constraints; those that act on a single geometric entity and those that define some type of relationship between two geometric entities.&#160; For example, the Fix (Ground), Horizontal, and Vertical constraints act on a single entity, whereas all of the others control two entities.</p>  <p>All of these are quite easy to use through the API.&#160; The diagram below shows the object model for 2d sketch geometric constraints.&#160; Youâ€™ve already learned from the previous posts how to access a sketch through the API.&#160; The SketchLines and SketchArcs collections on the Sketch were used to drawing the slot geometry.&#160; Now youâ€™ll use the GeometricConstraints collection to add the needed geometric constraints.&#160; Unlike the sketch geometry where there was a unique collection for each type of geometry, for geometric constraints there is a single collection for all of the constraint types.&#160; The GeometricConstraints collections supports many Add methods to allow the creation of each of the types of constraints.&#160; Itâ€™s also through this collection where you can access existing constraints.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb032970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="GeomConstraintsObjectModel" border="0" alt="GeomConstraintsObjectModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb03e970d-pi" width="475" height="323" /></a></p>  <p>Below is the program from the last post that creates the slot shape.&#160; The new portion of code at the bottom, highlighted in yellow, creates the constraints.&#160; You can see that it uses the variables that reference geometry created earlier in the program.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Get a reference to the SketchPoints collection.</font></strong>     <br />Dim points As Inventor.SketchPoints = sketch.SketchPoints     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchLines collection.        <br /></strong></font>Dim lines As Inventor.SketchLines = sketch.SketchLines     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchArcs collection.</strong></font>     <br />Dim arcs As Inventor.SketchArcs = sketch.SketchArcs     <br />    <br /><font color="#0000ff"><strong>' Create the sketch points.</strong></font>     <br />Dim pointArray(5) As Inventor.SketchPoint     <br />pointArray(0) = points.Add(tg.CreatePoint2d(0, 1), False)     <br />pointArray(1) = points.Add(tg.CreatePoint2d(0, 0), False)     <br />pointArray(2) = points.Add(tg.CreatePoint2d(0, -1), False)     <br />pointArray(3) = points.Add(tg.CreatePoint2d(4, -1), False)     <br />pointArray(4) = points.Add(tg.CreatePoint2d(4, 0), False)     <br />pointArray(5) = points.Add(tg.CreatePoint2d(4, 1), False)     <br />    <br /><font color="#0000ff"><strong>' Draw the geometry.</strong></font>     <br />Dim arc1 As Inventor.SketchArc     <br />arc1 = arcs.AddByCenterStartEndPoint(pointArray(1), pointArray(0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(2))     <br />    <br />Dim line1 As Inventor.SketchLine     <br />line1 = lines.AddByTwoPoints(pointArray(2), pointArray(3))     <br />    <br />Dim arc2 As Inventor.SketchArc     <br />arc2 = arcs.AddByCenterStartEndPoint(pointArray(4), pointArray(3), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(5))     <br />    <br />Dim line2 As Inventor.SketchLine     <br />line2 = lines.AddByTwoPoints(pointArray(5), pointArray(0))    <br /><span style="background: #eeee00">     <br /><font color="#0000ff"><strong>' Get a reference to the GeometricConstraints collection.         <br /></strong></font>Dim geomConstraints As Inventor.GeometricConstraints       <br />geomConstraints = sketch.GeometricConstraints       <br />      <br /><font color="#0000ff"><strong>' Create the four tangent constraints.</strong></font>       <br />geomConstraints.AddTangent(arc1, line1)       <br />geomConstraints.AddTangent(line1, arc2)       <br />geomConstraints.AddTangent(arc2, line2)       <br />geomConstraints.AddTangent(line2, arc1)       <br />      <br /><font color="#0000ff"><strong>' Create a parallel constraint.</strong></font>       <br />geomConstraints.AddParallel(line1, line2)       <br />      <br /><font color="#0000ff"><strong>' Create a horizontal constraint.</strong></font>       <br />geomConstraints.AddHorizontal(line1)       <br /></span></p>  <p>Creating any of the other types of constraints is similar to the above with the difference being the add method thatâ€™s used. The API help is a great resource to help in understanding the various add methods of the GeometricConstraints object.</p>  <p>I mentioned earlier that geometric constraints are used by Inventor in more ways than most people think.&#160; In addition to the typical geometric constraints as discussed above, there are several other geometry creation commands that result in the creation of geometric constraints.&#160; For example, when you create an offset, new geometry is created and Inventor creates constraints between the original geometry and the new geometry so the new geometry behaves as an offset.&#160; You can delete the constraint to remove the offset behavior.&#160; The picture below shows a simple sketch.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb048970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints1" border="0" alt="GeomConstraints1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb716538970c-pi" width="475" height="293" /></a></p>  <p>Below is the same sketch after offsetting the outside profile and creating a rectangular pattern of the circle.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb054970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints2" border="0" alt="GeomConstraints2" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167666f8466970b-pi" width="475" height="294" /></a></p>  <p>Finally, the picture below shows the constraint symbols turned on so you can see all of the constraints that were created automatically as a result of the previous operations.&#160; The API provides query access to all of these constraints through the GeometricConstraints collection.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb716546970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints3" border="0" alt="GeomConstraints3" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb065970d-pi" width="475" height="300" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Sheet Metal Extents Add-In Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: sheet-metal-extents-add-in-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/sheet-metal-extents-add-in-update.html 
DATE: 05/09/2012 11:33:36 PM
-----
BODY:
<p><strong>See the <a href="http://modthemachine.typepad.com/my_weblog/2015/03/latest-update-to-sheet-metal-extents-add-in.html" target="_self" title="latest update">latest update</a> for this posted&#0160;on March 20, 2015.</strong></p>
<p>Several years ago I wrote an add-in that creates parameters and iProperties whose values are the length and width of the sheet metal flat pattern.&#0160; If the model is updated, the values are also automatically updated to reflect the change.&#0160; I havenâ€™t touched the add-in for a few years but a problem was recently reported that was the result of a change in the API to handle the new Text and Yes/No types of parameters.&#0160; Since the source code was delivered with the add-in, several of you had already found the problem and fixed it.&#0160; Iâ€™ve made the change now to fix this and have also updated it to take advantage of some new add-in functionality.</p>
<p><span style="text-decoration: underline;">This version of the add-in is specific to Inventor 2013 and later</span> because Iâ€™m taking advantage of a feature that was introduced with Inventor 2013.&#0160; Iâ€™ve also upgraded the project to Visual Studio 2010 and .Net 4, which is what is recommended for Inventor 2013.&#0160; One of the biggest changes was to change this from a registered add-in to registry-free.&#0160; This makes it simpler to deploy and is the recommended way of deploying an add-in since Inventor 2012.&#0160;</p>
<p>Below are three different zips.&#0160; The first two contain the runtime for the add-in but provide two different ways of deploying it.&#0160; You can pick whichever will work the best in your situation.&#0160; The third zip is the source code for the add-in.</p>
<p>&#0160;</p>
<p><strong>Installer</strong> â€“ This zip file contains an installer that when run will install the add-in.&#0160; You can uninstall the add-in using the Windows Control Panel.&#0160; Installation of the add-in no longer requires Administrator rights.</p>
<blockquote>
<p><a href="http://modthemachine.typepad.com/SheetMetalExtentsInstall.zip"><img alt="zip[9]" border="0" height="16" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb5fa693970c-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="zip[9]" width="16" /></a>&#0160;<a href="http://modthemachine.typepad.com/SheetMetalExtentsInstall.zip">SheetMetalExtentsInstall.zip</a> (433 Kb)</p>
</blockquote>
<p>&#0160;</p>
<p>&#0160;</p>
<p><strong>Drag &amp; Drop Deployment</strong> â€“ This zip file contains a directory containing the add-in dll, a .addin file and the readme file.&#0160; Because the add-in is now registry-free, you can install the add-in by simply copying these files into the correct location on your computer (Drag &amp; Drop Deployment).&#0160; Uninstall is just a matter of deleting the directory.&#0160; To â€œinstallâ€ the add-in using these files copy the â€œSheetMetalExtentsâ€ directory from the zip file into:</p>
<p>&#0160;&#0160; <span style="font-family: Courier New;">%APPDATA%\Autodesk\ApplicationPlugins</span></p>
<p>The â€œ%APPDATA%â€ portion of the path uses an environment variable that will resolve to your Roaming directory.&#0160; On my machine it ends up using the path of:</p>
<p>&#0160;&#0160; <span style="font-family: Courier New;">C:\Users\ekinsb\AppData\Roaming\Autodesk\ApplicationPlugins</span></p>
<blockquote>
<p><a href="http://modthemachine.typepad.com/SheetMetalExtents.zip"><img alt="zip[10]" border="0" height="16" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630569bc57970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="zip[10]" width="16" /></a>&#0160;<a href="http://modthemachine.typepad.com/SheetMetalExtents.zip">SheetMetalExtents.zip</a> (8 Kb)</p>
</blockquote>
<p>&#0160;</p>
<p>&#0160;</p>
<p><strong>Source Code</strong> â€“ This zip file contains the source code for the add-in.</p>
<blockquote><a href="http://modthemachine.typepad.com/SheetMetalExtentsSource.zip"><img alt="zip[11]" border="0" height="16" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630569bc9a970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="zip[11]" width="16" /></a>&#0160;<a href="http://modthemachine.typepad.com/SheetMetalExtentsSource.zip">SheetMetalExtentsSource.zip</a> (9 Kb)</blockquote>
<p>&#0160;</p>
<p>Please let me know if you find any issues with the program or have suggestions to improve it.</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Paul
EMAIL: Paul@Cadsetterout.com
IP: 217.155.18.238
URL: http://cadsetterout.com/guest-posts/expanding-the-autocad-ws-dojo-the-kung-fu-drafter/
DATE: 05/11/2012 08:48:55 AM
Hi Brian,

It's great to see that you've taken the time to update this add in. I use it extensively, it's a very useful tool.

My only bug bear is that It occasionally gives an error, but it doesn't tell me which part the error was in.

There is also no way to turn the error off. This can be very frustrating if the error crops up a lot of times in a large assembly - lots of button clicks to clear the errors before you can go looking for the cause.

In the meantime, keep up the good work with 'Mod the machine'.

Paul.


-----
COMMENT:
AUTHOR: Denis
EMAIL: madalenix9@hotmail.com
IP: 213.97.184.37
URL: 
DATE: 05/11/2012 10:10:12 AM
Hello,

I have some questions:

â€¢Can I load an Inventor File with C#?
â€¢Can I load an Inventor File with C# without Inventor Installled in my computer?
I have an Inventor File with a mechanical piece that move in his 3 axes, can I make a C# application where I insert some values and the application modify the inventor file and then view this "modified" mechanical piece on C#?( All this without Inventor installed on my computer)

 
(I Post a comment here because I don't know where I can ask you about this)
Thank you very much.

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 50.53.105.90
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/11/2012 04:21:30 PM
Hi Paul,

If you run into things like this please let me know.  I did add some more error handling with this release where it should gracefully fail without any dialogs.  There may be some room for improvement there in the future.

-Brian
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 50.53.105.90
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/11/2012 04:22:30 PM
It's not possible to manipulate an Inventor model without having Inventor.  The Inventor API can be used from C# but without Inventor you don't have access to the API.
-----
COMMENT:
AUTHOR: Fulvio
EMAIL: fuvio81@hotmail.it
IP: 188.218.50.99
URL: 
DATE: 05/18/2012 12:18:30 AM
Hi Brian,
 it's a very useful tool and all my colleagues like it.
I created a sheetmetal iPartFactory with 3 rows for example. When i put it with the different MemberName in an assembly, i realized that the relative drawing with the partlist was not update. Please can you help iProperties in each file generated from the iPart to be update?
Thank you very much.

-----
COMMENT:
AUTHOR: Brendan H
EMAIL: brendan.henderson@augers.com.au
IP: 115.64.119.122
URL: 
DATE: 06/28/2012 03:14:47 AM
Brian, I'm using your original add-in with 2012. Occasionally (usually when changing the part sketch) I get the following error "Unexpected error while updating the property values with the sheet metal extents. The results should not ne used." Any idea's as to how this can be overcome? I'll be upgrading to 2013 in the first quarter of next year so your updated version might fix this). I have only seen this error since upgrading from 2011 to 2012 PDS.
-----
COMMENT:
AUTHOR: Carlos
EMAIL: lastrillaca@yahoo.com
IP: 203.59.98.3
URL: 
DATE: 06/29/2012 07:17:41 AM
Hi Brian,

I assume this even if this is a registry-free version, it will still add an entry in the Add-ins dialog box (Tools > Options > Add-Ins)?

I cant seem to get it to work, as no entry appears in my Add-In (even after clicking Show hidden members), either through the installer, or drag and drop method.

I'm using Inventor 2013 from Factory Design Suite.

Any other checks I can do to make sure it loads? Any re-registration needed?

Thanks!


-----
COMMENT:
AUTHOR: omar
EMAIL: omar.martin@iko.com
IP: 204.101.159.34
URL: http://www.iko.com
DATE: 07/03/2012 02:33:30 PM
Hi, I cant get it to work either I am on 2013, never tried the 2012 version...probaly user error not sure of the steps to get it to work:

I just ran the installer, checked the %app% all the files got copied there.

but there is no entry in my add-ins manager.

I tried to add the variables manually and they are blank.

Any help is appreciated

Thanks
-----
COMMENT:
AUTHOR: Rob Veer
EMAIL: rob.veer@vancouver.ca
IP: 199.175.219.1
URL: 
DATE: 07/03/2012 09:54:30 PM
Hi Brian,

Use your addin all the time - still on 2011.  I know why I sometimes get an error and it has to do with some code in some legacy parts or a hole in a sheetmetal part.  The only additional thing I would add to the error handling is some indication of what part the error is referring to if possible: "Unexpected error while updating the property values with the sheet metal extents. The results should not ne used for part XYZ.ipt" 

Thanks,

Rob
-----
COMMENT:
AUTHOR: Carlo
EMAIL: clast14@yahoo.com
IP: 203.59.98.3
URL: 
DATE: 07/06/2012 09:22:24 AM
What I eventually ended up doing was to use Mike's install_64.bat found in his post # 61 here:

<a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Sheet-Metal-Extents/td-p/1885434/page/7">http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Sheet-Metal-Extents/td-p/1885434/page/7</a>

Its inside the zip file. I placed this in the same folder where the SheetMetalExtents.dll is located, ran it, and now it appears in the Add-in Manager



-----
COMMENT:
AUTHOR: Kirk
EMAIL: karthur@fmi-solutions.com
IP: 12.236.116.18
URL: 
DATE: 08/01/2012 11:13:34 PM
I also tried to use the "SheetMetalExtentsInstall" thats posted above.  The program shows up on my "Programs and features" as version 3.0, but it is not listed under Inventor 2013 Add-ins and it doesnt work in 2013.  I also tried adding the code in the second zip to the %appdata% folder, but that didnt work either.
-----
COMMENT:
AUTHOR: Kirk
EMAIL: karthur@fmi-solutions.com
IP: 12.236.116.18
URL: 
DATE: 10/25/2012 07:20:12 PM
I am also seeing the "Unexpected Error while updating the property values....". This happens if I edit the sketch of my part.  When I exit the sketch and the model updates, it gives me this error and the parameters do not update.  I am using Inventor 2013, SP1.1
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Thumbnail Viewer Component on a 64-Bit System
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: thumbnail-viewer-component-on-a-64-bit-system
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/05/thumbnail-viewer-component-on-a-64-bit-system.html 
DATE: 05/03/2012 10:12:11 PM
-----
BODY:
<p>In a <a href="http://modthemachine.typepad.com/my_weblog/2010/06/accessing-thumbnail-images.html">previous post</a> I discussed several way to access the thumbnail image thatâ€™s associated with each document.&#160; One of these ways is to use the ThumbnailView component.&#160; I received a question recently regarding the ThumbnailView component not working as expected.&#160; After quite a bit of digging and some testing I believe I know what the problem is and how to fix it.</p>  <p><strong><font color="#0000ff">I believe this an issue only if youâ€™re using .Net (VB or C#) and are using 64-bit Windows.</font></strong>&#160; I donâ€™t think there are problems with any other configurations but if there are, please let me know.</p>  <p><strong><font size="3">COM and .Net on a 64-Bit OS Overview</font></strong>     <br />Before I describe the solution, I think it might be worth taking a minute to describe whatâ€™s happening when you use a COM component (the thumbnail view component in this case) from .Net program on a 64-bit system.&#160; The picture below attempts to show all of the various pieces that need to play together to get this work.&#160; First, is the COM component itself.&#160; The thumbnail viewer was created using C++ and the resulting dll is compiled for either 32 or 64-bit.&#160; On a 32-bit system you can only use 32-bit components.&#160; On a 64-bit system you can use either 32 or 64-bit components because 64-bit windows supports an emulator that is able to run 32-bit applications.&#160; COM dll components run within the process of the program using it and a 32-bit component can only run within a 32-bit process and a 64-bit component can only run within a 64-bit process. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016766153837970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="64BitCOMComponent" border="0" alt="64BitCOMComponent" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676615383e970b-pi" width="403" height="314" /></a></p>  <p>The registry is used because COM components can be located anywhere on a computer but other programs need to be able to know theyâ€™re available and where theyâ€™re located.&#160; The components make themselves known by adding information to the registry.&#160; There are separate areas in the registry where 32-bit and 64-bit components register themselves.</p>  <p>Another piece that makes the 32-bit vs. 64-bit issue described above even more confusing is that when writing a .Net program you can specify that the runtime will be compatible with 32-bit (x86), 64-bit (x64), or â€œAny CPUâ€ (both 32 and 64-bit).&#160; The â€œAny CPUâ€ option is the interesting, and confusing, option.&#160; Itâ€™s the option I almost always use.&#160; The reason that .Net can support the â€œAny CPUâ€ option is that when you compile your program, .Net compiles your program into MSIL (Microsoft Intermediate Language) which is a CPU independent set of instructions.&#160; When your program is run, it is converted by the JIT (Just-In-Time) compiler into native code. This means that even if your program was compiled for â€œAny CPUâ€, when it runs it will actually be running as a native 32-bit or 64-bit application.</p>  <p>Because the COM component runs in-process to your application it must match the bitness of the running application.&#160; For example, if you compile your application for â€œAny CPUâ€ and run your program on a 64-bit machine, the .Net Framework will run it as a true 64-bit application and the 64-bit version of the thumbnail viewer will be required.&#160; If you compile your application for 32-bit and run it on a 64-bit machine, it will run as a 32-bit app and will require the 32-bit version of the thumbnail viewer.&#160; If the correct version of the COM component isnâ€™t available, it will fail to run.</p>  <p>In addition to your program and the COM component, there is one other piece needed when using a COM component with .Net; an <em>Interop</em> assembly.&#160; Your .Net program canâ€™t directly call a COM component.&#160; To provide support for COM, .Net uses the concept of Interop assemblies which are .Net components that provide a .Net interface to a COM component.&#160; When you use the COM component, your program is actually calling functions in the interop assembly, which translates those calls and makes the equivalent call in the COM component.&#160; The Interop serves as a wrapper for the COM component making it compatible with .Net.&#160; These interop assemblies are dllâ€™s and can also be created for 64-bit, 32-bit, or <em>agnostic</em> (equivalent to â€œAny CPUâ€).&#160; But like the component, it must also match the bitness of the program it will be running within.</p>  <p>In summary, there are three runtime pieces; the COM component, the .Net Interop, and your program.&#160; If youâ€™re running on a 32-bit system, all of them must be 32-bit.&#160; If youâ€™re running on a 64-bit system you can run either 32-bit or 64-bit but all of the pieces must be 32-bit or 64-bit.&#160; You canâ€™t mix and match the bitness.</p>  <p><strong><font size="3">The Problem        <br /></font></strong>When programming with .Net and using a COM component, itâ€™s somewhat transparent that there is an interop assembly involved.&#160; When you reference the COM component into your project, Visual Studio automatically creates the interop behind the scenes.&#160; The problem is that itâ€™s creating a 32-bit compatible interop.&#160; If youâ€™re creating a 32-bit application, then everything is fine, but for a 64-bit application itâ€™s not going to work.</p>  <p>I found the problem by doing some research on the web and discovering <a href="http://connect.microsoft.com/VisualStudio/feedback/details/711406/tlbimp-error-since-vs2010-a-single-valid-machine-type-compatible-with-the-input-type-library-must-be-specified">this article</a> on a Microsoft support site that gave me the clue I needed.&#160; It also indicates that this is fixed in VS 11.</p>  <p><font size="3"><strong>The Fix        <br /></strong></font>Hereâ€™s the fix that Iâ€™m using to get this to work.&#160; You need to manually create the interop for the thumbnail viewer component.&#160; By manually creating it, you can specify the machine type that itâ€™s compatible with.&#160; In this case either â€œx64â€ or â€œAgnosticâ€ will work because at runtime on an x64 machine they will both result in true X64 machine code.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">TlbImp.exe InventorThumbnailView.dll    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /machine:Agnostic&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /namespace:InventorThumbnailViewLib     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; /out:Interop.InventorThumbnailView.dll</p>  <p>Hereâ€™s a <a href="http://modthemachine.typepad.com/CreateInteropCommandLine.txt">link to a text file</a> that has the complete command line, with the full paths, so you can just copy and past this into a DOS command window.&#160; You will need to edit the path for the output interop dll to where your project is.</p>  <p>Once youâ€™ve created the interop, Use the References command in Visual Studio to reference it into your project.&#160; Use the Browse tab on the References dialog so you can browse and select the interop dll.&#160; Youâ€™ll reference this instead of the InventorThumbNailView.dll file.&#160; Now it should all work.&#160; </p>  <p>Below is some code from a very simple Windows Forms project that I created.&#160; After creating the new project, I added a picture box control (with the SizeMode property set to â€œStretchImageâ€) and a button to the dialog.&#160; I also added an open file dialog.&#160; Finally, I added a reference to the .Net component â€œstdoleâ€.&#160; Below is the code thatâ€™s contained within the Click event of the button.&#160; It uses the file dialog to get the filename of an Inventor file, uses the thumbnail view component to get the thumbnail from the Inventor file and then displays it.&#160; The component returns the image as an IPictureDisp object.&#160; Next, it converts this object to a .Net Image object, which it finally assigns to the picture box.&#160; See below for some more discussion about this conversion process.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Code in the button Click event.</font></strong>     <br />With OpenFileDialog1     <br />&#160;&#160;&#160; .Filter = &quot;Inventor Files (*.ipt;*.iam;*.idw)|*.ipt;*.iam;*.idw&quot;     <br />&#160;&#160;&#160; If .ShowDialog() = System.Windows.Forms.DialogResult.OK Then     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Create an instance of the thumbnail viewer component.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim thumbviewer As New _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InventorThumbnailViewLib.ThumbnailProvider     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Use the component to get the thumbnail.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim pic As stdole.IPictureDisp = Nothing     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim handle As Long = 0     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Use workaround to make sure handle is a positive number.        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Otherwise the call to PictureDispToImage will fail.         <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Do     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pic = thumbviewer.GetThumbnail(.FileName)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; handle = pic.Handle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Loop While handle &lt; 0     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Convert the IPictureDisp into an Image to&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' display it in the picture box.         <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim img As Image = AxHostConverter.PictureDispToImage(pic)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; PictureBox1.Image = img     <br />&#160;&#160;&#160; End If     <br />End With     <br /></p>  <p>The object that represents a bitmap image in COM is an IPictureDisp object, (which is defined in the stdole library).&#160; .Net represents a bitmap image using the Image object.&#160; This means there needs to be a conversion from an IPictureDisp objet to an Image object to be able to use the returned bitmap in .Net.&#160; There is a Visual Basic compatibility library that contains routines to do this.&#160; Unfortunately, if you use them with .Net 4, youâ€™ll get a warning message that these functions are obsolete and are only supported on 32-bit.&#160; You can read more here: <a title="http://go.microsoft.com/fwlink/?linkid=160862" href="http://go.microsoft.com/fwlink/?linkid=160862">http://go.microsoft.com/fwlink/?linkid=160862</a>.</p>  <p>To avoid these warnings and possible problems in the future youâ€™ll need to use something else.&#160; Unfortunately, Microsoft hasnâ€™t provided a simple alternative.&#160; Below is a class that exposes some functions to do this conversion from one type to the other.&#160; I wraps some internal functionality on another Microsoft class to it can be used in a general way.&#160; To use it in your project, just copy the class below into your project.&#160; The PictureDispToImage function defined in this AxHostConverter class is used in the code above.</p>  <p>Thereâ€™s also some funny code in the example above thatâ€™s a workaround to a problem I found while testing.&#160; When testing, it would periodically fail to do the conversion.&#160; The failure seemed random with a â€œA generic error occurred in GDI+â€ failure.&#160; I accidentally discovered that the failure was occurring whenever the Windows handle being provided by the IPictureDisp object was negative.&#160; The workaround I put in the code above keeps getting an new IPictureDisp until the handle is a positive number.&#160; I stress tested this through several thousand iterations and the most it ever looped to get a positive number was 10, so I think the chance of this being an endless loop is too small to worry about.&#160; About 85% the first return is positive, another 10% took two calls, and the remaining 5% is 3 or more calls.&#160; I believe the cause of this problem is that the number is actually an unsigned int, but itâ€™s being treated as a regular int which results in a negative number for large numbers.&#160; Anyway, this seems to work around the problem.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Utility class that provides support for converting between       <br /><strong><font color="#0000ff">' IPictureDisp and Image objects.</font></strong></font></strong>    <br />Friend Class AxHostConverter     <br />&#160;&#160;&#160; Inherits AxHost     <br />    <br />&#160;&#160;&#160; Private Sub New()     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MyBase.New(&quot;&quot;)     <br />&#160;&#160;&#160; End Sub     <br />    <br />&#160;&#160;&#160; Public Shared Function ImageToPictureDisp( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal objImage As Image) As stdole.IPictureDisp     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return DirectCast(GetIPictureDispFromPicture(objImage), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; stdole.IPictureDisp)     <br />&#160;&#160;&#160; End Function     <br />    <br />&#160;&#160;&#160; Public Shared Function PictureDispToImage( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal pictureDisp As stdole.IPictureDisp) As Image     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim objPicture As System.Drawing.Image     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; objPicture = CType(GetPictureFromIPicture(pictureDisp), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Drawing.Image)     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return objPicture     <br />&#160;&#160;&#160; End Function     <br />End Class</p> One final thing to remember is that youâ€™ll need to deliver the interop with your program.&#160; Your program has two dependencies which youâ€™ll need to deliver in addition to your exe; the thumbnail view component, (which also needs to be registered), and the interop dll.
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: filat
EMAIL: filat18@yahoo.com
IP: 85.90.193.241
URL: 
DATE: 05/10/2012 08:22:40 AM
When using the method proposed in this article, I was able to get Preview. But the problem is that there Preview horizontal stripes! Why are horizontal bands show up at the Preview?
[URL=<a href="http://radikal.ru/F/s61.radikal.ru/i173/1205/05/c8abe8bfcb96.jpg.html][IMG]http://s61.radikal.ru/i173/1205/05/c8abe8bfcb96t.jpg[/IMG][/URL]">http://radikal.ru/F/s61.radikal.ru/i173/1205/05/c8abe8bfcb96.jpg.html][IMG]http://s61.radikal.ru/i173/1205/05/c8abe8bfcb96t.jpg[/IMG][/URL]</a>
-----
COMMENT:
AUTHOR: filat
EMAIL: filat18@yahoo.com
IP: 85.90.193.241
URL: 
DATE: 05/10/2012 08:24:54 AM
Scine <a href="http://s61.radikal.ru/i173/1205/05/c8abe8bfcb96.jpg">http://s61.radikal.ru/i173/1205/05/c8abe8bfcb96.jpg</a>
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Drawing in a Sketch
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: drawing-in-a-sketch
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/drawing-in-a-sketch.html 
DATE: 04/27/2012 08:57:08 PM
-----
BODY:
<p>This is a continuation of the <a href="http://modthemachine.typepad.com/my_weblog/getting-started-tutorial/">getting started tutorial</a> thatâ€™s discussing the creation of a new command to draw a slot.&#160; In this installment I discuss drawing geometry in a sketch.</p>  <p>When creating sketch geometry using the API, there are a couple of concepts that are important to understand that arenâ€™t very obvious when you create sketches interactively.&#160; Letâ€™s look at what you really have when you draw two lines in a sketch.&#160; You can see from the picture below it just looks like two lines and nothing else.</p>  <p>&#160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b8e7970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="Lines" border="0" alt="Lines" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b8ee970c-pi" width="339" height="248" /></a></p>  <p>If you know what to look for, youâ€™ll also notice something else.&#160; If you move the mouse over the end of the lines, a point is displayed, as shown below.&#160; At first you might think this is just a handle being displayed to indicate that you can drag the end of the line.&#160; Itâ€™s not a handle, itâ€™s a real sketch point thatâ€™s being displayed.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304db28eb970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="LinesWithPoint" border="0" alt="LinesWithPoint" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b8fc970c-pi" width="347" height="272" /></a></p>  <p>In fact, to better see these are real points you can select a point and using the context menu, change the display style of the point to a center point.&#160; With this display style it remains visible all the time and not just when the cursor is over it.&#160; The picture below shows all three of the points being displayed with a center point style.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016765ce49e8970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="LineWithCenterPoint" border="0" alt="LineWithCenterPoint" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304db28fc970d-pi" width="346" height="273" /></a></p>  <p>The thing to learn from this is that all sketch geometry is <u>always</u> associated to&#160; sketch points.&#160; Sketch geometry doesnâ€™t exist on its own.&#160; The position of sketch geometry is controlled by the position of the points.&#160; Itâ€™s like the geometry is fastened to the points and if the points move the geometry attached to them also moves.&#160; </p>  <p>Another very important concept is that the two lines are connected by the fact that they share the same point.&#160; Both lines are attached to the same point.&#160; Thatâ€™s how Inventor determines connected curves in a profile.&#160; Weâ€™ll see an example of this later in this post.</p>  <p>Below is a picture of the two lines after placing a fillet.&#160; The geometry consists of two lines and an arc.&#160; The position of each of the lines is still defined by two sketch points and the arc shares the sketch points where it connects to the lines.&#160; In addition, the arc has an additional sketch point that defines its center.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b90b970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="LinesWithFillet" border="0" alt="LinesWithFillet" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b913970c-pi" width="324" height="230" /></a></p>  <p>When you interactively draw a sketch, Inventor automatically creates these points behind the scenes.&#160; It also automatically deletes them when the associated geometry is deleted.&#160; When using the API itâ€™s possible to have it automatically create these points too, but without understanding these concepts of how geometry is connected to points and each other by sharing points itâ€™s easy to get results you werenâ€™t expecting.&#160; When interactively drawing a sketch, itâ€™s natural to get the correct result because Inventor infers connections based on where you click the mouse.&#160; When using the API, none of this inference can take place because youâ€™re not moving the mouse over the geometry.</p>  <p>The code below creates a sketch line on an existing sketch.&#160; You can paste this into the bottom of the sub from the previous post in this series.&#160; </p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong><font color="#0000ff">' Get a reference to the TransientGeometry object</font></strong>. </font>    <br />Dim tg As Inventor.TransientGeometry = invApp.TransientGeometry     <br />    <br /><strong><font color="#0000ff">' Get a reference to the SketchLines collection.        <br /></font></strong>Dim lines As Inventor.SketchLines = sketch.SketchLines     <br />    <br /><font color="#0000ff"><strong>' Draw a line between (0,0) and (4,0).</strong></font>     <br />Dim line1 As Inventor.SketchLine     <br />line1 = lines.AddByTwoPoints(tg.CreatePoint2d(0, 0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(4, 0))</p>  <p>The first thing this does is get a reference to the <em>TransientGeometry</em> object. This is a utility object in the API that lets you create various types of geometry.&#160; However, the geometry created is not ever displayed or saved by Inventor, which is why they are called <em>transient</em>.&#160; These objects are simply the mathematical definition of the geometry and are not visible entities.&#160; Iâ€™m using it in this case to create two coordinate points to define the end points of the line.&#160; The CreatePoint2d method creates a transient 2d point.&#160; The Point2d object is a simple API object that wraps the x-y coordinates of a point in 2d space.&#160; In Inventorâ€™s API, instead of passing two values to define x-y coordinates a Point2d object is used instead.&#160; Thereâ€™s also a Point object which wraps x-y-z coordinates for a 3d point.&#160; When working with a sketch you want to make sure youâ€™re using the CreatePoint<u>2d</u> method and not the CreatePoint method.&#160; Itâ€™s a common mistake.</p>  <p>The next thing the program above does is get the SketchLines collection.&#160; In a <a href="http://modthemachine.typepad.com/my_weblog/2012/04/objects-in-the-api.html">previous post</a> I briefly discussed collection objects.&#160; The SketchLines object lets you access all of the lines on the sketch and it supports add methods to let you create new lines.&#160; This examples uses the AddByTwoPoints method to create a new sketch line.</p>  <p>The final section of the code above creates the new line.&#160; A variable is declared with the type of SketchLine and the newly created line is assigned to the variable.&#160; The AddByTwoPoints method takes to points as input.&#160; These can either be coordinate points (defined by a Point2d object as in the example above) or they can be existing SketchPoint objects, which youâ€™ll see demonstrated below.</p>  <p>Another thing thatâ€™s important to understand are the units that Inventor uses. Internally, Inventor is consistent in the units it uses.&#160; Lengths are <u>always</u> defined in centimeters and angles are <u>always</u> defined in radians.&#160; It doesnâ€™t matter what units the user has specified as their document units.&#160; The API is consistent with the Inventor internal units.&#160; When you create or query geometry, any length or coordinate values will always be in centimeters and any angles will always be in radians.&#160; The example above creates a 4 centimeter long line starting from the origin and going in the sketch X direction.&#160; Weâ€™ll see in a later post how to deal with user defined units.</p>  <p>Below is some code that creates a second and third line to create a triangle.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Draw a line between (4,0) and (4,3).</strong></font>     <br />Dim line2 As Inventor.SketchLine     <br />line2 = lines.AddByTwoPoints(tg.CreatePoint2d(4, 0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(4, 3))     <br />    <br /><font color="#0000ff"><strong>' Draw a line between (4,3) and (0,0).</strong></font>     <br />Dim line3 As Inventor.SketchLine     <br />line3 = lines.AddByTwoPoints(tg.CreatePoint2d(4, 3), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(0, 0)) </p>  <p>The resulting geometry is shown below on the left.&#160; If I try to create an extrusion using this sketch I canâ€™t select the triangle, but only the individual lines.&#160; Thatâ€™s because each line has itâ€™s own unique pair of sketch points for its end points, instead of sharing a single point between two lines.&#160; This becomes obvious if I drag any of the end points, the triangle pulls apart, as shown in the picture on the right.</p>  <p align="left"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b919970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="LinesTriangle" border="0" alt="LinesTriangle" align="left" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016765ce49f5970b-pi" width="231" height="182" /></a></p>  <p align="left"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304db290c970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="LinesBrokenTriangle" border="0" alt="LinesBrokenTriangle" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b92f970c-pi" width="240" height="204" /></a></p>  <p>The code below is a variation of the previous code but creates a set of connected lines.&#160; The difference is that instead of defining new coordinates for the end of each line it uses the EndSketchPoint and StartSketchPoint properties of the SketchLine object to get the sketch points from the existing lines.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Draw a line between (0,0) and (4,0).</strong></font>     <br />Dim line1 As Inventor.SketchLine     <br />line1 = lines.AddByTwoPoints(tg.CreatePoint2d(0, 0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(4, 0))     <br />    <br /><font color="#0000ff"><strong>' Draw a second line from the end of the previous line to (4,3).</strong></font>     <br />Dim line2 As Inventor.SketchLine     <br />line2 = lines.AddByTwoPoints(line1.EndSketchPoint, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(4, 3))     <br />    <br /><font color="#0000ff"><strong>' Draw a line connecting the last point to the first point.        <br /></strong></font>Dim line3 As Inventor.SketchLine     <br />line3 = lines.AddByTwoPoints(line2.EndSketchPoint, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; line1.StartSketchPoint)</p>  <p>&#160;</p>  <p>The approach to creating sketch geometry that Iâ€™ve had the best personal success with is to create the sketch points first and then use those as input when creating the various sketch entities.&#160; Itâ€™s easier for me to visualize the points I need if I map it out before hand and having the map helps to eliminate mistakes in my code.&#160; For example, below is an example of what I sketched up to help me visualize the points that will be needed to create the slot.&#160; Remember that arcs and circles require a sketch point at their center.&#160; Iâ€™ve numbered the points starting with zero.&#160; Those numbers will correspond to indices in an array in my program.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b93c970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="SlotSketch" border="0" alt="SlotSketch" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304db2924970d-pi" width="347" height="200" /></a></p>  <p>Below is the code that demonstrates this approach.&#160; It begins by creating the sketch points and then it uses those points to create the sketch geometry.&#160; It becomes a dot-to-dot exercise to draw the geometry.&#160; This examples illustrates lines and arcs, but all of sketch geometry uses the same concepts.&#160; Youâ€™ll just be using different collection objects and different add methods within those collections.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Get a reference to the SketchPoints collection.</font></strong>     <br />Dim points As Inventor.SketchPoints = sketch.SketchPoints     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchLines collection.        <br /></strong></font>Dim lines As Inventor.SketchLines = sketch.SketchLines     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchArcs collection.</strong></font>     <br />Dim arcs As Inventor.SketchArcs = sketch.SketchArcs     <br />    <br /><font color="#0000ff"><strong>' Create the sketch points.</strong></font>     <br />Dim pointArray(5) As Inventor.SketchPoint     <br />pointArray(0) = points.Add(tg.CreatePoint2d(0, 1), False)     <br />pointArray(1) = points.Add(tg.CreatePoint2d(0, 0), False)     <br />pointArray(2) = points.Add(tg.CreatePoint2d(0, -1), False)     <br />pointArray(3) = points.Add(tg.CreatePoint2d(4, -1), False)     <br />pointArray(4) = points.Add(tg.CreatePoint2d(4, 0), False)     <br />pointArray(5) = points.Add(tg.CreatePoint2d(4, 1), False)     <br />    <br /><font color="#0000ff"><strong>' Draw the geometry.</strong></font>     <br />Dim arc1 As Inventor.SketchArc     <br />arc1 = arcs.AddByCenterStartEndPoint(pointArray(1), pointArray(0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(2))     <br />    <br />Dim line1 As Inventor.SketchLine     <br />line1 = lines.AddByTwoPoints(pointArray(2), pointArray(3))     <br />    <br />Dim arc2 As Inventor.SketchArc     <br />arc2 = arcs.AddByCenterStartEndPoint(pointArray(4), pointArray(3), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(5))     <br />    <br />Dim line2 As Inventor.SketchLine     <br />line2 = lines.AddByTwoPoints(pointArray(5), pointArray(0))     <br /></p>  <p>The result after running the program is shown below, which is whatâ€™s expected.&#160; Because the entities share sketch points at the connections, Inventor sees this as being closed so it can be used as input to create an extrusion.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b94b970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="SlotResult" border="0" alt="SlotResult" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ead0b959970c-pi" width="274" height="117" /></a></p>  <p>However, if you try and edit the sketch by dragging the points it may not behave as you expect, as shown in the picture below.&#160; This is because there arenâ€™t any constraints to define the behavior.&#160; Interactively, constraints are inferred during the sketching process by how you move your mouse, which canâ€™t happen when using the API.&#160; Iâ€™ll discuss adding constraints in an upcoming post.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016765ce4a2b970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="ModifiedSlotResult" border="0" alt="ModifiedSlotResult" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304db2966970d-pi" width="273" height="132" /></a></p>  <p><strong>Note</strong>: One issue that I just discovered while writing this post is that the AddByCenterStartEndPoint method is not associating the input center sketch point with the new arc, but is instead creating a new point at that position.&#160; This is not expected behavior and Iâ€™ll discuss how you can work around this issue in a later post.&#160; Just know that when you see the extra center points that you didnâ€™t do anything wrong.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Anton
EMAIL: anton.van.buiten@betagraphics.nl
IP: 212.178.65.74
URL: 
DATE: 05/16/2012 07:48:20 AM
Although very clear described one question remains:
How is the 2Dpoint "linked" to the active sketch in the following code fragment.

Dim tg As Inventor.TransientGeometry = invApp.TransientGeometry

' Draw a line between (0,0) and (4,0).
Dim line1 As Inventor.SketchLine
line1 = lines.AddByTwoPoints(tg.CreatePoint2d(0, 0), _
                             tg.CreatePoint2d(4, 0))

I'll assume the active sketch supplies the Z-coordinate but how is the tg object linked to the active sketch?


-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Develop Inventor Website Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: develop-inventor-website-update
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/develop-inventor-website-update.html 
DATE: 04/26/2012 12:36:45 AM
-----
BODY:
<p>Autodesk supports several Developer Center web pages that contain general information about programming the various Autodesk products that support an API.&#0160; With each major release these sites are updated, and occasionally there are updates in between releases.&#0160; The update to Inventorâ€™s Developer Center site for Inventor 2013 is now available.&#0160; See <a href="http://www.autodesk.com/developinventor">http://www.autodesk.com/developinventor</a>.&#0160; Youâ€™ll also see links on the left-hand side of the page to the pages of the other Autodesk products.&#0160; These sites arenâ€™t meant to have all the information youâ€™ll ever need but are intended to help get you started programming a product by providing a general overview of the technology and links to existing resources.</p>
<p><a href="http://www.autodesk.com/developinventor"><img alt="DevelopInventor" border="0" height="395" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016765b72ecc970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="DevelopInventor" width="479" /></a></p>
<p>&#0160;</p>
<p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with Sketches
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: working-with-sketches
CATEGORY: Brian
CATEGORY: Getting Started Tutorial

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/working-with-sketches.html 
DATE: 04/20/2012 08:30:05 PM
-----
BODY:
<p>In this post, on our slow journey towards creating a command that creates a slot shape in a sketch, Iâ€™m going to discuss the main principles when working with sketches.</p>  <p>You can create a sketch in a part or assembly but Iâ€™m only going to address parts for now.&#160; A sketch is basically a 2D coordinate system positioned in 3D space.&#160; The API has a special type of object for this type of sketch called a <em>PlanarSketch</em> since itâ€™s defining a plane in 3D space.&#160; There is also a <em>DrawingSketch</em> which is slightly different since a drawing is already 2D.&#160; Typically, sketches are created by referencing an existing planar entity, either a planar face or a work plane.&#160; The sketch is associatively related to the entity so that if the entity moves the sketch moves with it.</p>  <p>When you pick a face or work plane, Inventor has some logic that it uses to determine the orientation and origin of the 2D coordinate system thatâ€™s defined during the creation of the sketch.&#160; You typically donâ€™t care about this orientation because the default is usually what you expect and the main thing it affects is the horizontal and vertical directions.&#160; The origin doesnâ€™t matter since you dimension the sketch geometry relative to other geometry in the model so the actual x-y coordinates of the sketch geometry is immaterial.&#160; The picture below shows a selected face on a part where I want to create a sketch.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea77864b970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="SketchPlaneEntity" border="0" alt="SketchPlaneEntity" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676575cce8970b-pi" width="300" height="333" /></a></p>  <p>&#160;</p>  <p>After creating the sketch it is possible to see and even edit the coordinate system that was defined for this sketch.&#160; You can do this using the â€œEdit Coordinate Systemâ€ command thatâ€™s accessed through the context menu for the sketch.&#160; A 2D triad is displayed indicating the origin and the direction of the x and y axes.&#160; While in this command you can edit these to reorient the sketch on the plane.</p>  <p align="center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163048218eb970d-pi"><img title="EditCoordSysCommand" border="0" alt="EditCoordSysCommand" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea778662970c-pi" width="150" height="161" /></a>&#160;&#160;&#160;&#160; <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676575ccf4970b-pi"><img title="SketchCoordSystem" border="0" alt="SketchCoordSystem" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630482190f970d-pi" width="275" height="312" /></a></p>  <p align="center">The yellow lines you see in the picture above are sketch lines that were automatically created by projecting the edges of the selected face onto the sketch.&#160; This is the default behavior of Inventor but is controlled using the setting in the Application Options dialog as shown below.</p>  <p align="center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630482193c970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="AutoProjectEdges" border="0" alt="AutoProjectEdges" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea778689970c-pi" width="415" height="279" /></a></p>  <p align="center">&#160;</p>  <p align="center">To create a sketch using the API you need to use the collection object for sketches.&#160; Remember from the discussion in the previous post that collection objects provide access to existing objects of a certain type and also support methods to create new objects of that type.&#160; Below is a simplified view of the object hierarchy to get to the PlanarSketches object.&#160; Weâ€™ve already discussed how to create a PartDocument object but most of the data that we think of as part specific data, (features, work features, parameters, imates, etc.) are part of the <em>PartComponentDefinition</em> object.&#160; There is always a one-to-one relationship between a PartDocument and a PartComponentDefinition object.&#160; Donâ€™t get too caught up in why there is a PartComponentDefinition object but instead just remember that for part information youâ€™ll need to take that one extra step to get the PartComponentDefinition from the PartDocument.&#160; </p>  <p align="center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630482194d970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="SketchModel" border="0" alt="SketchModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea778699970c-pi" width="264" height="219" /></a></p>  <p align="center">Below is some code that creates a new part document and creates a new sketch on the X-Y work plane of the part.&#160; </p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Connect to a running instance of Inventor.</strong></font>     <br />Dim invApp As Inventor.Application     <br />invApp = System.Runtime.InteropServices.Marshal.GetActiveObject _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;Inventor.Application&quot;)     <br />    <br /><font color="#0000ff"><strong>' Get the Documents collection.</strong></font>     <br />Dim docs As Inventor.Documents docs = invApp.Documents     <br />    <br /><font color="#0000ff"><strong>' Create a new part document.</strong></font>     <br />Dim partDoc As Inventor.PartDocument     <br />partDoc = docs.Add(Inventor.DocumentTypeEnum.kPartDocumentObject)     <br />    <br /><font color="#0000ff"><strong>' Get the component definition.</strong></font>     <br />Dim partDef As Inventor.PartComponentDefinition     <br />partDef = partDoc.ComponentDefinition     <br />    <br /><font color="#0000ff"><strong>' Get the X-Y work plane.        <br /></strong></font>Dim xyPlane As Inventor.WorkPlane = partDef.WorkPlanes.Item(3)     <br />    <br /><font color="#0000ff"><strong>' Create a new sketch.</strong></font>     <br />Dim sketch As Inventor.PlanarSketch     <br />sketch = partDef.Sketches.Add(xyPlane, False) </p>  <p>&#160;</p>  <p>The code above uses the ComponentDefinition property of the PartDocument object to get the PartComponentDefinition object associated with the part.&#160; In most cases the name of the property matches the name of the object is returns but thatâ€™s not always the case as in this example.&#160; </p>  <p>Next it gets the X-Y work plane from the part.&#160; It does this by getting the WorkPlanes collection object from the PartComponentDefinition and gets a work plane from it using the Item property.&#160; The WorkPlanes collection object contains all of the work planes in a part and also supports several Add methods to create new work planes.&#160; All parts will always have at least three work planes, three work axes, and one work point.&#160; Below is a picture of the browser for a new, empty part.&#160; You can see the base work features that exist in every part.&#160; When accessing these through the API they are returned by the API collection objects in the same order theyâ€™re shown in the browser.&#160; For example, getting WorkPlanes.Item(1) will return the YZ Plane.&#160; Getting WorkAxes.item(2) will return the Y axis. and getting WorkPoints.Item(1) will always return the origin work point.&#160; The user cannot delete or reorder these base work features so this is guaranteed to always be true.&#160; In this case Iâ€™m getting item 3 from the WorkPlanes collection, which is the XY Plane.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304821966970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="BrowserNewPart" border="0" alt="BrowserNewPart" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016304821978970d-pi" width="187" height="293" /></a></p>  <p>The last section of code, shown below, creates a new sketch.&#160; There are a couple of things that I want to point out here.&#160; There are several things happening on the line where the sketch gets created.&#160; First, the Sketches property of the PartComponentDefinition is called.&#160; This returns a PlanarSketches object.&#160; Next, the Add method of the PlanarSketches object is called.&#160; This line could have been broken up into multiple lines by first getting the PlanarSketches object and then calling the Add method.&#160; Most languages support the ability to combine these calls into a single line to allow for less code.&#160; Just be aware that there are several calls being made on that single line, which can sometimes make problems a little more difficult to debug because if that line fails itâ€™s difficult to know which call failed.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Create a new sketch.</strong></font>     <br />Dim sketch As Inventor.PlanarSketch     <br />sketch = partDef.Sketches.Add(xyPlane, False) </p>  <p>The Add method to create a new sketch is fairly simple.&#160; It has two arguments.&#160; The first is the planar object you want to create the sketch on.&#160; This can be a work plane, like in this example, or it can be a planar face.&#160; The second argument indicates if the edges of the face should be copied into the sketch.&#160; This is the equivalent of the â€œAuto Projectâ€ option discussed above.&#160; The API ignores the application setting for the auto project and allows you to control it explicitly when you create a sketch.&#160; This setting is only used when youâ€™re creating a sketch on a face and is ignored when a work plane is used.&#160; In fact the second argument is defined to be an optional argument so I could have left it out.&#160; It defaults to False if you donâ€™t specify it.</p>  <p>The work plane created is the same as if you had interactively created it in Inventor, in that the origin and orientation of the plane is automatically inferred by Inventor.&#160; The PlanarSketches collection also supports an AddWithOrientation method that lets you specify the origin and orientation when you create it.&#160; In practice this is rarely used.</p>  <p>If you run the code above it will create a new part and youâ€™ll see a new empty sketch in the part.&#160; Each time you run the program you get a new part with a sketch.&#160; Not too exciting yet, but in the next post weâ€™ll look at drawing geometry on the sketch.&#160; Then it gets a lot more fun <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea7786a3970c-pi" />.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Zhang Yi
EMAIL: yi.zhang@fivesgroup.com
IP: 114.80.207.34
URL: 
DATE: 04/24/2012 03:13:52 AM
im xyPlane As Inventor.WorkPlane = partDef.WorkPlanes.Item(3) 
partDef.WorkPlanes hasn't Item's definition?
why??
-----
COMMENT:
AUTHOR: Zhang Yi
EMAIL: yi.zhang@fivesgroup.com
IP: 114.80.207.34
URL: 
DATE: 04/24/2012 03:16:10 AM
I use Inventor 2011.
-----
COMMENT:
AUTHOR: Zhang Yi
EMAIL: yi.zhang@fivesgroup.com
IP: 114.80.207.34
URL: 
DATE: 04/27/2012 01:53:48 AM
The problem is solved.
Thank you!
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Wayne Brill
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: wayne-brill

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/wayne-brill.html 
DATE: 04/20/2012 01:05:18 AM
-----
BODY:
<p><a class="asset-img-link" style="float: left;" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea6ce30d970c-popup"><img class="asset  asset-image at-xid-6a00e553fcbfc688340168ea6ce30d970c" style="margin: 0px 5px 5px 0px;" title="Wayne_Brill_88x88" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea6ce30d970c-320wi" alt="Wayne_Brill_88x88" /></a>Wayne joined Autodesk in 1991 and started out supporting AutoCAD 11 (DOS version).&nbsp; In 2000 Wayne started with Autodesk Developer Technical services and has been providing programming support, consulting, training and evangelism to external developers since then. Currently Wayne supports the APIs for AutoCAD, AutoCAD Mechanical, Inventor and ETO and Vault.&nbsp; Wayne has a computer science degree from Lake Washington College.</p>
<p>On the weekends he enjoys a good round of golf and spending time with his wife and two children. Wayne works out of his home office near Seattle Washington.</p>
<p><strong>Disclaimer</strong><br />If you need an official Autodesk company response or a contact for press related activities please contact<a href="http://www.autodesk.com/pressroom"> Autodesk Public Relations.</a></p>
<p>If you need support for our products or APIs, please visit Autodesk's <a href="http://support.autodesk.com/">support website</a>, use our <a href="http://discussion.autodesk.com/">discussion groups</a> or post a question via your reseller or the <a href="http://adn.autodesk.com/">Autodesk Developer Network website</a>, if you're a member.</p>
<p>The contents of this site are my own personal opinions and do not represent my employer's view in any way. In addition, my thoughts and opinions often change, and as a weblog is intended to provide a semi-permanent point-in-time snapshot you should not consider out-of-date posts to reflect my current thoughts and opinions.</p>
<p>The code provided in this blog is provided "as is" and with all faults. I (and my employer) specifically disclaim any implied warranty of merchantability or fitness for a particular use. The operation of the code provided is not warranted to be uninterrupted or error free.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
akn_exclude
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Objects in the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: objects-in-the-api
CATEGORY: Brian
CATEGORY: Getting Started Tutorial

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/objects-in-the-api.html 
DATE: 04/17/2012 03:03:23 AM
-----
BODY:
<p>Hereâ€™s another post in the getting series where weâ€™re looking at the creation of a new sketch command to create slot shapes.&#160; Iâ€™ll be adding each of the posts in this series to the <a href="http://modthemachine.typepad.com/my_weblog/getting-started-tutorial/">Getting Started Tutorial</a> category.</p>  <p>This post is more discussion than coding so you will have some background to follow whatâ€™s coming next.&#160; First, I want to go back to the previous program and look at that code in a bit more detail.&#160; The code below is from the previous post with the error handling removed and one of the lines has been broken into two to make it easier to follow whatâ€™s happening</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><font color="#000000">1.</font><strong>&#160; ' Connect to a running instance of Inventor.        <br /></strong></font>2.&#160; Dim invApp As Inventor.Application     <br />3.&#160; invApp = System.Runtime.InteropServices.Marshal.GetActiveObject _     <br />4.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;Inventor.Application&quot;)     <br /><font color="#0000ff"><font color="#000000">5.</font><strong>&#160; ' Get the Documents collection.        <br /></strong></font>6.&#160; Dim docs As Inventor.Documents     <br />7.&#160; docs = invApp.Documents     <br />8.     <br /><font color="#0000ff"><font color="#000000">9.&#160; </font><strong>' Create a new part document.        <br /></strong></font>10. Dim partDoc As Inventor.PartDocument     <br />11. partDoc = docs.Add(Inventor.DocumentTypeEnum.kPartDocumentObject)     <br /></p> </font>  <p>Line 2 declares a variable to be of type Inventor.Application.&#160; The â€œInventorâ€ portion of the declaration is specifying the library and the â€œApplicationâ€ portion is the name of the object.&#160; The Inventor API is exposed as objects.&#160; Youâ€™re already used to this concept since thatâ€™s also how Visual Basic works.&#160; For example, when you place a button control on a form, that results in the creation of a button object that you can access in your program.&#160; The button has properties that you can read and write to manipulate the button.&#160; It also has methods you can call and it has events that notify you when certain things happen to the button, like when it is clicked.&#160; </p>  <p>Inventor objects have the same concept but instead of representing something on a form, they represent something within Inventor.&#160; For example, for every extrude feature in a part there is an ExtrudeFeature object that you can access and use in a program.&#160; Inventor is a large and fairly complicated application and the API reflects that.&#160; Inventor 2013 has 1365 objects which have a total of 20,462 properties, methods, and events.&#160; Donâ€™t let these big numbers discourage you though because you donâ€™t need to understand all of it be able to use it.</p>  <p>These objects are accessed through something known as the <em>object model or object hierarchy</em>.&#160; A useful tool in working with the API is the object model chart, which is shown below.&#160; You can download a printable pdf version of the chart <a href="http://modthemachine.typepad.com/files/Inventor2013Model.pdf">here</a>.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5127970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="FullObjectModel" border="0" alt="FullObjectModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b519e970c-pi" width="479" height="311" /></a></p>  <p>&#160;</p>  <p>Below is a snapshot of the upper-left corner of the chart that includes the few objects that are used in the small program discussed here.&#160; You can see in the chart that the top-level object is the <strong>Application</strong> object.&#160; This object represents the Inventor application and has functionality that lets you manipulate the entire application; things like resizing the main window and accessing application options.&#160; However, the most important thing the Application object does is support properties that return other objects.&#160; This is how you gain access to the other objects in the hierarchy.&#160; For example, the Application object supports the Documents property which returns the Documents object.&#160; This is illustrated in line 7 in the code sample above and that relationship can be seen in the chart below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676539b40b970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="ObjectModelDocs" border="0" alt="ObjectModelDocs" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630445f32a970d-pi" width="477" height="148" /></a></p>  <p>&#160;</p>  <p>You can also view all of the objects and their associated methods, properties, and events from within Visual Basic using the Object Browser.&#160; To access the Object Browser in Visual Basic Express 2010, press F2. The Object Browser is shown below, with the Inventor library selected.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5213970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="VB2010ObjectBrowser" border="0" alt="VB2010ObjectBrowser" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b521d970c-pi" width="479" height="248" /></a></p>  <p>Below is the Object Browser with the Documents object selected in the list on the left and the Item property selected on the right.&#160; The Object Browser provides a convenient way to see the objects and what functionality they support.&#160; You can see in the picture below that the Item property is read-only and has a single argument called Index which is an Integer.&#160; You can also see that it returns an Inventor.Document object. (You can ignore the _ character in front of Document.&#160; It has something to do with how the API was implemented internally and I donâ€™t understand it either. <font size="1"><img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5223970c-pi" width="15" height="15" /></font>)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676539b529970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DocumentsCollection" border="0" alt="DocumentsCollection" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630445f3e8970d-pi" width="479" height="248" /></a></p>  <p>&#160;</p>  <p style="line-height: 140%; background: #eebb00; color: black"><strong>Tip:</strong> You can expose additional capabilities in the Visual Basic Express 2010 interface by changing your settings to â€œExpert Settingsâ€ in the â€œToolsâ€ menu, as shown below.&#160; After doing this the â€œObject Browserâ€ command will be displayed in the â€œViewâ€ menu.     <br />    <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5297970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="ExpertSettings" border="0" alt="ExpertSettings" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401630445f426970d-pi" width="404" height="141" /></a>     <br /></p>  <p>&#160;</p>  <p>Line 6, in the sample above, declares a variable to be of type Documents.&#160; The Documents object is a special type of object known as a <em>collection</em> object.&#160; Collection objects are used extensively throughout the API and are an important concept to understand.&#160;&#160; </p>  <p><strong>Collection objects</strong> are utility objects used in the API.&#160; They donâ€™t represent specific objects within Inventor but instead provide access to a group of related objects and in many cases also provide the ability to create new objects.&#160; The Documents object illustrates both of these.</p>  <p>The Documents object provides access to all of the documents that are currently open in Inventor.&#160; <u>All</u> collection objects support the properties Count and Item.&#160; The Count property tells you how many items are in the collection and the Item property lets you access the items within the collection.&#160; If you add the following to the end of the previous program it will display a message box telling you how many documents are currently open.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Display the number of documents.</font></strong>     <br /><font style="background-color: #f79646"></font>MessageBox.Show(&quot;There are &quot; &amp; docs.Count &amp; &quot; documents open.&quot;)&#160; <br /></p> </font>  <p>You use the Item property of a collection to get a specific object from the collection.&#160; This is somewhat similar to an array but the first item has in index of 1.&#160; Some collections will also let you specify the name of the object you want.&#160; The code below uses both the Count and the Item properties of the Documents object to iterate over all of the open documents and display the name of each one in the output window.&#160; (You may need to turn on the display of the output window from the menu â€œView â€“&gt; Other Windows â€“&gt; Outputâ€ or&#160; â€œCtrl + Alt + Oâ€.)</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><font color="#000000"><strong><font color="#0000ff">' Iterate over the open documents</font></strong>         <br />For i As Integer = 1 To docs.Count         <br />&#160;&#160;&#160; Debug.Print(&quot;Doc Name: &quot; &amp; docs.Item(i).DisplayName)         <br />Next</font></font></p>  <p>If youâ€™re iterating through a collection a more efficient technique for is to use the For Next statement.&#160; Code using a For Each vs. the For To will typically run faster and is easier to read.&#160; This is demonstrated below.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Iterate over the open documents        <br /></strong></font><font color="#000000">For Each doc As Inventor.Document In docs      <br />&#160;&#160;&#160; Debug.Print(&quot;Doc: &quot; &amp; doc.DisplayName)       <br />Next</font></p>  <p>The Item property of the Documents collection does not support indexing by name.&#160; You can determine which Item properties do support this by looking at the description of the property in the API help.&#160; The Documents object supports a separate property for named lookup called ItemByName where instead of providing the index number you supply the filename of the document.&#160; If you specify an out of range number or a name that doesnâ€™t exist the call will fail.</p>  <p><strong>Adding objects</strong> to a collection is done by using the Add methods of the collection.&#160; This was demonstrated in the original program above in line 11 where the Add method is called.&#160; Some collections wonâ€™t have any add methods and others will have several.&#160; The arguments to the add methods will also vary greatly depending on what is being created.&#160; Itâ€™s takes much different information to create a new document versus creating a new extrude feature.</p>  <p>Weâ€™ll look at practical applications of collection objects and using them to create new objects in the upcoming posts.&#160; In the next post Iâ€™ll talk about creating sketches.</p>  <p>Another useful tool to look at Inventorâ€™s objects is VBAâ€™s debugger.&#160; Iâ€™ve described this in a <a href="http://modthemachine.typepad.com/my_weblog/2008/10/program-prototyping.html">previous post on program prototyping</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Join us at Camp this Summer!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: join-us-at-camp-this-summer
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/join-us-at-camp-this-summer.html 
DATE: 04/12/2012 01:32:08 AM
-----
BODY:
<p><em>Autodesk Manufacturing DevCamp (June 13-14)!</em></p>
<p><span style="color: #ff0000;"><em>Register by April 30<sup>th</sup> to get the $100 early bird discount!</em></span></p>
<p>DevCamps are held every other year where software developers like you can learn to get the most from your time and effort working with Autodesk platform technologies.&#0160; The two industry specific Developer Camps include several tracks catering to the learning needs of beginner and expert software developers â€“ as well as a business track for start-ups looking to develop and leverage their relationship with Autodesk.&#0160; Come to Camp and get two days of face to face learning and help from Autodesk software engineers â€“ the same Autodesk software engineers developing and supporting the Autodesk technology you work with every day.&#0160;</p>
<p>You can also join us for a third day at&#0160; â€œ<a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=13713450"><strong>DevLab</strong></a>â€ where you can work on your hardest coding challenges with an Autodesk software engineer looking over your shoulder giving you immediate help and advice.&#0160; Bring your laptop and work on your code as youâ€™d normally do in your own office â€“ the difference is that you have a team of DevTech experts (the same people who answer your questions through DevHelp Online) available to review your code if youâ€™d like, answer your questions, and make suggestions.&#0160;</p>
<p><strong>Cloud and Mobile Classes</strong></p>
<p>New for this yearâ€™s DevCamps are several classes on helping you get started developing apps based on Cloud and Mobile technologies.&#0160; Learn how to build your first Cloud app integrated with your favorite Autodesk product â€“ and how you can make it available â€œeverywhereâ€ through browser and mobile user interfaces.&#0160; Have you been considering building your first app for the iPhone, iPad or Android device but holding back because of fear of lost hours thrashing while learning the new technology?&#0160; DevCamp includes classes that will show you how to quickly and easily create your first â€œHello Worldâ€ app for iOS and Android - with a design and graphics twist.</p>
<p>&#0160;</p>
<p><strong>Class schedule, </strong>June 13-14<strong> (</strong>in Portland Oregon<strong>) </strong></p>
<p>You can attend beginner and expert classes on developing solutions with AutodeskÂ® InventorÂ® (including Inventor ETO), AutodeskÂ® Vault, AutodeskÂ® Navisworks, Autodesk PLM 360, and several more Autodesk manufacturing technologies.&#0160; Hear from Autodeskâ€™s Manufacturing Leadership including Executive Vice President Robert â€œBuzzâ€ Kross.&#0160; Learn about new technologies Autodesk is working on from the head of our â€œFusionâ€ Product Management Team Kevin Schneider.&#0160;</p>
<p>Complete list of classes being offered at MFG DevCamp found <strong><a href="https://custom.cvent.com/FDBB345248B94F40BFFFCEF2FBE054E4/files/901b9a180ac242069d041846cb69f5b4.pdf">here</a></strong>.</p>
<p>Register to attend Manufacturing DevCamp <strong><a href="http://www.cvent.com/d/ycq03r/1K">here</a></strong>.&#0160;</p>
<p><strong>Optional MFG DevLab </strong>June 15, requires a separate registration <a href="http://usa.autodesk.com/adsk/servlet/item?id=6703509&amp;siteID=123112&amp;cname=DevLab%20Manufacturing,%20Lake%20Oswego,%20Jun%2015%202012,%20201237"><strong>here</strong></a></p>
<p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating and Setting up Your Project
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-and-setting-up-your-project
CATEGORY: Brian
CATEGORY: Getting Started Tutorial

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/creating-and-setting-up-your-project.html 
DATE: 04/09/2012 05:02:55 AM
-----
BODY:
<p>If youâ€™ve gone through the lessons in the <a href="http://modthemachine.typepad.com/my_weblog/2012/03/getting-started-programming-inventor.html">book I suggested earlier</a>, or any of the <a href="http://msdn.microsoft.com/en-us/vstudio/bb466226.aspx">online Microsoft tutorials</a> that are available you should be familiar with what projects are and how to create them.&#160; I wonâ€™t go into a lot of detail but will go through the steps below.</p>  <p>Here are the steps to creating an exe program that will access and control Inventor using the API.</p>  <ol>   <li>After running Visual Basic 2010 Express, select the â€œNew Projectâ€¦â€ option, which is outlined in red below.      <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e9d48668970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="VBStartPage" border="0" alt="VBStartPage" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016303def143970d-pi" width="454" height="371" /></a>&#160; </li>    <li>In the <strong>New Project</strong> dialog select â€œWindows Forms Applicationâ€ as the type of project and enter â€œDrawShapeâ€ for the project name.&#160; <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016303def149970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="VBNewProject" border="0" alt="VBNewProject" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016764d38b63970b-pi" width="454" height="257" /></a> </li>    <li>The project youâ€™ve just created is a standard Windows application and doesnâ€™t have any knowledge about Inventorâ€™s API.&#160; In order to access Inventorâ€™s API you need to make your project aware of the API and what it supports.&#160; You do this by referencing Inventorâ€™s Interop library.&#160; The interop completely describes the API in a .Net friendly way.      <br />      <br />To add the reference choose the â€œAdd Referenceâ€¦â€ command from the Project menu, as shown below.       <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016764d38b6a970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="VBAddReferenceMenu" border="0" alt="VBAddReferenceMenu" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016303def15c970d-pi" width="254" height="210" /></a>       <br />In the <strong>Add Reference</strong> dialog choose the Browse tab and browse to the directory below (for whatever version of Inventor youâ€™re using).&#160; <br />      <br />&#160;&#160; <font face="MS Reference Sans Serif">C:\Program Files\Autodesk\Inventor 2013\bin\Public Assemblies</font>       <br />      <br />Select â€œAutodesk.Inventor.Interop.dllâ€, as shown below and click OK.       <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016303def169970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="VBAddReference" border="0" alt="VBAddReference" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e9d48694970c-pi" width="454" height="237" /></a>&#160; <br />You can view the references a project has by using the Project window and selecting the â€œShow All Filesâ€ button highlighted in red below.&#160; All of the references will be displayed in the â€œReferencesâ€ folder.       <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e9d4869c970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="VBShowReferences" border="0" alt="VBShowReferences" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016303def17b970d-pi" width="221" height="244" /></a> </li>    <li>Iâ€™ll talk more about this in my next post, but just so we end this post with your program doing something somewhat useful, add a button to your form, (I called mine btnRun), and add the code below into the Click event of the button.&#160; (Sorry about the weird line continuations but the width of a line in this blog interface is very limited.) </li> </ol>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Connect to a running instance of Inventor.&#160; <br /></strong></font>Dim invApp As Inventor.Application&#160; <br />Try&#160; <br />&#160;&#160;&#160; invApp = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Runtime.InteropServices.Marshal.GetActiveObject _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;Inventor.Application&quot;)&#160; <br />Catch ex As Exception&#160; <br />&#160;&#160;&#160; MessageBox.Show(&quot;Inventor must be running.&quot;)&#160; <br />&#160;&#160;&#160; Exit Sub&#160; <br />End Try     <br />    <br /><font color="#0000ff"><strong>' Create a new part document.&#160; <br /></strong></font>Dim partDoc As Inventor.PartDocument&#160; <br />partDoc = invApp.Documents.Add( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.DocumentTypeEnum.kPartDocumentObject)     <br /></font></p>  <blockquote>   <p>Now when you run your application and click the button the program will connect to Inventor if itâ€™s running or display a warning message if itâ€™s not.&#160; If it is running it will create a new part document.&#160; Each time you click the button a new part will be created.&#160; In the next post weâ€™ll look at this code in more detail and discuss the basics of working with documents.</p> </blockquote>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sunith Babu
EMAIL: sunithbabu@cadprofessor.in
IP: 223.227.92.189
URL: http://www.cadprofessor.in
DATE: 04/10/2012 02:03:34 AM
I've completed this step. Looking forward for the next post 

Thanks for this great simple post ! 
-----
COMMENT:
AUTHOR: grapecat
EMAIL: grapecat205@gmail.com
IP: 139.223.11.13
URL: 
DATE: 04/11/2012 07:50:55 AM
hi Brian
First of all, I am very sorry
My English is very pool
My program compile when an error has occurred

objDocumentSel.PropertySets.FlushToFile()


The following errorï¼š
Unspecified error (Exception from HRESULT: 0x80004005 (E_FAIL))




-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: What Should I Use to Program Inventor?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: what-should-i-use-to-program-inventor
CATEGORY: Brian
CATEGORY: Getting Started Tutorial

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/04/what-should-i-use-to-program-inventor.html 
DATE: 04/05/2012 12:11:32 AM
-----
BODY:
<p>Before actually beginning to write any code I wanted to spend some time discussing what language to use when programming Inventor.&#160; I wrote a <a href="http://modthemachine.typepad.com/my_weblog/2008/09/inventor-api-fundamentals-002---choosing-a-language.html">post</a> on this a while ago that still applies but my opinion has changed a bit since then.&#160; In that post I recommended that you begin with Inventorâ€™s VBA.&#160; VBA still does have a few advantages but I think the advantages some of&#160; the other languages have now outweighs the advantages VBA has.</p>  <p>If youâ€™re a fairly new programmer, I recommend Visual Basic.&#160; The latest version is Visual Basic 2010.&#160; It comes as one of several languages in Visual Studio 2010.&#160; The Professional version of Visual Studio, which is the least expensive full version, is approx. $500 and it probably has everything youâ€™ll ever need.&#160; You can also download <a href="http://www.microsoft.com/visualstudio/en-us/products/2010-editions/visual-basic-express">Visual Basic 2010 Express</a> from Microsoft, which is a trimmed down version and is <font style="background-color: #ffff00"><strong>free</strong></font>.&#160; This is the version thatâ€™s used for the book I recommended in my <a href="http://modthemachine.typepad.com/my_weblog/2012/03/getting-started-programming-inventor.html">previous post</a>.&#160; There are a couple of things missing from this version that youâ€™ll wish you had when you begin some more advanced Inventor development but weâ€™ll look at some workarounds later when we get to those topics.&#160; For now the free Express edition has more than enough capabilities to begin learning Inventorâ€™s API and is a great way to get started.</p>  <p>If youâ€™re an old C++ programmer then youâ€™ll likely prefer C# over Visual Basic.&#160; I believe Visual Basic is easier to use for a new programmer but C# is very similar so it really is a personal preference rather than a question of which one is better.&#160; You can also use Visual C++, but it is much harder, especially for a new programmer, to use than either Visual Basic or C#.&#160; For this series of posts on getting started with the API, Iâ€™ll stick primarily with Visual Basic, but will also do some coverage of C# when there are differences.&#160; Iâ€™m not going to spend any time on C++ but plan to write a separate post covering using C++ with Inventor.</p>  <p>In the next post weâ€™ll actually begin writing some code.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sunith Babu
EMAIL: sunithbabu@cadprofessor.in
IP: 180.215.70.156
URL: http://www.cadprofessor.in
DATE: 04/06/2012 03:36:40 AM
I'm interested in learning more about programming with Inventor. Looking forward for more posts 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Getting Started Programming Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: getting-started-programming-inventor
CATEGORY: Getting Started Tutorial

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/getting-started-programming-inventor.html 
DATE: 03/30/2012 12:33:30 AM
-----
BODY:
<p>Itâ€™s good to be back now that Inventor 2013 is out the door.&#160; I ended up with my hands in too many projects this release and didnâ€™t get much of a chance to work on the blog.&#160; A big thanks to Wayne for keeping it going.</p>  <p>Over the past few months my son has developed an interest in programming and Iâ€™ve been working with him on learning to program Inventor.&#160; I thought it might be useful to write up for the blog some of exercises Iâ€™ve gone through with him to help him learn how to program in general, and Inventorâ€™s programming interface specifically.</p>  <p>Over the next several weeks I want to go through a lot of topics, each building on top of the other, to create a relatively sophisticated Inventor command.&#160; The command will be a new sketch command that creates a slot shape.&#160; I know there have been requests in the past to have this functionality in Inventor.&#160; Inventor 2013 does introduce new commands to create center point rectangles but it doesnâ€™t yet address the creation of slot shapes, so weâ€™ll create our own.</p>  <p>As we go through these exercises I want to focus on the Inventor API (Application Programming Interface) side of programming and am going assume you already know the basics of general programming.&#160; I know this is a big assumption and probably incorrect in many cases.&#160; It was also something that my son didnâ€™t know and to help get him started I did some research to find a good book.&#160; The one I found and ordered for him Iâ€™m quite happy with and feel I can recommend it to others that are getting started programming or are a bit rusty in their programming skills.&#160; The book is <strong><a href="http://www.informit.com/store/product.aspx?isbn=0672331136">Sams Teach Yourself Visual Basic 2010 in 24 Hours</a></strong> by James Foxall.&#160; Itâ€™s relatively inexpensive and is available on Amazon in both a printed and Kindle version.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016764683955970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="TeachYourselfVB2010" border="0" alt="TeachYourselfVB2010" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e9696989970c-pi" width="290" height="377" /></a></p>  <p>&#160;</p>  <p>If youâ€™re new to programming, this is a simple way to get started and then being able to apply many of the basics you learn from the book as we begin writing the new Inventor command will help to reinforce what youâ€™ve just learned by seeing practical uses for it.</p>  <p>-Brian</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Len Larsen
EMAIL: lgl@kingsbury.com
IP: 208.253.150.194
URL: http://www.Kingsbury.com
DATE: 04/03/2012 02:09:01 PM
Brian,

I have been told to try and gain audience with you, as I've created a Hybrid model assembly some people feel that you need to see. I've taken some iParts and iAssemblies and put them together with iMates and control the various configurations with a user form, iLogic and some of my own code. I've automated the model assembly so that it builds itself based on what is chosen from the user form. I can go into greater detail if you could contact me. When I seemed to have hit a wall towards the end of this project, I posted on the AutoDesk forum and caught the eye of a co-worker of yours. Once he had seen my Configurator, he thought it was "awesome". I would like you to see what I've built, I believe there is nothing else like it. I work for a Philadelphia based (100 year old) company. I am also on the Autodesk Beta team. Please contact me. 
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: SurfaceGraphics &ndash; Select Primitives
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: surfacegraphics-select-primitives

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/surfacegraphics-select-primitives.html 
DATE: 03/28/2012 09:10:51 PM
-----
BODY:
<p>The Inventor 2013 API has enhancements for ClientGraphics including the ability to control which parts of SurfaceGraphics will be selectable. (These are B-Rep entities within the graphics).</p>  <p>In previous releases you could create SurfaceGraphics, but the entire graphic would have been considered a primitive and just selectable as one entity. </p>  <p><strong>New 2013 properties for SurfaceGraphics: </strong></p>  <ul>   <li>SurfaceGraphics.ChildrenAreSelectable </li>    <li>SurfaceGraphicsEdge.Selectable </li>    <li>SurfaceGraphicsFace.Selectable </li>    <li>SurfaceGraphicsVertex.Selectable </li>    <li>SurfaceGraphics.DisplayedVertices </li> </ul>  <p>To make different parts of the SurfaceGraphics selectable, make that <strong>Selectable</strong> boolean property equal to true.&#160; </p>  <p>Also in this release there are a couple of new objects related to SurfaceGraphics. </p>  <p><strong>New 2013 Objects related to SurfaceGraphics:</strong></p>  <ul>   <li>SurfaceGraphicsVertex </li>    <li>SurfaceGraphicsVertexList </li> </ul>  <p><strong></strong></p>  <p><strong>VBA Example. </strong>(Please keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production).</p>  <p>This example demonstrates this new functionality. When you run the code it will display the open dialog that allows you to select an ipt or sat file that will be used to create the SurfaceGraphics. (The active document needs to be a part or assembly). A message box is then displayed with three options that control the userâ€™s ability to select parts of the SurfaceGraphic. </p>  <ul>   <li>Yes - Make just the node selectable. (The entire body will be one selectable thing) </li>    <li>No - Everything is selectable. (Each edge, face and vertex) </li>    <li>Cancel - Disable selection for all the edges and vertices and make every other face selectable. (shows that you can control what is selectable in the SurfaceGraphics) </li> </ul>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676459d5c6970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e95af415970c-pi" width="465" height="217" /></a></p>  <p>Here is a screenshot that shows the result of selecting â€œ<strong>Yes</strong>â€. The entire SurfaceGraphics is only selectable. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676459d5db970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676459d5eb970b-pi" width="457" height="246" /></a></p>  <p>Also just to be clear, notice that this isnâ€™t real inventor geometry. If you look at the model browser there are not any solid bodies or features. This is just client graphics.</p>  <p>Here you can see the result of selecting â€œ<strong>Cancel</strong>â€ It will only allow you to select every other face which is kind of arbitrary. (Whatever order they came up in the faces collection). Also you canâ€™t pick edges or vertices. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e95af440970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e95af44d970c-pi" width="407" height="310" /></a></p>  <p>You can run the procedure again with the â€œ<strong>No</strong>â€ option to create a SurfaceGraphics that will allow you to select everything.&#160; (Each time the procedure runs it deletes the ClientGraphics named â€œtestâ€ and then recreates it).&#160; </p>  <p><strong>VBA Code</strong></p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">Public Sub SelectablePrimitives()    <br />&#160;&#160;&#160; <font color="#0000ff">' Make sure a part or assembly is active.</font>     <br />&#160;&#160;&#160; If ThisApplication.ActiveDocumentType &lt;&gt; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAssemblyDocumentObject _     <br />&#160;&#160;&#160;&#160;&#160; And ThisApplication.ActiveDocumentType _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;&gt; kPartDocumentObject Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A part or assembly must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Get the document and it's      <br />&#160;&#160;&#160; ' associated definition.       <br /></font>&#160;&#160;&#160; Dim doc As Document     <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160; Dim def As ComponentDefinition     <br />&#160;&#160;&#160; Set def = doc.ComponentDefinition     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Get an .ipt or SAT filename from the user.      <br /></font>&#160;&#160;&#160; Dim dialog As FileDialog     <br />&#160;&#160;&#160; Dim filename As String     <br />&#160;&#160;&#160; Call ThisApplication.CreateFileDialog(dialog)     <br />&#160;&#160;&#160; With dialog     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Filter = _     <br />&quot;Inventor Part File (*.ipt)|*.ipt|ACIS SAT File (*.sat)|*.sat&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .FilterIndex = 0     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .ShowOpen     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If .filename = &quot;&quot; Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = .filename     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; End With     <br />&#160;&#160;&#160; <br />&#160;&#160; <font color="#0000ff">' Get the transient B-Rep object.      <br /></font>&#160;&#160;&#160; Dim tb As TransientBRep     <br />&#160;&#160;&#160; Set tb = ThisApplication.TransientBRep     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' If a part was selected, open it invisibly      <br />&#160;&#160;&#160; ' and get the body.       <br /></font>&#160;&#160;&#160; Dim body As SurfaceBody     <br />&#160;&#160;&#160; If UCase(Right$(filename, 4)) = &quot;.IPT&quot; Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim newPart As PartDocument     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set newPart = ThisApplication.Documents. _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Open(filename, False)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Copy out the first body of the part.      <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set body = tb.Copy _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (newPart.ComponentDefinition. _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SurfaceBodies.Item(1))     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Read in the sat file.</font>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim bodies As SurfaceBodies     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set bodies = tb.ReadFromFile(filename)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set body = bodies.Item(1)     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160; <font color="#0000ff">' Create the client graphics object.      <br /></font>&#160;&#160;&#160; Dim graphics As ClientGraphics     <br />&#160;&#160;&#160; On Error Resume Next     <br />&#160;&#160;&#160; Set graphics = def.ClientGraphicsCollection _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Item(&quot;Test&quot;)     <br />&#160;&#160;&#160; If Err.Number = 0 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; graphics.Delete     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; On Error GoTo 0     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Set graphics = def.ClientGraphicsCollection _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Add(&quot;Test&quot;)     <br />&#160;&#160;&#160; Dim node As GraphicsNode     <br />&#160;&#160;&#160; Set node = graphics.AddNode(1)     <br />&#160;&#160;&#160; node.Selectable = True     <br />&#160;&#160;&#160; node.DisplayName = &quot;My Solid&quot;     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim answer As VbMsgBoxResult     <br />&#160;&#160;&#160; answer = MsgBox _     <br />(&quot;Yes=Node Selectable, No=All Selectable, Cancel=Every other face selectable&quot;, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vbYesNoCancel + vbQuestion)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim solidGraphics As SurfaceGraphics     <br />&#160;&#160;&#160; Set solidGraphics = node.AddSurfaceGraphics(body)     <br />&#160;&#160;&#160; ThisApplication.ActiveView.Update     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If answer = vbYes Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; solidGraphics.ChildrenAreSelectable = False     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; solidGraphics.ChildrenAreSelectable = True     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If answer = vbCancel Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim i As Integer     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Make Selectable False for all the      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' SurfaceGraphicsVertex       <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 1 To solidGraphics. _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DisplayedVertices.Count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; solidGraphics.DisplayedVertices _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Item(i).Selectable = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Make Selectable False for all the      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' SurfaceGraphicsEdge       <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 1 To solidGraphics. _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DisplayedEdges.Count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; solidGraphics.DisplayedEdges _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Item(i).Selectable = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Make Selectable every other      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' SurfaceGraphicsFace False       <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 1 To solidGraphics. _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DisplayedFaces.Count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If i Mod 2 = 0 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; solidGraphics.DisplayedFaces _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Item(i).Selectable = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; End If     <br />End Sub</p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Customizing Marking Menus
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: customizing-marking-menus

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/customizing-marking-menus.html 
DATE: 03/24/2012 08:09:28 PM
-----
BODY:
<p>New user-interface elements such as Marking Menus, Mini Toolbars, the Contextual Mini Toolbar and Balloon Tips were introduced in the AutodeskÂ® InventorÂ® 2012 release. The Inventor 2012 API also provides access to all of this functionality so that you can incorporate them into your applications. </p>  <p>The <a href="http://modthemachine.typepad.com/my_weblog/2012/03/create-a-mini-toolbar.html">post on March 2nd</a> discussed how to create a mini toolbar. This time you see how to access marking menus. The following is a description of this <a href="http://modthemachine.typepad.com/Marking_Menus_Example.zip">VB.NET project</a> that creates an Inventor Add-In. (This example was originally created by my colleague Philippe Leefsma).</p>  <p>First notice that there is a class named CMarkingMenu that contains all the code related to the marking menus:&#160; <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbb9c970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163033ad7af970d-pi" width="362" height="290" /></a></p>  <p>For simplicity a toolbar is created when the Add-In is loaded by Inventor. This toolbar contains three buttons, each of the buttons allow activating or toggling the marking menus functionality without the need to customize the Ribbon.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbbaa970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163033ad7c0970d-pi" width="377" height="197" /></a></p>  <p><strong>Toggle Vertex Radial Menu</strong></p>  <p>The first button is connected to the ToggleRadialMarkingMenu procedure. Pressing this button alternatively enables/disables the event handler for UserInputEvents.OnRadialMarkingMenu event.</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> ToggleRadialMarkingMenu _</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: blue">ByVal</span> Context <span style="color: blue">As</span> Inventor.<span style="color: #2b91af">NameValueMap</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; _bRadialMarkingMenu = <span style="color: blue">Not</span> _bRadialMarkingMenu</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> _bRadialMarkingMenu = <span style="color: blue">False</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddHandler</span> _UserInputEvents. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OnRadialMarkingMenu, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddressOf</span> OnRadialMarkingMenu</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">RemoveHandler</span> _UserInputEvents. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OnRadialMarkingMenu, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddressOf</span> OnRadialMarkingMenu</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p>    <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">     <p style="margin: 0px"><span style="color: blue"></span></p>      <p style="margin: 0px"><span style="color: blue">Private</span> <span style="color: blue">Sub</span> OnRadialMarkingMenu _</p>      <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: blue">ByVal</span> SelectedEntities <span style="color: blue">As</span>&#160; _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">ObjectsEnumerator</span>, _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> SelectionDevice <span style="color: blue">As</span> Inventor. _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SelectionDeviceEnum</span>, _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> RadialMenu <span style="color: blue">As</span> Inventor. _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RadialMarkingMenu</span>, _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> AdditionalInfo <span style="color: blue">As</span>&#160; _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">NameValueMap</span>)</p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> SelectedEntities.Count &lt;&gt; 1 <span style="color: blue">Then</span></p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span></p>      <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: blue">Not</span> <span style="color: blue">TypeOf</span> SelectedEntities(1) _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Is</span> <span style="color: #2b91af">Vertex</span> <span style="color: blue">Then</span></p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span></p>      <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> subMenu <span style="color: blue">As</span> <span style="color: #2b91af">RadialMarkingMenu</span></p>      <p style="margin: 0px">&#160;&#160;&#160; subMenu = RadialMenu. _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CreateRadialSubMenu(<span style="color: #a31515">&quot;Vertex Stuff&quot;</span>)</p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px">&#160;&#160;&#160; subMenu.EastControl = _Application. _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CommandManager.ControlDefinitions _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;PartPointWorkPointCmd&quot;</span>)</p>      <p style="margin: 0px">&#160;&#160;&#160; subMenu.WestControl = _Application. _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CommandManager.ControlDefinitions _</p>      <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;AppSketch3DWrapperCmd&quot;</span>)</p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px">&#160;&#160;&#160; RadialMenu.EastControl = subMenu</p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p>   </div> </div>  <p>As we can see in the code snippet, if a single vertex is selected at the time the user is right-clicking the mouse button, the event handler code replaces the RadialMarkingMenu.EastControl by a submenu containing two controls. Again, for simplicity, it uses two existing native controls, one creates a workpoint at the vertex location, the other creates a new sketch3d and sketchpoint3d in it.    <br />Hereâ€™s a screenshot of the radial marking menu with the new menu â€œVertex Stuffâ€. (Notice that a vertex is selected).&#160; <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbbb4970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbbbd970b-pi" width="337" height="297" /></a></p>  <p>After selecting â€œVertext Stuffâ€ radial menu:</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163033ad7d7970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340163033ad7dd970d-pi" width="343" height="291" /></a></p>  <p><strong></strong></p>  <p><strong>Activate Workpoint Radial Menu</strong></p>  <p>The second button in the toolbar activates an object-specific marking menu. As illustrated in the snippet below, if a workpoint is currently selected, then a custom radial marking menu will be displayed upon right-click, which contains two commands.    <br />This object-specific menu is environment dependant. It is not possible to rollback those changes inside a session, so if you want to restore the original marking menu for that kind of object, you would need to store the initial controls for each direction on the original RadialMarkingMenu returned by GetRadialMarkingMenu method.     <br />Such override of the marking menu will also be reinitialized the next time you start Inventor, so if you want it to be persistent, your application will need to handle that customization each time it is loaded.</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> ActivateRadialMarkingMenuCtx _</p>    <p style="margin: 0px">(<span style="color: blue">ByVal</span> Context <span style="color: blue">As</span> Inventor.<span style="color: #2b91af">NameValueMap</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> env <span style="color: blue">As</span> <span style="color: #2b91af">Environment</span> = _Application _</p>    <p style="margin: 0px">&#160;&#160;&#160; .UserInterfaceManager.ActiveEnvironment</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> radialMenu <span style="color: blue">As</span> <span style="color: #2b91af">RadialMarkingMenu</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu = env.GetRadialMarkingMenu _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">ObjectTypeEnum</span>.kWorkPointObject)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Clear all of the buttons from the menu </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' except for undo on the West and the</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' East(button)</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.NorthControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.NortheastControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.NorthwestControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.SouthControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.SoutheastControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.SouthwestControl = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Redefine the East button with a </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' new command.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; radialMenu.EastControl = _Application _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .CommandManager.ControlDefinitions _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;AppMeasureDistanceCmd&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p>Here is a screenshot of the result of selecting a workpoint and then doing a right-click:    <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbbc7970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e9309864970c-pi" width="318" height="329" /></a></p>  <p>&#160;</p>  <p><strong>Toggle Linear Menu</strong></p>  <p>The third button on the toolbar illustrates the customization of the linear marking menu. This is also the old classic context menu. Note that the previous API is still working to customize that menu and was preserved in order to provide continued support for legacy code. You are encouraged to migrate your code to use the new API, as the old one will be retired at some point in the future. </p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> ToggleLinearMarkingMenu _</p>    <p style="margin: 0px">(<span style="color: blue">ByVal</span> Context <span style="color: blue">As</span> Inventor.<span style="color: #2b91af">NameValueMap</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; _bLinearMarkingMenu = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Not</span> _bLinearMarkingMenu</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> _bLinearMarkingMenu = <span style="color: blue">False</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddHandler</span> _UserInputEvents. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OnLinearMarkingMenu, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddressOf</span> OnLinearMarkingMenu</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">RemoveHandler</span> _UserInputEvents _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .OnLinearMarkingMenu, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">AddressOf</span> OnLinearMarkingMenu</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">Private</span> <span style="color: blue">Sub</span> OnLinearMarkingMenu _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">ByVal</span> SelectedEntities <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">ObjectsEnumerator</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> SelectionDevice <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">SelectionDeviceEnum</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> LinearMenu <span style="color: blue">As</span> <span style="color: #2b91af">CommandControls</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> AdditionalInfo <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">NameValueMap</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Iterate each controls in linear menu</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> <span style="color: blue">Each</span> ctrl <span style="color: blue">As</span> <span style="color: #2b91af">CommandControl</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">In</span> LinearMenu</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Uncomment to debug and see _</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' results in output window</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Control: &quot;</span> + _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ctrl.DisplayName + _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot; [&quot;</span> + ctrl.InternalName + <span style="color: #a31515">&quot;]&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Inserts new button and separator in </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' the linear menu</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> (ctrl.InternalName = <span style="color: #a31515">&quot;AppHowToCmd&quot;</span>) <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinearMenu.AddButton _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (_buttonDefRadialMarkingMenu, <span style="color: blue">False</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">True</span>, ctrl.InternalName, <span style="color: blue">True</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinearMenu.AddSeparator _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ctrl.InternalName, <span style="color: blue">True</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p>In this event handler the â€œToggle Vertex Radial Menuâ€ button and a separator above the â€œAppHowToCmdâ€ control are added as seen in this screenshot:&#160; <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163033ad7f5970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340167642fbbe5970b-pi" width="243" height="336" /></a></p>  <p>When you click this menu item the â€œVertex Stuffâ€ radial menu as described above is disabled or enabled. </p>  <p>I believe this VB.NET example will be very helpful if you are just getting started with this part of the API that allows you to incorporate radial marking menus in your application.&#160; </p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: ClientGraphics - text on each planar face
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: clientgraphics-text-on-each-planar-face

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/clientgraphics-text-on-each-planar-face.html 
DATE: 03/20/2012 10:31:30 PM
-----
BODY:
<p>ClientGraphics allow you to provide visual cues to the user and there are many examples in the API help that show how to create ClientGraphics. This VB.NET example is interesting because it shows you how to put text on each planar face in a part. </p>  <p>To create ClientGraphics text, you use TextGraphics and you can control the orientation of the TextGraphics in 3D space. The TextGraphics itself is placed on the x-y plane and along the x-axis but you can reposition it by transforming the graphics node that the TextGraphics is owned by. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676409a086970b-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e90a60c7970c-pi" width="244" height="226" /></a></p>  <p>Below is code from <a href="http://modthemachine.typepad.com/ClientGraphics_Text_Example.zip">this example</a> that creates the ClientGraphics. In the VB.NET project you will also find the functions named FaceNormal and FaceXDir that are called from this Sub. See the comments in the code for more detail on how this example does the work. Notice that the second time you run the code it removes the ClientGraphics. </p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> CreateTextOnEveryPlanarFace()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> partDoc <span style="color: blue">As</span> <span style="color: #2b91af">PartDocument</span></p>    <p style="margin: 0px">&#160;&#160;&#160; partDoc = _InvApplication.ActiveDocument</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> compDef <span style="color: blue">As</span> <span style="color: #2b91af">PartComponentDefinition</span></p>    <p style="margin: 0px">&#160;&#160;&#160; compDef = partDoc.ComponentDefinition</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' Check to see if client graphics already exist.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> clientGraphics <span style="color: blue">As</span> <span style="color: #2b91af">ClientGraphics</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Try</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clientGraphics = compDef. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ClientGraphicsCollection.Item(<span style="color: #a31515">&quot;FaceLabel&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' They do exist so just delete them and exit.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">clientGraphics</span>.Delete()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _InvApplication.ActiveView.Update()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Exit Sub</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Catch</span> ex <span style="color: blue">As</span> <span style="color: #2b91af">Exception</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' They don't exist so create them</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clientGraphics = compDef. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ClientGraphicsCollection.Add(<span style="color: #a31515">&quot;FaceLabel&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Try</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' Iterate over all of the faces in the part.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> count <span style="color: blue">As</span> <span style="color: blue">Integer</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oFace <span style="color: blue">As</span> <span style="color: #2b91af">Face</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> <span style="color: blue">Each</span> oFace <span style="color: blue">In</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; compDef.SurfaceBodies.Item(1).Faces</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Check if the current face is a plane.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> oFace.SurfaceType = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceTypeEnum</span>.kPlaneSurface <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Get a point on the face. This </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' function is good because you're </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' guaranteed to get a(Point) on the </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' face, where-as if you got the </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' center of the face there could be </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' a hole there so the point would </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' be in space.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> facePoint <span style="color: blue">As</span> <span style="color: #2b91af">Point</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; facePoint = oFace.PointOnFace</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Get the normal of the face.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> normal <span style="color: blue">As</span> <span style="color: #2b91af">UnitVector</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; normal = FaceNormal(oFace, facePoint)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Get the X direction of the face</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' (normal along the u).</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> xDir <span style="color: blue">As</span> <span style="color: #2b91af">UnitVector</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xDir = FaceXDir(oFace, facePoint)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Calculate the Y direction by crossing</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' the normal with the x.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> yDir <span style="color: blue">As</span> <span style="color: #2b91af">UnitVector</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yDir = normal.CrossProduct(xDir)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Create a transform to position the text</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' on the face.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> transform <span style="color: blue">As</span> <span style="color: #2b91af">Matrix</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; transform = _InvApplication. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransientGeometry.CreateMatrix</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Call</span> transform. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SetCoordinateSystem(facePoint, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xDir.AsVector, yDir.AsVector, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; normal.AsVector)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Create a graphics node.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oNode <span style="color: blue">As</span> <span style="color: #2b91af">GraphicsNode</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; count = count + 1</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oNode = <span style="color: #2b91af">clientGraphics</span>.AddNode(count)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Create text at the model origin.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> text <span style="color: blue">As</span> <span style="color: #2b91af">TextGraphics</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text = oNode.AddScalableTextGraphics</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> origin <span style="color: blue">As</span> <span style="color: #2b91af">Point</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; origin = _InvApplication. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransientGeometry.CreatePoint(0, 0, 0)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Call</span> text.SetTransformBehavior(origin, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DisplayTransformBehaviorEnum</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kNoTransformBehaviors, 1)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.Text = <span style="color: #a31515">&quot;Face &quot;</span> &amp; count</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.DepthPriority = 1</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.FontSize = 0.1</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.Font = <span style="color: #a31515">&quot;Arial&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.HorizontalAlignment = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">HorizontalTextAlignmentEnum</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAlignTextCenter</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.VerticalAlignment = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">VerticalTextAlignmentEnum</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAlignTextMiddle</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text.Anchor = origin</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Call</span> text.PutTextColor(255, 255, 0)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Transform the graphics node so the text</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' will lie on the face.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oNode.Transformation = transform</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' Update the view to see the results.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; _InvApplication.ActiveView.Update()</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Create an iPart
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: create-an-ipart
CATEGORY: Beginning API

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/create-an-ipart.html 
DATE: 03/14/2012 12:45:35 AM
-----
BODY:
<p>To make a part into an iPart, you use the CreateFactory method of the PartComponentDefinition. The iPartFactory returned by the call to CreateFactory does have a TableRows collection but it does not have an Add method and the way to add the rows that you need for your iPart, may not be obvious. </p>  <p>My colleague Philippe Leefsma has this example that shows what needs to be done. It uses the Excel Spreadsheet returned from the ExcelWorkSheet property of the iPartFactory to create the table used to define the functionality of the iPart. In this <a href="http://modthemachine.typepad.com/iPart_VS_Example.zip">visual studio project</a> you will find the CreateiPart Sub Procedure and a couple of other procedures. One adds a new row to the iPart and the other prints the contents of the table to the immediate window. </p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> CreateiPart()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oPartDoc <span style="color: blue">As</span> <span style="color: #2b91af">PartDocument</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc = _InvApplication.Documents.Add _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">DocumentTypeEnum</span>.kPartDocumentObject, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; _InvApplication.FileManager.GetTemplateFile _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">DocumentTypeEnum</span>.kPartDocumentObject), _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">True</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.SaveAs _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;c:\Temp\iPart_By_API.ipt&quot;</span>, <span style="color: blue">False</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oTG <span style="color: blue">As</span> <span style="color: #2b91af">TransientGeometry</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG = _InvApplication.TransientGeometry</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oCompDef <span style="color: blue">As</span> <span style="color: #2b91af">PartComponentDefinition</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCompDef = oPartDoc.ComponentDefinition</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oPoints(3) <span style="color: blue">As</span> <span style="color: #2b91af">Point2d</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPoints(0) = oTG.CreatePoint2d(0, 0)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPoints(1) = oTG.CreatePoint2d(5, 0)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPoints(2) = oTG.CreatePoint2d(5, 5)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPoints(3) = oTG.CreatePoint2d(0, 5)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oSketch <span style="color: blue">As</span> <span style="color: #2b91af">PlanarSketch</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSketch = oCompDef.Sketches.Add _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oCompDef.WorkPlanes(1))</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oLines(3) <span style="color: blue">As</span> <span style="color: #2b91af">SketchLine</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oLines(0) = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSketch.SketchLines.AddByTwoPoints _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oPoints(0), oPoints(1))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oLines(1) = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSketch.SketchLines.AddByTwoPoints _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oLines(0).EndSketchPoint, oPoints(2))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oLines(2) = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSketch.SketchLines.AddByTwoPoints _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oLines(1).EndSketchPoint, oPoints(3))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oLines(3) = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSketch.SketchLines.AddByTwoPoints _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oLines(2).EndSketchPoint, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oLines(0).StartSketchPoint)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oProfile <span style="color: blue">As</span> <span style="color: #2b91af">Profile</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oProfile = oSketch.Profiles.AddForSolid</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oExtrude <span style="color: blue">As</span> <span style="color: #2b91af">ExtrudeFeature</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oExtrude = oCompDef.Features. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ExtrudeFeatures.AddByDistanceExtent _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oProfile, 15, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PartFeatureExtentDirectionEnum</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kPositiveExtentDirection, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PartFeatureOperationEnum</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kNewBodyOperation, 0)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oExtrude.FeatureDimensions(1). _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Parameter.Name = <span style="color: #a31515">&quot;Length&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oExtrude.FeatureDimensions(2). _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Parameter.Name = <span style="color: #a31515">&quot;TaperAngle&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oFactory <span style="color: blue">As</span> <span style="color: #2b91af">iPartFactory</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oFactory = oCompDef.CreateFactory</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oWS <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Microsoft.Office.Interop.Excel.<span style="color: #2b91af">Worksheet</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS = oFactory.ExcelWorkSheet</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(1, 1) = _</p>    <p style="margin: 0px">&#160;<span style="color: #a31515">&quot;Member&lt;defaultRow&gt;1&lt;/defaultRow&gt;&lt;filename&gt;&lt;/filename&gt;&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(1, 2) = <span style="color: #a31515">&quot;Part Number [Project]&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(1, 3) = <span style="color: #a31515">&quot;Length&lt;free&gt;150 mm&lt;/free&gt;&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(1, 4) = <span style="color: #a31515">&quot;TaperAngle&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(2, 1) = <span style="color: #a31515">&quot;iPart_By_API-01&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(2, 2) = <span style="color: #a31515">&quot;iPart_By_API-01&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(2, 3) = <span style="color: #a31515">&quot;150 mm&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(2, 4) = <span style="color: #a31515">&quot;0 deg&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(3, 1) = <span style="color: #a31515">&quot;iPart_By_API-02&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(3, 2) = <span style="color: #a31515">&quot;iPart_By_API-02&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(3, 3) = <span style="color: #a31515">&quot;100 mm&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(3, 4) = <span style="color: #a31515">&quot;5 deg&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(4, 1) = <span style="color: #a31515">&quot;iPart_By_API-03&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(4, 2) = <span style="color: #a31515">&quot;iPart_By_API-03&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(4, 3) = <span style="color: #a31515">&quot;50 mm&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWS.Cells(4, 4) = <span style="color: #a31515">&quot;10 deg&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oWB <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Microsoft.Office.Interop.Excel.<span style="color: #2b91af">Workbook</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWB = oWS.Parent</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWB.Save()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWB.Close()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.Update()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.Save()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Create a Mini Toolbar
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: create-a-mini-toolbar
CATEGORY: Beginning API

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/03/create-a-mini-toolbar.html 
DATE: 03/02/2012 07:51:33 PM
-----
BODY:
<p>New user-interface elements such as the mini-toolbar were introduced in the 2012 release. The mini-toolbar could be a welcome addition to your applicationâ€™s user interface and making one is fairly easy. In <a href="http://modthemachine.typepad.com/Mini_ToolBar_Example.zip">this example</a> a Visual Basic forms application is used. (Similar steps could be taken to create the toolbar in your Add-In) </p>  <p><strong>Here are the steps to create this example. </strong></p>  <p><strong>1</strong>. Using Visual Studio in a Windows Forms application, add a class. (Name it something like clsMiniToolbar). Also add a button to the form.     <br />&#160; <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e84b46e1970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016302550e26970d-pi" width="446" height="201" /></a></p>  <p><strong>2.</strong> In the click event for the button have it create a New clsMiniToolBar.</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> Button1_Click _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">Object</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">EventArgs</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> Button1.Click</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oMiniToolbar </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">clsMiniToolbar</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">clsMiniToolbar</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p><strong>3.</strong> At the top of the code window for clsMiniToolbar add the following Imports:</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Inventor</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> System.Runtime.InteropServices</span></p> </div>  <p><strong>4</strong>. Add the following declarations to the class. These variables will be instantiated in the constructor for the class (Sub New) that will be added following this step.</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">clsMiniToolbar</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> invApp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">Application</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> started </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Boolean</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_miniToolbar _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">MiniToolbar</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_button1 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MiniToolbarButton</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_button2 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MiniToolbarButton</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_button3 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MiniToolbarButton</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_combo </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MiniToolbarComboBox</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> m_dropDown </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MiniToolbarDropdown</span></p> </div>  <p><strong>5</strong>. Add the Constructor for clsMiniToolbar. When this class is created, the invApp variable is instantiated with the call to GetActiveObject. If this is successful createMiniToolbar is called as long as there is a document open.</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; invApp = </span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.GetActiveObject _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> ex </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Exception</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Need to have a session of Inventor running&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> invApp.Documents.Count &gt; 0 </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; createMiniToolbar()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Need to have a document open&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p><strong>6</strong>. Add the createMiniToolbar Sub Procedure. The CreateMiniToolbar method of the CommandManager is used to instantiate the m_miniToolbar variable. You then use the MiniToolbarControls of the MiniToolbar to add the buttons, ComboBox and Dropdown.</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> createMiniToolbar()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_miniToolbar = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; invApp.CommandManager.CreateMiniToolbar</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> controls </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">MiniToolbarControls</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; controls = m_miniToolbar.Controls</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button1 = controls.AddButton _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyButton1&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Button 1&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;This is button 1&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button2 = controls.AddButton _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyButton2&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Button 2&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;This is button 2&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button2.AutoHide = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_miniToolbar.Controls.AddSeparator()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button3 = controls.AddButton _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyButton3&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Button 3&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;This is button 3&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; controls.AddNewLine()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo = controls.AddComboBox _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyCombo&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">, 35)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Item 1&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Item number 1&quot;</span><span style="line-height: 140%">, , </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Item 2&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Item number 2&quot;</span><span style="line-height: 140%">, , </span><span style="line-height: 140%; color: blue">False</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Item 3&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Item number 3&quot;</span><span style="line-height: 140%">, , </span><span style="line-height: 140%; color: blue">False</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Item 4&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Item number 4&quot;</span><span style="line-height: 140%">, , </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; controls.AddLabel _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyLabel&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Some stuff:&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Stuff&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_dropDown = controls.AddDropdown _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;MyDropdown&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_dropDown.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Thing 1&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Thing 1 tooltip&quot;</span><span style="line-height: 140%">, , , , )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_dropDown.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Thing 2&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Thing 2 tooltip&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_dropDown.AddItem _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Thing 3&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Thing 3 tooltip&quot;</span><span style="line-height: 140%">, , , , )</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_miniToolbar.Visible = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p>When the createMiniToolbar procedure is run it will create this Mini Toolbar:</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016763498da0970b-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016302550e2e970d-pi" width="244" height="107" /></a></p>  <p><strong>7</strong>. Now we need to add the events that will run when the user interacts with controls on the mini toolbar. In this example we are just providing feedback that the event occurred. (Note: If you try this example, the MsgBox items may be behind the Inventor Window.)</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_button1_OnClick1() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_button1.OnClick</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Button 1&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_button2_OnClick1() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_button2.OnClick</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Button 2&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_button3_OnClick1() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_button3.OnClick</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Button 3&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_combo_OnSelect1 _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> ListItem </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">MiniToolbarListItem</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_combo.OnSelect</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Combo selected: &quot;</span><span style="line-height: 140%"> &amp; ListItem.Text)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_combo_OnItemHoverEnd1 _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> ListItem </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">MiniToolbarListItem</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_combo.OnItemHoverEnd</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Debug</span><span style="line-height: 140%">.Print _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Hovered ended over item &quot;&quot;&quot;</span><span style="line-height: 140%"> _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; ListItem.Text &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_combo_OnItemHoverStart1 _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> ListItem </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">MiniToolbarListItem</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_combo.OnItemHoverStart</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Debug</span><span style="line-height: 140%">.Print _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;Hovered started over item &quot;&quot;&quot;</span><span style="line-height: 140%"> _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; ListItem.Text &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_combo_OnItemRemove _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> ListItem </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">MiniToolbarListItem</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_combo.OnItemRemove</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Item removed: &quot;&quot;&quot;</span><span style="line-height: 140%"> _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; ListItem.Text &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_dropDown_OnSelect1 _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; (</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> ListItem </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">MiniToolbarListItem</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_dropDown.OnSelect</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Debug</span><span style="line-height: 140%">.Print(</span><span style="line-height: 140%; color: #a31515">&quot;Dropdown selected: &quot;</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ListItem.Text)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_miniToolbar_OnApply() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_miniToolbar.OnApply</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Apply&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_miniToolbar_OnCancel() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_miniToolbar.OnCancel</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Cancel&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_miniToolbar = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button1 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button2 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button3 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> m_miniToolbar_OnOK() _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> m_miniToolbar.OnOK</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(</span><span style="line-height: 140%; color: #a31515">&quot;Clicked &quot;&quot;Ok&quot;&quot;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_miniToolbar = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button1 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button2 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_button3 = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_combo = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p><strong>(End of the example)</strong></p>  <p>The mini toolbars will be a nice addition to the user interface for your application. The Inventor 2012 API gives you the ability to create these floating, transparent replacements to dialog interfaces. </p>  <p>The API for mini toolbars Support the following:    <br /></p>  <ul>   <li>Apply, OK, Cancel buttons </li>    <li>New lines and separators </li>    <li>Button </li>    <li>Check box </li>    <li>Combo box </li>    <li>Drop-downs </li> </ul>  <p>Mini toolbars are also supported within a command (InteractionEvents) and at Application level (CommandManager) as in this example. </p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Getting data from Content Center
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: getting-data-from-content-center
CATEGORY: Assemblies

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/getting-data-from-content-center.html 
DATE: 02/29/2012 08:38:53 PM
-----
BODY:
<p>You can use GetContentObject() of ContentCenter<em> </em>to get data about an occurrence that was placed from content center. There are two samples that use the ContentCenter object in the API help file, however there is not an example of using GetContentObject(). If you are trying to use this method it will help to know how to create the string so it will return what you need.&#160;&#160;&#160; </p>  <p>In a recent case my colleague Xiaodong Liang explained that if the MemberId is included in the string parameter, GetContentObject() returns the ContentTableRow and if the MemberId is not provided, the method returns the ContentFamily. To get the MemberId you access a PropertySet of the PartDocument. (Use the Definition of the occurrence).</p>  <p><em>PartDocument-&gt;PropertySets-&gt;Content Library Component Properties&gt;item[MemberId].Value.</em></p>  <p><strong>VBA Example</strong>. (Please keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production).</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">Sub GetContentObject_Test()    <br />&#160;&#160;&#160; Dim oOcc As ComponentOccurrence     <br />&#160;&#160;&#160; Set oOcc = ThisApplication.CommandManager.Pick _     <br />&#160;&#160;&#160; (kAssemblyOccurrenceFilter, &quot;Pick occurrence&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If oOcc.DefinitionDocumentType &lt;&gt; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kPartDocumentObject Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;The occurrence is not a CC part.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oOccDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oOccDef = oOcc.Definition     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If Not oOccDef.IsContentMember Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;The occurrence is not a CC part.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Set a reference to the ContentCenter object.</font>     <br />&#160;&#160;&#160; Dim oContentCenter As ContentCenter     <br />&#160;&#160;&#160; Set oContentCenter = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ContentCenter     <br />&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Reference &quot;CC Library Component      <br />&#160;&#160;&#160; ' Properties' propertyset       <br /></font>&#160;&#160;&#160; Dim propSet As PropertySet     <br />&#160;&#160;&#160; Set propSet = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oOccDef.Document.PropertySets.Item _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;{B9600981-DEE8-4547-8D7C-E525B3A1727A}&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Get FamilyId property      <br /></font>&#160;&#160;&#160; Dim familyId As Property     <br />&#160;&#160;&#160; Set familyId = propSet.Item(&quot;FamilyId&quot;)     <br />&#160;&#160; <br />&#160;&#160; <font color="#0000ff">' Get MemberId property      <br /></font>&#160;&#160;&#160; Dim strMemberId As String     <br />&#160;&#160;&#160; strMemberId = propSet(&quot;MemberId&quot;).Value     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim msgBoxResult As VbMsgBoxResult     <br />&#160;&#160;&#160; msgBoxResult = MsgBox _     <br />&#160;&#160; (&quot;Get Family ?&quot;, vbYesNo, &quot;Yes=Family No=Row&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If msgBoxResult = vbYes Then     <br />&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Get family, (Not including memberId)</font>     <br />&#160;&#160;&#160;&#160;&#160;&#160; Dim oContentFamily As ContentFamily     <br />&#160;&#160;&#160;&#160;&#160;&#160; Set oContentFamily = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentCenter.GetContentObject _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;v3#&quot; &amp; familyId.Value &amp; &quot;#&quot;)     <br />&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;family display name: &quot; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; oContentFamily.DisplayName &amp; vbCr &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;family LibraryName name: &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentFamily.LibraryName     <br />&#160;&#160;&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Get Table Row, (Including memberId)</font>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim oContentTableRow As ContentTableRow     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oContentTableRow = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentCenter.GetContentObject _     <br />&#160;&#160;&#160;&#160; (&quot;v3#&quot; &amp; familyId.Value &amp; &quot;#&quot; &amp; strMemberId)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim str As String     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; str = &quot;Data from cells in Table Row&quot; &amp; vbCr     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Debug.Print oContentTableRow.count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 1 To oContentTableRow.count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Debug.Print i&#160; <br />&#160;&#160;&#160;&#160;&#160; ' Debug.Print oContentTableRow.GetCellValue(i)&#160; <br />&#160;&#160;&#160;&#160;&#160; str = str &amp; oContentTableRow.GetCellValue(i)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox str     <br />&#160;&#160;&#160; End If     <br />End Sub</p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Wang
EMAIL: invapp@hotmail.com
IP: 220.233.81.29
URL: 
DATE: 03/04/2012 11:21:54 PM
Hi Wayne,

Is there an example how to place a steel structure from CC? I know there is one in the sample code to place a bolt. Follow that, I can choose which Row to place, but I can't work out how to set the length of that occurrence.

Thanks a lot

Peter
-----
COMMENT:
AUTHOR: Alessandro
EMAIL: projetech.eng@gmail.com
IP: 200.232.245.158
URL: 
DATE: 07/14/2012 09:09:40 PM
Brian it is possible to open the screen of the "Place iLogic Component" through the API using C#? it created an application and want to open this screen and the object escolhor well throw it in assembly using the Place iLogic Component  if you can help me I am very grateful. Alessandro Brazil
 e-mail --- projetech.eng@gmail.com
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Inventor API Labs step by step
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: inventor-api-labs-step-by-step
CATEGORY: Beginning API

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/inventor-api-labs-step-by-step.html 
DATE: 02/25/2012 12:57:30 AM
-----
BODY:
<p>If you are just learning the Inventor API, these <a href="http://www.adskconsulting.com/adn/cs/api_course_webcast_archive.php">webcasts</a> delivered in the spring of 2010 are a great resource. There are labs for each section. (A slide in the presentation). The finished labs that are downloaded with the webcast recordings are very useful however the lab instructions do not have much detail. </p>  <p>When I do labs I usually want to have step by step instructions. If you are like me then the steps in these <a href="http://modthemachine.typepad.com/Inventor_API_Labs_StepByStep.zip">VB.NET projects</a> will be better. There are four VB .NET projects in the zip file. </p>  <ul>   <li>Labs </li>    <li>Labs_Compete </li>    <li>Lab_10_AddIn_Add_To_Ribbon </li>    <li>Lab_10_Complete_AddIn_Add_To_Ribbon </li> </ul>  <p>The Labs project creates a standalone executable that connects to Inventor from out of process. Lab_10_AddIn_Add_To_Ribbon project is an Add-In created by the SDK Add-In wizard.</p>  <p>Here is an example of the Instructions in the Labs project:</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' ***** Start of LAB 2 ***********************</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.1 Add a procedure called iProps. </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Note: put the End Sub below step 2.19</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.2 Declare a variable as a PartDocument </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Name it m_PartDoc</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.3. Make a new PartDocument by using the Add</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' method of the documents collection of the </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Application(variable created in step 3 of LAB1)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' (Instantiate the variable created in 2.2)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.4. Use a For Each loop and iterate through</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' all the PropertySets in the PartDocument </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' created in step 2.3.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Note: put the Next statement below Step 2.10</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.5. Use Debug.print and print the DisplayName </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' of the PropertySet</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.6. Use Debug.print and print the InternalName</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' of the PropertySet</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' 2.7. Use a For Each loop and iterate through </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' all the Property in the PropertySet created in </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' step 2.4.(in the For Each statement)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Note: put the Next statement below Step 2.10 </span></p> </div>  <p>You can use Labs_Complete if you have trouble getting the lab to work right.&#160; </p>  <p>Here is a synopsis of the labs. </p>  <p><strong>Lab1</strong>: Access the Application Object â€“ Connect to an Inventor session change the ActiveView and the caption of the Inventor Window.</p>  <p><strong>Lab2</strong>: iProperties - In this lab you create a procedure that creates a new part document and sets a few iProperties for the part.</p>  <p><strong>Lab3</strong>: UnitsOfMeasure and parameters - Use UnitsOfMeasure to test to see if a string you get from the user is valid. If the value is valid you convert it to a different unit and use the value to update a parameter.</p>  <p><strong>Lab4</strong>: WorkFeatures Sketch &amp; Fetures - Access workaxes and workplanes. You create a new workaxis and workplane. You also create a new part, add a sketch and then extrude it. You also create a SweepFeature. (It needs a SketchLine3d)</p>  <p><strong>Lab5</strong>: B-Rep: In this lab you get information about a selected edge using the curveEvaluator of the edge. You also use the B-Rep API to traverse the solid. You also use LocateUsingPoint and FindUsingRay to get geometry of the model. </p>  <p><strong>Lab6</strong>: â€“ (not finished) It would have done more with the B-Rep API</p>  <p><strong>Lab7</strong>: Sheet Metal â€“ Demonstrates the creation of sheet metal face and cut features. It creates a new sheet metal document, creates a face feature, a cut feature and another face feature. You also create a R12 DXF file. </p>  <p><strong>Lab8</strong>: Assembly Occurrences - Create an assembly and place components. You will also see how to move occurrences by transforming them. This lab also has instructions for exploring proxies and how to add constraints.</p>  <p><strong>Lab9</strong>: Drawings - Create an idw file and see how to add a dimension</p>  <p><strong>Lab10</strong>: Add-In â€“ Create an AddIn that adds buttons to the part and assembly ribbon. The project you complete was created by the Add-In wizard. To get your Add-In to load make sure to edit the .addin file and put the file in a location where Inventor will find it.</p>  <p>The instructions in these labs require some experience with VB.NET programming. If you are just getting started with programming then be sure to go through the â€œ<a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=17324828">My First Plug-In</a>â€ training first. </p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Frank
EMAIL: frankfralick@beckgroup.com
IP: 198.17.222.126
URL: 
DATE: 03/06/2012 08:04:03 PM
related to lab 7, how would you add a flange feature to the face?  I tried and I am getting type mismatch errors wrt:

 oSheetMetalFeatures.FlangeFeatures.CreateFlangeDefinition(Edges, FlangeAngle, Distance)  

I successfully made face features with the same oSheetMetalFeatures.FaceFeatures...etc.  I verified I'm passing in a valid edge (is it to be a collection?), but I guess I'm not getting what type angle and distance need to be.  Tried enumerators, passing in parameters, passing in values from parameters, passing in values like '1.57 deg' etc.  Any help will be greatly appreciated.
-----
COMMENT:
AUTHOR: plumbing
EMAIL: marianne_030796@yahoo.com
IP: 125.60.173.180
URL: http://www.bes.co.uk
DATE: 03/08/2012 06:54:07 AM
I think that is the easiest way to invent lab. Thanks for sharing this step-by-step procedure. I hope that it can help us very well.
-----
COMMENT:
AUTHOR: john
EMAIL: jhtodd123@gmail.com
IP: 112.198.82.75
URL: http://enchanted-graphics.com/index.php/member/112436/
DATE: 06/16/2012 12:11:01 AM
Wow! At last I got a webpage from where I know how to truly take helpful information concerning my study and knowledge.

-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Migrate .Net Add-Ins to registry free
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: migrate-net-add-ins-to-registry-free
CATEGORY: Add-In Creation

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/migrate-net-add-ins-to-registry-free.html 
DATE: 02/24/2012 02:28:01 AM
-----
BODY:
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Inventor 2012 allows your Add-Ins to be loaded without them being registered as a COM component in the Windows registry. These Add-Ins are called â€œregistry free Add-Insâ€. I was sure happy when I could have my Add-In load without having to use the Windows registry. It really makes installing custom applications much&#0160; easier.&#0160; </p>
<p>The Inventor 2012 Add-In wizard provided with the SDK uses a new template that generates a Registry Free Add-In. If you want to migrate your existing Add-Ins without re-creating them from scratch (using the new template) you can follow these five steps. </p>
<p>Happy migration!</p>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong><span style="font-size: small;"><em>1. Remove COM Registration</em><em>&#0160;</em></span></strong></p>
<p>Uncheck the <strong>Register for COM interop</strong> check box on the â€œCompileâ€ tab of the Application Properties dialog, as shown below: </p>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e7e204ad970c-pi"><img alt="image" border="0" height="610" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016762e015a6970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="470" /></a>   
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Note: In Visual Studio Express Edition this setting does not exist.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016762e015b6970b-pi"></a></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Remove any code associated with registering the add-in in the registry. This typically just means removing the <strong><em>Register</em></strong> and <strong><em>Unregister</em></strong> methods from your add-in class. The <strong><em>AddInGuid</em></strong> property is in the same region as the registration functions, so if you intend on using this property in other areas of your add-in youâ€™ll want to be careful not to delete it. </p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong><span style="font-size: small;"><em>2. </em><em>Create the manifest file</em></span></strong></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Create a new file in the same directory as your project file and name it â€œ<em>YourAddin</em>.X.manifestâ€, where <em>YourAddin</em> will be replaced with the name of your add-in. Add the following to the manifest file. The portions highlighted in yellow need to be edited to match your add-in properties: </p>
</td>
</tr>
</tbody>
</table>
<div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;?</span><span style="line-height: 140%; color: #a31515;">xml</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">version</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">1.0</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">encoding</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">UTF-8</span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">standalone</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">yes</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">?&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: #a31515;">assembly</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">xmlns</span><span style="line-height: 140%; color: blue;">=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">urn:schemas-microsoft-com:asm.v1</span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">manifestVersion</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">1.0</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">assemblyIdentity</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">name</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">RegFreeVbAddin</span></span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">version</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">1.0.0.0</span></span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">assemblyIdentity</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">clrClass</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">clsid</span><span style="line-height: 140%; color: blue;">=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">{<span style="background-color: #ffff00;">6e41e3fb-439a-4cbe-b648-ed6a47eeac8d</span>}</span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">progid</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">RegFreeVbAddin.StandardAddInServer</span></span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">threadingModel</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">Both</span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">name</span><span style="line-height: 140%; color: blue;">=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">RegFreeVbAddin.RegFreeVbAddin.StandardAddInServer</span></span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">runtimeVersion</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">1.0</span></span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">clrClass</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">file</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">name</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;"><span style="background-color: #ffff00;">RegFreeVbAddin.dll</span></span><span style="line-height: 140%;">&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">hashalg</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">SHA1</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">file</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">assembly</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
</div>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>The â€œ<em>name</em>â€ attribute of the clrClass element consists of three parts, separated by dots: </p>
<p><strong><em>Assembly.Namespace.ClassName</em></strong></p>
<p><strong><em>&#0160;</em></strong></p>
<p>To make sure, you can retrieve the assembly name and root namespace from your project properties:</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e7e204d3970c-pi"><img alt="image" border="0" height="83" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016301eb4d0f970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="479" /></a></p>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong>Note:</strong> The manifest file is not Unicode!<span style="text-decoration: underline;"> </span></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong><span style="font-size: small;"><em>3. </em><em>Embed the manifest during post-build</em></span></strong></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>The next step is to add a post-build process to incorporate this manifest into your dll. The post-build process calls <strong><em>mt.exe</em></strong> which is a Microsoft utility that will embed the manifest into your AddInâ€™s dll. You define a post-build step through the Compile tab of the Application Properties dialog. On the Compile tab, click the â€œBuild Eventsâ€¦â€ button and then on the â€œBuild Eventsâ€ dialog click the â€œEdit Post-buildâ€¦â€ button. Finally enter the following string by replacing the correct Add-In name into the â€œPost-build Event Command Lineâ€ dialog, as shown below:</p>
<p><strong><em>call &quot;%VS90COMNTOOLS%vsvars32&quot; mt.exe -manifest &quot;$(ProjectDir)<span style="background-color: #ffff00;">RegFreeVbAddin</span>.X.manifest&quot; -outputresource:&quot;$(TargetPath)&quot;;#2</em></strong></p>
</td>
</tr>
</tbody>
</table>
<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834016762e015cc970b-pi"><img alt="image" border="0" height="449" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834016762e015dd970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="477" /></a>   
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Compile your project. This will cause the manifest to be embedded within your dll. If you get any errors when compiling, verify that the command line that you entered matches the one above. </p>
<p>You can verify that the manifest has been correctly embedded by dragging the Add-In dll into Visual Studio. You should see the â€œRT_MANIFESTâ€ folder, as shown below. Double clicking on the â€œ2â€ icon will open a window to show you actual manifest data.</p>
</td>
</tr>
</tbody>
</table>
<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e7e204f5970c-pi"><img alt="image" border="0" height="250" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340168e7e20506970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="477" /></a>   
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>It appears that the â€œbuild eventsâ€ functionality is not provided for Visual Basic Express. It is there for C# Express and of course regular versions of Visual Studio. If you use VB Express you can manually invoke the mt utility from the command line or create a batch file.</p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong><span style="font-size: small;"><em>4. </em><em>Create the .addin file</em></span></strong></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>A requirement for all registry-free Add-Ins is to have an .addin file. With a registry based Add-In, Inventor relied completely on the registry to get information about the Add-In. The .addin file takes the place of the registry for this same information. </p>
<p>The addin filename is in the form of <strong><em>Company.AddInName.Inventor.addin</em></strong></p>
<p>Below is the .addin file for my example Add-In with the portions to change highlighted:</p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: #a31515;">Addin</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">Type</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">Standard</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;!--</span><span style="line-height: 140%; color: green;">Created for Autodesk Inventor Version 16.0</span><span style="line-height: 140%; color: blue;">--&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;!--</span><span style="line-height: 140%; color: green;">Override settings for ApplicationAddIn: RegFreeVbAddin</span><span style="line-height: 140%; color: blue;">--&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">ClassId</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {<span style="background-color: #ffff00;">6e41e3fb-439a-4cbe-b648-ed6a47eeac8d</span>}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">ClassId</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">ClientId</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {<span style="background-color: #ffff00;">6e41e3fb-439a-4cbe-b648-ed6a47eeac8d</span>}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">ClientId</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">DisplayName</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; <span style="background-color: #ffff00;">RegFreeVbAddin</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">DisplayName</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">Description</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; <span style="background-color: #ffff00;">A Registry-free Inventor Addin</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">Description</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">Assembly</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; <span style="background-color: #ffff00;">C:\Autodesk\Inventor\MyAddins\RegFreeVbAddin.dll</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">Assembly</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">LoadOnStartUp</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">1</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">LoadOnStartUp</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">UserUnloadable</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">1</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">UserUnloadable</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">Hidden</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">0</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">Hidden</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">SupportedSoftwareVersionGreaterThan</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; <span style="background-color: #ffff00;">15..</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;/</span><span style="line-height: 140%; color: #a31515;">SupportedSoftwareVersionGreaterThan</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">DataVersion</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">1</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">DataVersion</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">UserInterfaceVersion</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">1</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">UserInterfaceVersion</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160; &lt;</span><span style="line-height: 140%; color: #a31515;">LoadBehavior</span><span style="line-height: 140%; color: blue;">&gt;</span><span style="line-height: 140%;"><span style="background-color: #ffff00;">0</span></span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">LoadBehavior</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: #a31515;">Addin</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>For most AddIns, the <strong>ClassId </strong>(required)<strong> </strong>and <strong>ClientId </strong>(required)<strong> </strong>elements will be the same value, which is the GUID at the top of the StandardAddInServer class. </p>
<p>The value of the <strong>DisplayName </strong>(required)<strong> </strong>element can be anything and is the name of the add-ins as shown in the AddIn Manager. </p>
<p>The <strong>Description </strong>(required)<strong> </strong>element can also be anything and is the description of the add-in as shown in the AddIn Manager.</p>
<p>The <strong>Assembly </strong>(required)<strong> </strong>element defines the name of the AddIn dll. It also defines the path to the dll.</p>
<p>There are 3 ways to specify the location of the binaries:</p>
<ol>
<li>A full path including the dll name. </li>
<li>Only the dll name. Inventor will look for this dll in the &lt;InstallPath&gt;\bin\ folder followed by the folder in which the .addin manifest was found (i.e. same folder as the .addin file). </li>
<li>A relative path including the dll name. Inventor will search for the dll in the specified relative path starting at the &lt;InstallPath&gt;\bin\ folder followed by a search in the specified relative path starting at the folder in which the .addin manifest was found. </li>
</ol>
<p>The <strong>LoadOnStartUp</strong> (optional - obsolete) element specifies whether the add-in should load on start up. Assumed to be true if this value is not specified. Value can be 0 or 1.</p>
<p>The <strong>UserUnloadable</strong> (optional) element specifies whether the user can unload the add-in. Assumed to be true if this value is not specified (i.e. user can unload the add-in). Value can be 0 or 1.</p>
<p>The <strong>Hidden </strong>(optional)<strong> </strong>element defines whether the add-in is visible in the Add-In Manager or not. A value of 1 indicates that it is hidden, although the end-user can still right-click within the Add-In Manager and choose â€œShow hidden membersâ€ to display all add-ins.</p>
<p>The <strong>SupportedSoftwareVersionXXX</strong> (optional) element specifies the version(s) of Inventor that the add-in should be available in. Combinations of these can be used. These values are ignored if the .addin file is located in a version-specific folder (i.e. the add-in is always available for that Inventor version).</p>
<p>The <strong>DataVersion</strong> (optional) element specifies the version of add-in data contained within Inventor documents. To be used by add-ins that store migrating data in Inventor documents, indicated by â€œDocumentInterestsâ€.</p>
<p>The <strong>UserInterfaceVersion</strong> (optional) element specifies the version of the user interface of the add-in. Incrementing this version results in all of the addinâ€™s UI getting cleaned up during Inventor start-up.</p>
<p>The <strong>LoadBehavior</strong> (optional) element allows you to control a brand new feature of Inventor 2012: this will determine for which document type the addin will be loaded. Basically this feature will improve the start-up time of Inventor by delaying the loading of the addin the first time a specific document type is created or open, for example if your addin is only providing part-specific functionalities, you can choose to let Inventor load it only when the user will open his first part in the session.</p>
<p>Here is a table that recaps the various values this flag can take and its effect:</p>
</td>
</tr>
<tr>
<td valign="top">&#0160;</td>
</tr>
</tbody>
</table>
<table border="1" cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="216">
<p>LoadBehavior</p>
</td>
<td valign="top" width="369">
<p>Effect</p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>0</p>
</td>
<td valign="top" width="369">
<p>Load on <strong><em>Start-up </em></strong><em>(not recommended)</em></p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>1</p>
</td>
<td valign="top" width="369">
<p>Load when any <strong><em>document</em></strong> is open/created</p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>2</p>
</td>
<td valign="top" width="369">
<p>Load when first <strong><em>Assembly</em></strong> is open/created</p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>3</p>
</td>
<td valign="top" width="369">
<p>Load when first <strong><em>Presentation</em></strong> is open/created</p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>4</p>
</td>
<td valign="top" width="369">
<p>Load when first <strong><em>Drawing</em></strong> is open/created</p>
</td>
</tr>
<tr>
<td valign="top" width="216">
<p>10</p>
</td>
<td valign="top" width="369">
<p>Load <strong><em>OnDemand</em></strong></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Assumed to be 0 if this value is not specified.</p>
<p><strong>Installer considerations:</strong></p>
<p>In the case you are building an installer to deploy your Add-In, you may wonder how you would handle the situation where you let the user select the location where they will install the Add-In dll itself, as the .addin file needs to reflect this path, and the answer is that you have 2 choices here:</p>
<ol>
<li>Do not let the user select a custom location for the install and provide a relative path or no path at all: Inventor will try to load the addin from the locations described above in the â€œAssemblyâ€ element section. </li>
<li>Let the user select a custom location, in which case you will have to create a custom dll called from a custom action inside your installer that will dynamically perform the editing of the .addin file based on the selected path. </li>
</ol>       </td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p><strong><span style="font-size: small;"><em>5. </em><em>Choose a location for .addin file</em></span></strong></p>
</td>
</tr>
</tbody>
</table>
<table cellpadding="0" cellspacing="0">
<tbody>
<tr>
<td valign="top">
<p>Copy the .addin file to one of the following directories, depending on the scope of your add-in and the operating system. </p>
<p><em>&#0160;</em></p>
<p><strong>Version Independent:</strong></p>
<p><strong><em>&#0160;</em></strong><strong><em>&#0160;</em></strong></p>
<p>The presence of a .addin file in the following locations indicates that the AddIn should be loaded in multiple versions of Inventor based on the values of the â€œSupportedSoftwareVersionXXXâ€ settings in the manifest file. </p>
<p><em>&#0160;</em></p>
<p><em>Windows XP: </em></p>
<p>C:\Documents and Settings\All Users\Application Data\Autodesk\Inventor Addins\ </p>
<p><em>&#0160;</em></p>
<p><em>Windows7/Vista: </em></p>
<p>C:\ProgramData\Autodesk\Inventor Addins\ </p>
<p><em>&#0160;</em></p>
<p><em>&#0160;</em></p>
<p><strong>Version Dependent:</strong></p>
<p><strong><em>&#0160;</em></strong><em>&#0160;</em></p>
<p>The presence of a manifest file in the following locations indicates that the AddIn should be loaded in a specific version of Inventor. The values of the â€œSupportedSoftwareVersionXXXâ€ settings in the manifest file are ignored, if present.</p>
<p><em>Windows XP: </em></p>
<p>C:\Documents and Settings\All Users\Application Data\Autodesk\Inventor 2012\Addins\ </p>
<p><em>&#0160;</em></p>
<p><em>Windows7/Vista: </em></p>
<p>C:\ProgramData\Autodesk\Inventor 2012\Addins\<em> </em></p>
<p><strong><em>&#0160;</em></strong></p>
<p><strong><em>&#0160;</em></strong></p>
<p><strong>Per User Override:</strong></p>
<p><strong><em>&#0160;</em></strong><em></em></p>
<p>The manifest file in the following locations can be created when per user overrides need to be saved. The settings in these manifest files override the setting values in the manifest files found in the â€˜all usersâ€™ folder. The names of these override manifest files match the names of the â€œmasterâ€ files. </p>
<p><em></em></p>
<p><em>Windows XP: </em></p>
<p>C:\Documents and Settings\&lt;user&gt;\Application Data\Autodesk\Inventor 2012\Addins\ </p>
<p><em></em></p>
<p><em>Windows7/Vista: </em></p>
<p>C:\Users\&lt;user&gt;\AppData\Roaming\Autodesk\Inventor 2012\Addins\</p>
<p>After following these steps your Add-In should be found and loaded by Inventor without any entries in the registry.</p>
<p>Wayne Brill </p>
</td>
</tr>
</tbody>
</table>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Samuel Low
EMAIL: harrybrown18@hotmail.com
IP: 188.72.228.12
URL: http://www.mspy.com
DATE: 04/10/2012 01:18:16 PM
Hope I understand the issue as I'm not so familiar with a "well-known" .NET class with an interface. 
-----
COMMENT:
AUTHOR: R. Krieg
EMAIL: r.krieg@metawell.com
IP: 87.149.204.119
URL: 
DATE: 05/05/2012 04:08:45 PM
Hello

Thanks for the tutorial. One question left for me. Is it possible to debug regfree Addins in Visual Studio 2010 Pro and if so, is there anything diffenrent to "normal" Addins?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.9
URL: 
DATE: 05/07/2012 07:33:53 PM
Hello R., You should be able to debug regfree AddIns the same way as you debug any AddIn. Also going forward, "normal" is now "Registry Free". 
Cheers,
Wayne

-----
COMMENT:
AUTHOR: Fred
EMAIL: fagrondin@parker.com
IP: 69.174.58.156
URL: 
DATE: 07/19/2012 07:34:35 PM
Hi,
Thank you very much for the step by step tutorial.
So decided to convert my c# app to registry free and thought I got it but it stil doesn't load. It shows in the Add-Ins as unloaded even if I set it to load at startup. I doesn't matter if i open/create a part it still doesn't load when I do the Loaded/unloaded in the Add-In manager. Any ideas ? I added caption right at the start of my program but don't see anything. I'm running windows 7 32b. Thank you for your help. Regards. Fred
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.29
URL: 
DATE: 07/19/2012 07:49:22 PM
Hi Fred,
From your description it seems like Inventor is finding your AddIn and trying to load it. If you debug and put a breakpoint on the Activate method does it get hit?

Also using a tool like ProcessMonitor to see if the correct dll is being accessed by Inventor could help: <a href="http://technet.microsoft.com/en-us/sysinternals/cb56073f-62a3-4ed8-9dd6-40c84cb9e2f5.aspx">http://technet.microsoft.com/en-us/sysinternals/cb56073f-62a3-4ed8-9dd6-40c84cb9e2f5.aspx</a>

When you built your dll did you have AnyCPU set? Also which version of .NET Framework is it using? Inventor 2012 uses 3.5

Hope this helps,
Wayne
-----
COMMENT:
AUTHOR: Fred
EMAIL: fagrondin@parker.com
IP: 69.174.58.156
URL: 
DATE: 07/19/2012 08:56:38 PM
Hey Wayne,
Thanks for a prompt reply.

It is set to AnyCPU, Inventor 2012 and I'm using .NET 3.5. I tried to put messages to in the activate method right at the start. Nothing happened. Will try the breaks next.
I ran my Process explorer whci I use all the time...-:) and found that if I start Inventor I have my DLL showing the path for process inventor.exe \Device\Mup\servername\...\name.dll & HANDLE ?
May bebecause I use a map network drive ?
Thanks again. Fred
-----
COMMENT:
AUTHOR: Fred
EMAIL: fagrondin@parker.com
IP: 69.174.58.156
URL: 
DATE: 07/19/2012 09:07:15 PM
Wayne,
Just change the path to the dll to C:\MyAddIn\ just to make sure and same thing:

Inventor.exe 352 DLL C:\MyAddIns\...\name.dll
Inventor.exe 352 Handle C:\MyAddIns\...\name.dll

Thanks. Fred
-----
COMMENT:
AUTHOR: Fred
EMAIL: fagrondin@parker.com
IP: 69.174.58.156
URL: 
DATE: 07/20/2012 01:02:08 PM
Hey Wayne,
Got it. All docs tell you in Application -> Assembly Information to uncheck Make assembly COM-Visble. But if I check it back it all works fine. Not sure why and may be you ca nexplain but that will work for me. Thanks you so much for the website and support. Best Regards. Fred
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: XML Ribbon Builder Design Pattern
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: xml-ribbon-builder-design-pattern

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/xml-ribbon-builder-design-pattern.html 
DATE: 02/18/2012 12:08:11 AM
-----
BODY:
<p>We all want to be efficient in our code writing and using design patterns can help with this. A design pattern is utility code that will solve a commonly recurring task. For Inventor AddIns creating the ribbon elements is a common task that can be expedited by using a design pattern. My colleagues Jan Liska and Philippe Leefsma created this example design pattern named AdnRibbonBuilder. This is XML based and provides these advantages:</p>  <ul>   <li>Define Ribbon elements much faster and more easily </li>    <li>Generate the Ribbon items dynamically at loading </li>    <li>Use external XML that can be replaced or modified by user </li> </ul>  <p>To use this design pattern you add the AdnRibbonBuilder class to your project. This class has functions that will create the Ribbon elements by parsing an xml file. Once you have added the class to your project there are two things you need to do.</p>  <ol>   <li>Create the xml file with the settings that will be parsed. There are tags in the xml file that will allow you control where the ribbon element is created and what the ribbon element is. </li>    <li>Call the CreateRibbon or CreateRibbonFromFile methods of the AdnRibbonBuilder class from the Activate method of the AddIn. One of the CreateRibbon parameters is a string that is the name of a resource. (This resource is an embedded xml file). CreateRibbonFromFile takes a string that is a name of an xml file on disk. </li> </ol>  <p>Here is the xml code from the project in this <a href="http://modthemachine.typepad.com/RibbonByXML_Example.zip">zip file</a> that creates a button when it is parsed by AdnRibbonBuilder. Notice that it is going to add the button to the Modify panel on the Part ribbon. The Button will use the ButtonDefintion named Autodesk:RibbonVBTest:Button4. (This ButtonDefinition needs to be already created in the project before the xml file is parsed).</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RibbonTab</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">ribbons</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Part</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">id_TabModel</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">displayName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetTab</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RibbonPanel</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">id_PanelP_ModelModify</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">displayName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetPanel</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Button</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Autodesk:RibbonVBTest:Button4</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">useLargeIcon</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">isInSlideout</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetControl</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RibbonPanel</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RibbonTab</span><span style="line-height: 140%; color: blue">&gt;</span></p> </div>  <p>Below is the code from the attached project that calls CreateRibbonFromFile or CreateRibbon. Having the ability to use an xml file on disk makes it easy to create a different layout of the ribbon elements. If you want to try using the file, rename this file so the extension is only â€œxmlâ€. (Ribbon_By_Xml_Example.ribbons.override.rename_to_just_xml) </p>  <p>The tags in the xml file cause the buttons to be created as a slide out instead of on the main ribbon.&#160; </p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">(</span><span style="line-height: 140%; color: red">isInSlideout</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">&quot;)</span></p> </div>  <p>If this xml file is found (this example is looking for it at the same location of the AddIn dll) it will be used instead of the xml resource.</p>  <p>Here is the code: </p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> asmName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160;&#160;&#160;&#160; Assembly</span><span style="line-height: 140%">.GetExecutingAssembly().GetName().Name</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (System.IO.</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (asmName + </span><span style="line-height: 140%; color: #a31515">&quot;.ribbons.override.xml&quot;</span><span style="line-height: 140%">)) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160; AdnRibbonBuilder</span><span style="line-height: 140%">.CreateRibbonFromFile(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Me</span><span style="line-height: 140%">.GetType,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; asmName + </span><span style="line-height: 140%; color: #a31515">&quot;.ribbons.override.xml&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160; AdnRibbonBuilder</span><span style="line-height: 140%">.CreateRibbon(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Me</span><span style="line-height: 140%">.GetType,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Ribbon_By_Xml_Example.Ribbons.xml&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p> </div>  <p>You can explore the AdnRibbonBuilder class to see how it creates the ribbon elements based on the tags in the xml file. The zip file with the project also has an xml file named ribbons_template.xml. This file has examples of xml tags that will create a few other ribbon elements. Here is the complete list of ribbon elements that AdnRibbonBuilder can create. (From the ProcessPanelNode Sub Procedure).</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Button&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessButtonNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Separator&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessSeparatorNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ButtonPopup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessButtonPopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Popup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessPopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ComboBox&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessComboBoxNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Gallery&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessGalleryNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Macro&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessMacroNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;SplitButton&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessSplitButtonNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;SplitButtonMRU&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; AddressOf</span><span style="line-height: 140%"> ProcessSplitButtonMRUNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;TogglePopup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessTogglePopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case Else</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Continue For</span></p> </div>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Javier
EMAIL: Jubierre@bv.tu-muenchen.de
IP: 138.246.2.50
URL: http://www.cms.bv.tum.de/de/ueber-uns/mitarbeiter/jubierre
DATE: 02/23/2012 03:26:12 PM
Hi Wayne,

this is Javier from Germany. This looks amaizing and I am going to try it out in my research project!!

Thanks for posting such nice things!
-----
COMMENT:
AUTHOR: Georg
EMAIL: GKoehler@Ingenieurbuero-Wagner-Karlsruhe.de
IP: 91.45.172.90
URL: 
DATE: 03/05/2012 03:45:13 PM
Hi Wayne,

I tried the add-in. But the ribbons/buttons do not appear in Inventor. I changed already the path name in Autodesk.Ribbon_By_Xml_Example.Inventor.addin to the real path. What could be wrong?

Thanks

Georg


-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.9
URL: 
DATE: 03/08/2012 12:43:29 AM
Hi Georg,

You can debug the Add-In from Visual Studio. (In properties for the project on the debug tab, change the setting so that it starts up Inventor) Put a break point on one of the first lines in the Activate Sub. Start debugging and step through the code to see where the problem is. If the breakpoint is not getting hit then Inventor is not finding the dll. 

Also there are tools available that will allow you to watch when files are getting accessed. You can use one of these tools to see if the dll file or addin file is being found by Inventor. 

I hope this helps.
Wayne

 

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Manufacturing DevCamp 2012 and DevLab
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: manufacturing-devcamp-2012-and-devlab
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/manufacturing-devcamp-2012-and-devlab.html 
DATE: 02/13/2012 11:32:17 PM
-----
BODY:
<p>Are you interested in customizing, extending or integrating with Autodesk<sup>Â®</sup> Inventor<sup>Â®</sup>, AutoCAD<sup>Â®</sup> Mechanical, Autodesk<sup>Â®</sup> Vault, Autodesk 360 Nexus, new Autodesk web services and mobile technologies, and more?</p>
<p>If yes then the Autodesk Manufacturing DevCamp is for you!</p>
<blockquote>
<p>When: June 13-14, with a DevLab on June 15</p>
</blockquote>
<blockquote>
<p>Where: Portland, Oregon -- near Autodeskâ€™s Manufacturing Division headquarters</p>
</blockquote>
<blockquote>
<p>Cost: early bird discount fee of US $500 valid to April 30, 2012, thereafter US $600</p>
</blockquote>
<p>The 2 day DevCamp offers training for beginners and experts on the APIs of each of the products listed above. You get to talk to Autodesk product management and engineering staff, and to meet fellow developers like you. There is also a Business Development track for those steering their companyâ€™s strategic direction and investments as well as Autodesk specific sales and marketing topics.&#0160; Just one of several featured Autodesk management speakers includes Executive Vice President of Autodesk Manufacturing, Robert â€œBuzzâ€ Kross.</p>
<p>Following on from the DevCamp we are holding a day long DevLab. The DevLab has no agenda as itâ€™s all about spending quality time working with you on your specific needs and challenges. ADN DevTech engineers covering Autodesk technologies â€“ Inventor, AutoCAD Mechanical, Vault and more - are available to help you â€“ 1 to 1. Bring your laptop and work on your code as youâ€™d normally do in your own office. With DevLab you have a team of experts available to review your code, answer your questions, and make suggestions.</p>
<p>CALL TO ACTION â€“ let us know youâ€™re interested!</p>
<p>To receive more information on the DevCamp and DevLab, including the detailed agenda and registration instructions, please send an email to Melrose Ross on email address <a href="mailto:melrose.ross@autodesk.com?subject=Please%20keep%20me%20informed%20about%20the%20Autodesk%20Manufacturing%20DevCamp">melrose.ross@autodesk.com</a> giving your full name and company name.</p>
<p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tom McKeand
EMAIL: tmckeand@cellxion.com
IP: 208.88.70.82
URL: 
DATE: 02/15/2012 07:38:50 PM
What about ETO?
-----
COMMENT:
AUTHOR: Wayne Brill
EMAIL: wayne.brill@autodesk.com
IP: 72.52.96.11
URL: 
DATE: 02/18/2012 12:16:34 AM
Presentations on ETO are being scheduled for the Manufacturing DevCamp. You could also bring your ETO issues to the DevLab. 
-----
--------
AUTHOR: Wayne Brill
AUTHOR EMAIL: wayne.brill@autodesk.com
TITLE: Bitmaps without VB6 IconToIPicture
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: bitmaps-without-vb6-icontoipicture
CATEGORY: Add-In Creation

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/bitmaps-without-vb6-icontoipicture.html 
DATE: 02/10/2012 07:00:02 PM
-----
BODY:
<p>Iâ€™m very excited to be joining Brian as a co-author on this blog. Itâ€™s my first blogging experience and Iâ€™m eager to start writing about the many and varied things weâ€™re doing with Inventorâ€™s API!. To start out I thought it would be interesting to discuss a different way to create IPictureDisp needed for button images.</p>  <p>Having to reference Microsoft.VisualBasic.Compatibility and use Microsoft.VisualBasic.Compatibility.VB6.Support.IconToIPicture() to create an IPictureDisp works, but I always thought there should be a better way to create the image for the user interface. Also in a future release of Inventor there is a good chance that it will support .NET framework 4 and warning messages occur using IconToPicture(). (Inventor 2012 uses .NET 3.5).</p>  <p>I was happy to find a utility class that my colleague Philippe Leefsma recently created that uses stdole.IPictureDisp instead of IconToPicture().</p>  <p>This <a href="http://modthemachine.typepad.com/Bitmap_Without_IconToIPicture.zip">zip file</a> has a project that creates an AddIn that adds a panel to the assemble tab on the assembly ribbon and a panel to the model tab on the part ribbon. This project is a completed lab used in one of the Inventor API trainings. (Originally using IconToIPicture). </p>  <p>Here is the class from the project that creates the IPicutreDisp. (See below for some instructions on how to use this class).</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> System.Runtime.InteropServices</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">NotInheritable</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PictureDispConverter</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">DllImport</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;OleAut32.dll&quot;</span><span style="line-height: 140%">, EntryPoint:= _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;OleCreatePictureIndirect&quot;</span><span style="line-height: 140%">, ExactSpelling:=</span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PreserveSig:=</span><span style="line-height: 140%; color: blue">False</span><span style="line-height: 140%">)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> OleCreatePictureIndirect( _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">MarshalAs</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">UnmanagedType</span><span style="line-height: 140%">.AsAny)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> picdesc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Object</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByRef</span><span style="line-height: 140%"> iid </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Guid</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">MarshalAs</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">UnmanagedType</span><span style="line-height: 140%">.Bool)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> fOwn </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Boolean</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> stdole.</span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> iPictureDispGuid </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Guid</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">GetType</span><span style="line-height: 140%">(stdole.</span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span><span style="line-height: 140%">).GUID</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">NotInheritable</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PICTDESC</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Picture Types</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_UNINITIALIZED </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = -1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_NONE </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = 0</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_BITMAP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = 1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_METAFILE </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = 2</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_ICON </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = 3</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> PICTYPE_ENHMETAFILE </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Short</span><span style="line-height: 140%"> = 4</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">StructLayout</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">LayoutKind</span><span style="line-height: 140%">.Sequential)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Icon</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> cbSizeOfStruct </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.SizeOf(</span><span style="line-height: 140%; color: blue">GetType</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.</span><span style="line-height: 140%; color: #2b91af">Icon</span><span style="line-height: 140%">))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> picType </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.PICTYPE_ICON</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> hicon </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%">.Zero</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> unused1 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> unused2 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> icon </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Drawing.</span><span style="line-height: 140%; color: #2b91af">Icon</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Me</span><span style="line-height: 140%">.hicon = icon.ToBitmap().GetHicon()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">StructLayout</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">LayoutKind</span><span style="line-height: 140%">.Sequential)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Bitmap</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> cbSizeOfStruct </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.SizeOf(</span><span style="line-height: 140%; color: blue">GetType</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.</span><span style="line-height: 140%; color: #2b91af">Bitmap</span><span style="line-height: 140%">))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> picType </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.PICTYPE_BITMAP</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> hbitmap </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%">.Zero</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> hpal </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #2b91af">IntPtr</span><span style="line-height: 140%">.Zero</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> unused </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Friend</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> bitmap </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Drawing.</span><span style="line-height: 140%; color: #2b91af">Bitmap</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Me</span><span style="line-height: 140%">.hbitmap = bitmap.GetHbitmap()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> ToIPictureDisp(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> icon </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%">&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; System.Drawing.</span><span style="line-height: 140%; color: #2b91af">Icon</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> stdole.</span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> pictIcon </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.</span><span style="line-height: 140%; color: #2b91af">Icon</span><span style="line-height: 140%">(icon)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> OleCreatePictureIndirect(pictIcon, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iPictureDispGuid, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> ToIPictureDisp(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> bmp _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Drawing.</span><span style="line-height: 140%; color: #2b91af">Bitmap</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> stdole.</span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> pictBmp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PICTDESC</span><span style="line-height: 140%">.</span><span style="line-height: 140%; color: #2b91af">Bitmap</span><span style="line-height: 140%">(bmp)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> OleCreatePictureIndirect(pictBmp, _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iPictureDispGuid, </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p> </div>  <p>How to use the PictureDispConverter class. </p>  <p>1. Add a reference to stdole (On the .NET tab of the Add Reference dialog) </p>  <p>2. In your project add a new class and copy the code above into the class. </p>  <p>3. Create a resource in the project.</p>  <p>4. Call&#160; PictureDispConverter.ToIPictureDisp() and pass in the resource. Here is the code from the attached project that does this.</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> mIPictureDisp1 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PictureDispConverter</span><span style="line-height: 140%">.ToIPictureDisp _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">My</span><span style="line-height: 140%">.Resources.Tools)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160; Dim</span><span style="line-height: 140%"> mIPictureDisp2 </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IPictureDisp</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PictureDispConverter</span><span style="line-height: 140%">.ToIPictureDisp _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">My</span><span style="line-height: 140%">.Resources.wbTest)</span></p> </div>  <p>&#160;</p>  <p>Wayne Brill</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Mike Kazakov
EMAIL: mikazakov@mail.ru
IP: 93.157.47.16
URL: 
DATE: 02/22/2012 02:36:46 PM
Hi Brian.
I used to use next function:

 Public Function ImageToIPicture(ByVal Image As System.Drawing.Image) As stdole.IPictureDisp
        Return System.Windows.Forms.AxHost.GetIPictureFromPicture(Image)
    End Function

and next function

 Public Function IPictureToImage(ByVal oPicture As stdole.StdPicture) As System.Drawing.Image
        Return System.Windows.Forms.AxHost.GetPictureFromIPicture(oPicture)
    End Function

It was a short and convenient :)

The truth is now to Windows7x64 Function IPictureToImage have a bug by converting.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Welcome a New Blog Co-Author
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: welcome-a-new-blog-co-author
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2012/02/welcome-a-new-blog-co-author.html 
DATE: 02/04/2012 12:14:54 AM
-----
BODY:
<p>As much as I would like to spend time writing posts for this blog, my other day-to-day work has gotten to be too much for me to be able to regularly write posts.&#0160; I hope things slow down in the future and Iâ€™ll be able to get back to contributing more.</p>
<p>In order to keep this blog alive a new author has been recruited.&#0160; Iâ€™d like you to meet Wayne Brill.&#0160; Wayne is a member of the Developer Technical Services (DevTech) team which is a part of <a href="http://www.autodesk.com/developer">Autodesk Developer Network</a> (ADN).&#0160; This is the group that supports external developers that are writing applications for Autodesk products.&#0160; Wayne has worked for Autodesk in a technical role for many years. (Last year he celebrated his 20th year at Autodesk). The API&#39;s he supports are Inventor, including iLogic and Engineering to Order (previously known as Intent). Wayne also supports the API&#39;s for AutoCAD, AutoCAD Mechanical and Vault.</p>
<p>Wayne will be posting regularly and will be getting help from some of his colleagues in DevTech.&#0160; Iâ€™m sure youâ€™ll appreciate a different perspective on programming Inventor and Iâ€™m sure weâ€™ll see some helpful and interesting posts from Wayne.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Doug Redmond
EMAIL: 
IP: 72.52.96.11
URL: http://profile.typepad.com/6p0120a5728249970b
DATE: 02/06/2012 01:17:08 PM
Welcome Wayne to the wonderful world of blogging!
-----
COMMENT:
AUTHOR: Tom McKeand
EMAIL: tmckeand@cellxion.com
IP: 208.88.70.82
URL: 
DATE: 02/06/2012 02:37:58 PM
Welcome Wayne. Looking forward to the new articles.
-----
COMMENT:
AUTHOR: MegaJerk
EMAIL: GarbageDonkey@gmail.com
IP: 70.225.227.195
URL: 
DATE: 02/06/2012 05:05:04 PM
I look forward to seeing the content continuing on this blog. For a moment there, I was worried that Brian hated us ;)

Welcome Wayne! 
-----
COMMENT:
AUTHOR: scott
EMAIL: scott_moyse1@hotmail.com
IP: 180.222.65.87
URL: 
DATE: 02/07/2012 07:37:14 PM
Love it can't wait
-----
COMMENT:
AUTHOR: Autodesk Inventor-Russia
EMAIL: 
IP: 82.220.1.196
URL: http://profile.typepad.com/6p013485f79c90970c
DATE: 02/08/2012 10:50:10 AM
Welcome Wayne!
-----
COMMENT:
AUTHOR: excel development
EMAIL: justreadup2@gmail.com
IP: 203.87.176.4
URL: http://www.clickconsulting.com/development/excel-development
DATE: 03/10/2012 03:21:58 PM
Hi! i'm just new to blogging, I want to make my friend a co-author of my new blog. How do I add him so he can post new articles?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Self-Pace Inventor API Development Guide
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: self-pace-inventor-api-development-guide
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/08/self-pace-inventor-api-development-guide.html 
DATE: 08/22/2011 07:39:36 PM
-----
BODY:
<p>The Autodesk Developer Network (ADN) has recently released a self-paced guide for Inventor API development called â€œMy First Plug-inâ€.&#0160; The guide is designed for those of you that are new to programming and doesnâ€™t assume any previous programming experience.&#0160; Most of the content discusses basic programming concepts and then lets you put them into practice utilizing Inventorâ€™s API (Application Programming Interface) to create a simple program to control the display of occurrences within an assembly.</p>
<p>Even for those of you that are experienced Inventor API developers, if youâ€™ve been using VBA this will serve as a good introduction to VB.Net.&#0160; It uses Visual Basic Express, which is available as a free download from Microsoft.</p>
<p>Clicking the picture below will take you to the â€œMy First Plug-In Trainingâ€ page for Inventor.&#0160; There is also a similar tutorial for Revit.</p>
<p><a href="http://www.autodesk.com/myfirstinventorplugin"><img alt="FirstPlug-In" border="0" height="88" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834015390e845ee970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="FirstPlug-In" width="351" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jean Pacher
EMAIL: 
IP: 187.112.193.80
URL: http://profile.typepad.com/pacher
DATE: 08/22/2011 08:17:49 PM
The guide helps a lot.
The material is very good to understand a little more about the Inventor API
-----
COMMENT:
AUTHOR: injection mold
EMAIL: infobiaoma26@126.com
IP: 182.148.170.223
URL: http://www.vulcanmold.com
DATE: 09/06/2011 06:49:51 AM
it is wonderful. thanks for your sharing and helping. we are a injection molding manufacturer in china , if you need, we can have a cooperation.OK/?
-----
COMMENT:
AUTHOR: Aksel
EMAIL: akselsc@hotmail.com
IP: 200.19.188.1
URL: 
DATE: 10/06/2011 08:22:09 PM
Help-me Create a ReplaceFace feature.
    If Surface Then
    ' Create a new workplane parallel to the XY plane.
    Dim oWorkPlane As WorkPlane
    Set oWorkPlane = oCompDef.WorkPlanes.AddByPlaneAndOffset(oCompDef.WorkPlanes.Item(3), 53)
    
    ' Create a 2d sketch to use as one section.
    Set oSketch = oCompDef.Sketches.Add(oWorkPlane)
    Call oSketch.SketchLines.AddAsTwoPointRectangle(oTG.CreatePoint2d(1, 1), oTG.CreatePoint2d(98, m - 3))

   ' Create a profile.
    Dim oProfile1 As Profile
    Set oProfile1 = oSketch.Profiles.AddForSolid

    ' Create a base extrusion 1cm thick.
    Dim oExtrude1 As ExtrudeFeature
    Set oExtrude1 = oCompDef.Features.ExtrudeFeatures.AddByDistanceExtent(oProfile1, 1, kNegativeExtentDirection, kJoinOperation)

    
    ' Get the top face of the extrusion to use for creating the new sketch.
    Dim oFrontFace As Face
    Set oFrontFace = oExtrude1.StartFaces.Item(1)
    
    End If

    ' Create the loft definition. Because one of the ends isn't planar,
    ' a surface must be created instead of a solid.
    Dim oLoftDefinition As LoftDefinition
    Set oLoftDefinition = oCompDef.Features.LoftFeatures.CreateLoftDefinition(oSections, kSurfaceOperation)

    ' Create the loft feature.
    Call oCompDef.Features.LoftFeatures.Add(oLoftDefinition)
    
    If Surface Then
    

    
    ' Create a ReplaceFace feature.
    Dim oReplaceFaceFeature As ReplaceFaceFeatures
    'Set oReplaceFaceFeature = oCompDef.Features.ReplaceFaceFeatures.?????
    
    End If
-----
COMMENT:
AUTHOR: cartoner
EMAIL: amy.78@yahoo.com
IP: 109.186.120.164
URL: http://www.leadpackaging.com/category.php?cat=Horizontal%20End%20load%20cartoner
DATE: 12/15/2011 08:15:16 AM
the guide helped me alot. i understand much more about the invertor API now.
-----
PING:
TITLE: Tatiana Bilbrey
URL: http://KITCHENANDHOUSEWARESREVIEWS.INFO
IP: 72.213.11.176
BLOG NAME: Tatiana Bilbrey
DATE: 01/12/2012 09:13:06 AM
Really enjoyed this article post.Really thank you! Fantastic.
-----
PING:
TITLE: Corbin Irving
URL: http://www.expedia-air-travel.net
IP: 72.213.11.176
BLOG NAME: Corbin Irving
DATE: 12/23/2011 08:59:03 AM
Looking forward to reading more. Great blog.Really thank you! Much obliged.
-----
PING:
TITLE: Royce Renfroe
URL: http://www.whatmehey.com
IP: 208.66.17.32
BLOG NAME: Royce Renfroe
DATE: 12/10/2011 08:45:31 AM
Muchos Gracias for your article.Really looking forward to read more. Cool.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Writing Work Points to an Excel File
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: writing-work-points-to-an-excel-file
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/06/writing-work-points-to-an-excel-file.html 
DATE: 06/27/2011 08:20:48 PM
-----
BODY:
<p>Hereâ€™s a solution to another problem that was recently posed.&#160; A customer is creating work points in a part and then needs an Excel file that has the coordinates of the work points.&#160; Hereâ€™s a VBA macro that will create a .csv file that contains the coordinates of the work points.&#160; If you select any work points before running the macro, it will give you the option of exporting only the selected work points or exporting all of the work points.&#160; If no work points are selected, then it will export all work points.&#160; Let me know if you find any issues or have suggestions on how to improve it.</p>  <p><font style="background-color: #ffff00">Update: Since I first posted this I received a question about how to have the macro use the current length units of the document.&#160; Iâ€™ve modified it so it now does that.&#160; Previously it was using the internal length unit of centimeters.&#160; It now uses the length specified for the document, but it ignores the number of decimal places specified for the document and always writes out up to 8 decimal places.</font></p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">Public Sub ExportWorkPoints()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active part document.        <br /></strong></font>&#160;&#160;&#160; Dim partDoc As PartDocument     <br />&#160;&#160;&#160; If ThisApplication.ActiveDocumentType = kPartDocumentObject Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A part must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see if any work points are selected.        <br /></strong></font>&#160;&#160;&#160; Dim points() As WorkPoint     <br />&#160;&#160;&#160; Dim pointCount As Long     <br />&#160;&#160;&#160; pointCount = 0     <br />&#160;&#160;&#160; If partDoc.SelectSet.Count &gt; 0 Then     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Dimension the array so it can contain the full        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' list of selected items.         <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReDim points(partDoc.SelectSet.Count - 1)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim selectedObj As Object     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; For Each selectedObj In partDoc.SelectSet     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If TypeOf selectedObj Is WorkPoint Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(pointCount) = selectedObj     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointCount = pointCount + 1     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReDim Preserve points(pointCount - 1)     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Ask to see if it should operate on the selected points        <br />&#160;&#160;&#160; ' or all points.         <br /></strong></font>&#160;&#160;&#160; Dim getAllPoints As Boolean     <br />&#160;&#160;&#160; getAllPoints = True     <br />&#160;&#160;&#160; If pointCount &gt; 0 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim result As VbMsgBoxResult     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; result = MsgBox(&quot;Some work points are selected.&#160; &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Do you want to export only the &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;selected work points?&#160; (Answering &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;&quot;&quot;No&quot;&quot; will export all work points)&quot;, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vbQuestion + vbYesNoCancel)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If result = vbCancel Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If result = vbYes Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; getAllPoints = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If MsgBox(&quot;No work points are selected.&#160; All work points&quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot; will be exported.&#160; Do you want to continue?&quot;, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vbQuestion + vbYesNo) = vbNo Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim partDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set partDef = partDoc.ComponentDefinition     <br />&#160;&#160;&#160; If getAllPoints Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReDim points(partDef.WorkPoints.Count - 2)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get all of the workpoints, skipping the first,        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' which is the origin point.         <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim i As Integer     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 2 To partDef.WorkPoints.Count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(i - 2) = partDef.WorkPoints.Item(i)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the filename to write to.        <br /></strong></font>&#160;&#160;&#160; Dim dialog As FileDialog     <br />&#160;&#160;&#160; Dim filename As String     <br />&#160;&#160;&#160; Call ThisApplication.CreateFileDialog(dialog)     <br />&#160;&#160;&#160; With dialog     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DialogTitle = &quot;Specify Output .CSV File&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Filter = &quot;Comma delimited file (*.csv)|*.csv&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .FilterIndex = 0     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .OptionsEnabled = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MultiSelectEnabled = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .ShowSave     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = .filename     <br />&#160;&#160;&#160; End With     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If filename &lt;&gt; &quot;&quot; Then     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Write the work point coordinates out to a csv file.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error Resume Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Open filename For Output As #1     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Err.Number &lt;&gt; 0 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Unable to open the specified file. &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;It may be open by another process.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get a reference to the object to do unit conversions.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim uom As UnitsOfMeasure     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set uom = partDoc.UnitsOfMeasure     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Write the points, taking into account the current default       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' length units of the document.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 0 To UBound(points)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim xCoord As Double     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xCoord = uom.ConvertUnits(points(i).Point.X, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kCentimeterLengthUnits, kDefaultDisplayLengthUnits)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim yCoord As String     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yCoord = uom.ConvertUnits(points(i).Point.Y, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kCentimeterLengthUnits, kDefaultDisplayLengthUnits)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim zCoord As String     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; zCoord = uom.ConvertUnits(points(i).Point.Z, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kCentimeterLengthUnits, kDefaultDisplayLengthUnits)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Print #1, points(i).Name &amp; &quot;,&quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(xCoord, &quot;0.00000000&quot;) &amp; &quot;,&quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(yCoord, &quot;0.00000000&quot;) &amp; &quot;,&quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(zCoord, &quot;0.00000000&quot;)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Close #1     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Finished writing data to &quot;&quot;&quot; &amp; filename &amp; &quot;&quot;&quot;&quot;     <br />&#160;&#160;&#160; End If     <br />End Sub</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Scott Moyse
EMAIL: Scott@smigroup.co.nz
IP: 118.90.61.20
URL: http://www.smigroup.co.nz
DATE: 06/28/2011 01:32:55 PM
Brian,

Once again more great stuff. Unrelated to this topic but I'm hoping you would be kind enough to read through this thread <a href="http://forums.autodesk.com/t5/Autodesk-Inventor/Inventor-for-Woodworkers-Joinery-Millwork-and-Cabinetry-Design/td-p/3064850/highlight/false">http://forums.autodesk.com/t5/Autodesk-Inventor/Inventor-for-Woodworkers-Joinery-Millwork-and-Cabinetry-Design/td-p/3064850/highlight/false</a> and maybe give some advice or offer an opinion? The length, Width, Thickness being automatically generated for irregular shaped or irregular orientated parts is the biggest issue for Inventor woodworkers and I'm sure a lot of Inventor users creating parts lists for ordering stock, or creating cut lists. Then there are a few other points in that thread that may be of interest to you.

Cheers for any help you may have the time to give

Scott
-----
COMMENT:
AUTHOR: Dan Margulius
EMAIL: 
IP: 46.117.114.198
URL: http://profile.typepad.com/margulius
DATE: 07/06/2011 08:29:41 PM
Hey,
I am looking for a macro wich can extract iproperties to excel. Do you have something like that? 

Thanks
-----
COMMENT:
AUTHOR: Aksel
EMAIL: akselsc@hotmail.com
IP: 200.19.188.1
URL: 
DATE: 10/07/2011 11:48:16 PM
Very good
How hability visible work point?
Last Creat Spline;
Att..
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Moving a Part in a Flexible Assembly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: moving-a-part-in-a-flexible-assembly
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/06/moving-a-part-in-a-flexible-assembly.html 
DATE: 06/20/2011 11:27:38 PM
-----
BODY:
<p>I recently received a question that I thought there might be some general interest in the answer.&#160; Hereâ€™s the problem.&#160; I have the assembly shown below.&#160; Itâ€™s free to move in the ways you would expect; it can pivot about the base and the arm can extend.&#160; Everything is fine so far.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834014e8944fce9970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="ArmAssembly" border="0" alt="ArmAssembly" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f51b996970b-pi" width="321" height="321" /></a></p>  <p>Next I insert the arm assembly shown above into a new assembly.&#160; Then I insert the yellow block part into the assembly and constrain it to the tip of the arm, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f51b99b970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="ArmAssemblyFull" border="0" alt="ArmAssemblyFull" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834014e8944fcee970d-pi" width="313" height="327" /></a></p>  <p>First, the arm assembly is rigid if I try to move any of its parts.&#160; Thatâ€™s the behavior I would expect because, by default, subassemblies are rigid within an assembly.&#160; However, you can set the subassembly occurrence to be â€œflexibleâ€ so that it will behave the same as it does when the subassembly is active.&#160; That is, the arms can be dragged and the positions of all of the connected parts will update.&#160; I can also drag the yellow block and that will cause the arms to reposition to follow the block.</p>  <p>The question posed was how to move the block using the API and still get the arms to follow.&#160; The expectation, which I shared, is that setting the transformation for the yellow block to reposition it should automatically reposition everything else thatâ€™s connected to it.&#160; This is probably how it should behave but itâ€™s not.&#160; When setting the position of the yellow block nothing happens.&#160; The yellow block doesnâ€™t move and the arm subassembly doesnâ€™t move.</p>  <p>I played around with a couple of ideas and one of them does work.&#160; Itâ€™s simple to implement so should be an acceptable workaround.&#160; It temporarily grounds the part thatâ€™s being moved.&#160; The API to move a part will move a grounded part and when the assembly computes, the grounded part has a higher priority in the solver than the flexible assembly so the flexible assembly adjusts to the change.</p>  <p>Hereâ€™s the code I used to test this.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">Public Sub MovePart()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Have the occurrence that will be moved selected.        <br /></strong></font>&#160;&#160;&#160; Dim occ As ComponentOccurrence     <br />&#160;&#160;&#160; Set occ = ThisApplication.CommandManager.Pick( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAssemblyOccurrenceFilter, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select an occurrence.&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the current grounded state of the selected occurrence.&#160; <br /></strong></font>&#160;&#160;&#160; Dim groundState As Boolean     <br />&#160;&#160;&#160; groundState = occ.Grounded     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Ground the occurrence.        <br /></strong></font>&#160;&#160;&#160; occ.Grounded = True     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Change the position of the occurrence.&#160; This repositions it        <br />&#160;&#160;&#160; ' in a series of steps to create a short animation.&#160; It moves         <br />&#160;&#160;&#160; ' it 0.5 cm in the Y direction for each step.         <br /></strong></font>&#160;&#160;&#160; Dim i As Integer     <br />&#160;&#160;&#160; For i = 1 To 10     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim trans As Matrix     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set trans = occ.Transformation     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Cell(2, 4) = trans.Cell(2, 4) + .5     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; occ.Transformation = trans     <br />&#160;&#160;&#160; Next    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Reset the grounded state of the occurrence back to        <br />&#160;&#160;&#160; ' its original state.         <br /></strong></font>&#160;&#160;&#160; occ.Grounded = groundState     <br />End Sub</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Subir Kumar Dutta
EMAIL: cad.customizations@gmail.com
IP: 121.241.235.98
URL: http://www.youtube.com/watch?v=CrZ_o8klPfY
DATE: 12/14/2011 10:20:02 AM
Hi,
 I am looking for developing inverse kinematics motion for Robot Simulation with-in Inventor. But I have to use C++ for it. Because I have to integrate a C++ library for the calculations.

Most of the samples I found are in VB or VB.net. Where to find good c++ samples for Inventor API.

Well, for moving the parts in assembly, what is the best way ? Manipulating with transformation matrix or driving the parameters programatically in a loop ?

Please suggest

Subir Kumar Dutta
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Last Chance for Input
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: last-chance-for-input
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/06/last-chance-for-input.html 
DATE: 06/15/2011 05:06:48 PM
-----
BODY:
<p>The Inventor API survey has been extended.&#0160; You now have until June 17th to provide your input.&#0160; This helps us a lot in determining what weâ€™re going to do in upcoming releases so please give us your opinion on whatâ€™s important.</p>
<p><a href="http://www.zoomerang.com/Survey/WEB22C9QBPTEZ5"><strong>http://www.zoomerang.com/Survey/WEB22C9QBPTEZ5</strong></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Correction to Feature Stepper Macro
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: correction-to-feature-stepper-macro
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/06/correction-to-feature-stepper-macro.html 
DATE: 06/14/2011 12:00:08 AM
-----
BODY:
<p>Iâ€™ve just corrected a problem to the code from my <a href="http://modthemachine.typepad.com/my_weblog/2011/06/stepping-through-the-features-of-a-model.html">previous post</a> for the macro that steps through the features in a part.&#160; It just shows you that I didnâ€™t test if very thoroughly.&#160; The previous version only works on sheet metal parts.&#160; The new version works on regular parts too.&#160; If you already got the code, you just need to download the zip file, unpack it, delete the form from your VBA project, and re-import the form file.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Stepping Through the Features of a Model
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: stepping-through-the-features-of-a-model
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/06/stepping-through-the-features-of-a-model.html 
DATE: 06/10/2011 09:01:20 PM
-----
BODY:
<p>A recent question came in about a way to make it easy to step through the features in the browser.&#160; Of course you can do this manually by dragging the stop node feature-by-feature in the tree, but that quickly becomes tedious.&#160; Hereâ€™s my answer to problem.&#160; Itâ€™s a small VBA program that displays a form as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4b9970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep" border="0" alt="FeatureStep" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4c1970c-pi" width="165" height="91" /></a></p>  <p>Pressing the buttons letâ€™s you move the stop node to the top, to the bottom, or advanced it one step at a time, either up or down the tree.&#160; A utility like this can be useful when youâ€™ve received a model from someone else and want to understand how it was built.</p>  <p>I think the trickiest part about using this program will be adding it to your VBA project.&#160; Fortunately you only have to do that once.&#160; Below is the step-by-step process to add it to your default VBA project and create a button in the ribbon to execute it.</p>  <ol>   <li>Download and unzip the <a href="http://modthemachine.typepad.com/FeatureStep.zip">code files</a>.&#160; You can unzip them anywhere on your computer. </li>    <li>Run Inventor and open the VBA development environment, (Alt-F11). </li>    <li>Right-click on the â€œApplicationProjectâ€ node in the Project window and select â€œImport Fileâ€¦â€, as shown below.      <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4c7970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep VBA1" border="0" alt="FeatureStep VBA1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4cd970c-pi" width="379" height="401" /></a>       <br /></li>    <li>Select the â€œFeatureStep.frmâ€ file that you unpacked previously from the zip file.      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4d3970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep VBA3" border="0" alt="FeatureStep VBA3" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4e1970c-pi" width="404" height="284" /></a>       <br /></li>    <li>In the VBA project window, double-click on Module1, within the Modules folder.&#160; This will open up the code window.&#160; <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb4fc970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="FeatureStep VBA4" border="0" alt="FeatureStep VBA4" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f196525970b-pi" width="464" height="298" /></a>      <br /></li>    <li>Copy and paste the code below into that window, as shown above.      <br />      <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Macro to reposition stop node in browser.            <br /></strong></font>Public Sub FeatureStep()         <br />&#160;&#160;&#160; Dim featureStepForm As New frmFeatureStep         <br />&#160;&#160;&#160; If featureStepForm.Init Then         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; featureStepForm.Show vbModeless         <br />&#160;&#160;&#160; End If         <br />End Sub&#160;&#160; <br /></p>   </li>    <li>The following steps will create a button on the ribbon to run the macro.&#160; Have a part open, making sure youâ€™re in the modeling environment and a sketch is not active.&#160; Right-click anywhere on the ribbon and select the â€œCustom User Commandsâ€¦â€ command from the context menu, as shown below.     <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834014e890c9e85970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep VBA5" border="0" alt="FeatureStep VBA5" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f196541970b-pi" width="349" height="328" /></a>       <br /></li>    <li>In the Customize dialog, first choose â€œMacrosâ€ in the â€œChoose commands fromâ€ drop-down.&#160; Next, select the â€œFeatureStepâ€ macro from the list.&#160; (If itâ€™s not in the list, double-check that you followed the previous steps correctly.)&#160; Finally, click the â€œ&gt;&gt;â€ button to move that macro the to the right side of the dialog.      <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f196554970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="FeatureStep VBA6" border="0" alt="FeatureStep VBA6" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb530970c-pi" width="454" height="369" /></a>       <br /></li>    <li>Edit the settings on the button to display text.      <br />      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f19656f970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep VBA7" border="0" alt="FeatureStep VBA7" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f19657c970b-pi" width="320" height="96" /></a>       <br />      <br />You should see the following in the ribbon.&#160; If you want the command available on the Sheet Metal modeling ribbon, youâ€™ll need to repeat steps 6 through 8 while a sheet metal document is open.      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834015432ecb556970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="FeatureStep VBA8" border="0" alt="FeatureStep VBA8" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401538f196598970b-pi" width="163" height="120" /></a>       <br /></li> </ol>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: help
EMAIL: in@need.com
IP: 80.35.14.65
URL: 
DATE: 06/13/2011 08:44:16 AM
With Inventor Professional 2011 I get a run-time error 9; subscript out of range.

Can you help me solve this?

Thank you!
-----
COMMENT:
AUTHOR: help
EMAIL: in@need.com
IP: 80.35.14.65
URL: 
DATE: 06/14/2011 09:05:21 AM
(here I'm again)

Thanks a lot! Thanks for the code and for the fast correction.
It works great for me in a part file.
It's very usefull.

Keep it up!

-----
COMMENT:
AUTHOR: Falgun
EMAIL: fshah@aaeltd.com
IP: 63.250.108.149
URL: 
DATE: 07/28/2011 01:35:53 PM
It's really handy, especially for other's part to work on. Can it possible to create macro for assembly environment?

Thanks

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-survey
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/05/inventor-api-survey.html 
DATE: 05/24/2011 12:40:05 AM
-----
BODY:
<p>Itâ€™s time once again to make your voice heard.&#0160; The annual Inventor API survey has begun and is all about getting your input about what API functionality we should be working on for future Inventor releases.&#0160; The questions this year a little more specific than theyâ€™ve been in the past.&#0160; Hopefully, this will help us to be able to more clearly define the areas where thereâ€™s the most need.&#0160; If thereâ€™s something you need and itâ€™s not listed, please feel free to list it.&#0160; Just click the link below to go to Kean Walmsleyâ€™s blog post for the link to survey and more information.</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/2011/05/api-wishlist-surveys-for-autodesk-products.html">Inventor API Survey</a></p>
<p>Thank you for participating.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jhskos
EMAIL: 
IP: 115.41.130.111
URL: http://profile.typepad.com/jhskos
DATE: 06/10/2011 05:19:44 AM
Always deeply grateful for your post
 Is there any plan to post about ilogic?

 One question to ask
 How do I add? User parameter (Text Value)


 Examples. DoubleValue)
Sub Main()            

     Dim oCompDef As PartComponentDefinition
     oComDef = ThisApplication.ActiveDocument.ComponentDefinition         

     Dim oParams As Parameters
     oParams = oComDef.Parameters             

     Dim uParams As UserParameters
     uParams = oParams.UserParameters                           

     kInventor = uParams.AddByExpression!("kInventor", 0.15, "mm") 

  iLogicVb.UpdateWhenDone = True   

End Sub
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Saving 3D DWG Using the DWG Translator
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: saving-3d-dwg-using-the-dwg-translator
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/05/saving-3d-dwg-using-the-dwg-translator.html 
DATE: 05/18/2011 08:19:27 PM
-----
BODY:
<p>Some new functionality in Inventor 2012 is the ability to save 3D part and assembly models to a DWG file.&#160; Ok, this isnâ€™t exactly new but the previous way to do it was a bit of a workaround by using the AEC Exchange application (now known as BIM Exchange) to create the DWG file.&#160; In Inventor 2012 the DWG translator has been expanded to support 3D so you can use the Save Copy As command and select â€œAutoCAD DWG Filesâ€ as the file type.&#160; In the options dialog you can choose which of the following types to write out; Solid, Surface, or Sketch.&#160; You can also specify which version of DWG you want to create; 2000, 2004, 2007, or 2010.</p>  <p>Itâ€™s also possible to do the same thing through the API by controlling the DWG translator add-in as shown below.&#160; The result of running the VBA macro below is that it will save the solids in the active part or assembly as an AutoCAD 2010 DWG file called â€œC:\Temp\DWGOutTest.dwgâ€.&#160; The options are documented in the comments.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">Public Sub SaveCopyAsDWG3D()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the DWG translator Add-In.&#160; <br /></strong></font>&#160;&#160;&#160; Dim DWGAddIn As TranslatorAddIn     <br />&#160;&#160;&#160; Set DWGAddIn = ThisApplication.ApplicationAddIns.ItemById( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;{C24E3AC2-122E-11D5-8E91-0010B541CD80}&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.&#160; Can be either a part or assembly.        <br /></strong></font>&#160;&#160;&#160; Dim doc As Document&#160; <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument&#160; <br />    <br />&#160;&#160;&#160; Dim transObjs As TransientObjects     <br />&#160;&#160;&#160; Set transObjs = ThisApplication.TransientObjects     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set up the context to define an output file.        <br /></strong></font>&#160;&#160;&#160; Dim context As TranslationContext     <br />&#160;&#160;&#160; Set context = transObjs.CreateTranslationContext     <br />&#160;&#160;&#160; context.Type = kFileBrowseIOMechanism     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the available options from the translator.        <br /></strong></font>&#160;&#160;&#160; Dim options As NameValueMap     <br />&#160;&#160;&#160; Set options = transObjs.CreateNameValueMap     <br />&#160;&#160;&#160; If DWGAddIn.HasSaveCopyAsOptions(doc, context, options) Then     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the options for what types of data to write out.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; options.Value(&quot;Solid&quot;) = True&#160;&#160;&#160;&#160;&#160; ' Output solids.&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; options.Value(&quot;Surface&quot;) = False&#160;&#160; ' Output surfaces.&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; options.Value(&quot;Sketch&quot;) = False&#160;&#160;&#160; ' Output sketches.     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the DWG version.        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' 23 = ACAD 2000         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' 25 = ACAD 2004         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' 27 = ACAD 2007         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' 29 = ACAD 2010&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; options.Value(&quot;DwgVersion&quot;) = 29     <br />&#160;&#160;&#160; End If     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the output filename, using a DataMedium object.        <br /></strong></font>&#160;&#160;&#160; Dim oDataMedium As DataMedium     <br />&#160;&#160;&#160; Set oDataMedium = transObjs.CreateDataMedium     <br />&#160;&#160;&#160; oDataMedium.filename = &quot;c:\temp\DWGOutTest.dwg&quot;     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Call the SaveCopyAs method of the translator add-in.        <br /></strong></font>&#160;&#160;&#160; Call DWGAddIn.SaveCopyAs(doc, context, options, oDataMedium)     <br />End Sub</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor 2012
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2012
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/04/inventor-2012.html 
DATE: 04/05/2011 04:50:46 PM
-----
BODY:
<p>Inventor 2012 has been announced and youâ€™ve probably seen various press reports on some of the new features.&#0160; Inventor 2012 also a lot of new functionality in the API.&#0160; You can find a presentation of whatâ€™s new in the API, along with some samples on the <a href="http://www.autodesk.com/developinventor" title="http://www.autodesk.com/developinventor">http://www.autodesk.com/developinventor</a> website.&#0160; An updated object model chart is also available there.</p>
<p>There will also be a live showing of this presentation on April 7th, where Iâ€™ll be going through the same presentation you can download above.&#0160; Itâ€™s free and you can sign up for the webcast at <a href="http://www.adskconsulting.com/adn/cs/api_course_sched.php">ADN Course Schedule</a> page.&#0160; Look for the class titled â€œDevDays Online: Inventor 2012 API updatesâ€ and click the â€œRegisterâ€ link.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: QubeIt
EMAIL: 
IP: 97.103.49.139
URL: http://profile.typepad.com/qubeit
DATE: 04/07/2011 01:11:08 PM
Brian,

What time is the event? It doesn't say anywhere or even in the initial confirmation email.

-Brian Hall-
-----
COMMENT:
AUTHOR: QubeIt
EMAIL: 
IP: 97.103.49.139
URL: http://profile.typepad.com/qubeit
DATE: 04/07/2011 01:21:51 PM
Nevermind. Got the second confirmation email with the time.  11:00 am EST / 08:00 am PST.

Will this meeting be recorded and posted somewhere? Unfortunately, I'll be hosting a separate Live meeting at the same time so I can't attend this one.

-Brian Hall-
-----
COMMENT:
AUTHOR: ravikumar
EMAIL: ravikmb5@gmail.com
IP: 59.92.141.152
URL: 
DATE: 04/19/2011 07:08:35 PM
is there any way to export dimensions with tolerance to the exel to a particular cell

i am asking this bec to create an inspection reports from inventor idw file

watch this video
<a href="http://www.youtube.com/watch?v=vo3qqYxTKAE&feature=related">http://www.youtube.com/watch?v=vo3qqYxTKAE&feature=related</a>
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Recommended Books
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: recommended-books
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/03/recommended-books.html 
DATE: 03/16/2011 02:07:44 PM
-----
BODY:
<p>With Sanjay moving onto another job and also some other additional responsibilities, Iâ€™ve been very busy lately.&#0160; Part of the other work Iâ€™ve been doing has involved quite a bit of code writing.&#0160; I want to point out a couple of books that I have that I keep going to back to for reference.&#0160; You have to keep in mind that the primary target audience for these books is someone coming from VB6 and moving to VB.Net, which is my background, so Iâ€™m not sure how useful all of you will find these, but I found them well worth the money.</p>
<p>I would also like to hear what books youâ€™ve found useful.&#0160; A category of book where I donâ€™t have much experience are those for beginning programmers and would especially like to know if any of you have found books in this category that you would recommend.&#0160; Here are the books I can recommend:</p>
<p><strong>The .NET Languages: A Quick Translation Guide</strong> by Brian Bischof <br />I found this book the most useful when I was first transitioning to VB.Net.&#0160; It lists common functionality in VB6 and compares it with the equivalent functionality in both VB.Net and C#.</p>
<p>Used and new copies are available on Amazon for about $5, including postage.</p>
<p><strong>Programming Microsoft Visual Basic .Net</strong> by Francesco Balena <br />I got my copy of this book in the early days of VB.Net&#0160; Thereâ€™s been one updated edition since then for VB.Net 2003 but the content still applies.&#0160; Itâ€™s a massive book at over 1500 pages and has answered most of my questions when I need to do something in VB.Net that I havenâ€™t done before.&#0160; This is the book that I keep by my keyboard and turn to the most now.</p>
<p>Used copies of this book are also available on Amazon for a good deal.&#0160; The only problem with the used copies is that a lot of them may not come with the included CD.&#0160; I glanced at the CD content when I first got the book but havenâ€™t used it since then so Iâ€™m not sure how useful it is, but if you have a choice you just as well get a copy that contains the CD.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: James Maeding
EMAIL: jmaeding@hunsaker.com
IP: 24.249.247.46
URL: 
DATE: 03/24/2011 04:04:19 PM
check out the Headfirst C# book.  Its different than any other i have seen, and explains the whole interface/inheritance thing going on, which is odd for VB'rs or LISPers.  I wish I had found the book sooner.
-----
COMMENT:
AUTHOR: Floris Duyfjes
EMAIL: florisduyfjes@yahoo.co.uk
IP: 83.84.54.133
URL: http://www.catweazlemagic.nl
DATE: 04/24/2011 08:28:38 PM
I'm still rather newbee to programming, but I found the website "Home and Learn" a very good introduction to programming. Next I liked the book "Mastering Visual Basic 2010, Evangelos Petroutsos" as a very good reference. Its a bit intimidating by it's size (1023 pages), but it contains nearly everything.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Update to Balloon Renumber Sample
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: update-to-balloon-renumber-sample
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/02/update-to-balloon-renumber-sample.html 
DATE: 02/22/2011 08:26:16 PM
-----
BODY:
<p>Based on some feedback to my <a href="http://modthemachine.typepad.com/my_weblog/2011/02/balloon-renumbering-across-sheets.html">previous post</a>, Iâ€™ve rewritten the sample so that, (hopefully <font size="1"><img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834014e863fb3c7970d-pi" /></font>), it works correctly now.&#160; If youâ€™ve pulled that code, you should copy it down again.&#160; Thereâ€™s a comment at the bottom of the post that explains what the problem was and whatâ€™s been changed.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Crisan Lucian
EMAIL: l.crisan@romania.danieli.com
IP: 84.233.154.253
URL: http://www.danieli.com
DATE: 04/05/2011 05:06:30 PM
Hello Brian,

I've followed your weblog for long time and I like it very much because of your professional and educational style reply.
Talking about balloons in Inventor, I want to ask you if there is a possibility (through programming or iLogic) to wrap balloon rows in an idw drawing. We all know that Inventor attach a balloon only horizontally and vertically in a single row.

Please kindly let me know.

Thanks and regards,
Lucian :o)
-----
COMMENT:
AUTHOR: Gerard
EMAIL: gerard.vanhooft@xsall.nl
IP: 82.161.171.51
URL: 
DATE: 07/26/2011 06:23:04 PM
Hello Brian,
can u help me:
I am workig on a vba solution that will make separate idw from the parts in a assambly.
The only thing that i can't get to work is after placing a baseview , i want to add(create) a balloon whit part information ( Whitout selecting a line in the base view). In the example i found, you always have to select a line in the view

Thanks in advance
-----
COMMENT:
AUTHOR: stianj
EMAIL: sje@grenlandgroup.com
IP: 213.225.85.162
URL: 
DATE: 08/30/2011 11:42:44 AM
Brilliant code Brian, is there any way you could post this in VB.net friendly code so it can be used with iLogic?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Balloon Renumbering Across Sheets
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: balloon-renumbering-across-sheets
CATEGORY: Brian
CATEGORY: Drawings

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/02/balloon-renumbering-across-sheets.html 
DATE: 02/17/2011 06:39:00 AM
-----
BODY:
<p>I recently received a challenge from an Autodesk dealer that I couldnâ€™t let sit since it seemed like it shouldnâ€™t be too hard to solve. The problem heâ€™s trying to solve is the case where the first sheet of a drawing contains a full assembly which is ballooned.&#160; Other sheets in the drawing contains subassemblies and parts that are used in the full assembly.&#160; What he wants is that the balloon numbers on the later sheets all match the numbers on the first sheet.&#160; By default, each document gets its own set of part numbers so each subassembly will begin numbering it parts at 1.</p>  <p>The following VBA code is my attempt at a solution.&#160; I didnâ€™t put it through a lot of testing but it worked on what I did throw at it.&#160; To use it, just have a drawing open and run the macro.&#160; It can be re-run at any point to update the balloons is balloons on the first sheet are added or renumbered.</p>  <p>The program assumes the full assembly is on the first sheet and it examines all of the balloons on the first sheet getting the number and the document associated with the part the balloon is pointing at.&#160; The program also determines the highest number used by any of the balloons on the first sheet.&#160; The program then looks through the other sheets, examining each balloon to see if it points to any of same parts that were ballooned in the full assembly.&#160; If it is a part already ballooned, the program overrides the balloon number using the number from the full assembly.&#160; If the part or subassembly isnâ€™t represented in the large assembly, it assigns it the next highest number.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' User-defined type used in the code code below.       <br /></font></strong>Private Type udtPartInfo     <br />&#160;&#160; Number As Integer     <br />&#160;&#160; ReferencedFile As String     <br />End Type     <br />    <br />    <br />Public Sub RenumberBalloonsToFirstSheet()     <br />&#160;&#160; <font color="#0000ff"><strong>' Get the active drawing document.</strong></font>     <br />&#160;&#160; If ThisApplication.ActiveDocumentType &lt;&gt; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kDrawingDocumentObject Then     <br />&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A drawing must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160; End If     <br />&#160; <br />&#160;&#160; Dim drawDoc As DrawingDocument     <br />&#160;&#160; Set drawDoc = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160; <br />&#160;&#160; <strong><font color="#0000ff">' Get the first sheet</font></strong>     <br />&#160;&#160; Dim baseSheet As Sheet     <br />&#160;&#160; Set baseSheet = drawDoc.Sheets.Item(1)     <br />&#160;&#160;&#160; <br /><strong><font color="#0000ff">&#160;&#160; ' Get the drawing BOM from a balloon.&#160; An assumption is that        <br />&#160;&#160; ' there is only one assembly represented on the sheet since         <br />&#160;&#160; ' this is arbitrarily using the BOM data of assembly associated         <br />&#160;&#160; ' with the first balloon found.        <br /></font></strong>&#160;&#160; Dim valSet As BalloonValueSet    <br />&#160;&#160; Set valSet = baseSheet.Balloons.Item(1).BalloonValueSets.Item(1)    <br />&#160;&#160; Dim drawBOM As DrawingBOM     <br />&#160;&#160; Set drawBOM = valSet.ReferencedRow.Parent     <br />&#160;&#160; Dim partInfo() As udtPartInfo     <br />&#160;&#160; ReDim partInfo(drawBOM.DrawingBOMRows.Count - 1)     <br />&#160;&#160; <br /><strong><font color="#0000ff">&#160;&#160; ' Determine which column contains the item number information.        <br /></font></strong>&#160;&#160; Dim itemColumn As Integer     <br />&#160;&#160; Dim i As Integer     <br />&#160;&#160; For i = 1 To drawBOM.DrawingBOMColumns.Count     <br />&#160;&#160;&#160;&#160;&#160; If drawBOM.DrawingBOMColumns.Item(i).PropertyType = _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kItemPartsListProperty Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; itemColumn = i     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit For     <br />&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160; Next     <br />&#160;&#160; <br />&#160;&#160; For i = 1 To drawBOM.DrawingBOMRows.Count     <br />&#160;&#160;&#160;&#160;&#160; Dim drawBOMRow As DrawingBOMRow     <br />&#160;&#160;&#160;&#160;&#160; Set drawBOMRow = drawBOM.DrawingBOMRows.Item(i)    <br />    <br /><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160; ' Get the filename of the file associated with this        <br />&#160;&#160;&#160;&#160;&#160; ' row of the BOM.         <br /></font></strong>&#160;&#160;&#160;&#160;&#160; Dim partDef As PartComponentDefinition    <br />&#160;&#160;&#160;&#160;&#160; Set partDef = drawBOMRow.BOMRow.ComponentDefinitions.Item(1)    <br />&#160;&#160;&#160;&#160;&#160; partInfo(i - 1).ReferencedFile = partDef.Document.FullFileName     <br />&#160;&#160;&#160;&#160;&#160; <br /><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160; ' Get the part number from the drawing BOM.&#160; This could        <br />&#160;&#160;&#160;&#160;&#160; ' be different than the assembly BOM since it can be         <br />&#160;&#160;&#160;&#160;&#160; ' overridden in the drawing.         <br /></font></strong>&#160;&#160;&#160;&#160;&#160; partInfo(i - 1).Number = drawBOMRow.Item(itemColumn).Value     <br />&#160;&#160; Next     <br />&#160;&#160;&#160; <br /><strong><font color="#0000ff">&#160;&#160; ' Iterate through the other sheets setting the balloon values        <br />&#160;&#160; ' to match these. If a balloon to a new part is found it will         <br />&#160;&#160; ' be set to the next highest value so all parts have unique         <br />&#160;&#160; ' balloon values.         <br /></font></strong>&#160;&#160; For i = 2 To drawDoc.Sheets.Count     <br />&#160;&#160;&#160;&#160;&#160; Dim currentSheet As Sheet     <br />&#160;&#160;&#160;&#160;&#160; Set currentSheet = drawDoc.Sheets.Item(i)    <br />    <br /><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160; ' Look through the balloons on this sheet.        <br /></font></strong>&#160;&#160;&#160;&#160;&#160; Dim checkBalloon As Balloon     <br />&#160;&#160;&#160;&#160;&#160; For Each checkBalloon In currentSheet.Balloons     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Initialize the flag indicating a match was found.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim matchFound As Boolean     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; matchFound = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim valueSet As BalloonValueSet     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set valueSet = checkBalloon.BalloonValueSets.Item(1)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim checkFilename As String     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; checkFilename = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; valueSet.ReferencedFiles.Item(1).FullFileName&#160; <br />    <br /><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Find the data that matches this balloon.        <br /></font></strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim j As Integer    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For j = 0 To UBound(partInfo)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If checkFilename = partInfo(j).ReferencedFile Then     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Override the balloon value to match, if        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' it's different.         <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; matchFound = True     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If valueSet.ItemNumber &lt;&gt; partInfo(j).Number Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; valueSet.OverrideValue = partInfo(j).Number     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit For     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160; Next     <br />End Sub     <br /></p>  <p>&#160;</p>  <p><strong>Updates:     <br /></strong>Feb. 22, 2011: Revised the code because of some problems pointed out in the previous version.&#160; The previous version was dependent on a balloon being present on the first sheet for every part in the assembly, which is not realistic.&#160; The new code relies on the BOM, which will include every part. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Wojciech
EMAIL: jarosz3@gmail.com
IP: 89.104.225.16
URL: 
DATE: 03/15/2011 08:18:37 AM
Hi Brain,

I have a problem. 

"If valueSet.ItemNumber <> partInfo(j).Number Then"

The both parts see each other but the program stops there and is yellow highlight and doesn't do anything. what is it wrong maybe I am doing something wrong..

Cheers

Wojtek
-----
COMMENT:
AUTHOR: Stian
EMAIL: stian@jenssen.net
IP: 213.225.85.162
URL: 
DATE: 06/07/2011 01:16:17 PM
When I place a balloon for the assembly (one is enough), this works great! But if a balloon isn't placed at all, I get an error. The follow line is being highlighted:

Set valSet = baseSheet.Balloons.Item(1).BalloonValueSets.Item(1)

Any way to fix this, or tell the user an error message saying a balloon must be placed?
-----
COMMENT:
AUTHOR: Reg Hasell
EMAIL: rhasell@gmail.com
IP: 118.208.56.118
URL: http://www.greenupdesign.com.au
DATE: 06/24/2011 12:02:00 AM
Hi Brian
Brilliant code, I use it a lot, thank you.

One issue: If the Sub Assemblies are on the same page (Page 1), the balloons do not update, I have to place the views on Page 2, run the code, then copy the views back to page 1.

What changes can be made to the code to allow the ballons to update on page 1 as well?
-----
COMMENT:
AUTHOR: Nate
EMAIL: brownn@westinghouse.com
IP: 66.116.62.178
URL: 
DATE: 07/08/2011 04:34:43 PM
I achieve nearly the same thing without any VBA code: create a custom BOM column (e.g. "ITEM NO.") in the top-level assembly's BOM.  Then edit the balloon style to display "ITEM NO." rather than "ITEM".  Add the "ITEM NO." column to the Parts List style (overwrite the column header to read "ITEM" if you wish).  In the top-level assembly's BOM, copy the "Item" column and paste it into the "ITEM NO." column.  Now the balloons display a custom iProperty associated with each part, rather than Inventor's assigned item number within each assembly.  So, no matter where the assembly or sub-assembly lies in the drawing, the balloon always shows the same number.
-----
COMMENT:
AUTHOR: stianj
EMAIL: sje@grenlandgroup.com
IP: 213.225.85.162
URL: 
DATE: 08/30/2011 11:05:04 AM
Any way to convert this to VB.net, so I can use it as an iLogic rule? 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Importing Non-Native Models into Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: importing-non-native-models-into-inventor
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/02/importing-non-native-models-into-inventor.html 
DATE: 02/03/2011 10:48:08 PM
-----
BODY:
<p>My friends from the DevTech group, which support the members of the <a href="http://www.autodesk.com/adn">Autodesk Developer Network (ADN)</a>, are helping me out while Iâ€™m buried with project work and are providing some content for blog posts.&#160; This one is from Xiaodong Liang who works in the Beijing China office.    <br />    <br />There are two basic mechanisms for importing non-native surface or solid bodies into Inventor. The first involves using the TransientBrep.ReadFromFile method to read a surface body in directly. The second mechanism involves using a suitable translator add-in to read the data in. In both cases the surface/solid data can then be added as a Part feature via the NonParametricFeatures.Add method.</p>  <p>This first code sample illustrates how to use the TransientBrep.ReadFromFile mechanism to read the model data from a SAT file:-</p>  <p style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Sub importByBrep()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get the active part document        <br /></font>&#160;&#160;&#160; </strong>Dim oDoc As PartDocument     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get transient Brep        <br /></font>&#160;&#160;&#160; </strong>Dim oBrep As TransientBRep     <br />&#160;&#160;&#160; Set oBrep = ThisApplication.TransientBRep     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get the surfacebodies        <br /></font>&#160;&#160;&#160; </strong>Dim oSBs As SurfaceBodies     <br />&#160;&#160;&#160; Set oSBs = oBrep.ReadFromFile(&quot;c:\temp\test.sat&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get definition of current document        <br /></font>&#160;&#160;&#160; </strong>Dim oActiveDocDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oActiveDocDef = oDoc.ComponentDefinition     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Add each surfacebody of imported file to        <br />&#160;&#160;&#160; ' NonParametricBaseFeatures         <br /></font>&#160;&#160;&#160; </strong>Dim oSB As SurfaceBody     <br />&#160;&#160;&#160; For Each oSB In oSBs     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oActiveDocDef.Features.NonParametricBaseFeatures.Add oSB     <br />&#160;&#160;&#160; Next     <br />    <br />&#160;&#160;&#160; oDoc.Update     <br />End Sub</p>  <p>This next code sample illustrates how to use one of the translator add-ins to read the relevant data in, again from a SAT file.</p>  <p style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Sub ImportByTanstorAddin()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get the active part document        <br /></font>&#160;&#160;&#160; </strong>Dim oActiveDoc As PartDocument     <br />&#160;&#160;&#160; Set oActiveDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get definition of active part document        <br /></font>&#160;&#160;&#160; </strong>Dim oActiveDocDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oActiveDocDef = oActiveDoc.ComponentDefinition     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get SAT TranslatorAddIn        <br /></font>&#160;&#160;&#160; </strong>Dim oAddin As TranslatorAddIn     <br />&#160;&#160;&#160; Set oAddin = ThisApplication.ApplicationAddIns.ItemById( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;{89162634-02B6-11D5-8E80-0010B541CD80}&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Create context for open&#160; <br /></font>&#160;&#160;&#160; Dim oTransObjs As TransientObjects       <br />&#160;&#160;&#160; Set oTransObjs = ThisApplication.TransientObjects       <br />&#160;&#160;&#160; </strong>Dim oContext As TranslationContext     <br />&#160;&#160;&#160; Set oContext = oTransObjs.CreateTranslationContext     <br />&#160;&#160;&#160; oContext.Type = kDataDropIOMechanism     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Create option for open        <br /></font>&#160;&#160;&#160; </strong>Dim oOptions As NameValueMap     <br />&#160;&#160;&#160; Set oOptions = oTransObjs.CreateNameValueMap     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Create DataMedium for open        <br /></font>&#160;&#160;&#160; </strong>Dim oDataMedium As DataMedium     <br />&#160;&#160;&#160; Set oDataMedium = oTransObjs.CreateDataMedium     <br />&#160;&#160;&#160; Call oOptions.Add(&quot;ImportSolid&quot;, True)     <br />&#160;&#160;&#160; oDataMedium.fileName = &quot;c:\temp\test.sat&quot;     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Open the SAT file        <br /></font>&#160;&#160;&#160; </strong>Dim oNewDoc As PartDocument     <br />&#160;&#160;&#160; Call oAddin.Open(oDataMedium, oContext, oOptions, oNewDoc)     <br />&#160;&#160;&#160; Dim oNewDocDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oNewDocDef = oNewDoc.ComponentDefinition     <br />    <br />&#160;<font color="#0000ff"><strong>&#160;&#160; </strong></font><strong><font color="#0000ff">' Read the surfacebodies to the current document        <br /></font>&#160;&#160;&#160; </strong>Dim oSB As SurfaceBody     <br />&#160;&#160;&#160; For Each oSB In oNewDocDef.SurfaceBodies     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oActiveDocDef.Features.NonParametricBaseFeatures.Add oSB     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Close the temp doc without saving        <br /></font>&#160;&#160;&#160; </strong>oNewDoc.Close True     <br />End Sub</p>  <p>What can be confusing about this is that reading multiple bodies from different files this way yields a solid for the first import, but surfaces for any further imports to the same Part document.&#160; A solid is created if there are no other solids in the Part and a surface is created if there is at least one solid in the Part already. This was the behavior in Inventor when importing bodies interactively until the recent addition of support for multiple solid bodies in a single part.&#160; The behavior of the method&#160; <b>NonParametricBaseFeatures.Add</b> mimics the old behavior.&#160; </p>  <p>There is a way to get the new behavior though. We can use a definition object to stipulate exactly what kind of model is imported (Solid or Surface). The <b>CreateDefinition</b> and <b>AddByDefinition</b> methods of the <b>NonParametricBaseFeatures</b> object were added in Inventor 2011 and support additional flexibility that the <b>Add</b> method doesnâ€™t. <b>CreateDefinition</b> is used to create the relevant definition object, which then specifies the output type of the NonParametricBaseFeature (surface, solid, multiple solids or composite type). The code below illustrates how this can be used to import solids:-</p>  <p style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Sub BatchImport()    <br />&#160;&#160;&#160; ImportEachFile &quot;C:\temp\test.sat&quot;, 1     <br />&#160;&#160;&#160; ImportEachFile &quot;C:\temp\test2.sat&quot;, 2     <br />End Sub</p>  <p style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Sub ImportEachFile(fileName As String, index As Integer)    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get the active part document        <br /></font>&#160;&#160;&#160; </strong>Dim oDoc As PartDocument     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get transient Brep        <br /></font>&#160;&#160;&#160; </strong>Dim oBrep As TransientBRep     <br />&#160;&#160;&#160; Set oBrep = ThisApplication.TransientBRep     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get the surfacebodies        <br /></font>&#160;&#160;&#160; </strong>Dim oSBs As SurfaceBodies     <br />&#160;&#160;&#160; Set oSBs = oBrep.ReadFromFile(fileName)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' To transform the body        <br /></font>&#160;&#160;&#160; Dim oTG As TransientGeometry       <br />&#160;&#160;&#160; Set oTG = ThisApplication.TransientGeometry       <br />&#160;&#160;&#160; </strong>Dim oMatrix As Matrix     <br />&#160;&#160;&#160; Set oMatrix = oTG.CreateMatrix()     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Move the body arbitrarily        <br /></font>&#160;&#160;&#160; </strong>oMatrix.SetTranslation oTG.CreateVector( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; index * 10, index * 10, 0)&#160; <br />&#160;&#160;&#160; Dim oTransObjs As TransientObjects     <br />&#160;&#160;&#160; Set oTransObjs = ThisApplication.TransientObjects     <br />&#160;&#160;&#160; Dim oObjColl As ObjectCollection     <br />&#160;&#160;&#160; Set oObjColl = oTransObjs.CreateObjectCollection()     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Add each surfacebody of imported file to ObjectCollection        <br /></font>&#160;&#160;&#160; </strong>Dim oSB As SurfaceBody     <br />&#160;&#160;&#160; For Each oSB In oSBs     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oBrep.Transform oSB, oMatrix     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oObjColl.Add oSB     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Get definition of current document        <br /></font>&#160;&#160;&#160; </strong>Dim oPartDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oPartDef = oDoc.ComponentDefinition     <br />&#160;&#160;&#160; Dim oFeatures As PartFeatures     <br />&#160;&#160;&#160; Set oFeatures = oPartDef.Features     <br />&#160;&#160;&#160; Dim oNPFD As NonParametricBaseFeatureDefinition     <br />&#160;&#160;&#160; Set oNPFD = oFeatures.NonParametricBaseFeatures.CreateDefinition     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Assign the ObjectCollection to the definition.</strong></font><strong><font color="#0000ff">        <br /></font>&#160;&#160;&#160; </strong>oNPFD.BRepEntities = oObjColl     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Set the output type        <br /></font>&#160;&#160;&#160; </strong>oNPFD.OutputType = kSolidOutputType     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; </strong></font><strong><font color="#0000ff">' Create the NonParametricBaseFeature using the definition.        <br /></font>&#160;&#160;&#160; </strong>oPartDef.Features.NonParametricBaseFeatures.AddByDefinition oNPFD     <br />End Sub</p>  <p>   <br />And there we have it! I hope this answers a few questions about importing solids into Inventor.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Good Luck to Sanjay
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: good-luck-to-sanjay
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2011/01/good-luck-to-sanjay.html 
DATE: 01/07/2011 06:23:30 PM
-----
BODY:
<p>Itâ€™s been too long since my last posting.&#0160; Things have been busy here at Autodesk with Autodesk University, the ADN DevDays tours, and putting the final touches on the next release of Inventor.&#0160; In the midst of all that Sanjay Ramaswamy, who most of you know, decided to change roles here at Autodesk and has moved into a new position.&#0160; Sanjay and I have been working together as the Inventor API product designers for quite a while and he has been a big part of getting the API where it is today.&#0160; Heâ€™s also been very active on the newsgroup and supporting the API.&#0160; I want to thank him for everything heâ€™s done and wish him the best in his new role as a product manager.&#0160; Heâ€™ll definitely be missed here.</p>
<p>With the new year and the accompanying resolutions, Iâ€™m going to work hard at posting content more regularly on this blog.&#0160; The DevTech team, the guys that support the ADN Developers (<a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=723353">Autodesk Developer Network</a>), are going to help me out by writing some content that Iâ€™ll be posting occasionally.&#0160; Iâ€™ve also received a couple of programs from customers with permission to post them here and will be doing that soon.&#0160; If any of you have found something that you think would be helpful to others and would like to share it, <a href="mailto:brian.ekins%40autodesk.com">email me</a> and we can discuss it.</p>
<p>The best wishes to all of you in this new year.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter
EMAIL: pbrown@redler.com
IP: 88.106.181.117
URL: 
DATE: 01/08/2011 11:32:05 AM
Good luck to Sanjay, he's helped me in the past.
-----
COMMENT:
AUTHOR: Sunith Babu 
EMAIL: sunithbabu@cadprofessor.in
IP: 115.184.61.228
URL: http://www.CADProfessor.in
DATE: 01/11/2011 03:30:45 PM
Good Luck Sanjay 


-----
COMMENT:
AUTHOR: noontz
EMAIL: steffen@dyhr-nielsen.dk
IP: 188.177.252.108
URL: 
DATE: 01/25/2011 09:12:56 AM
All the best Sanjay

I have frequently used your answers on the forum to get past obstacles on the route to better API understanding.

Thanks for all your work! 
-----
COMMENT:
AUTHOR: Web Design Agency India 
EMAIL: links@icu-india.com
IP: 59.90.194.46
URL: http://www.icu-india.com
DATE: 02/11/2011 09:19:13 AM
for heart good luck sanjay............
-----
COMMENT:
AUTHOR: meizitang
EMAIL: jeremykris1988@gmail.com
IP: 210.4.127.58
URL: http://cheapmeizitang.com/
DATE: 03/31/2011 03:29:11 PM
Good luck to your new adventure.
-----
PING:
TITLE: Cristian Lindsley
URL: http://www.ultimatemoviescenter.com
IP: 97.90.17.192
BLOG NAME: Cristian Lindsley
DATE: 12/26/2011 08:43:02 AM
Wow, great article.Really looking forward to read more. Awesome.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Changing Drawing Curves to Match Assembly Color
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: changing-drawing-curves-to-match-assembly-color
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/10/changing-drawing-curves-to-match-assembly-color.html 
DATE: 10/18/2010 06:21:05 PM
-----
BODY:
<p>I had a couple of requests lately asking about the possibility of using the API to change the colors of the curves in a drawing view to match the color of the parts in the assembly.&#160; Below is a program that does this.&#160; It starts with a selected drawing view and gets the associated assembly.&#160; It then iterates over every occurrence in the assembly and for each part occurrence gets the color of that part as it exists in the assembly.&#160; If the color has been overridden in the assembly then it will use the override color.&#160; It then checks to see if there is a layer in the drawing that has the same name as the color.&#160; If there isnâ€™t it creates a new layer with the same color.&#160; It then gets all of the curves in the drawing that are associated with that occurrence and assigns the layer to those curves.&#160; The picture below shows the result after running it on the engine sample thatâ€™s delivered with Inventor.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f52a0299970b-pi"><img title="DrawingCurveColorExample" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="242" alt="DrawingCurveColorExample" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f52a029e970b-pi" width="450" border="0" /></a> </p>  <p>Hereâ€™s the VBA code that does the work.&#160; A key API functions that the program uses is the DrawingView.DrawingCurves property, which given an occurrence returns all of the curves in the view that are associated with that occurrence.&#160; It also uses the Sheet.ChangeLayer method which is a new method in Inventor 2011 that changes the layer of a group of objects.&#160; The program could be written without this, but would be much slower since it will need to change the layer of each curve one at a time.</p>  <p style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub ChangeLayerOfOccurrenceCurves()   <br /><font color="#0000ff"><strong>&#160;&#160; ' Get the active drawing document.       <br /></strong></font>&#160;&#160; Dim drawDoc As DrawingDocument    <br />&#160;&#160; Set drawDoc = ThisApplication.ActiveDocument    <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Have the user select a drawing view.       <br /></strong></font>&#160;&#160; Dim drawView As DrawingView    <br />&#160;&#160; Set drawView = ThisApplication.CommandManager.Pick( _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kDrawingViewFilter, &quot;Select a drawing view.&quot;)&#160; <br />    <br />&#160;&#160; Dim docDesc As DocumentDescriptor    <br />&#160;&#160; Set docDesc = drawView.ReferencedDocumentDescriptor&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Verify that the selected drawing view is of an assembly.       <br /></strong></font>&#160;&#160; If docDesc.ReferencedDocumentType &lt;&gt; kAssemblyDocumentObject Then    <br />&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The selected view must be of an assembly.&quot;    <br />&#160;&#160;&#160;&#160;&#160; Exit Sub    <br />&#160;&#160; End If&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Get the component definition for the assembly.       <br /></strong></font>&#160;&#160; Dim asmDef As AssemblyComponentDefinition    <br />&#160;&#160; Set asmDef = docDesc.ReferencedDocument.ComponentDefinition&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Process the occurrences, wrapping it in a transaction so the       <br />&#160;&#160; ' entire process can be undone with a single undo operation.        <br /></strong></font>&#160;&#160; Dim trans As Transaction    <br />&#160;&#160; Set trans = ThisApplication.TransactionManager.StartTransaction( _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawDoc, &quot;Change drawing view color&quot;)&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Call the recursive function that does all the work.       <br /></strong></font>&#160;&#160; Call ProcessAssemblyColor(drawView, asmDef.Occurrences)    <br />&#160;&#160; trans.End    <br />End Sub     <br />    <br />    <br />    <br />Private Sub ProcessAssemblyColor(drawView As DrawingView, _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Occurrences As ComponentOccurrences)    <br /><font color="#0000ff"><strong>&#160;&#160; ' Iterate through the current collection of occurrences.       <br /></strong></font>&#160;&#160; Dim occ As ComponentOccurrence    <br />&#160;&#160; For Each occ In Occurrences    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Check to see if this occurrence is a part or assembly.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160; If occ.DefinitionDocumentType = kPartDocumentObject Then    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' ** It's a part so process the color.&#160; <br />        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the render style of the occurrence.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim color As RenderStyle    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim sourceType As StyleSourceTypeEnum    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set color = occ.GetRenderStyle(sourceType)&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the TransientsObjects object to use later.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim transObjs As TransientObjects    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set transObjs = ThisApplication.TransientObjects&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Verify that a layer exists for this color.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim layers As LayersEnumerator    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set layers = drawView.Parent.Parent.StylesManager.layers&#160; <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim drawDoc As DrawingDocument    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set drawDoc = drawView.Parent.Parent&#160; <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error Resume Next    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim colorLayer As Layer    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set colorLayer = layers.Item(color.Name)&#160; <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Err.Number &lt;&gt; 0 Then    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error GoTo 0    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the diffuse color for the render style.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim red As Byte    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim green As Byte    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim blue As Byte&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Create a color object that is the diffuse color.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call color.GetDiffuseColor(red, green, blue)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim newColor As color    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set newColor = transObjs.CreateColor(red, green, blue)&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Copy an arbitrary layer giving it the name       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' of the render style.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set colorLayer = layers.Item(1).Copy(color.Name)    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the attributes of the layer to use the color,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' have a solid line type, and a specific width.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; colorLayer.color = newColor    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; colorLayer.LineType = kContinuousLineType    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; colorLayer.LineWeight = 0.02    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error GoTo 0&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get all of the curves associated with this occurrence.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error Resume Next    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim drawcurves As DrawingCurvesEnumerator    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set drawcurves = drawView.DrawingCurves(occ)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Err.Number = 0 Then    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error GoTo 0&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Create an empty collection.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim objColl As ObjectCollection    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set objColl = transObjs.CreateObjectCollection()&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Add the curve segments to the collection.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim drawCurve As DrawingCurve    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For Each drawCurve In drawcurves    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim segment As DrawingCurveSegment    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For Each segment In drawCurve.Segments    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; objColl.Add segment    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Change the layer of all of the segments.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call drawView.Parent.ChangeLayer(objColl, colorLayer)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error GoTo 0    <br />&#160;&#160;&#160;&#160;&#160; Else    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' It's an assembly so process its contents.       <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call ProcessAssemblyColor(drawView, occ.SubOccurrences)    <br />&#160;&#160;&#160;&#160;&#160; End If    <br />&#160;&#160; Next    <br />End Sub</p>  <p>This sample program sets the color of each occurrence based on its color in the assembly. You could choose to set the color based on any other criteria instead. It can be anything associated with the part. you just have to choose what attribute of the part to use and what the associated set of colors are that cam be assigned to each part. For example, you might have a custom iProperty that controls what color is assigned to each part in the drawing.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: R. van de Burgt
EMAIL: r.vandeburgt@gmail.com
IP: 94.208.121.75
URL: 
DATE: 11/03/2010 10:04:48 PM
This code is great and we welcome'd it in our company. We used to do this work manually in Autocad...
Altough the code works fine, vba gives an error:

Run-time error '-2147467259 (80004005)'
"Method 'GetRenderStyle' of object 'ComponentOccurence' failed"

Did I miss something here? (we use inventor pro 2011)
-----
COMMENT:
AUTHOR: Anders Petersen
EMAIL: abp@cdlight.dk
IP: 87.104.234.146
URL: http://www.cdlight.dk
DATE: 03/21/2011 11:00:26 AM
Hi
This code solve some of my problem then exporting to dwg, but it seems to change alle the lines and put them in the same layer and therefore they lose there linetypes(contintues, hidden ect.) is it possible to keep the linetype and stil change the colour?
 
-----
COMMENT:
AUTHOR: Andre
EMAIL: andcana@iol.it
IP: 80.86.156.192
URL: 
DATE: 06/14/2011 03:55:12 PM
Using the macro I got an error

"Method 'GetRenderStyle' of object 'ComponentOccurence' failed"


-----
COMMENT:
AUTHOR: here
EMAIL: vicentewakk@gmail.com
IP: 120.29.91.78
URL: http://bellavitabags.com/
DATE: 08/16/2011 02:14:15 PM
It's easier to get a good finish if you keep your basic shapes simple.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: API Functionality for AEC Exchange (BIM Exchange)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: api-functionality-for-aec-exchange-bim-exchange
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/10/api-functionality-for-aec-exchange-bim-exchange.html 
DATE: 10/18/2010 07:08:28 AM
-----
BODY:
<p>For those of you on subscription, the Inventor 2011 Subscription Bonus Pack includes API functionality for AEC Exchange.&#0160; (In Inventor it is still referred to as <em>AEC Exchange</em> but the API refers to it as <em>BIM Exchange</em> since it will be called BIM Exchange in the future.)&#0160; The API provides the same functionality that you have through the user-interface; you can define and edit connections, define and edit the definition of a component, and output a component as an .adsk file.</p>
<p>This enhanced functionality is part of the subscription bonus pack, but the API documentation was not updated to reflect this new functionality.&#0160; Below is a link to documentation for the BIM Exchange API.</p>
<p><a href="http://modthemachine.typepad.com/BIMExchangeAPI.pdf">BIM Exchange API Documentation</a></p>
<p>Be sure to read the introduction, particularly if you are using a .Net based language.&#0160; There is also a small sample program at the bottom of the document.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Migrating your SolidWorks Applications to Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: migrating-your-solidworks-applications-to-inventor
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/09/migrating-your-solidworks-applications-to-inventor.html 
DATE: 09/21/2010 09:48:55 PM
-----
BODY:
<p>I asked a question in a recent post to see if any of you were interested in a series of posts discussing how to migrate your SolidWorks programs to work with Inventor.&#0160; Well, there was some interest in the topic.&#0160; Rather than break the information up into a series of posts, hereâ€™s a document produced by the Autodesk Developer Network (ADN) team that describes some of the differences in the programming interfaces and some hints and tips to help you with the migration.</p>
<blockquote>
<p><a href="http://modthemachine.typepad.com/SW2InventorGuideV1.pdf">Migrating SolidWorks Applications to Autodesk Inventor</a></p>
</blockquote>
<p>This is the initial release of the document so it will likely go through some updates.&#0160; Any comments that will help to improve it are welcome.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jens Bejer Pedersen
EMAIL: jbp@cdlight.dk
IP: 87.104.234.146
URL: http://www.cdlight.dk
DATE: 09/23/2010 09:20:49 AM
Hi Brian

A couple of comments on the PDF Document:

The first link on page 5 points to a file in the local users temporary internet files and of gives an error when clicked.

In several of the code examples You use the Inventor Application as _InvApplication but I think You intended to use ThisApplication since You use the VBA Environment.

In general You use a mixed mode for writing Object.Method accessors, either using the :: as in C++ or just using the . as in VB and C# (and in all the VBA code examples), I would recommend to use either only one of these conventions or at least give an explanation when :: is used the first time (Page 16) as this is after the first code examples.

I would like You to extend the document with some examples about (Model) Parameters and Properties, how to get, Query and Set these entities.

Regards,
Jens Bejer Pedersen
-----
COMMENT:
AUTHOR: jakubd
EMAIL: jakubd@pspsolution.pl
IP: 83.8.228.62
URL: http://www.pspsolution.pl
DATE: 10/13/2010 08:46:07 AM
Hi Brian

I need help with vba script in inventor for one of Our customers.

Can You please contact me to my email ?

Best Regards

Jakub D.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Totaling the Length of Parts in an Assembly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: totaling-the-length-of-parts-in-an-assembly
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/09/totaling-the-length-of-parts-in-an-assembly.html 
DATE: 09/09/2010 10:56:04 PM
-----
BODY:
<p>Thereâ€™s a <a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Adding-values-from-within-a-BOM/td-p/2758449">question on the Inventor Customization newsgroup</a> that I thought might be of general interest so Iâ€™m posting my response here.&#160; The specific question is that they have a cabinet assembly and some of the parts in the assembly represent pieces of molding.&#160; They want to get a total length of all of the molding used in the assembly.&#160; Iâ€™ve written a small sample below that illustrates one approach to this.</p>  <p>The first thing before writing any program is to fully understand the conditions the program can expect.&#160; You might need to impose certain requirements on the model in order for the program to function correctly.&#160; A computer program isnâ€™t very smart and only does exactly what youâ€™ve programmed it to do.&#160; Each variation in the conditions of the model requires more code to check for and handle each case.&#160; Here are the assumptions that this program makes about the assembly.&#160; </p>  <ol>   <li>The program is executed when the cabinet assembly is active. </li>    <li>Any parts that represent molding will have the word â€œmoldingâ€ in the category iProperty.&#160; This is how the program determines which parts are molding parts. </li>    <li>Each molding part has a parameter called â€œLengthâ€ that is the actual length of the molding part. </li> </ol>  <p>The program demonstrates several basic things that should be interesting for many of you.&#160; First, it traverses the entire assembly looking for molding parts.&#160; It uses the iProperty portion of the API and rule number 2 above to determine which parts in the assembly are molding parts.&#160; Once it finds a molding part it uses the parameters portion of the API to get the length of the molding.&#160; It again uses iProperties to create or update a custom iProperty in the assembly with the total length of the molding (plus 30% for waste).</p>  <p>Not everyone needs a program that totals the length of molding parts but hopefully you can see how this sample could be easily edited to perform other similar tasks.</p>  <p>Something to be aware of is that this is not automatic.&#160; Itâ€™s essentially a â€œsnapshotâ€ of the length of molding at the time you run the program.&#160; If you edit, add, or remove parts the iProperty will not automatically update but youâ€™ll need to manually run the program again.   <br />    <br />If youâ€™re new to Inventorâ€™s VBA, hereâ€™s a <a href="http://modthemachine.typepad.com/my_weblog/2010/05/using-vba-sample-code-for-the-non-programmer.html">post that lists the steps of how to use a VBA macro within Inventor</a>.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Main program that computes the total length of all molding         <br />' parts in the active assembly.</strong></font>      <br />Public Sub ComputeMoldingLength()&#160; <br />&#160;&#160; Dim asmDoc As AssemblyDocument&#160; <br />&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument&#160; <br />&#160;&#160; Dim asmDef As AssemblyComponentDefinition&#160; <br />&#160;&#160; Set asmDef = asmDoc.ComponentDefinition      <br />&#160; <br /><font color="#0000ff"><strong>&#160;&#160; ' Call the recursive function to traverse the assembly.&#160; <br /></strong></font>&#160;&#160; Dim MoldingLength As Double&#160; <br />&#160;&#160; MoldingLength = 0&#160; <br />&#160;&#160; Call GetMoldingLength(asmDef.Occurrences, MoldingLength)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160; ' Get the iProperties for this document.&#160; <br /></strong></font>&#160;&#160; Dim propSets As PropertySets&#160; <br />&#160;&#160; Set propSets = asmDoc.PropertySets&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160; ' Get the user defined property set.&#160; <br /></strong></font>&#160;&#160; Dim userProps As PropertySet&#160; <br />&#160;&#160; Set userProps = propSets.Item(&quot;Inventor User Defined Properties&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160; ' Create a string that represents the length value,&#160; <br />&#160;&#160; ' including an extra 30% for waste.&#160; <br /></strong></font>&#160;&#160; Dim totalLength As String&#160; <br />&#160;&#160; totalLength = asmDoc.UnitsOfMeasure.GetStringFromValue( _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MoldingLength * 1.3, kDefaultDisplayLengthUnits)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160; ' Update or create the iProperty containing the length.&#160; <br /></strong></font>&#160;&#160; On Error Resume Next&#160; <br />&#160;&#160; Dim lengthProp As Inventor.Property&#160; <br />&#160;&#160; Set lengthProp = userProps.Item(&quot;MoldingLength&quot;)&#160; <br />&#160;&#160; If Err.Number &lt;&gt; 0 Then&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' The property doesn't exist so create it.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Set lengthProp = userProps.Add(totalLength, &quot;MoldingLength&quot;)&#160; <br />&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160; lengthProp.value = totalLength&#160; <br />&#160;&#160; End If&#160; <br />      <br />&#160;&#160; MsgBox &quot;Total molding length (including 30% waste): &quot; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; totalLength       <br />End Sub       <br />      <br />      <br /></p>   <font color="#0000ff"><strong>' Sub that is called recursively to iterate through the entire       <br />' assembly structure to find and total the lengths of all         <br />' molding parts.        <br /></strong></font>Private Sub GetMoldingLength( _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal Occurrences As ComponentOccurrences, _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef MoldingLength As Double)&#160; <br /><font color="#0000ff"><strong>&#160;&#160; ' Iterate through the occurrences in the current assembly.&#160; <br /></strong></font>&#160;&#160; Dim occ As ComponentOccurrence&#160; <br />&#160;&#160; For Each occ In Occurrences&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Check if this is a part or assembly.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; If occ.DefinitionDocumentType = kPartDocumentObject Then&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the iProperties for this document.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim propSets As PropertySets&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set propSets = occ.Definition.Document.PropertySets&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the Document Summary Info property set.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim docSummaryInfo As PropertySet&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set docSummaryInfo = propSets.Item( _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor Document Summary Information&quot;)&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Check to see if the term &quot;molding&quot; is part of&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the category property.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If InStr(&quot;MOLDING&quot;, _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UCase(docSummaryInfo.Item(&quot;Category&quot;).value)) &gt; 0 Then&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the user defined property set.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim userDefinedProps As PropertySet&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set userDefinedProps = propSets.Item( _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor User Defined Properties&quot;)    <br />&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the component definition of the part.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim partCompDef As PartComponentDefinition&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set partCompDef = occ.Definition&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the parameter for the length.&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' It will be in centimeters.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error Resume Next&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim length As Double&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; length = partCompDef.Parameters.Item(&quot;Length&quot;).value&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Err.Number = 0 Then&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MoldingLength = MoldingLength + length&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Error getting the Length property from &quot; &amp; _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; occ.Definition.Document.DisplayName&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; On Error GoTo 0&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If&#160; <br />&#160;&#160;&#160;&#160;&#160; Else&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' It's an assembly so call this sub again.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call GetMoldingLength(occ.SubOccurrences, MoldingLength)&#160; <br />&#160;&#160;&#160;&#160;&#160; End If&#160; <br />&#160;&#160; Next     <br />End Sub</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Wojciech
EMAIL: jarosz3@gmail.com
IP: 89.104.225.16
URL: http://www.wj.hostei.com
DATE: 09/20/2010 12:15:05 PM
A drawing with 20 different seizes metal sheets. I was wondering if I would put a BOM table with dimensions (like length X wide x thickness) rather than  dimensioning each one. If is possible to get a macro code for that?

Best Regards
Wojciech
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Balloon Reporting Macro
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: balloon-reporting-macro
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/09/balloon-reporting-macro.html 
DATE: 09/03/2010 12:38:44 AM
-----
BODY:
<p>There was a question on the <a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/bd-p/120">Autodesk Inventor Customization newsgroup</a> this morning that caught my interest.&#160; The question was about creating a report, (in their case editing a column in the BOM), that lists all of the balloons in a drawing along with what sheet theyâ€™re on and the zone on the sheet theyâ€™re located within,</p>  <p>The macro below does this.&#160; The output is simple since it just writes out the result as a file, but youâ€™ll likely want to edit the program to do something else with the result like incorporate it into the BOM, create a custom table, or some other thing I would never have thought of.&#160; The macro assumes that the border was created as a default border.&#160; With a default border itâ€™s a simple matter to get the number of zones on a sheet and determine whether to use numbers or characters for the zone labels.&#160; If youâ€™re using a border youâ€™ve created then youâ€™ll need to edit the program and specify this information.</p>  <p>I tested the macro using the Engine MKII sample assembly shown below.&#160; The drawing that comes with that sample has three sheets and balloons on two of the sheets.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f38931dd970b-pi"><img title="BalloonDrawing" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="298" alt="BalloonDrawing" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834013486acccdc970c-pi" width="454" border="0" /></a> </p>  <p>Here are the contents of the report created by the macro. </p>  <div style="font-size: 8pt; background: #ffeeee; color: black; line-height: 140%; font-family: courier new">   <p>==== Balloon Report ====      <br />&#160; Sheet: Sheet:1       <br />&#160;&#160;&#160; Balloon: 8, (7, B)       <br />&#160;&#160;&#160; Balloon: 7, (1, A)       <br />&#160;&#160;&#160; Balloon: 11, (7, B)       <br />&#160;&#160;&#160; Balloon: 12, (7, B)       <br />&#160;&#160;&#160; Balloon: 23, (7, A)       <br />&#160;&#160;&#160; Balloon: 19, (7, A)       <br />&#160;&#160;&#160; Balloon: 28, (7, A)       <br />&#160;&#160;&#160; Balloon: 26, (7, A)       <br />&#160;&#160;&#160; Balloon: 18, (8, A)       <br />&#160;&#160;&#160; Balloon: 20, (8, A)       <br />&#160;&#160;&#160; Balloon: 110, (3, B)       <br />&#160;&#160;&#160; Balloon: 81, (3, A)       <br />&#160;&#160;&#160; Balloon: 112, (4, A)       <br />&#160; Sheet: Sheet:2       <br />&#160;&#160;&#160; Balloon: 18, (2, B)       <br />&#160;&#160;&#160; Balloon: 19, (3, A)       <br />&#160;&#160;&#160; Balloon: 9, (5, C)       <br />&#160;&#160;&#160; Balloon: 1, (5, D)       <br />&#160;&#160;&#160; Balloon: 3, (5, D)       <br />&#160;&#160;&#160; Balloon: 8, (5, C)       <br />&#160;&#160;&#160; Balloon: 5, (5, D)       <br />&#160;&#160;&#160; Balloon: 7, (5, C)       <br />&#160;&#160;&#160; Balloon: 6, (5, C)       <br />&#160;&#160;&#160; Balloon: 4, (5, D)       <br />&#160;&#160;&#160; Balloon: 31, (5, B)       <br />&#160;&#160;&#160; Balloon: 29, (2, B)       <br />&#160;&#160;&#160; Balloon: 30, (2, B)       <br />&#160;&#160;&#160; Balloon: 28, (2, B)       <br />&#160;&#160;&#160; Balloon: 24, (2, B)       <br />&#160;&#160;&#160; Balloon: 27, (2, B)       <br />&#160;&#160;&#160; Balloon: 25, (2, B)       <br />&#160;&#160;&#160; Balloon: 26, (2, B)       <br />&#160;&#160;&#160; Balloon: 12, (5, B)       <br />&#160;&#160;&#160; Balloon: 11, (5, B)       <br />&#160;&#160;&#160; Balloon: 10, (5, B)       <br />&#160;&#160;&#160; Balloon: 16, (2, C)       <br />&#160;&#160;&#160; Balloon: 18, (3, D)       <br />&#160;&#160;&#160; Balloon: 17, (3, D)       <br />&#160;&#160;&#160; Balloon: 14, (2, C)       <br />&#160;&#160;&#160; Balloon: 13, (2, C)       <br />&#160;&#160;&#160; Balloon: 9, (2, C)       <br />&#160;&#160;&#160; Balloon: 15, (3, D)       <br />&#160;&#160;&#160; Balloon: 20, (3, A)       <br />&#160;&#160;&#160; Balloon: 23, (2, A)       <br />&#160;&#160;&#160; Balloon: 22, (3, A)       <br />&#160;&#160;&#160; Balloon: 21, (3, A)       <br />&#160; Sheet: Sheet:3</p> </div>  <p>Hereâ€™s the VBA macro.&#160; To use it, just copy and paste the code below into a VBA code module, have a drawing open, and run it.&#160; If youâ€™re not familiar with VBA, instructions to do this are available <a href="http://modthemachine.typepad.com/my_weblog/2010/05/using-vba-sample-code-for-the-non-programmer.html">here</a>.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub BalloonReport()&#160; <br /><font color="#0000ff"><strong>&#160; ' Get the active drawing document.&#160; <br /></strong></font>&#160; Dim drawDoc As DrawingDocument&#160; <br />&#160; Set drawDoc = ThisApplication.ActiveDocument&#160; <br />      <br /><font color="#0000ff"><strong>&#160; ' Open a file to write the results into.&#160; <br /></strong></font>&#160; Dim filename As String&#160; <br />&#160; filename = &quot;C:\Temp\BalloonReport.txt&quot;&#160; <br />&#160; Open filename For Output As #1&#160; <br />      <br /><font color="#0000ff"><strong>&#160; ' Print out the header for the report, both to the&#160; <br />&#160; ' output file and the immediate window in VBA.&#160; <br /></strong></font>&#160; Debug.Print &quot;&quot;&#160; <br />&#160; Debug.Print &quot;==== Balloon Report ====&quot;&#160; <br />&#160; Print #1, &quot;==== Balloon Report ====&quot;&#160; <br />      <br /><font color="#0000ff"><strong>&#160; ' Iterate through the sheets.&#160; <br /></strong></font>&#160; Dim drawSheet As sheet&#160; <br />&#160; For Each drawSheet In drawDoc.Sheets&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Print out the sheet name.&#160; <br /></strong></font>&#160;&#160;&#160; Debug.Print &quot;&#160; Sheet: &quot; &amp; drawSheet.Name&#160; <br />&#160;&#160;&#160; Print #1, &quot;&#160; Sheet: &quot; &amp; drawSheet.Name&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine the zones within this sheet.&#160; This assumes that         <br />&#160;&#160;&#160; ' the border was created as a standard border where the          <br />&#160;&#160;&#160; ' zones are explicitly defined.&#160; If this is a custom border          <br />&#160;&#160;&#160; ' then some other mechanism will need to be created to&#160; <br />&#160;&#160;&#160; ' define the zones.&#160; <br /></strong></font>&#160;&#160;&#160; Dim border As DefaultBorder&#160; <br />&#160;&#160;&#160; Set border = drawSheet.border&#160; <br />&#160;&#160;&#160; Dim XZoneWidth As Double&#160; <br />&#160;&#160;&#160; Dim YZoneWidth As Double&#160; <br />&#160;&#160;&#160; XZoneWidth = drawSheet.Width / border.HorizontalZoneCount&#160; <br />&#160;&#160;&#160; YZoneWidth = drawSheet.Height / border.VerticalZoneCount&#160; <br />&#160;&#160;&#160; Dim XZoneIsNumber As Boolean&#160; <br />&#160;&#160;&#160; If border.HorizontalZoneLabelMode = kBorderLabelModeNumeric Then&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; XZoneIsNumber = True&#160; <br />&#160;&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; XZoneIsNumber = False&#160; <br />&#160;&#160;&#160; End If&#160; <br />      <br />&#160;&#160;&#160; Dim YZoneIsNumber As Boolean&#160; <br />&#160;&#160;&#160; If border.VerticalZoneLabelMode = kBorderLabelModeNumeric Then&#160; <br />&#160;&#160;&#160;&#160;&#160; YZoneIsNumber = True&#160; <br />&#160;&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160; YZoneIsNumber = False&#160; <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through the balloons on this sheet.&#160; <br /></strong></font>&#160;&#160;&#160; Dim drawBalloon As Balloon&#160; <br />&#160;&#160;&#160; For Each drawBalloon In drawSheet.Balloons&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Because the border is numbered in the X direction from&#160; <br />&#160;&#160;&#160;&#160;&#160; ' right to left and the sheet coordinate system is from&#160; <br />&#160;&#160;&#160;&#160;&#160; ' left to right, this reverses the X coordinate so the&#160; <br />&#160;&#160;&#160;&#160;&#160; ' zone computation will be correct.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim newXPosition As Double&#160; <br />&#160;&#160;&#160;&#160;&#160; newXPosition = drawSheet.Width - drawBalloon.position.X&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Determine the X zone.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim XZone As Integer&#160; <br />&#160;&#160;&#160;&#160;&#160; XZone = Int(newXPosition / XZoneWidth)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the X zone as a string.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim XZoneValue As String&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160; If XZoneIsNumber Then&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; XZoneValue = XZone + 1&#160; <br />&#160;&#160;&#160;&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; XZoneValue = Chr(XZone + 65)&#160; <br />&#160;&#160;&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Determine Y zone.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim YZone As Integer&#160; <br />&#160;&#160;&#160;&#160;&#160; YZone = Int(drawBalloon.position.Y / YZoneWidth)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the Y zone as a string.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim YZoneValue As String&#160; <br />&#160;&#160;&#160;&#160;&#160; If YZoneIsNumber Then&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; YZoneValue = YZone + 1&#160; <br />&#160;&#160;&#160;&#160;&#160; Else&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; YZoneValue = Chr(YZone + 65)&#160; <br />&#160;&#160;&#160;&#160;&#160; End If&#160; <br />      <br /><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160; ' Iterate through each value set associated with this balloon.&#160; <br /></font></strong>&#160;&#160;&#160;&#160;&#160; Dim valueSet As BalloonValueSet&#160; <br />&#160;&#160;&#160;&#160;&#160; For Each valueSet In drawBalloon.BalloonValueSets&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Print out the results for this value set.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print &quot;&#160;&#160;&#160; Balloon: &quot; &amp; valueSet.value &amp; _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;, (&quot; &amp; XZoneValue &amp; &quot;, &quot; &amp; YZoneValue &amp; &quot;)&quot;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Print #1, &quot;&#160;&#160;&#160; Balloon: &quot; &amp; valueSet.value &amp; _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;, (&quot; &amp; XZoneValue &amp; &quot;, &quot; &amp; YZoneValue &amp; &quot;)&quot;&#160; <br />&#160;&#160;&#160;&#160;&#160; Next&#160; <br />&#160;&#160;&#160; Next&#160; <br />&#160; Next&#160; <br />      <br /><font color="#0000ff"><strong>&#160; ' Close the output file.&#160; <br /></strong></font>&#160; Close #1&#160; <br />      <br />&#160; MsgBox &quot;Report written to: &quot;&quot;&quot; &amp; filename &amp; &quot;&quot;&quot;&quot;       <br />End Sub</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Any Interest in Solid Works?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: any-interest-in-solid-works
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/08/any-interest-in-solid-works.html 
DATE: 08/26/2010 06:06:21 PM
-----
BODY:
<p>I have a quick question while I work on finishing up the series of posts on using C# with Inventorâ€™s API.&#0160; Are any of you interested in a series of posts that would discuss porting Solid Works applications you have written to Inventor?&#0160; If you are, you can add a comment to this post.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Brad Johnson
EMAIL: brjjohnson@dstoutput.com
IP: 165.79.13.192
URL: 
DATE: 08/26/2010 09:29:31 PM
Yes, I would be very interest in converting a VB6 program that I wrote for SolidWorks. I have been trying to use iLogic and VB Express 2010. This has worked and is going to take a lot more time.
-----
COMMENT:
AUTHOR: JB
EMAIL: jeamy.baena@microcad.com.co
IP: 190.248.115.220
URL: 
DATE: 08/27/2010 04:56:28 PM
Any information about this topic, it will be appreciated. Thanks Brian.
-----
COMMENT:
AUTHOR: Gerrard
EMAIL: g.hickson@tpg.com.au
IP: 203.41.236.211
URL: 
DATE: 09/02/2010 12:19:25 AM
Very interested to hear more about this topic Brian. I'll be watching closely.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Using C# with the Inventor API (Part 3)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: using-c-with-the-inventor-api-part-3
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/08/using-c-with-the-inventor-api-part-3.html 
DATE: 08/12/2010 06:46:02 PM
-----
BODY:
<p>Hereâ€™s my third installment on some of the differences between VBA and C# that youâ€™ll encounter when using C# to program Inventorâ€™s API.&#160; Here are links to the <a href="http://modthemachine.typepad.com/my_weblog/2010/07/using-c-with-the-inventor-api-part-1.html">first</a> and <a href="http://modthemachine.typepad.com/my_weblog/2010/08/using-c-with-the-inventor-api-part-2.html">second</a> posts.</p>  <p><strong><em><font size="3">Optional Arguments</font></em></strong>&#160; <br />Previous to C# 2010, C# didnâ€™t support optional arguments so you need to provide every argument in a method call.&#160; If youâ€™re already working with C# 2010 then you can ignore this section.</p>  <p>The thing that makes handling optional arguments in C# difficult is figuring out what value you need to supply to get the same default behavior as you would in another language that supports optional arguments.</p>  <p>Hereâ€™s one example using the Documents.Add method.&#160; If you look at this using the Object Browser in C# you wonâ€™t get much help in determine what values to provide for the optional arguments, since in C# they arenâ€™t optional.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b79b970b-pi"><img title="CSharp2008ObjectBrowser" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="255" alt="CSharp2008ObjectBrowser" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b7a1970b-pi" width="454" border="0" /></a> </p>  <p>If you have Visual Studio, the Visual Basic Object Browser is a good way to determine what the expected input is.&#160; The Documents.Add method is shown below and its signature appears at the bottom of the browser.&#160; The first argument specifying the document type doesnâ€™t have a default value and must always be supplied.&#160; The second argument specifying the template is optional, and defaults to an empty String.&#160; The third value is also optional Boolean and defaults to True.    <br />    <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b7ba970b-pi"><img title="VB2008ObjectBrowser" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="222" alt="VB2008ObjectBrowser" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b7d3970b-pi" width="454" border="0" /></a></p>  <p>   <br />Here are examples of VBA and C# code calling the Documents.Add method where the desire is to take the default values for the optional arguments.</p>  <p><em>VBA</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim doc As Document    <br />&#160;&#160;&#160; Set doc = ThisApplication.Documents.Add(kPartDocumentObject) </div>  <p></p>  <p><em>C#</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Document doc;    <br />&#160;&#160;&#160; doc = invApp.Documents.Add(DocumentTypeEnum.kPartDocumentObject,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;&quot;, true); </div>  <p>The other case youâ€™ll run into are arguments where the default value in Visual Basic is Nothing.&#160; This is demonstrated in the AssemblyConstraints.AddMate method where the last two arguments default to Nothing, as shown below.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134862a3c7e970c-pi"><img title="VBObjectBrowserMate" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="197" alt="VBObjectBrowserMate" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b809970b-pi" width="454" border="0" /></a> </p>  <p>In C#, instead of Nothing you can use Type.Missing, as shown in the code below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">MateConstraint mate;    <br />mate = asmDef.Constraints.AddMateConstraint(face1, face2, 0,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InferredTypeEnum.kNoInference,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InferredTypeEnum.kNoInference,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Type.Missing, Type.Missing); </div>  <p><strong><em><font size="3">Casting</font></em></strong>     <br />When making variable assignments, VBA and Visual Basic will automatically cast from one type to another when itâ€™s possible.&#160; C# doesnâ€™t do this automatically so you have to explicitly cast variables.&#160; Hereâ€™s some VBA code demonstrating the complete sample from above that places a mate constraint.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub AddMate()      <br />&#160;&#160;&#160; Dim asmDoc As AssemblyDocument       <br />&#160;&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; Dim asmDef As AssemblyComponentDefinition       <br />&#160;&#160;&#160; Set asmDef = asmDoc.ComponentDefinition       <br />      <br />&#160;&#160;&#160; Dim face1 As face       <br />&#160;&#160;&#160; Set face1 = ThisApplication.CommandManager.Pick( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectionFilterEnum.kPartFacePlanarFilter, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select planar face 1.&quot;)       <br />&#160;&#160;&#160; Dim face2 As face       <br />&#160;&#160;&#160; Set face2 = ThisApplication.CommandManager.Pick( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectionFilterEnum.kPartFacePlanarFilter, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select planar face 2.&quot;) </p>    <p>&#160;&#160;&#160; Dim mate As MateConstraint      <br />&#160;&#160;&#160; Set mate = asmDef.Constraints.AddMateConstraint(face1, face2, 0)       <br />End Sub</p> </div>  <p>Hereâ€™s the equivalent code in C#.&#160; There are several casts required to get this code to work.&#160; The casts are needed because those calls are typed to return a value different than the variable itâ€™s being assigned to.&#160; For example, the Application.ActiveDocument property is typed to return an object of type Document and itâ€™s being assigned to a variable typed as AssemblyDocument.&#160; Visual Basic and VBA handle this conversion automatically.&#160; In C# you need to tell it the conversion type by adding the <font face="Courier New">(AssemblyDocument)</font> cast.&#160; The same thing is required with the Pick method which is typed to return an Object.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>AssemblyDocument asmDoc = (AssemblyDocument)invApp.ActiveDocument;      <br />AssemblyComponentDefinition asmDef = asmDoc.ComponentDefinition; </p>    <p>Face face1 = (Face)invApp.CommandManager.Pick(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectionFilterEnum.kPartFacePlanarFilter,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select planar face 1.&quot;);       <br />Face face2 = (Face)invApp.CommandManager.Pick(       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectionFilterEnum.kPartFacePlanarFilter,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Select planar face 2.&quot;); </p>    <p>MateConstraint mate;      <br />mate = asmDef.Constraints.AddMateConstraint(face1, face2, 0,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InferredTypeEnum.kNoInference,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InferredTypeEnum.kNoInference,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Type.Missing, Type.Missing); </p> </div>  <p>Casting problems are typically easy to catch because the error from Visual Studio tells you exactly what the problem is.</p>  <p>&#160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b817970b-pi"><img title="CastingError" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="74" alt="CastingError" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f306b81e970b-pi" width="470" border="0" /></a>     <br />    <br />Hereâ€™s another example that isnâ€™t specifically a casting issue but is somewhat related and the easy way to solve the problem is by using casting.&#160; Below is some VBA code that gets the first body in the active part document.&#160; (Remember that a     <br />â€œ _â€ (space underscore) identifies a line continuation in Visual Basic.)</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Dim body As SurfaceBody    <br />Set body = ThisApplication.ActiveDocument. _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComponentDefinition.SurfaceBodies.Item(1) </div>  <p></p>  <p>Hereâ€™s the same code converted to C#.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>SurfaceBody body;      <br />body = invApp.ActiveDocument.ComponentDefinition.SurfaceBodies[1]; </p> </div>  <p>The above code doesnâ€™t work in C# and results in the error shown below.&#160; This is because the ActiveDocument property returns a Document object, not a PartDocument object, and the Document object does not support the ComponentDefinition property.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134862a3c8e970c-pi"><img title="ComponentDefinitionError" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="78" alt="ComponentDefinitionError" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340134862a3c97970c-pi" width="470" border="0" /></a> </p>  <p>Breaking the line up to first get the PartDocument object, which requires casting, and then using that object to get the body fixes the problem.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>PartDocument partDoc = (PartDocument) invApp.ActiveDocument;      <br />SurfaceBody body = partDoc.ComponentDefinition.SurfaceBodies[1]; </p> </div>  <p><strong><font size="3"><em>Declaring Arrays</em></font></strong>     <br />When you declare an array in VBA it is automatically initialized.&#160; In C# (and VB.Net) declaring an array does not initialize it.&#160; You need to add a bit more to the declaration to cause the initialization.&#160; If you donâ€™t initialize the array youâ€™ll get an error when you pass the array as a method argument. </p>  <p><em>VBA</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim stuff() As Double </div>  <p><em>VB.Net</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim stuff() As Double = {} </div>  <p><em>C#</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; double[] stuff = new double[] {}; </div>  <br /><strong><font size="3"><em>Resizing an Array</em></font></strong>   <br />In VB/VBA you can resize an array and maintain its current contents by using the Redim statement using the Preserve option.&#160; C# canâ€™t dynamically resize an array so to accomplish the equivalent you create a new array of the desired size and copy the original array into it.   <br />  <p><em>VBA</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim newSize As Integer    <br />&#160;&#160;&#160; newSize = 500     <br />&#160;&#160;&#160; Redim Preserve stuff(newSize) </div>  <p><em>C#</em>     <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; int newSize = 500;</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; int[] newStuff = new int[newSize]; </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; stuff.CopyTo(newStuff, 0);</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steffen
EMAIL: steffen@dyhr-nielsen.dk
IP: 87.56.112.154
URL: 
DATE: 08/30/2010 09:07:35 PM
I just opened my fresh copy of "C# 4.0 in a nutshell" and allready on page 5 "Dynamic binding" is mentioned as the biggest innovation in C# 4.0.. "useful when interoperating with dynamic languages and COM components"..  Any chance on showing how this can affect casting & typing in the API with some examples in part 4 ;)..
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Using C# with the Inventor API (Part 2)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: using-c-with-the-inventor-api-part-2
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/08/using-c-with-the-inventor-api-part-2.html 
DATE: 08/02/2010 06:58:01 PM
-----
BODY:
<p>Hereâ€™s my second installment on some of the differences youâ€™ll encounter when using C# to program Inventorâ€™s API.&#160; The first post is <a href="http://modthemachine.typepad.com/my_weblog/2010/07/using-c-with-the-inventor-api-part-1.html">here</a>.     <br /></p>  <p><em><strong>Property Name Differences</strong></em>     <br />If a property has arguments then C# automatically converts that property into one or two methods so that there is a method that represents the read version of the property and another for the write version.     <br />    <br />Hereâ€™s an example VBA program that calls some properties.&#160; The first is the Transformation property of the ComponentOccurrence object.&#160; It reads this property and then later also sets the value of the property.&#160; The program also uses the Cell property of the Matrix object.&#160; This property has arguments to allow you to specify the row and column of the cell you want to get or set.&#160; </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Get the selected occurrence from the active document.          <br />' This will fail if an occurrence is not currently selected.           <br /></strong></font>Set occ = asmDoc.SelectSet.Item(1) </p>    <p><font color="#0000ff"><strong>' Get the transform from the selected occurrence.          <br /></strong></font>Dim transform As Matrix       <br />Set transform = occ.Transformation </p>    <p><font color="#0000ff"><strong>' Display the current X translation value.          <br /></strong></font>Debug.Print &quot;X translation: &quot; &amp; transform.Cell(1, 4) </p>    <p><font color="#0000ff"><strong>' Modify the X translation to be an additional 1 cm.          <br /></strong></font>transform.Cell(1, 4) = transform.Cell(1, 4) + 1 </p>    <p><font color="#0000ff"><strong>' Assign the modified matrix back to the occurence.          <br /></strong></font>occ.Transformation = transform </p> </div>  <p>Hereâ€™s the equivalent code in C#.&#160; Because the Transformation property doesnâ€™t have any arguments, you use it the same way as in the VBA code above.&#160; The Cell property has arguments and doesnâ€™t exist in C# but is instead accessed by the get_Cell and set_Cell methods.&#160; The get_Cell method takes the row and column as input arguments and returns the value of the cell as a return value.&#160; To set the cell I call the set_Cell method.&#160; This has three arguments, the first two are the row and column and the third is the new value of the cell.&#160; The get_Cell and set_Cell methods donâ€™t actually exist in the Inventor API, but are automatically created by C# as part of its COM interop implementation.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>// Get the selected occurrence from the active document.          <br />// This will fail if an occurrence is not currently selected.           <br /></strong></font>occ = (ComponentOccurrence) asmDoc.SelectSet[1]; </p>    <p><font color="#0000ff"><strong>// Get the transform from the selected occurrence.          <br /></strong></font>Matrix transform;       <br />transform = occ.Transformation; </p>    <p><font color="#0000ff"><strong>// Display the current X translation value.          <br /></strong></font>System.Diagnostics.Debug.Print(       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;X translation: &quot; + transform.get_Cell(1, 4)); </p>    <p><font color="#0000ff"><strong>// Modify the X translation to be an additional 1 cm.          <br /></strong></font>transform.set_Cell( 1, 4, transform.get_Cell(1, 4) + 1.0 ); </p>    <p><font color="#0000ff"><strong>// Assign the modified matrix back to the occurence.          <br /></strong></font>occ.Transformation = transform;</p> </div>  <p>This inconsistency between VB and C# is relatively easy to catch because youâ€™ll get an error saying that the specified property doesnâ€™t exist.&#160; That should be the reminder to look for the get_XXX or set_XXX version instead.</p>  <p><em><strong>Methods that Return Values as Arguments</strong></em>    <br />In C# you need to explicitly specify that an argument will return a value when making a method call.&#160; Hereâ€™s the VBA example of calling the GetCoordinateSystem method of the Matrix object.&#160; All four arguments are return values.&#160; The VBA version of the code doesnâ€™t do anything special to indicate they are return values. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>' Get the coordinate system information from the matrix.        <br /></strong></font>Dim origin As Point     <br />Dim xAxis As Vector     <br />Dim yAxis As Vector     <br />Dim zAxis As Vector     <br />Call transform.GetCoordinateSystem(origin, xAxis, yAxis, zAxis) </div>  <br />Hereâ€™s the equivalent C# code.&#160; Notice that I have to qualify each argument that will return a value with the â€œoutâ€ keyword to indicate that the argument is being passed by reference and will return a value.   <br />  <br />  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>// Get the coordinate system information from the matrix.</strong></font>     <br />Inventor.Point origin;     <br />Vector xAxis;     <br />Vector yAxis;     <br />Vector zAxis;     <br />transform.GetCoordinateSystem(out origin, out xAxis,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; out yAxis, out zAxis);     <br /></div>  <p>This issue is also relatively easy to catch and fix since it shows itself as a compile error.&#160; Intellisense provides the best clue about what the problem is.&#160; Below is the feedback for the code above before I added the â€œoutâ€ keyword to each argument.&#160; Notice that each argument has the â€œoutâ€ keyword in the signature shown in the intellisense window.&#160; Typically there may be some input arguments and one or two output arguments.&#160; Itâ€™s only the output arguments that you need to add the â€œoutâ€ keyword to.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f2cd5863970b-pi"><img title="OutKeyword" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="159" alt="OutKeyword" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f2cd586c970b-pi" width="495" border="0" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steffen
EMAIL: steffen@dyhr-nielsen.dk
IP: 87.56.112.154
URL: 
DATE: 08/11/2010 10:35:18 AM
Hi Brian..  Please keep em coming!!!
IÂ´m fighting alot to make VBA examples work in C#. This code was how I got an example from the helpfiles working in C#


WorkPlane wXY = part1.WorkPlanes["XY Plane"];
object pXY;
compOcc.CreateGeometryProxy(wXY, out pXY);
pXY = (WorkPlaneProxy)pXY;


In VBA  the WorkPlaneProxy is defined as a WorkPlaneProxy BEFORE the call, but this threw an exception in C#.. I would really appretiate if you could explain ( with a few concrete examples like above ) the underlying differences between C# and VBA regarding typing, as it seems to be a major issue IÂ´m facing again and again.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Using C# with the Inventor API (Part 1)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: using-c-with-the-inventor-api-part-1
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/07/using-c-with-the-inventor-api-part-1.html 
DATE: 07/27/2010 07:47:34 PM
-----
BODY:
<p>My <a href="http://modthemachine.typepad.com/my_weblog/2010/07/sketch-curve-as-line-segments-in-vbnet-and-c.html#scrollDown">last post</a> contained VB.Net and C# versions of a VBA program from an <a href="http://modthemachine.typepad.com/my_weblog/2010/07/approximating-a-sketch-curve-with-line-segments.html#tp">earlier post</a>.&#160; Converting the VBA program to VB.Net was relatively easy.&#160; The conversion to C# wasnâ€™t as easy.&#160; In this post I want to begin covering many of the issues youâ€™ll run into when converting VBA code to C#.</p>  <p>One question that might come to mind is why would you want to convert from VBA and not just write everything in C# to begin with?&#160; The first reason is that many of the programming samples youâ€™ll find for the Inventor API are written using VBA.&#160; The second reason is that VBA remains the fastest and easiest way to access and use the Inventor API.&#160; Having said that, it does have a lot of other shortcomings so I wouldnâ€™t recommend it for general development, but if youâ€™re not using it for prototyping youâ€™re missing out on a very powerful tool.</p>  <p>To go from VBA to C#, Iâ€™ve found the simplest method is to first convert the code to VB.Net.&#160; This is typically fairly easy, particularly if the VBA code was written with going to VB.Net in mind.&#160; For example, all arrays should be 0 based.&#160; In many cases itâ€™s just a copy and paste and Visual Studio will automatically do some syntax conversion.&#160; Some of the manual changes that were required I went over in the <a href="http://modthemachine.typepad.com/my_weblog/2010/07/sketch-curve-as-line-segments-in-vbnet-and-c.html">previous post</a>.&#160; The next step is to go from VB.Net to C#.&#160; There are some converters that do a pretty good job of automatically converting the VB.Net code to C#.&#160; I found an online converter using Google that worked great.&#160; (For any syntax issues that might still come up, hereâ€™s a <a href="http://www.harding.edu/fmccown/vbnet_csharp_comparison.html">good comparison of VB.Net and C#</a>.)&#160; Next youâ€™ll need to account for other differences that are typically specific to a COM Automation API, like Inventorâ€™s.&#160; Itâ€™s those issues that this series of posts will attempt to cover.</p>  <p><strong><em>Item Property</em>       <br /></strong>C# hides the fact that thereâ€™s an Item property on the Inventor collection objects so&#160; you access the contents of the collection as if it was a read-only array, except the first item has an index of 1. </p> VBA   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim body As SurfaceBody&#160; <br />&#160;&#160;&#160; Set body = partDef.SurfaceBodies.Item(1) </div>  <br />C#   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; SurfaceBody body;    <br />&#160;&#160;&#160; body = partDef.SurfaceBodies[1];     <br /></div>  <p><strong>     <br /><em>Comparing Two Objects</em>       <br /></strong>Sometimes you need to check if two variables referencing objects are referring to the same object.&#160; Hereâ€™s how you do it in VBA and C# </p> VBA   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a parameter using two different collections.        <br /></strong></font>&#160;&#160;&#160; Dim var1 As Parameter     <br />&#160;&#160;&#160; Set var1 = partDef.Parameters.Item(&quot;Length&quot;)     <br />&#160;&#160;&#160; Dim var2 As ModelParameter     <br />&#160;&#160;&#160; Set var2 = partDef.Parameters.ModelParameters.Item(&quot;Length&quot;)&#160;&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Verify that the variables are referencing the same parameter.        <br /></strong></font>&#160;&#160;&#160; If var1 Is var2 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The two variables reference the same object.&quot;     <br />&#160;&#160;&#160; End If </div>  <br />C#   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160; // Get a parameter using two different collections.&#160; <br /></strong></font>&#160; Parameter var1 = partDef.Parameters[&quot;Length&quot;];&#160; <br />&#160; ModelParameter var2;     <br />&#160; var2 = partDef.Parameters.ModelParameters[&quot;Length&quot;];&#160; <br />    <br /><font color="#0000ff"><strong>&#160; // Verify that the variables are referencing the same parameter.&#160; <br /></strong></font>&#160; if (var1 == var2)&#160; <br />&#160; {&#160; <br />&#160;&#160;&#160; MessageBox.Show(&quot;The two variables reference the same object.&quot;);&#160; <br />&#160; } </div>  <p>   <br /><strong><em>Checking the Type of an Object</em></strong>     <br />Sometimes itâ€™s useful to be able to check if an object is a certain type.&#160; Both VBA and C# provide an easy way to do this. </p> VBA   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the selected object.&#160; <br />&#160;&#160;&#160; ' This will fail if nothing is selected.         <br /></strong></font>&#160;&#160;&#160; Dim selectedObject As Object     <br />&#160;&#160;&#160; Set selectedObject = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ActiveDocument.SelectSet.Item(1)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check that the selected object is a sketch line.        <br /></strong></font>&#160;&#160;&#160; If TypeOf selectedObject Is SketchLine Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Selected object is a sketch line&quot;     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Something besides a sketch line is selected.&quot;     <br />&#160;&#160;&#160; End If </div>  <br />C#   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the selected object.&#160; <br />&#160;&#160;&#160; // This will fail if nothing is selected.         <br /></strong></font>&#160;&#160;&#160; object selectedObject = invApp.ActiveDocument.SelectSet[1];     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Check that the selected object is a sketch line.        <br /></strong></font>&#160;&#160;&#160; if (selectedObject is SketchLine)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;Selected object is a sketch line&quot;);     <br />&#160;&#160;&#160; else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;Something besides a sketch line is     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; selected.&quot;); </div>  <p></p>  <p><strong><em>       <br />Iterating Through the Contents of a Collection</em></strong>     <br />Using a For Each loop is the most efficient way to iterate through the contents of a collection.&#160; In some cases it can be much faster than using the collectionâ€™s Count and Item properties. </p> VBA   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate over all of the faces in the primary body.        <br /></strong></font>&#160;&#160;&#160; Dim area As Double     <br />&#160;&#160;&#160; Dim partFace As Face     <br />&#160;&#160;&#160; For Each partFace In partDef.SurfaceBodies.Item(1).Faces     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; area = area + partFace.Evaluator.area     <br />&#160;&#160;&#160; Next     <br />    <br />&#160;&#160;&#160; MsgBox &quot;Total surface area: &quot; &amp; area &amp; &quot; cm^2&quot;</div>  <br />C#   <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; // Iterate over all of the faces in the primary body.        <br /></strong></font>&#160;&#160;&#160; double area = 0;     <br />&#160;&#160;&#160; foreach( Face partFace in partDef.SurfaceBodies[1].Faces)     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; area += partFace.Evaluator.Area;     <br />&#160;&#160;&#160; }     <br />    <br />&#160;&#160;&#160; MessageBox.Show(&quot;Total surface area: &quot; + area + &quot; cm^2&quot;);</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rodney
EMAIL: rodneyjt@jayteknet.com
IP: 69.11.232.226
URL: http://www.jayteknet.com
DATE: 07/29/2010 09:55:29 PM
One thing to note with C# and the some members. There are a few types I've come across that don't properly expose some members and a get_MemberName() has to be used instead.

For example: 
Parameter.Units -> Parameter.get_Units()
ComponentOccurences.ItemByName() -> ComponentOccurences.get_ItemByName()

-----
COMMENT:
AUTHOR: Joe
EMAIL: joesu@belvac.com
IP: 65.210.36.90
URL: 
DATE: 08/11/2010 03:02:34 PM
Could you please explain why you would want to convert from VB .NET to C#?
-----
COMMENT:
AUTHOR: Sonicsx
EMAIL: animafia@msn.com
IP: 201.230.151.157
URL: 
DATE: 10/09/2010 10:29:16 PM
Nice blog. Really useful. Maybe you can help me. What is the equivalence in c# of the code below?

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.Documents.Open("C:\work\1.ipt", False)

THX
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Sketch Curve as Line Segments in VB.Net and C#
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: sketch-curve-as-line-segments-in-vbnet-and-c
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/07/sketch-curve-as-line-segments-in-vbnet-and-c.html 
DATE: 07/20/2010 06:15:58 PM
-----
BODY:
<p>Hereâ€™s the VB.Net and C# versions of the <a href="http://modthemachine.typepad.com/my_weblog/2010/07/approximating-a-sketch-curve-with-line-segments.html">VBA program from previous post</a>.&#160; To go from that VBA program to this VB.Net version was fairly easy.&#160; I just copied and pasted the VBA code into a new VB.Net project.&#160; The primary changes that I had to make were primarily to the array declarations.&#160; Another change, although it wasnâ€™t required, was to change the error handling from the On Error style to Try Catch.&#160; I prefer the Try Catch style of error handling.&#160; </p>  <p>The array declaration change is because in .Net declaring an array isnâ€™t enough to&#160; initialize it.&#160; The VBA version of one of the declarations is here:</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim startCoord() As Double</p> </div>  <p>Hereâ€™s the .Net version of the same array.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim startCoord() As Double = {}      <br /></p> </div>  <p>Hereâ€™s the full VB.Net program.&#160; The Inventor Application object is passed in as an argument.&#160; The act of pasting the VBA code into a .Net program automatically removed all of the Set statements because theyâ€™re not longer needed in .Net, which is nice.&#160; I also like to enclose arguments to a method within parentheses.&#160; In VBA the parentheses are optional and use have to use the Call statement to have them.&#160; In VB.Net parentheses are required and using a Call statement is optional.&#160; Other than these minor changes, itâ€™s the same code as the original VBA version.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub CreateSegmentedCurve(ByVal invApp As Inventor.Application)      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see that a curved sketch entity is selected.          <br /></strong></font>&#160;&#160;&#160; Dim entity As SketchEntity       <br />&#160;&#160;&#160; Try       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; entity = invApp.ActiveDocument.SelectSet.Item(1)       <br />&#160;&#160;&#160; Catch ex As Exception       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;A curved sketch entity must be selected.&quot;)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End Try&#160; <br />      <br />&#160;&#160;&#160; If TypeOf entity Is SketchPoint Or _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchLine Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;A curved sketch entity must be selected.&quot;)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Ask for the number of segments to break the curve into.          <br /></strong></font>&#160;&#160;&#160; Dim prompt As String       <br />&#160;&#160;&#160; prompt = &quot;Enter the number of segments for the curve.&quot;       <br />&#160;&#160;&#160; Dim segmentCount As Integer       <br />&#160;&#160;&#160; segmentCount = Val(InputBox(prompt, &quot;Number of Segments&quot;, &quot;10&quot;))       <br />&#160;&#160;&#160; If segmentCount = 0 Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;Invalid segment count.&quot;)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the parent sketch.          <br /></strong></font>&#160;&#160;&#160; Dim sk As Sketch = entity.Parent&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the evaluator from the associate geometry.          <br /></strong></font>&#160;&#160;&#160; Dim curveEval As Curve2dEvaluator = entity.Geometry.Evaluator       <br />&#160;&#160;&#160; Dim minU As Double       <br />&#160;&#160;&#160; Dim maxU As Double&#160; <br />&#160;&#160;&#160; curveEval.GetParamExtents(minU, maxU)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine if the entity is open or closed (circle,          <br />&#160;&#160;&#160; ' ellipse, or closed spline)           <br /></strong></font>&#160;&#160;&#160; Dim curveIsClosed As Boolean = False       <br />&#160;&#160;&#160; If TypeOf entity Is SketchCircle Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchEllipse Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchSpline Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchOffsetSpline Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If TypeOf entity Is SketchSpline Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchOffsetSpline Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If entity.Closed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = True       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = True       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End If       <br />      <br />&#160;&#160;&#160; Dim tg As TransientGeometry = invApp.TransientGeometry&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine if start point is at the min or max parameter.          <br /></strong></font>&#160;&#160;&#160; Dim startPoint As SketchPoint = Nothing       <br />&#160;&#160;&#160; Dim endPoint As SketchPoint = Nothing       <br />&#160;&#160;&#160; If Not curveIsClosed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim startCoord() As Double = {}       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim endCoord() As Double = {}&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetEndPoints(startCoord, endCoord)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If entity.StartSketchPoint.Geometry.IsEqualTo( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(startCoord(0), startCoord(1))) Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; startPoint = entity.StartSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = entity.EndSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = entity.StartSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; startPoint = entity.EndSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the curve length.          <br /></strong></font>&#160;&#160;&#160; Dim length As Double&#160; <br />&#160;&#160;&#160; curveEval.GetLengthAtParam(minU, maxU, length)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine the length between segments.          <br /></strong></font>&#160;&#160;&#160; Dim offset As Double       <br />&#160;&#160;&#160; offset = length / segmentCount&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Start a transaction to wrap the sketch creation as a          <br />&#160;&#160;&#160; ' single undo operation.           <br /></strong></font>&#160;&#160;&#160; Dim trans As Transaction = Nothing       <br />&#160;&#160;&#160; Try       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim transMgr As TransactionManager       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; transMgr = invApp.TransactionManager       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans = transMgr.StartTransaction( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; invApp.ActiveDocument, &quot;Segment Curve&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Defer updates on the sketch while the sketch entities          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' are being created.&#160; This will significantly improve           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' performance.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = True&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Calculate the points and create a sketch          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' point at each position.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim points() As SketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ReDim points(segmentCount)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim currentLength As Double = 0       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i As Integer = 0 To segmentCount       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim currentParam As Double&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetParamAtLength(minU, currentLength, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentParam)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentLength = currentLength + offset&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim params(0) As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; params(0) = currentParam       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim coords() As Double = {}&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetPointAtParam(params, coords)&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If i = 0 Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Special case for the first point.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not curveIsClosed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(i) = startPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(i) = sk.SketchPoints.Add( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords(0), coords(1)), _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; False)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = points(i)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ElseIf i = segmentCount Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Special case for the last point          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(i) = endPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(i) = sk.SketchPoints.Add( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords(0), coords(1)), _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; False)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Connect the points with lines.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i As Integer = 0 To segmentCount - 1&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.SketchLines.AddByTwoPoints(points(i), points(i + 1))       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Make the selected entity construction geometry.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; entity.Construction = True&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' There's a current problem that when setting the          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' construction property, the display isn't updated           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' to reflect this change until something causes the           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' sketch to recompute.&#160; This performs a change on           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the sketch to kick a recompute.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim originalPoint As Point2d       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; originalPoint = points(0).Geometry&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).MoveTo(tg.CreatePoint2d( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).Geometry.X + 0.001, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).Geometry.Y))&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).MoveTo(originalPoint)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Turn off the defer to the sketch will recompute normally.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = False&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.End()       <br />&#160;&#160;&#160; Catch ex As Exception       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = False&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not trans Is Nothing Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Abort()       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;Unexpected error segmenting curve.&quot;)       <br />&#160;&#160;&#160; End Try       <br />End Sub</p> </div>  <p>Hereâ€™s a C# version of the same program.&#160; Iâ€™m not going to go into a lot of details now about the differences other than to say that there are several.&#160; Iâ€™m working on an upcoming post that will describe the various issues when using C# to program Inventor.&#160; The majority of this code was created using a VB.Net to C# converter, but there were still significant changes that had to be made after that to get it to run.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>static void CreateSegmentedCurve(Inventor.Application invApp)      <br />{       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Check to see that a curved sketch entity is selected.          <br /></strong></font>&#160;&#160;&#160; SketchEntity entity = null;       <br />&#160;&#160;&#160; try       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; entity = (SketchEntity) invApp.ActiveDocument.SelectSet[1];       <br />&#160;&#160;&#160; }       <br />&#160;&#160;&#160; catch&#160; <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;A curved sketch entity must be selected.&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return;       <br />&#160;&#160;&#160; }&#160; <br />      <br />&#160;&#160;&#160; if (entity is SketchPoint | entity is SketchLine)       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;A curved sketch entity must be selected.&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return;       <br />&#160;&#160;&#160; }&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Ask for the number of segments to break the curve into.          <br /></strong></font>&#160;&#160;&#160; string prompt = null;       <br />&#160;&#160;&#160; prompt = &quot;Enter the number of segments for the curve.&quot;;       <br />&#160;&#160;&#160; int segmentCount = 0;       <br />&#160;&#160;&#160; segmentCount = (int) Conversion.Val(Interaction.InputBox(prompt,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Number of Segments&quot;, &quot;10&quot;, 20, 20));       <br />&#160;&#160;&#160; if (segmentCount == 0)       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;Invalid segment count.&quot;);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return;       <br />&#160;&#160;&#160; }&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the parent sketch.          <br /></strong></font>&#160;&#160;&#160; Sketch sk = entity.Parent;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the geometry associated with the sketch entity.&#160; Since          <br />&#160;&#160;&#160; // the Geometry property will return one of various types of          <br />&#160;&#160;&#160; // objects, we need to use late binding here which C# doesn't          <br />&#160;&#160;&#160; // handle very nicely.           <br /></strong></font>&#160;&#160;&#160; object geom = entity.GetType().InvokeMember(&quot;Geometry&quot;,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; BindingFlags.GetProperty , null, entity, null);&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the curve evaluator from the geometry.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Curve2dEvaluator curveEval =       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (Curve2dEvaluator) geom.GetType().InvokeMember(&quot;Evaluator&quot;,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; BindingFlags.GetProperty, null, geom, null);       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the evaluator from the associate geometry.          <br /></strong></font>&#160;&#160;&#160; double minU = 0;       <br />&#160;&#160;&#160; double maxU = 0;       <br />&#160;&#160;&#160; curveEval.GetParamExtents(out minU, out maxU);&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Determine if the entity is open or closed (circle,          <br />&#160;&#160;&#160; // ellipse, or closed spline)           <br /></strong></font>&#160;&#160;&#160; bool curveIsClosed = false;       <br />&#160;&#160;&#160; if (entity is SketchCircle | entity is SketchEllipse |       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; entity is SketchSpline | entity is SketchOffsetSpline)       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (entity is SketchSpline | entity is SketchOffsetSpline)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bool isClosed = (bool) entity.GetType().InvokeMember(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Closed&quot;, BindingFlags.GetProperty,&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; null, entity, null);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (isClosed)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = true;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = true;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160; }       <br />&#160;&#160;&#160; TransientGeometry tg = invApp.TransientGeometry;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Determine if start point is at the min or max parameter.          <br /></strong></font>&#160;&#160;&#160; SketchPoint startPoint = null;       <br />&#160;&#160;&#160; SketchPoint endPoint = null;       <br />&#160;&#160;&#160; if (!curveIsClosed)       <br />&#160;&#160;&#160; {       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Get the start and end sketch points from the curve.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; SketchPoint tempStartPoint =       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (SketchPoint) entity.GetType().InvokeMember(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;StartSketchPoint&quot;, BindingFlags.GetProperty,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; null, entity, null);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; SketchPoint tempEndPoint =       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (SketchPoint) entity.GetType().InvokeMember(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;StartSketchPoint&quot;, BindingFlags.GetProperty,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; null, entity, null);&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Get the coordinate, as a Point object from          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // the start sketch point.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Point2d tempStartCoord =       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (Point2d) tempStartPoint.GetType().InvokeMember(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Geometry&quot;, BindingFlags.GetProperty, null,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tempStartPoint, null);&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; double[] startCoord = {};       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; double[] endCoord = {};       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetEndPoints(ref startCoord, ref endCoord);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (tempStartCoord.IsEqualTo(tg.CreatePoint2d(startCoord[0],      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; startCoord[1]), tg.PointTolerance))       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; startPoint = tempStartPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = tempEndPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = tempStartPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; startPoint = tempEndPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160; }&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Get the curve length.          <br /></strong></font>&#160;&#160;&#160; double length = 0;       <br />&#160;&#160;&#160; curveEval.GetLengthAtParam(minU, maxU, out length);&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Determine the length between segments.          <br /></strong></font>&#160;&#160;&#160; double offset = length / segmentCount;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; // Start a transaction to wrap the sketch creation as a          <br />&#160;&#160;&#160; // single undo operation.           <br /></strong></font>&#160;&#160;&#160; Transaction trans = null;       <br />&#160;&#160;&#160; try       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransactionManager transMgr = null;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; transMgr = invApp.TransactionManager;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans = transMgr.StartTransaction(invApp.ActiveDocument,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Segment Curve&quot;);&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Defer updates on the sketch while the sketch entities          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // are being created.&#160; This will significantly improve           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // performance.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = true;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Calculate the points and create a sketch          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // point at each position.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; SketchPoint[] points = new SketchPoint[segmentCount+1];       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; double currentLength = 0;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; for (int i = 0; i &lt;= segmentCount; i++) {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; double currentParam = 0;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetParamAtLength(minU, currentLength,       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; out currentParam);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentLength = currentLength + offset;&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; double[] crvParams = new double[1];       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; crvParams[0] = currentParam;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; double[] coords = {};       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveEval.GetPointAtParam(ref crvParams, ref coords);&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (i == 0) {       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Special case for the first point.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (!curveIsClosed)&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[i] = startPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[i] = sk.SketchPoints.Add(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords[0],       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; coords[1]), false);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; endPoint = points[i];       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else if (i == segmentCount)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Special case for the last point          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[i] = endPoint;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[i] = sk.SketchPoints.Add(      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords[0],       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; coords[1]), false);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Connect the points with lines.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; for (int i = 0; i &lt;= segmentCount - 1; i++)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.SketchLines.AddByTwoPoints(points[i], points[i + 1]);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Make the selected entity construction geometry.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; entity.Construction = true;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // There's a current problem that when setting the         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // construction property, the display isn't updated to          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // reflect this change until something causes the sketch          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // to recompute.&#160; This performs a change on the sketch to          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // kick a recompute.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Point2d originalPoint = default(Point2d);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; originalPoint = points[0].Geometry;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[0].MoveTo(tg.CreatePoint2d(points[0].Geometry.X +      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0.001, points[0].Geometry.Y));       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; points[0].MoveTo(originalPoint);&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Turn off the defer to the sketch will recompute normally.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = false;&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.End();       <br />&#160;&#160;&#160; }       <br />&#160;&#160;&#160; catch (Exception)       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; sk.DeferUpdates = false;&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if ((trans != null))       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Abort();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MessageBox.Show(&quot;Unexpected error segmenting curve.&quot;);       <br />&#160;&#160;&#160; }       <br />}</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Approximating a Sketch Curve with Line Segments
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: approximating-a-sketch-curve-with-line-segments
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/07/approximating-a-sketch-curve-with-line-segments.html 
DATE: 07/15/2010 07:23:52 PM
-----
BODY:
<p>Hereâ€™s another little VBA macro that I wrote that might be interesting to some of you.&#160; This one takes any sketch curve (circle, arc, spline, ellipse, or elliptical arc) as input, along with the number of segments to break the curve into.&#160; It then creates sketch lines along the curve.&#160; It also sets the original curve to be construction geometry.</p>  <p>This mostly uses the curve geometry query functionality in the API and also demonstrates creating a sketch.&#160; Iâ€™ve tried to add comments to the code to help in understanding what itâ€™s doing.&#160; </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub CreateSegmentedCurve()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see that a curved sketch entity is selected.          <br /></strong></font>&#160;&#160;&#160; Dim entity As SketchEntity       <br />&#160;&#160;&#160; On Error Resume Next       <br />&#160;&#160;&#160; Set entity = ThisApplication.ActiveDocument.SelectSet.Item(1)       <br />&#160;&#160;&#160; If Err.Number &lt;&gt; 0 Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A curved sketch entity must be selected.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; On Error GoTo 0&#160; <br />      <br />&#160;&#160;&#160; If TypeOf entity Is SketchPoint Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchLine Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A curved sketch entity must be selected.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Ask for the number of segments to break the curve into.          <br /></strong></font>&#160;&#160;&#160; Dim prompt As String       <br />&#160;&#160;&#160; prompt = &quot;Enter the number of segments for the curve.&quot;       <br />&#160;&#160;&#160; Dim segmentCount As Integer       <br />&#160;&#160;&#160; segmentCount = Val(InputBox(prompt, &quot;Number of Segments&quot;, &quot;10&quot;))       <br />&#160;&#160;&#160; If segmentCount = 0 Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Invalid segment count.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the parent sketch.          <br /></strong></font>&#160;&#160;&#160; Dim sk As sketch       <br />&#160;&#160;&#160; Set sk = entity.Parent&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the evaluator from the associate geometry.          <br /></strong></font>&#160;&#160;&#160; Dim curveEval As Curve2dEvaluator       <br />&#160;&#160;&#160; Set curveEval = entity.Geometry.Evaluator       <br />&#160;&#160;&#160; Dim minU As Double       <br />&#160;&#160;&#160; Dim maxU As Double       <br />&#160;&#160;&#160; Call curveEval.GetParamExtents(minU, maxU)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine if the entity is open or closed (circle,          <br />&#160;&#160;&#160; ' ellipse, or closed spline)           <br /></strong></font>&#160;&#160;&#160; Dim curveIsClosed As Boolean       <br />&#160;&#160;&#160; curveIsClosed = False       <br />&#160;&#160;&#160; If TypeOf entity Is SketchCircle Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchEllipse Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchSpline Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchOffsetSpline Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If TypeOf entity Is SketchSpline Or _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TypeOf entity Is SketchOffsetSpline Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If entity.Closed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = True       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; curveIsClosed = True       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Dim tg As TransientGeometry       <br />&#160;&#160;&#160; Set tg = ThisApplication.TransientGeometry&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine if start point is at the min or max parameter.          <br /></strong></font>&#160;&#160;&#160; Dim startPoint As SketchPoint       <br />&#160;&#160;&#160; Dim endPoint As SketchPoint       <br />&#160;&#160;&#160; If Not curveIsClosed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim startCoord() As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim endCoord() As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call curveEval.GetEndPoints(startCoord, endCoord)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If entity.StartSketchPoint.Geometry.IsEqualTo( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(startCoord(0), startCoord(1))) Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set startPoint = entity.StartSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set endPoint = entity.EndSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set endPoint = entity.StartSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set startPoint = entity.EndSketchPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End If&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the curve length.          <br /></strong></font>&#160;&#160;&#160; Dim length As Double       <br />&#160;&#160;&#160; Call curveEval.GetLengthAtParam(minU, maxU, length)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Determine the length between segments.          <br /></strong></font>&#160;&#160;&#160; Dim offset As Double       <br />&#160;&#160;&#160; offset = length / segmentCount&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Start a transaction to wrap the sketch creation as a          <br />&#160;&#160;&#160; ' single undo operation.           <br /></strong></font>&#160;&#160;&#160; On Error GoTo ErrorFound       <br />&#160;&#160;&#160; Dim transMgr As TransactionManager       <br />&#160;&#160;&#160; Set transMgr = ThisApplication.TransactionManager       <br />&#160;&#160;&#160; Dim trans As Transaction       <br />&#160;&#160;&#160; Set trans = transMgr.StartTransaction( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ActiveDocument, &quot;Segment Curve&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Defer updates on the sketch while the sketch entities          <br />&#160;&#160;&#160; ' are being created.&#160; This will significantly improve           <br />&#160;&#160;&#160; ' performance.           <br /></strong></font>&#160;&#160;&#160; sk.DeferUpdates = True&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Calculate the points and create a sketch          <br />&#160;&#160;&#160; ' point at each position.           <br /></strong></font>&#160;&#160;&#160; Dim points() As SketchPoint       <br />&#160;&#160;&#160; ReDim points(segmentCount)       <br />&#160;&#160;&#160; Dim i As Integer       <br />&#160;&#160;&#160; Dim currentLength As Double       <br />&#160;&#160;&#160; currentLength = 0       <br />&#160;&#160;&#160; For i = 0 To segmentCount       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim currentParam As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call curveEval.GetParamAtLength(minU, currentLength, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentParam)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentLength = currentLength + offset&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim params(0) As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; params(0) = currentParam       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim coords() As Double       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call curveEval.GetPointAtParam(params, coords)&#160; <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If i = 0 Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Special case for first point.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not curveIsClosed Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(i) = startPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(i) = sk.SketchPoints.Add( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords(0), coords(1)), False)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set endPoint = points(i)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ElseIf i = segmentCount Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Special case for last point          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(i) = endPoint       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set points(i) = sk.SketchPoints.Add( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tg.CreatePoint2d(coords(0), coords(1)), False)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Next&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Connect the points with lines.          <br /></strong></font>&#160;&#160;&#160; For i = 0 To segmentCount - 1       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call sk.SketchLines.AddByTwoPoints(points(i), points(i + 1))       <br />&#160;&#160;&#160; Next&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Make the selected entity construction geometry.          <br /></strong></font>&#160;&#160;&#160; entity.Construction = True       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' There's a current problem that when setting the construction          <br />&#160;&#160;&#160; ' property, the display isn't updated to reflect this change           <br />&#160;&#160;&#160; ' until something causes the sketch to recompute.&#160; This performs           <br />&#160;&#160;&#160; ' a change on the sketch to kick a recompute.           <br /></strong></font>&#160;&#160;&#160; Dim originalPoint As Point2d       <br />&#160;&#160;&#160; Set originalPoint = points(0).Geometry       <br />&#160;&#160;&#160; Call points(0).MoveTo(tg.CreatePoint2d( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).Geometry.X + 0.001, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; points(0).Geometry.Y))       <br />&#160;&#160;&#160; Call points(0).MoveTo(originalPoint)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Turn off the defer to the sketch will recompute normally.          <br /></strong></font>&#160;&#160;&#160; sk.DeferUpdates = False&#160; <br />      <br />&#160;&#160;&#160; trans.End       <br />&#160;&#160;&#160; Exit Sub       <br />      <br />ErrorFound:       <br />&#160;&#160;&#160; sk.DeferUpdates = False&#160; <br />      <br />&#160;&#160;&#160; If Not trans Is Nothing Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Abort       <br />&#160;&#160;&#160; End If&#160; <br />      <br />&#160;&#160;&#160; MsgBox &quot;Unexpected error segmenting curve.&quot;       <br />End Sub</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Saving Files as an Image (bmp, jpg, png, tiff, gif)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: saving-files-as-an-image-bmp-jpg-png-tiff-gif
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/07/saving-files-as-an-image-bmp-jpg-png-tiff-gif.html 
DATE: 07/12/2010 09:59:17 PM
-----
BODY:
<p>I was recently asked if I had a macro that would create a jpg file for each part in a directory.&#160; The code below is what I came up with.&#160; It finds all of the files of a certain type within a specified directory and creates an image file for each one.&#160; </p>  <p>The primary function this macro uses to accomplish this is the SaveAsBitmap method.&#160; This method is on the View object, which represents a graphics window.&#160; The SaveAsBitmap method saves the contents of that window as an image.&#160; You can specify one of several different image types and you can also specify the size of the output image.&#160; The supported image types are bmp, jpg, png, tiff, and gif.&#160; The type to write out is inferred by the extension of the image file you specify.&#160; The sample below will create jpg files.&#160; Being able to specify the size of the output image is also powerful because then youâ€™re not limited by the size of the window and the resulting image is not just a scaled bitmap of the current window contents&#160; but is an image rendered specifically at the specified size.</p>  <p>Itâ€™s also very simple in that there isnâ€™t any user-interface.&#160; All inputs, the directory to process and the input and output file types, are hard-coded within the program.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub SaveImages()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Specify the size of the output image in pixels.&#160; If you          <br />&#160;&#160;&#160; ' use zero then it will be the actual size of the window.           <br /></strong></font>&#160;&#160;&#160; Dim pixelWidth As Integer       <br />&#160;&#160;&#160; Dim pixelHeight As Integer       <br />&#160;&#160;&#160; pixelWidth = 800       <br />&#160;&#160;&#160; pixelHeight = 800      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Specify the path where the files exist.&#160; The rest of the          <br />&#160;&#160;&#160; ' code expects this path name to end with a backslash.           <br /></strong></font>&#160;&#160;&#160; Dim dirName As String       <br />&#160;&#160;&#160; dirName = &quot;C:\Temp\&quot;       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Loop through the files in the specified directory.          <br />&#160;&#160;&#160; ' Depending on the file type you want to generate the           <br />&#160;&#160;&#160; ' images for you may need to change the file extension.           <br />&#160;&#160;&#160; ' In this case it will create images for all the part           <br />&#160;&#160;&#160; ' files in the specified directory.&#160; Editing &quot;*.ipt&quot; to           <br />&#160;&#160;&#160; ' &quot;*.iam&quot; will generate images for all assemblies.           <br /></strong></font>&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = Dir(dirName &amp; &quot;*.ipt&quot;)       <br />&#160;&#160;&#160; Do While filename &lt;&gt; &quot;&quot;       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Save the current silent operation state.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim silentState As Boolean       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; silentState = ThisApplication.SilentOperation       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Turn on silent operation.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.SilentOperation = True       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Open the document.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set doc = ThisApplication.Documents.Open(dirName &amp; filename)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Restore the state to its previous value.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.SilentOperation = silentState      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the currently active view, which will be for         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the document just opened.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim window As view       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set window = ThisApplication.ActiveView      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Create the filename for the output file.&#160; This uses          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the same name as the original file and replaces the          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' extension with .jpg           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim imageFilename As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; imageFilename = dirName &amp; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Left$(filename, InStr(filename, &quot;.&quot;)) &amp; &quot;jpg&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call window.SaveAsBitmap(imageFilename, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pixelWidth, pixelHeight)      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Close the current document.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call doc.Close(True)       <br />      <br /><font color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the next filename.        <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Dir       <br />&#160;&#160;&#160; Loop       <br />      <br />&#160;&#160;&#160; ThisApplication.StatusBarText = &quot;Finished processing.&quot;       <br />End Sub</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Max U
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 07/14/2010 09:45:29 AM
Brian, could all the same be done to get some type of raster with alpha channel?
-----
COMMENT:
AUTHOR: Peter
EMAIL: pbrown@redler.com
IP: 88.106.186.59
URL: 
DATE: 07/14/2010 07:14:36 PM
Another useful bit of code from the master.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: iProperty Name Table
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: iproperty-name-table
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/07/iproperty-name-table.html 
DATE: 07/07/2010 06:18:03 PM
-----
BODY:
<p>I thought I would share something that I use frequently and have found very useful.&#160; Itâ€™s a listing of Inventorâ€™s iProperties and the sets theyâ€™re grouped within.&#160; I keep a printout of this at my desk that I refer to frequently when Iâ€™m writing programs that use iProperties.&#160; I included a version of this table as part of an earlier <a href="http://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html">post covering the basics of iProperties</a>, but I find it useful to have a printed version handy that I can quickly refer to.</p>  <p>Hereâ€™s the <a href="http://modthemachine.typepad.com/files/iProperyNameTable.pdf">single page pdf file that has the iProperty name table</a>.&#160; Hopefully youâ€™ll find it as useful as I have.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Brown
EMAIL: pbrown@redler.com
IP: 89.206.162.123
URL: 
DATE: 07/08/2010 03:34:08 PM
That's very helpful, thank you.
-----
COMMENT:
AUTHOR: Brad Johnson
EMAIL: brjjohnson@dstoutput.com
IP: 165.79.13.192
URL: 
DATE: 08/26/2010 09:34:17 PM
That is going to be a very useful chart.
Thank you 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Plug-In of the Month &ndash; Feature Migrator for Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: plug-in-of-the-month-feature-manager
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/06/plug-in-of-the-month-feature-manager.html 
DATE: 06/26/2010 02:13:12 AM
-----
BODY:
<p>A new plug-in of the month has just been posted at Autodesk Labs.&#160; This one is called Feature Migrator for Inventor.&#160; What it does is transfer assembly features down into the parts they affect.</p>  <p>Philippe Leefsma, one of the engineers that supports members of the Autodesk Developer Network (ADN) wrote this one.&#160; Philippe has put a lot of thought and effort into this application.&#160; Hereâ€™s a shot of the browser thatâ€™s displayed when you run the application.&#160; It displays the assembly features that are valid for transfer.&#160; This picture shows several of the features selected and the â€œSend to Partsâ€ option selected.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134853f1743970c-pi"><img title="FeatureManager" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="513" alt="FeatureManager" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340134853f1758970c-pi" width="278" border="0" /></a> </p>  <p>The documentation that comes with the download describes the add-in and its features.&#160; You can download it from here: <a title="http://labs.autodesk.com/utilities/ADN_plugins/" href="http://labs.autodesk.com/utilities/ADN_plugins/">http://labs.autodesk.com/utilities/ADN_plugins/</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: QubeIt
EMAIL: 
IP: 70.118.82.171
URL: http://profile.typepad.com/qubeit
DATE: 07/01/2010 01:12:48 AM
Wow, I can see the effort put into this. Great job!!  Also, thank you for writing this in C# Philippe!!! :)
-----
COMMENT:
AUTHOR: raj
EMAIL: rajeshindi@metalform.com.au
IP: 122.108.24.189
URL: 
DATE: 07/16/2011 04:26:04 AM
great plug in.  Appreciated
-----
COMMENT:
AUTHOR: ekat
EMAIL: emilykcameron77@yahoo.com
IP: 98.225.50.201
URL: 
DATE: 11/10/2011 04:06:08 PM
I was unable to extract this. I received an error- 
You need to have the following volume to continue extraction:.V2012.X32.part02.rar


-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: How to Time an Operation and Optimizing Code
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: how-to-time-an-operation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/06/how-to-time-an-operation.html 
DATE: 06/22/2010 01:41:59 AM
-----
BODY:
<p>Iâ€™ve found it beneficial to time how long it takes portions of my programs to run and in particular when a program takes longer to run than I initially expected.&#160; Timing the different portions of a program tells you where the program is taking the most time and sometimes will help you find issues with your logic or how youâ€™re using the API so you can make improvements to the execution time of your program.&#160; Determining where your program spends time processing is referred to as <em>profiling</em>.&#160; Some development environments provide profiling utilities and there are also 3rd party profilers available.&#160; Thereâ€™s no profiling functionality built-in to VBA so youâ€™ll have to do something on your own.&#160; Hereâ€™s the process Iâ€™ve used for several years to profile my VBA code.</p>  <p>First, Iâ€™ve created a small timer class.&#160; Iâ€™ve found this easier to use and much more accurate than trying to use built-in VBA functions to get the current time.&#160; Hereâ€™s the code for my timer class.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Private Declare Function QueryPerformanceFrequency _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Lib &quot;kernel32&quot; (lpFrequency As Currency) As Long       <br />Private Declare Function QueryPerformanceCounter _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Lib &quot;kernel32&quot; (lpPerformanceCount As Currency) As Long       <br />      <br />Private ConversionFactor As Currency       <br />Private CurrentStartTime As Currency       <br />      <br />      <br />Public Sub Start()       <br />&#160;&#160;&#160; Dim iReturn As Long       <br />&#160;&#160;&#160; iReturn = QueryPerformanceCounter(CurrentStartTime)       <br />End Sub       <br />      <br />      <br />Private Sub Class_Initialize()       <br />&#160;&#160;&#160; Dim iReturn As Long       <br />&#160;&#160;&#160; iReturn = QueryPerformanceFrequency(ConversionFactor)       <br />End Sub       <br />      <br />      <br />Public Property Get CurrentTime() As Double       <br />&#160;&#160;&#160; Dim NewTime As Currency       <br />&#160;&#160;&#160; Dim iReturn As Long       <br />&#160;&#160;&#160; iReturn = QueryPerformanceCounter(NewTime)       <br />&#160;&#160;&#160; Dim TotalTime As Currency       <br />&#160;&#160;&#160; TotalTime = NewTime - CurrentStartTime       <br />&#160;&#160;&#160; CurrentTime = TotalTime / ConversionFactor       <br />End Property</p> </div>  <p>To add the code above to your VBA project, run the <strong>Class Module</strong> command from the <strong>Insert</strong> menu.&#160; This will create a new, empty class module.&#160; Copy and paste the code above into the new module.</p>  <p>Rename the class module to â€œclsTimerâ€&#160; Do this by selecting the class module in the Project Explorer tree and then editing the name in the Properties window, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834013484b6179a970c-pi"><img title="NameTimerClass" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="247" alt="NameTimerClass" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f18dd78d970b-pi" width="212" border="0" /></a> </p>  <p>Now you can use this class to time portions of your code.&#160; Hereâ€™s a simple example.&#160; This creates two instances of the timer class.&#160; One that will be used to time small portions of the program and another that will be used to time the overall execution.&#160; After creating a timer you call the Start method to begin timing.&#160; At any time you can use the timerâ€™s CurrentTime property to get the elapsed time.&#160; You can also call the Start method again to restart the timer.&#160; The value returned is the number of seconds that have elapsed since the timer started.&#160; I use the VBA Format function to control the number of decimal places displayed.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub TimerExample()&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create and start a timer for the total time.         <br /></strong></font>&#160;&#160;&#160; Dim timerAll As New clsTimer       <br />&#160;&#160;&#160; timerAll.Start      <br />      <br /></p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Create and start a timer for individual times.       <br /></strong></font>&#160;&#160;&#160; Dim timer As New clsTimer     <br />&#160;&#160;&#160; timer.Start    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Time creating an assembly document.&#160; <br /></strong></font>&#160;&#160;&#160; Dim doc As Document     <br />&#160;&#160;&#160; Set doc = ThisApplication.Documents.Add(kAssemblyDocumentObject)     <br />&#160;&#160;&#160; Debug.Print &quot;Assembly: &quot; &amp; Format(timer.CurrentTime, &quot;0.000000&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Restart the timer.       <br /></strong></font>&#160;&#160;&#160; timer.Start     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Time creating a drawing document.       <br /></strong></font>&#160;&#160;&#160; Set doc = ThisApplication.Documents.Add(kDrawingDocumentObject)     <br />&#160;&#160;&#160; Debug.Print &quot;Drawing: &quot; &amp; Format(timer.CurrentTime, &quot;0.000000&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Restart the timer.       <br /></strong></font>&#160;&#160;&#160; timer.Start    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Time creating a part document.       <br /></strong></font>&#160;&#160;&#160; Set doc = ThisApplication.Documents.Add(kPartDocumentObject)     <br />&#160;&#160;&#160; Debug.Print &quot;Part: &quot; &amp; Format(timer.CurrentTime, &quot;0.000000&quot;)    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Display the total time.&#160; <br /></strong></font>&#160;&#160;&#160; Debug.Print &quot;Total: &quot; &amp; Format(timerAll.CurrentTime, &quot;0.000000&quot;)     <br />End Sub</div>  <p>Hereâ€™s another example that puts this into practice to try and optimize a program.&#160; It gets all of the faces from the active part.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub GetFaces1()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the first body from the active part.&#160; <br /></strong></font>&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; Dim body As SurfaceBody       <br />&#160;&#160;&#160; Set body = partDoc.ComponentDefinition.SurfaceBodies.Item(1)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create a timer          <br /></strong></font>&#160;&#160;&#160; Dim timer As New clsTimer       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Start the timer.          <br /></strong></font>&#160;&#160;&#160; timer.Start       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through the faces using the Item property.          <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face       <br />&#160;&#160;&#160; Dim i As Integer&#160; <br />&#160;&#160;&#160; For i = 1 To body.Faces.Count       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oFace = body.Faces.Item(i)&#160; <br />&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Time for &quot; &amp; body.Faces.Count &amp; &quot; faces: &quot; &amp; _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(timer.CurrentTime, &quot;0.000000&quot;)       <br />End Sub</p> </div>  <p>This results in the following being printed to my Immediate window:</p>  <blockquote>   <p>Time for 1264 faces: 41.421942</p> </blockquote>  <p>It takes forty-one seconds to iterate over the faces in the body.&#160; Letâ€™s look at some things that can be done to improve the performance.&#160; </p>  <p>A common coding method, particularly in VB/VBA, is to string multiple calls together in a single line.&#160; This is done in the code above in a few places.&#160; The first is where it gets the SurfaceBody object.&#160; It does this by calling the ComponentDefinition property of the PartDocument object, and then calls the SurfaceBodies property on the PartComponentDefinition object thatâ€™s returned, and finally calls the Item property on the returned SurfaceBodies object.&#160; There are three API calls within that single line.&#160; Itâ€™s ok in this case since itâ€™s only executed once, but sometimes you can do excessive processing when these are within loops.</p>  <p>Another line where there are multiple calls being made is the one within the For loop where itâ€™s getting the Face.&#160; In this case, this line is being call 1264 times.&#160; Hereâ€™s a modified version where the SurfaceBodies object is obtained once, outside the loop and then used within the loop to get each face.&#160; The new and modifies lines are highlighted in red.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub GetFaces2()&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the first body from the active part.&#160; <br /></strong></font>&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; Dim body As SurfaceBody       <br />&#160;&#160;&#160; Set body = partDoc.ComponentDefinition.SurfaceBodies.Item(1)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create a timer          <br /></strong></font>&#160;&#160;&#160; Dim timer As New clsTimer       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Start the timer.          <br /></strong></font>&#160;&#160;&#160; timer.Start       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through the faces using the Item property.          <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face       <br />&#160;&#160;&#160; Dim i As Integer&#160;&#160; <br /><font color="#ff0000">&#160;&#160;&#160; Dim oFaces As Faces        <br />&#160;&#160;&#160; Set oFaces = body.Faces</font>       <br />&#160;&#160;&#160; For i = 1 To body.Faces.Count&#160; <br /><font color="#ff0000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oFace = oFaces.Item(i)&#160; <br /></font>&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Time for &quot; &amp; body.Faces.Count &amp; &quot; faces: &quot; &amp; _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(timer.CurrentTime, &quot;0.000000&quot;)       <br />End Sub</p> </div>  <p>This results in the following being printed to my Immediate window:</p>  <blockquote>   <p>Time for 1264 faces: 0.217899</p> </blockquote>  <p>We went from over 40 seconds down to less than one second.&#160; This is over 190 times faster than the previous code, and a huge improvement.&#160; Donâ€™t always expect improvements like this, but taking the time to do a little profiling can often result in some time improvements.</p>  <p>Thereâ€™s one more thing that can be done that might help with performance.&#160; Instead of using the For statement to go from 1 to Count we can use the For Each statement.&#160; This can result in better performance and also creates cleaner, easier to read code.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub GetFaces3()&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the first body from the active part.&#160; <br /></strong></font>&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />&#160;&#160;&#160; Dim body As SurfaceBody       <br />&#160;&#160;&#160; Set body = partDoc.ComponentDefinition.SurfaceBodies.Item(1)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create a timer          <br /></strong></font>&#160;&#160;&#160; Dim timer As New clsTimer       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Start the timer.          <br /></strong></font>&#160;&#160;&#160; timer.Start       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through the faces using the Item property.          <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face&#160; <br /><font color="#ff0000">&#160;&#160;&#160; For Each oFace in body.Faces        <br /></font>&#160;&#160;&#160; Next       <br />      <br />&#160;&#160;&#160; Debug.Print &quot;Time for &quot; &amp; body.Faces.Count &amp; &quot; faces: &quot; &amp; _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Format(timer.CurrentTime, &quot;0.000000&quot;)       <br />End Sub</p> </div>  <p>This results in the following being printed to my Immediate window:</p>  <blockquote>   <p>Time for 1264 faces: 0.060036</p> </blockquote>  <p>This is an improvement of about 3.5 times over the earlier time.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Update to Thumbnail Component
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: update-to-thumbnail-component
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/06/update-to-thumbnail-component.html 
DATE: 06/19/2010 12:16:11 AM
-----
BODY:
<p>In my <a href="http://modthemachine.typepad.com/my_weblog/2010/06/accessing-thumbnail-images.html">previous post</a> I described how to access thumbnail images in Inventor documents.&#160; At the bottom of that post is a link to an updated version of a component that provides access to thumbnails.&#160; A problem has been reported since I posted that code and has now been fixed.&#160; </p>  <p>Itâ€™s likely that most of you would have never noticed the problem, since it is a bit obscure.&#160; The issue was with how the component was registering itself.&#160; It was registering itself in the Current User portion of the registry which meant only the user that it was registered for would have access to the component.&#160; In the problem that was reported, they were running Win7 and the application that was using the component needed to run as an administrator.&#160; Running as an administrator looks at a different portion of the registry so the application couldnâ€™t find the thumbnail component and would fail.&#160; The fix changes the component so it is now registered for everyone.&#160; Please see the readme for details on how to register it.</p>  <p>I updated the previous post so the link at the bottom is to the new version of the component and you can also access <a href="http://modthemachine.typepad.com/ThumbnailView.zip">here</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: pete
EMAIL: peteh@marvin.com
IP: 69.89.205.214
URL: http://modthemachine.typepad.com/my_weblog/2010/06/update-to-thumbnail-component.html#tp
DATE: 06/23/2010 02:37:22 PM

Thank you Brian.  I have the application working now.
-----
COMMENT:
AUTHOR: Voctor
EMAIL: vrula@mail.ru
IP: 89.251.104.242
URL: 
DATE: 12/28/2010 07:40:54 AM
I am Update to Thumbnail Component, but this version not work correctly. Memory isn't released at the reference to given component(from my AddIns dll), thus occupied memory displayed in Inventore critically decreases (AIP 2010 - 32 bit).The previous version ThumbnailViewer.dll works correctly.
-----
COMMENT:
AUTHOR: Voctor
EMAIL: vrula@mail.ru
IP: 89.251.104.242
URL: 
DATE: 12/28/2010 07:49:40 AM
Please give if probably last version of the given component.
-----
COMMENT:
AUTHOR: Voctor
EMAIL: vrula@mail.ru
IP: 89.251.104.242
URL: 
DATE: 12/28/2010 07:51:05 AM
Forgive for bad English
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Accessing Thumbnail Images
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: accessing-thumbnail-images
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/06/accessing-thumbnail-images.html 
DATE: 06/10/2010 12:29:12 AM
-----
BODY:
<p>Iâ€™ve had a few recent posts that have talked briefly about using thumbnail images (<a href="http://modthemachine.typepad.com/my_weblog/2010/03/document-thumbnails-and-button-icons.html">Document Thumbnails and Button Icons</a>, <a href="http://modthemachine.typepad.com/my_weblog/2010/02/parts-list-with-thumbnail-image.html">Parts List with Thumbnail Image</a>, and <a href="http://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html">Accessing iProperties</a>).&#160; If you need to get a thumbnail image from an Inventor document there are several possibilities.&#160; I want to briefly cover those here.</p>  <p><strong><font size="3">Thumbnail as an iProperty        <br /></font></strong>The thumbnail is stored as an iProperty within an Inventor document.&#160; One way to access the thumbnail is as an iProperty.&#160; The following VBA code accesses the thumbnail as an iProperty and writes it as a bmp file to disk.&#160; (This code wonâ€™t work on a 64-bit Inventor because of the issues discussed in this <a href="http://modthemachine.typepad.com/my_weblog/2010/03/document-thumbnails-and-button-icons.html">post</a>.)</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub WriteThumbnail()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the currently active document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Summary Information property set.          <br /></strong></font>&#160;&#160;&#160; Dim summaryInfo As PropertySet       <br />&#160;&#160;&#160; Set summaryInfo = doc.PropertySets.Item( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor Summary Information&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the thumbnail property.&#160; When using VBA, this will          <br />&#160;&#160;&#160; ' only work with 32-bit Inventor.           <br /></strong></font>&#160;&#160;&#160; Dim thumbProp As Property       <br />&#160;&#160;&#160; Set thumbProp = summaryInfo.Item(&quot;Thumbnail&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the thumbnail image.          <br /></strong></font>&#160;&#160;&#160; Dim thumbnail As IPictureDisp       <br />&#160;&#160;&#160; Set thumbnail = thumbProp.Value       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check that an image was returned.&#160; It's possible for a          <br />&#160;&#160;&#160; ' file to not have a thumbnail.           <br /></strong></font>&#160;&#160;&#160; If Not thumbnail Is Nothing Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Write the thumbnail to disk.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call SavePicture(thumbnail, &quot;C:\Temp\Thumb.bmp&quot;)       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The active document doesn't have a thumbnail.&quot;       <br />&#160;&#160;&#160; End If       <br />End Sub</p> </div>  <p>Because Apprentice provides access to iProperties, you can use it instead of Inventor to access the thumbnail.&#160; Below is some VB.Net code that uses Apprentice to read a thumbnail from an Inventor document and display it within a picture box.</p>  <p>To use the code below, create a new â€œWindows Form Applicationâ€.&#160; On the form add a button (Button1) and a picture box (PictureBox1).&#160; Set the <strong>SizeMode</strong> property of the picture box to <strong>StretchImage</strong>.&#160; My dialog is shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f084ab40970b-pi"><img title="ThumbnailDialogBefore" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="293" alt="ThumbnailDialogBefore" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f084ab91970b-pi" width="243" border="0" /></a> </p>  <p>Youâ€™ll also need to add references to the following components using the .Net tab of the <strong>Add Reference</strong> dialog:</p>  <blockquote>   <p>Autodesk.Inventor.Interop      <br />Microsoft.VisualBasic.Compatibility       <br />stdole</p> </blockquote>  <p>Hereâ€™s my implementation for the form and the button click sub.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Imports Inventor      <br />Imports Microsoft.VisualBasic </p>    <p>Public Class Form1&#160; <br />&#160;&#160; Private Sub Button1_Click(ByVal sender As System.Object, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal e As System.EventArgs) Handles Button1.Click&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Create an instance of Apprentice.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim apprentice As New ApprenticeServerComponent       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Open a document.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim doc As ApprenticeServerDocument&#160; <br />&#160;&#160;&#160;&#160;&#160; doc = apprentice.Open(&quot;C:\Temp\Part1.ipt&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the Summary Information property set.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim summaryInfo As PropertySet&#160; <br />&#160;&#160;&#160;&#160;&#160; summaryInfo = doc.PropertySets.Item( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor Summary Information&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the thumbnail property.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim thumbProp As Inventor.Property&#160; <br />&#160;&#160;&#160;&#160;&#160; thumbProp = summaryInfo.Item(&quot;Thumbnail&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the thumbnail image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim thumbnail As stdole.IPictureDisp&#160; <br />&#160;&#160;&#160;&#160;&#160; thumbnail = thumbProp.Value&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Convert the IPictureDisp object to an Image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim img As Image = _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Compatibility.VB6.IPictureDispToImage(thumbnail)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Display the image in the picture box.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; PictureBox1.Image = img&#160; <br />&#160;&#160; End Sub       <br />End Class</p> </div>  <p>And hereâ€™s the result.    <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f084ab95970b-pi"><img title="ThumbnailDialogAfter" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="290" alt="ThumbnailDialogAfter" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f084aba0970b-pi" width="240" border="0" /></a>    <br /></p>  <p><font size="3"><strong>Document.Thumbnail Property        <br /></strong></font>Thereâ€™s another way you can get the thumbnail thatâ€™s simpler than going through the iProperty objects.&#160; Both the Document and ApprenticeServerDocument objects&#160; support the Thumbnail property.&#160; Hereâ€™s a modified version of the program above that uses the Thumbnail property.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Imports Inventor      <br />Imports Microsoft.VisualBasic </p>    <p>Public Class Form1&#160; <br />&#160;&#160; Private Sub Button1_Click(ByVal sender As System.Object, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal e As System.EventArgs) Handles Button1.Click&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Create an instance of Apprentice.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim apprentice As New ApprenticeServerComponent       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Open a document.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim doc As ApprenticeServerDocument&#160; <br />&#160;&#160;&#160;&#160;&#160; doc = apprentice.Open(&quot;C:\Temp\Part1.ipt&quot;)&#160;&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the thumbnail image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim thumbnail As stdole.IPictureDisp&#160; <br />&#160;&#160;&#160;&#160;&#160; thumbnail = doc.Thumbnail       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Convert the IPictureDisp object to an Image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim img As Image = _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Compatibility.VB6.IPictureDispToImage(thumbnail)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Display the image in the picture box.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; PictureBox1.Image = img&#160; <br />&#160;&#160; End Sub       <br />End Class</p> </div>  <p>A big difference between using the Document.Thumbnail property and accessing the thumbnail as an iProperty is that the Document.Thumbnail property is read-only while the iProperty is writable.&#160; This means you can push any image you would like into the iProperty to be used as the thumbnail for that document.&#160; However, this is only supported in Inventor and setting the value of the thumbnail iProperty will fail when using Apprentice.</p>  <p><font size="3"><strong>ThumbnailView Component        <br /></strong></font>Thereâ€™s one other way of accessing a thumbnail.&#160; Because iProperties are stored using some Microsoft standards, itâ€™s possible to use Windows functionality to directly access the thumbnail without using Inventor or Apprentice.&#160; It requires some more advanced programming to do it this way, so to make it easier thereâ€™s a&#160; component delivered as part of the Inventor SDK that you can use rather than write the code yourself.&#160; The source code is also provided to serve as a sample for those that want to include this functionality within their applications.</p>  <p>To use this component you need to first install the <strong>DeveloperTools.msi</strong> package.&#160; This is in the Inventor SDK directory (C:\Program Files\Autodesk\Inventor 2011\SDK on WinNT and C:\Users\Public\Documents\Autodesk\Inventor 2011\SDK on Vista or Win7).&#160; Installing this will create an SDK\DeveloperTools\Tools\ThumbnailView directory that contains the component, its source code, and some samples demonstrating its use.</p>  <p>To use the component, go into the Bin directory and run the Register.bat file to register the component.&#160; In your project where youâ€™ll be using the component youâ€™ll need to add a reference to it.&#160; I typically use the Browse option and browse to the InventorThumbnailView.dll file.&#160; Hereâ€™s a version of the previous program that uses this component to get the thumbnail.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Imports Microsoft.VisualBasic </p>    <p>Public Class Form1&#160; <br />&#160;&#160; Private Sub Button1_Click(ByVal sender As System.Object, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal e As System.EventArgs) Handles Button1.Click&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Create an instance of the ThumbnailProvider component.         <br />&#160;&#160;&#160;&#160;&#160; </strong></font>Dim thumbView As New InventorThumbnailViewLib.ThumbnailProvider </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Get the thumbnail image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim thumbnail As stdole.IPictureDisp&#160; <br />&#160;&#160;&#160;&#160;&#160; thumbnail = thumbView.GetThumbnail(&quot;C:\Temp\Part1.ipt&quot;)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Convert the IPictureDisp object to an Image.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; Dim img As Image = _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Compatibility.VB6.IPictureDispToImage(thumbnail)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160; ' Display the image in the picture box.&#160; <br /></strong></font>&#160;&#160;&#160;&#160;&#160; PictureBox1.Image = img&#160; <br />&#160;&#160; End Sub       <br />End Class</p> </div>  <p>One thing important to notice is that thereâ€™s no longer a reference to the Inventor component required since this isnâ€™t using the Inventor API.</p>  <p><font size="3"><strong>Inventor 2011 and ThumbnailView       <br /></strong></font><font size="2">The ThumbnailView component has been provided as a sample for several releases of Inventor.&#160; However, an issue was discovered soon after Inventor 2011 was shipped where it was found the component doesnâ€™t work with Inventor 2011 files.&#160; In Inventor 2011 a change was made to how the thumbnail image is stored within the iProperty value.&#160; Previously to Inventor 2011 it was stored as a bmp image.&#160; In Inventor 2011 itâ€™s now saved as a png image.&#160; All of the other functionality that deals with the thumbnail, iProperties and the Document.Thumbnail property, were updated to account for this change.&#160; However, the ThumbnailView utility slipped through the cracks and was not updated.&#160; You can <a href="http://modthemachine.typepad.com/ThumbnailView.zip">access an updated version of the component here</a> that works with Inventor 2011 and previous files.</font></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Davide
EMAIL: d.madoi@qsinformatica.it
IP: 62.173.187.170
URL: 
DATE: 06/10/2010 01:30:25 PM
Hi Brian,
I've just tried updated version of thumbnailView for Inv2011 files but nothing seems to be changed. Could you check please?
Thank you in advance
-----
COMMENT:
AUTHOR: Davide
EMAIL: d.madoi@qsinformatica.it
IP: 87.1.18.110
URL: 
DATE: 06/10/2010 02:05:37 PM
Hi,
sorry for my previous post. I installed directly InventorThumbnailView.dll found in Release directory. After, I've tried to rebuild project and I've installed resulting dll. This seems to be good. I hope this is helpful.
Cheers
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.7
URL: http://blogs.autodesk.com/modthemachine
DATE: 06/10/2010 03:38:48 PM
Thank you for this information.  I've rebuilt both the 32 and 64-bit versions of the dll and have repackaged the file.
-----
COMMENT:
AUTHOR: Max U
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 06/10/2010 03:42:25 PM
Brian,
Does introducing PNG somehow connected with introducing ability to discard Inventor-user-chosen background when using thumbnails in Vault or something like this?
-----
COMMENT:
AUTHOR: Max U
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 06/10/2010 03:53:41 PM
As I understand IPTs, IAMs, IDWs etc now use PNG as thumbnail. But I see DWF still uses JPG :(
-----
COMMENT:
AUTHOR: Pete
EMAIL: peteh@marvin.com
IP: 69.89.205.214
URL: http://modthemachine.typepad.com/my_weblog/2010/06/accessing-thumbnail-images.html#comments
DATE: 06/11/2010 09:16:07 PM
InventorThumbnailView.dll

I am having trouble running an application on Windows 7 x32 and x64 if it runs as administrator using the dll.

I get the error "Could not obtain thumbnail provider...." when running your sample "ViewThumgnail"

Works fine if it isn't run as admin. My application needs admin.

-----
COMMENT:
AUTHOR: Scott K
EMAIL: scott.koeppel@greenheck.com
IP: 64.211.107.4
URL: 
DATE: 08/02/2010 09:00:23 PM
I have tested the code that you posted for exporting the sheet metal flat pattern and putting edges on specific layers. Do you know if the same can be done with sketch lines of an unconsumed sketch in the flat pattern?
-----
COMMENT:
AUTHOR: David
EMAIL: shihjih@hotmail.com
IP: 111.252.125.216
URL: 
DATE: 09/10/2010 08:31:39 AM
Hi Brian,
First I want to thank you for making this post about Inventor 2011 thumbnail. It really helped out on my project.

As what I do is a PDM-like software and is not free to my clients, is it against Autodesk. or the author using InventorThumbnailView.dll in my code? 

I have not include this DLL into my code yet, but it seems to be the easiest way to solve the Inventor 2011 preview issue.

Also I had a lot of fun reading stuff here.  Good site!


-----
COMMENT:
AUTHOR: RenÃ© J
EMAIL: rj@sfk.com
IP: 62.199.212.151
URL: 
DATE: 02/14/2011 10:25:43 PM
Hi Brian
I have download the ThumbnailViewer.dll 
Reg. the ThumbnailViewer.dll as admin.
and it succeded.
On win 7 64 bit. the dll file, do not show
in the add reference list in my VB 2010 
it is seems that the dll file is not registered
is there something wrong with the ThumbnailViewer.dll for 64 bit ?
-----
COMMENT:
AUTHOR: Jim Duncan
EMAIL: jduncan@fabricimages.com
IP: 173.165.46.17
URL: 
DATE: 06/21/2011 06:32:55 PM
Brian,

I have been reading some of your posts and have a challange for you. 

I have a macro that works in 2009 but doesn't seem to work in 2012. The Macro takes a skeleton file and creates an Assembly file, all the derived parts for the assembly as their own ipt files, and then places all the parts into the assembly file. We are wanting to upgrade to 2012 and Windows 7 from 2009 and XP.

I have a test machine set up with just windows 7 and 2012 on it. I can't get the macro to work and don't have an ideas why.

Can you help? If you think you can I will send you the macros.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with Files and Directories
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: working-with-files-and-directories
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/working-with-files-and-directories.html 
DATE: 05/25/2010 10:36:59 PM
-----
BODY:
<p>Hereâ€™s some more functionality Iâ€™ve discovered in the .Net Framework that makes it hard for me when I have use VBA.&#160; In a <a href="http://modthemachine.typepad.com/my_weblog/2010/05/working-with-filenames.html">recent post</a> I talked about the functionality to manipulate full paths thatâ€™s supported by the Path class of the System.IO namespace.&#160; Two other very useful classes supported by System.IO are Directory and File.&#160; In VBA there are several functions that work with files but theyâ€™re harder to use and donâ€™t have the same capabilities as whatâ€™s supported by System.IO.</p>  <p>A workhorse function in VBA is the Dir function.&#160; You can use it to check for the existence of a file.&#160; This isnâ€™t much code but itâ€™s not particularly intuitive that you can use Dir for this.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim filename As String      <br />filename = &quot;C:\Temp\Part1.ipt&quot;       <br />If Dir(filename) = &quot;&quot; Then       <br />&#160;&#160;&#160; MsgBox &quot;Specified file does not exist.&quot;       <br />Else       <br />&#160;&#160;&#160; MsgBox &quot;File exists.&quot;       <br />End If</p> </div>  <p>Using VB.Net and System.IO I can accomplish the same thing with the code below.&#160; In lines of code thereâ€™s not any difference, but itâ€™s easier to understand what itâ€™s supposed to be doing.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim filename As String      <br />filename = &quot;C:\Temp\Part1.ipt&quot;       <br />If System.IO.File.Exists(filename) Then       <br />&#160;&#160;&#160; MsgBox(&quot;File exists.&quot;)       <br />Else       <br />&#160;&#160;&#160; MsgBox(&quot;Specified file does not exist.&quot;)       <br />End If       <br /></p> </div>  <p>The File class thatâ€™s used above supports much more than just the Exists function.&#160; You can delete, open for read, create, get and set various file attributes, etc.</p>  <p>In addition to the File class the System.IO class also supports the Directory class.&#160; Using this class you can check for the existence of a directory, create a directory, delete a directory and much more.&#160; Hereâ€™s a VBA example using the Dir function to iterate over all of the part files within a directory.&#160; This does the job but isnâ€™t particularly intuitive.&#160; If you also want to process the contents of subdirectories then it gets much more complicated because you canâ€™t have nested Dir calls.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessPartsVBA()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot;       <br />      <br /></p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory.&#160;&#160; <br /></strong></font>&#160;&#160;&#160; Dim filename As String     <br />&#160;&#160;&#160; filename = Dir(processPath &amp; &quot;*.ipt&quot;)     <br />&#160;&#160;&#160; Do While filename &lt;&gt; &quot;&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print &quot;Processing &quot; &amp; processPath &amp; filename     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Dir     <br />&#160;&#160;&#160; Loop     <br />End Sub</div>  <p>Hereâ€™s the same thing using the Directory class.&#160; Here a single call to the GetFiles function returns all of the files matching the search pattern as an array of strings.&#160; I think this is much easier to read, maintain, and is more flexible.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessPartsVBNet()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot; </p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory.       <br /></strong></font>&#160;&#160;&#160; Dim filenames() As String     <br />&#160;&#160;&#160; filenames = System.IO.Directory.GetFiles(processPath, &quot;*.ipt&quot;)     <br />&#160;&#160;&#160; For Each filename As String In filenames     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print(&quot;Processing &quot; &amp; filename)     <br />&#160;&#160;&#160; Next     <br />End Sub </div>  <p>Thereâ€™s also a version of the GetFiles function that gets the files in the current directory and all subdirectories.&#160; This is messy to do with VBA.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessAllPartsVBNet()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot; </p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory and subdirectories.       <br /></strong></font>&#160;&#160;&#160; Dim filenames() As String     <br />&#160;&#160;&#160; filenames = System.IO.Directory.GetFiles(processPath, _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;*.ipt&quot;, SearchOption.AllDirectories )     <br />&#160;&#160;&#160; For Each filename As String In filenames     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print(&quot;Processing &quot; &amp; filename)     <br />&#160;&#160;&#160; Next     <br />End Sub</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Pete
EMAIL: peteh@marvin.com
IP: 69.89.205.214
URL: http://modthemachine.typepad.com/my_weblog/2010/05/working-with-files-and-directories.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+modthemachine+%28Mod+the+Machine%29
DATE: 05/26/2010 01:40:21 PM
GetFiles 

The third parameter for GetFiles lets you specify top level or all directories

System.IO.Directory.GetFiles("myPath", "myPattern", SearchOption.AllDirectories)

or

My.Computer.FileSystem.GetFiles("myPath", FileIO.SearchOption.SearchAllSubDirectories, "myPattern")




-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.5
URL: http://blogs.autodesk.com/modthemachine
DATE: 05/26/2010 05:27:16 PM
Thanks for this feedback.  I expected this functionality to be built-in to the framework, but missed this when I was looking for it.  I've updated the post to reflect this.
-----
COMMENT:
AUTHOR: Alex Fielder
EMAIL: 
IP: 62.22.46.197
URL: http://profile.typepad.com/6p0120a6442f9f970c
DATE: 06/25/2010 02:48:32 PM
Hi Brian,

I was wondering if you can tell me whether it's possible to (on creating a new file from a .idw template) prevent display of/replace the dialogue that appears to fill in the prompted text entries. 

I've tried capturing the different events that occur whilst opening a new file using the Event Watcher provided in the SDK but to no avail.

Thanks,

Alex.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Virtual Training Videos
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: inventor-api-virtual-training-videos
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/inventor-api-virtual-training-videos.html 
DATE: 05/12/2010 07:49:47 PM
-----
BODY:
<p>We recently finished presenting the first set of API virtual training sessions.&#160; It seems they were a success since those attending want us to continue with the rest of the material.&#160; The sessions were presented by myself and members of the Autodesk DevTech team.&#160; Theyâ€™re the guys that support the members of the <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=723353">Autodesk Developer Network (ADN)</a>.&#160; If you want to get serious about developing with Inventor, or any Autodesk product, itâ€™s worth investigating if a membership makes sense for you.&#160; </p>  <p>Here are links to the material from the classes presented so far.&#160; </p>  <table cellspacing="0" cellpadding="0" width="308" border="0"><tbody>     <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module1_Basic_concepts_04March10.zip">Module 01 â€“ Basic concepts</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module2_Common_Document_Functionality_11March10.zip">Module 02 â€“ Common Document Functionality</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module3_Part_Document_Essentials_18March10.zip">Module 03 â€“ Part Documents</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module4_B-Rep_25March10.zip">Module 04 â€“ BREP</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module5_SheetMetal_01April10.zip">Module 05 â€“ Sheet Metal</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module6_Assembly_Documents_08April10.zip">Module 06 â€“ Assembly Documents</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module7_Drawing_Documents_15April10.zip">Module 07 â€“ Drawing Documents</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module8_AddIns_22April10.zip">Module 08 â€“ .Net Add-Ins</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module9_User_Interface_29April10.zip">Module 09 â€“ User Interface</a></p>       </td>     </tr>      <tr>       <td valign="bottom" width="306">         <p><a href="http://download.autodesk.com/media/adn/Autodesk_Inventor_API_Module10_Events_06May10.zip">Module 10 â€“ Events</a></p>       </td>     </tr>   </tbody></table>  <p>If youâ€™re interested in this series continuing contact <a href="mailto:gary.wassell@autodesk.com?subject=Inventor API Virtual Training">Gary Wassell</a> (DevTech manager) and let him know.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Nishith
EMAIL: nrjbv@yahoo.com
IP: 202.79.203.43
URL: 
DATE: 05/14/2010 05:26:36 AM
Hi,I cant download API virtual training videos...When i click on "file download",it is not downloading.
-----
COMMENT:
AUTHOR: Alex Fielder
EMAIL: 
IP: 62.22.46.197
URL: http://profile.typepad.com/6p0120a6442f9f970c
DATE: 05/17/2010 04:01:59 PM
These will be really handy, thanks. :)
-----
COMMENT:
AUTHOR: Lars S
EMAIL: ls@cadcon.dk
IP: 93.166.154.122
URL: 
DATE: 07/13/2010 09:43:23 PM
Hi great tutorials :-)
In "Module 03 â€“ Part Documents", there is no desktop video, only audio during the desktop sessions. Do the other modules also lack desktop video content?

BR Lars
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.7
URL: http://blogs.autodesk.com/modthemachine
DATE: 07/13/2010 09:52:34 PM
I'm able to see the video using the download from the link.  I downloaded and upacked the zip file and then ran ReplayMeeting.htm which is in the top-level directory.  The video and audio replayed as expected.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: API Wishlist Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: api-wishlist-survey
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/api-wishlist-survey.html 
DATE: 05/10/2010 10:55:24 PM
-----
BODY:
<p>Itâ€™s time again for the latest API wishlist survey.&#0160; This survey provides an opportunity for us to get some information about whoâ€™s using Inventorâ€™s API and what issues youâ€™re having.&#0160; This information is very important in helping us to determine what to spend resources on for the upcoming releases.</p>
<p>Please take the time to think about any issues youâ€™re having with the API; what functionality that you need is missing or what tools or documentation would make your life much easier.&#0160; This years survey is more open than it has been in the past to allow you to describe your specific issues rather than feel limited to choosing from a predefined list.</p>
<p>You can access the survey here: <a href="http://www.zoomerang.com/Survey/WEB22ALQSBG7BT">Autodesk InventorÂ® Survey</a>.&#0160;</p>
<p>The survey will remain open until <strong>May 30th, 2010</strong>.&#0160; Thanks in advance for your input.</p>
<p>If you use other Autodesk products and their APIâ€™s, there are also API surveys for them.&#0160; You can find more info about all the surveys at <a href="http://through-the-interface.typepad.com/through_the_interface/2010/05/api-wishlist-surveys-for-autodesk-products.html#tp">Kean Walmsleyâ€™s <em>Through the Interface</em> blog</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk University Class Proposals (Last Call)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-university-class-proposals-last-call
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/autodesk-university-class-proposals-last-call.html 
DATE: 05/07/2010 05:02:44 PM
-----
BODY:
<p>You have one more week to submit your proposals for this years Autodesk University.&#0160; Theyâ€™re due May 14th.&#0160; Iâ€™ve been dragging my feet and just submitted mine this morning.&#0160; More information is available at the <a href="http://www.autodeskevents.com/au2010/?event=speaker.call">Call for Proposals site</a>.&#0160; Hopefully Iâ€™ll see you in Las Vegas this November, either as a speaker or an attendee.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Using VBA Sample Code (for the Non-Programmer)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: using-vba-sample-code-for-the-non-programmer
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/using-vba-sample-code-for-the-non-programmer.html 
DATE: 05/06/2010 09:15:44 PM
-----
BODY:
<p>You donâ€™t know anything about VBA but youâ€™ve found some interesting VBA code somewhere on the web, in a newsgroup, or maybe even here.&#160; So now what do you do with that code to be able to use it in Inventor?&#160; Here are the cookbook steps:</p>  <ol>   <li>From within Inventor, press Alt-F11 or run the <strong>VBA Editor</strong> command from the Tools tab of the ribbon.&#160; This will open the VBA development environment, as seen below.       <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17c6970c-pi"><img title="VBAEditor" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="330" alt="VBAEditor" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17d3970c-pi" width="450" border="0" /></a> </p>   </li>    <li>The <strong>Project Explorer</strong> is the window containing the tree at the upper-left in the picture.&#160; <ul>       <li>Expand the node labeled â€œApplicationProjectâ€.&#160; </li>        <li>Expand the node labeled â€œModulesâ€ </li>        <li>Double-click on the node labeled â€œModule1â€          <br />An editor window will pop-up, similar to the picture below. (In the picture below I have one document open so there are two top-level nodes in the project explorer.&#160; One node is for the application project and the other node is for the document.&#160; Make sure you use the application project.)           <br /></li>     </ul>     <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17de970c-pi"><img title="VBAEditorModule1" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="330" alt="VBAEditorModule1" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17ec970c-pi" width="450" border="0" /></a>       <p></p>      <p></p>   </li>    <li>Go to wherever the original VBA code is (browser, new reader, email, etc.) and copy it to the clipboard.      <br /></li>    <li>Click within the VBA code window and paste the code.&#160; You should see something similar to the picture below.      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed5953b2970b-pi"><img title="VBAEditorCode" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="270" alt="VBAEditorCode" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d1838970c-pi" width="450" border="0" /></a> </p>   </li>    <li>Scan through the code to see if there are any problems.&#160; Do this by scrolling down through the pasted code looking for any red lines.&#160; If you donâ€™t see any problems go to step 6, otherwise continue with this step.      <p>The most common issue when pasting code is that lines that should be a single line may end up wrapping onto two lines.&#160; VBA expects a statement to be on a single line.&#160; The example below illustrates the problem where what should be a single line has been broken and wraps onto the next line. </p>      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed59543d970b-pi"><img title="VBABadCodeSample" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="174" alt="VBABadCodeSample" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed5954a7970b-pi" width="450" border="0" /></a> </p>      <p></p>      <p>Fix it by editing it so it is on a single line.</p>      <p>Thereâ€™s also an exception to the statement I made above about the requirement of a statement only being a single line.&#160; Itâ€™s possible to break a statement into multiple lines by adding a â€œ _â€ (space and underscore) at the end of a line.&#160; This is a line continuation character and indicates that the statement continues on the next line.&#160; Thatâ€™s shown in the top statement in the previous picture.&#160; You may need to understand that to better understand why a line is shown in red.       <br />        <br />If you see other problems, it beyond the scope of this post to diagnose those.&#160; It would be best to go back to the author or to ask someone that has some familiarity with the API.</p>   </li>    <li>Close the VBA window.      <br /></li>    <li>Run the program by pressing Alt-F8 or running the <strong>Macros</strong> command from the Tools tab.&#160; This will display the Macros dialog, as shown below.       <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d18fc970c-pi"><img title="MacrosEmptyDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="262" alt="MacrosEmptyDialog" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed595521970b-pi" width="354" border="0" /></a> </p>   </li>    <li>In the â€œMacros inâ€ drop-down list select â€œApplication Projectâ€ and choose the macro you want to run from the list, as shown below.      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d193a970c-pi"><img title="MacrosDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="262" alt="MacrosDialog" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed595530970b-pi" width="354" border="0" /></a> </p>   </li>    <li>Click the â€œRunâ€ button. </li> </ol>  <p></p>  <p>For some other ways to execute a macro see the post <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">Creating Buttons for VBA Macros</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: marcos
EMAIL: madiva45@gmail.com
IP: 190.166.151.198
URL: 
DATE: 05/06/2010 11:01:45 PM
Iam a old  mechanical engineer who need to learn more about VBA this is good start for me keep doing it 
Thanks 
Marcos Diaz
Dominican Republic
-----
COMMENT:
AUTHOR: Romil
EMAIL: romiloptimist12@gmail.com
IP: 59.95.217.101
URL: 
DATE: 09/26/2010 09:45:51 AM
Thanks.
It's really good..
-----
COMMENT:
AUTHOR: Eloisio Henrique
EMAIL: eloisio.silva@liebherr.com
IP: 193.27.220.254
URL: http://www.liebherr.com
DATE: 09/01/2011 03:54:25 PM
I have used the code bellow ( Autolisp code ) into AutoCad 2004 to make baloons.
Now we migrated for Autodesk Inventor 2011 but we get the following error:

** Esse comando nÃ£o pode ser chamado de modo transparente **
; erro: FunÃ§Ã£o cancelada


Does anybody know if the new version of the Autocad ( Inventor 2011 ) doesnÂ´t work correctly with Autolisp routines? Or could somebody give qa help to solve this error?


Variaveis: 
blndia  balao diameter, GLOBAL 
blnnum  balao number, GLOBAL 
cen     Center of balao 
ep      Endpoint of arrow 
oom     Old osnap mode 
sp      Start point of arrow 
temp    Temp. value for blndia and blnnum input 
ts      Name of current text style 
tshei   Text style height                              |; 

;10====PROGRAM SETUP 

(defun c:balao (/ cen ep oom sp temp ts tshei) 
(setq oom (getvar "osmode")) 
(graphscr) 

;20====GET SIZE, START POINT, CENTER, & NUMBER 

(if (null blndia) 
  (if (= 0 (getvar "dimscale")) 
    (setq blndia (/ (getvar "dimtxt") 0.28)) 
    (setq blndia (/ (* (getvar "dimtxt") (getvar "dimscale")) 0.28)) 
  ) 
) 
(initget 6) 
(setq temp (getreal (strcat "\nDiametro do BalÃ£o : "))) 
(if temp (setq blndia temp)) 

(setvar "osmode" 512) 
(initget 1) 
(setq sp (getpoint "\nIndique a cota: ")) 
(setvar "osmode" 0) 

(initget 1) 
(setq cen (getpoint sp "\nLocal do balao: ")) 

(if (null blnnum) (setq blnnum 0)) 
(setq blnnum (1+ blnnum)) 
(initget 6) 
(setq temp (getint (strcat "\nNÃºmero do BalÃ£o : "))) 
(if temp (setq blnnum temp)) 

;30====CALCULATE END POINT OF ARROW, GET TEXT STYLE HEIGHT, DRAW balao 

(setq ep (polar cen (angle cen sp) (/ blndia 2))) 

(setq ts (getvar "textstyle")) 
(setq tshei (cdr (assoc 40 (tblsearch "style" ts)))) 
(if (> tshei 0) (princ "\nEstilo do texto tem altura fixa; pode nÃ£o caber no balÃ£o.")) 

(setvar "cmdecho" 0) 

  (command ".dim" "LEADER" sp ep) (command)
  
(command ".circle" cen "D" blndia) 

(if (> tshei 0) 
  (command "_.text" "M" cen 0 blnnum) 
  (command ".text" "M" cen (* 0.28 blndia) 0 blnnum) 
) 

;40====RESET 

(setvar "cmdecho" 1) 
(setvar "osmode" oom) 
(princ) 
) 

-----
COMMENT:
AUTHOR: Lionel
EMAIL: lcoronelli@convexpert.com
IP: 69.159.239.55
URL: 
DATE: 10/24/2011 04:18:26 PM
Hi, I'm new in development of macro for inventor but the code used in your screen seem to be very interesting for me (Flattern assembly) It's exactly what I wanna do to be more iefficient :) 
Is it possible to get it ? I'm also looking for a code to save all flat patterns of sheemetal parts in a assembly which contains standard parts and sheetmetal parts, any suggestion to modify the code ? MAny thanks for your help.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with Filenames
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: working-with-filenames
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/05/working-with-filenames.html 
DATE: 05/04/2010 05:44:21 PM
-----
BODY:
<p>Itâ€™s common to need to manipulate filenames within a program.&#160; When using VBA thereâ€™s very little built-in functionality to help with this.&#160; When using VB.Net I had assumed I needed to do the same thing there that I had been doing in VBA.&#160; It wasnâ€™t until fairly recently that I discovered a set of utilities in the .Net Framework that makes working with filenames much easier. </p>  <p>The .Net Framework is one of the huge advantages of doing development with any of the .Net languages.&#160; Especially compared to VBA which has very little built-in functionality.&#160; As I find things in the .Net Framework I find useful Iâ€™ll add blog posts in case some of you are like me and are still discovering its capabilities.</p>  <p>For those of you using VBA, here are some functions that I wrote to work with filenames.&#160; Using these I can extract the various bits of a filename and piece it back together to get the new filename I need.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Return the path of the input filename.          <br /></strong></font>Public Function FilePath(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the path by getting everything up to and          <br />&#160;&#160;&#160; ' including the last backslash &quot;\&quot;.           <br /></strong></font>&#160;&#160;&#160; FilePath = Left$(fullFilename, InStrRev(fullFilename, &quot;\&quot;) - 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the name of the file, without the path.          <br /></strong></font>Public Function Filename(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everything to          <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Filename = Right$(fullFilename, Len(fullFilename) â€“ _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the base name of the input filename, without          <br />' the path or the extension.           <br /></strong></font>Public Function BaseFilename(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everttgubg to          <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Dim temp As String       <br />&#160;&#160;&#160; temp = Right$(fullFilename, Len(fullFilename) â€“ _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the base filename by getting everything to          <br />&#160;&#160;&#160; ' the left of the last period &quot;.&quot;.           <br /></strong></font>&#160;&#160;&#160; BaseFilename = Left$(temp, InStrRev(temp, &quot;.&quot;) - 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the extension of the input filename.          <br /></strong></font>Public Function FileExtension(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everthing to&#160; <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Dim temp As String       <br />&#160;&#160;&#160; temp = Right$(fullFilename, Len(fullFilename) â€“ _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the base filename by getting everything to          <br />&#160;&#160;&#160; ' the right of the last period &quot;.&quot;.           <br /></strong></font>&#160;&#160;&#160; FileExtension = Right$(temp, Len(temp) - InStrRev(temp, &quot;.&quot;) + 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Test the filename functions.</strong></font>       <br />Public Sub TestFileFunctionsVBA()       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = &quot;C:\Samples\Models\Parts\OilPan\OilPan.ipt&quot;       <br />&#160;&#160;&#160; Debug.Print FilePath(fullFilename)       <br />&#160;&#160;&#160; Debug.Print Filename(fullFilename)       <br />&#160;&#160;&#160; Debug.Print BaseFilename(fullFilename)       <br />&#160;&#160;&#160; Debug.Print FileExtension(fullFilename)       <br />End Sub</p> </div>  <p>Below are the results as seen in the Immediate window.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">C:\Samples\Models\Parts\OilPan    <br />OilPan.ipt     <br />OilPan     <br />.ipt     <br /></div>  <p>Using VB.Net this is all much easier.&#160; The .Net Framework supports the IO class which has a lot of file related functionality.&#160; For working with file paths the IO class provides access to the Path class.&#160; Below is a VB.Net function that does the same thing as the VBA code above but it uses .Net Framework functions instead of custom functions.&#160; Youâ€™ll need to use the Imports statement for System.IO or specify the full namespace path as demonstrated in the GetDirectoryName call below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Imports System.IO      <br />      <br /><font color="#0000ff"><strong>' Test the .Net Framework Path functions.         <br /></strong></font>Public Sub TestFileFunctionsVBNet()       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = &quot;C:\Samples\Models\Parts\OilPan\OilPan.ipt&quot;       <br />&#160;&#160;&#160; Debug.Print(System.IO.Path.GetDirectoryName(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetFileName(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetFileNameWithoutExtension(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetExtension(fullFilename))       <br />End Sub </p> </div>  <p>As you can see the results are identical to the VBA sample without having to write the custom functions.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>C:\Samples\Models\Parts\OilPan      <br />OilPan.ipt       <br />OilPan       <br />.ipt</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating Custom Property Sets and iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-custom-property-sets-and-iproperties
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/04/creating-custom-property-sets-and-iproperties.html 
DATE: 04/28/2010 12:21:50 AM
-----
BODY:
<p>In all previous iProperty related posts Iâ€™ve only talked about working with the four public property sets; Design Tracking, Summary Info, Document Summary Info, and User Defined.&#160; The first three of these contain a fixed number of properties while the user defined allows you to add and delete your own properties.&#160; This mirrors the iProperty functionality thatâ€™s available through Inventorâ€™s user-interface.</p>  <p>Using the API itâ€™s possible to create new property sets in addition to these standard four.&#160; A property set created using the API is not visible through the user-interface.&#160; For example, it does not automatically create a new tab in the iProperty dialog.&#160; It is only accessible through the API.&#160; The code below creates a new property set named â€œMyStuffâ€ and a property named â€œFavorite Fruitâ€.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub CreatePropertySet()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument      <br />      <br />&#160;<font color="#0000ff"><strong>&#160;&#160; ' Create a new property set.          <br /></strong></font>&#160;&#160;&#160; Dim customSet As PropertySet       <br />&#160;&#160;&#160; Set customSet = doc.PropertySets.Add(&quot;My Stuff&quot;)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add a property.          <br /></strong></font>&#160;&#160;&#160; Call customSet.Add(&quot;Banana&quot;, &quot;Favorite Fruit&quot;)       <br />End Sub</p> </div>  <p>Hereâ€™s some sample code that accesses and reads the value of the property created above.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the custom property set.          <br /></strong></font>&#160;&#160;&#160; Dim customSet As PropertySet       <br />&#160;&#160;&#160; Set customSet = doc.PropertySets.Item(&quot;My Stuff&quot;)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the value of the &quot;Favorite Fruit&quot; property.          <br /></strong></font>&#160;&#160;&#160; Dim fruit As String       <br />&#160;&#160;&#160; fruit = customSet.Item(&quot;Favorite Fruit&quot;).value       <br />&#160;&#160;&#160; MsgBox &quot;The favorite fruit is: &quot; &amp; fruit       <br />End Sub</p> </div>  <p>Hopefully you can see that working with these custom property sets is not any different than working with the standard property sets.&#160; Itâ€™s likely that you wonâ€™t ever&#160; need for this capability but sometimes it can come in handy.&#160; The primary use is when you need to store additional data with a file.&#160; iProperties especially make sense when you want to be able to access this information from Apprentice.&#160; An example of where Inventor uses this functionality is Content Center.&#160; Content Center adds an new property set to the parts it creates and uses the property set to store information about the part.</p>  <p>A useful tool when working with iProperties is a sample program thatâ€™s delivered with the Inventor SDK.&#160; Assuming youâ€™ve installed the developer tools using the DeveloperTools.msi in the SDK directory, youâ€™ll find the following directory:</p>  <p><font face="Arial Narrow">SDK\DeveloperTools\Samples\VB\Standalone Applications\ApprenticeServer\Properties</font></p>  <p>Itâ€™s an old VB6 sample, but you can use the EXE without having VB6.&#160; When you run the EXE, the dialog below is displayed.&#160; You use the button at the top to browse to any Inventor file.&#160; The property sets and properties are then displayed in the dialog and you can double-click on most properties to edit them.&#160; I use tool anytime I want to know about all of the iProperties in a document.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed00d537970b-pi"><img title="PropertyViewer" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="328" alt="PropertyViewer" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed00d53e970b-pi" width="454" border="0" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: iProperties and Dates
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: iproperties-and-dates
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/04/iproperties-and-dates.html 
DATE: 04/15/2010 04:45:11 PM
-----
BODY:
<p><strong>&#160; <br /></strong>The <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties.html">previous post on working with custom iProperties</a> shows how to create iProperties of various types, including dates.&#160; However, dates have one unique behavior, as shown below.&#160; There is a check box next to each date property, (circled in the picture below), that the user can check or uncheck to indicate if they want to set a date or not.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe50401970c-pi"><img title="DateiProperty" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="288" alt="DateiProperty" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecb51bd8970b-pi" width="404" border="0" /></a> </p>  <p>A date iProperty will always have a value, but there is one date that is considered the zero date.&#160; If you set the iProperty value to this date it will have the side-effect of removing the check from the box.&#160; The date is Jan. 1, 1601.&#160; The code below demonstrates creating two new custom iProperties.&#160; One will be set to the zero date and the other will be set to the current date.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub DateProperties()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the custom property set.          <br /></strong></font>&#160;&#160;&#160; Dim customPropSet As PropertySet       <br />&#160;&#160;&#160; Set customPropSet = partDoc.PropertySets.Item( _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor User Defined Properties&quot;) </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create the properties.          <br /></strong></font>&#160;&#160;&#160; Dim dateValue As Date       <br />&#160;&#160;&#160; dateValue = #1/1/1601#       <br />&#160;&#160;&#160; Dim sample1 As Property       <br />&#160;&#160;&#160; Set sample1 = customPropSet.Add(dateValue, &quot;Zero Date&quot;)       <br />      <br />&#160;&#160;&#160; dateValue = Now       <br />&#160;&#160;&#160; Dim sample2 As Property       <br />&#160;&#160;&#160; Set sample2 = customPropSet.Add(dateValue, &quot;Now Date&quot;)       <br />End Sub</p> </div>  <p>Hereâ€™s the result after running the program.&#160; Notice that the check box for the zero date property is unchecked.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe50433970c-pi"><img title="ZeroDate" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="277" alt="ZeroDate" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe5044e970c-pi" width="404" border="0" /></a> </p>  <p>This is also important to understand if you ever need to read the value of a date property.&#160; In the example above, the date for the Zero Date iProperty will be Jan. 1, 1601, but you should handle this date as a special case and treat it as though the date hasnâ€™t been set.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: iProperty Expressions
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: iproperty-expressions
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/04/iproperty-expressions.html 
DATE: 04/14/2010 08:19:08 PM
-----
BODY:
<p>In the iProperties dialog, Inventor allows you to create expressions for the values of iProperties.&#160; Using an expression you can combine the values of other iProperties into a single iProperty value.&#160; (By using the functionality described in <a href="http://modthemachine.typepad.com/my_weblog/2010/04/parameters-as-iproperties.html">a previous post</a> to create an iProperty for a parameter, you can also use parameter values in an expression.)&#160; To create an expression just enter an â€œ=â€ sign as the first character of the iProperty value.&#160; Inventor will now treat this as an expression.&#160; An expression can consist of any text and can reference any existing iProperties by specifying their names in brackets, as shown below.&#160; The expression in this example uses the iProperty named â€œPart Numberâ€ and two custom iProperties named â€œLengthâ€ and â€œHeightâ€ that were created by exporting parameters.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecb03915970b-pi"><img title="iPropertyExpression" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="231" alt="iPropertyExpression" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe0087d970c-pi" width="450" border="0" /></a> </p>  <p>Once youâ€™ve finished entering the expression and press return, the expression is evaluated and the resulting value is displayed, as shown below.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe008bc970c-pi"><img title="iPropertyExpressionResult" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="56" alt="iPropertyExpressionResult" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecb039a9970b-pi" width="450" border="0" /></a></p>  <p>The <img title="fx" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="16" alt="fx" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecb039c8970b-pi" width="15" border="0" /> symbol to the right of the field indicates that the property is defined using an expression.&#160; To edit the expression, rather than the value, right-click in the iProperty field and select the Edit Expression command from the context menu, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe00913970c-pi"><img title="EditExpression" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="88" alt="EditExpression" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe00929970c-pi" width="450" border="0" /></a></p>  <p>To use expressions through the API you use the Expression property of the Property object.&#160; This is demonstrated below.&#160; The Expression property is the equivalent of editing the expression in the iProperties dialog.&#160; When setting the value of the Expression property you need to follow the same rules as when creating an expression in the iProperties dialog.&#160; The Value property of the Property object will always return the evaluated result.&#160; Setting the value through the Value property will remove the expression associated with the property or you can set the value of the expression to an empty string (â€œâ€).</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub TestExpression()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Design Tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim designTrackPropSet As PropertySet       <br />&#160;&#160;&#160; Set designTrackPropSet = partDoc.PropertySets.Item( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Description property.          <br /></strong></font>&#160;&#160;&#160; Dim descProp As Property       <br />&#160;&#160;&#160; Set descProp = designTrackPropSet.Item(&quot;Description&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add an expression to the property.          <br /></strong></font>&#160;&#160;&#160; descProp.Expression = _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;=&lt;Part Number&gt; size is &lt;Length&gt; x &lt;Height&gt;&quot;       <br />End Sub</p> </div>  <p>The program below removes the expression from the property but maintains the propertyâ€™s current value.&#160; It does this by setting the value of the property to its current value.&#160; This would at first seem like it wouldnâ€™t do anything, but in the case where the property is defined using an expression, setting the value of the property removes the expression.&#160; Itâ€™s just that in this case the value weâ€™re setting it to happens to be the current displayed value.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub TestExpression()    <br />&#160;&#160;&#160; Dim partDoc As PartDocument     <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Design Tracking property set.        <br /></strong></font>&#160;&#160;&#160; Dim designTrackPropSet As PropertySet     <br />&#160;&#160;&#160; Set designTrackPropSet = partDoc.PropertySets.Item( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Design Tracking Properties&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Description property.        <br /></strong></font>&#160;&#160;&#160; Dim descProp As Property     <br />&#160;&#160;&#160; Set descProp = designTrackPropSet.Item(&quot;Description&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the value of the property to itâ€™s current value.       <br />&#160;&#160;&#160; ' This has the side-effect of removing an associated expression.</strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; descProp.Value = descProp.Value   <br />End Sub</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Manuela
EMAIL: mpinho@cadtech.pt
IP: 213.58.198.21
URL: 
DATE: 02/15/2011 12:52:08 PM
Great! Thanks Brian.

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Parameters as iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: parameters-as-iproperties
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/04/parameters-as-iproperties.html 
DATE: 04/13/2010 08:48:37 PM
-----
BODY:
<p>The next few posts Iâ€™ll be making are intended to complete my coverage of topics related to iProperties.&#160; Iâ€™ve made <a href="http://modthemachine.typepad.com/my_weblog/iproperties/">several recent posts</a> that I believe cover the majority of the API functionality that will enable you to write most programs that use iProperties.&#160; However, there are a few odds and ends that I havenâ€™t covered.&#160; Hereâ€™s the first of these last set of posts on iProperties.</p>  <p>In the Parameters dialog you can check the Export Parameter box for a parameter, as shown circled below.&#160; This is useful because there are quite a few areas in Inventor that provide access to property values, (text in drawings, BOM, etc.), and by exporting a parameter as a property it extends the use of the existing functionality to also be able to use parameters.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f10a970c-pi"><img title="ExportParameter" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="171" alt="ExportParameter" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f110970c-pi" width="454" border="0" /></a> </p>  <p>This causes a custom iProperty to be created that contains the value of that parameter.&#160; This is a one-way association.&#160; Changing the parameter will cause the iProperty to update, but changing the value of the iProperty will not cause the parameter to update.&#160; The iProperty is just a reflection of the parameter and will be updated whenever the parameter value changes.</p>  <p>If the Export Parameter box is checked, then you can also access the <strong>Custom Property Formatâ€¦</strong> command through the context menu, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f115970c-pi"><img title="CustomPropertyFormatCtxMenu" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="208" alt="CustomPropertyFormatCtxMenu" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f11f970c-pi" width="454" border="0" /></a> </p>  <p>This displays the dialog shown below where you can control the format of the iProperty thatâ€™s created for this parameter.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecaa0287970b-pi"><img title="CustomPropertyFormat" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="251" alt="CustomPropertyFormat" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f127970c-pi" width="304" border="0" /></a> </p>  <p>This all results in the iProperty shown below.&#160; The name of the iProperty is the same as the parameter.&#160; If an iProperty of that name already exists, itâ€™s value will be overwritten to the value of the parameter.&#160; You can edit and even delete the iProperty, but Inventor will overwrite the edited value or re-create the iProperty whenever the parameter value changes.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f12f970c-pi"><img title="ParamAsCustomiProp" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="286" alt="ParamAsCustomiProp" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fd9f139970c-pi" width="404" border="0" /></a> </p>  <p>From the API you can also set the â€œExport Parameterâ€ box for a parameter.&#160; You do this by using the ExposedAsProperty property of the Parameter object.&#160; With Inventor 2010 and later you can also edit the formatting of the resulting iProperty using the CustomPropertyFormat property of the Parameter object.&#160; This is demonstrated in the code below. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim param As Parameter      <br />Set param = partDoc.ComponentDefinition.Parameters.Item(&quot;Length&quot;)       <br />param.ExposedAsProperty = True       <br />      <br />param.CustomPropertyFormat.Precision = kThreeDecimalPlacesPrecision       <br />param.CustomPropertyFormat.ShowTrailingZeros = True       <br />param.CustomPropertyFormat.ShowUnitsString = True       <br />param.CustomPropertyFormat.Units = &quot;in&quot; </p> </div>  <p>iProperties created as the result of an export appear like any other property through the API.&#160; In fact, the iProperty doesnâ€™t know itâ€™s the result of an export.&#160; If you need to find the iProperties that were created through an export youâ€™ll would need to look through the parameters to see if any of them have been exported.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sundeep
EMAIL: sveguru@enclos.com
IP: 4.79.160.34
URL: 
DATE: 04/13/2010 09:31:32 PM
Thanks a lot Brian.
It was very helpful
-----
COMMENT:
AUTHOR: www.google.com/accounts/o8/id?id=AItOawk8weCEDZpGLV9M8rK_RyMwwCxVoM9rnnE
EMAIL: 
IP: 194.7.161.147
URL: http://profile.typepad.com/6p01053720ba58970b
DATE: 04/14/2010 09:08:00 AM
We mark all parameters for export with this code:

Public Sub MarkAllParametersForExport()

Dim oPartDoc As PartDocument
Set oPartDoc = ThisApplication.ActiveDocument

Dim oParameter As Parameter
For Each oParameter In oPartDoc.ComponentDefinition.Parameters
oParameter.ExposedAsProperty = True
Next oParameter

MsgBox "Done!", vbInformation

End Sub
-----
COMMENT:
AUTHOR: FY
EMAIL: farren.young@d3tech.net
IP: 99.62.192.102
URL: 
DATE: 04/15/2010 04:40:14 AM
Very nice.  I will definitely use this. I just wonder how I've missed it all these years?!
-----
COMMENT:
AUTHOR: Said
EMAIL: abbassisaid@yahoo.com
IP: 69.125.23.39
URL: 
DATE: 04/24/2010 11:05:17 PM
Hi
Is it possible to ask some questions regarding macros in other subjects, How?
thank you very much for helping us, I really appreciate that.

-----
COMMENT:
AUTHOR: Ramy
EMAIL: ramy.mansour@geagroup.com
IP: 72.37.244.36
URL: http://www.funkyfreshmedia.com
DATE: 07/08/2010 07:55:02 PM
Any change you can show how to add parameters through the API (preferably via VB.net if possible)
-----
COMMENT:
AUTHOR: Gavin Bath
EMAIL: gavin@knac.co.nz
IP: 121.72.226.92
URL: http://www.knac.co.nz/blog
DATE: 07/23/2010 12:06:19 AM
Hi Brian,

I've been able to create numeric parameters, but am really struggling to figure out how to create a text parameter. Does the API support this?

Thanks
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Learning About New Functionality in Inventor 2011
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: learning-about-new-functionality-in-inventor-2011
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/learning-about-new-functionality-in-inventor-2011.html 
DATE: 03/30/2010 09:36:08 PM
-----
BODY:
<p>For those of you in the US and Canada thereâ€™s a free virtual event for you to learn more about the new features in the latest release of products.&#0160; Hereâ€™s the brief description I was given.</p>
<blockquote>
<p>Itâ€™s here â€” your chance to preview all the new ways that Autodesk 2011 software can help you transform your business challenges into new opportunities.&#0160; Attend Autodeskâ€™s free Seize the Opportunity Virtual Event.</p>
<p>Monday, April 19, 2010 <br />7:00 a.m.â€“2:00 p.m. PT</p>
<p>Get access to exclusive sessions and live demonstrations, including:</p>
<ul>
<li>How to achieve greater speed, power and flexibility using AutoCAD 2011 software</li>
<li>Going beyond 3D to Digital Prototyping with AutodeskÂ® InventorÂ® software</li>
<li>Delivering building projects more economically and with minimal environmental impact using AutodeskÂ® RevitÂ® software for building information modeling (BIM).</li>
<li>Delivering transportation and environmental engineering projects faster with AutoCADÂ® Civil 3DÂ® software.</li>
<li>How Autodesk Digital Entertainment Creation software can open new opportunities for creativity and give you a competitive edge.</li>
</ul>
<p>Explore all the new opportunities that Autodesk 2011 software can offer you. Register for the free Seize the Opportunity Virtual Event today at <a href="http://www.autodesk.com/seizetheopportunity">www.autodesk.com/seizetheopportunity</a></p>
</blockquote>
<p>Sorry to those of you in other countries.&#0160; I assume there will be similar events for you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Manufacturing DevCamp 2010 and DevLab
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: manufacturing-devcamp-2010-and-devlab
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/manufacturing-devcamp-2010-and-devlab.html 
DATE: 03/29/2010 08:21:19 PM
-----
BODY:
<p>Registration is now open for the Manufacturing DevCamp on June 2-4, 2010 in Portland, Oregon.&#0160; You can <a href="https://reg.eegeventdirect.com/index.cfm?event=cms.page&amp;id=SID3FAC7891D004441BB8310C3FCF7DCCB8&amp;token=843039e39a9d9c1243f18011756f3b5052c3">register here</a> and <a href="http://devcamps2010.autodeskevents.net/index.cfm?event=cms.page&amp;id=SIDA5276497014D8474B8D2C27B3BA42307">get more information here</a>. DevCamp is a three-day conference for both beginners and experts interested in learning more about extending the capabilities of Autodesk Inventor through its API. The day before the conference begins and throughout the rest of the week, weâ€™ll also be hosting a DevLab.&#0160; A DevLab This is a great opportunity to bring your project in and get advice on any issues you might be having.&#0160; (<a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=13713450">Hereâ€™s a more detailed description of what a DevLab is</a>.)</p>
<p><strong>DevCamp â€“ June 2-4, 2010, Portland, Oregon <br />DevLab â€“ June 1, 2010, Lake Oswego, Oregon</strong></p>
<p>During the three days, we will have several keynote talks, (including Manufacturing Senior Vice President Buzz Kross), and will be holding more than 20 sessions on the various manufacturing related products, most of which are targeted at Inventor.&#0160; The classes will be taught by DevTech engineers (those that support ADN developers) and also some of us from the Inventor engineering team.&#0160; Hereâ€™s an overview of the classes (with a <a href="https://register.eeginc.com/autodesk/files/Autodesk_MFG_DevCamp_2010_Agenda.doc">full agenda here</a>):</p>
<blockquote>
<p><strong>Beginner</strong></p>
<ul>
<li>Introduction to .NET programming for non-programmers</li>
<li>Introduction to the Inventor API â€“ parts 1, 2, 3 and 4</li>
<li>Introduction to Vault programming</li>
<li>AutoCAD Mechanical customization</li>
<li>Working with large machines and factories?&#0160; An introduction to the Navisworks API</li>
</ul>
</blockquote>
<blockquote>
<p><strong>Expert</strong></p>
<ul>
<li>Working with solids through the Inventor API</li>
<li>Creating custom commands in Inventor</li>
<li>The Vault client and job processor APIâ€™s</li>
<li>Advanced Vault programming</li>
<li>Inventor API customization case studies</li>
<li>In-depth review of the Inventor 2011 APIâ€™s â€“ Part 1 and 2</li>
</ul>
<p><strong>Sharing</strong></p>
<ul>
<li>The Doctor is in: bring your challenges and problems and get expert advice/help</li>
<li>Talk to the Inventor product managers</li>
<li>Talk to the Inventor API designer and developers</li>
</ul>
<p><strong>Business</strong></p>
<ul>
<li>Teaming with the Autodesk sales team and Autodesk Authorized Resellers</li>
<li>Leveraging your relationship with Autodesk to grow your business</li>
<li>Understanding Autodesk mergers and acquisitions</li>
</ul>
</blockquote>
<p>A large portion of the Inventor development team works from an office in Lake Oswego, Oregon, (about 10 miles southwest of Portland).&#0160; This makes it possible for senior management and the Inventor engineering team to participate in the event and provides a great opportunity for you to meet them and discuss your trials and triumphs with Autodesk software.</p>
<p>If you havenâ€™t been to Portland before thereâ€™s a lot to see in the area so hopefully you can spare a little more time outside the conference and do some site-seeing.</p>
<p>If any of you are cyclists, the <a href="http://www.pwtc.com/index.php/schedule/more/pioneer_century_june_5_20101/">Pioneer Century</a> ride is on June 5th (the Saturday following the conference) and will let you experience some of Oregon at a more relaxed pace than a car. Iâ€™ll be riding the 100 mile option if anyone wants to join in. <br /> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5cea7970c-pi"><img alt="PioneerCentury" border="0" height="337" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5ceaf970c-pi" style="display: inline; border: 0px;" title="PioneerCentury" width="254" /></a></p>
<p>Here are some links for some more things to see and do in the Portland area:</p>
<p><a href="http://www.travelportland.com/" title="http://www.travelportland.com/">General Portland Info</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbb70970b-pi"><img alt="Portland" border="0" height="223" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5ced3970c-pi" style="display: inline; border: 0px;" title="Portland" width="354" /></a></p>
<p><a href="http://www.friendsofmultnomahfalls.org/" title="http://www.friendsofmultnomahfalls.org/">Multnomah Falls and the Columbia River Gorge</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5ceda970c-pi"><img alt="MultnomahFalls" border="0" height="316" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5ceed970c-pi" style="display: inline; border: 0px;" title="MultnomahFalls" width="254" /></a></p>
<p><a href="http://www.portlandsaturdaymarket.com/" title="http://www.portlandsaturdaymarket.com/">Portland&#39;s Saturday Market</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbba9970b-pi"><img alt="SaturdayMarket" border="0" height="248" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5ceff970c-pi" style="display: inline; border: 0px;" title="SaturdayMarket" width="354" /></a></p>
<p><a href="http://www.fs.fed.us/gpnf/mshnvm/" title="http://www.fs.fed.us/gpnf/mshnvm/">Mt. Saint Helens National Volcanic Monument</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbbbc970b-pi"><img alt="MtSaintHelens" border="0" height="240" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbbc7970b-pi" style="display: inline; border: 0px;" title="MtSaintHelens" width="354" /></a></p>
<p><a href="http://www.timberlinelodge.com/" title="http://www.timberlinelodge.com/">Mt. Hood</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbbcd970b-pi"><img alt="MtHood" border="0" height="285" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5cf17970c-pi" style="display: inline; border: 0px;" title="MtHood" width="354" /></a></p>
<p><a href="http://visittheoregoncoast.com/">Oregon Coast</a> <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ec4fbbdd970b-pi"><img alt="CanonBeach" border="0" height="266" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310ff5cf26970c-pi" style="display: inline; border: 0px;" title="CanonBeach" width="354" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk Inventor 2011 New Functionality
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-inventor-2011-new-functionality
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/autodesk-inventor-2011-new-functionality.html 
DATE: 03/26/2010 09:38:53 PM
-----
BODY:
<p>With respect to the API, the <a href="http://www.autodesk.com/developinventor">http://www.autodesk.com/developinventor</a> website has been updated with the information for Inventor 2011.&#0160; There is a PowerPoint presentation that goes through the new API features and also a set of demo files, including sample code, that demonstrates many of the new features.</p>
<p>To learn about new non-API functionality in Inventor 2011 you can attend a virtual event that Autodesk is hosting. Itâ€™s Monday, April 19th, 2010 from 7amâ€“2pm Pacific time.&#0160; Register for this event at <a href="http://www.autodesk.com/seizetheopportunity">http://www.autodesk.com/seizetheopportunity</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: VBA Code Writing Tip
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: vba-code-writing-tip
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/vba-code-writing-tip.html 
DATE: 03/25/2010 08:32:11 PM
-----
BODY:
<p>This week has been busy and left me with little time to work on finishing up some posts Iâ€™ve been working on.&#160; Hereâ€™s a quick tip that can make coding in VBA or VB6 a little easier.&#160; Maybe you already know about it, but itâ€™s something I didnâ€™t learn about until I had been using VBA and VB6 for several years.</p>  <p>When youâ€™re entering code in a VBA code window you get Intellisense help when accessing methods and properties on objects.&#160; VB.Net uses intellisense to help you when typing variable names.&#160; You can also get help with variable names in VBA, itâ€™s just not automatic like it is in VB.Net.&#160; When youâ€™ve typed the first few characters of a variable, press ctrl-space and the intellisense window will display showing you the available variable names that match the characters youâ€™ve typed in so far.&#160; You can continue typing to narrow down the list or choose one from the list.&#160; Once youâ€™ve selected one from the list by clicking with the mouse or using the arrow keys, press the tab key to use it.&#160; An example of its use is shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a9774170970b-pi"><img title="VBAIntellisense" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="292" alt="VBAIntellisense" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310fde3bba970c-pi" width="471" border="0" /></a> </p>  <p>The written description makes it sound like a bit difficult to use with a lot of steps&#160; but it quickly became second nature for me and has saved me a lot of typing.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk University Class Proposals
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-university-class-proposals
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/autodesk-university-class-proposals.html 
DATE: 03/19/2010 06:37:42 PM
-----
BODY:
<p>The <a href="http://www.autodeskevents.com/au2010/email/CFPInvite/">invitation</a> to submit proposals for this years Autodesk University was sent out earlier this week.&#0160; Do you have a topic you think would be interesting to a lot of other Inventor users?&#0160; Now&#39;s the time to start thinking about it.&#0160; The deadline for proposals is May 14th.</p>
<p>If you donâ€™t have an idea for a class or teaching a class isnâ€™t your thing, what would you like to hear from others?&#0160; Remember that AU isnâ€™t limited to those few that can attend in Las Vegas; there are the new virtual sessions that are available online and the papers from the classes benefit everyone.&#0160; So even if you canâ€™t attend in Las Vegas you should still care about the topics covered.&#0160; If you have any ideas for API specific or general Inventor classes please let me know.&#0160; Iâ€™ll pass any ideas onto other experts that might be interested in teaching your suggested classes.&#0160; Itâ€™s always difficult to come up with new topics each year so any input is appreciated.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Material from the Free Online API Class
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: material-from-the-free-online-api-class
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/material-from-the-free-online-api-class.html 
DATE: 03/18/2010 09:43:53 PM
-----
BODY:
<p>I mentioned before in the <a href="http://modthemachine.typepad.com/my_weblog/2010/02/free-online-inventor-api-training-class.html">previous post</a> about the free online API training class that the material would be posted online.&#0160; The material is currently available as a single <a href="http://download.autodesk.com/media/adn/InventorOnlineAPItraining2010.zip">zip file</a> that contains the videos, slides, and labs for the sessions that have been completed so far.&#0160; This zip file will be added to each week with the material presented during the most recent session.&#0160; The final session is currently scheduled for May 6, 2010.&#0160; If the format or location for this delivery changes, Iâ€™ll add a new post describing the changes.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Flattening an Assembly
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: flattening-an-assembly
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/flattening-an-assembly.html 
DATE: 03/17/2010 02:53:08 PM
-----
BODY:
<p>I had an internal request recently for a utility to take any assembly and create an equivalent single-level assembly.&#0160; In this particular case they had a large assembly whose structure didnâ€™t make sense for their current use and the structure made it difficult to delete individual components.&#0160; By flattening the assembly theyâ€™re now able to quickly remove portions of the assembly and get something they can begin working with.&#0160; In this specific case, to begin building fixtures around it.</p>
<p>Hereâ€™s the VBA macro code that does the flattening.&#0160; (I had to add some line continuations that I wouldnâ€™t normally use to get the code to fit within the narrow space I have here.)</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p><font color="#0000ff"><strong>&#39; Macro that creates a new assembly that represents a flattened <br />&#39; version of the current active assembly.&#0160; The result is a single <br />&#39; level assembly of occurrences.&#0160; There are not constraints and <br />&#39; each occurrence is grounded. <br /></strong></font>Public Sub FlattenAssembly()&#0160; <br /><font color="#0000ff"><strong>&#0160;&#0160; &#39; Get the active assembly.&#0160; <br /></strong></font>&#0160;&#0160; Dim sourceAsmDoc As AssemblyDocument&#0160; <br />&#0160;&#0160; On Error Resume Next&#0160; <br />&#0160;&#0160; Set sourceAsmDoc = ThisApplication.ActiveDocument&#0160; <br />&#0160;&#0160; If Err Then&#0160; <br />	&#0160; MsgBox &quot;An assembly must active.&quot;&#0160; <br />	&#0160; Exit Sub&#0160; <br />&#0160;&#0160; End If&#0160; <br />&#0160;&#0160; On Error GoTo 0 <br /><br /><font color="#0000ff"><strong>&#0160;&#0160; &#39; Create the new, empty assembly.&#0160; <br /></strong></font>&#0160;&#0160; Dim targetAsmDoc As AssemblyDocument&#0160; <br />&#0160;&#0160; Set targetAsmDoc = ThisApplication.Documents.Add( _ <br />					&#0160; kAssemblyDocumentObject, _ <br />					&#0160; ThisApplication.FileManager.GetTemplateFile( _ <br />					&#0160; kAssemblyDocumentObject)) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160; &#39; Traverse through the existing assembly getting&#0160; <br />&#0160;&#0160; &#39; each leaf component and creating an occurrence&#0160; <br />&#0160;&#0160; &#39; in the new assembly that represents it.&#0160; <br /></strong></font>&#0160;&#0160; Call CopyAssemblyAsFlat(targetAsmDoc.ComponentDefinition, _&#0160; <br />					&#0160;&#0160; sourceAsmDoc.ComponentDefinition.Occurrences) <br />End Sub <br /><br /><br /><br /><font color="#0000ff"><strong>&#39; Utility sub used by FlattenAssembly macro.&#0160; This sub is call <br />&#39; recursively to traverse an entire assembly.&#0160; It creates new <br />&#39; top-level occurrences in the target assembly to represent each <br />&#39; of the occurrences found in the source assembly. <br />&#39; <br />&#39; TargetAsm - The component definition of the target assembly. <br />&#39; Occurrences - The occurrences collection of the assembly <br />&#39; to traverse. <br /></strong></font>Private Sub CopyAssemblyAsFlat( _<br />					&#0160;&#0160; TargetAsm As AssemblyComponentDefinition, _&#0160; <br />					&#0160;&#0160; Occurrences As ComponentOccurrences)&#0160; <br /><font color="#0000ff"><strong>&#0160;&#0160; &#39; Iterate through the occurrences in the current level&#0160; <br />&#0160;&#0160; &#39; of the assembly.&#0160; <br /></strong></font>&#0160;&#0160; Dim occ As ComponentOccurrence&#0160; <br />&#0160;&#0160; For Each occ In Occurrences&#0160; <br /><font color="#0000ff"><strong>	&#0160; &#39; Skip any invisible, suppressed, or excluded components.&#0160; <br /></strong></font>	&#0160; If occ.Visible And Not occ.Suppressed And _ <br />											&#0160; Not occ.Excluded Then&#0160; <br /><font color="#0000ff"><strong>		 &#39; Check to see if this occurrence is a part or assembly.&#0160; <br /></strong></font>		 If occ.DefinitionDocumentType = kPartDocumentObject Then&#0160; <br /><font color="#0000ff"><strong>		&#0160;&#0160;&#0160; &#39; Create an occurrence in the target assembly&#0160; <br />		&#0160;&#0160;&#0160; &#39; for this part.&#0160; <br /></strong></font>		&#0160;&#0160;&#0160; Dim newOcc As ComponentOccurrence&#0160; <br />		&#0160;&#0160;&#0160; Set newOcc = _ <br />				&#0160;&#0160; TargetAsm.Occurrences.AddByComponentDefinition( _&#0160; <br />								 occ.Definition, occ.Transformation)&#0160; <br />		&#0160;&#0160;&#0160; newOcc.Grounded = True&#0160; <br />		 Else&#0160; <br /><font color="#0000ff"><strong>		&#0160;&#0160;&#0160; &#39; Recursively call this sub to continue&#0160; <br />		&#0160;&#0160;&#0160; &#39; traversing the assembly.&#0160; <br /></strong></font>		&#0160;&#0160;&#0160; Call CopyAssemblyAsFlat(TargetAsm, occ.SubOccurrences)&#0160; <br />	&#0160;&#0160;&#0160; End If&#0160; <br />	 End If&#0160; <br />&#0160;&#0160; Next <br />End Sub</p></div>
<p>The macro uses somewhat of a brute force method.&#0160; It creates a new, empty assembly, traverses the existing assembly to determine what parts are used and where theyâ€™re located and then reconstructs the original assembly by placing parts in the new assembly.&#0160; The parts are positioned correctly in the new assembly but there arenâ€™t any constraints and theyâ€™re all grounded.</p>
<p>You can see that thereâ€™s really not much code needed to do this.&#0160; Itâ€™s actually just a variation of the assembly traversal code from a <a href="http://modthemachine.typepad.com/my_weblog/2009/03/accessing-assembly-components.html">previous post</a>.</p>
<p><strong>Update (March 29, 2010)</strong> <br />A couple of limitations with the program have been pointed out to me and are worth noting.</p>
<ol>
<li>All assembly features are lost. 
<li>All weldment data is lost (preparations, welds, finishing). </li>
</li></ol>
<p>Luckily I donâ€™t believe these are an issue in most cases where the program would be used, but in case you do have assembly features or weldments you should be aware of these limitations.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: JLackey
EMAIL: jlackey@enflite.com
IP: 208.180.87.178
URL: 
DATE: 04/28/2010 04:51:06 PM
I pasted the macro, however, it is telling me the sub is not defined.  I am very new to VBA and know barely anything about.  I have been trying to do some reading about it, but have not really been able to practice anything with it. I initially pasted all the text in one module, but got an error telling me nothing but comments were allowed after the end sub statement, so I pasted the private sub on a seperate module.  ANy help would be greatly appreciated. 
-----
COMMENT:
AUTHOR: BRENDAN  HENDERSON
EMAIL: brendan.henderson@augers.com.au
IP: 115.64.119.122
URL: 
DATE: 06/21/2010 03:38:08 AM
Add both sets of text into the 1 module. Edit the long lines that end in _ so that the lines are joined together (see example below) :-

hello, _
there,

Becomes :-
hello, there

Save the macro and run it. It works fine for me.
-----
COMMENT:
AUTHOR: Craig Lambson
EMAIL: 
IP: 67.136.118.165
URL: http://profile.typepad.com/craiglambson
DATE: 08/04/2010 09:08:49 PM
How can I alter this code to selectively remove or ignore components going in to the new assembly?  I can place a value in an excel file indicating a particular component is not needed.
-----
COMMENT:
AUTHOR: Alessandro Ferraz
EMAIL: projetech.eng@gmail.com
IP: 200.148.142.114
URL: 
DATE: 01/05/2011 02:46:13 PM
Hello, I work with Inventor 2011 in Portuguese, and when I create a rule in iLogic and have to put the unit "s_m" it does not work, this unit in English is "ul"
 when I do the same thing the inventor in English it works, tell me know if there is some code that I put to identify the unit of the inventor in Portuguese? Or is there a plugin to fix?
 grateful
 Alessandro

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: iProperty Performance
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: iproperty-performance
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/iproperty-performance.html 
DATE: 03/15/2010 11:50:33 PM
-----
BODY:
<p>Hereâ€™s some performance data regarding using Inventor and Apprentice to work with iProperties.&#160; I found this interesting and think it will be useful when architecting your programs so you fully understand the advantages and disadvantages of different approaches.</p>  <p>All of the test results shown below are for processing 1000 unique files.</p>  <p><strong>Test 1 â€“ Open, Edit, Save, Close      <br /></strong>This test opened each of the 1000 files, edited the value of two iProperties, saved the document, and closed it.</p>  <ol>   <li>Apprentice â€“ 116 seconds. </li>    <li>Inventor (visible document) â€“ 1068 seconds.&#160; This test opened the documents visibly by setting the second argument of the Documents.Open method to True. </li>    <li>Inventor (invisible document) â€“ 238 seconds.&#160; This is the same as the test above but opens the documents invisibly by setting the second argument of the Documents.Open method to False. </li> </ol>  <p>The biggest difference is between opening the document visibly or invisibly.&#160; When a document is opened invisibly, Inventor is able to optimize the open and not read all of the file.&#160; Opening a file invisibly is similar to the time it takes in Apprentice, as shown by test 2 below.&#160; However, for test 1 Apprentice is still twice as fast.&#160; Two things account for the extra time spent by Inventor; changing the property value and saving the document.&#160; Changing the value of an iProperty in Inventor is transacted, meaning that you can undo the operation.&#160; Transacting has some overhead which accounts for some of the time.&#160; Apprentice doesnâ€™t have any transaction capabilities so it doesnâ€™t have this overhead.&#160; The other big difference is the save.&#160; To save an iProperty change in Inventor you need to save the entire document using Document.Save.&#160; In Apprentice you can save just the iProperty portion of the document using PropertySets.FlushToFile.</p>  <p><strong>Test 2 â€“ Open, Read, Close</strong>     <br />This test also operated on all 1000 files by opening a file, reading property values, and closing the document.</p>  <ol>   <li>Apprentice â€“ 92.341 seconds </li>    <li>Inventor (invisible document) â€“ 100.374 seconds </li> </ol>  <p>These numbers show that there isnâ€™t a lot of difference between invisible Inventor and Apprentice when you donâ€™t do anything thatâ€™s transacted and you donâ€™t save the document.&#160; This is particularly important for add-in writers to understand since you canâ€™t use Apprentice within an add-in.</p>  <p><strong>Test 3 â€“ Open, Close      <br /></strong>This test uses VB.Net to open and close the same 1000 files.&#160; It opens a file, reads the file into memory, and closes the file.&#160; It is a pure VB.Net program and has nothing to do with Inventor.&#160; I wrote this program to help understand how much of the time is spent on general overhead of reading the file and how much time is spent by Inventor or Apprentice actually doing the work they need to do.&#160; As you can see, most of the time used by Apprentice or Inventor is system overhead of opening and reading the file.&#160; Anytime you have to read or write data to a hard drive, performance will be slow.</p>  <ol>   <li>VB.Net â€“ 77.69 seconds </li> </ol>  <p><strong>Summary      <br /></strong>If you need to write a utility to manipulate iProperties, using Apprentice will allow you to create the fastest program.&#160; However, if you just need to read iProperty data, opening documents invisibly in Inventor is almost as fast and a good alternative.&#160; Remember that Apprentice cannot be used within an add-in.&#160; If you need to do a lot of iProperty processing (writing and saving) through an add-in it might be worth creating a separate exe that uses apprentice that your add-in uses.&#160; You need to be careful that those documents are not currently open in Inventor.</p>  <p><strong>Gotcha</strong>     <br />Hereâ€™s something to watch out for when doing any timing tests like those above.&#160; The first time I ran a test it was slow and subsequent runs were significantly faster.&#160; For example, when I first ran test 2 with Inventor it took 100 seconds and then running the same test a second time only took 4 seconds.&#160; Even test 3, which doesnâ€™t have anything to do with Inventor went from 77 seconds for the first run down to 0.338 seconds for subsequent runs.&#160; Whatâ€™s happening is that Windows is caching data in memory in case the data is used again.&#160; This is great if you are reusing data but I think in most workflows where youâ€™re batch reading and updating iProperties this wonâ€™t be the case.&#160; To get the times reported above I rebooted between each test to clear memory and force the data to be read from disk.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: iProperties Without Inventor (Apprentice)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: iproperties-without-inventor-apprentice
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/iproperties-without-inventor-apprentice.html 
DATE: 03/09/2010 09:47:22 PM
-----
BODY:
<p>Continuing with the iProperty theme of some recent <a href="http://modthemachine.typepad.com/my_weblog/iproperties/">posts</a> I want to talk about the ability to work with iProperties without using Inventor. You can do this using a component known as <em>Apprentice</em>. Apprentice doesnâ€™t have a user-interface but is a component use can only use through programming. Apprentice is installed as part of Inventor and is also installed as part of Inventor View (<a href="http://www.autodesk.com/inventorview">www.autodesk.com/inventorview</a>).&#160; This means if Inventor or Inventor View is installed on a machine youâ€™ll have access to the Apprentice component and any Apprentice dependent program will work.&#160; The fact that itâ€™s available with Inventor View is interesting since Inventor View is free.</p>  <p><strong>What is Apprentice?</strong>     <br />Apprentice is a programming component that provides access to Inventor files.&#160; Using Apprentice you can open Inventor files, query information from them, and in a few cases, edit data.&#160; Apprentice supports a small subset of the functionality that Inventor supports and is primarily read-only with just a few exceptions.&#160; The primary things it provides access to are:</p>  <ul>   <li>Geometry of solids and surfaces (B-Rep) </li>    <li>Assembly structure </li>    <li>File references </li>    <li>Bill Of Material </li>    <li>Printing </li>    <li>Attributes </li>    <li>iProperties </li> </ul>  <p>Youâ€™ll notice that there are a lot of things missing.&#160; Apprentice is designed to be smaller and faster than Inventor and achieves this by providing having less code and operating on smaller portions of a document.&#160; Even things that are exposed in Apprentice will often have limitations that arenâ€™t present in Inventor.&#160; For example, letâ€™s say you have an extrude feature that youâ€™ve added an attribute to in Inventor.&#160; Using Apprentice, you can open that part and you can query for all attributes and get the attribute set associated with the feature.&#160; However when you try and get the feature from the attribute set itâ€™s not available because Apprentice doesnâ€™t support features.&#160; Apprentice is good at what it does but does have limitations you need to be aware of before attempting to use it in a project.</p>  <p><strong>Using Apprentice</strong>     <br />Apprentice uses much of the same code and components as Inventor.&#160; Because of this there are conflicts if you try running both of them within the same process.&#160; Remember that Apprentice always runs within the process of another program.</p>  <p>This means:</p>  <ul>   <li>You canâ€™t use Apprentice with Inventorâ€™s VBA. </li>    <li>You canâ€™t use Apprentice in an Add-In.</li> </ul>  <p>Using VBA within another application, for example Excel, is ok since Apprentice will be running within the Excel process and not Inventorâ€™s process.&#160; Another common use of Apprentice is within standalone exe programs where Apprentice will be running within the exe process.&#160; The example that part of this post is a standalone exe.</p>  <p>Another limitation of Apprentice is that it canâ€™t migrate files.&#160; Migration occurs when you open a file that is older than the current version of Inventor.&#160; For example, if I have an Inventor 2009 file on disk and open it with Inventor 2010 the data is migrated to the current version of Inventor.&#160; Inventor is smart and only migrates whatâ€™s necessary based on what youâ€™re currently doing with the file.&#160; However, if you save the file, the entire file must be migrated to the current version before it is saved.&#160; Apprentice can open and query older files but nothing can be changed and saved because that would require migration.&#160; You can use the NeedsMigrating property to determine if a file can be edited and saved.&#160; This is demonstrated in the sample at the bottom of this post.</p>  <p><strong>Connecting to Apprentice</strong>     <br />Hereâ€™s an example of how to use Apprentice within a VB Express Windows forms application.&#160; To enable the use of Apprentice in your program you need to add a reference to the Inventor Object Library.&#160; The Inventor Object Library is used for both Inventor and Apprentice even though Apprentice only supports a small subset of the entire library.&#160; You can add the reference using the <strong>Project |</strong> <strong>Add Referenceâ€¦</strong> command.&#160; In the example below Iâ€™ve select the version 14.0.0 (Inventor 2010) interop.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f82b0a9970c-pi"><img title="AddReference" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="375" alt="AddReference" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f82b0b2970c-pi" width="471" border="0" /></a> </p>  <p></p>  <p>Below is the minimum code needed to load Apprentice.&#160; This declares and creates a new ApprenticeServerComponent object.&#160; The ApprenticeServerComponent object is similar to the Inventor Application object.&#160; It is the top-level object for Apprentice.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim apprentice As New Inventor.ApprenticeServerComponent </p> </div>  <p>Itâ€™s also common to declare the variable and then create apprentice separately, like shown below.&#160; I do this in the sample program where the variable is declared as a member variable so I can reuse it.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim apprentice As Inventor.ApprenticeServerComponent      <br />apprentice = New Inventor.ApprenticeServerComponent </p> </div>  <p>When you create the ApprenticeServerComponent object the Apprentice dllâ€™s are loaded into your process and you can access the apprentice functionality through the properties and methods of the object.</p>  <p>Once you have an instance of the ApprenticeServerComponent, the next step is to open an Inventor document.&#160; You do this using the Open method of the ApprenticeServerComponent object, as shown below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Open a file using Apprentice.         <br /></strong></font>Dim apprenticeDoc As Inventor.ApprenticeServerDocument       <br />apprenticeDoc = apprentice.Open(Filename)</p> </div>  <p>Apprentice supports the ApprenticeServerDocument and ApprenticeServerDrawingDocument types.&#160; The ApprenticeServerDocument object can represent all document types.&#160; the ApprenticeServerDrawingDocument can be used to access some drawing specific functionality.</p>  <p><strong>Using iProperties With Apprentice</strong>     <br />Once you have the document, accessing iProperties is the same in Apprentice as it is in Inventor.&#160; The example below gets the summary information property set and changes the value of the â€œCompanyâ€ property.&#160; The previous <a href="http://modthemachine.typepad.com/my_weblog/iproperties/">posts</a> on using the API with iProperties also apply to Apprentice.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Get the &quot;Summary Information&quot; property set.&#160; <br /></strong></font>Dim summaryPropSet As Inventor.PropertySet&#160; <br />summaryPropSet = apprenticeDoc.PropertySets.Item( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor Document Summary Information&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>' Get the &quot;Company&quot; property.&#160; <br /></strong></font>Dim companyProp As Inventor.Property&#160; <br />companyProp = summaryPropSet.Item(&quot;Company&quot;) </p>    <p><font color="#0000ff"><strong>' Change the value of the iProperty.&#160; <br /></strong></font>companyProp.Value = &quot;Widgets R Us&quot; </p> </div>  <p><strong>Saving Changes With Apprentice      <br /></strong>When you use Inventor to change iProperties, you save the changes by saving the document.&#160; In Apprentice thereâ€™s a much more efficient way of saving iProperty changes.&#160; Instead of saving the entire document itâ€™s possible to just save the iProperties.&#160; You do this using the FlushToFile method of the PropertySet object, as illustrated below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>' Save the iProperty changes.</strong></font>&#160; <br />apprenticeDoc.PropertySets.FlushToFile()</div>  <p><strong>Example Program     <br /></strong>Hereâ€™s an <a href="http://modthemachine.typepad.com/files/ApprenticeSample.zip">example program</a> written using Visual Basic 2008 Express.&#160; It demonstrates the functionality discussed above.&#160; Itâ€™s a simple program that gets all of the part files in a specified directory, changes an iProperty value and saves it.&#160; Even though itâ€™s simple it does demonstrates the functionality needed to access iProperties using Apprentice.&#160; Youâ€™ll need to modify it to fit your specific requirements.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Brown
EMAIL: pbrown@redler.com
IP: 89.206.162.123
URL: 
DATE: 02/08/2011 04:02:30 PM
Can Apprentice access documents in the Vault?

-----
COMMENT:
AUTHOR: Bob Donovan
EMAIL: rdonovan@bigge.com
IP: 96.253.71.90
URL: http://www.bigge.com
DATE: 04/04/2011 06:29:26 PM
I saw the comment about apprentice accessing documents in vault but did not see an answer.

I have been developing an access solution for our bill of materials and it would seem to be a better solution to access through vault rather than local copies of the documents?

Thank you for any insite.

Bob D.
-----
COMMENT:
AUTHOR: Jon
EMAIL: guestj@its.jnj.com
IP: 148.177.193.210
URL: 
DATE: 08/16/2011 12:58:13 PM
Great blog, and thanks for the lessons gleaned from it so far.

I have been developing data extraction code in a database using Apprentice to read the iProperties of IDW's & Inventor DWG's, verify them against the database, and then push any necessary corrections back again. 

Problem is that when the IDW/DWG is opened in Inventor I then have to access the Property Sets and read and write each property before it will update on screen. This only seems to apply to iProperties that are referenced in the Revision Table. Other properties in the title block seem fine.

The values are saved fine using 'FlushToFile', and they appear in the 'Custom' tab in the iProperties dialog once the file is reopened in Inventor, but they won't update until I've either manually edited one of them in the iProperties dialog and clicked 'Apply', or I've done the read/write using this VBA approach:


Set invDoc = ThisApplication.ActiveDocument
Set invPropSets = invDoc.PropertySets
Set invPropSet = invPropSets.Item("Inventor User Defined Properties")

Set invProp = invPropSet.Item("REV CHK BY")
strTemp = invProp.Value
invProp.Value = strTemp


Any thoughts please? A blog post on the matter perhaps?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Document Thumbnails and Button Icons
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: document-thumbnails-and-button-icons
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/document-thumbnails-and-button-icons.html 
DATE: 03/04/2010 10:16:46 PM
-----
BODY:
<p>I had a hard time deciding what to title this post since what Iâ€™m actually discussing here isnâ€™t something that someone would likely be searching for.&#0160; The real topic is â€œIssues When Using the Inventor API Out-of-Processâ€.&#0160; The typical problems people run into because of out-of-process issues are when working with thumbnail or button images.</p>
<p>First, letâ€™s define what it means to be running in-process versus out-of-process.&#0160; For our purposes, a process is an executable thatâ€™s running.&#0160; Inventor is an example of a process.&#0160; A windows executable that you write is also an example of a process.</p>
<p>When Inventor is running there is an Inventor process.&#0160; Add-ins, which are dllâ€™s and not exeâ€™s, are loaded within the Inventor process and are referred to as running in-process.&#0160; VBA is only available from Microsoft as a 32-bit component, so with 32-bit Inventor VBA also runs in-process.&#0160; This is illustrated in the picture below with both VBA and the Add-In running within Inventorâ€™s process.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f633990970c-pi"><img alt="InOutProc01" border="0" height="198" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8fc64d3970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc01" width="362" /></a></p>
<p>With 64-bit Inventor, VBA canâ€™t be loaded since a 32-bit component canâ€™t load within a 64-bit process.&#0160; To still allow customers the use of VBA on 64-bit machines, Inventor runs a separate 32-bit process which hosts VBA.&#0160; VBA then talks to Inventor through the API but is running out-of-process with respect to Inventor, as illustrated below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339a3970c-pi"><img alt="InOutProc02" border="0" height="148" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8fc64da970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc02" width="450" /></a> </p>
<p>So what does it matter if VBA is running in or out of Inventorâ€™s process?&#0160; There are a couple of things this affects.&#0160; First, running out-of-process will be slower than in-process.&#0160; Thereâ€™s more overhead in passing data back and forth between processes.&#0160; Second, is that bitmap data canâ€™t be passed between two processes.&#0160; Inventor uses the Microsoft IPictureDisp object to represent bitmap data and it doesnâ€™t support being passed between processes.</p>
<p>The VBA programs below both get the thumbnail image from the active document.&#0160; One uses the Document.Thumbnail property and the other uses the Thumbnail iProperty.&#0160; Both of them will work in 32-bit Inventor since VBA runs in-process but they will fail for 64-bit Inventor.&#0160; In the SaveThumbnail macro the failure happens when calling the Thumbnail property of the document because that is when the bitmap would be passed.&#0160; For the iProperty example, the failure occurs when calling the Value property of the Property object.&#0160; Any call that passes an IPictureDisp object wonâ€™t work when running out-of-process, including getting or setting icons for buttons. </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub SaveThumbnail() <br /><strong><span style="COLOR: #0000ff; FONT-FAMILY: ">&#0160;&#0160;&#0160; &#39; Get the active document. <br /></span></strong>&#0160;&#0160;&#0160; Dim doc As Document <br />&#0160;&#0160;&#0160; Set doc = ThisApplication.ActiveDocument </p>
<p><strong><span style="COLOR: #0000ff; FONT-FAMILY: ">&#0160;&#0160;&#0160; &#39; Get the thumbnail from the document. <br /></span></strong>&#0160;&#0160;&#0160; Dim thumb As IPictureDisp <br />&#0160;&#0160;&#0160; Set thumb = doc.Thumbnail </p>
<p><span style="COLOR: #0000ff; FONT-FAMILY: "><strong>&#0160;&#0160;&#0160; &#39; Create the filename for the bmp file so it is the same <br />&#0160;&#0160;&#0160; &#39; as the document name but with a &quot;bmp&quot; extension. <br /></strong></span>&#0160;&#0160;&#0160; Dim filename As String <br />&#0160;&#0160;&#0160; filename = Left$(doc.FullFileName, Len(doc.FullFileName)-3)&amp;&quot;bmp&quot; </p>
<p><strong><span style="COLOR: #0000ff; FONT-FAMILY: ">&#0160;&#0160;&#0160; &#39; Save the thumbnail. <br /></span></strong>&#0160;&#0160;&#0160; Call SavePicture(thumb, filename) <br />End Sub </p></div>
<p><br /></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub SaveThumbnailUsingiProperty() <br /><span style="COLOR: #0000ff; FONT-FAMILY: "><strong>&#0160;&#0160;&#0160; &#39; Get the active document. <br /></strong></span>&#0160;&#0160;&#0160; Dim doc As Document <br />&#0160;&#0160;&#0160; Set doc = ThisApplication.ActiveDocument </p>
<p><span style="COLOR: #0000ff; FONT-FAMILY: "><strong>&#0160;&#0160;&#0160; &#39; Get the thumbnail from the document&#39;s iProperty. <br /></strong></span>&#0160;&#0160;&#0160; Dim oPropSet As PropertySet <br />&#0160;&#0160;&#0160; Set oPropSet = doc.PropertySets.Item( _ <br />									 &quot;Inventor Summary Information&quot;) <br />&#0160;&#0160;&#0160; Dim thumb As IPictureDisp <br />&#0160;&#0160;&#0160; Set thumb = oPropSet.Item(&quot;Thumbnail&quot;).Value </p>
<p><span style="COLOR: #0000ff; FONT-FAMILY: "><strong>&#0160;&#0160;&#0160; &#39; Create the filename for the bmp file so it is the same <br />&#0160;&#0160;&#0160; &#39; as the document name but with a &quot;bmp&quot; extension. <br /></strong></span>&#0160;&#0160;&#0160; Dim filename As String <br />&#0160;&#0160;&#0160; filename = Left$(doc.FullFileName, Len(doc.FullFileName)-3)&amp;&quot;bmp&quot; </p>
<p>&#0160;&#0160;&#0160; &#39; Save the thumbnail. <br />&#0160;&#0160;&#0160; Call SavePicture(thumb, filename) <br />End Sub</p></div>
<br />
<p>Here are some other examples where you can encounter out-of-process issues.&#0160; If youâ€™ve written a windows application it will be a separate exe and will run as a separate process.&#0160; It can still use the Inventor API, but it will be out-of-process and because of this will not be able to access any bitmaps through the API.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339af970c-pi"><img alt="InOutProc05" border="0" height="150" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339b8970c-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc05" width="450" /></a>&#0160;</p>
<br />
<p>Another example is using another productâ€™s VBA.&#0160; For example, Excel is illustrated in the picture below.&#0160; Excel is itâ€™s own process and itâ€™s version of VBA is running in-process to Excel.&#0160; If Excelâ€™s VBA is using Inventorâ€™s API it will be accessing it out-of-process and will not have any access to bitmaps through the API.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8fc64ec970b-pi"><img alt="InOutProc06" border="0" height="148" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339c6970c-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc06" width="450" /></a></p>
<br />
<p>Another way to access Inventor data is using Apprentice.&#0160; Apprentice is a programming only component and doesnâ€™t have a user-interface and canâ€™t run on its own but will always run in-process to its host application, (which is what you write).&#0160; In the example below, the primary application, Your.exe, has loaded Apprentice and Apprentice has opened a part document.&#0160; When using the Apprentice API (which is a subset of the Inventor API) you can successfully get the thumbnail because Apprentice is running in-process to your application and the IPictureDisp can be passed.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339cf970c-pi"><img alt="InOutProc03" border="0" height="199" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f6339dd970c-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc03" width="362" /></a></p>
<br />
<p>If youâ€™ve seen the program from a <a href="http://modthemachine.typepad.com/my_weblog/2010/02/parts-list-with-thumbnail-image.html">previous post</a> that creates a parts list with thumbnail images you might think that itâ€™s breaking some of these rules.&#0160; It doesnâ€™t, but these limitations did affect the choices I made as I arrived at the final design.&#0160; In that program, the code is an Inventor Add-in that reads the part list data from Inventor.&#0160; For each row in the parts list it accesses the associated document and gets the thumbnail.&#0160; Since the add-in is running in-process to Inventor thereâ€™s no problem to read the thumbnail.&#0160; As it processes each row and gets the thumbnail, it writes the thumbnail to disk.&#0160; It then accesses Word through itâ€™s API.&#0160; This communication is out-of-process.&#0160; Using Wordâ€™s API it has Word insert the thumbnail into the table.&#0160; The Word API function to insert a bitmap into a table takes a filename as input.&#0160; Word uses this to read the bitmap from disk and insert it into the table.&#0160; The bitmap was never directly passed between Inventor and Word but went through the intermediate step of going to the disk.&#0160; If the Word function to place the bitmap into a table had taken an iPictureDisp as input the program would not have worked and I would have had to come up with some other solution.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8fc650b970b-pi"><img alt="InOutProc07" border="0" height="230" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8fc6516970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="InOutProc07" width="450" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Lubos Rodanic
EMAIL: lubos.rodanic@stor.sk
IP: 195.98.27.156
URL: http://www.cadcentrum.sk
DATE: 03/19/2010 01:13:00 PM
Dear Brian, 

Thank you very much for powerfull infos, but I would discuss about one interesting issue.
I created AddIn in VB2008ExpressEdition from inventor template. The AddIn referenced to Autodesk.Inventor.Interop.dll, which exists in C:\Program Files\Autodesk\Inventor 2010\Bin\Public Assemblies. I used the value 12 of SupportedSoftwareVersionGreaterThan... subkey in COMRegistration Region . AddIn works fine in both versions of Inventor (2009 and 2010) unless the both versions are installed. Other PC, where is installed only Inventor 2009, is not able to register AddIn, because Interop.dll does not exist on the specified path. My question is: Does exist solution for this issue? And what next, if Inventor 2011 come to us, and I will have only 2011 version installed on my PC? Will be registration succesfull or not? 
It's really necesary, to create a AddIn for each version of Inventor especially? 

I hope that you understand my issue. Please, write me back your opinion. 

Thanks in advanced.

Lubos.
-----
COMMENT:
AUTHOR: Die cut machine
EMAIL: baura1@yahoo.com
IP: 188.27.89.159
URL: http://www.diecuttingmachine.org/choosing-a-die-cutting-machine/
DATE: 07/20/2010 11:16:07 PM
Other PC, which is only installed Inventor 2009 is not capable of recording AddIn because Interop.dll not exist in the specified path.
-----
COMMENT:
AUTHOR: Cartus hp
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:47:28 AM
Add-in works well in both versions of Inventor (2009 and 2010) unless both are installed versions. Other PC, which is only installed Inventor 2009 is not capable of recording AddIn because Interop.dll not exist in the specified path. 
-----
COMMENT:
AUTHOR: Larry
EMAIL: larryleebert04g40@hotmial.com
IP: 8.14.147.116
URL: 
DATE: 08/29/2010 09:24:47 AM
Other PC, which is only installed Inventor 2009 is not capable of recording AddIn because Interop.dll not exist in the specified path. <a href="http://www.hotfilemediafire.com">http://www.hotfilemediafire.com</a>
-----
COMMENT:
AUTHOR: Klaas De Smedt
EMAIL: klaas.de.smedt@ace.eu
IP: 91.183.55.62
URL: 
DATE: 11/03/2011 12:26:52 PM
Is it possible to get the thumbnail in vba with 64 bit Inventor? (2011)

Klaas
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Buttons for VBA Macros in the Ribbon User-Interface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: buttons-for-vba-macros-in-the-ribbon-user-interface
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/03/buttons-for-vba-macros-in-the-ribbon-user-interface.html 
DATE: 03/02/2010 07:23:47 PM
-----
BODY:
<p>Thereâ€™s a <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">previous post</a> that describes various ways to run a VBA macro, with a&#160; portion of that post discussing how to create a button to execute a macro.&#160; That post describes the process of creating a button for the classic user-interface but the process is different for the ribbon user-interface.&#160; This post describes the differences when using the ribbon.</p>  <p>To create a button to execute a VBA macro in the ribbon user-interface you use the <strong>Customize User Commands</strong> command which you access by right-clicking anywhere on the ribbon, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ed48e9970b-pi"><img title="CustomizeUserCommandsContext" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="263" alt="CustomizeUserCommandsContext" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ed48f5970b-pi" width="454" border="0" /></a> </p>  <p>The command displays the dialog shown below.&#160; To choose a VBA macro select â€œMacrosâ€ in the drop-down in the upper-left corner of the dialog.&#160; The list of commands will now show all of the VBA macros in the application project.&#160; Select the desired macro and then click the â€œAdd &gt;&gt;â€ button in the middle of the dialog.&#160; You can continue to select and add other macros and then click OK when finished. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f5413b8970c-pi"><img title="CustomizeUserCommands" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="390" alt="CustomizeUserCommands" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f5413bf970c-pi" width="454" border="0" /></a> </p>  <p>Buttons for the selected macros are added to a new panel, as shown below.&#160; The â€œUser Commandsâ€ panel is added to the currently active ribbon tab, so by choosing which tab to add the macros to you have some control over when the command is available.&#160; If you need it in more than one tab, youâ€™ll need to go through the process&#160; for each tab.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f5413c9970c-pi"><img title="UserCommandExample" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="167" alt="UserCommandExample" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ed4903970b-pi" width="331" border="0" /></a>&#160;</p>  <p></p>  <p></p>  <p>As explained in the <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">other post</a>, you can assign your own icons, as Iâ€™ve done in this example.&#160; This is done in exactly the same way as described before, by creating a bmp file, saving it in the same directory as the .ivb file, and naming it correctly.&#160; One thing to be aware of is that you donâ€™t have control over whether the button will be displayed as a large or small button; itâ€™s always small.&#160; Because of that the bitmap you create should be 16x16 pixels and should be named â€œ<em>ModuleName</em>.<em>MacroName</em>.Small.bmpâ€.&#160; Unfortunately, you donâ€™t have the option of displaying text with the button.&#160; Having a recognizable icon will help with this and the tooltip for the button displays the name of the macro.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Die cut machine
EMAIL: baura2@yahoo.com
IP: 188.27.89.159
URL: http://www.diecuttingmachine.org/choosing-a-die-cutting-machine/
DATE: 07/20/2010 11:17:53 PM
Where can i find a free online Autodesk Inventor LT Suite 2010 classes?
-----
COMMENT:
AUTHOR: Cartus hp
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:49:30 AM
The command displays the dialog shown is ok...
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Update to Thumbnail Parts List
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: update-to-thumbnail-parts-list
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/update-to-thumbnail-parts-list.html 
DATE: 02/26/2010 12:08:32 AM
-----
BODY:
<p>Iâ€™ve re-written the utility to create a parts list with the thumbnail image.&#0160; Iâ€™ve updated the <a href="http://modthemachine.typepad.com/my_weblog/2010/02/parts-list-with-thumbnail-image.html">original post</a> with the new program.&#0160; The new program is an add-in instead of a VBA macro.</p>
<p>For those of you interested, the problem on 64-bit machines was a side effect of a limitation of COM Automation.&#0160; COM Automation is the underlying Microsoft technology that Inventorâ€™s API is based on.&#0160; A limitation it has is that you canâ€™t pass a bitmap between processes.&#0160; When the macro is running on a 32-bit machine, VBA is running in the same process as Inventor so when the API call is made to get the thumbnail image Inventor is able to pass it back to VBA.&#0160; VBA doesnâ€™t have 64-bit support so in order to still provide VBA capabilities with 64-bit Inventor, VBA is run using a separate 32-bit process.&#0160; When the API call is made to get the thumbnail it fails because it canâ€™t pass the bitmap between the Inventor process and the process hosting VBA.&#0160; Rewriting this as an add-in solves the problem because it can be 64-bit and so it can run within Inventorâ€™s process.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Brown
EMAIL: pbrown@redler.com
IP: 89.206.162.123
URL: 
DATE: 03/02/2010 11:41:24 AM
Thanks for the clarification, but one further point-
IV2010 currently has VBA for macro's is this OK for machines running the 64 bit version as well as the 32 bit version?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Another iProperty Custom Dialog Example
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: another-iproperty-custom-dialog-example
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/another-iproperty-custom-dialog-example.html 
DATE: 02/23/2010 03:41:18 PM
-----
BODY:
<p>When writing the <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties-dialog.html">previous post</a> about a custom dialog for iProperty entry I had forgotten about another example I had put together a couple of years ago.&#160; This is similar but I think is better at demonstrating how useful this concept can be.&#160; In this case thereâ€™s a custom dialog that looks like a title block.&#160; This significantly simplifies filling out the title block.&#160; Instead of the user having to search through the iProperties dialog and remember which property corresponds to which field on the title block they just fill out the title block directly.&#160; For this example, one of the fields is also a prompted text entry to demonstrate that youâ€™re not limited to only using iProperties.&#160; This sample doesnâ€™t demonstrate it but it could also use drop-down fields with lists like that shown in the <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties-dialog.html">previous post</a>.</p>  <p>When the program is run, this is what the user sees.&#160; Itâ€™s a VBA dialog that was created by doing a screen shot of the title block and inserting that as an image on the dialog.&#160; The various text controls were added on top of the image.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8c89a59970b-pi"><img title="CustomTitleBlock" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="195" alt="CustomTitleBlock" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8c89a61970b-pi" width="454" border="0" /></a> </p>  <p>One the dialog is filled out and the â€œApplyâ€ button is pressed it sets the corresponding iProperties and the prompted text and then the title block automatically updates to reflect those changes.&#160; Hereâ€™s the result.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8c89a6d970b-pi"><img title="CustomTitleBockResults" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="270" alt="CustomTitleBockResults" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f2f6afa970c-pi" width="454" border="0" /></a> </p>  <p>Hereâ€™s a <a href="http://modthemachine.typepad.com/files/TitleBlock.zip">zip file</a> containing a sample drawing that has the custom iProperties and the prompted text field the sample program expects and it contains a VBA project that contains the source code.&#160; If you want to implement this within your company I would recommend writing this as an add-in rather than VBA, like the <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties-dialog.html">previous post</a> demonstrates.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
PING:
TITLE: example
URL: http://www.example.com
IP: 109.230.221.30
BLOG NAME: example
DATE: 02/15/2012 02:05:08 AM
Mod the Machine: Another iProperty Custom Dialog Example
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Parts List with Thumbnail Image
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: parts-list-with-thumbnail-image
CATEGORY: Brian
CATEGORY: Drawings

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/parts-list-with-thumbnail-image.html 
DATE: 02/18/2010 05:52:27 PM
-----
BODY:
<p>There was a recent question in the customization newsgroup about creating a parts list in Word or Excel that contained the thumbnail image for each part.&#0160; This seemed like an interesting problem to tackle.&#0160; Since a parts list is a table, Excel was the obvious first choice.&#0160; However, after playing with it a bit I found that Excel doesnâ€™t support inserting pictures into cells and from what I found online is an enhancement coming in Office 2010.&#0160; I also found out that Word does allow you to insert pictures into table cells so thatâ€™s what I decided to use.</p>  <p>Below is an example of the result using one of the sample files that comes with Inventor.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e34970b-pi"><img alt="PartListThumbResult" border="0" height="442" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e3d970b-pi" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="PartListThumbResult" width="454" /></a> </p>  <p>My initial code for this was a VBA macro but it was found to have a problem on 64-bit machines.&#0160; Iâ€™m leaving the original VBA version described below because itâ€™s simpler and easier to understand the whatâ€™s going on.&#0160; It isnâ€™t fancy but mostly does the job.&#0160; The new version is an add-in and will work on 32 and 64-bit machines.</p>  <p><strong>Add-In Version</strong>&#0160; <br />To use this version download this <a href="http://modthemachine.typepad.com/files/ThumbnailPartsList.zip">zip file</a>.&#0160; Inside the zip is a .exe and another zip file.&#0160; The .exe is an installer and running it will install the add-in.&#0160; It creates a new button on the Tools tab of the drawing ribbon.&#0160; If youâ€™re using the classic UI then it adds a new button to the annotation panel bar.&#0160; The add-in is compatible with Inventor 2010.&#0160; The zip file contains the source code for the add-in, in case youâ€™re interested in that.&#0160; It was written using Visual Basic Express 2008. </p>  <p><strong>VBA Version      <br /></strong>You can To use the program you need to copy and paste the <a href="http://modthemachine.typepad.com/files/PartsListThumbnail.txt">source code</a> into VBA.&#0160; I would recommend pasting it into your VBA application project, as shown below. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e44970b-pi"><img alt="PasteMacroVBA" border="0" height="355" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877b538e9970c-pi" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="PasteMacroVBA" width="454" /></a> </p>  <p>Since this program uses Word and drives it through the Word API, you need to add a reference to the Word Object Library.&#0160; You do this by using the <strong>Referencesâ€¦</strong> command in the Tools menu within VBA.&#0160; You need to check the box next to â€œMicrosoft Word 12.0 Object Libraryâ€ as shown below.&#0160; (I received some feedback on the newsgroup that this will also work with Word 2002 with some small changes to the code, which Iâ€™ve made the linked source code.&#0160; Thereâ€™s also a change so that itâ€™s tolerant of files that donâ€™t have a thumbnail.&#0160; Thanks to Cadfish1 from the autodesk.inventor.customization newsgroup for his input.)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e50970b-pi"><img alt="ReferenceWord" border="0" height="361" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877b538f3970c-pi" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="ReferenceWord" width="453" /></a> </p>  <p>Now youâ€™re all set.&#0160; You need to have a drawing open and the parts list selected that you want to write out and then you can run the program.&#0160; You run the program using the <strong>Macros</strong> command on the Tools tab of Inventor (which you can also access using Alt-F8).&#0160; Once itâ€™s finished you should have a new Word document that contains the parts list table.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Kent Boettger
EMAIL: mail@Kentboettger.com
IP: 80.160.144.50
URL: 
DATE: 02/21/2010 12:48:28 PM
Hello,
This is really cool, but is there any way to do the same from the Assembly bom view.
Like it is right now you have to do It from a Drawing and select a bom .
How can you export the assembly BOM into word without a Drawing present?

Regards.
Kent boettger.

-----
COMMENT:
AUTHOR: Marco
EMAIL: info@tecnomedianet.it
IP: 80.183.42.196
URL: 
DATE: 02/22/2010 02:26:41 PM
Hi
I tried your code, the list is created but without the previews.
Could not we be able to print, also in PDF from the assembly as the bill was structured?

Thanks
Marco
-----
COMMENT:
AUTHOR: Dennis M Koch
EMAIL: dennis@tulsarigiron.com
IP: 66.210.94.242
URL: 
DATE: 02/24/2010 09:46:26 PM
Anyone know if this has been able to work on 64-bit systems yet?

-----
COMMENT:
AUTHOR: Dennis M Koch
EMAIL: dennis@tulsarigiron.com
IP: 66.210.94.242
URL: 
DATE: 02/24/2010 10:54:30 PM
I have 64-bit... i have gotten it to where it will start to pop up messages... however, i cannot get past the msg that says (an active drawing must be open) or something like that... is there a direct email or phone # that i could talk to someone about getting this to work? OR is this a 64 bit issue... 
-----
COMMENT:
AUTHOR: Dan
EMAIL: danm@omnitech.co.il
IP: 193.138.92.152
URL: 
DATE: 02/25/2010 10:10:18 AM
It works great . 

Thanks
-----
COMMENT:
AUTHOR: Max U
EMAIL: umax.com@gmail.com
IP: 195.230.112.10
URL: 
DATE: 02/26/2010 02:41:05 PM
Doesn't work under Russian AI2010x64.
It says "A part list must exist on the active sheet". The Part list does exist. In Russian it is Ð¡Ð¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ. It is probably due to another term used in localised ver?
-----
COMMENT:
AUTHOR: Dennis M Koch
EMAIL: dennis@tulsarigiron.com
IP: 66.210.94.242
URL: 
DATE: 03/02/2010 04:41:03 PM
It works perfectly on 64 bit.
-----
COMMENT:
AUTHOR: Sam Nicarry
EMAIL: snicarry@msn.com
IP: 216.135.72.10
URL: 
DATE: 03/05/2010 07:12:56 PM
Woks great! Inventor 2010 64bit.
(Thanks for the code too.)


snicarry
-----
COMMENT:
AUTHOR: Harm van de Wetering
EMAIL: skull_snake@hotmail.com
IP: 213.197.215.104
URL: 
DATE: 04/01/2010 12:50:29 PM
Hello,
It works great on my work computer with word 2003, but at home with word 2007 the previews are not displayed. Am I doing something wrong?

Kind regards,

Harm van de Wetering
-----
COMMENT:
AUTHOR: Harm van de Wetering
EMAIL: skull_snake@hotmail.com
IP: 213.197.215.104
URL: 
DATE: 04/01/2010 02:14:27 PM
Hello, me again,

If I use the Add-in it works also great with word 2007. So there is not realy a problem.

Kind regards,

Harm van de Wetering
-----
COMMENT:
AUTHOR: GonÃ§alo Ferreira
EMAIL: 
IP: 85.244.50.93
URL: http://profile.typepad.com/gonaloferreira
DATE: 05/07/2010 10:53:06 AM
Hello,

in case you don't follow it, I posted a 'cry for help' on the 'Export PartList with thumbnail' Autodesk Discussion Groups thread 

<a href="http://discussion.autodesk.com/forums/message.jspa?messageID=6386877#6386877">http://discussion.autodesk.com/forums/message.jspa?messageID=6386877#6386877</a>

The main question is: AI2008 does not support the DrawingBOMs object. Is there a workaround in AI2008 API to refer to the part document only from object PartList?

Any idea on how to achieve this would be very appreciated.

Best Regards,
GonÃ§alo Ferreira

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.7
URL: http://blogs.autodesk.com/modthemachine
DATE: 06/15/2010 07:02:33 PM
Hi GonÃ§alo,

You should be able to use the ReferencedFiles property of the PartsListRow object.  It's a hidden property that was retired when the DrawingBOM functionality was added.  It still works to allow for backward compatibility.

-Brian
-----
COMMENT:
AUTHOR: Cartuse
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:01:53 AM
I tried your code, it creates the list but not the previews. Can not we be able to print, also in PDF format of the assembly as the bill was structured?
-----
COMMENT:
AUTHOR: Brick patio designs
EMAIL: eaura@yahoo.com
IP: 188.27.90.238
URL: http://www.brickpatiodesigns.org/
DATE: 08/09/2010 11:39:54 AM
There was a recent question in the customization newsgroup on the creation of a parts list in Word or Excel which contains the thumbnail image for each part. 
-----
COMMENT:
AUTHOR: Celine
EMAIL: 0jf49nt94ntg9n@hafasdc.om
IP: 8.14.147.116
URL: 
DATE: 08/10/2010 10:10:26 AM


I tried your code, it creates the list but not the previews. Can not we be able to print, also in PDF format of the assembly as the bill was structured?
<a href="http://rapidpig.com">http://rapidpig.com</a>
-----
COMMENT:
AUTHOR: Georhe
EMAIL: 94gn95n9@h93gff.com
IP: 8.14.147.116
URL: 
DATE: 09/02/2010 05:58:43 PM


I have 64-bit... i have gotten it to where it will start to pop up messages... however, i cannot get past the msg that says (an active drawing must be open) or something like that... is there a direct email or phone # that i could talk to someone about getting this to work? OR is this a 64 bit issue...
<a href="http://www.mediafiretorrent.com">http://www.mediafiretorrent.com</a>
-----
COMMENT:
AUTHOR: Wojciech
EMAIL: jarosz3@gmail.com
IP: 188.222.217.89
URL: http://www.wj.hostei.com
DATE: 11/21/2010 09:55:54 AM
Brain,

I have a drawing with an assembly. That drawing also has a detail drawing a part from the assembly. But the part for the detail drawing has been opened by separately so is not a part of the assembly. Therefore if I attached a balloon to the part it shows 1. I am looking for a solution where I would be able to attach the balloon for the part from the assembly parts list.

Thus I am looking for a code like:

1. record a path (folders/sub-folders) of parts from the parts list or the assembly with the item numbers from the parts list

2. check if the part (that opened individually but the same drawing)  does much with the records list
3. if yes attach the balloon with number from the assembly part list.

So I am looking for a vba code or similar code to modify...

if you could help mi please with it

many thanks

Wojciech
-----
COMMENT:
AUTHOR: Thomas Vandenberghe
EMAIL: thomas.vandenberghe@ninix-tech.com
IP: 62.166.209.162
URL: 
DATE: 11/22/2010 04:15:04 PM
Hi,

It works great on our Inventor 2011 x64.
But we only get the partlist on first level.
Is there a way to get the full partlist (hierarchical)?

Thanks!
Thomas.
-----
COMMENT:
AUTHOR: Eric
EMAIL: eucci10@gmail.com
IP: 72.226.111.19
URL: 
DATE: 11/28/2010 04:17:24 PM
Brian,
Thanks a bunch.  This is just what We've been looking for.  We're on INV2011 x64 with Word2010 and no issues at all.  Didn't have to make any changes in Word.
-----
COMMENT:
AUTHOR: Maria Manuela
EMAIL: mpinho@cadtech.pt
IP: 213.58.198.21
URL: 
DATE: 03/01/2011 12:47:04 PM
Great Job! Thanks for sharing Brian!

-----
COMMENT:
AUTHOR: Varinder
EMAIL: varindersra@gmail.com
IP: 209.91.138.170
URL: 
DATE: 07/15/2011 02:33:34 PM
Hi,

Do you have similar add-in for Inventor 2012.
-----
COMMENT:
AUTHOR: Kirk Arthur
EMAIL: karthur@fmi-solutions.com
IP: 12.236.116.18
URL: 
DATE: 07/15/2011 07:39:02 PM
Installed the Add-In version on 2011x64.  Installed without issues.  When I opened the iam, there was not a button on the Tools ribbon.  I was able to add it, but it is greyed out, thus will not work.  the add-in shows to be loaded.

Uninstall/reinstalled... problem persists
-----
COMMENT:
AUTHOR: Inspection India
EMAIL: elfinnjohn@googlemail.com
IP: 119.152.165.202
URL: http://www.asiatextileinspections.com/
DATE: 12/09/2011 12:20:08 PM
Therefore if I attached a balloon to the part it shows 1. I am looking for a solution where I would be able to attach the balloon for the part from the assembly parts list.
-----
PING:
TITLE: Janice Chunn
URL: http://www.ultimatemoviescenter.com
IP: 97.90.17.192
BLOG NAME: Janice Chunn
DATE: 12/26/2011 08:48:01 AM
Awesome blog article.Much thanks again. Great.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Free Online Inventor API Training Class
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: free-online-inventor-api-training-class
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/free-online-inventor-api-training-class.html 
DATE: 02/17/2010 06:33:39 PM
-----
BODY:
<p>The Autodesk DevTech team (the group that supports the Autodesk Developer Network (ADN)) is presenting a series of online Inventor API classes.&#0160; You donâ€™t need to be a member of ADN to attend.&#0160; These classes will be approx. 1 hour and will be presented each Thursday for 10 weeks.&#0160; The classes begin on Mar. 4th.&#0160; The classes are free but you do need to register.&#0160; The full list of API classes is at:</p>
<p><a href="http://www.adskconsulting.com/adn/cs/api_course_sched.php" title="http://www.adskconsulting.com/adn/cs/api_course_sched.php">http://www.adskconsulting.com/adn/cs/api_course_sched.php</a></p>
<p>Look for the class titled <strong>Introductory Inventor API virtual training class </strong>and click the <strong>Register</strong> link to the right.</p>
<p>A different topic will be presented each week with a lab provided at the end that you can work on until the class next week.&#0160; The concepts taught build on each other so you should plan on starting at the beginning and taking the entire series.</p>
<p>The class it being held at a time both those in Europe and in the Americas can attend.&#0160; It will be at 4pm UK time, which is 8am Pacific time (and for a brief time it will be 9am until out daylight saving times sync up).</p>
<p>If you have Inventor, you have the minimum pre-requisites because you have access to Inventorâ€™s VBA that you can use.&#0160; It would be good to have had some experience with VBA or another programming language.&#0160; In addition to VBA it wouldnâ€™t hurt to have a full development environment. If you donâ€™t already have something I would recommend looking into one of the Express Edition languages.&#0160; Theyâ€™re free and can be downloaded from <a href="http://www.microsoft.com/express/Downloads/">Microsoftâ€™s website</a>.&#0160; Visual Basic 2008 Express Edition will be the easiest to transition to from VBA.</p>
<p>The classes will also be recorded and made available online for those that arenâ€™t able to attend the live class.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Ben
EMAIL: ben.chanhong@rainin.com
IP: 206.169.16.248
URL: 
DATE: 02/23/2010 11:32:47 PM
Where can i find a free online Autodesk Inventor LT Suite 2010 classes?
-----
COMMENT:
AUTHOR: Binu
EMAIL: binu@fte.net.au
IP: 150.101.214.77
URL: http://www.fte.com.au
DATE: 02/25/2010 10:18:51 PM
Could you please show us how to retrieve iProperty information (eg. Revision) from individual files or all files in a directory using vba in Excel 2007. I can get Inventor to export it with VBA but not able to do it from excel VBA. Thank you
-----
COMMENT:
AUTHOR: Renaissance Clothing for Sale
EMAIL: renablogposts@gmail.com
IP: 112.202.3.154
URL: http://www.renaissancemodel.com/girls-dresses-gowns-13/
DATE: 03/13/2010 11:11:09 AM
"The classes will also be recorded and made available online for those that arenâ€™t able to attend the live class". What is the URL of this online class? What are the requirements to in order to join online?
-----
COMMENT:
AUTHOR: Die cut machine
EMAIL: baura1@yahoo.com
IP: 188.27.89.159
URL: http://www.diecuttingmachine.org/choosing-a-die-cutting-machine/
DATE: 07/20/2010 11:17:06 PM
Where I can find a free online Suite 2010 Autodesk Inventor LT classes? 
-----
COMMENT:
AUTHOR: Cartus hp
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:48:34 AM
Could you please show us how to retrieve information iProperty (ie revision) of the individual files or all files in a directory using VBA in Excel 2007.
-----
COMMENT:
AUTHOR: Larry
EMAIL: LTKDesigns@comcast.net
IP: 98.248.191.137
URL: 
DATE: 02/07/2011 04:18:48 AM
AutoCAD provides API's to track user interactions such as AcEditorReactor and AcEdInputContextReactor - these provide knowledge of command (& sub-command) invocation.

Does Inventor provide any such facility?

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Woodworking &ndash; Board Layout
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: woodworking-board-layout
CATEGORY: Brian
CATEGORY: Woodworking

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/woodworking-board-layout.html 
DATE: 02/17/2010 03:49:07 PM
-----
BODY:
<p>Ever since my <a href="http://modthemachine.typepad.com/my_weblog/2008/09/woodworking-with-inventor.html">initial post</a> discussing the use of Inventor for woodworking Iâ€™ve been planning on writing a tool to help laying out the individual parts onto stock so you know how to cut them out.&#160; Iâ€™ve a design in mind for an add-in that would have some nice features for this but unfortunately havenâ€™t been able to get going beyond some initial design.&#160; Thatâ€™s the problem with making the project too big to begin with.</p>  <p>Right now Iâ€™m in the middle of a new woodworking project at home and could use my non-existent add-in to layout my boards for cutting. Instead of waiting for my add-in that may never show up I decided to do some quick and dirty coding that would do some of the work and should still be a lot better than nothing. It ended up working pretty good, for at least what I used it for. I thought I would go ahead and share it with the rest of you and hopefully you can get some use out of it to.</p>  <p>Hereâ€™s my latest project, a vanity for a bathroom that Iâ€™m remodeling.&#160; Iâ€™ve constructed it completely in Inventor.&#160; Thatâ€™s the first step, to get a complete and accurate digital prototype.&#160; Hereâ€™s a picture of my project rendered with Inventor Studio.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877af4ebc970c-pi"><img title="Vanity" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="402" alt="Vanity" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ac8fc6970b-pi" width="454" border="0" /></a> </p>  <p>The programs to help with the layout are small VBA macros and are available <a href="http://modthemachine.typepad.com/files/PartLayoutMacros.txt">here</a>.&#160; The link is for a text file that you can copy and paste the contents of into your VBA application project.&#160; The first macro is called LayoutParts.&#160; To use this have your assembly open (in my case the vanity assembly shown above) and run the macro.&#160; After running this macro with my assembly I see the result shown below.&#160; A new assembly was created and every part is layed out flat on the assembly x-y plane.&#160; An assumption made by the program is that when the board parts were created that they lie flat on the x-y plane of the part coordinate system.&#160; Itâ€™s beneficial to have each material youâ€™re using colored in an obvious way so you can easily tell the differenced.&#160; The program also constrains the part x-y work plane to the assembly x-y work plane so they can easily be moved around in that plane.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ac8fe7970b-pi"><img title="BoardLayoutStart" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="386" alt="BoardLayoutStart" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877af4f2b970c-pi" width="454" border="0" /></a> </p>  <p>Next, I created a sketch in the assembly that represented my stock boards.&#160; In my case I have some cherry stock that is of various widths.&#160; I drew a sketch that contained all of these boards butted up to each other since I knew I would have to do some glue-ups.&#160; With this sketch I then manually did some nesting by dragging the parts around to see where they would best fit.&#160; While doing this I found I needed some additional capability to rotate the parts and to flip them over.&#160; This resulted in the creation of the three other macros; FlipPart, Rotate90, and Rotate180.&#160; After a few minutes of this manual nesting process I ended up with whatâ€™s shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877af4f44970c-pi"><img title="BoardLayoutFinish" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="390" alt="BoardLayoutFinish" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ac9048970b-pi" width="454" border="0" /></a> </p>  <p>I inserted this assembly into a drawing, added a few overall dimensions to some of the boards, printed out the drawing and then started laying out my project on the actual boards using chalk. Iâ€™ll keep this layout drawing handy while Iâ€™m doing the glue-up and actual cutting.</p>  <p>Iâ€™m still hoping to write the bigger program some day, but these simple macros ended up providing a good share of the capabilities I needed. Hopefully they can help someone else too.&#160; Iâ€™ll post a picture of the real vanity once I get it finished. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Table saw sale
EMAIL: contact@tablesawsale.net
IP: 95.149.194.7
URL: http://www.tablesawsale.net/
DATE: 06/30/2010 07:26:48 PM
Very interesting post, I normally don't use anything like that so I found it very interesting. I'll check back and have a look for the finished vanity unit.
-----
COMMENT:
AUTHOR: Terry Holt
EMAIL: staff@woodworkingcenter.net
IP: 94.194.182.50
URL: http://woodworkingcenter.net
DATE: 07/13/2010 12:11:19 PM
I've only really just combined woodworking and technology and my own effort was merely a website, but reading your post it suddenly struck me that there are lots of possibilities to use computers and software in woodworking. Seeing the rendering of the vanity and then the pieces all laid flat was just so cool. Well, I've saw renderings of furniture before, and even been doing some of my own, but I've never seen them split into the component parts. This is something I'm going to have to look into. Maybe it would all be too complicated for me, I don't know, but worth looking into definitely. I was getting quite excited about the potential of 3D printers for plastic components, and now you've shown something just as cool for the wood itself. This time not printing but planning. Thanks for a great post!
-----
COMMENT:
AUTHOR: woodworkingfan
EMAIL: joe@woodworking.com
IP: 81.190.243.9
URL: http://bestwoodworkingideas.com/
DATE: 03/03/2011 04:43:19 PM
great post

usually I just use paper and pencil:) but this is a great idea
-----
COMMENT:
AUTHOR: Tom
EMAIL: agold16@gmail.com
IP: 76.110.98.59
URL: http://howtobuildashedperfect.com/
DATE: 07/28/2011 09:00:56 PM
I've never built a vanity, but am interested.  Maybe one of the next projects.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Custom iProperties Dialog
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: custom-iproperties-dialog
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties-dialog.html 
DATE: 02/16/2010 04:18:40 PM
-----
BODY:
<p>I had a comment on one of the previous posts about iProperties asking about how to present the user a list of valid entries for an iProperty. Itâ€™s a good question and would be a useful feature, but is not something that Inventor supports. However, thatâ€™s an advantage of learning to program because you can create new functionality and add support for this yourself, which Iâ€™ve demonstrated below.</p>  <p>Iâ€™ve written a sample program to demonstrate one possible solution to this problem.&#160; The program is an Inventor add-in.&#160; It adds a new command to the application menu in the ribbon, as shown below.&#160; (It will add it to the File menu if youâ€™re using the classic user-interface.)&#160; I chose to call the command iProperties+. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877a96cc0970c-pi"><img title="iPropertiesPlusCommand" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="379" alt="iPropertiesPlusCommand" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8a6d266970b-pi" width="154" border="0" /></a> </p>  <p>When the command is executed it brings up a custom iProperties dialog, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877a96ccd970c-pi"><img title="iPropertiesPlusDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="322" alt="iPropertiesPlusDialog" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877a96cd8970c-pi" width="448" border="0" /></a> </p>  <p>This dialog provides access to some of the standard iProperties plus an additional custom iProperty (Finish).&#160; It has the advantage of providing a simplified view of the iProperties where only those iProperties that are important for your workflow are shown.&#160; This makes it faster to enter the values and much easier since youâ€™re not having to navigate through several tabs to remember and find the iProperties you need to fill out.</p>  <p>Another advantage is that since this is a custom dialog you can choose to present the iProperties in any form you want.&#160; For example, Finish, Material, and Approved By are implemented as combo boxes allowing you to present the user with a list of valid values.&#160; The picture below shows the drop-down list when the Finish field is selected.&#160; Using the drop-down makes is even easier for the user and eliminates any mistakes from typing.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8a6d272970b-pi"><img title="iPropertiesPlusDropDown" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="322" alt="iPropertiesPlusDropDown" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834012877a96ce4970c-pi" width="448" border="0" /></a>&#160; </p>  <p></p>  <p></p>  <p>Here is the <a href="http://modthemachine.typepad.com/files/iPropertiesPlus.zip">source code</a> for this sample.&#160; Itâ€™s written using Visual Basic Express 2008 and is compatible with Inventor 2010 and later since it expects the ribbon to be available. I donâ€™t think the program is very useful as-is since everyone will have different requirements as far as which properties they want to display. In my sample I chose to use an external file to define the contents of the drop-down lists so they could be easily updated without modifying any code.&#160; If you want to see the program run, you just need to open the source within VB Express and compile it.&#160; This will compile and register it on your system so that when you start Inventor you should see the â€œiProperties +â€ icon in the Application menu.</p>  <p>The use of iProperties within the program is the most important part of the program but is also a small portion of the code.&#160; There is quite a bit of add-in code and also a fair amount of code to deal with the dialog.&#160; Updating this program for your specific needs would be a good project to get you going in the world of add-in development using VB.Net.&#160; For some background on add-ins and user-interface customization you might want to read these other posts; <a href="http://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html">Accessing iProperties</a>, <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties.html">Custom iProperties</a>, and <a href="http://modthemachine.typepad.com/my_weblog/2010/01/upgrading-your-add-ins-to-support-the-ribbon-user-interface.html">Supporting the Ribbon User Interface</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: JÃ¼rgen
EMAIL: juergen@kacaju.de
IP: 93.199.246.63
URL: http://inventorfaq.blogspot.com/
DATE: 02/16/2010 07:30:02 PM
Hi Brian,
thanks for the source code!
juergen
-----
COMMENT:
AUTHOR: jjbt
EMAIL: jeamyjoe1@une.net.co
IP: 200.13.234.100
URL: 
DATE: 02/16/2010 09:01:01 PM
Hi, Brian

Very interesting. 
A question: There is a way to put these iProperties in a tooltip?. For example when you have an Assembly this tooltip shows information (part number, weight, and so on..)when you pass the cursor over each part. (similar to AutoCAD). Is it possible?

Thanks!!
-----
COMMENT:
AUTHOR: Wenja
EMAIL: paojie@yahoo.com.tw
IP: 114.47.126.237
URL: 
DATE: 02/21/2010 03:52:13 AM
Hi Dear 
Thank you very Much.
it is useful to learn Inv .net for me
Tks again
-----
COMMENT:
AUTHOR: PBL
EMAIL: PaulBo.Luo@asc-csa.gc.ca
IP: 142.92.129.130
URL: 
DATE: 06/10/2010 02:24:18 PM
Hi Brian,

It will be a very useful tool for us, if I can get it run.  Could you give me more detail on how to "open the source within VB Express and compile it"?

Thanks.


-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.7
URL: http://blogs.autodesk.com/modthemachine
DATE: 06/10/2010 03:48:11 PM
To open and compile this in VB Express, just download and install Visual Basic 2008 Express.  You can get this at:

<a href="http://www.microsoft.com/express/Downloads/">http://www.microsoft.com/express/Downloads/</a>

There is also Visual Basic 2010 Express.  It should also work but I haven't spent much time with it yet so there are some unknowns.  To keep it simple I would stick with 2008 to get started.

Once that's installed and you've downloaded the sample program, just double-click on the iPropertiesPlus.sln file.  This will open up the program within Visual Studio.  Finally run the Build command from the Build menu.  This will create the add-in and also perform the required registration.  The next time you run Inventor you should see the new command in the ribbon.

-Brian
-----
COMMENT:
AUTHOR: nav
EMAIL: ntlsoft@gmail.com
IP: 78.105.168.177
URL: 
DATE: 06/21/2010 04:14:08 PM
Hi Brian
 nice work. can you please tell me how i can launch inventor iProperties dialog from my addin.
unable to find any info in API.
-----
COMMENT:
AUTHOR: Marcos
EMAIL: marcos.faustino@freeartseral.com.br
IP: 187.111.223.42
URL: 
DATE: 12/30/2010 12:50:07 PM
how to make this program compatible with Inventor 2011?

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Screenshot &ndash; The Plugin of the Month
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: screenshot-the-plugin-of-the-month
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/screenshot-the-plugin-of-the-month.html 
DATE: 02/10/2010 04:41:41 PM
-----
BODY:
<p>The team at Autodesk that supports members of the Autodesk Developer Network (ADN) has begun writing small utilities for the various Autodesk products and are making them available at Autodesk Labs.&#0160; This month introduces the first of these utilities for Inventor.&#0160; Itâ€™s a utility to capture screen shots and can be downloaded from <a href="http://labs.autodesk.com/utilities/inventor_screenshot/">here</a>.</p>
<p>Itâ€™s an Inventor add-in that was written by Xiaodong Liang and is based on an AutoCAD plugin that Kean Walmsley developed.&#0160; An installer for the utility is provided so you can begin using it now and the source code is also included so it can serve as a programming sample.&#0160; Itâ€™s compatible with Inventor 2008 and later.</p>
<p>Once installed youâ€™ll see a Screenshot panel on the Tools tab of the ribbon.&#0160; When you run the Screenshot command the dialog below is displayed, where you can set various options, control what you want to capture, and specify where you want the output.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287789a629970c-pi"><img alt="Screenshot" border="0" height="290" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287789a633970c-pi" style="display: inline; border: 0px;" title="Screenshot" width="454" /></a></p>
<p>Hereâ€™s an image of my latest at-home project that was captured using the utility.&#0160; You can see the Screenshot command in the ribbon.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a886fb97970b-pi"><img alt="VanityScreenshot" border="0" height="342" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287789a643970c-pi" style="display: inline; border: 0px;" title="VanityScreenshot" width="454" /></a></p>
<p>You should also keep an eye on the <a href="http://labs.autodesk.com/utilities/ADN_plugins/">Plugin of the Month page</a> as additional utilities are released and for an overview of the program.&#0160; Make sure to read the <strong>Help Us Out</strong> section at the bottom of the page to see how you can contribute.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Scott Sheppard
EMAIL: 
IP: 132.188.71.6
URL: http://profile.typepad.com/sheppards
DATE: 02/12/2010 05:44:54 PM
Thanks for helping to spread the word. We encourage Mod the Machine readers to give us feedback at labs.plugins@autodesk.com.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating a Skeletal Assembly Structure
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: creating-a-skeletal-assembly-structure
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/creating-a-skeletal-assembly-structure.html 
DATE: 02/05/2010 11:59:05 PM
-----
BODY:
<p>I wrote a program several months ago that I was reminded of when writing the post about <a href="http://modthemachine.typepad.com/my_weblog/2010/01/exporting-assembly-structure-to-excel.html">exporting an assembly structure to Excel</a>.&#160; This program does somewhat the opposite.&#160; It creates an assembly based on the structure defined by an input file. All parts and subassemblies are created by the program and assembled as defined by the input file. The parts are empty parts created using the default template file. You can optionally specify iProperty values for each assembly and part. You can then create the geometry for each of the parts to complete the assembly.&#160; </p>  <p>Iâ€™m not sure how many people will find this useful but thought I would make it available in case it can benefit someone.</p>  <p>I chose to use XML as the way of defining the assembly structure since it provides a better way to define structure than Excel.&#160; However, it would be fairly easy to convert this to use Excel or to write an Excel macro that would write out an Excel sheet into the required XML format.</p>  <p><strong>Using the Program      <br /></strong>To use the program execute BuildAssemblyStructure.exe, (typically by double-clicking on the program in Explorer). The dialog below is displayed. In the top field specify the xml file that defines the structure of the assembly you want to create. The lower field defines the path where the parts and assemblies will be created. Once the two fields are defined, click the Create Assembly button to start the creation of the assembly. Inventor must already be running.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a86815a7970b-pi"><img title="BuildAssemblyStructureDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="155" alt="BuildAssemblyStructureDialog" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340128776a6da7970c-pi" width="454" border="0" /></a> </p>  <p>After the program has completed running the defined assembly will be open in Inventor. None of the files will have been saved to disk yet. Saving the assembly will prompt you to save all of the related files too. Closing the assembly without saving will result in no files being created.</p>  <p><strong>XML Format      <br /></strong>If youâ€™ve never used XML before, donâ€™t worry about having to learn a new complicated language. Itâ€™s an ASCII file with a .xml extension that you can create using Notepad or any other ASCII editor youâ€™re familiar with and is just a standardized way of structuring data.&#160; Hereâ€™s a quick overview of XML.</p>  <p>An XML document contains one or more <em>elements</em>.&#160; Below is an example of an element.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;ElementName&gt;      <br />This is some text within the ElementName element.       <br />&lt;/ElementName&gt;</p> </div>  <p>The element consists of two <em>tags</em>, an opening tag which is the element name conntained within the less than (&lt;) and greater-than (&gt;) signs and a closing tag which is the same except there is a forward slash (/) in front of the element name.&#160; All elements must have an opening and closing tag.&#160; A common mistake is to forget the closing tag.</p>  <p>Elements can also have <em>attributes</em>, as shown in the example below:</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly.iam'&gt;</p> </div>  <p>The attribute is specified within the opening tag and in his example is called â€œFilenameâ€.&#160; It has a value of â€œAssembly.iamâ€ which is contained within single or double quotes.</p>  <p>Elements can also be nested as in the example below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly.iam'&gt;      <br />&#160;&#160;&#160; &lt;Assembly Filename=â€™SubAssembly.iamâ€™&gt;       <br />&#160;&#160;&#160; &lt;/Assembly&gt;       <br />&lt;/Assembly&gt;</p> </div>  <p>The nesting is defined by the fact that the second Assembly element is within the first Assembly element.&#160; The indenting of the lines doesnâ€™t define the nesting but makes it easier for humans to read and edit.</p>  <p>Thatâ€™s about all you need to know about XML to create a file to use with this program.&#160; Hereâ€™s an example of the format expected by this program.&#160; It describes the structure of the XML to create parts and assembly and also define any iProperties. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly01.iam'&gt;      <br />&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;Designer&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;Spock&lt;/Value&gt;       <br />&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;Assembly Filename='Assembly02.iam'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;Designer&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;Capt. Kirk&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Part Filename='Part01.ipt'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Part&gt;       <br />&#160;&#160;&#160; &lt;/Assembly&gt;       <br />&#160;&#160;&#160; &lt;Part Filename='Part01.ipt'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;/Part&gt;       <br />&lt;/Assembly&gt;</p> </div>  <p>The first line defines the opening tag of an Assembly element. This will be the top-level assembly document. There is a closing tag for the element at the bottom of the file.</p>  <p>The second line begins a Property element. This will define the values for any properties of the assembly. In this case there are two nested elements that will set the property called â€œDesignerâ€ to the value â€œSpockâ€. There is a closing tag for the property. Each property value defined is contained within its own Property element. This is demonstrated by the next set of lines that begins another Property element and sets the property named â€œDeliveryDateâ€ to have a value of Dec. 18, 2008.</p>  <p>The second property, DeliveryDate, has a Type element whereas the first property does not. This is because the first property set, â€œDesignerâ€, is a standard property and its type is defined by Inventor. The second property â€œDeliverDateâ€ is not a standard property so the program will create a custom property for it and set its type to be whatever is specified by this element. If the custom property already exists, the type value is ignored and the value is set using the specified value. The names of the standard iProperties are listed below.</p>  <p>The next element is another Assembly element. This will result in the creation of a subassembly. Within this Assembly element there is a Property element that will set a property value for this subassembly. There is also a Part element that will create a part within this assembly. The part also has a Property element to set a property within it.</p>  <p>Finally, there is another Part element that defines a part within the top-level assembly. There is no limit to number of the parts or assemblies that can be defined or the number of levels of subassemblies.</p>  <p><b>Standard Properties      <br /></b>The following are the names and types of the standard iProperties that can be set. If you specify any other name besides these a custom property will be created.</p>  <blockquote>   <p>Title, String      <br />Subject, String       <br />Author, String       <br />Keywords, String       <br />Comments, String       <br />Revision Number, String       <br />Category, String       <br />Manager, String       <br />Company, String       <br />Creation Time, String       <br />Part Number, String       <br />Project, String       <br />Cost Center, String       <br />Checked By, String       <br />Date Checked, String       <br />Engr Approved By, String       <br />Engr Date Approved, Date       <br />User Status, String       <br />Catalog Web Link, String       <br />Description, String       <br />Vendor, String       <br />Mfg Approved By, String       <br />Mfg Date Approved, Date       <br />Cost, Currency       <br />Designer, String       <br />Engineer, String       <br />Authority, String       <br />Standard Revision, String       <br />Stock Number, String</p> </blockquote>  <p>You can download the program and source code here.&#160; Feel free to use and modify it to fit your specific needs. It was written using Visual Basic 2008 Express and is compatible with Inventor 2009 and later.</p>  <p><a href="http://modthemachine.typepad.com/files/BuildAssemblyStructure.zip">Assembly Structure Program</a>     <br /><a href="http://modthemachine.typepad.com/files/BuildAssemblyStructureSource.zip">Assembly Structure Source</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jan Klc
EMAIL: johan826@gmail.com
IP: 95.102.76.156
URL: 
DATE: 02/08/2010 09:36:24 PM
Hi Brain,
I'm student from Slovakia. I started learning Inventor and VBA. I use inventor 2008. I have problem with property "visible" in my macro. His function is modify parameters in assembly document. I need know set "visible"(False or True)some part or parts in assembly document by macro. I worked any problems, but this stoped me.
Can you help me, please?
Sorry my English.
Than you.
Jano
-----
COMMENT:
AUTHOR: Cartus canon
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:52:06 AM
The second line begins with an element of the Property. This will define the values of the properties of the assembly. 
-----
COMMENT:
AUTHOR: Erwin Lindeboom
EMAIL: e.lineboom@polem.nl
IP: 195.73.172.58
URL: http://www.polem.nl
DATE: 03/17/2011 08:43:43 AM
Hi Brian,

Can this code/program also be used to push predefined iproperties from a xml file to a existing inventor file? We have a great deal of standard iproperties we would like to push, rather to edit manually in every part/assembly.

Greetings,
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Custom iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 1
BASENAME: custom-iproperties
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties.html 
DATE: 02/04/2010 12:10:05 AM
-----
BODY:
<P>Following up from the <A href="http://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html">previous post about iProperties</A>, I want to discuss how to work with custom iProperties.&nbsp; In the user-interface you access custom properties using the â€œCustomâ€ tab of the iProperties dialog, as shown below.</P>
<P><A href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fd5970b-pi"><img title=CustomiProperties style="BORDER-TOP-WIDTH: 0px; DISPLAY: block; BORDER-LEFT-WIDTH: 0px; FLOAT: none; BORDER-BOTTOM-WIDTH: 0px; MARGIN-LEFT: auto; MARGIN-RIGHT: auto; BORDER-RIGHT-WIDTH: 0px" height=473 alt=CustomiProperties src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fdc970b-pi" width=456 border=0 /></A>&nbsp;</P>
<P>Custom iProperties are accessed the same as other iProperties.&nbsp; Itâ€™s just that there is a specific property set that contains them.&nbsp; The property set is called:</P>
<blockquote>
<P>â€œInventor User Defined Propertiesâ€</p>

</blockquote>
<P><font size=3><strong><font size=2>Getting iProperty Values</font> <br></strong></font>The name of the property is the name that was assigned when it was created.&nbsp; You use the name to access a specific property.&nbsp; The sample VBA code below illustrates getting the custom property named â€œSample1â€ and displaying its value.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P>Public Sub GetCustomiProperty() <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim doc As Document <br>&nbsp;&nbsp;&nbsp; Set doc = ThisApplication.ActiveDocument <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = doc.PropertySets.Item( _ <br>							&nbsp;&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the property named "Sample1". <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customProp As Property <br>&nbsp;&nbsp;&nbsp; Set customProp = customPropSet.Item("Sample1") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Display the value of the iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; MsgBox "Sample1 = " &amp; customProp.Value <br>End Sub</P></DIV>
<P>This results in displaying the dialog shown below.</P>
<P><A href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fe3970b-pi"><img title=CustomiPropertyValue style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=104 alt=CustomiPropertyValue src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fe7970b-pi" width=184 border=0 /></A> </P>
<P><strong>Setting iProperty Values</strong> <br>In the example above the Value property of the Property object is used to get the current value of the iProperty.&nbsp; You can also set the value of the iProperty using the Value property as demonstrated in the code below.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Set the value of the property.</strong></font> <br>&nbsp;&nbsp;&nbsp; customProp.Value = "Here's a new value." </P></DIV>
<P>When setting the value of an iProperty you are also controlling the property type (Text, Number, Date, or Yes/No).&nbsp; This is implicitly defined by the type of the value you assign to the property.&nbsp; If the value is a String then the property will be a Text property type.&nbsp; If you assign any number type (Integer, Long, Double, etc.) then the result will be a Number property type.&nbsp; If you assign a Date type then the result will be a Date property type.&nbsp; Finally, if you assign a Boolean type then the result will be a Yes/No property type.&nbsp; This also applies when creating iProperties and is demonstrated in the section below.</P>
<P><strong>Creating Custom iProperties</strong> <br>Another difference between custom iProperties and the standard iProperties is that you can create new ones and delete existing ones.&nbsp; For the standard iProperties youâ€™re limited to only getting and setting their values.&nbsp; To create a new iProperty you use the Add method of the PropertySet object.&nbsp; It has three arguments, the value, the name, and the ID.&nbsp; Besides its name, the ID is another way to identify a specific iProperty.&nbsp; This argument is optional and Inventor will automatically assign an ID if you donâ€™t provide one, which is what I always do.</P>
<P>The sample VBA code below demonstrates creating several new iProperties.&nbsp; The type of iProperty created (Text, Number, Date, or Yes/No) is implicitly defined by the type of the value you supply.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P>Public Sub CreateCustomiProperty() <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim doc As Document <br>&nbsp;&nbsp;&nbsp; Set doc = ThisApplication.ActiveDocument <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = doc.PropertySets.Item( _ <br>							&nbsp;&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new text property.&nbsp; <br></strong></font>&nbsp;&nbsp;&nbsp; Dim textValue As String <br>&nbsp;&nbsp;&nbsp; textValue = "Here's some text." <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(textValue, "TextProp") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new number property. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim numberValue As Double <br>&nbsp;&nbsp;&nbsp; numberValue = 3.14159265358979 <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(numberValue, "Pi") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new date property. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim dateValue As Date <br>&nbsp;&nbsp;&nbsp; dateValue = Now <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(dateValue, "Right Now") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new boolean property. <br></strong></font>&nbsp;&nbsp;&nbsp; yesNoValue As Boolean <br>&nbsp;&nbsp;&nbsp; yesNoValue = True <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(yesNoValue, "Chocolate is good") <br>End Sub</P></DIV>
<P><strong>Creating or Updating Custom iProperties</strong> <br>If you run the above sample code twice, it will fail the second time.&nbsp; Thatâ€™s because itâ€™s attempting to create iProperties with names that already exist.&nbsp; Each iProperty must have a unique name with respect to other iProperties in that property set.&nbsp; A common workflow is to update the value of an iProperty, but if it doesnâ€™t exist to create it.&nbsp; The VBA sample code below demonstrates a function that does this.&nbsp; It relies on error handling to determine if an iProperty already exists.&nbsp; If it exists it updates its value.&nbsp; If it doesnâ€™t exist then it creates it.&nbsp; Below this sample Iâ€™ve also listed VB.Net, and C# samples since there are differences in syntax and error handling, even though they all make the same Inventor API calls.</P><strong>VBA</strong> 
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub TestiPropertyUpdate() <br>&nbsp;<font color=#0000ff><strong>&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim Doc As Document <br>&nbsp;&nbsp;&nbsp; Set Doc = ThisApplication.ActiveDocument <br><br>
<P></P>
<P><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; Call UpdateCustomiProperty(Doc, "Test", "Some Text") <br>End Sub <br><br><br><br>Public Sub UpdateCustomiProperty(ByRef Doc As Document, _ <br>								 ByRef PropertyName As String, _ <br>								 ByRef PropertyValue As Variant) <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = Doc.PropertySets.Item( _ <br>							&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim prop As Property <br>&nbsp;&nbsp;&nbsp; On Error Resume Next <br>&nbsp;&nbsp;&nbsp; Set prop = customPropSet.Item(PropertyName) <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Check to see if the above call failed.&nbsp; If it failed <br>&nbsp;&nbsp;&nbsp; ' then the property doesn't exist. <br></strong></font>&nbsp;&nbsp;&nbsp; If Err.Number &lt;&gt; 0 Then <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; Set prop = customPropSet.Add(PropertyValue, PropertyName) <br>&nbsp;&nbsp;&nbsp; Else <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue <br>&nbsp;&nbsp;&nbsp; End If <br>End Sub</P></DIV>
<br>
<P><strong>VB.Net</strong> <br></P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Private Sub TestiPropertyUpdate() </DIV>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new"><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Connect to a running instance of Inventor. <br>&nbsp;&nbsp;&nbsp; ' Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim invApp As Inventor.Application <br>&nbsp;&nbsp;&nbsp; invApp = System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application")&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim Doc As Inventor.Document <br>&nbsp;&nbsp;&nbsp; Doc = invApp.ActiveDocument&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; UpdateCustomiProperty(Doc, "Test", "Some Text") <br>End Sub <br><br><br><br>Private Sub UpdateCustomiProperty(ByRef Doc As Inventor.Document, _ <br>								 ByRef PropertyName As String, _ <br>								 ByRef PropertyValue As Object) <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As Inventor.PropertySet <br>&nbsp;&nbsp;&nbsp; customPropSet = Doc.PropertySets.Item( _ <br>							&nbsp;&nbsp; "Inventor User Defined Properties")&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim prop As Inventor.Property = Nothing <br>&nbsp;&nbsp;&nbsp; Dim propExists As Boolean = True <br>&nbsp;&nbsp;&nbsp; Try <br>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Item(PropertyName) <br>&nbsp;&nbsp;&nbsp; Catch ex As Exception <br>	&nbsp;&nbsp;&nbsp; propExists = False <br>&nbsp;&nbsp;&nbsp; End Try&nbsp; <br><br>&nbsp;&nbsp;&nbsp; ' Check to see if the property was successfully obtained. <br>&nbsp;&nbsp;&nbsp; If Not propExists Then <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Add(PropertyValue, PropertyName) <br>&nbsp;&nbsp;&nbsp; Else <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue <br>&nbsp;&nbsp;&nbsp; End If <br>End Sub</DIV>
<br><strong>C#</strong> 
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">private void TestiPropertyUpdate() <br>{ <br>&nbsp;&nbsp;&nbsp; // Connect to a running instance of Inventor. <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Application invApp = null; <br>&nbsp;&nbsp;&nbsp; invApp = (Inventor.Application)System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application");&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Document doc = invApp.ActiveDocument;&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; UpdateCustomiProperty(doc, "Test2", "Some updated text."); <br>} 
<P>private void UpdateCustomiProperty(Inventor.Document Doc, <br>								&nbsp;&nbsp; String PropertyName, <br>								&nbsp;&nbsp; Object PropertyValue) <br>{ <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the custom property set.&nbsp; <br></strong></font><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.PropertySet customPropSet; <br>&nbsp;&nbsp;&nbsp; customPropSet = Doc.PropertySets["Inventor User Defined Properties"];&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Property prop = null; <br>&nbsp;&nbsp;&nbsp; Boolean propExists = true; <br>&nbsp;&nbsp;&nbsp; try <br>&nbsp;&nbsp;&nbsp; { <br>	&nbsp;&nbsp;&nbsp; prop = customPropSet[PropertyName]; <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; catch (Exception ex) <br>&nbsp;&nbsp;&nbsp; { <br>	&nbsp;&nbsp;&nbsp; propExists = false; <br>&nbsp;&nbsp;&nbsp; }&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Check to see if the property was successfully obtained. <br></strong></font>&nbsp;&nbsp;&nbsp; if (!propExists) <br>&nbsp;&nbsp;&nbsp; { <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; // Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Add(PropertyValue, PropertyName, null); <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; else <br>&nbsp;&nbsp;&nbsp; { <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; // Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue; <br>&nbsp;&nbsp;&nbsp; } <br>}</P></DIV>
<P><strong></strong></P>
<P><strong>Deleting iProperties</strong> <br>To delete an iProperty you just call the Delete method of the Property object.</P>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: chris
EMAIL: chris@merlinmfgusa.com
IP: 71.182.101.243
URL: 
DATE: 02/10/2010 04:56:15 PM
What would be the procedure for setting up pull down list (for Finish data or special Material call outs) in Custom properties from a template.
-----
COMMENT:
AUTHOR: Nikola
EMAIL: brradako@net.hr
IP: 95.178.235.181
URL: 
DATE: 04/13/2010 12:43:52 AM
Dear Mr. Ekins ,

I would like to ask you a question.
As you are an expert I am sure you will be able to answer my beginner's question.
May post you a question here or on your e-mail.

Kind regards,
Nikola Radakovic
-----
COMMENT:
AUTHOR: Rick Nelson
EMAIL: rick.nelson.ext@canberra.com
IP: 160.84.254.241
URL: 
DATE: 08/10/2010 01:31:43 PM
I seem to have lost your email address.

I have some questions about accessing the Manufacturer iproperty in Inventor and exploiting it in vault.  

I have been able to set it in vault using code you supplied (thanks) but on the Vault 2011 property Manufacturer is illusive.  Sometimes the field is available sometimes not.  It never populates.

I created an ipt and set the Vendor and Manufacturer iprops using a mild hack on your excel > ipt program.  

Frankly, I don't understand, nor can I examine the schema in Vault.  I've tried mapping and category settings without joy.
-----
COMMENT:
AUTHOR: Simon Spence
EMAIL: S.Spence@clicknetherfield.com
IP: 84.19.243.226
URL: http://www.clicknetherfield.com
DATE: 08/16/2010 04:34:37 PM
Hello,
Is it possible to have the 'type' default set to number instead of text? I ask this because when pulling dimensions from the parameters they come with their unit string (mm) and our management system wont accept them with this.

Thanks

Simon 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Accessing iProperties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: accessing-iproperties
CATEGORY: Brian
CATEGORY: iProperties

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html 
DATE: 02/02/2010 02:14:07 AM
-----
BODY:
<p>Probably the most used area of Inventorâ€™s API is iProperties and because of that it generates more questions than any other single area.&#160; I wanted to try and eliminate some of those questions by giving a brief overview of how to access iProperties that I hope will answer most questions.&#160; Because iProperties is relatively simple itâ€™s also a very good introduction to Inventorâ€™s API.&#160; In the example below weâ€™ll look at what it takes to edit the value of the Part Number property.</p>  <p><font size="3"><strong>iProperty Object Model</strong>       <br /></font>When working with Inventorâ€™s API you need to be aware of the <em>Object Model</em>.&#160; The object model describes the relationship between the various API objects and is used to understand how to gain access to a particular object.&#160; Inventorâ€™s entire object model is quite large and can be a bit overwhelming, which can be seen below.&#160; (Click the picture to access the pdf file of the entire chart.)</p>  <p><a href="http://modthemachine.typepad.com/files/Inventor2010Model.pdf"><img title="FullObjectModel" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="295" alt="FullObjectModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287747df64970c-pi" width="454" border="0" /></a> </p>  <p>However, when programming with Inventor you donâ€™t need to understand the entire object model, but just the portion of the model that youâ€™re currently using.&#160; When working with iProperties youâ€™ll be using a maximum of only six different objects.&#160; A simplified version of the object model for these six objects is shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846027e970b-pi"><img title="iPropertiesObjectModel" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="166" alt="iPropertiesObjectModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287747df6e970c-pi" width="160" border="0" /></a> </p>  <p>The Application object is the top-level object and represents Inventor.&#160; From it you can get the Documents object which provides the ability to access any open documents and also to open documents and create new documents.&#160; The Document object represents any of the various Inventor documents, i.e. part, assembly, drawing, etc.&#160; From the object model chart we learn that the PropertySets object is accessed from a document.&#160; This implies that properties are owned by a document and each document has its own unique set.</p>  <p><font size="3"><strong>Accessing a Document        <br /></strong></font>There are several ways to access a specific document but for this example Iâ€™ll keep it simple by accessing the document thatâ€™s currently open for edit.&#160; This is also the most common way of accessing a document.&#160; You do this by using the ActiveDocument property of the Application object.&#160; Looking at the object model chart above, using this property takes you from the Application object and jumps directly to the Document object, bypassing the Documents object.&#160; The code for this is shown below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the active document.</strong></font>       <br />&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />End Sub</p> </div>  <p><font size="3"><strong>Accessing iProperties</strong></font>     <br />From each document you can access its associated iProperties.&#160; iProperties are organized in groups and the API provides access to these groups.&#160; The first iProperty related object is the PropertySets object.&#160; You can think of the PropertySets object as the equivalent to the iProperties dialog.&#160; Itâ€™s the top level that provides access to all iProperty information.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8460285970b-pi"><img title="PropertySets" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="359" alt="PropertySets" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8460289970b-pi" width="450" border="0" /></a> </p>  <p>The code below shows how to get the PropertySets object.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />End Sub</p> </div>  <p>The next object in the object model is the PropertySet object.&#160; You can think of this object as being equivalent to a tab in the iProperties dialog.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846028f970b-pi"><img title="PropertySet" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="357" alt="PropertySet" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8460294970b-pi" width="450" border="0" /></a> </p>  <p>Thereâ€™s a little more to worry about when accessing the PropertySet object because you have to specify which of the existing PropertySet objects you want.&#160; There are a few different ways to do this but I would recommend using the name of the PropertySet.&#160; This makes your code easier to read later.&#160; The names of the standard property sets are:</p>  <blockquote>   <p>Inventor Document Summary Information      <br />Inventor Summary Information       <br />Design Tracking Properties       <br />Inventor User Defined Properties</p> </blockquote>  <p>For this sample I want to get the value of the Part Number property.&#160; This is in the â€œDesign Tracking Propertiesâ€ property set (as determined by looking at the chart at the end of this post).&#160; The code below illustrates getting this property set by name.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />End Sub</p> </div>  <p>The next object is the Property object.&#160; This represents a specific property, as illustrated below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846029e970b-pi"><img title="Property" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="358" alt="Property" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287747df88970c-pi" width="450" border="0" /></a> </p>  <p>Properties are also identified by name.&#160; The code below demonstrates accessing the part number property.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />End Sub</p> </div>  <p>Once you have a Property object you can use its Value property to get its current value and to also set the value is you want to change the iProperty.&#160; The code below displays the part number of the active document in a message box.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Display the value.          <br /></strong></font>&#160;&#160;&#160; MsgBox &quot;The part number is: &quot; &amp; oPartNumiProp.Value       <br />End Sub</p> </div>  <p>This code changes the value of the part number property.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub SetiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the part number.          <br /></strong></font>&#160;&#160;&#160; oPartNumiProp.Value = &quot;SamplePart001&quot;       <br />End Sub</p> </div>  <p>Accessing an iProperty is simply of a matter of navigating down the object model to get to a specific Property object.&#160; The tricky parts is knowing which property set the property you want is located in, and knowing the name of that property set and the name of the property.&#160; The table below lists all of the standard property sets and the names of the properties they contain.&#160; This should provide all you need to access existing properties.&#160; In addition to the names, the chart also lists the type of each property.&#160; This is important when setting the value of a property so you know what type is expected.</p>  <table border="black"><tbody>     <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor Summary Information</b> </td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Author</td>        <td>String</td>     </tr>      <tr>       <td>Comments</td>        <td>String</td>     </tr>      <tr>       <td>Keywords</td>        <td>String</td>     </tr>      <tr>       <td>Last Saved By</td>        <td>String</td>     </tr>      <tr>       <td>Thumbnail</td>        <td>IPictureDisp</td>     </tr>      <tr>       <td>Revision Number</td>        <td>String</td>     </tr>      <tr>       <td>Subject</td>        <td>String</td>     </tr>      <tr>       <td>Title</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor Document Summary Information</b></td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Category</td>        <td>String</td>     </tr>      <tr>       <td>Company</td>        <td>String</td>     </tr>      <tr>       <td>Manager</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Design Tracking Properties</b></td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Authority</td>        <td>String</td>     </tr>      <tr>       <td>Catalog Web Link</td>        <td>String</td>     </tr>      <tr>       <td>Categories</td>        <td>String</td>     </tr>      <tr>       <td>Checked By</td>        <td>String</td>     </tr>      <tr>       <td>Cost</td>        <td>Currency</td>     </tr>      <tr>       <td>Cost Center</td>        <td>String</td>     </tr>      <tr>       <td>Creation Time</td>        <td>Date</td>     </tr>      <tr>       <td>Date Checked</td>        <td>Date</td>     </tr>      <tr>       <td>Defer Updates</td>        <td>Boolean</td>     </tr>      <tr>       <td>Description</td>        <td>String</td>     </tr>      <tr>       <td>Design Status</td>        <td>Long</td>     </tr>      <tr>       <td>Designer</td>        <td>String</td>     </tr>      <tr>       <td>Document SubType</td>        <td>String</td>     </tr>      <tr>       <td>Document SubType Name</td>        <td>String</td>     </tr>      <tr>       <td>Engineer</td>        <td>String</td>     </tr>      <tr>       <td>Engr Approved By</td>        <td>String</td>     </tr>      <tr>       <td>Engr Date Approved</td>        <td>Date</td>     </tr>      <tr>       <td>External Property Revision Id</td>        <td>String</td>     </tr>      <tr>       <td>Language</td>        <td>String</td>     </tr>      <tr>       <td>Manufacturer</td>        <td>String</td>     </tr>      <tr>       <td>Material</td>        <td>String</td>     </tr>      <tr>       <td>Mfg Approved By</td>        <td>String</td>     </tr>      <tr>       <td>Mfg Date Approved</td>        <td>Date</td>     </tr>      <tr>       <td>Parameterized Template</td>        <td>Boolean</td>     </tr>      <tr>       <td>Part Icon</td>        <td>IPictureDisp</td>     </tr>      <tr>       <td>Part Number</td>        <td>String</td>     </tr>      <tr>       <td>Part Property Revision Id</td>        <td>String</td>     </tr>      <tr>       <td>Project</td>        <td>String</td>     </tr>      <tr>       <td>Proxy Refresh Date</td>        <td>Date</td>     </tr>      <tr>       <td>Size Designation</td>        <td>String</td>     </tr>      <tr>       <td>Standard</td>        <td>String</td>     </tr>      <tr>       <td>Standard Revision</td>        <td>String</td>     </tr>      <tr>       <td>Standards Organization</td>        <td>String</td>     </tr>      <tr>       <td>Stock Number</td>        <td>String</td>     </tr>      <tr>       <td>Template Row</td>        <td>String</td>     </tr>      <tr>       <td>User Status</td>        <td>String</td>     </tr>      <tr>       <td>Vendor</td>        <td>String</td>     </tr>      <tr>       <td>Weld Material</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor User Defined Properties</b></td>     </tr>   </tbody></table>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Brad Johnson
EMAIL: brjjohnson@dstoutput.com
IP: 165.79.13.192
URL: 
DATE: 10/06/2010 10:30:10 PM
When I run the following code in VB6 
Private Sub Form_Load()
    Call GetActiveDocument
End Sub
Public Sub GetActiveDocument()
 ' Get the active document.
 Dim oDoc As Document
 Set oDoc = ThisApplication.ActiveDocument
 MsgBox "Got " & oDoc.FullFileName
End Sub
'
I get the following error
Run-time error '429':
ActiveX component can't create object
Can you tell me why?
-----
COMMENT:
AUTHOR: Tommy Rosberg
EMAIL: tommy.rosberg@avaloninnovation.com
IP: 90.230.249.164
URL: 
DATE: 08/29/2011 11:01:46 AM
A quick question:
I can see in the table that some iProperty categories have the word 'Inventor' added to their name. The category earlier called 'Summary Information' is now called 'Inventor Summary Information'. Have I understood this correct?

Best regards,
Tommy Rosberg
Avalon PLM AB
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Exporting Assembly Structure to Excel
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: exporting-assembly-structure-to-excel
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/01/exporting-assembly-structure-to-excel.html 
DATE: 01/28/2010 07:59:03 PM
-----
BODY:
<p>There was a recent question in the newsgroup about exporting the structure of an assembly to an Excel spreadsheet.&#160; Iâ€™ve written a small VBA program that does this.&#160; When executed it will prompt for a filename and then write the structure of the currently open assembly to the file.&#160; The file created is a CSV file, which can be opened directly by Excel.&#160; For each occurrence in the assembly it writes one row, with the first column containing the name of the occurrence as seen in the browser, and the second column containing the full filename of the part or assembly represented by that occurrence.&#160; The data is written such that the structure of the assembly is preserved, which can be seen below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340128772191fb970c-pi"><img title="AssemblyStructureExcel" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="298" alt="AssemblyStructureExcel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a81ed10b970b-pi" width="454" border="0" /></a> </p>  <p>Itâ€™s likely everyone using this will want different information or a different format for the output.&#160; This is a good time to get your feet wet and learn a little bit about programming Inventor so you can make the small changes to have it write out the information you want.</p>  <p>For those of you unfamiliar with VBA here are the steps to using this program:</p>  <ol>   <li>Open the VBA editor within Inventor (Alt-F11 or Tools â€“&gt; VBA Editor).&#160; </li>    <li>In the project tree, find the project named <strong>ApplicationProject</strong> </li>    <li>Expand the <strong>Modules</strong> folder. </li>    <li>Double click on the module named <strong>Module1</strong>.&#160; This should open up the code window. </li>    <li>Copy and paste the code below into the code window.&#160; If thereâ€™s some code already there, paste it at the bottom of any existing code.&#160; The result is shown below. </li> </ol>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401287721920c970c-pi"><img title="Paste code into VBA" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="278" alt="Paste code into VBA" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a81ed116970b-pi" width="454" border="0" /></a> </p>  <p>Once pasted, you can run the program.&#160; This <a href="http://modthemachine.typepad.com/my_weblog/visual-basic-for-applications-vba/">posting</a> describes a few ways to do that.</p>  <p>Hereâ€™s the code to copy and paste:</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub WriteAssemblyStructure()     <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check that an assembly is open.         <br /></strong></font>&#160;&#160;&#160; Dim asmDoc As AssemblyDocument      <br />&#160;&#160;&#160; Dim docType As DocumentTypeEnum      <br />&#160;&#160;&#160; docType = ThisApplication.ActiveDocumentType      <br />&#160;&#160;&#160; If docType &lt;&gt; kAssemblyDocumentObject Then      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;An assembly must be active.&quot;      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub      <br />&#160;&#160;&#160; Else      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set asmDoc = ThisApplication.ActiveDocument      <br />&#160;&#160;&#160; End If      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the name of the file to create.          <br /></strong></font>&#160;&#160;&#160; Dim csvFilename As String       <br />&#160;&#160;&#160; Dim saveDialog As FileDialog       <br />&#160;&#160;&#160; Call ThisApplication.CreateFileDialog(saveDialog)       <br />&#160;&#160;&#160; With saveDialog       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Filter = &quot;CSV (Command delimited)(*.csv)|*.csv&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DialogTitle = &quot;Specify output filename&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .OptionsEnabled = False       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .SuppressResolutionWarnings = True       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .ShowSave      <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If .FileName = &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; csvFilename = .FileName       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; End With      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Open the file.          <br /></strong></font>&#160;&#160;&#160; Dim FilePointer As Integer       <br />&#160;&#160;&#160; FilePointer = FreeFile       <br />&#160;&#160;&#160; Open csvFilename For Output As #FilePointer       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Write the top-level assembly name.          <br /></strong></font>&#160;&#160;&#160; Print #FilePointer, asmDoc.DisplayName &amp; &quot;,&quot; &amp; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; asmDoc.FullFileName      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Read through the assembly and write the structure out.          <br /></strong></font>&#160;&#160;&#160; Call WriteStructure(asmDoc.ComponentDefinition.occurrences, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1, FilePointer)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Close the file.&#160; <br /></strong></font>&#160;&#160;&#160; Close #FilePointer      <br />       <br />&#160;&#160;&#160; MsgBox &quot;Completed writing assembly structure to: &quot; &amp; csvFilename       <br />End Sub      <br />      <br />      <br />      <br />Private Sub WriteStructure( _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal occurrences As ComponentOccurrences, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal Level As Integer, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal FilePointer As Integer)      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through the occurrences in the current level.          <br /></strong></font>&#160;&#160;&#160; Dim occ As ComponentOccurrence       <br />&#160;&#160;&#160; For Each occ In occurrences       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Write information for this occurrence to the file.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Print #FilePointer, String$(Level, &quot;,&quot;) &amp; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; occ.Name &amp; &quot;,&quot; &amp; occ.Definition.Document.FullFileName      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' If this occurrence is a subassembly iterate          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' over its occurrences.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; If occ.DefinitionDocumentType = kAssemblyDocumentObject Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call WriteStructure(occ.SubOccurrences, Level + 1, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FilePointer)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Next       <br />End Sub</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Richard Persson
EMAIL: rillepersson@hotmail.com
IP: 94.255.243.124
URL: 
DATE: 01/29/2010 06:14:45 PM
Its just the way I want it in: <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340128772191fb970c-pi">http://modthemachine.typepad.com/.a/6a00e553fcbfc688340128772191fb970c-pi</a>

when I do as you say i get all information in the first column in excel? What am i doing wrong?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Upgrading your Add-Ins to Support the Ribbon User Interface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: upgrading-your-add-ins-to-support-the-ribbon-user-interface
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/01/upgrading-your-add-ins-to-support-the-ribbon-user-interface.html 
DATE: 01/25/2010 11:15:26 PM
-----
BODY:
<p>I thought I should share some more of the work that was done for the last Autodesk University.&#160; This class covered how to upgrade your add-in to use the ribbon user interface.&#160; It was one of the new virtual classes and the video is available.&#160; However, the paper contains all of the information in the video plus some additional material that I didnâ€™t have time for in the video.</p>  <p>The paper answers the following questions:</p>  <ol>   <li>From a userâ€™s perspective, what is the ribbon user interface?</li>    <li>Can my VBA macros work with the ribbon?</li>    <li>Will my existing add-ins work with the ribbon?</li>    <li>How does the API support the ribbon?</li>    <li>What do I need to consider when adding my buttons to the ribbon?</li>    <li>What do I do about the classic interface?</li> </ol>  <p>Below are links to the paper and some sample programs.</p>  <p><a href="http://modthemachine.typepad.com/files/Upgrading%20to%20Ribbon.pdf">Paper</a>    <br /><a href="http://modthemachine.typepad.com/files/Upgrading%20to%20Ribbon%20Samples.zip">Sample Programs</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Bobby Salazar
EMAIL: rsalazar@fwsgroup.com
IP: 64.4.80.91
URL: 
DATE: 02/08/2010 07:24:33 PM
Just a inquiry, we have this file extensions (.nwf & .nwc) can we open it in Inventor Programs or do we need to install another sofware to view or edit the said file. or can we do Inventor 3d modeling base on this file extensions. / or can we open and save the file to a different file extensions? Preferablt in invertor Programs.

Please advice.

Thanks,

Bobby Salazar
-----
COMMENT:
AUTHOR: Tomas Nissila
EMAIL: tomas.nissila@gmail.com
IP: 93.106.58.55
URL: 
DATE: 07/05/2010 08:51:30 AM
Hello!

There was a good information to make one button to the fileBrowser.

Is it possible to programm header and many buttons on it to the fileBrowser? I mean just like: 

Manage: Projects, Migrate, ... (many buttons).

I tried to do it on some ways. One is below:

---
Dim fileControl As CommandControl = UIManager.FileBrowserControl
            Dim ManagCombo As CommandControl = _
                fileControl.AddPopup(m_Manag, m_Projec, , , "AppiPropertiesWrapperCmd")
            ManagCombo.AddButton(m_Projec)
---

Thank you for your any help,
-Tomas N
-----
COMMENT:
AUTHOR: Mike V
EMAIL: mikev@odg.com
IP: 216.16.227.118
URL: 
DATE: 09/30/2010 09:02:38 PM
Have things changed much for 2011?  If so, could you update the sample files?

Very helpful information!
Thanks, 

Mike V.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: How to Write an Inventor Add-In
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: how-to-write-an-inventor-add-in
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2010/01/how-to-write-an-inventor-add-in.html 
DATE: 01/22/2010 11:07:51 PM
-----
BODY:
<p>Iâ€™ve posted similar material previously but this is more complete and up to date.&#160; The attached paper and code is from a presentation at this past Autodesk University.&#160; I believe the paper can be used by itself and is not dependent on you having been at the presentation.&#160; The primary focus is on someone thatâ€™s now using VBA and would like to move to add-ins, although it will also serve as a good general introduction for anyone that wants to learn more about add-ins.</p>  <p>The paper tries to answer the following questions:</p>  <ol>   <li>What is an Add-In?</li>    <li>Why would you want to create an Add-In?</li>    <li>How do you create an Add-In?</li>    <li>How do you convert your VBA macros?</li>    <li>How do you execute an Add-In command?</li>    <li>How do you debug an Add-In?</li>    <li>How do you deploy an Add-In?</li> </ol>  <p>The languages used are VB Express 2008 and Visual Basic from Visual Studio 2008.&#160; It also covers the differences youâ€™ll run into between VBA and VB.Net.</p>  <p><a href="http://modthemachine.typepad.com/files/VBAtoAddIn.pdf">Paper</a>    <br /><a href="http://modthemachine.typepad.com/files/VBA%20to%20Add-In.zip">Sample Files</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tomas Nissila
EMAIL: tomas.nissila@gmail.com
IP: 93.106.33.54
URL: 
DATE: 02/24/2010 01:50:18 PM
Hello!

What about the debugging? I tried to debug using Visual Basic 2008 Express and Inventor 2010. Then appeared next message:

---
A project with an Output Type of Class Library cannot be started directly.

In order to debug this project, add an executable project to this solution which references the library project. Set the executable project as the startup project.
---

Does it take extra operations/code trics to get to debug with Inventor process? I tried with one kind of them, but I got same problem message.

-TomasN
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 132.188.71.5
URL: http://blogs.autodesk.com/modthemachine
DATE: 02/24/2010 03:28:49 PM
You can debug an add-in using the steps described in the paper beginning on page 20.
-----
COMMENT:
AUTHOR: Yves Gingras
EMAIL: ygingras@ventrol.com
IP: 174.90.83.58
URL: http://www.ventrol.com/
DATE: 01/07/2011 06:35:53 PM
Hi Brian

Thanks for this guided introduction to the creation of an Inventor AddIn.

Everything works fine for me but the registration. I cannot get the addin to load in every release of inventor on my workstation, neither on my colleagueâ€™s.

I you have a minute, could you take a look at a posting on the topic â€œAddIn; loads only in one Inventor releaseâ€ in â€œInventor Customizationâ€, at Autodesk Discussion Groups? Iâ€™ve put a few facts concerning this matter.
 
If you ever think of something I could try, your help would be greatly appreciated.

Thanks in advance.

Yves
-----
COMMENT:
AUTHOR: Tiago BrandÃ£o
EMAIL: tiagofbrandao@gmail.com
IP: 94.132.214.173
URL: 
DATE: 09/18/2011 11:57:57 AM
Hi i tried to build as in the the paper but the add-in doesnt appear on the list, i am using inventor 2011 and visual basic 2008 express.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: AU Virtual Update (Free for ADN members)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-virtual-update-free-for-adn-members
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/11/au-virtual-update-free-for-adn-members.html 
DATE: 11/30/2009 12:52:59 AM
-----
BODY:
<p>Here are a couple of updates regarding Autodesk University Virtual.&#0160; First, Kean Walmsley has just announced that <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=723353">Autodesk Developer Network (ADN)</a> members will receive a <strong><a href="http://through-the-interface.typepad.com/through_the_interface/2009/11/breaking-news-adn-members-can-attend-au-virtual-for-free.html">free Premier Pass</a></strong> for AU Virtual (normally worth $99).</p>
<p>Second, Lynn Allen has put together a video showing you what using AU Virtual will be like.&#0160; <a href="http://www.youtube.com/watch?v=V6FngK_xiEs">http://www.youtube.com/watch?v=V6FngK_xiEs</a></p>
<p>I have one AUv session that will be broadcast twice that discusses <a href="http://au.autodesk.com/?nd=virtual_class_listing&amp;date_filter=&amp;industry_filter=&amp;speaker_filter=105591">upgrading your existing add-ins to use the new ribbon interface</a>.&#0160; I hope you can join me.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: You Can Attend Autodesk University
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: you-can-attend-autodesk-university
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/11/you-can-attend-autodesk-university.html 
DATE: 11/19/2009 05:50:43 PM
-----
BODY:
<p>Have you ever wanted to go to Autodesk University (AU)?&#0160; Itâ€™s an annual event, usually in Las Vegas, where you can attend classes to learn how to make better use of your Autodesk software, see the latest hardware and software, and meet with a bunch of other people doing what you do.&#0160; The problem is that it can be expensive and it takes time to go.&#0160; This year theyâ€™ve come up with something new so everyone can attend.&#0160; Itâ€™s called <em>Autodesk University Virtual</em>.&#0160; With this you can get much of the same content as if you were there but you can stay at home and fit it into your schedule.&#0160;</p>
<p>For AU Virtual, there are two levels of passes; free and premier.&#0160; The premier pass is $99, but is free for subscription customers and also students and educators.&#0160; Rather than list what you get with each pass Iâ€™ll point you to the <a href="http://au.autodesk.com/?nd=au_virtual_eight_reasons">AU website</a>.&#0160; The biggest difference is that with the premier pass you can attend over 50 classes that are only accessible through AU Virtual.&#0160; (Even those attending in Las Vegas will have to use AU Virtual to see these classes.)&#0160; The AU Virtual classes are live where you can watch the class and ask questions.&#0160; In addition you will also have access to many of the other presentations that are being presented in Las Vegas that you can view anytime.</p>
<p>I&#39;m presenting one AU Virtual class.&#0160; If you decide to sign up look for the <a href="http://au.autodesk.com/?nd=e_class&amp;session_id=5206&amp;jid=323682"><strong>Upgrading Your Autodesk Inventor Add-Ins to Use the New Ribbon User-Interface</strong></a> class.&#0160; You can watch it at 6:00am and 9:00 am PST on Thursday, Dec. 3rd.&#0160; Iâ€™ll be there to answer any questions.</p>
<p>I hope to see you in Las Vegas or online.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Drawing Automation
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: drawing-automation
CATEGORY: Brian
CATEGORY: Drawings

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/10/drawing-automation.html 
DATE: 10/15/2009 12:18:15 AM
-----
BODY:
<p>I gave a high-level presentation about automating drawings in Inventor at AU 2007.&#160; The most useful information from that presentation is the sample programs, but apparently they arenâ€™t available from the AU website since Iâ€™ve had a couple of requests for them recently.&#160; Remember this is from a couple of years ago and Inventor now supports some things that it didnâ€™t then.&#160; Hereâ€™s a <a href="http://modthemachine.typepad.com/files/Drawing%20Automation.zip">download</a> that contains the original class handout plus all of the sample programs.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Abhishek Singhal
EMAIL: abhi.singhal@gmail.com
IP: 122.161.126.137
URL: 
DATE: 10/19/2009 06:41:19 PM
Brian

The class handout gives an excellent overview of what is achievable and what to expect with the drawing API that existed at that time.

However, many new features have been added since then and one of the important ones to me is the ability to add balloons.

I am trying to build an application where drawings will be created automatically. In our case, the same assembly is used in several drawings each of which focuses on a different part of the assembly. The BOM of each drawing is available separately and the application knows which componentoccurences in the tree correspond to those items.

Ok. Now the questions.

1. Is it possible to customize the auto balloon feature (present in Inventor UI) through the API to mark only the items of interest.

2. If the answer to above question is no, I guess the only solution is for the application to actually make the balloons for the items of interest through API. 
In that case, would there be a sample available which can show what are the issues to take care (placement etc.) during auto ballooning ?

Thanks and Regards
Abhishek
-----
COMMENT:
AUTHOR: Don Wen
EMAIL: dwen999@yahoo.com
IP: 204.244.252.153
URL: 
DATE: 10/23/2009 07:59:16 PM
Thanks Brian. Just for others info, the downloaded file has to be renamed as a .zip file to open it.
-----
PING:
TITLE: single fitness
URL: http://www.yourfitnessdating.com/articles/ways-to-get-your-fitness-dating-man-to-like-you.xhtml
IP: 173.198.228.43
BLOG NAME: single fitness
DATE: 02/09/2013 01:19:36 PM
Mod the Machine: Drawing Automation
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Update to Visual Basic 6 Add-Ins and 64-Bit Windows
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: update-to-visual-basic-6-add-ins-and-64-bit-windows
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/10/update-to-visual-basic-6-add-ins-and-64-bit-windows.html 
DATE: 10/14/2009 11:42:04 PM
-----
BODY:
<p>I recently made a post discussing the issues around Add-Ins written using Visual Basic 6 and 64-bit Windows.&#160; I made the mistake of not testing it completely before making that post.&#160; Everything in the original posting is correct but itâ€™s incomplete because I hadnâ€™t thought through the registration process.&#160; Iâ€™ve update the <a href="http://modthemachine.typepad.com/my_weblog/2009/10/visual-basic-6-add-ins-and-64-bit.html">original post</a> to add more information to cover registering your Add-In on the 64-bit machine.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Visual Basic 6 Add-Ins and 64-Bit
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: visual-basic-6-add-ins-and-64-bit
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/10/visual-basic-6-add-ins-and-64-bit.html 
DATE: 10/01/2009 07:39:05 PM
-----
BODY:
<p>I saw a question in the customization newsgroup where someone has an Add-In written using Visual Basic 6 and wants to use that add-in with the 64-bit version of Inventor.&#160; In doing this there are some issues to be aware of:</p>  <ul>   <li>64-bit Windows can run both 32-bit and 64-bit applications (exeâ€™s and dllâ€™s). </li>    <li>Visual Basic 6 can only create 32-bit applications (exeâ€™s and dllâ€™s). </li>    <li>A 64-bit exe can only load 64-bit dllâ€™s.&#160; It cannot use 32-bit dllâ€™s. </li> </ul>  <p>In this case, Inventor is a 64-bit exe and the Add-In is a dll.&#160; A VB 6 Add-In will be a 32-bit dll.&#160; Based on the statements above, this means that it canâ€™t be used by 64-bit Inventor since that results in a 64-bit exe trying to load a 32-bit dll.&#160; There are two possible solutions; change the add-in to be an exe instead of a dll or convert the add-in to .Net where you have the ability to create a 64-bit dll.</p>  <p>&#160;</p>  <p><strong>Changing a VB 6 Add-In from a DLL to an EXE</strong>     <br />Changing an existing VB 6 Add-In from a dll to an exe is very easy.&#160; Open the project and use the <strong>Properties</strong> command in the <strong>Project</strong> menu to display the dialog shown below.&#160; Change the project type from â€œAcitveX DLLâ€ to â€œActiveX EXEâ€.&#160; Recompile and now you have an exe Add-in.&#160; However, continue readingâ€¦</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a63d0d93970c-pi"><img title="VB6_DLLtoEXE" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="321" alt="VB6_DLLtoEXE" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a63d0d96970c-pi" width="354" border="0" /></a> </p>  <p>There are two things to be aware of when converting a dll Add-In to an exe Add-In.&#160; The first is that the performance of the exe Add-In wonâ€™t be as good as the dll Add-In.&#160; A dll Add-In is loaded into Inventorâ€™s process space and API calls are made directly.&#160; An exe Add-In runs in its own process space and is separate from Inventor.&#160; This requires API calls to be <em>marshaled</em> between the two processes which is not as efficient.&#160; How much slower it is will differ from Add-In to Add-In because it depends on what kind of API calls youâ€™re making.</p>  <p>The second issue is more of a problem and is a side-effect of the fact that data has to be marshaled between the two processes.&#160; Inventorâ€™s API relies on Microsoft technology to do the marshaling between the two processes.&#160; Unfortunately, this technology doesnâ€™t support the marshaling of bitmap data.&#160; This means that any Inventor API calls you make where an IPictureDisp object is passed as an argument wonâ€™t work with an exe Add-In.&#160; </p>  <p>Their are only a few calls in Inventorâ€™s API that work with bitmaps but one of these is a function that most Add-Ins use.&#160; Thatâ€™s the AddButtonDefinition method thatâ€™s used to create a button for the user-interface.&#160; An exe Add-In wonâ€™t be able to have icons on its buttons because of this limitation.&#160; Icons are optional so you can remove those arguments from the AddButtonDefinition call and then the Add-In should function correctly but youâ€™ll only have text on the button instead of an icon.</p>  <p>Another area of the API where a bitmap is used is when getting or setting the thumbnail image for a document.&#160; This will fail for an exe Add-In.</p>  <p>Using the VB6 version of the SimpleAddIn sample thatâ€™s delivered as part of Inventorâ€™s SDK, here are the changes that are required to make it work on 64-bit Windows.</p>  <ol>   <li>Change the project type to ActiveX EXE, as explained above.      <br /></li>    <li>Comment out the lines that load the bitmaps for the icons.      <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">       <p>Dim oIcon1 As IPictureDisp          <br /><font color="#0000ff"><strong>'&#160;&#160;&#160; Dim oIcon2 As IPictureDisp              <br />'&#160;&#160;&#160; Dim oIcon3 As IPictureDisp               <br />'&#160;&#160;&#160; Set oIcon1 = LoadPicture(App.Path &amp; &quot;\AddSlotOption.ico&quot;)               <br />'&#160;&#160;&#160; Set oIcon2 = LoadPicture(App.Path &amp; &quot;\Slot.ico&quot;)               <br />'&#160;&#160;&#160; Set oIcon3 = LoadPicture(App.Path &amp; &quot;\Toggle.ico&quot;)               <br /></strong></font></p>     </div>      <p><font color="#0000ff"><strong></strong></font></p>   </li>    <li>Edit the lines where the buttons are created to remove the icons.&#160; The following three lines (please pay attention to the line wrapping) are changed from this:      <p></p>      <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Set oButtonDefAddOption = ..., &quot;Add slot option&quot;, oIcon1, oIcon1)        <br />Set oButtonDefDrawSlot = ... , &quot;Draw Slot&quot;, oIcon2, oIcon2)         <br />Set oButtonDefToggleSlotState = ..., &quot;Toggle Slot State&quot;, oIcon3, oIcon3) </div>      <p></p>      <p>to this:</p>      <p></p>      <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Set oButtonDefAddOption = ..., &quot;Add slot option&quot;)&#160;&#160; <br />Set oButtonDefDrawSlot = ... , &quot;Draw Slot&quot;)&#160; <br />Set oButtonDefToggleSlotState = ..., &quot;Toggle Slot State&quot;)</div>      <p></p>      <p>This is possible because the icon arguments are optional.</p>   </li>    <li>Compile the Add-In to create the EXE version of it and run the the registration file to register it, (AddInSample.reg in the case of the example Add-In).      <br /></li>    <li>Run Inventor to make sure the Add-In is loading and working correctly on a 32-bit system.      <br />      <br />The tricky part now is getting this Add-In to register correctly on a 64-bit system.&#160; Since itâ€™s a 32-bit application, by default it will register itself in the 32-bit section of the registry on a 64-bit system, but Inventor will only look for Add-Ins in the main section of the registry, which is the 64-bit section in this case.&#160; The following steps illustrate one way to get the registration in the correct area on the 64-bit system.       <br /></li>    <li>Find out the CLSID for your Add-In.&#160; There are two ways to find this out.&#160; If youâ€™re already using a .reg file to register your Add-In, it will be in that.&#160; Hereâ€™s the second line from the AddInSample.reg file thatâ€™s part of the sample.      <p><font face="Arial Narrow">[HKEY_CLASSES_ROOT\CLSID\{DB59D9A7-EE4C-434A-BB5A-F93E8866E872}]</font></p>      <p>The â€œ{DB59D9A7-EE4C-434A-BB5A-F93E8866E872}â€ portion of the line is the CLSID of the Add-In.&#160; Just remembering the first 3 or 4 characters is enough for what you need to do in the subsequent steps.</p>      <p>The other way to find out the CLSID is to look it up in the registry.&#160; First, you need to know what to look up.&#160; You can use the ProgID of your Add-In.&#160; This is determined by the name of your project and the name of the class that supports the Add-In interface.&#160; You can see these in the Properties window inside Visual Basic.&#160; In this case the ProgID of the Add-In will be â€œAddInSample.clsSampleAddInâ€.</p>      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e697fb970b-pi"><img title="AddInName" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="137" alt="AddInName" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e697fe970b-pi" width="290" border="0" /></a> </p>      <p>Run RegEdit and look in the HKEY_CLASSES_ROOT section for the ProgID of your Add-In.&#160; This is shown below for the sample Add-In.</p>      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a63d0d9a970c-pi"><img title="CLSID_Lookup" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="173" alt="CLSID_Lookup" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a63d0d9e970c-pi" width="404" border="0" /></a></p>      <p>Once youâ€™ve found the ProgID for the Add-In, expand the key in the registry and then expand the Clsid key and select â€œClsidâ€.&#160; In the right-hand portion of the Registry Editor youâ€™ll see the CLSID of your Add-in.</p>   </li>    <li>Now using the Registry Editor, find the HKEY_CLASSES_ROOT\CLSID section of the registry.&#160; Within this key, find the CLSID for your Add-In.&#160; The picture below shows this key selected in the browser and expanded so you can see its subkeys.&#160; You can verify that you have the correct registry key by checking on the right-hand side of the Registry Editor to see if the ProgID matches the one for your Add-In.<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e69807970b-pi">        <br />        <br /><img title="Add-InRegKey" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="187" alt="Add-InRegKey" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e6980a970b-pi" width="404" border="0" /></a>       <br /></li>    <li>Right-click on the CLSID key of your Add-In and choose Export, as shown below.&#160; Specify a name and save the .reg file.      <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e69811970b-pi"><img title="RegistryExport" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="315" alt="RegistryExport" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a5e69816970b-pi" width="346" border="0" /></a>       <br /></li>    <li>Copy the Add-In to the 64-bit system by copying the EXE, the reg file you just created in the previous step, and any other files your Add-in might require.&#160; The SimpleAddIn sample doesnâ€™t need anything except these two files but your Add-In may need some other files.      <br /></li>    <li>Edit the .reg file so that it contains the correct path for your Add-In as it exists on the 64-bit system.&#160; Youâ€™ll need to edit one line in the .reg file to correct the path.&#160; The edited portion is highlighted below.&#160; Notice how the backslashes of the actual path are replaced with double back slashes.      <p><font face="Arial Narrow">[HKEY_CLASSES_ROOT\CLSID\{DB59D9A7-â€¦-F93E8866E872}\LocalServer32]          <br />@=&quot;<font color="#0000ff"><strong>C:\\Users\\ekins\\Documents</strong></font>\\AddInSample.exe&quot;</font></p>   </li>    <li>Run the .reg file to register your Add-In.&#160; When you run Inventor, your Add-In should be running and work.&#160; If it isnâ€™t working, check the Add-In Manager to see if your Add-In is in the list.&#160; If it is in the list but isnâ€™t listed as being loaded, then the Add-In is likely failing in the Activate method.&#160; Make sure you removed the icons as instructed above and double-check that youâ€™re not trying to access something thatâ€™s not available on the 64-bit machine.      <br />      <br />If your Add-In doesnâ€™t show up at all in the Add-In Manager then go through the directions above and double-check that you didnâ€™t leave out anything.&#160; For your Add-In to not show up at all indicates that itâ€™s not being registered correctly.</li> </ol>  <p><strong>Converting a Visual Basic 6 Add-In to 64-Bit      <br /></strong>Visual Basic 6 is only capable of creating 32-bit applications.&#160; To convert an existing project to a 64-bit application will require porting the application to VB.Net, which does support the creation of a 64-bit application.&#160; VB.Net has a VB 6 conversion tool but I would suggest that you NOT use it.&#160; Instead, I would use the Add-In Wizard thatâ€™s delivered as part of Inventorâ€™s SDK to create a new Add-In and copy the code manually from VB 6 into the VB.Net project.&#160; There are too many differences between VB 6 and VB.Net and my experience is that cleaning up the resulting code from the conversion is harder than copying over smaller portions of code at a time an manually converting it.</p>  <p>Youâ€™ll also need to recreate your dialogs.&#160; The dialogs are much more powerful in VB.Net so this lets you take advantage of those new features.&#160; The basics of converting your code is covered in this post: <a href="http://modthemachine.typepad.com/my_weblog/2008/10/converting-vba-auto-macros-to-an-add-in.html">Converting VBA Auto Macros to an Add-In</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: pushpak
EMAIL: pushpak@sungrace-group.com
IP: 219.64.90.194
URL: 
DATE: 10/08/2009 02:39:47 PM
Can anybody explain. How can we use Winodws Presentation Foundation (WPF) with Autodesk Inventor?

I got enough material on autoCAD with WPF but not much on WPF and Inventor.

Please guide.
-----
COMMENT:
AUTHOR: Asep Hibban
EMAIL: ibnusurur@yahoo.co.id
IP: 118.96.224.139
URL: http://khoiriyyah.blogspot.com
DATE: 02/15/2010 07:57:10 PM
Good information, by the way how can I insert a picture to imagelist control from add-ins coding? I am very confuse.

Thank You
-----
COMMENT:
AUTHOR: shira
EMAIL: a@a.com
IP: 109.67.16.202
URL: 
DATE: 06/08/2010 09:33:13 PM
Thanks that helped a lot!!!
-----
COMMENT:
AUTHOR: Guru
EMAIL: guruprasad.anumula1@gmail.com
IP: 122.169.133.209
URL: 
DATE: 08/12/2010 12:54:05 PM
Hi is their any other way to convert vb6 32 bit dll into 64 bit dll
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Attribute Utility
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: attribute-utility
CATEGORY: Attributes
CATEGORY: Brian
CATEGORY: Inventor

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/09/attribute-utility.html 
DATE: 09/23/2009 09:56:40 PM
-----
BODY:
<p>Working with attributes can sometimes be a bit frustrating because the only access you have to attributes is through the API.&#0160; You canâ€™t quickly create, edit, or view an attribute without writing a program to do it.&#0160; Because of this I became a bit frustrated when working on my first program that made extensive use of attributes.&#0160; For the program to function correctly the attributes it was using all had to be correct and it was difficult to debug problems to determine if the problem was my program or the attributes it was trying to access.</p>
<p>For my own sanity I wrote a little utility that would let me view all of the attributes in a document.&#0160; That helped a lot but I never felt it was finished because it only allowed me to view existing attributes and I still couldnâ€™t easily create or edit an existing attribute without writing code.&#0160; As part of the series of blog posts Iâ€™ve Iâ€™m writing about <a href="http://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html">attributes</a>, Iâ€™ve completely re-written the utility so that it provides full creation, edit, and viewing of attributes.&#0160; This new version of the utility is an add-in.&#0160; To use it just <a href="http://modthemachine.typepad.com/files/AttributeHelperSetup.zip">download</a> and install the add-in and look at the readme thatâ€™s installed for instructions on how to use it.&#0160; When installing you have the option of also installing the source code, if youâ€™re interested in the internals of how it works.&#0160; It was written using the Visual Basic language in Visual Studio 2008.</p>
<p>Let me know if you have suggestions or find any problems.</p>
<p>---------------------------</p>
<p>Update (Aug. 10, 2015) - I&#39;ve updated this utility.&#0160; The update can be found <a href="http://modthemachine.typepad.com/my_weblog/2015/08/attribute-helper-update.html" target="_self" title="here">here</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: RenÃ© Gerlach
EMAIL: rene.gerlach@cideon.com
IP: 87.139.109.177
URL: http://www.cideon-software.com
DATE: 11/03/2009 04:43:58 PM
Hi Brian,

some time ago, we tried to use occurrence attributes as occurence properties. But how can we take them over to exchange formats like dwf, 3d-pdf, adsk,...?
We found no way to do this.

Thanks for any hints
RenÃ©
-----
COMMENT:
AUTHOR: Rodrigo
EMAIL: xptomacr@gmail.com
IP: 195.23.36.154
URL: 
DATE: 03/30/2010 11:55:56 AM
Hi Brian!

thanks a lot for your attribute utility, it's very usefull.
but i want to ask you, if it's possible to the utility to show,color or highlight all the sufaces with attributes?

What part of the code do i have to change?

best regards,Rodrigo.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Wishlist Survey Reminder
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-wishlist-survey-reminder
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/07/inventor-api-wishlist-survey-reminder.html 
DATE: 07/28/2009 06:43:21 PM
-----
BODY:
<p>Just a gentle reminder that time is running out to participate in this years Inventor API Wishlist Survey.&#0160; <strong>The deadline is July 31, 2009.</strong>&#0160; Hereâ€™s a link to the survey: <a href="http://www.zoomerang.com/Survey/?p=WEB229EPCV8VA2">AutodeskÂ® InventorÂ®</a>.</p>
<p>Thanks to those of you that have already taken the time to fill out the survey.&#0160; Weâ€™re slightly ahead of the response we had for last years survey.&#0160; This survey is very important to the Inventor engineering team in deciding what will go into the upcoming releases.</p>
<p>Hereâ€™s the wishlist that was generated from the survey in 2008.</p>
<ol>
<li>Use Inventorâ€™s functionality through in-process component</li>
<li>VBA Record and Playback</li>
<li>Create Solids and Surfaces by defining geometry and B-Rep</li>
<li>Ability to control Inventorâ€™s progress bar</li>
<li>Support for modeling in sheet metal flat pattern</li>
<li>Full support for assembly feature creation</li>
<li>Creation of all sheet metal features</li>
<li>Creation of other drawing view types</li>
<li>Hole notes, thread notes, and punch notes</li>
<li>Full support for centerlines and center marks</li>
<li>Ability to participate in Inventorâ€™s error reporting mechanism</li>
<li>Creation of ordinate and baseline dimension sets</li>
<li>Support for inspection dimensions</li>
</ol>
<p>Hereâ€™s what we did based on this feedback.&#0160; The bold items were completed and work was done on the italicized items.</p>
<ol>
<li><em>Use Inventorâ€™s functionality through in-process component</em></li>
<li>VBA Record and Playback</li>
<li><em>Create Solids and Surfaces by defining geometry and B-Rep</em></li>
<li><strong>Ability to control Inventorâ€™s progress bar</strong></li>
<li><strong>Support for modeling in sheet metal flat pattern</strong></li>
<li><strong>Full support for assembly feature creation</strong></li>
<li><em>Creation of all sheet metal features</em></li>
<li><em>Creation of other drawing view types</em></li>
<li><strong>Hole notes, thread notes, and punch notes</strong></li>
<li><strong>Full support for centerlines and center marks</strong></li>
<li><strong>Ability to participate in Inventorâ€™s error reporting mechanism</strong></li>
<li><strong>Creation of ordinate and baseline dimension sets</strong></li>
<li><strong>Support for inspection dimensions</strong></li>
</ol>
<p>You can see that we do respond to these lists and need your input to help guide the API in the direction that is most useful to you.&#0160; Thank you for your help.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Viktor
EMAIL: viktork@steel-detailer.com
IP: 65.98.166.18
URL: http://www.steel-detailer.com
DATE: 09/03/2009 08:07:06 PM
Personally, I need item number 2 the most!

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Have you Written any Cool Add-Ins?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: have-you-written-any-cool-add-ins
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/07/have-you-written-any-cool-add-ins.html 
DATE: 07/24/2009 06:13:51 PM
-----
BODY:
<p>The Autodesk Developer Network (ADN) group here at Autodesk has just announced a new program to promote the writing and sharing of small utilities to enhance the various Autodesk products.&#0160; Kean Walmsley, who is the manager of the group that supports ADN, describes it in his latest <a href="http://through-the-interface.typepad.com/through_the_interface/2009/07/coming-soon-to-autodesk-labs-plugin-of-the-month.html">blog posting</a>.&#0160; Go check it out and start thinking of what you might be able to do.&#0160; Even if you donâ€™t feel like your programming skills are up to the challenge you could still submit ideas for useful utilities.&#0160; The <a href="http://discussion.autodesk.com/forums/forum.jspa?forumID=120 ">Inventor customization newsgroup</a> will be a good place to do that.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Wishlist Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-api-wishlist-survey
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/07/inventor-api-wishlist-survey.html 
DATE: 07/20/2009 06:48:28 PM
-----
BODY:
<p>This years API survey is now available.&#0160;</p>
<p><a href="http://www.zoomerang.com/Survey/?p=WEB229EPCV8VA2">AutodeskÂ® InventorÂ® API Survey</a></p>
<p>Please do take the time to fill out the survey and give us your input.&#0160; We rely heavily on the information obtained through this survey to help us prioritize what weâ€™ll do in upcoming releases.&#0160; This is a great chance for you to voice your opinion.&#0160; If you provide your email address you will also be sent a copy of the survey results once theyâ€™ve been compiled.</p>
<p>The survey will remain open until <strong>July 31, 2009</strong>.&#0160; Thanks in advance for participating!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Working with STL and OBJ Files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: working-with-stl-and-obj-files
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/07/working-with-stl-and-obj-files.html 
DATE: 07/15/2009 01:15:16 AM
-----
BODY:
<p>This posting isnâ€™t about how to use the API but is an example of what can be done with the API and hopefully is useful to some of you.&#160; A big reason Iâ€™m posting it here is that I continue to get requests for the program and this will provide a better way to distribute and update it than the newsgroup.</p>  <p>The program came about after I visited a university a couple of years ago that is using Inventor as part of their engineering program.&#160; In one of their classes the students need to create an Inventor model to fit around a model thatâ€™s defined by an OBJ file.&#160; (OBJ and STL files are formats that define a model using a mesh of triangles.)&#160; It was difficult for them to use this data in Inventor and it seemed to me like something could be done to improve the process and it became a pet project of mine.</p>  <p>The Facet Enabler add-in became the result.&#160; Itâ€™s an add-in that uses client graphics and client features, plus a lot of code of my own.&#160; It allows you to read in an OBJ or STL file and see it in Inventor.&#160; What you see is just client graphics which means itâ€™s only for display and doesnâ€™t affect the model and canâ€™t be used for other operations like interference checking, measure, etc.&#160; To be able to make use of the mesh data for modeling the add-in supports a command that lets you cut a section through the client graphics, which creates a sketch that can then be cleaned up and used as input for standard Inventor features.</p>  <p>The add-in adds two commands to Inventor.&#160; The first is added to the part environment.&#160; Its icon is the yellow pyramid as shown below (the second to the last command in the panel bar).&#160; If using the ribbon interface it is in the Add-Ins panel of the Part ribbon.&#160; When you read in the OBJ or STL data a new icon is created in the browser to represent the data.&#160; There are also several options to control how it is displayed that are accessed from the context menu, as shown below.&#160; (The â€œSmooth Shadingâ€ option is only available if that information existed in the OBJ file.&#160; Itâ€™s never available for STL data.)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834011571114618970c-pi"><img title="FacetEnablerOptions" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="364" alt="FacetEnablerOptions" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401157205eedc970b-pi" width="404" border="0" /></a> </p>  <p>   <br />In the sketch environment thereâ€™s one new button thatâ€™s added.&#160; It looks like a sectioned pyramid and is the last command in the panel menu below.&#160; It will create sketch geometry that represents a section cut through the faceted model as shown below.&#160; You can use the sketch geometry for standard Inventor modeling.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834011571114620970c-pi"><img title="FacetEnablerSection" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="364" alt="FacetEnablerSection" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401157205eef4970b-pi" width="404" border="0" /></a> </p>  <p>To install the program just download the zip file and run the install program it contains.&#160; It will run with Inventor 2009 and later.</p>  <p><a href="http://modthemachine.typepad.com/files/facetenablersetup.zip">Facet Enabler Install Download</a></p>  <p>Please let me know if you find any problems, have suggestions to improve the program, or want to be notified if there are updates.&#160; Iâ€™ll also update this blog post when I update the program.</p>  <p><strong>Revisions</strong>     <br />July 14, 2009 â€“ Initial Post    <br />July 23, 2009 â€“ Posted version 1.5 which contains a fix to correctly handle line continuation characters in OBJ files.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Deelip Menezes
EMAIL: deelip@sycode.com
IP: 59.90.33.122
URL: http://www.deelip.com
DATE: 07/15/2009 07:05:59 AM
Brian,

Neat! Just a small FYI. At SYCODE (www.sycode.com) we offer Inventor add-ins that import STL and OBJ (among other mesh formats) to Inventor parts as solid objects (not client graphics) that can be edited using Inventor's solid modeling tools.

I hope this does not sound like advertising. Well, who am I kidding. It is, isn't it. ;-)

Cheers!
-----
COMMENT:
AUTHOR: Brian Hall
EMAIL: bhall@qubeitdesign.com
IP: 24.173.161.78
URL: http://www.armstrongaluminum.com
DATE: 07/15/2009 12:42:39 PM
Hi Brian E.,

This is interesting to me. I have an interest in hi-def, phase shift scanners (i.e. FARO, Leica, etc.) and there is a large gap between obtaining the scan data (point clouds) and being able to utlize that data inside Inventor (cost effectively). I am VERY new to programming and the API of Inventor, so please excuse any ignorant questions.  Could this add-in be extended to bring in "point clouds" as client graphics for which that data could also be leveraged in a 2D sketch?  Also, did you make the OBJ & STL files be displayed as client graphics to keep it light weight?  TIA!!

-Brian Hall
-----
COMMENT:
AUTHOR: RV
EMAIL: rishivadher@hotmail.com
IP: 193.136.128.19
URL: 
DATE: 07/22/2009 11:49:28 PM
Hi
Excellent add-in, thanks for sheering and hope this add-in is integrated in the new version of Inventor.

-----
COMMENT:
AUTHOR: Alois
EMAIL: alois.spiess@tqs.de
IP: 62.157.136.28
URL: 
DATE: 12/18/2009 09:52:56 AM
Hello Brian,

i tried it with a german installation and it doesn't work. Furthermore i couldn't import step untill i uninstalled our programm. 
Is there a possibility to get it in a version, that works with a german installation ?

For your information: I have installed INV2008 and INV2010 Prof. and tried your tool with INV2008.
-----
COMMENT:
AUTHOR: Acai Optimum
EMAIL: acai@top3acaiberry.com
IP: 98.247.53.241
URL: http://www.top3acaiberry.org
DATE: 01/24/2010 07:04:10 AM
Wonderful post... Very educational and easy to understand. Thanks for the excellent post!
-----
COMMENT:
AUTHOR: animation clips
EMAIL: Khare.125@gmail.com
IP: 122.168.224.194
URL: 
DATE: 04/05/2010 02:13:27 PM
thanx that you post this article on our request
-----
COMMENT:
AUTHOR: Air Jordan shoes
EMAIL: luoace2@gmail.com
IP: 64.56.66.235
URL: http://www.airjordan.cc/
DATE: 07/03/2010 08:31:36 AM
As anybody understands respect is one of the most imperative amongst people's existence. Only respect one another to obtain along properly and I feel that leaving one's opinion is often a behavior of respect. Do you feel so?
-----
COMMENT:
AUTHOR: id scanner
EMAIL: shkolnikova.manovich7@gmail.com
IP: 77.127.194.65
URL: http://www.scanshell-store.com/software_idscan.htm
DATE: 07/18/2010 02:04:23 PM
I think it's just great what you did! I is fascinating how sometimes the most random things give us inspiration to do something wonderful!
-----
COMMENT:
AUTHOR: JSP 3D.C.S
EMAIL: jpitcher@rand.com
IP: 123.200.242.153
URL: 
DATE: 10/07/2010 11:32:45 PM
Hi Brian, thanks for the facet enabler for AIP 2011, works well! However I have a client having issues not opening .stl file that I can.  I have told him to uninstall and reinstall but no luck there either, are there any tricks to uninstalling apart from add/remove progs etc?

Thanks
-----
COMMENT:
AUTHOR: Pet monkeys for sale
EMAIL: qmcgv671@yahoo.com
IP: 188.26.146.90
URL: http://www.petmonkeysforsale.org/
DATE: 02/27/2011 10:05:53 PM
Hi Brian, thanks for the facilitator facet of AIP 2011, works fine! However I have a client that has no problems opening the file. Stl I can. I have told to uninstall and reinstall but luck does not exist or is there some trick to uninstall as well as add or remove progs etc who wants to learn to fly one day must first learn to stand, walk and run and climb and dance? , can not fly in flight. Nope. This is not my own project. I finish it in a teamwork, so we spare the job in every of us.
-----
COMMENT:
AUTHOR: Javier
EMAIL: fjaviemx@gmail.com
IP: 92.233.236.144
URL: 
DATE: 12/06/2011 10:20:52 PM
Brian, this API, even with all the limitations you stated so clearly, has just saved my project (not an academic one). The STL visualization and on-plane cross sections was exactly what I needed.  I usually used the SYCODE which works smoothly but I think it's a high price to pay for a functionality that SHOULD be provided by the software.
The day Inventor takes seriously STL & Scan data, that day it will take the edge over its competitors. 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Introduction to Attributes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: introduction-to-attributes
CATEGORY: Attributes
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/07/introduction-to-attributes.html 
DATE: 07/02/2009 06:31:03 AM
-----
BODY:
<p>This is the first of at least two posts on attributes.&#160; This first one will cover the basics and subsequent postings will go into some more advanced aspects.&#160; Most programs your write will likely only need the information covered in this post.</p>  <p>The attribute functionality of Inventor is something thatâ€™s only available through the API; it doesnâ€™t have a user-interface.&#160; The basic concept of attributes is very simple; itâ€™s the ability to associate information with Inventor entities.&#160; Where it getâ€™s a little more complicated is in understanding when this functionality might apply to your programs and how you can take advantage of it.</p>  <p>First, letâ€™s look at the API for attributes.&#160; Every object that supports attributes has the AttributeSets property from which you can access the attributes associated with that particular object.&#160; Below is the object model for attributes.    <br />&#160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834011570a96141970c-pi"><img title="AttributesModel" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="141" alt="AttributesModel" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834011570a96151970c-pi" width="179" border="0" /></a></p>  <p></p>  <p>The â€œInventor Entityâ€ is any object that supports the AttributeSets property.&#160; The AttributesSets object returned by this property is an object collection that lets you access all of the AttributeSet objects associated with the object, and it also lets you create new AttributeSet objects.&#160; An AttributeSet is exactly what the name implies; a set of attributes.&#160; They provide a way of grouping the attributes associated with an object.&#160; Typically, each application that adds an attribute to an object will create their own attribute set so that their attributes arenâ€™t mixed with another applicationâ€™s attributes. </p>  <p><font size="3"><strong>Creating an Attribute </strong></font>    <br />An AttributeSet object is also a collection object and provides access to the Attribute objects it contains and provides the ability to create new attributes.&#160; Below is an example VBA macro that demonstrates this by creating a new attribute set on a selected entity and then adds an attribute to that set.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub CreateAttribute()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.&#160; It can be any type of document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument&#160; <br />      <br /></p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the selected entity.          <br /></strong></font>&#160;&#160;&#160; Dim entity As Object       <br />&#160;&#160;&#160; On Error Resume Next       <br />&#160;&#160;&#160; Set entity = doc.SelectSet.Item(1)       <br />&#160;&#160;&#160; If Err Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;You must select an entity.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the AttributeSets object from the selected entity.          <br /></strong></font>&#160;&#160;&#160; Dim attribSets As AttributeSets       <br />&#160;&#160;&#160; Set attribSets = entity.AttributeSets       <br />&#160;&#160;&#160; If Err Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;You must select an entity that supports attributes.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; On Error GoTo 0&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create an attribute set.          <br /></strong></font>&#160;&#160;&#160; Dim attribSet As AttributeSet       <br />&#160;&#160;&#160; Set attribSet = attribSets.Add(&quot;SampleSet&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create an attribute on the set.          <br /></strong></font>&#160;&#160;&#160; Dim attrib As Inventor.Attribute       <br />&#160;&#160;&#160; Set attrib = attribSet.Add(&quot;SampleAttribute&quot;, _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kStringType, &quot;A Test&quot;)       <br />End Sub</p> </div>  <p></p>  <p>The first portion of the program gets the entity that is currently selected within the active document.&#160; Notice that the variable â€œentityâ€ is declared as Object, indicating that any type of object can be handled.&#160; The error handling is used to catch the case where no entity has been selected.</p>  <p>The next section of the program gets the AttributeSets object from the selected entity.&#160; Since the program allows you to select anything, the error handling is used to catch the case where the selected object doesnâ€™t support the AttributeSets property.</p>  <p>Finally, we have an AttributeSets object that was obtained from the selected entity.&#160; The next section creates an AttributeSet object using the Add method of the AttributeSets object.&#160; It supplies the name to use for the AttributeSet.&#160; The name must be unique with respect to the other AttributeSet objects associated with that particular AttributeSets object.&#160; Typically you would append the set name with your company or application name to make it unique, i.e. â€œmodmachineSampleTestâ€.</p>  <p>The final section of the program creates an attribute within the attribute set.&#160; The creation of the attribute takes three arguments; name, type, and value.&#160; The name must be unique with respect to the other attributes within this attribute set.&#160; Since itâ€™s likely youâ€™re the only one adding attributes to your set this is easily managed by you.&#160; Attributes can be one of four different types; Double, Integer, String, or array of Bytes.&#160; In the example above it creates a String attribute with the value of â€œA Testâ€.</p>  <p><font size="3"><strong>Getting an Existing Attribute From an Entity</strong></font>     <br />Now that youâ€™ve seen how to create an attribute on an entity, how do you get that attribute back at a later time?&#160; There are two ways of accessing attributes.&#160; The first uses the objects weâ€™ve already looked at; AttributeSets and AttributeSet.&#160; The sample code below illustrates getting the attribute that was just created.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub GetAttribute()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.&#160; It can be any type of document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the selected entity.          <br /></strong></font>&#160;&#160;&#160; Dim entity As Object       <br />&#160;&#160;&#160; On Error Resume Next       <br />&#160;&#160;&#160; Set entity = doc.SelectSet.Item(1)       <br />&#160;&#160;&#160; If Err Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;You must select an entity.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the AttributeSets object from the selected entity.          <br /></strong></font>&#160;&#160;&#160; Dim attribSets As AttributeSets       <br />&#160;&#160;&#160; Set attribSets = entity.AttributeSets       <br />&#160;&#160;&#160; If Err Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;You must select an entity that supports attributes.&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; On Error GoTo 0       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see if it has the &quot;SampleSet&quot; attribute set.          <br /></strong></font>&#160;&#160;&#160; If attribSets.NameIsUsed(&quot;SampleSet&quot;) Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the attribute set.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim attribSet As AttributeSet       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set attribSet = attribSets.Item(&quot;SampleSet&quot;) </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the attribute on the set.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim attrib As Inventor.Attribute       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set attrib = attribSet.Item(&quot;SampleAttribute&quot;)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Attribute &quot; &amp; attrib.name &amp; &quot; = &quot; &amp; attrib.Value       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The entity does not have the expected attribute set.&quot;       <br />&#160;&#160;&#160; End If       <br />End Sub</p> </div>  <p></p>  <p>Most of the code in the sample above is the same as the previous sample.&#160; However, once it has the AttributeSets object from the selected entity it uses the NameIsUsed property of the AttributeSets object to see if there is an attribute set named â€œSampleSetâ€.&#160; If there is then it gets the attribute named â€œSampleAttributeâ€.&#160; Finally it displays the name and value of that attribute.</p>  <p>The approach demonstrated above illustrates how you can get an attribute from an known entity.&#160; The problem with this approach is that in many cases you donâ€™t have a reference to the entity the attribute is attached to.&#160; For example, you might have attached an attribute to a face so you can use the attribute at a later time to find that face again.&#160; Using the technique shown above you would need to iterate over every face in the model until you found the one that had the â€œSampleSetâ€ attribute set.&#160; Not a very efficient way to find the attribute.&#160; Another approach of getting attributes is discussed below.</p>  <p><font size="3"><strong>Getting an Existing Attribute Using the Attribute Manager        <br /></strong></font>The other way to find existing attributes is to use the AttributeManager object.&#160; This is an object you obtain using the AttributeManager property of the Document object.&#160; The most common use of the attribute manager is to query for attributes that exist in the document.&#160; For example, the code below will find all entities that have an attribute set called â€œSampleSetâ€.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub GetAttributeUsingManager()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.&#160; It can be any type of document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the attribute manager.          <br /></strong></font>&#160;&#160;&#160; Dim attribMgr As AttributeManager       <br />&#160;&#160;&#160; Set attribMgr = doc.AttributeManager       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Find all attribute sets named &quot;SampleSet&quot;.          <br /></strong></font>&#160;&#160;&#160; Dim foundEntities As ObjectCollection       <br />&#160;&#160;&#160; Set foundEntities = attribMgr.FindObjects(&quot;SampleSet&quot;)       <br />      <br />&#160;&#160;&#160; MsgBox &quot;Found &quot; &amp; foundEntities.Count &amp; &quot; entities.&quot;       <br />End Sub</p> </div>  <p></p>  <p>You can see this is much easier, and faster, than looking through all of the entities to see if they have a particular attribute set.</p>  <p>There are three different Find methods to choose from and youâ€™ll choose one over the other depending on which type of object will be the most convenient for you to use in your program.&#160; The three find methods are FindAttributes, FindAttributeSets, and FindObjects.&#160; All three of them take the same input arguments and do the same type of search with the only difference being what they return.&#160; The FindAttributes method returns a list of Attribute objects as an AttributesEnumerator object.&#160; The FindAttributeSets method returns a list of AttributeSet objects as an AttributeSetsEnumerator object.&#160; The FindObjects returns a list of entities as an ObjectCollection object.</p>  <p>The three Find methods have three arguments.&#160; The first is the name of the attribute set, the second is the name of the attribute, and the third is the value of the attribute.&#160; You can use wild cards when searching.&#160; For example if I had added the following attribute sets to several different entities, SampleSet1, SampleSet2, SampleSet3, and SampleSet4, the following query would find and return all four attribute sets.&#160; Notice the asterisk wild card at the end of â€œSampleSetâ€</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Find all attribute sets named &quot;SampleSet&quot;.        <br /></strong></font>&#160;&#160;&#160; Dim foundSets As AttributeSetsEnumerator&#160; <br />&#160;&#160;&#160; Set foundSets = attribMgr.FindAttributeSets(&quot;SampleSet*&quot;)     <br /></div>  <p>The following query will find all attribute sets named â€œSampleSetâ€ that contain an attribute named â€œTableTypeâ€.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Find all attribute sets named &quot;SampleSet&quot;.        <br /></strong></font>&#160;&#160;&#160; Dim foundSets As AttributeSetsEnumerator&#160; <br />&#160;&#160;&#160; Set foundSets = attribMgr.FindAttributeSets(&quot;SampleSet&quot;, _</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;TableType&quot;)    <br /></div>  <p>This last one find all attribute sets that have an attribute whose value is â€œACME Fastenerâ€.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Find all attribute sets named &quot;SampleSet&quot;.        <br /></strong></font>&#160;&#160;&#160; Dim foundSets As AttributeSetsEnumerator&#160; <br />&#160;&#160;&#160; Set foundSets = attribMgr.FindAttributeSets(&quot;*&quot;, &quot;*&quot;, _</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;ACME Fastener&quot;)    <br /></div>  <p>As discussed above, the various find methods return different types of objects.&#160; Frequently you may have a reference to one type of object but also need the associated objects.&#160; Weâ€™ve already seen how how you can walk down the object model from an entity to get an associated AttributeSet object and from the AttributeSet object to get the Attribute objects.&#160; You can also walk up the object model.&#160; If you start with an Attribute object you can use its Parent property to get the AttributeSet object it is associated with.&#160; You can use the Parent property of the AttributeSet object to get the parent AttributeSets object.&#160; And finally, you can use the AttributeSets objectâ€™s Parent property to get the entity the attribute set is associated with.&#160; <br /><font size="3"><strong>       <br />Why Use Attributes? </strong>      <br /></font>A common question when first learning about attributes is â€œwhy/how would you use them?â€.&#160; Attributes donâ€™t do anything by themselves but only serve as a tool to enable other things.&#160; Because of this they are used in many different ways for many unique applications.&#160; Here are a some examples that illustrate how attributes can be used.&#160; They also demonstrate why you would choose one of the find methods of the AttributeManager object over another.&#160; </p>  <p>Probably the most common use of attributes is for naming an entity so you can find it later.&#160; For example, you might be automating the creation of an assembly and need to find the entities that will be used as input when creating constraints to position the parts in the assembly.&#160; One approach is to add an attribute set to the entity so you can use one of the AttributeManager find method find it later.&#160; In this case itâ€™s the entity thatâ€™s of interest and the attribute is just serving as the mechanism to find the entity and using the FindObjects method makes sense because it directly returns the object so you can easily use it to create the constraint.</p>  <p>Another common example of the use of attributes is adding additional information to an entity thatâ€™s important for your application. For example you might write a program to create a custom table in a drawing.&#160; In this case each row of the table represents something unique to your application is not something that Inventor is aware of.&#160; You can use the API to create a custom table with the data you want to display but you can also add an attribute set to the custom table that contains additional information that will be useful to you to understand where the data in the table came from so you can easily update it.&#160; In this case itâ€™s probably the AttributeSets object thatâ€™s the most interesting since it gives you easy access to the attributes to allow you to query them to determine the table information.&#160; Using the FindAttributeSets method makes more sense in this case.</p>  <p>Hereâ€™s an example where Inventor takes advantage of attributes.&#160; I talked this in a previous post, <a title="http://modthemachine.typepad.com/my_weblog/2009/04/controlling-layers-in-your-flat-pattern-export.html" href="http://modthemachine.typepad.com/my_weblog/2009/04/controlling-layers-in-your-flat-pattern-export.html">http://modthemachine.typepad.com/my_weblog/2009/04/controlling-layers-in-your-flat-pattern-export.html</a>.&#160; In this example, you add attributes to the edges of a flat pattern and the translator will use the attributes to determine which layer to create the corresponding geometry on.</p>  <p>Another example is face colors.&#160; You can right-click on a face in a part and select the Properties command to change the color of that face.&#160; Internally, Inventor remembers the color you selected by adding an attribute to that face that has the name of the color.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: J.J.
EMAIL: jjbt@microcad.com.co
IP: 200.13.234.98
URL: 
DATE: 07/02/2009 02:32:36 PM
Hi, Brian

Nice to read you again!!!
-----
COMMENT:
AUTHOR: Jon Brabbs
EMAIL: jbrabbs@polypal.co.uk
IP: 80.193.68.234
URL: 
DATE: 07/03/2009 11:06:12 AM
Morning Brian,

I've automated an assembly that puts shelves on different levels, and want to add text detailing the height and details of each shelf.

I'm currently using drawings curves to identify components and add text to the relevant item, but I've discovered that on different machines, it puts the leader in different locations.

Could Attributes be used to identify components and add the text in the correct location?

Cheers

Jon
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 132.188.64.150
URL: http://profile.typepad.com/1218580234s15464
DATE: 07/07/2009 12:48:25 AM
Hi Jon,

I would need to see an example of what you're doing and the problem you're seeing to fully understand the issue.  I don't know if attributes can provide help in your case or not.  An example of where they might help is if there's a particular location on a part where you want the leader to point.  You could save that location (maybe the x,y,z coordinate) as an attribute and then use this information later when creating a leader.
-----
COMMENT:
AUTHOR: carl hughes
EMAIL: carl.hughes@bvtsurfacefleet.com
IP: 93.157.223.82
URL: 
DATE: 11/05/2009 03:38:11 PM
hi, 

is it possible to pick up the attributes using design review in a published dwf?
we are using attributes to hold system ids for libary parts and it would be nice to be able to read them from the final dwfs.


-----
COMMENT:
AUTHOR: Cris_oliver
EMAIL: 
IP: 189.30.16.90
URL: http://profile.typepad.com/crisoliver
DATE: 08/27/2010 02:58:48 PM
Hi,
i would like makes a attribute for checked the sub-assemblies with Y or N, and read the attributes into the IDW. It's possible?

Explain my case: Today, when changed an item IAM into BOM Struture for PHANTOM, the Inventor makes the sub-IAM file phantom, thus affecting all other places where it is used.
-----
COMMENT:
AUTHOR: Fred Grondin
EMAIL: fagrondin@parker.com
IP: 12.4.27.248
URL: 
DATE: 11/11/2011 08:04:42 PM
Hi Brian,

I started not a long time ago to look at API for inventor and I'm stuck with attributes..
How do I determine what are the attributeSet ?
The command attbSets.get_NameIsUsed("Description") tell you if it exist but if you would like to know what is the name when you know it exist. Can't figure it out.
Thanks
-----
COMMENT:
AUTHOR: Fred Grondin
EMAIL: fagrondin@parker.com
IP: 12.4.27.248
URL: 
DATE: 11/11/2011 08:27:15 PM
Brian,

Thanks all your example and explanation.
I got it, what I relly needed was the attributeSet NAME ??? Regards. Fred
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: DevLabs
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: devlabs
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/04/devlabs.html 
DATE: 04/30/2009 02:35:32 AM
-----
BODY:
<p>Hereâ€™s an unbelievable opportunity, if youâ€™re in a position that you can take advantage of it.&#0160; Itâ€™s essentially up to a weeks worth of free programming consultation.&#0160; Kean Walmsley, who is the manager of the DevTech team explains it fully in his blog <a href="http://through-the-interface.typepad.com/through_the_interface/2009/04/introducing-devlabs.html">Through the Interface</a>.&#0160; DevTech is the support group for the Autodesk Developer Network (ADN).&#0160; Take a look at the locations and dates and see if one of them works for you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor 2010 API Information
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: inventor-2010-api-information
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/04/inventor-2010-api-information.html 
DATE: 04/21/2009 11:47:16 PM
-----
BODY:
<p>The official Inventor API page has been updated with information about Inventor 2010, <a href="http://www.autodesk.com/developinventor">http://www.autodesk.com/developinventor</a>.&#0160; Here are a couple of highlights of whatâ€™s available.&#0160;</p>
<ul>
<li>A PowerPoint presentation, along with sample code, that discusses the API enhancements that are in Inventor 2010.&#0160; It was pointed out that the PowerPoint file is in the new pptx format.&#0160; You can download an Office compatibility pack so you can view the new file formats in older versions of office.&#0160; The compatibility pack is available from Microsoft <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=941b3470-3ae9-4aee-8f43-c6bb74cd1466&amp;displaylang=en">here</a>. </li>
<li>The new Object Model chart for Inventor 2010.&#0160; (This is also installed in the Docs directory as part of the Developer Tools in the SDK.) </li>
<li>There is an update for the SDK.&#0160; There were some issues discovered in the wizards and sample programs that have been resolved in this update.&#0160; Itâ€™s a complete SDK install so youâ€™ll need to uninstall your existing User Tools or Developer Tools if you have installed them and then install these updates.</li>
</ul>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: jeremy
EMAIL: jknoll@apx-enclosures.com
IP: 65.40.136.252
URL: 
DATE: 04/22/2009 09:44:43 PM
I just found this site recently and keep coming back.  Lots of good information and tutorials.  Thanks!  I was wondering if you took questions on how to do things?
-----
COMMENT:
AUTHOR: Brian Hall
EMAIL: bhall@qubeitdesign.com
IP: 24.243.145.210
URL: 
DATE: 05/02/2009 02:17:30 PM
Brian, I am getting an error when downloading the 64 bit SDK update.  I am unable to save it or directly open it.  I'm running Vista (64 bit).  
-----
COMMENT:
AUTHOR: cesar
EMAIL: crivasg@gmail.com
IP: 147.83.129.129
URL: 
DATE: 05/04/2009 07:00:29 PM
hey, Brian!

would be too much to ask to post the  inventor 2010 new api presentation in ppt or pdf? 

<a href="http://images.autodesk.com/adsk/files/inventor_2010_new_api.zip">http://images.autodesk.com/adsk/files/inventor_2010_new_api.zip</a>


thanks!

ps. your blog rocks! :D
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/04/2009 08:38:10 PM
Hi Brian,

About the error when downloading the 64-bit SDK update.  Can you try it again?  I tried downloading and installing it on my machine, which is also 64-bit Vista and it worked without any problems.

-Brian
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 05/04/2009 08:51:23 PM
I updated the blog posting to include some information on how to read the newer pptx format using older versions of Office.
-----
COMMENT:
AUTHOR: Brian Hall
EMAIL: bhall@qubeitdesign.com
IP: 24.173.161.78
URL: 
DATE: 05/04/2009 09:00:50 PM
Hi Brian Ekins (all the "Brian's" are confusing)

I went back to the download site several times that day and it finally worked.  Incidentally, I had a similar issue with downloading the Inventor Tooling Suite.  I tried the website (autodesk.com/ait) and it came up as "Not found".  Went back several times (today) and finally it worked.  I have a brand new machine, with security settings fairly low and no Anti-virus firewall going, etc.  Could be a fluke. Thanks for checking!!

-Brian Hall-
-----
COMMENT:
AUTHOR: Adam Clampet
EMAIL: clampeta@spectrumcontrol.com
IP: 216.169.165.178
URL: http://www.specpower.com
DATE: 02/24/2010 09:09:09 PM
I am trying to create a pdf from idw using visual basic.  I get an error :An invalid pointer was supplied to the method.

Code:
Public Sub PublishPDF(ByVal sFile)

        ' Get the PDF translator Add-In.
        Dim SavePath As String
        Dim m_inventorApplication As Inventor.Application = Nothing
        m_inventorApplication.Documents.Open(sFile)
        Dim FileName As String
        FileName = GetFileName(sFile)
        SavePath = "C:\AdamTest\" + FileName + ".pdf"
        Dim PDFAddIn As TranslatorAddIn
        PDFAddIn = m_inventorApplication.ApplicationAddIns.ItemById("{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}")

        'Set a reference to the active document (the document to be published).
        Dim oDocument As Inventor.Document
        oDocument = m_inventorApplication.ActiveDocument

        Dim oContext As TranslationContext
        oContext = m_inventorApplication.TransientObjects.CreateTranslationContext
        oContext.Type = IOMechanismEnum.kFileBrowseIOMechanism
        ' Create a NameValueMap object
        Dim oOptions As NameValueMap
        oOptions = m_inventorApplication.TransientObjects.CreateNameValueMap

        ' Create a DataMedium object
        Dim oDataMedium As DataMedium
        oDataMedium = m_inventorApplication.TransientObjects.CreateDataMedium
        ' Check whether the translator has 'SaveCopyAs' options
        If PDFAddIn.HasSaveCopyAsOptions(oDocument, oContext, oOptions) Then

            ' Options for drawings...
            oOptions.Value("All_Color_AS_Black") = 0
            'oOptions.Value("Remove_Line_Weights") = 0
            'oOptions.Value("Vector_Resolution") = 400
            oOptions.Value("Sheet_Range") = Inventor.PrintRangeEnum.kPrintAllSheets
            'oOptions.Value("Custom_Begin_Sheet") = 2
            'oOptions.Value("Custom_End_Sheet") = 4

        End If

        'Set the destination file name
        oDataMedium.FileName = SavePath

        'Publish document.
        Call PDFAddIn.SaveCopyAs(oDocument, oContext, oOptions, oDataMedium)
    End Sub
-----
COMMENT:
AUTHOR: Adam Clampet
EMAIL: clampeta@spectrumcontrol.com
IP: 216.169.165.178
URL: http://www.specpower.com
DATE: 02/25/2010 06:40:45 PM
Is there a way to create visual basic using the inventor view software instead of inventor?

I need to be able to create a pdf from idw, without needing a license for inventor.
-----
COMMENT:
AUTHOR: Adam Clampet
EMAIL: clampeta@spectrumcontrol.com
IP: 216.169.165.178
URL: http://www.specpower.com
DATE: 03/19/2010 12:41:13 PM
I am trying to run Inventor, using an api, to create dwg over top of old dwg, but it keeps asking if I want to save whenever the file already exists.  Is there something I am missing in the ini or inventor configuration?
-----
COMMENT:
AUTHOR: manju
EMAIL: manju.inform@gmail.com
IP: 122.166.147.69
URL: 
DATE: 08/03/2010 10:09:51 AM
sir am fresher open inventor using C#,i know basics of C#,could suggest me some links to get information and  pdf related to it
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Extracting a Specific Size Icon From a .ico File
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: extracting-a-specific-size-icon-from-a-ico-file
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/04/extracting-a-specific-size-icon-from-a-ico-file.html 
DATE: 04/17/2009 10:48:24 PM
-----
BODY:
<p>Hereâ€™s something that I recently discovered after a lot of searching and some experimenting.&#0160; In my add-ins I prefer to use .ico files for my button icons.&#0160; Icons have some advantages over .bmp files in that you can define a transparent background and you can save multiple images within a single .ico file.&#0160; This is convenient because to fully support Inventorâ€™s interface you should have three icon sizes, as listed below.</p>
<p>16x16 pixels â€“ Used for small icons in both Classic and Ribbon interfaces. <br />24x24 pixels â€“ Used for large icons in Class interface. <br />32x32 pixels â€“ Used for large icons in Ribbon interface. </p>
<p>Using an icon editor itâ€™s fairly easy to create the icons of the various sizes and then use that .ico file in my program.&#0160; What I couldnâ€™t figure out was how to extract an icon of a specific size from the .ico file.&#0160; My searches just lead to postings from other who had the same question but no answers.&#0160; I finally began experimenting and found something that works.</p>
<p>In my add-in project I add each of the .ico files as a resource to my project.&#0160; In VB.Net you can access any item in your resources by name.&#0160; The name of my icon in the example below is â€œMyCommand1â€.&#0160; The code below reads the icon of the specified size from the resource and ends up holding a reference to an Icon object.&#0160; </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Dim smallIcon As System.Drawing.Icon <br />smallIcon = New System.Drawing.Icon(My.Resources.MyCommand1, 16, 16)</p></div>
<p><br />The code below reads in the large icon file from the same icon resource.&#0160; </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Dim largeIcon as Sytem.Drawing.Icon <br />largeIcon = New System.Drawing.Icon(My.Resources.MyCommand1, 32, 32)</p></div>
<p><br />You canâ€™t directly use an Icon object with Inventorâ€™s API since it is expecting an IPictureDisp object.&#0160; The code below demonstrates how to convert an Icon to an IPictureDisp.&#0160; Youâ€™ll need to reference the Microsoft.VisualBasic.Compatibility and stdole libraries into the project first.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Dim smallPic As stdole.IPictureDisp <br />smallPic = Microsoft.VisualBasic.Compatibility.VB6.IconToIPicture( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; smallIcon)</p></div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: J. Daniel Smith
EMAIL: typepad.com@jdanielsmith.org
IP: 99.29.197.47
URL: http://jdanielsmith.spaces.live.com
DATE: 04/18/2009 10:56:58 PM
Unfortunately, IconToIPicture() doesn't preserve the alpha channel in 32-bit icons; this results in a poor image when compared to other built-in Inventor images.

There is at least one work-around, but it involves using undocumented stuff.
-----
COMMENT:
AUTHOR: darkfall gold
EMAIL: jackal@gmail.com
IP: 115.126.20.65
URL: http://www.darkfallgoldsale.com/
DATE: 09/22/2009 02:49:33 AM
My searches just lead to postings from other who had the same question but no answers.  I finally began experimenting and found something that works.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Controlling Layers in Your Flat Pattern Export
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: controlling-layers-in-your-flat-pattern-export
CATEGORY: Brian
CATEGORY: Sheet Metal

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/04/controlling-layers-in-your-flat-pattern-export.html 
DATE: 04/14/2009 05:24:10 PM
-----
BODY:
<p>When writing out a flat pattern as DXF or DWG you have control over which layers various bits of the flat pattern are written to.&#0160; You can see these options in the <strong>Save Copy As</strong> dialog when you right-click on the flat pattern in the browser, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f2545df970c-pi"><img alt="SaveCopyAsFlatPattern" border="0" height="394" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340115701c0353970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="SaveCopyAsFlatPattern" width="454" /></a> </p>
<br />
<p>The dialog allows you to specify the layer name for various categories of items that can exist in a flat pattern.&#0160; You can change the layer names and control which groups are written to the DXF or DWG file.&#0160; This is all good functionality but youâ€™re limited to the predefined sets of groups.&#0160; There is a solution to this that allows you to have very detailed control over which layer specific entities are written to.</p>
<p>Using the API you can assign an attribute to an edge in the flat pattern and this will control which layer that edge will be written to in the DXF or DWG file.&#0160; The name of the layer is specified by the attribute.&#0160; Below is a very simple example that will add an attribute to a selected edge.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p><font color="#0000ff"><strong>&#39; This program assumes that a sheet metal document is open, the <br />&#39; flat pattern is active, and that an edge of the flat pattern is <br />&#39; selected.&#0160; For simplicity, no error checking is done to <br />&#39; validate this. <br /></strong></font>Sub AddLayerName() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active document. <br /></strong></font>&#0160;&#0160;&#0160; Dim oDoc As PartDocument <br />&#0160;&#0160;&#0160; Set oDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the selected edge. <br /></strong></font>&#0160;&#0160;&#0160; Dim oEdge As Edge <br />&#0160;&#0160;&#0160; Set oEdge = oDoc.SelectSet(1) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Add an attribute set named â€œFlatPatternAttributesâ€ <br />&#0160;&#0160;&#0160; &#39; to the selected edge. <br /></strong></font>&#0160;&#0160;&#0160; Dim attSet As AttributeSet <br />&#0160;&#0160;&#0160; Set attSet = oEdge.AttributeSets.Add(&quot;FlatPatternAttributes&quot;)&#0160; <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Add an attribute specifying the name of the layer. <br /></strong></font>&#0160;&#0160;&#0160; Dim myLayerName As String <br />&#0160;&#0160;&#0160; myLayerName = &quot;CustomLayer&quot; <br />&#0160;&#0160;&#0160; Call attSet.Add(&quot;LayerName&quot;, kStringType, myLayerName) <br />End Sub</p></div>
<p><br />Any edge on the flat pattern model is valid to name.&#0160; The bend and tangent lines are also Edge objects and can be assigned a layer name too.&#0160; Defining layers for sketches and sketch entities is not currently supported so attributes added to these will be ignored.&#0160; When you specify the layer of an entity using this technique it overrides the dialog settings.&#0160; For example, if an edge will normally be written to the IV_OUTER_PROFILE it will instead be written to the layer you specify using the attribute.</p>
<p>One other thing to be aware of is that only the edges that are visible are written to the DXF or DWG file.&#0160; The picture below shows a flat pattern as viewed with the Z axis pointed towards you.&#0160; This is the geometry you would expect in the output DXF or DWG file.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f2545ea970c-pi"><img alt="FlatPattern" border="0" height="386" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340115701c0359970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="FlatPattern" width="450" /></a> </p>
<br />
<p>Hereâ€™s a close-up of an area of the model where itâ€™s slightly rotated.&#0160; The red selected edge is on the â€œbackâ€ of the part and will not be written out to the DXF or DWG file.&#0160; Adding an attribute to this edge wonâ€™t have any effect since the edge is not written out.&#0160; The same is true for the bend and tangent lines too.&#0160; Only those on the â€œfrontâ€ of the part will be written out.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f2545f1970c-pi"><img alt="FlatPatternEdge" border="0" height="172" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f2545f3970c-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="FlatPatternEdge" width="244" /></a> </p>
<p></p>
<br />
<p>When edges have been attributed in this way the <strong>Save Copy As</strong> command honors this by displaying this as a layer in the dialog to allow you to choose whether to write it out or not.&#0160; Notice in the picture below that the last layer in the list is â€œCustomLayerâ€ which is the name that was assigned using the macro above.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f2545f6970c-pi"><img alt="SaveCopyAsFlatPatternAfter" border="0" height="394" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340115701c0364970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="SaveCopyAsFlatPatternAfter" width="454" /></a>&#0160; </p>
<br />
<p>These layer overrides are also honored when using the API to write out a DXF or DWG file of the flat pattern.&#0160; The program below is directly from Inventorâ€™s online help and illustrates using the API to write out a DXF file of the flat pattern.&#0160; See the topic on the DataIO object in the online help for additional information about this.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub WriteSheetMetalDXF() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active document.&#0160; This assumes it is a part document. <br /></strong></font>&#0160;&#0160;&#0160; Dim oDoc As PartDocument <br />&#0160;&#0160;&#0160; Set oDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the DataIO object. <br /></strong></font>&#0160;&#0160;&#0160; Dim oDataIO As DataIO <br />&#0160;&#0160;&#0160; Set oDataIO = oDoc.ComponentDefinition.DataIO <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Build the string that defines the format of the DXF file. <br /></strong></font>&#0160;&#0160;&#0160; Dim sOut As String <br />&#0160;&#0160;&#0160; sOut = &quot;FLAT PATTERN DXF?AcadVersion=R12&quot; <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Create the DXF file. <br /></strong></font>&#0160;&#0160;&#0160; oDataIO.WriteDataToFile sOut, &quot;C:\temp\flat.dxf&quot; <br />End Sub</p></div>
<br />
<p>If attributes are something new to you watch this blog over the next couple of weeks for additional postings explaining attributes in more detail.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: PeterCharles
EMAIL: peter.brown@tesco.net
IP: 88.106.133.78
URL: 
DATE: 04/16/2009 07:34:44 PM
A very useful tutorial, although I had to learn it the hard way.
Would be nice to change the line colours as well as the layer names.
-----
COMMENT:
AUTHOR: cheap maple story money
EMAIL: pixeltracer123@gmail.com
IP: 58.212.4.134
URL: http://www.playerassist.com/maple-story/
DATE: 07/08/2009 08:53:26 AM
Would be nice to change the line colours as well as the layer names.
-----
COMMENT:
AUTHOR: aion kinah
EMAIL: aiononline@gmail.com
IP: 115.126.20.65
URL: http://www.buyaionkinah.com/
DATE: 09/23/2009 09:17:30 AM
The picture below shows a flat pattern as viewed with the Z axis pointed towards you.  This is the geometry you would expect in the output DXF or DWG file.
-----
COMMENT:
AUTHOR: darkfall guide
EMAIL: kingston@yahoo.com
IP: 115.126.20.65
URL: http://www.playerassist.com/darkfall/
DATE: 10/30/2009 03:54:44 AM
I donâ€™t know If I said it already but â€¦Iâ€™m so glad I found this siteâ€¦Keep up the good work I read a lot of blogs on a daily basis and for the most part, people lack substance but, I just wanted to make a quick comment to say GREAT blog. Thanks!
-----
COMMENT:
AUTHOR: Scott K
EMAIL: scott.koeppel@greenheck.com
IP: 64.211.107.4
URL: 
DATE: 08/03/2010 03:47:37 PM
Can an entities other than edges be used? Like flat pattern sketches?

-----
COMMENT:
AUTHOR: C James
EMAIL: cjj@puresilica.com
IP: 78.33.62.4
URL: http://www.puresilica.com
DATE: 09/03/2010 08:49:03 PM
Hi,

I realise I must be particularly 'thick' but can anyone explain how I implement iFlatPatternExport to run within Inventor 2009. I extracted the rar into a new folder within the Inventor programme bin but when I run Inventor no export option appears to be available.

Help please?

Thank you.

CJJ
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Positioning Assembly Occurrences
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: positioning-assembly-occurrences
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/04/positioning-assembly-occurrences.html 
DATE: 04/10/2009 01:03:20 AM
-----
BODY:
<p>Rob Cohee recently posted a <a href="http://www.youtube.com/watch?v=GsE7r9iU5Rw">video</a> demonstrating some skeletal modeling techniques in Inventor related to .&#0160; To simplify the process he used a VBA macro that I wrote for him.&#0160; Itâ€™s a simple macro and is useful by itself but also helps to demonstrate some API capabilities.&#0160; Hereâ€™s the macro that I provided Rob.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub AlignOccurrencesWithConstraints() <br />&#0160;&#0160;&#0160; Dim assemblydoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set assemblydoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the occurrences in the select set. <br /></strong></font>&#0160;&#0160;&#0160; Dim occurrenceList As New Collection <br />&#0160;&#0160;&#0160; Dim entity As Object <br />&#0160;&#0160;&#0160; For Each entity In assemblydoc.SelectSet <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If TypeOf entity Is ComponentOccurrence Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; occurrenceList.Add entity <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br /><br />&#0160;&#0160;&#0160; If occurrenceList.Count &lt; 2 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;At least two occurrences must be selected.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; This assumes the first selected occurrence is the &quot;base&quot; <br />&#0160;&#0160;&#0160; &#39; and will constrain the base workplanes of all the other parts <br />&#0160;&#0160;&#0160; &#39; to the base workplanes of the first part. If there are <br />&#0160;&#0160;&#0160; &#39; constraints on the other they end up being over constrained.</strong></font></p>
<p><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the planes from the base part and create proxies for them. <br /></strong></font>&#0160;&#0160;&#0160; Dim baseOccurrence As ComponentOccurrence <br />&#0160;&#0160;&#0160; Set baseOccurrence = occurrenceList.Item(1) <br /><br />&#0160;&#0160;&#0160; Dim BaseXY As WorkPlane <br />&#0160;&#0160;&#0160; Dim BaseYZ As WorkPlane <br />&#0160;&#0160;&#0160; Dim BaseXZ As WorkPlane <br />&#0160;&#0160;&#0160; Call GetPlanes(baseOccurrence, BaseXY, BaseYZ, BaseXZ) <br /><br />&#0160;&#0160;&#0160; Dim constraints As AssemblyConstraints <br />&#0160;&#0160;&#0160; Set constraints = assemblydoc.ComponentDefinition.constraints <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through the other occurrences <br /></strong></font>&#0160;&#0160;&#0160; Dim i As Integer <br />&#0160;&#0160;&#0160; For i = 2 To occurrenceList.Count <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim thisOcc As ComponentOccurrence <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set thisOcc = occurrenceList.Item(i) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Move it to the base occurrence so that if the base is <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; not fully constrained it shouldn&#39;t move when the flush <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; constraints are added. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; thisOcc.Transformation = baseOccurrence.Transformation <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the planes from the occurrence <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim occPlaneXY As WorkPlane <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim occPlaneYZ As WorkPlane <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim occPlaneXZ As WorkPlane <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call GetPlanes(thisOcc, occPlaneXY, occPlaneYZ, occPlaneXZ) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Add the flush constraints. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call constraints.AddFlushConstraint(BaseXY, occPlaneXY, 0) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call constraints.AddFlushConstraint(BaseYZ, occPlaneYZ, 0) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call constraints.AddFlushConstraint(BaseXZ, occPlaneXZ, 0) <br />&#0160;&#0160;&#0160; Next <br />End Sub <br /><br /><font color="#0000ff"><strong>&#39; Utility function used by the AlignOccurrencesWithConstraints macro. <br />&#39; Given an occurrence it returns the base work planes that are in <br />&#39; the part or assembly the occurrence references.&#0160; It gets the <br />&#39; proxies for the planes since it needs the work planes in the <br />&#39; context of the assembly and not in the part or assembly document <br />&#39; where they actually exist.</strong></font> <br />Private Sub GetPlanes(ByVal Occurrence As ComponentOccurrence, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByRef BaseXY As WorkPlane, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByRef BaseYZ As WorkPlane, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByRef BaseXZ As WorkPlane) <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the work planes from the definition of the occurrence. <br />&#0160;&#0160;&#0160; &#39; These will be in the context of the part or subassembly, not&#0160; <br />&#0160;&#0160;&#0160; &#39; the top-level assembly, which is what we need to return. <br /></strong></font>&#0160;&#0160;&#0160; Set BaseXY = Occurrence.Definition.WorkPlanes.Item(3) <br />&#0160;&#0160;&#0160; Set BaseYZ = Occurrence.Definition.WorkPlanes.Item(1) <br />&#0160;&#0160;&#0160; Set BaseXZ = Occurrence.Definition.WorkPlanes.Item(2) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Create proxies for these planes.&#0160; This will act as the work <br />&#0160;&#0160;&#0160; &#39; plane in the context of the top-level assembly. <br /></strong></font>&#0160;&#0160;&#0160; Call Occurrence.CreateGeometryProxy(BaseXY, BaseXY) <br />&#0160;&#0160;&#0160; Call Occurrence.CreateGeometryProxy(BaseYZ, BaseYZ) <br />&#0160;&#0160;&#0160; Call Occurrence.CreateGeometryProxy(BaseXZ, BaseXZ) <br />End Sub</p></div>
<br />
<p>The program above constrains the base work planes of the set of selected occurrences to the base work planes of one other selected occurrence (the base part).&#0160; It places three flush constraints between each part and the base part.&#0160; The advantage to this is that the occurrences are all constrained to the base part so that if the base part is repositioned all of the other parts will automatically move to maintain the relationship defined by the constraints.&#0160; The disadvantage is that itâ€™s doing quite a bit of work and each constraint placement causes the assembly to recompute, which is what gave Rob time to go get coffee.</p>
<p>Thereâ€™s another approach that is much faster if you just need to position parts but donâ€™t need to associate their position to another part.&#0160; The macro below does this.&#0160; Itâ€™s simpler and runs much faster.&#0160; This macro positions the parts exactly as the previous macro but instead of creating constraints it just repositions them and then grounds them so they canâ€™t be accidentally moved.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub AlignOccurrencesWithGround() <br />&#0160;&#0160;&#0160; Dim assemblydoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set assemblydoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the occurrences in the select set.&#0160; The first occurrence <br />&#0160;&#0160;&#0160; &#39; selected will be the &quot;base&quot; where all of the other occurrences <br />&#0160;&#0160;&#0160; &#39; will be positioned relative to it. <br /></strong></font>&#0160;&#0160;&#0160; Dim baseOccurrence As ComponentOccurrence <br />&#0160;&#0160;&#0160; Dim baseTransform As Matrix <br />&#0160;&#0160;&#0160; Dim transObjects As TransientObjects <br />&#0160;&#0160;&#0160; Set transObjects = ThisApplication.TransientObjects <br />&#0160;&#0160;&#0160; Dim occList As ObjectCollection <br />&#0160;&#0160;&#0160; Set occList = transObjects.CreateObjectCollection <br />&#0160;&#0160;&#0160; Dim transformList As ObjectCollection <br />&#0160;&#0160;&#0160; Set transformList = transObjects.CreateObjectCollection <br />&#0160;&#0160;&#0160; Dim entity As Object <br />&#0160;&#0160;&#0160; For Each entity In assemblydoc.SelectSet <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check that the selected entity is an occurrence. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If TypeOf entity Is ComponentOccurrence Then <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check if the base occurrence has been assigned. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; If not then this is the first occurrence found and <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; use it as the base occurrence. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If baseOccurrence Is Nothing Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set baseOccurrence = entity <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set baseTransform = baseOccurrence.Transformation <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; This is another selected occurrence so just <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; add it to the list. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; occList.Add entity <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; transformList.Add baseTransform <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next&#0160; <br /><br />&#0160;<font color="#0000ff"><strong>&#0160;&#0160; &#39; Check that at least a base occurrence and one other occurrence <br />&#0160;&#0160;&#0160; &#39; was selected. <br /></strong></font>&#0160;&#0160;&#0160; If occList.Count &lt; 1 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;At least two occurrences must be selected.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Reposition all of the occurrences.&#0160; The TransformOccurrences <br />&#0160;&#0160;&#0160; &#39; method was new in Inventor 2009. <br /></strong></font>&#0160;&#0160;&#0160; Dim assemblyDef As AssemblyComponentDefinition <br />&#0160;&#0160;&#0160; Set assemblyDef = assemblydoc.ComponentDefinition <br />&#0160;&#0160;&#0160; Call assemblyDef.TransformOccurrences( occList, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; transformList) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through the occurrences and ground them. <br /></strong></font>&#0160;&#0160;&#0160; Dim i As Integer <br />&#0160;&#0160;&#0160; For i = 1 To occList.Count <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim thisOccurrence As ComponentOccurrence <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set thisOccurrence = occList.Item(i) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; thisOccurrence.Grounded = True <br />&#0160;&#0160;&#0160; Next <br />End Sub</p></div>
<br />
<p>Hereâ€™s one final version of this macro that is still even simpler.&#0160; In the two previous macros the selected occurrences were moved relative to the location of the first selected occurrence.&#0160; The macro below moves every occurrence to be positioned relative to the base assembly coordinate system.&#0160; It doesnâ€™t rely on selection but repositions every occurrence and grounds it.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p>Public Sub AlignOccurrencesWithOrigin() <br />&#0160;&#0160;&#0160; Dim assemblyDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set assemblyDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; Dim assemblyDef As AssemblyComponentDefinition <br />&#0160;&#0160;&#0160; Set assemblyDef = assemblyDoc.ComponentDefinition <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Create a matrix.&#0160; It is initialized as an identity matrix <br />&#0160;&#0160;&#0160; &#39; which means it defines a position as the origin and aligned <br />&#0160;&#0160;&#0160; &#39; with the global x, y, and z axes. <br /></strong></font>&#0160;&#0160;&#0160; Dim transGeom As TransientGeometry <br />&#0160;&#0160;&#0160; Set transGeom = ThisApplication.TransientGeometry <br />&#0160;&#0160;&#0160; Dim baseTransform As Matrix <br />&#0160;&#0160;&#0160; Set baseTransform = transGeom.CreateMatrix <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Create collections to load the occurrences into. <br /></strong></font>&#0160;&#0160;&#0160; Dim transObjects As TransientObjects <br />&#0160;&#0160;&#0160; Set transObjects = ThisApplication.TransientObjects <br />&#0160;&#0160;&#0160; Dim occList As ObjectCollection <br />&#0160;&#0160;&#0160; Set occList = transObjects.CreateObjectCollection <br />&#0160;&#0160;&#0160; Dim transformList As ObjectCollection <br />&#0160;&#0160;&#0160; Set transformList = transObjects.CreateObjectCollection <br /><br />&#0160;<font color="#0000ff"><strong>&#0160;&#0160; &#39; Iterate through all of the occurrences. <br /></strong></font>&#0160;&#0160;&#0160; Dim occurrence As ComponentOccurrence <br />&#0160;&#0160;&#0160; For Each occurrence In assemblyDef.Occurrences <br />&#0160;<font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Add each occurrence to the list. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; occList.Add occurrence <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Add the transform to the list. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; transformList.Add baseTransform <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Ground each occurrence.&#0160; This is ok to do here <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; because the move will ignore the ground condition. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; occurrence.Grounded = True <br />&#0160;&#0160;&#0160; Next <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Reposition all of the occurrences.&#0160; The TransformOccurrences <br />&#0160;&#0160;&#0160; &#39; method was new in Inventor 2009.&#0160; <br /></strong></font>&#0160;&#0160;&#0160; Set assemblyDef = assemblydoc.ComponentDefinition <br />&#0160;&#0160;&#0160; Call assemblyDef.TransformOccurrences(occList, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; transformList) <br />End Sub</p></div>
<br />
<p>Of course these macros just the demonstrate one solution using the API to a specific problem.&#0160; The same functionality demonstrated above and combined with other API functions can be used in many other ways to solve other problems.&#0160; All Iâ€™m trying to say is that if the macros above donâ€™t quite do what you need them to do itâ€™s time to start investigating Inventorâ€™s API so that you can modify them to solve your specific problems.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 198.102.112.18
URL: 
DATE: 04/10/2009 09:13:43 PM
I added one more sample to the post.  It's the last of the three and is simpler and is likely to be the functionality that more people will want.
-----
COMMENT:
AUTHOR: Tore Marskar Eek-Jensen
EMAIL: tme@apl.no
IP: 212.4.33.194
URL: 
DATE: 04/14/2009 08:56:07 AM
Hi Brian

Great blog. I have a question. Previously we have flushed components to origin and avoided using grouding. What would happen if I ground a component also flushed to origin. Would Inventor skip computing flush constaints sinse it's already fixed?

Cheers
Tore
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 04/14/2009 03:45:07 PM
Hi Tore,

Good question and the truth is that I don't know the answer for sure but I believe that Inventor will optimize the solve and recognizes that it can ignore any grounded components.

-Brian
-----
COMMENT:
AUTHOR: karthik
EMAIL: 
IP: 97.89.154.43
URL: http://profile.typepad.com/6p011570241faf970b
DATE: 04/16/2009 10:27:38 PM
Hi Brian
I'm using inventor 2008. In assembly i'm using  more than 100 LOD's .At this point if add one part to this assembly.. that appears in all the existing LOD's....   what would you suggest to get rid of additional parts from the existing LOD's by default.....



-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Running Commands Using the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: running-commands-using-the-api
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/03/running-commands-using-the-api.html 
DATE: 03/30/2009 11:46:45 PM
-----
BODY:
<p>Occasionally there is a need to run an Inventor command from a program.&#160; There are a couple of reasons why you might want to do this.&#160; One is when the API doesnâ€™t support some functionality but Inventor does.&#160; By running the command you can sometimes work around the API deficiency.&#160; Another reason is when you want to take advantage of the interactive behavior of a command by starting a command and then turning it over to the user finish it.</p>  <p><font size="3"><strong>Running a Command in Inventor        <br /></strong></font>It turns out that itâ€™s fairly simple to run any command in Inventor.&#160; This includes Inventorâ€™s standard commands and also Add-In commands.&#160; In the API, every command is represented as a ControlDefinition object.&#160; The ControlDefinition object supports the Execute method which is the equivalent of clicking on a button and running a command in the user-interface.&#160; Below is an example that executes the Line command in a sketch.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub RunLineCommand()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the CommandManager object.        <br /></strong></font>&#160;&#160;&#160; Dim oCommandMgr As CommandManager     <br />&#160;&#160;&#160; Set oCommandMgr = ThisApplication.CommandManager     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get control definition for the line command.        <br /></strong></font>&#160;&#160;&#160; Dim oControlDef As ControlDefinition     <br />&#160;&#160;&#160; Set oControlDef = oCommandMgr.ControlDefinitions.Item( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;SketchLineCmd&quot;)&#160; <br />&#160;&#160;&#160; ' Execute the command.     <br />&#160;&#160;&#160; Call oControlDef.Execute     <br />End Sub</div>  <p></p>  <p>&#160;</p>  <p><font size="3"><strong>Getting Command Names</strong></font>     <br />The tricky part in using the code above is knowing what the name of the command is that you want to run.&#160; In the example above it uses â€œSketchLineCmdâ€ to specify the Line command.&#160; Every control definition has a name that uniquely identifies it.&#160; There are a couple of techniques you can use to find out the name of the desired command.&#160; The first is to use a program to create a list of all of the available commands.&#160; The program below, (which is straight from Inventorâ€™s programming help), does this.&#160; It will create a file named â€œC:\Temp\CommandNames.txtâ€ that contains a list showing the name and description of every command.&#160; You can open this file using Notepad or another text editor and search for the command youâ€™re interested in.&#160; Command names are typically very similar to the command name you see in the user-interface.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Sub PrintCommandNames()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the CommandManager object.        <br /></strong></font>&#160;&#160;&#160; Dim oCommandMgr As CommandManager     <br />&#160;&#160;&#160; Set oCommandMgr = ThisApplication.CommandManager     <br />&#160;&#160;&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the collection of control definitions.        <br /></strong></font>&#160;&#160;&#160; Dim oControlDefs As ControlDefinitions     <br />&#160;&#160;&#160; Set oControlDefs = oCommandMgr.ControlDefinitions     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Open the file and print out a header line.        <br /></strong></font>&#160;&#160;&#160; Dim oControlDef As ControlDefinition     <br />&#160;&#160;&#160; Open &quot;C:\temp\CommandNames.txt&quot; For Output As #1     <br />&#160;&#160;&#160; Print #1, Tab(10); &quot;Command Name&quot;; Tab(75); _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Description&quot;; vbNewLine     <br />    <br /><font color="#0000ff">&#160;&#160;&#160; ' Iterate through the controls and write out the name.      <br /></font>&#160;&#160;&#160; For Each oControlDef In oControlDefs     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Print #1, oControlDef.InternalName; Tab(55); _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oControlDef.DescriptionText     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff">&#160;&#160;&#160; ' Close the file.      <br /></font>&#160;&#160;&#160; Close #1     <br />End Sub</div>  <p></p>  <p>   <br />Another technique to find a command name is to use the Event Watcher utility thatâ€™s delivered as part of Inventorâ€™s SDK.&#160; This utility lets you listen to the various events that Inventor supports through the API.&#160; One of these events is sent whenever a command is executed within Inventor and as part of that event it provides the name of the command that was executed.&#160; To use this follow the steps below.</p>  <ol>   <li>Have Inventor running and in a state where the command you want to use is available.&#160; For example, if you want to know the name of the Circle command you will need to have a sketch active.      <br /></li>    <li>Run EventWatcher.exe.&#160; On a Windows Vista install this is typically at:      <br /><font face="Arial Narrow" size="1">       <br />C:\Users\Public\Documents\Autodesk\Inventor 2009\SDK\DeveloperTools\Tools\EventWatcher\bin\Release         <br /></font>      <br />On a Windows XP install it is typically at:       <br /><font face="Arial Narrow" size="1">       <br />C:\Program Files\Autodesk\Inventor 2009\SDK\DeveloperTools\Tools\EventWatcher\bin\Release         <br /></font>      <br />If you canâ€™t find it, itâ€™s likely you havenâ€™t installed the developer tools portion of the SDK.&#160; To do that install DeveloperTools.msi, which is in the SDK directory.&#160; If youâ€™re running Vista youâ€™ll need to disable UAC to successfully install the developer tools.       <br /></li>    <li>In EventWatcher, find the event UserInputEvents.OnActivateCommand and make sure the event has a check mark beside it.      <br /></li>    <li>Run the whatever command in Inventor that you want to find the name for.      <br /></li>    <li>Get the command name from EventWatcher.&#160; The picture below shows the EventWatcher interface with the OnActivateCommand selected and the results after running the New Sketch and Sketch Line commands. </li> </ol>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156f985477970b-pi"><img title="EventWatcher" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="302" alt="EventWatcher" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401156e9eff13970c-pi" width="454" border="0" /></a> </p>  <p>&#160;</p>  <p><font size="3"><strong>Limitations</strong></font>     <br />Being able to run any command using the API may seem like the answer to the problem where the API doesnâ€™t cover all of Inventorâ€™s functionality.&#160; Unfortunately this isnâ€™t a solution to that problem.&#160; When you execute a command using the functionality discussed above it is exactly the same as if you had clicked on the command in the user-interface; the command is started.&#160; The problem is that most commands need additional input from the user.&#160; For example, the Extrude command displays a dialog to get the required input from the user or the Arrange Dimensions command doesnâ€™t have a dialog but does require the user to select the set of dimensions to arrange.</p>  <p>In general, when running a command using the API you canâ€™t provide the input the command is expecting so you canâ€™t fully control and use the command via the API.&#160; There are a couple of exceptions to this discussed below but for most commands you can only start them through the API.&#160; This is still useful because there are cases where you only want to start a command and then let the user take over.</p>  <p><font size="3"><strong>Providing Input to Commands</strong></font>     <br />As mentioned above, there are some exceptions about providing input to commands that will allow you to better utilize them from the API.&#160; There are two techniques of providing input to a command.&#160; The first is pre-selecting the entities that the command should process.&#160; This will only work for a small set of commands but is a workaround in a few cases where the API doesnâ€™t directly support the equivalent of the command functionality.</p>  <p>An example of the use of pre-selecting entities is the new Arrange Dimensions command in Inventor 2010.&#160; The API doesnâ€™t support this functionality yet but by using this pre-selection technique you can use the command directly.&#160; You select entities by adding them to the SelectSet object.&#160; This is the equivalent of the user selecting them.&#160; Many commands will check to see if valid entities are selected and operate on them if they are.&#160; The program below takes advantage of this.&#160; </p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub ArrangeDimensions()    <br /><font color="#0000ff">&#160;&#160;&#160; <strong>' Get the active document, assuming it is a drawing.        <br /></strong></font>&#160;&#160;&#160; Dim oDrawDoc As DrawingDocument     <br />&#160;&#160;&#160; Set oDrawDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the collection of dimensions on the active sheet.        <br /></strong></font>&#160;&#160;&#160; Dim oDimensions As DrawingDimensions     <br />&#160;&#160;&#160; Set oDimensions = oDrawDoc.ActiveSheet.DrawingDimensions     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the select set and clear it.        <br /></strong></font>&#160;&#160;&#160; Dim oSelectSet As SelectSet     <br />&#160;&#160;&#160; Set oSelectSet = oDrawDoc.SelectSet     <br />&#160;&#160;&#160; oSelectSet.Clear     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add each dimension to the select set to select them.        <br /></strong></font>&#160;&#160;&#160; Dim oDrawDim As DrawingDimension     <br />&#160;&#160;&#160; For Each oDrawDim In oDimensions     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSelectSet.Select oDrawDim     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff"><strong>&#160;&#160; ' Get the CommandManager object.        <br /></strong></font>&#160;&#160;&#160; Dim oCommandMgr As CommandManager     <br />&#160;&#160;&#160; Set oCommandMgr = ThisApplication.CommandManager     <p></p>    <p>&#160;<font color="#0000ff"><strong>&#160;&#160; ' Get control definition for the arrange dimensions command.          <br /></strong></font>&#160;&#160;&#160; Dim oControlDef As ControlDefinition       <br />&#160;&#160;&#160; Set oControlDef = oCommandMgr.ControlDefinitions.Item( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;DrawingArrangeDimensionsCmd&quot;) </p>    <p>&#160;<font color="#0000ff"><strong>&#160;&#160; ' Execute the command.          <br /></strong></font>&#160;&#160;&#160; Call oControlDef.Execute       <br />End Sub</p> </div>  <p></p>  <p>&#160;</p>  <p>In the case of the Arrange Dimensions sample above, it fully completes the command.&#160; That is when you run the macro, all of the dimensions on the active sheet will be re-arranged.&#160; Thatâ€™s because if the command sees some dimensions in the select set it operates on them without asking for any more input.&#160; Most commands, even if they support pre-selection of entities, will still allow additional selection so they will still require user input.&#160; For example the Fillet command will take any pre-selected edges as input but still displays the dialog to allow the user to select more edges and specify any other options.</p>  <p>There is another way of providing input for most commands expect a filename as input.&#160; Through the API you can predefine a filename and then run the command.&#160; If a filename is defined, the command will use it.&#160; For some commands, where only a filename is needed, it will skip the dialog portion of the command, for example the Place Component command.&#160; Where more information is required it will use the predefined filename as the default filename and the command will run as normal by displaying its dialog so the user can change the filename and/or set other options.&#160; The Base View command thatâ€™s used to create a drawing view is a good example of this.</p>  <p>You predefine a filename using the PostPrivateEvent method of the CommandManager object.&#160; The example below demonstrates its use with the Place Component command.&#160; When the macro executes the Place Component command checks to see if a filename has already been defined.&#160; If it has it uses that filename and skips the dialog step and continues to the step where the user can specify the placement point of the component.&#160; This is a good example of defining the inputs and then allowing the command to take over so you can take advantage of the interactivity the command provides.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub PlacePart()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the command manager.        <br /></strong></font>&#160;&#160;&#160; Dim oCommandMgr As CommandManager     <br />&#160;&#160;&#160; Set oCommandMgr = ThisApplication.CommandManager     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Post the filename.        <br /></strong></font>&#160;&#160;&#160; Call oCommandMgr.PostPrivateEvent(kFileNameEvent, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;C:\Users\ekinsb\Documents\Inventor 2010\Showcasetest.ipt&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get control definition for the place component command.        <br /></strong></font>&#160;&#160;&#160; Dim oControlDef As ControlDefinition     <br />&#160;&#160;&#160; Set oControlDef = oCommandMgr.ControlDefinitions.Item( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;AssemblyPlaceComponentCmd&quot;)&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Execute the command.        <br /></strong></font>&#160;&#160;&#160; Call oControlDef.Execute     <br />End Sub</div>  <p></p>  <p>&#160;</p>  <p><font size="3"><strong>Command Execution Behavior</strong></font></p>  <p>In all of the examples above the Execute method has been used to run the desired command.&#160; The behavior of this method is to tell Inventor to run the command but immediately return control back to your program.&#160; In the example of placing a component in the assembly, control returns back to the macro right after calling Execute, event though the user is still in the middle of placing components.&#160; In many cases this is ok because itâ€™s likely this is the last step in your program, but sometimes you may want to wait until the command has been completed and then finish some additional steps in your program.&#160; You can do this using the Execute2 method.&#160; This method has a single argument indicating if you want to run the command synchronously or asynchronously.&#160; Asynchronous is the same as the Execute method and will immediately return control back to your program.&#160; Synchronous wonâ€™t return control back to your program until the command has finished processing.&#160; </p>  <p></p>  <p>Hereâ€™s a variation of the previous program that reports on which components were just placed.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub PlacePart2()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the assembly component definition.        <br /></strong></font>&#160;&#160;&#160; Dim oAsmDef As AssemblyComponentDefinition     <br />&#160;&#160;&#160; Set oAsmDef = ThisApplication.ActiveDocument.ComponentDefinition     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the command manager.        <br /></strong></font>&#160;&#160;&#160; Dim oCommandMgr As CommandManager     <br />&#160;&#160;&#160; Set oCommandMgr = ThisApplication.CommandManager     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Post the filename.        <br /></strong></font>&#160;&#160;&#160; Call oCommandMgr.PostPrivateEvent(kFileNameEvent, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;C:\Users\ekinsb\Documents\Inventor 2010\Showcasetest.ipt&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get control definition for the place component command.        <br /></strong></font>&#160;&#160;&#160; Dim oControlDef As ControlDefinition     <br />&#160;&#160;&#160; Set oControlDef = oCommandMgr.ControlDefinitions.Item( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;AssemblyPlaceComponentCmd&quot;)     <p></p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the current number of occurrences.          <br /></strong></font>&#160;&#160;&#160; Dim iOccurrenceCount As Long       <br />&#160;&#160;&#160; iOccurrenceCount = oAsmDef.Occurrences.Count&#160; <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Execute the command synchronously.&#160; <br /></strong></font>&#160;&#160;&#160; Call oControlDef.Execute2(True)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Display information about the placed components.          <br /></strong></font>&#160;&#160;&#160; Dim strPrompt As String       <br />&#160;&#160;&#160; strPrompt = oAsmDef.Occurrences.Count - iOccurrenceCount &amp; _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot; occurrences were placed:&quot; &amp; vbCr       <br />&#160;&#160;&#160; Dim i As Integer       <br />&#160;&#160;&#160; For i = iOccurrenceCount + 1 To oAsmDef.Occurrences.Count       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; strPrompt = strPrompt &amp; &quot;&#160;&#160;&#160; &quot; &amp; _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAsmDef.Occurrences.Item(i).Name &amp; vbCr       <br />&#160;&#160;&#160; Next       <br />&#160;&#160;&#160; MsgBox strPrompt       <br />End Sub</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Vladimir Ananiev
EMAIL: vananiev@gmail.com
IP: 91.77.233.114
URL: 
DATE: 04/05/2009 01:14:52 PM
Thank you, Brian, for this post.

In Inventor 2009 Execute2(True)  doesnâ€™t work as described. 
So I still have to use loop like

Do While ThisApplication.CommandManager. _
   ActiveCommand="AssemblyPlaceComponentCmd" 
   DoEvents
Loop

Is Execute2 method specific to Inventor 2010 release?

Vladimir
-----
COMMENT:
AUTHOR: Raminder Singh
EMAIL: givemespamfor-whatever@yahoo.co.in
IP: 122.162.230.53
URL: 
DATE: 04/09/2009 01:19:45 PM
Hi Vladimir,

I've Inventor 2009 and its api also exposes Execute2 method. So it's not specific to 2010.
-----
COMMENT:
AUTHOR: xxxtomxxx
EMAIL: tom.bradley@narec.co.uk
IP: 213.131.97.201
URL: http://www.narec.co.uk
DATE: 04/30/2009 03:56:24 PM
Hello, I'm using the below code in an activated sketch, yet nothing seems to happen. Are there specific different commands when using SketchProjectCutEdgescmd?


Dim oDef As ControlDefinition
    
Set oDef = ThisApplication.CommandManager.ControlDefinitions.Item("SketchProjectCutEdgesCmd")

oDef.Execute

-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 198.102.112.18
URL: 
DATE: 05/01/2009 07:53:47 PM
Here's some code that I've copied from a program I had previously written that does exactly what you're trying to do.  I don't remember why I set the SilentOperation property.

' Create a sketch on the work plane.
Dim invSketch As PlanarSketch
Set invSketch = PartCompDef.Sketches.Add(invWorkPlane)
        
' Call the Project Cut Edges command.
invSketch.Edit
        
ThisApplication.SilentOperation = True
        ThisApplication.CommandManager.ControlDefinitions.Item("SketchProjectCutEdgesCmd").Execute
ThisApplication.SilentOperation = False

invSketch.ExitEdit
ThisApplication.ActiveView.Update

-----
COMMENT:
AUTHOR: Cristiano
EMAIL: cristianoarquivo@gmail.com
IP: 189.30.16.90
URL: 
DATE: 07/03/2009 02:44:51 PM
Hi,
Use your example PlacePart with command RenameBrowserNodes and pre-setting Default Option.

How I use the kCommandNameEvent and define in the option?
Call oCommandMgr.PostPrivateEvent(kCommandNameEvent, "Default")


-----
COMMENT:
AUTHOR: Alan
EMAIL: ahughes@efcocorp.com
IP: 64.22.226.2
URL: 
DATE: 07/19/2010 08:24:07 PM
Brian,

I have an odd situation.  I'm using the the CommandManager to execute an export of a face to get to a pline of the surface's edges in Autocad (which is used by a vendor to create an extrusion die).  Here's the applicable portion of the code (in c#):


partDoc:  previously assigned to the active Part Document.  

dieProfile:  previously selected by the user via user interactions (type Inventor.Face).
 


partDoc.SelectSet.Clear();
            partDoc.SelectSet.Select(dieProfile);

controlDef = commandManager.ControlDefinitions["GeomToDXFCommand"];
 controlDef.Execute();


The code above runs correctly when my program runs as an external program that hooks into an existing instance of Inventor.  The problem is that whenever I convert my program to run as an add-in the exact same code above doesn't appear to execute (or at least the export never happens).  Any ideas?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Combining Multiple Actions into a Single Undo
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: combining-multiple-actions-into-a-single-undo
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/03/combining-multiple-actions-into-a-single-undo.html 
DATE: 03/12/2009 11:53:46 PM
-----
BODY:
<p>A question was recently asked in the customization newsgroup about how to combine several actions into one undo.&#160; I think this topic is of general interest and a good one to discuss here.&#160; I think this is a capability that's typically overlooked but is something that's easy to add to your existing macros.&#160; Below is an example of a simple macro that draws a triangle on the active sketch.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub DrawTriangle()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see that a sketch is active.        <br /></strong></font>&#160;&#160;&#160; If Not TypeOf ThisApplication.ActiveEditObject Is sketch Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A sketch must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the sketch.        <br /></strong></font>&#160;&#160;&#160; Dim oSketch As sketch     <br />&#160;&#160;&#160; Set oSketch = ThisApplication.ActiveEditObject     <br />    <br />&#160;&#160;&#160; Dim oTG As TransientGeometry     <br />&#160;&#160;&#160; Set oTG = ThisApplication.TransientGeometry     <br />    <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Draw the three lines of the triangle.        <br /></font></strong>&#160;&#160;&#160; Dim aoLines(2) As SketchLine     <br />&#160;&#160;&#160; Set aoLines(0) = oSketch.SketchLines.AddByTwoPoints( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(0, 0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(5, 0))     <br />&#160;&#160;&#160; Set aoLines(1) = oSketch.SketchLines.AddByTwoPoints( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).EndSketchPoint, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(2.5, 4))     <br />&#160;&#160;&#160; Set aoLines(2) = oSketch.SketchLines.AddByTwoPoints( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(1).EndSketchPoint, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).StartSketchPoint)     <br />    <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Add a horizontal constraint to the bottom line.        <br /></font></strong>&#160;&#160;&#160; Call oSketch.GeometricConstraints.AddHorizontal(aoLines(0))     <br />End Sub </div>  <p></p>  <p>   <br />If you run this program it will create a triangle.&#160; If you want to get rid of the triangle you'll need to do 4 undo steps, one for the horizontal constraint and three for the lines.&#160; Since from the users perspective this was all created as a single step it would be nice if it would undo using a single undo.     <br /></p>  <p></p>  <p><strong><font size="3">Transaction Basics        <br /></font></strong>You can combine multiple actions into a single undo using <em>transactions</em>.&#160; A transaction is any action that can be undone.&#160; Many, if not most, API calls are not transacted.&#160; In the example above, checking that a sketch is active, getting the sketch, and getting the TransientGeometry are not transacted since they don't cause any change to the current document.&#160; Creating the lines and the horizontal constraint are automatically transacted.&#160; If you don't do anything special, each API call that causes a transaction will show up in the undo list as an individual item and can be undone.</p>  <p>To combine a set of actions into a single undo the API allows you to create your own transaction which wraps the other transactions.&#160; Since the other transactions are nested within your transaction they aren't visible in the undo command and are undone and redone as a group whenever your transaction is undone or redone.&#160; The functionality to use transactions through the API is supported through the TransactionManager object.&#160; The modified version of the previous program shown below demonstrates this. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub DrawTriangle()    <br /><font color="#0000ff">&#160;<strong>&#160;&#160; ' Check to see that a sketch is active.        <br /></strong></font>&#160;&#160;&#160; If Not TypeOf ThisApplication.ActiveEditObject Is sketch Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A sketch must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the sketch.        <br /></strong></font>&#160;&#160;&#160; Dim oSketch As sketch     <br />&#160;&#160;&#160; Set oSketch = ThisApplication.ActiveEditObject     <br />    <br />&#160;&#160;&#160; Dim oTG As TransientGeometry     <br />&#160;&#160;&#160; Set oTG = ThisApplication.TransientGeometry     <br />    <br /><font color="#0000ff">&#160;&#160;&#160; ' Create a transaction. </font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#ff0000">&#160;&#160;&#160; Dim oTransMgr As TransactionManager</font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#ff0000">&#160;&#160;&#160; Set oTransMgr = ThisApplication.TransactionManager      <br />&#160;&#160;&#160; Dim oTrans As Transaction       <br />&#160;&#160;&#160; Set oTrans = oTransMgr.StartTransaction( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ActiveDocument, &quot;Create Triangle&quot;)       <br /></font>    <br /><font color="#0000ff">&#160;&#160;&#160; ' Draw the three lines of the triangle.      <br /></font>&#160;&#160;&#160; Dim aoLines(2) As SketchLine     <br />&#160;&#160;&#160; Set aoLines(0) = oSketch.SketchLines.AddByTwoPoints( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d0,0),     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(5, 0))     <br />&#160;&#160;&#160; Set aoLines(1) = oSketch.SketchLines.AddByTwoPoints( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).EndSketchPoint,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(2.5, 4))     <br />&#160;&#160;&#160; Set aoLines(2) = oSketch.SketchLines.AddByTwoPoints( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(1).EndSketchPoint,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).StartSketchPoint)&#160; <br />    <br /><font color="#0000ff">&#160;&#160;&#160; ' Add a horizontal constraint to the bottom line.      <br /></font>&#160;&#160;&#160; Call oSketch.GeometricConstraints.AddHorizontal(aoLines(0))     <br />    <br />&#160;<font color="#0000ff">&#160;&#160; ' End the transaction.      <br /></font><font color="#ff0000">&#160;&#160;&#160; oTrans.End      <br /></font>End Sub </div>  <p>   <br />There are four extra lines from the previous program that are highlighted in red.&#160; After running this program and looking in the Edit menu you'll see that you can undo &quot;Create Triangle&quot;, as shown in the picture below.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401127964e52328a4-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="116" alt="UndoInEditMenu" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834011168f09138970c-pi" width="244" border="0" /></a></p>  <p>&#160;</p>  <p>For many programs these four extra lines are all that you'll need to implement undo behavior.&#160; The StartTransaction method creates and starts your transaction.&#160; The first argument is a document and can be any document, it doesn't matter which one.&#160; The second argument is the text that will appear in the Edit menu and can be whatever string you want to describe the group of steps being wrapped by this transaction.&#160; The API calls after the StartTransaction and before the call of the End method will be nested within your transaction.</p>  <p><font size="3"><strong></strong></font></p>  <p><font size="3"><strong>Handling Errors</strong></font>     <br />The code above does demonstrate the minimum to wrap multiple actions into a single undo.&#160; The only problem with it is if something happens in the program so that the Transaction.End method is never called.&#160; For example, if an error is encountered when creating the lines.&#160; In this case your transaction is started, some other transactions are created as a result of the API calls and are nested within your transaction but then it terminates if an error occurs, which leaves Inventor in a bit of a weird state.&#160; To make sure this doesn't happen it's best to correctly handle any errors that might occur.&#160; The modified example code below illustrates this.&#160; <br /></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub DrawTriangle()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Enable error handling.        <br /></strong></font><font color="#ff0000">&#160;&#160;&#160; On Error GoTo ErrorFound      <br /></font>    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see that a sketch is active.        <br /></strong></font>&#160;&#160;&#160; If Not TypeOf ThisApplication.ActiveEditObject Is sketch Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A sketch must be active.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the sketch.        <br /></strong></font>&#160;&#160;&#160; Dim oSketch As sketch     <br />&#160;&#160;&#160; Set oSketch = ThisApplication.ActiveEditObject     <br />    <br />&#160;&#160;&#160; Dim oTG As TransientGeometry     <br />&#160;&#160;&#160; Set oTG = ThisApplication.TransientGeometry     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create a transaction.        <br /></strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oTransMgr As TransactionManager</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Set oTransMgr = ThisApplication.TransactionManager    <br />&#160;&#160;&#160; Dim oTrans As Transaction     <br />&#160;&#160;&#160; Set oTrans = oTransMgr.StartTransaction( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ActiveDocument, &quot;Create Triangle&quot;)     <br /></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Draw the three lines of the triangle.        <br /></strong></font>&#160;&#160;&#160; Dim aoLines(2) As SketchLine     <br />&#160;&#160;&#160; Set aoLines(0) = oSketch.SketchLines.AddByTwoPoints( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(0, 0),     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(5, 0))     <br />&#160;&#160;&#160; Set aoLines(1) = oSketch.SketchLines.AddByTwoPoints( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).EndSketchPoint,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(2.5, 4))     <br />&#160;&#160;&#160; Set aoLines(2) = oSketch.SketchLines.AddByTwoPoints( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(1).EndSketchPoint,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aoLines(0).StartSketchPoint)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add a horizontal constraint to the bottom line.        <br /></strong></font>&#160;&#160;&#160; Call oSketch.GeometricConstraints.AddHorizontal(aoLines(0))     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' End the transaction.        <br /></strong></font>&#160;&#160;&#160; oTrans.End     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' No errors were found so exit before the error handling code.        <br /></strong></font><font color="#ff0000">&#160;&#160;&#160; Exit Sub      <br /></font>    <br /><font color="#0000ff"><strong>' Handle any errors        <br /></strong></font><font color="#ff0000">ErrorFound:      <br />&#160;&#160;&#160; MsgBox &quot;Unexpected error encountered.&quot;       <br /></font>    <br /><strong>&#160;</strong><font color="#0000ff"><strong>&#160;&#160; ' Check to see if a transaction was started.        <br /></strong></font><font color="#ff0000">&#160;&#160;&#160; If Not oTrans Is Nothing Then      <br /></font><strong><font color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Abort the transaction.        <br /></font></strong><font color="#ff0000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTrans.Abort      <br />&#160;&#160;&#160; End If       <br /></font>End Sub </div>  <p>   <br />The new code is highlighted.&#160; At the beginning of the macro the On Error statement is used to turn on error handling.&#160; In this case it's set up to jump to the ErrorFound: line if any error should occur.&#160; In the ErrorFound: section it checks to see if a transaction object was created and if it was it calls the Transaction.Abort method.&#160; This results in undoing every action since your transaction was created.&#160; Instead of the Abort method the End method could have been called which will result in creating everything that was created up to the point of the error occurring.&#160; The choice is yours whether to use Abort or End.&#160; The reason this section checks to see if a transaction was created before call Abort is because an error could have occurred before the transaction was created and calling Abort or End would fail since your transaction object won't exist.</p>  <p>&#160;</p>  <p><font size="3"><strong>Transaction Issues to be Aware Of</strong></font>&#160; <br />There are a couple of things to be aware of when using transactions through the API.&#160; First, let's look at the behavior of Inventor relative to transactions and undo.&#160; Try this:</p>  <ol>   <li>Create a new part document. </li>    <li>Create another new part document. </li>    <li>In one of the part documents (part 1), draw some lines in a sketch. </li>    <li>Activate the other part document (part 2) and draw two lines. </li>    <li>Activate part 1 and draw one line. </li>    <li>Do an undo and the line will go away. </li>    <li>Do another undo.&#160; One of the lines in part 2 will go away. </li>    <li>Close part 1. </li>    <li>Do another undo. </li> </ol>  <p>There are two things to notice from the above steps.&#160; First is that there is a single undo list for all of Inventor, not for each document.&#160; The fact that you performed operations in different documents doesn't matter, all actions go onto a single undo list and are undone in the order they were performed.&#160; The second issue is that in step 9 you are unable to do an undo because the undo command is unavailable.&#160; This is because when a document is closed the undo stack is cleared.&#160; This seems like a fairly big limitation but doesn't seem to matter in the real world since I've never found anyone that knew of this behavior before I showed it to them.</p>  <p>Because the undo stack is cleared when a document is closed you can't wrap the opening and closing of documents in a transaction.&#160; That's probably the single biggest problem people have when using transactions.&#160; There is one exception to this rule.&#160; If the opening and closing of a document is done within your transaction, then it's ok.&#160; For example, you could perform the following steps:</p>  <ol>   <li>Start a transaction. </li>    <li>Open a part. </li>    <li>Change a parameter. </li>    <li>Update the part. </li>    <li>Save a copy to a new file. </li>    <li>Close the part. </li>    <li>Insert the new part into the assembly. </li>    <li>End the transaction. </li> </ol>  <p>Even though a document was closed, it didn't clear the undo stack since the opening and closing of the document was within your transaction.&#160; If you perform an undo after the previous steps, the part will be removed from the assembly.&#160; However, the file on disk will remain.</p>  <p>&#160;</p>  <p><font size="3"><strong>Other Functionality</strong></font>&#160; <br />The TransactionManager supports a lot more functionality than Iâ€™ve described here.&#160; However, I think the samples above demonstrate all thatâ€™s needed by 99.9% of the programs written.&#160; There are descriptions of the additional functionality in the online help, if youâ€™re interested.</p>  <p>You might also see references to something called a <em>change processor</em>.&#160; This is a different mechanism for grouping multiple operations within a single undo but itâ€™s much more complicated to use and cannot be used from within VBA.&#160; I wouldnâ€™t recommend it for most programs.&#160; In fact I would only recommend it for larger application type of add-ins (like Tube &amp; Pipe) that want to automate testing their custom commands.&#160; The change processor provides important functionality to support that.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Daniele
EMAIL: d.piazza@qsinformatica.it
IP: 87.9.27.7
URL: 
DATE: 03/17/2009 01:25:14 PM
Interesting article. Using transaction you also have to consider the huge amount of memory Inventor consumes. Using single steps (no transaction) Inventor releases the memory at every step. With transaction the memory will be released just at the end. This might lead to potential crashes.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 04/13/2009 10:24:42 PM
This will cause a bit more memory to be consumed but no more than you would expect if you adjusted the number of undo steps available.  To illustrate let's assume that the undo stack will allow up to 10 undo operations.  When working interactively that means the memory consumed will be up to 10 individual actions.  By using the API it is still 10 actions but those actions can wrap multiple sub-actions.  For example, you might write a macro that uses transactions and creates 100 lines.  Internally there were 100 transactions but they're grouped into a single transaction for undo.  Those 100 transactions will used whatever memory is needed to support undo.  When they drop off the undo stack that memory will be recovered.

I think it's a small price to pay to be able to undo the placement of the 100 lines whereas without the transaction ability the user would have only been able to undo 10 of the 100, in this example.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Accessing Assembly Components
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: accessing-assembly-components
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/03/accessing-assembly-components.html 
DATE: 03/05/2009 12:45:45 AM
-----
BODY:
<p>A common need when working with an assembly is accessing the components that make up the assembly.&#0160; This reason to do this can be for a lot of reasons from creating your own custom BOM to editing parameter values within certain parts.&#0160; Hereâ€™s a quick overview of how to access its components.&#0160; (For this discussion Iâ€™m going to focus only on the parts and subassemblies within an assembly and not anything else that can be in an assembly; constraints, assembly features, level of detail, etc.)</p>
<p><strong><font size="3">What is an Assembly?</font></strong> <br />For the topic at hand, an assembly can be thought of as a container that contains instances of parts and other assembles.&#0160; Each instance (or occurrence) defines a position within the assembly and other properties that define the appearance and behavior (color, visibility, adaptive, etc.) of the instance.&#0160; An instance doesnâ€™t contain any geometry but displays the geometry that it gets from the referenced part.&#0160; A part can be referenced once and then instanced many times by displaying that single part in different locations in the assembly.&#0160; Below is the example assembly Iâ€™ll use to illustrate.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834011168baac16970c-pi"><img alt="AssemblyStructureAssembly" border="0" height="294" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834011168baac5a970c-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="AssemblyStructureAssembly" width="454" /></a> </p>
<br />
<p>Below is the browser for this assembly.&#0160; You can see that the assembly consists of 14 occurrences where two of these are subassemblies and 12 of them are parts.&#0160; There is one unique subassembly and 5 unique parts, which is illustrated in the view of Windows Explorer shown below.&#0160; The geometry for the parts only exists within the five .ipt files.&#0160; The assembly references these parts and displays their graphics at positions defined by the location of the occurrence that represents the part.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340112792f5be328a4-pi"><img alt="AssemblyStructureBrowser" border="0" height="383" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340112792f5c4f28a4-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="AssemblyStructureBrowser" width="465" /></a> </p>
<p>Here are some API terms you should be familiar with for the rest of the discussion:</p>
<blockquote>
<p><em><strong>ComponentOccurrence</strong></em> â€“ This is the API object that represents an occurrence within an assembly.&#0160; A ComponentOccurrence can represent a subassembly or part and can be at any level of the assembly.&#0160; The example assembly above is represented by 14 ComponentOccurrence API objects.</p>
<p><em><strong>File Reference</strong> â€“ </em>This is the reference between the assembly to the subassemblies and parts it contains.&#0160; In the example above there are six file references within the assembly to the various subassemblies and parts that are referenced.&#0160; There is only ever one file reference for a particular file.&#0160; For example, even though there are four Pillar parts, there is only one file reference between the assembly and the Pillar.ipt file.&#0160; For more information about file references see the previous post <a href="http://modthemachine.typepad.com/my_weblog/2008/11/understanding-file-references.html" title="Understanding File References">Understanding File References</a>.</p>
<p><em><strong>Leaf Occurrences</strong></em> â€“ These are occurrences that define the end of each branch as you traverse an assembly.&#0160; In Inventor all parts are considered leaf occurrences.</p></blockquote>
<p>There are a few ways to access the occurrences of an assembly.&#0160; Which one to use depends on what youâ€™ll be doing with the results.&#0160; Below are descriptions and samples illustrating each one.</p>
<p><strong><font size="3">Assembly Structure</font> <br /></strong>The first method is to access the full assembly structure.&#0160; This provides all of the occurrences and the full assembly tree, just as you see it in the browser.&#0160; This provides the complete view of the assembly and should be a sufficient amount of information for any task that needs the complete structure.&#0160; </p>
<p>Writing a program to access the full assembly tree is the most difficult of the approaches discussed here.&#0160; This is because an assembly tree is not a pre-defined size.&#0160; An assembly can have any number of levels with each level having any number of occurrences.&#0160; Itâ€™s a tree with any number of branches.&#0160; To get the full assembly structure you need to walk down every branch until you reach every leaf.&#0160; To handle a problem like this you need to use a recursive function, which is demonstrated in the code below. </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub TraverseAssemblySample() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set oAsmDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; Debug.Print oAsmDoc.DisplayName <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Call the function that does the recursion. <br /></strong></font>&#0160;&#0160;&#0160; Call TraverseAssembly(oAsmDoc.ComponentDefinition.Occurrences, 1) <br />End Sub <br /><br />Private Sub TraverseAssembly(Occurrences As ComponentOccurrences, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Level As Integer) <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through all of the occurrence in this collection.&#0160; This <br />&#0160;&#0160;&#0160; &#39; represents the occurrences at the top level of an assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oOcc As ComponentOccurrence <br />&#0160;&#0160;&#0160; For Each oOcc In Occurrences <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Print the name of the current occurrence. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print Space(Level * 3) &amp; oOcc.Name <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check to see if this occurrence represents a subassembly <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; and recursively call this function to traverse through it. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If oOcc.DefinitionDocumentType = kAssemblyDocumentObject Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call TraverseAssembly(oOcc.SubOccurrences, Level + 1) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br />End Sub</div>
<p></p>
<br />
<p>The TraverseAssemblySample sub gets the active assembly document and calls the TraverseAssembly sub, passing in the collection of occurrences from the top-level assembly.&#0160; The Occurrences property of the AssemblyComponentDefinition object and the SubOccurrences property of the ComponentOccurrence object only return the occurrences directly within that assembly, not in any of its subassemblies.&#0160; The TraverseAssembly Sub then does all the work to walk the tree.&#0160; It iterates through each occurrences in the collection and for this sample,&#0160; prints out the name of each occurrence, but anything could be done with the occurrence at that point.&#0160; The next thing it does is whatâ€™s the most interesting; it checks to see if the occurrence is a subassembly or a part and if it is a subassembly it calls the TraverseAssembly sub again, passing the collection of occurrences in that subassembly.&#0160; The fact that the sub is calling itself is recursion.&#0160; It continues this process until itâ€™s completely walked the assembly tree. <br /><br />When running the program using the previous sample assembly, the following is written into the VBA Immediate window.&#0160; You can compare this with the browser view of the assembly and see that they match.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Sample.iam <br />&#0160;&#0160; Floor:1 <br />&#0160;&#0160; Arch:1 <br />&#0160;&#0160;&#0160;&#0160;&#0160; CurvedSupport:1 <br />&#0160;&#0160;&#0160;&#0160;&#0160; CurvedSupport:2 <br />&#0160;&#0160;&#0160;&#0160;&#0160; ArchTop:1 <br />&#0160;&#0160; Arch:2 <br />&#0160;&#0160;&#0160;&#0160;&#0160; CurvedSupport:1 <br />&#0160;&#0160;&#0160;&#0160;&#0160; CurvedSupport:2 <br />&#0160;&#0160;&#0160;&#0160;&#0160; ArchTop:1 <br />&#0160;&#0160; Pillar:1 <br />&#0160;&#0160; Pillar:2 <br />&#0160;&#0160; Pillar:3 <br />&#0160;&#0160; Pillar:4 <br />&#0160;&#0160; Inventor:1</div>
<br />
<p>There are a couple of things to point out in the program.&#0160; One is the â€œLevelâ€ argument of the TraverseAssembly sub.&#0160; This is used to keep track of what level of the assembly the program is currently at so it can correctly indent the output of the tree and is not required to walk an assembly tree.&#0160; The area of the code that you would replace to do the work you want to perform with each occurrence is the line where it prints out the occurrence name.&#0160; This line is executed for every occurrence in the assembly.&#0160; You can replace this with code that performs whatever functionality you need to accomplish.&#0160; For example, if you need to create a custom BOM your code might access the document thatâ€™s referenced by this occurrence and extract some iProperty values and then print this out as part of a structured BOM. <br /></p>
<p><strong><font size="3">Occurrence Lists</font>&#0160; <br /></strong>For several releases of Inventor the only way to access the assembly through the API was to traverse the entire tree, as shown above.&#0160; Often you donâ€™t need the tree structure but just want a simple list of the contents of the assembly.&#0160; There are a couple of properties that provide this simpler access to the assembly contents.</p>
<p><strong>All Leaf Occurrences <br /></strong>This first example uses the AllLeafOccurrences property of the ComponentOccurrences object which returns a collection that contains all of the leaf occurrences of an entire assembly.&#0160; the leaf occurrences at every level of the assembly are returned in this single collection.&#0160; Remember that the leaf occurrences are the parts, so this wonâ€™t contain any subassembly occurrences.&#0160; The AllLeafOccurrences property also has one optional argument, (that isnâ€™t used in the sample below), that provides some additional flexibility by allowing you to get only the leaf occurrences for a specified subassembly.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub GetPartOccurrences() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set oAsmDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the assembly component definition. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDef As AssemblyComponentDefinition <br />&#0160;&#0160;&#0160; Set oAsmDef = oAsmDoc.ComponentDefinition <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get all of the leaf occurrences of the assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oLeafOccs As ComponentOccurrencesEnumerator <br />&#0160;&#0160;&#0160; Set oLeafOccs = oAsmDef.Occurrences.AllLeafOccurrences <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through the occurrences and print the name. <br /></strong></font>&#0160;&#0160;&#0160; Dim oOcc As ComponentOccurrence <br />&#0160;&#0160;&#0160; For Each oOcc In oLeafOccs <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print oOcc.Name <br />&#0160;&#0160;&#0160; Next <br />End Sub</div>
<p></p>
<br />
<p>When the above program is run on the sample assembly the following is written to the VBA Immediate window.&#0160; Making the single call is much simpler than traversing the entire assembly looking for part occurrences.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Floor:1 <br />CurvedSupport:1 <br />CurvedSupport:2 <br />ArchTop:1 <br />CurvedSupport:1 <br />CurvedSupport:2 <br />ArchTop:1 <br />Pillar:1 <br />Pillar:2 <br />Pillar:3 <br />Pillar:4 <br />Inventor:1 </div>
<p><br /><strong>All Occurrences of a Specified Component <br /></strong>You can also get all of the occurrences that reference a specific document.&#0160; For example, you might need to access every instance of a specific fastener in an assembly to replace it with another.&#0160; To find every occurrence that references a specified document you can use the AllReferencedOccurrences property of the ComponentOccurrences object.&#0160; This property has a single required argument that specifies which part or assembly you want the referencing occurrences for.&#0160; It will return all of the occurrences at all levels of the assembly that reference the specified document.&#0160; The sample below illustrates this. </p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub FindOccurrences() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set oAsmDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the definition of the assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDef As AssemblyComponentDefinition <br />&#0160;&#0160;&#0160; Set oAsmDef = oAsmDoc.ComponentDefinition <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the document to find occurrences for. Since itâ€™s assumed <br />&#0160;&#0160;&#0160; &#39; there is at least one occurrence in the assembly that&#0160; <br />&#0160;&#0160;&#0160; &#39; references this document, it will already be open since it <br />&#0160;&#0160;&#0160; &#39; was opened when the assembly was opened. <br /></strong></font>&#0160;&#0160;&#0160; Dim oDoc As Document <br />&#0160;&#0160;&#0160; Set oDoc = ThisApplication.Documents.ItemByName( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;C:\AssemblySample\Pillar.ipt&quot;) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the occurrences that represent this document. <br /></strong></font>&#0160;&#0160;&#0160; Dim oOccs As ComponentOccurrencesEnumerator <br />&#0160;&#0160;&#0160; Set oOccs = oAsmDef.Occurrences.AllReferencedOccurrences(oDoc) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Print the occurrences to the Immediate window. <br /></strong></font>&#0160;&#0160;&#0160; Dim oOcc As ComponentOccurrence <br />&#0160;&#0160;&#0160; For Each oOcc In oOccs <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print oOcc.Name <br />&#0160;&#0160;&#0160; Next <br />End Sub</div>
<p></p>
<p><br />The output for this program is shown below.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Pillar:1 <br />Pillar:2 <br />Pillar:3 <br />Pillar:4</div>
<p></p>
<p><br />Getting a single list of specific occurrences is easier than traversing through the assembly but you also lose the assembly context that you get when traversing.&#0160; However, there are a few properties supported by the occurrence that provide this information in various ways.&#0160; If you ever need this kind of information look at the ContainingOccurrence, OccurrencePath, and ParentOccurrence properties of the ComponentOccurrence object. <br /></p>
<p><strong><font size="3">All Referenced Documents</font> <br /></strong>Another common need when working with an assembly is to access the unique documents referenced by the assembly, because in many cases you donâ€™t need individual access to each occurrence.&#0160; For example, letâ€™s say you want to change the material of all parts to a certain material.&#0160; You can do that with either one of the two previous programs by adding code that takes a given occurrence, gets the associated document, and changes its material.&#0160; The problem is that youâ€™ll end up doing a lot more work than is necessary.&#0160; For example, in the sample assembly youâ€™ll end up setting the material for the pillar part four times since itâ€™s used that many times in the assembly, where you really only need to set it once for Pillar.ipt.</p>
<p>You can do this using the list of references instead of the occurrences since there is only one reference to each document regardless of how many times itâ€™s used in the assembly.&#0160; The AllReferencedDocuments property of the AssemblyDocument object provides this.&#0160; It returns the complete set of referenced documents for the entire assembly regardless of the level in the assembly the reference actually occurs.</p>
<p>Hereâ€™s a simple example that illustrates this.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub ShowReferences() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set oAsmDoc = ThisApplication.ActiveDocument 
<p></p>
<p><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get all of the referenced documents.</strong></font> <br />&#0160;&#0160;&#0160; Dim oRefDocs As DocumentsEnumerator <br />&#0160;&#0160;&#0160; Set oRefDocs = oAsmDoc.AllReferencedDocuments <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through the list of documents. <br /></strong></font>&#0160;&#0160;&#0160; Dim oRefDoc As Document <br />&#0160;&#0160;&#0160; For Each oRefDoc In oRefDocs <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print oRefDoc.DisplayName <br />&#0160;&#0160;&#0160; Next <br />End Sub</p></div>
<p></p>
<p><br />And here are the results when this sample is run.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Pillar.ipt <br />Inventor.ipt <br />ArchTop.ipt <br />CurvedSupport.ipt <br />Arch.iam <br />Floor.ipt 
<p></p></div>
<br />
<p>Hereâ€™s a more complex sample that uses this to demonstrate setting the material of every referenced part to Gold.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub ChangeAllPartMaterial() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the active assembly document. <br /></strong></font>&#0160;&#0160;&#0160; Dim oAsmDoc As AssemblyDocument&#0160; <br />&#0160;&#0160;&#0160; Set oAsmDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get the material to assign to all of the parts. <br /></strong></font>&#0160;&#0160;&#0160; Dim strMaterialName As String <br />&#0160;&#0160;&#0160; strMaterialName = &quot;Gold&quot; <br /><br />&#0160;&#0160;&#0160; Dim oMaterial As Material <br />&#0160;&#0160;&#0160; On Error Resume Next <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Try to get the material of the specified name. <br /></strong></font>&#0160;&#0160;&#0160; Set oMaterial = oAsmDoc.Materials.Item(strMaterialName) <br />&#0160;&#0160;&#0160; If Err Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;The material &quot;&quot;&quot; &amp; strMaterialName &amp; _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;&quot;&quot; was not found in the library.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through all of the documents refrenced by the assembly. <br /></strong></font>&#0160;&#0160;&#0160; Dim oDoc As Document <br />&#0160;&#0160;&#0160; For Each oDoc In oAsmDoc.AllReferencedDocuments <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check to see if this is a part. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If oDoc.DocumentType = kPartDocumentObject Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oPartDoc As PartDocument <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oPartDoc = oDoc <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Set the material. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPartDoc.ComponentDefinition.Material = oMaterial <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br />End Sub </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Marian S.
EMAIL: slavik.marian@gmail.com
IP: 78.99.39.231
URL: 
DATE: 04/02/2009 09:12:58 PM
Hello, when using script "ChangeAllPartMaterial" an error message "Set oAsmDoc = ThisApplication.ActiveDocument" appears, in form of "Tipe mismatch"; if I remove "Set oAsm....", application shows a message, that particular kind of material is not recognized in the library. IÂ´ll be very grateful for your advice on this problem.
-----
COMMENT:
AUTHOR: Marian S.
EMAIL: slavik.marian@gmail.com
IP: 84.47.20.231
URL: 
DATE: 04/05/2009 11:53:51 PM
Hello, when using script "ChangeAllPartMaterial" an error message "Set oAsmDoc = ThisApplication.ActiveDocument" appears, in form of "Tipe mismatch"; if I remove "Set oAsm....", application shows a message, that particular kind of material is not recognized in the library. IÂ´ll be very grateful for your advice on this problem.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 04/13/2009 11:03:09 PM
I suspect the first error is because you're running this when a document besides an assembly is active.  This macro expects an assembly to be active.  The sample also expects that there is a material named "Gold" in your materials library.
-----
COMMENT:
AUTHOR: luis mestre
EMAIL: l.m.s.mestre@sapo.pt
IP: 194.105.164.226
URL: 
DATE: 01/21/2010 03:49:05 PM
Hi Brian 
I'm trying to access subassembly parameters but without sucess,can you please see my post because i have pictures that can explain better what I'm looking for.

<a href="http://discussion.autodesk.com/forums/thread.jspa?threadID=759541&tstart=0">http://discussion.autodesk.com/forums/thread.jspa?threadID=759541&tstart=0</a>

Kind regards
Luis Mestre

-----
COMMENT:
AUTHOR: ×§×•×¡×ž×˜×™×§××™×ª
EMAIL: gloriaabro2011@gmail.com
IP: 124.123.110.142
URL: http://www.gloriaabro.co.il
DATE: 06/29/2011 07:54:05 PM
Hey Brian!! I was impressed by the â€œAssembly Structureâ€ you described in the article, but when I tried writing the script and saving, I got an error saying that â€œTipe Mismatchâ€ and a dialog box appears with a dialog â€œParticular kind of material is not available in the libraryâ€.
	Can you please help me out to resolve itâ€¦..

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Setting the Weight for iPart Members
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: setting-the-weight-for-ipart-members
CATEGORY: Brian
CATEGORY: Parts

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/02/setting-the-weight-for-ipart-members.html 
DATE: 02/10/2009 09:32:27 PM
-----
BODY:
<p>There was a question posted on the customization newsgroup that I spent a little time investigating and think the answer might be of general interest.&#0160; The objective is to have a column in the iPart table that has the weight for that member.&#0160; I wasnâ€™t able to figure out a way to do this with built-in functionality in Inventor but it turned out it isnâ€™t too difficult to write a program to accomplish the task.&#0160; Although the program and description below is specific to the weight of a part, it could be modified to handle other part information that you want to associate with an iPart member.</p>
<p>First, letâ€™s look at the iPart factory to see what needs to exist for the program to function correctly.&#0160; The only thing special is that I created a custom iProperty called â€œWeightâ€ and added that as one of the iProperties that I want to set from the table.&#0160; It didnâ€™t have to be an iProperty and could have been an â€œOtherâ€ value but using an iProperty provides the most flexibility for using the value elsewhere in Inventor.&#0160; For example, in the the drawing.&#0160; The picture below shows the iPart table after setting it up with this iProperty.&#0160; The values for this new column are empty.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401116858fd95970c-pi"><img alt="iPartTable" border="0" height="275" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371e608e970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="iPartTable" width="454" /></a> </p>
<br />
<p>Now we need to assign the correct weight for each row to the weight column.&#0160; If you had to this manually you would:</p>
<ol>
<li>Activate a member. 
<li>Run the iProperties command 
<li>Go to the â€œPhysicalâ€ tab of the iProperties dialog. 
<li>Click the â€œUpdateâ€ button on the â€œPhysicalâ€ tab. 
<li>Select and Copy the â€œMassâ€ field. 
<li>Open the iPart table and paste the mass value into the table for the correct row. 
<li>Close the iPart table. 
<li>Repeat steps 1 to 7 for every row in the table. </li>
</li></li></li></li></li></li></li></ol>
<p>As you can see this is very tedious and prone to errors.&#0160; Instead of manually going through these steps they can be automated using Inventorâ€™s programming interface.&#0160; Below is a VBA macro that will do the work. </p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub UpdateWeightOfiParts() <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; â€˜ Get the active document.&#0160; This assumes it is a part. <br /></strong></font>&#0160;&#0160;&#0160; Dim oPartDoc As PartDocument <br />&#0160;&#0160;&#0160; Set oPartDoc = ThisApplication.ActiveDocument <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Check that this part is an iPart factory. <br /></strong></font>&#0160;&#0160;&#0160; If Not oPartDoc.ComponentDefinition.IsiPartFactory Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;This part must be an iPart factory.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br /><br />&#0160;&#0160;&#0160; Dim oFactory As iPartFactory <br />&#0160;&#0160;&#0160; Set oFactory = oPartDoc.ComponentDefinition.iPartFactory <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Check that there&#39;s a &quot;Weight&quot; column in the iPart table,</strong></font></div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new"><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; and get its index in the table. <br /></strong></font>&#0160;&#0160;&#0160; Dim iWeightColumnIndex As Long <br />&#0160;&#0160;&#0160; iWeightColumnIndex = GetColumnIndex(oFactory, &quot;Weight&quot;) <br />&#0160;&#0160;&#0160; If iWeightColumnIndex = -1 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;The column &quot;&quot;weight&quot;&quot; does not exist in the table.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Iterate through the rows <br /></strong></font>&#0160;&#0160;&#0160; Dim oRow As iPartTableRow <br />&#0160;&#0160;&#0160; For Each oRow In oFactory.TableRows <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Make this the active row so the model will recompute. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFactory.DefaultRow = oRow <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the weight. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim dWeight As Double <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dWeight = oPartDoc.ComponentDefinition.MassProperties.Mass <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Convert it to current mass units defined by the document. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim strWeight As String <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strWeight = oPartDoc.UnitsOfMeasure.GetStringFromValue( _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dWeight, kDefaultDisplayMassUnits) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Set the row value for the weight column. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oRow.Item(iWeightColumnIndex).Value = strWeight <br />&#0160;&#0160;&#0160; Next <br />End Sub <br /><br /><br /><font color="#0000ff"><strong>â€™ Function that given a factory and the name or a column will return <br />â€™ the index number of the column, if itâ€™s found in the factoryâ€™s <br />â€™ table.&#0160; If the column is not found it returns â€“1.&#0160; The comparison <br />â€™ of the name is done in a case insensitive way. <br /></strong></font>Private Function GetColumnIndex(ByVal Factory As iPartFactory, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal ColumnName As String) As Long <br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; â€˜ Iterate through all of the columns looking for a <br />&#0160;&#0160;&#0160; â€˜ match to the input name. <br /></strong></font>&#0160;&#0160;&#0160; Dim i As Long <br />&#0160;&#0160;&#0160; For i = 1 To Factory.TableColumns.Count <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oColumn As iPartTableColumn <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oColumn = Factory.TableColumns.Item(i) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; â€˜ Compare this column with the input name. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If LCase(oColumn.DisplayHeading) = LCase(ColumnName) Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; A matching column was found so exit. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetColumnIndex = i <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Function <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; The column wasn&#39;t found so return -1. <br /></strong></font>&#0160;&#0160;&#0160; GetColumnIndex = -1 <br />End Function</div>
<p></p>
<br />
<p>The program is essentially performing the same steps that would be required to do this manually.&#0160; Itâ€™s just able to do it much faster and without any mistakes.&#0160; After running the macro on my factory the table now looks like this.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371e60a3970b-pi"><img alt="iPartTableAfter" border="0" height="276" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371e60ac970b-pi" style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" title="iPartTableAfter" width="454" /></a></p>
<br />
<p>Itâ€™s also important to recognize that the weight is a snapshot of the weight at the time the macro was run.&#0160; If the part is modified (for example, a new feature is added) or table values are edited that affect the part geometry, the weight will no longer be correct and the macro will need to be run again to update the weight column.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Stefaan Boel
EMAIL: inventorwizard@gmail.com
IP: 194.7.161.147
URL: http://www.inventorwizard.be
DATE: 02/13/2009 01:13:49 PM
So in my opinion this just needs to be behand the save button. You even check if this an ipart so you leave the message out and you never have any issue right?
-----
COMMENT:
AUTHOR: jbaena
EMAIL: jjbt7@starmedia.com
IP: 200.13.234.98
URL: 
DATE: 03/04/2009 04:50:30 PM
Hi,Brian

Thank you very much, excellent macro. I was needing this function a long time ago.
I built from your source code, another version, but with some modifications:
- For iAssemblies too.
- Included the area field (for painting, mÂ²)
- A toolbar for with two buttons for each function.
I left the units for area as "ul", because Inventor API doesn't have explicit square units (mÂ²) only (m m).
If somebody need this macro, please send me a message.

Cheers!
-----
COMMENT:
AUTHOR: jeggert
EMAIL: jeggert@andersencorp.com
IP: 158.107.48.254
URL: 
DATE: 10/05/2010 07:54:56 PM
Is there a way to add an iPart Column through the API?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Saving Image Files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: saving-image-files
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/02/saving-image-files.html 
DATE: 02/09/2009 10:29:30 PM
-----
BODY:
<p>This is somewhat of a follow-up posting to the previous <a href="http://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html" target="_blank">Translating Files with the API</a> posting since some might consider that saving an Inventor file as a .bmp or other type of image format is a form of translating that file.&#160; Here is some information specific to saving an image file.</p>  <p>If you have an Inventor file open and run the Save Copy As command youâ€™ll notice that several of the file types shown are image files, as shown below.&#160; This is how you can interactively save an Inventor file as an image file.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c3970c-pi"><img title="SaveAsImage" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="254" alt="SaveAsImage" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c7970c-pi" width="404" border="0" /></a> </p>  <p>&#160;</p>  <p>The technique described in the <a href="http://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html" target="_blank">Translating Files with the API</a> post that uses the SaveAs method will also work for image file types too.&#160; It has all of the same advantages and disadvantages as described in the posting; itâ€™s easy to use but doesnâ€™t provide access to the setting in the options dialog, which in this case allows you to specify the resolution of the output image.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678cc970c-pi"><img title="SaveImageOptions" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="194" alt="SaveImageOptions" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678d4970c-pi" width="299" border="0" /></a> </p>  <p>   <br />    <br />When using the SaveAs method the output resolution will always be the current screen resolution.&#160; Hereâ€™s an example.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsBMP()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.</strong>       <br /></font>&#160;&#160;&#160; Dim oDoc As Document     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.activeDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save a copy as a BMP file.</strong>       <br /></font>&#160;&#160;&#160; Call oDoc.SaveAs(&quot;C:\Temp\Test.bmp&quot;, True)     <br />End Sub</div>  <br />  <br />There arenâ€™t translator add-ins for the image file formats so that option as described in the file translation posting will not work for image files.&#160; However, Inventor does support another way to save image files that does allow you to specify the output resolution.&#160; This is the View.SaveAsBitmap method.&#160; Hereâ€™s an example of using it to save a jpg file.  <p></p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsJPG()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active view.       <br /></strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oView as View    <br />&#160;&#160;&#160; Set oView = ThisApplication.ActiveView </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save the view as a jpg file.</strong>&#160; <br /></font>&#160;&#160;&#160; Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 700, 500)     <br />End Sub</div>  <br />  <br />There are a few things to understand when using this method.&#160; First is that itâ€™s a method of the View object and not the Document object.&#160; In the API the View object represents a graphics window.&#160; This method is supported on the View object because youâ€™re not saving the entire contents of a document, like you do when you use the other translators, but youâ€™re capturing a snapshot of a specific view.&#160; Itâ€™s possible to display multiple windows for a document, as illustrated below.&#160; By choosing which view to call the SaveAsBitmap method on you can control which view is saved as an image file.  <p></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371c1b72970b-pi"><img title="MultipleViews" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="293" alt="MultipleViews" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371c1b76970b-pi" width="454" border="0" /></a> </p>  <p>&#160;</p>  <p>There are a couple of ways to access a View object through the API.&#160; One of the most common, and the one used in the sample above, is to use the ActiveView property of the Application object.&#160; This returns the view that the end-user is currently working on.&#160; Only one window is ever active at a time.&#160; The other method is to use the Views property of the Document object to access all of the views associated with a particular document.</p>  <p>The second thing to understand is how to specify the format of the image file youâ€™re creating.&#160; This is done implicitly by the extension of the supplied filename.&#160; In the example above it will create a jpg file because the filename is â€œTest.jpgâ€.&#160; If â€œTest.bmpâ€ had been used instead it would have created a bmp file.&#160; You can see the formats that Inventor supports by looking at the types shown in the â€œSave as typeâ€ dropdown in the Save Copy As dialog, as shown below.&#160; Inventor currently supports bmp, gif, jpg, png, and tiff files.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c3970c-pi"><img title="SaveAsImage" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="254" alt="SaveAsImage" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c7970c-pi" width="404" border="0" /></a>&#160; </p>  <p>&#160;</p>  <p>The final thing to understand is how to control the size, or resolution, of the output image.&#160; Unlike a screen capture, youâ€™re not limited by the screen resolution.&#160; The two arguments following the filename are the height and width of the output image, where the size is specified as the number of pixels.&#160; You can provide zero as the argument value to indicate you want to use the current view size on the screen.&#160; For example, the following program will create a jpg file that is exactly the same size as the view on the screen.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsJPG()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active view.       <br /></strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oView as View    <br />&#160;&#160;&#160; Set oView = ThisApplication.ActiveView </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save the view as a jpg file.</strong>&#160; <br /></font>&#160;&#160;&#160; Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 0, 0)     <br />End Sub</div>  <p>&#160;</p>  <p>You can also use a combination of values and zeros.&#160; This can be useful when you want a specific resolution but also want to maintain the same aspect ratio as the view.&#160; The example below will create a jpg that is 2000 pixels wide and the height will be computed by Inventor to be whateverâ€™s necessary to maintain the viewâ€™s current height-width ratio.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 2000, 0)    <br /></div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: eve isk
EMAIL: sdgfdgdf@163.com
IP: 58.213.39.63
URL: http://www.playerassist.com/eve/
DATE: 06/17/2009 10:54:18 AM
You can also use a combination of values and zeros.  This can be useful when you want a specific resolution but also want to maintain the same aspect ratio as the view.  The example below will create a jpg that is 2000 pixels wide and the height will be computed by Inventor to be whateverâ€™s necessary to maintain the viewâ€™s current height-width ratio.
-----
COMMENT:
AUTHOR: buying darkfall online gold
EMAIL: pixeltracer123@gmail.com
IP: 58.212.4.134
URL: http://www.cheapdarkfallgold.com/
DATE: 07/08/2009 08:31:29 AM
The example below will create a jpg that is 2000 pixels wide and the height will be computed by Inventor to be whateverâ€™s necessary to maintain the viewâ€™s current height-width ratio.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Slide Shows and Bags
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: slide-shows-and-bags
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/02/slide-shows-and-bags.html 
DATE: 02/06/2009 08:08:41 PM
-----
BODY:
<p>Here are a couple of items that are completely off-topic but hopefully a few of you might find them interesting.</p>
<p>The first item is some software I discovered this past summer for creating slide shows.&#0160; I wasnâ€™t happy with the software that I had for creating slide shows of vacation pictures.&#0160; I searched for a commercial product but still didnâ€™t find what I was looking for at a reasonable price.&#0160; Finally I found an article that mentioned Microsoftâ€™s Photo Story.&#0160; It seemed to have what I was looking for and the price couldnâ€™t be beat since itâ€™s a free download.&#0160; Click the picture below to see a small sample I put together using pictures from a backpacking trip this summer in Olympic National Park.&#0160; (I was trying to keep the final size small for download and chose a video quality that isnâ€™t that great but you can get an idea of what the software does.)</p>
<p><a href="http://modthemachine.typepad.com/files/photostorysample.wmv"><img alt="Olympic National Park" border="0" height="292" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053714874f970b-pi" style="display: inline; border-width: 0px;" title="Olympic National Park" width="388" /></a></p>
<p>The output from PhotoStory is a wmv file so you can use it as input to Windows Movie Maker or any other video editing software and combine your photos with other video into a larger video.</p>
<p>There are a few features I wish Photo Story had but for the price I can live with itâ€™s limitations.&#0160; Hereâ€™s a link to the Microsoft site that describes <a href="http://www.microsoft.com/windowsxp/using/digitalphotography/photostory/default.mspx" rel="noopener noreferrer" target="_blank">Photo Story 3</a> and points you to the download.&#0160; By the way I highly recommend visiting the park some day too.</p>
<p>The other item I want to tell you about is that Autodesk is selling left-over bags from AU.&#0160; Every bag is unique because the center panel is made from left over vinyl banners from previous events.&#0160; Out of all of the bags from previous AUâ€™s, this is my personal favorite for usability.</p>
<p><a href="http://shop.autodesk.com/product/148/12"><img alt="Rotating Bag GIF for Homepage of shop" height="270" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340111684eb003970c-pi" style="display: inline;" title="Rotating Bag GIF for Homepage of shop" width="370" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Developer Days Online
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: developer-days-online
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/02/developer-days-online.html 
DATE: 02/06/2009 02:36:49 AM
-----
BODY:
<p>Hereâ€™s a great opportunity for you to learn about the API enhancements coming in Inventor 2010.&#0160; Itâ€™s a free online presentation describing and demonstrating the new features.&#0160; Kean Walmsley describes the event in more detail in his <a href="http://through-the-interface.typepad.com/through_the_interface/2009/02/developer-days-online.html">blog</a>.&#0160; Check out what he has to say and mark February 24th on your calendar.&#0160; See you there.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Controlling Part Colors
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: controlling-part-colors
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/02/controlling-part-colors.html 
DATE: 02/05/2009 12:18:39 AM
-----
BODY:
<p>There was a recent discussion on the newsgroup regarding setting the color of a part.&#160; Itâ€™s not particularly easy to figure out the API to do this so I thought I would put together a little primer on the concepts and some sample code that demonstrates it.</p>  <p><strong><font size="3">Overall Color of a Part        <br /></font></strong>First, a part has a defined overall color.&#160; By default this is defined as â€œAs Materialâ€ which means it will use whatever color is assigned to the current material.&#160; Using the material combo box in the part you can override this and change the part color to any other available color.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401116848128c970c-pi"><img title="PartColorList" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="151" alt="PartColorList" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834011168481293970c-pi" width="220" border="0" /></a>     <br /></p>  <p>The available colors are defined in the style library, which you can see using the Style and Standard Editor, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401116848129a970c-pi"><img title="ColorStyleEditor" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="326" alt="ColorStyleEditor" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105370dc34c970b-pi" width="434" border="0" /></a>     <br /></p>  <p>In the API, these colors are referred to as <em>RenderStyles</em>.&#160; Hereâ€™s a small program that sets the color of the active part to â€œRedâ€.&#160; When getting a render style you specify the style using its name.&#160; In the example below, if there isnâ€™t a color named â€œRedâ€ the line where it tries to get the color will fail.&#160; When using the Item property to get a specific RenderStyle the name specified is case insensitive so â€œRedâ€, â€œredâ€ or â€œREDâ€ will all work.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SetPartColor()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the RenderStyle named &quot;Red&quot;.        <br /></strong></font>&#160;&#160;&#160; Dim oRenderStyle As RenderStyle     <br />&#160;&#160;&#160; Set oRenderStyle = oPartDoc.RenderStyles.Item(&quot;Red&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Assign the render style to the part.        <br /></strong></font>&#160;&#160;&#160; oPartDoc.ActiveRenderStyle = oRenderStyle     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Force the view to update to see the change.        <br /></strong></font>&#160;&#160;&#160; ThisApplication.ActiveView.Update     <br />End Sub</div>  <p>   <br />If you want to set the part color back to â€œAs Materialâ€ then you need to set the color currently assigned to part to be the render style associated with the active material.&#160; Inventor recognizes that the assigned render style is the same as that associated with the active material and will change the setting to â€œAs Materialâ€.&#160; This is demonstrated below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SetPartToMaterialColor()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oPartDef As PartComponentDefinition</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Set oPartDef = oPartDoc.ComponentDefinition    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get a reference to the material render style.        <br /></strong></font>&#160;&#160;&#160; Dim oRenderStyle As RenderStyle     <br />&#160;&#160;&#160; Set oRenderStyle = oPartDef.Material.RenderStyle     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Assign the render style to the part.        <br /></strong></font>&#160;&#160;&#160; oPartDoc.ActiveRenderStyle = oRenderStyle     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Force the view to update to see the change.        <br /></strong></font>&#160;&#160;&#160; ThisApplication.ActiveView.Update     <br />End Sub</div>  <p>&#160;</p>  <p><strong><font size="3">Override Colors for Features and Faces        <br /></font></strong>What Iâ€™ve talked about so far is the overall color for the part.&#160; Itâ€™s also possible to assign override colors to faces and features.&#160; In the user-interface this is done by right-clicking on the feature or the face and running the <strong>Properties</strong> command from the context menu.&#160; As you can see in the pictures below, the Properties dialogs for a feature and face allow you to select a color style for the feature or face.&#160; These override the color defined by the part for that specific feature or face.&#160; Thereâ€™s a level of priority when assigning colors.&#160; The part color colors the entire part.&#160; A feature color overrides the part color and colors the feature.&#160; A face color override the part or feature color and will color the face.&#160; To remove the override of a face you set itâ€™s color style to â€œAs Featureâ€ or â€œAs Partâ€ and to remove the override from a feature you set it to â€œAs Partâ€.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105370dc355970b-pi"><img title="FeatureColor" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="319" alt="FeatureColor" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105370dc359970b-pi" width="224" border="0" /></a>&#160; <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105370dc35c970b-pi"><img title="FaceColor" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="109" alt="FaceColor" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340111684812ae970c-pi" width="224" border="0" /></a>     <br /></p>  <p>Below is an example program that sets the color of a feature and a face.&#160; It uses the second feature created in the active part and an arbitrary face of that feature.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SetFeatureAndFaceColor()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the second feature.        <br /></strong></font>&#160;&#160;&#160; Dim oFeature As PartFeature     <br />&#160;&#160;&#160; Set oFeature = oPartDoc.ComponentDefinition.Features.Item(2)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the color of the feature to &quot;Yellow&quot;        <br /></strong></font>&#160;&#160;&#160; Call oFeature.SetRenderStyle(kOverrideRenderStyle, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.RenderStyles.Item(&quot;Yellow&quot;))     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get one of the faces of the feature.&#160;&#160; <br />&#160;&#160;&#160; ' This could be any face in the part.         <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face     <br />&#160;&#160;&#160; Set oFace = oFeature.Faces.Item(1)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the color of the face to &quot;Green&quot;        <br /></strong></font>&#160;&#160;&#160; Call oFace.SetRenderStyle(kOverrideRenderStyle, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.RenderStyles.Item(&quot;Green&quot;))     <br />End Sub</div>  <p>   <br />The example below removes these color overrides and resets all features to use the part color and all faces to use the feature color.&#160; </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub RemoveFeatureAndFaceColorOverrides()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oPartDef As PartComponentDefinition</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Set oPartDef = oPartDoc.ComponentDefinition    <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through all features.        <br /></strong></font>&#160;&#160;&#160; Dim oFeature As PartFeature     <br />&#160;&#160;&#160; For Each oFeature In oPartDoc.ComponentDefinition.Features     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the render style to be &quot;As Part&quot;.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oFeature.SetRenderStyle(kPartRenderStyle)     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through all faces.        <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face     <br />&#160;&#160;&#160; For Each oFace In oPartDef.SurfaceBodies.Item(1).Faces     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the render style to be &quot;As Feature&quot;.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oFace.SetRenderStyle(kFeatureRenderStyle)     <br />&#160;&#160;&#160; Next     <br />End Sub</div>  <p>&#160;</p>  <p>Part models can have very many faces and typically only a few of those will have color overrides.&#160; Iterating and setting every face can be expensive.&#160; To improve performance there is a trick to quickly find only those faces that have overrides.&#160; The trick takes advantage of the fact that face color overrides are implemented internally using standard API attributes.&#160; The program below does the same thing as the previous program but uses this trick so it will be more efficient on large models. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub RemoveFeatureAndFaceColorOverrides2()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through all features.        <br /></strong></font>&#160;&#160;&#160; Dim oFeature As PartFeature     <br />&#160;&#160;&#160; For Each oFeature In oPartDoc.ComponentDefinition.Features     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the render style to be &quot;As Part&quot;.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oFeature.SetRenderStyle(kPartRenderStyle)     <br />&#160;&#160;&#160; Next     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get all of the faces that have the &quot;FaceColor&quot; attribute.        <br /></strong></font>&#160;&#160;&#160; Dim oFaces As ObjectCollection     <br />&#160;&#160;&#160; Set oFaces = oPartDoc.AttributeManager.FindObjects( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;com.autodesk.inventor.FaceAttributes&quot;, &quot;FaceColor&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Iterate through all faces that have colors.        <br /></strong></font>&#160;&#160;&#160; Dim oFace As Face     <br />&#160;&#160;&#160; For Each oFace In oFaces     <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Set the render style to be &quot;As Feature&quot;.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oFace.SetRenderStyle(kFeatureRenderStyle)     <br />&#160;&#160;&#160; Next     <br />End Sub</div>  <p>&#160;</p>  <p>If you want to find out what the current color of a feature or face is you can use the GetRenderStyle method.&#160; This returns the current color of the feature or face and also indicates why it is that color.&#160; For example, if you get the color of a face it can be that color because of the part color, feature color, or the face color.&#160; In most cases you probably donâ€™t care why itâ€™s the color it is and can just use the color returned and ignore why itâ€™s that color.&#160; The sample below displays the name of the color of the selected feature or face and why itâ€™s that color.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub ShowPartColors()    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check that an entity is selected.        <br /></strong></font>&#160;&#160;&#160; If oPartDoc.SelectSet.Count &lt;&gt; 1 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A feature or face must be selected.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Check to see if it is a face or feature that's selected.        <br /></strong></font>&#160;&#160;&#160; Dim ColorSource As StyleSourceTypeEnum     <br />&#160;&#160;&#160; Dim oRenderStyle As RenderStyle     <br />&#160;&#160;&#160; If TypeOf oPartDoc.SelectSet.Item(1) Is PartFeature Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim oFeature As PartFeature     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oFeature = oPartDoc.SelectSet.Item(1)     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oRenderStyle = oFeature.GetRenderStyle(ColorSource)     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Feature color: &quot; &amp; oRenderStyle.Name &amp; vbCr &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Reason: &quot; &amp; StyleSourceTypeEnumName(ColorSource)     <br />&#160;&#160;&#160; ElseIf TypeOf oPartDoc.SelectSet.Item(1) Is Face Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim oFace As Face     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oFace = oPartDoc.SelectSet.Item(1)     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oRenderStyle = oFace.GetRenderStyle(ColorSource)     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;Face color: &quot; &amp; oRenderStyle.Name &amp; vbCr &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Reason: &quot; &amp; StyleSourceTypeEnumName(ColorSource)     <br />&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;A feature or face must be selected.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />End Sub     <br />    <br />    <br /><font color="#0000ff"><strong>' Utility function used to get a readable name for an enum value.        <br /></strong></font>Private Function StyleSourceTypeEnumName( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; EnumValue As StyleSourceTypeEnum) As String     <br />&#160;&#160;&#160; Select Case EnumValue     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kFeatureRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Feature color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kOverrideRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Override color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kPartRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Part color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kWeldBeadRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Weld bead color&quot;     <br />&#160;&#160;&#160; End Select     <br />End Function</div>  <p>&#160;</p>  <p><font size="3"><strong>Override Colors for Occurrences in an Assembly</strong></font>     <br />The concepts of applying an override color also apply when coloring objects in an assembly.&#160; The default color of any part in an assembly is the color defined in the part.&#160; You can choose to override the part color and assign any other color.&#160; In an assembly, the override applies to the entire occurrence.&#160; You override the color of a part in the user-interface by selecting a part and then choosing a color from the color combo box, as shown below. You canâ€™t override the color of feature or faces in an assembly, only the entire part.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401116848128c970c-pi"><img title="PartColorList" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="151" alt="PartColorList" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834011168481293970c-pi" width="220" border="0" /></a>    <br /></p>  <p>The ComponentOccurrence object supports both the SetRenderStyle and GetRenderStyle methods.&#160; A ComponentOccurrence object can represent an individual part or a subassembly.&#160; If you set the render style of a component occurrence that represents a part it will override the color for that single instance of the part.&#160; If you set it for a component occurrence that represents a subassembly it will override the color for all of the parts within the subassembly.&#160; The sample below illustrates this by randomly setting the color of all of the top-level occurrences in an assembly.&#160; The occurrences can be parts or subassemblies.&#160;&#160; Remember, this is overriding the color as defined by the part.&#160; </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SetOccurrenceOverrideColors()    <br />&#160;&#160;&#160; Dim oAsmDoc As AssemblyDocument     <br />&#160;&#160;&#160; Set oAsmDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Initialize the random number generator and get        <br />&#160;&#160;&#160; ' the number of render styles defined.         <br /></strong></font>&#160;&#160;&#160; Randomize     <br />&#160;&#160;&#160; Dim iColorCount As Long     <br />&#160;&#160;&#160; iColorCount = oAsmDoc.RenderStyles.Count     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Iterate through the top-level occurrences in the assembly.</strong></font>     <br />&#160;&#160;&#160; Dim oOcc As ComponentOccurrence     <br />&#160;&#160;&#160; For Each oOcc In oAsmDoc.ComponentDefinition.Occurrences     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Set the color to a random color.</strong></font>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oOcc.SetRenderStyle(kOverrideRenderStyle, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAsmDoc.RenderStyles.Item(Int((iColorCount * Rnd) + 1)))     <br />&#160;&#160;&#160; Next     <br />End Sub</div>  <p>&#160;</p>  <p>This next sample goes through the top-level occurrences in an assembly and removes any color overrides so they all revert back to the original part color.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub RemoveOccurrenceOverrideColors()    <br />&#160;&#160;&#160; Dim oAsmDoc As AssemblyDocument     <br />&#160;&#160;&#160; Set oAsmDoc = ThisApplication.ActiveDocument     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Iterate through the top-level occurrences in the assembly.</strong></font>     <br />&#160;&#160;&#160; Dim oOcc As ComponentOccurrence     <br />&#160;&#160;&#160; For Each oOcc In oAsmDoc.ComponentDefinition.Occurrences     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Set each occurrence to use the part defined color.        <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call oOcc.SetRenderStyle(kPartRenderStyle)     <br />&#160;&#160;&#160; Next     <br />End Sub</div>  <p>&#160;</p>  <p>This final sample is similar to the previous part sample that reports the color of the selected feature or face except this reports the color of the selected occurrence.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub ShowOccurrenceColor()    <br />&#160;&#160;&#160; Dim oAsmDoc As AssemblyDocument     <br />&#160;&#160;&#160; Set oAsmDoc = ThisApplication.ActiveDocument     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check that an occurence is selected.        <br /></strong></font>&#160;&#160;&#160; Dim oOcc As ComponentOccurrence     <br />&#160;&#160;&#160; On Error Resume Next     <br />&#160;&#160;&#160; Set oOcc = oAsmDoc.SelectSet.Item(1)     <br />&#160;&#160;&#160; If Err Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;An occurrence must be selected.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; On Error GoTo 0     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check to see if it is a face or feature that's selected.        <br /></strong></font>&#160;&#160;&#160; Dim ColorSource As StyleSourceTypeEnum     <br />&#160;&#160;&#160; Dim oRenderStyle As RenderStyle     <br />&#160;&#160;&#160; Set oRenderStyle = oOcc.GetRenderStyle(ColorSource)     <br />&#160;&#160;&#160; MsgBox &quot;Occurence color: &quot; &amp; oRenderStyle.Name &amp; vbCr &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Reason: &quot; &amp; StyleSourceTypeEnumName(ColorSource)     <br />End Sub     <br />    <br />    <br /><font color="#0000ff"><strong>' Utility function used to get a readable name for an enum value.        <br /></strong></font>Private Function StyleSourceTypeEnumName( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; EnumValue As StyleSourceTypeEnum) As String     <br />&#160;&#160;&#160; Select Case EnumValue     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kFeatureRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Feature color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kOverrideRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Override color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kPartRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Part color&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Case kWeldBeadRenderStyle     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; StyleSourceTypeEnumName = &quot;Weld bead color&quot;     <br />&#160;&#160;&#160; End Select     <br />End Function</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Igor 
EMAIL: sharkyenergy@hotmail.com
IP: 78.14.40.134
URL: 
DATE: 02/05/2009 07:12:45 AM
YAYYYYYYYY thank you very much! this is the most helpful inventor text ive seen online.. very well written!

thank you again
-----
COMMENT:
AUTHOR: Stefaan Boel
EMAIL: inventorwizard@gmail.com
IP: 194.7.161.147
URL: http://www.inventorwizard.be
DATE: 02/05/2009 08:21:53 AM
I created this macro to change selected parts to a clear color, "green" or "blue" or set it back to "as material", it has a small selection window. Using that dailly.
Check it out in this zip:
<a href="http://www.inventorwizard.be/tools/macro/change_color_2_clear.zip">http://www.inventorwizard.be/tools/macro/change_color_2_clear.zip</a>
-----
COMMENT:
AUTHOR: Stefaan Boel
EMAIL: inventorwizard@gmail.com
IP: 194.7.161.147
URL: http://www.inventorwizard.be
DATE: 02/13/2009 01:14:45 PM
Did you try it?
-----
COMMENT:
AUTHOR: Francis
EMAIL: jfwedema@wanadoo.nl
IP: 82.204.43.99
URL: 
DATE: 02/17/2009 03:50:57 PM
this is a nice base for what i'm trieing to accomplisch. how can I change colors of parts which are in a sub assy? (and offcourse leave the colors of the sub assemblies unchanged then)
my sincere compliments on your blog, it makes alot off stuf much clearer. thank you!

Francis, netherlands
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 198.102.112.18
URL: 
DATE: 04/13/2009 10:10:23 PM
It's possible to iterate through the entire assembly structure.  This is discussed in detail in a more recent blog posting:

<a href="http://modthemachine.typepad.com/my_weblog/2009/03/accessing-assembly-components.html">http://modthemachine.typepad.com/my_weblog/2009/03/accessing-assembly-components.html</a>

Each occurrence obtained while traversing can have it's color set.  This is an override that's defined at the level of the top-level assembly and does not change the subassemblies or parts.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Translating Files with the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 1
BASENAME: translating-files-with-the-api
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html 
DATE: 01/22/2009 12:18:26 AM
-----
BODY:
<p>I've been asked the same question twice recently that's related to my previous <a href="http://modthemachine.typepad.com/my_weblog/2008/10/converting-vba-auto-macros-to-an-add-in.html">Converting VBA Auto Macros to an Add-In</a> post.&#160; In that example I showed how to write out dwf and pdf files using the API.&#160; The question asked was how to create a pdf file that contains all of the sheets in the drawing instead of just the active sheet.&#160; Similar questions about how to control the translators have been asked in the customization newsgroup too, so I think it's worthwhile to discuss how to read and write various file formats using Inventor's API.&#160; Inventor's API supports three different ways of importing and exporting files in and out of Inventor.&#160; These are discussed below.&#160; </p>  <p><strong><font size="4">Method 1 (Save As)</font></strong>     <br />The first way to translate files is very easy to use and supports a wide variety of formats but has limited flexibility with respect to controlling the various options when doing the translation.&#160; This first method uses the Document.SaveAs method to translate a file from Inventor to another format and the Documents.Open method to translate a foreign file into Inventor.&#160; Below is an example of a program that uses the SaveAs method to save a PDF file of the active document.</p>  <br />  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsPDF()    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the active docuement.</strong></font>     <br />&#160;&#160;&#160; Dim oDoc As Document     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.activeDocument     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Save a copy as a PDF file.</strong></font>     <br />&#160;&#160;&#160; Call oDoc.SaveAs(&quot;C:\Temp\TestFile.pdf&quot;, True)     <br />End Sub </div>  <div></div>  <p>   <br />The SaveAs and Open methods are the methods you use to open and save Inventor files.&#160; The key to also using them to translate other file formats is the file extension.&#160; When you specify the filename to open or save to, Inventor looks at the extension of the filename and will automatically call the appropriate translator.&#160; In this example it sees the PDF file extension and automatically calls the PDF translator.&#160; The same limitations of the file types that you have in the Inventor <strong>Open</strong> and <strong>Save Copy As</strong> commands apply.&#160; For example, you can save a part as an stl file but you can't open an stl file.&#160;&#160; The picture below shows the file types available in the Open dialog.&#160; These are also the file types that are supported by the Documents.Open method.     <br /></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4af970c-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="356" alt="OpenFileTypes" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536e2b8d0970b-pi" width="400" border="0" /></a> </p>  <p>This technique is very simple, as you can see in the sample code above.&#160; The primary limitation with this approach is that you don't have control over any of the options for the translator.&#160; For example, the picture below shows the options dialog that's available when you're using the <strong>Save Copy As</strong> command to create a PDF file.&#160; When you use the Document.SaveAs method from the API the PDF will be created using default values for these settings.&#160; Typically these defaults are the settings last specified by the user when using the <strong>Save Copy As</strong> command, although this behavior can vary from one translator type to another.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536e2b8d3970b-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="191" alt="pdfOptions" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4b9970c-pi" width="354" border="0" /></a> </p>  <p>&#160;</p>  <p><font size="4"><strong>Method 2</strong> (Translator Add-Ins)</font>     <br />This second technique is more complicated to use but provides access to the various options that the translator supports.&#160; It takes advantage of the fact that translators in Inventor are implemented as a special type of Add-In.&#160; All translator Add-Ins are required to support a common set of methods and properties which allows you to write a program that drives the translator.&#160; This is illustrated in the sample program below.</p>  <p>&#160;</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsPDF()&#160; <br />&#160; <font color="#0000ff"><strong>' Get the PDF translator Add-In.</strong></font>&#160; <br />&#160; Dim oPDFTrans As TranslatorAddIn&#160; <br />&#160; Set oPDFTrans = ThisApplication.ApplicationAddIns.ItemById( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}&quot;)&#160; <br />&#160; If oPDFTrans Is Nothing Then&#160; <br />&#160;&#160;&#160; MsgBox &quot;Could not access PDF translator.&quot;&#160; <br />&#160;&#160;&#160; Exit Sub&#160; <br />&#160; End If&#160;&#160; <br />    <br />&#160; <font color="#0000ff"><strong>' Create some objects that are used to pass information to&#160; <br />&#160; the translator Add-In.</strong></font>&#160;&#160; <br />&#160; Dim oContext As TranslationContext&#160; <br />&#160; Set oContext = ThisApplication.TransientObjects.CreateTranslationContext&#160; <br />&#160; Dim oOptions As NameValueMap&#160; <br />&#160; Set oOptions = ThisApplication.TransientObjects.CreateNameValueMap&#160; <br />&#160; If oPDFTrans.HasSaveCopyAsOptions(ThisApplication.activeDocument, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContext, oOptions) Then&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set to print all sheets.&#160; This can also have the value&#160; <br />&#160;&#160;&#160; ' kPrintCurrentSheet or kPrintSheetRange. If kPrintSheetRange&#160; <br />&#160;&#160;&#160; ' is used then you must also use the CustomBeginSheet and&#160; <br />&#160;&#160;&#160; ' Custom_End_Sheet to define the sheet range.&#160; <br /></strong></font>&#160;&#160;&#160; oOptions.Value(&quot;Sheet_Range&quot;) = kPrintAllSheets&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Other possible options...&#160; <br /></strong></font>&#160;&#160;&#160; 'oOptions.Value(&quot;Custom_Begin_Sheet&quot;) = 1&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Custom_End_Sheet&quot;) = 5&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;All_Color_AS_Black&quot;) = True&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Remove_Line_Weights&quot;) = True&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Vector_Resolution&quot;) = 200 </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Define various settings and input to provide the translator.</strong>&#160; <br /></font>&#160;&#160;&#160; oContext.Type = kFileBrowseIOMechanism&#160; <br />&#160;&#160;&#160; Dim oData As DataMedium&#160; <br />&#160;&#160;&#160; Set oData = ThisApplication.TransientObjects.CreateDataMedium&#160; <br />&#160;&#160;&#160; oData.FileName = &quot;C:\temp\test.pdf&quot;&#160;&#160; <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Call the translator.&#160; <br /></strong></font>&#160;&#160;&#160; Call oPDFTrans.SaveCopyAs(ThisApplication.activeDocument, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContext, oOptions, oData)&#160; <br />&#160; End If     <br />End Sub</div>  <p>   <br />This program begins by getting a specific translator Add-In using its ID, the PDF translator in this case.&#160; (See the translator reporter paragraph below for one method to determine the Add-In ID.)&#160; It then creates some objects that are required for some input arguments.&#160; The next section is the most interesting and is where it sets the values for the various options of the translator.&#160; In this cases it's setting the PDF translator to print all of the sheets in the drawing.&#160; Next it defines the filename of the output file and finally it calls the method on the translator to perform the actual translation.</p>  <p>The hardest part of using this approach to translate files is understanding what the supported options are and how to set them.&#160; The best resource for this information is the programming help.&#160; This discusses the options for each translator type along with samples for most of the translators.&#160; Look for the help topic &quot;TranslatorAddIn Object&quot;.&#160; You can also get to this topic from the <strong>Samples</strong> page in the programming help and selecting one of the samples from the <strong>Import/Export</strong> section.&#160; The picture below illustrates how to access the programming help.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4c1970c-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="197" alt="APIHelpAccess" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4c7970c-pi" width="350" border="0" /></a>     <br /></p>  <p>Here's a <a href="http://modthemachine.typepad.com/files/translatorreport.zip">translator reporter macro</a> that I created before the help files existed but that I still find useful when working with translators.&#160; To use it copy and paste the code into a VBA project and run the macro.&#160; It writes a report that contains information about all of the loaded translators.&#160; The most interesting information reported is the list of all of the available translator Add-Ins, their Add-In ID, and the options supported by each Add-In.&#160; The online help is still the best resource for the option information since it also includes a description of the options and valid input for the options.</p>  <p>&#160;</p>  <p><strong><font size="4">Method 3 (DataIO)</font>       <br /></strong>The final method of translating data has the most limitations but supports some special cases that aren't handled by the standard translators.&#160; This method uses an API object called DataIO which you can get from some Inventor API objects.&#160; Basically, you get the DataIO object from the object of Interest and use the methods on the DataIO object to write out the object of interest in the specified format.&#160; The DataIO object can also be used to read data into Inventor.&#160; The number of objects that support DataIO and the formats supported are very small.&#160; Here are what I think are the most interesting:</p>  <ul>   <li>Writing out a sheet metal flat pattern as DWG or DXF. </li>    <li>Writing out the contents of a sketch as DWG or DXF. </li>    <li>Reading and writing a part solid as SAT. </li> </ul>  <p>These and more information about DataIO are discussed in more detail in the programming help.&#160; Since it's not used very often and rather than just repeat that information here I'll refer you to it.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: John
EMAIL: John@hotmail.com
IP: 59.95.22.15
URL: 
DATE: 01/31/2009 11:40:40 AM
As i understand, it is in Inventor 2009. is it possiable in 2008. if not, what are the best possiable options available?
-----
COMMENT:
AUTHOR: Doug
EMAIL: dwp64@fuse.net
IP: 72.49.137.105
URL: 
DATE: 04/05/2009 10:30:14 PM
possible to do the same as shown here except export as .TIF ?
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 198.102.112.18
URL: 
DATE: 04/13/2009 10:03:52 PM
Image files (tif, jpg, bmp) are handled differently than geometry based translations.  Because of that none of the approaches discussed above will work.  However it is possible using a different approach.  See my other posting for an explanation.

<a href="http://modthemachine.typepad.com/my_weblog/2009/02/saving-image-files.html">http://modthemachine.typepad.com/my_weblog/2009/02/saving-image-files.html</a>


-----
COMMENT:
AUTHOR: Lars
EMAIL: larsjorgenbr@hotmail.com
IP: 84.234.169.93
URL: http://translatorschoice.com/
DATE: 04/21/2009 11:07:32 PM
Ah, great post! Thank you!
-----
COMMENT:
AUTHOR: Adam Clampet
EMAIL: clampeta@spectrumcontrol.com
IP: 216.169.165.178
URL: http://www.specpower.com
DATE: 03/05/2010 08:07:42 PM
Can this be done using Inventor View?
-----
COMMENT:
AUTHOR: doug
EMAIL: dgesler@unstoppablesoftware.com
IP: 74.5.25.193
URL: 
DATE: 06/28/2011 09:35:09 PM
In Inventor 2012 (and possibly other versions), these methods work fine, except when functions are executed from a service, where Inventor is started without visibility or a drawing plane). Do you know of any solutions to solve this.  I can get it to run fine outside the service.
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: brian.ekins@autodesk.com
IP: 50.53.92.120
URL: http://blogs.autodesk.com/modthemachine
DATE: 06/29/2011 03:55:53 PM
Working with Inventor through a service is not something supported by Inventor.  Being â€œnot supportedâ€ doesnâ€™t necessarily mean that it wonâ€™t work but it is something that is not designed for and is not tested.  Because of that I donâ€™t know what the behavior will be.  Obviously youâ€™ve run into an issue where the behavior is different.  I know there are a few issues where Inventor expects there to be a visible view.  This is mostly when working with drawings.  There can also be cases where certain registry entries or configuration files are looked for in the user directory and Iâ€™m not sure if that process works the same in finding the current user when youâ€™re running from a service.  Itâ€™s unknown territory.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Removing VBA Document Projects From Inventor Files
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: removing-vba-document-projects-from-inventor-files
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2009/01/removing-vba-document-projects-from-inventor-files.html 
DATE: 01/14/2009 03:52:47 AM
-----
BODY:
<p>I received an email recently with a question that relates back to a series of past postings in this blog.&#0160; They used the previous blog postings to migrate their document macros to an add-in but are now wondering how to remove their document macros from their files.&#0160; There are three approaches that I&#39;m aware of to do this.&#0160; With all of these make sure you have a back up of the file before deleting the macros.</p>
<p>First, you can manually open each document and use the VBA editor to delete the code from the document project.&#0160; This is fine if you only have a handful of documents but is tedious if you have many documents.&#0160; The advantages to this approach is that it&#39;s simple and also gives you the flexibility to look at the macros within the document and decide one-by-one whether to delete and/or to copy the macro to the application project.</p>
<p>Second, you can use a VBA macro to automate the deletion.&#0160; Here&#39;s a VBA macro that I wrote using the functionality provided by Inventor&#39;s API and the VBA Extensibility library to manipulate a VBA project.&#0160; It either comments or deletes all automatic macros from the specified VBA project.&#0160; You could easily wrap this to open, process, and save many documents.&#0160; This will leave any other macros in the project alone.&#0160; There are some cases where you might have a regular macro (vs. an auto macro) that is specific to that document and you don&#39;t want to delete it.&#0160; To use the macro below, copy and paste it into your application project and add a reference to the <strong>Microsoft Visual Basic for Applications Extensibility 5.3</strong> library. <br /></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<p><strong><font color="#0000ff">&#39; Sub to test the DeleteAutoMacros sub. <br /></font></strong>Public Sub TestDeleteAutoMacros() <br />&#0160;&#0160;&#0160; Dim oActiveDocument As Document <br />&#0160;&#0160;&#0160; Set oActiveDocument = ThisApplication.activeDocument <br />&#0160;&#0160;&#0160; Call DeleteAutoMacros(oActiveDocument.VBAProject, True) <br />End Sub <br /><br /><br /></p>
<p><strong><font color="#0000ff">&#39; Given an Inventor VBA project as input, this <br />&#39; deletes or comments the code for all of the <br />&#39; automatic macros contained within the project. <br /></font></strong>Private Sub DeleteAutoMacros( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal VBAProject As InventorVBAProject, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Optional ByVal Comment As Boolean = True) <br /><font color="#0000ff"><strong>&#0160;&#0160; &#39; Iterate through the modules of the document project. <br /></strong></font>&#0160;&#0160; Dim oModule As InventorVBAComponent <br />&#0160;&#0160; For Each oModule In VBAProject.InventorVBAComponents <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check to see if this is a code module or document module. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160; If oModule.VBComponent.Type = vbext_ct_StdModule Or _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oModule.VBComponent.Type = vbext_ct_Document Then <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Look for any auto macros. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oFunction As InventorVBAMember <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For Each oFunction In oModule.InventorVBAMembers <br /><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check that this is an automatic macro. <br /></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Select Case LCase(oFunction.Name) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Case &quot;autosave&quot;, &quot;autoopen&quot;, &quot;autonew&quot;, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;autoclose&quot;, &quot;autoedit&quot; <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the VBIDE object that represents the module. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oVBCodeModule As codeModule <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oVBCodeModule = oModule.VBComponent.codeModule </p>
<p><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the start line and length of the module. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim iStartLine As Long <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iStartLine = oVBCodeModule.ProcStartLine( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFunction.Name, vbext_pk_Proc) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim iNumLines As Long <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iNumLines = oVBCodeModule.ProcCountLines( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oFunction.Name, vbext_pk_Proc) </p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If Comment Then <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the macro as a string. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim strMacroLines As String <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strMacroLines = oVBCodeModule.Lines( _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iStartLine, iNumLines) </p>
<p><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Insert a comment at the beginning line. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strMacroLines = &quot;&#39; &quot; &amp; strMacroLines </p>
<p><font color="#0000ff"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Add a comment at the beginning of each line. <br /></strong></font>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strMacroLines = Replace(strMacroLines, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf, vbCr &amp; &quot;&#39; &quot;) </p>
<p><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Delete the existing macro. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call oVBCodeModule.DeleteLines(iStartLine, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iNumLines) </p>
<p><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Add the commented version of the macro. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call oVBCodeModule.InsertLines(iStartLine, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strMacroLines) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Else <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Delete the lines. <br /></font></strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call oVBCodeModule.DeleteLines(iStartLine, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iNumLines) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End Select <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next <br />&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160; Next <br />End Sub</p></div>
<br />
<p>The third option is to use this <a href="http://modthemachine.typepad.com/files/deletevba-1.zip">Delete VBA</a> utility to completely remove the VBA project from the document.&#0160; It&#39;s a command line utility.&#0160; Just supply the filename of the Inventor file as an argument when run from the command line.&#0160; The zip file in the link contains the program and the source code.&#0160; To use it you only need the DeleteVBA.exe file.&#0160; If you&#39;re sure you don&#39;t have any other VBA code in the document that you care about this is the best option.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jayaram Raman
EMAIL: jayaramraman365@hotmail.com
IP: 82.4.253.228
URL: 
DATE: 02/24/2009 01:00:52 PM
The command prompt utility comes with the following message:

A filename must be specified in the command line.

On clicking OK The command utility promptly disappears.

Anything I'm doing wrong?

Thanks
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 04/13/2009 10:59:06 PM
You need to run the program from the Command window where you can specify additional options.  In this case you need to specify the name of the Inventor file to remove the VBA project from.

To open a Command window you can use the "Run..." command in the Start menu and type in "cmd" as the command to run.  This will open the command window.  Change directory to wherever you downloaded the utility to (C:\Temp\VBARemove in the example below).

C:\Users\Ekins> cd C:\Temp\VBARemove

Run the utility specifying the filename.

C:\Temp\VBARemove> DeleteVBA.exe C:\Users\Ekins\Part1.ipt


-----
COMMENT:
AUTHOR: Wolfgang Seidel
EMAIL: Seidel@arges.de
IP: 80.153.20.53
URL: 
DATE: 08/18/2009 07:58:53 AM
After using DeleteVBA.exe all macros were deleted. We did this directly on a copy of the file store. The only problem that remains is that we get strange vault status in the Autodesk Vault:
E.g. some of the files have green staus flags that do not get white if you check out this file.
Does DeleteVBA.exe also influence the status flags? Do you know what to do about this problem?
-----
COMMENT:
AUTHOR: Rob Beckley
EMAIL: robert.beckley@sloanegroup.co.uk
IP: 212.44.61.100
URL: 
DATE: 04/29/2010 11:01:30 AM
I need to delete some code from all our files, I tried your DeleteAutoMacros but it errors on 'oVBCodeModule As codeModule' saying User-defined type not defined

We only have one bit of code and it dose not work because of the ThisDocument. ref in 64bit windows. 
___________________________________
Public Sub AutoSave()

    Dim oCustomPropSet As PropertySet
    Set oCustomPropSet = ThisDocument.PropertySets.Item("{D5CDD505-2E9C-101B-9397-08002B2CF9AE}")

    ' Create or update the property containing the Total Mass.
    Dim strTotalMass As String
    strTotalMass = Format(ThisDocument.ComponentDefinition.MassProperties.Mass, "###0.000")
       
    On Error Resume Next
    oCustomPropSet.Item("Total Mass").Value = strTotalMass
        If Err Then
        Err.Clear
        Call oCustomPropSet.Add(strTotalMass, "Total Mass")
    End If
    On Error GoTo 0

End Sub
______________________

Not sure where its going wrong? 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: After Autodesk University
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: after-autodesk-university
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/12/after-autodesk-university.html 
DATE: 12/10/2008 01:16:13 AM
-----
BODY:
<p>Autodesk University is finished for another year.&#0160; I taught a few classes that I hope those that attended were able to get something out of.&#0160; Here are a few pictures from one of the classes.&#0160; These were taken before the class started so everyone is still awake. :)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105364df589970b-pi"><img alt="Class1" border="0" height="184" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105364df58f970b-pi" style="border-width: 0px;" width="244" /></a>&#0160; <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536565f64970c-pi"><img alt="Class2" border="0" height="184" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536565f68970c-pi" style="border-width: 0px;" width="244" /></a></p>
<p>&#0160;</p>
<p>The picture below shows my favorite part.&#0160; Getting a chance after the class to meet with some of you and help with questions and hear about your API issues.&#0160; (Thanks to Samu Karlsson for this picture.)</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105364df5a4970b-pi"><img alt="AfterClass" border="0" height="184" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536565f6d970c-pi" style="border-width: 0px;" width="244" /></a></p>
<p>&#0160;</p>
<p>Here&#39;s the material from the classes I presented.&#0160; There are some Readme.txt files in most of the the zip files that explains what&#39;s there.</p>
<p>&#0160;</p>
<p><strong>Inventor API: Exploring iProperties and Parameters</strong></p>
<p><a href="http://modthemachine.typepad.com/files/ipropertiesandparameters.pdf">Paper</a>, <a href="http://modthemachine.typepad.com/files/samples.zip">Samples</a></p>
<p>&#0160;</p>
<p><strong>How Deep is the Rabbit Hole? Examining the Matrix and Other Inventor Math and Geometry Objects.</strong></p>
<p>If it&#39;s not obvious, the title of this class was a play on a scene from the movie <strong>The Matrix</strong>.</p>
<p><a href="http://modthemachine.typepad.com/files/mathgeometry.pdf">Paper</a>, <a href="http://modthemachine.typepad.com/files/demos.zip">Samples</a></p>
<p>&#0160;</p>
<p><strong>Inventor API: Taking the Step from VBA Macros to Add-Ins</strong></p>
<p><a href="http://modthemachine.typepad.com/files/vbatoaddins.pdf">Paper</a>, <a href="http://modthemachine.typepad.com/files/vbatoaddinssamples.zip">Samples</a></p>
<p>&#0160;</p>
<p><strong>Inventor API: New Features in Inventor 2009</strong></p>
<p><a href="http://modthemachine.typepad.com/files/newapiinventor2009.pdf">Paper</a>, <a href="http://modthemachine.typepad.com/files/inventor2009samples.zip">Samples</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Samu Karlsson
EMAIL: samu3@yahoo.com
IP: 72.128.92.152
URL: 
DATE: 12/10/2008 02:40:55 AM
Yes, we all do look amazingly awake in those 2 photos! Thanks for the classes Brian, they were great!
-----
COMMENT:
AUTHOR: Vladimir Ananiev
EMAIL: vananiev@gmail.com
IP: 91.76.177.206
URL: 
DATE: 12/10/2008 08:50:44 AM
Brian, 
thank you for publication of AU materials!

Vladimir Ananiev
Moscow, Russia
-----
COMMENT:
AUTHOR: Paul Munford
EMAIL: pmunford@beckinteriors.com
IP: 217.155.18.238
URL: 
DATE: 12/10/2008 02:25:09 PM
Brian,
Thanks very much for running these classes, you even managed to make a dry subject quite entertaining! I am bursting with new ideas...
-----
COMMENT:
AUTHOR: PeterCharles
EMAIL: engineer177@hotmail.co.uk
IP: 88.106.246.122
URL: 
DATE: 12/11/2008 09:20:41 PM
Thanks for posting your papers so quickly.  They've been printed out for further study.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Signing Your .Net Add-In
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: signing-your-net-add-in-1
CATEGORY: Add-In Creation
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/11/signing-your-net-add-in-1.html 
DATE: 11/26/2008 06:40:41 PM
-----
BODY:
<p>In my previous posting <a href="http://modthemachine.typepad.com/my_weblog/2008/10/converting-vba-auto-macros-to-an-add-in.html">Converting VBA Auto Macros to an Add-In</a> I described how to create a basic add-in and install it.&#0160; There&#39;s one additional item that I didn&#39;t cover in that posting related to the installation of your add-in.&#0160; When you install your add-in you&#39;ll get the warning shown below.&#0160; It is just a warning and can be ignored, but it&#39;s often misinterpreted as an error and it would be best to avoid it.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105361c356f970b-pi"><img alt="UnsignedAssembly" border="0" height="231" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd2c970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="454" /></a> </p>
<br />
<p>If you read the warning you&#39;ll see that it doesn&#39;t like you to use the /codebase argument with an unsigned assembly.&#0160; We have to use the /codebase argument with an add-in to get it to register correctly so it&#39;s not an option to leave it out.&#0160; The only other option is to sign the assembly, which is what I&#39;ll show you how to do here.</p>
<p><font size="3"><strong>What is Signing?</strong></font>&#0160; <br />Signing is a way of creating a unique ID for your add-in.&#0160; This is also referred to as a &quot;strong name&quot;.&#0160; Without signing your add-in there is the potential, although very minimal, of it conflicting with another .Net assembly.&#0160; A strong name consists of the filename, a key, version, culture (language), and processor type.</p>
<p>The concept of signing can also extended to serve as a security mechanism.&#0160; In addition to providing a unique identifier for the assembly it also identifies the make of the assembly.&#0160; Microsoft calls this <a href="http://technet.microsoft.com/en-us/library/cc750035.aspx">Authenticode</a> and the process is handled by <a href="https://www.verisign.com/products-services/security-services/code-signing/digital-ids-code-signing/index.html">Verisign</a>.&#0160; This type of signing is not required and not something I&#39;ll discuss here.</p>
<p><font size="3"><strong>Creating a Key <br /></strong></font>To sign an assembly you need to have a unique key to sign it with.&#0160; You generate a key using the .Net sn.exe (strong name) utility.&#0160; This utility is located in C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin.&#0160; I would recommend creating a new directory for the resulting key because a single key can be used to sign all of your add-ins.&#0160; Here&#39;s an example of executing this utility from the command line.&#0160; (This is for Visual Studio 2008.&#0160; If you&#39;re using something else you may need to search for sn.exe.)</p>
<p>&quot;C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\sn.exe&quot; -k MyKey.snk </p>
<p>This is all shown below.&#0160; Note that because of the spaces in some of the directory names that the double quotes around the full command line are required. </p>
<p>&#0160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105361c3573970b-pi"><img alt="CreateKey" border="0" height="231" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd30970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="454" /></a> <br /></p>
<p>If you have a version of visual studio besides one of the Express editions, you can use the Visual Studio Command Prompt to make this a bit easier because you won&#39;t need to know where the utility is.&#0160; This creates a cmd window where the paths are set to all of the various .Net related tools.&#0160; If you&#39;re new to Visual Studio, you open a Visual Studio Command Prompt window through the Start menu in the &quot;Visual Studio Tools&quot; list, as shown below. <br /></p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd38970c-pi"><img alt="CommandPrompt" border="0" height="318" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd3b970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="450" /></a>&#0160; </p>
<p>In the Visual Studio Command Prompt you only need to enter: <br /><br />sn -k MyKey.snk </p>
<br />
<p><font size="3"><strong>Signing the Add-In <br /></strong></font>Now that you have the key, you can use it to sign your add-in.&#0160; To do that run the <strong>Project -&gt; Properties...</strong> command, (the last command in the Project menu).&#0160; Pick the &quot;Signing&quot; tab, click the &quot;Sign the assembly&quot; check box and browse to select your key file.&#0160; Recompile your project and you now have a signed assembly.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105361c357c970b-pi"><img alt="AssemblySigning" border="0" height="314" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd4f970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="454" /></a> </p>
<br />
<p>Now when you run the regasm utility when installing your add-in you should see this and no more errors.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105361c3582970b-pi"><img alt="GoodInstall" border="0" height="230" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053624dd59970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="454" /></a> </p>
<br />
<p><font size="3"><strong>Using a signed Add-In <br /></strong></font></p>
<p>Using a signed add-in is no different than an unsigned one with one exception.&#0160; To use it you just need to copy it to the computer you want to use it on and register it.&#0160; That&#39;s the same process as an unsigned one, except you won&#39;t get the warning message anymore.&#0160; The difference to be aware of is if you want to replace the existing add-in with a newer version.&#0160; With an unsigned add-in you can just copy the new dll to the computer and everything is fine.&#0160; With a signed add-in you must re-register the add-in.&#0160; Signing ties the registration to the dll version so you need to re-register the add-in to update the version information in the registry to match the current dll.</p>
<p>(Thanks to Neil Munro for a question about the versioning that caused me to investigate this some more and update this posting.)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Neil
EMAIL: nmunro@shaw.ca
IP: 70.71.158.131
URL: 
DATE: 12/06/2008 07:55:47 PM
Brian, could you expand on the issues regarding signed assemblies and versioning. My understanding is that if you distribute strong named add-ins, each version (i.e. each build if versioning is on, which is the default) would require the user to unregister (or uninstall) the current add-in assembly and then register (or install) the new one. This negates updates via dll copy that can be accomplished with unsigned add-ins. Is that correct?
-----
COMMENT:
AUTHOR: darkfall gold
EMAIL: kitty@gmail.com
IP: 115.126.20.65
URL: http://www.dfstock.net/
DATE: 10/10/2009 02:26:45 AM
Hey, I found your blog while searching on Google your post looks very interesting for me. I will add a backlink and bookmark your site. Keep up the good work!
-----
COMMENT:
AUTHOR: Yves
EMAIL: ygingras@ventrol.com
IP: 209.5.111.162
URL: 
DATE: 01/29/2010 09:38:44 PM
Hi Brian
What do you think of registering an AddIn using the "/tlb" switch of regasm.exe

Such as : C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727\regasm /codebase ".\CustomCommand.dll" /tlb:".\CustomCommand.tlb"; (assuming the dll is in the same folder as the bat file containing the regasm instruction).

So far I do not find this registration part so easy... :)

Tech specs:
Using Inventor 2008, soon 2010
Windows XP 64Bits
Visual C# 2005

Thanks in advance.

Yves

-----
COMMENT:
AUTHOR: Woodworking project plans
EMAIL: scott1202@hotmail.com
IP: 219.133.255.86
URL: http://woodworking-books.org
DATE: 08/31/2010 12:40:05 PM
The concept of signing can also extended to serve as a security mechanism.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Creating Buttons for VBA Macros
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: creating-buttons-for-vba-macros
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html 
DATE: 11/18/2008 08:07:23 PM
-----
BODY:
<p><strong><font size="3">What is a Macro?</font></strong></p>
<p>The title for this posting is specific to a question that&#39;s come up a couple of times recently, but the post is actually more general and covers the many ways you can execute an Inventor VBA macro.</p>
<p>First, let&#39;s define what a macro is.&#0160; It&#39;s a public sub without any arguments within a standard code module in an Inventor VBA project.&#0160; The following code shows a valid macro.&#0160; It&#39;s declared as a Public sub with no arguments.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub SampleMacro() <br />&#0160;&#0160;&#0160; MsgBox &quot;The macro is running.&quot; <br />End Sub</div>
<p>The following is also a valid macro since subs default to being Public if you don&#39;t specify it to be Public or Private.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Sub SampleMacro() <br />&#0160;&#0160;&#0160; MsgBox &quot;The macro is running.&quot; <br />End Sub</div>
<p>The following is not a valid macro since it has arguments.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub AddNumbers(Value1 As Double, Value2 As Double) <br />&#0160;&#0160;&#0160; MsgBox &quot;Value sum: &quot; &amp; Value1 + Value2 <br />End Sub</div>
<br />
<p>Standard code modules are shown in the project window under the <strong>Modules</strong> node in the tree, as shown below.&#0160; You can have any number of code modules within a project and all new projects will contain a module named &quot;Module1&quot;.&#0160; A macro can exist in any module.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536013916970c-pi"><img alt="AppProjectModule1" border="0" height="137" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053601391a970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="232" /></a> </p>
<p style="text-align: center">VBA&#39;s Project window and a code module.</p>
<p style="text-align: left">&#0160;</p>
<p><strong><font size="3">Running a Macro Using the Macros Command</font></strong></p>
<p>One interface you can use to run a VBA macro is the <strong>Macros</strong> command (Tools -&gt; Macro -&gt; Macros... or Alt-F8).&#0160; Running this command will display the dialog shown below.&#0160; This dialog displays a list of all of the available macros.&#0160; It lists them as ModuleName.MacroName.&#0160; The &quot;Macros in&quot; drop-down list let you select different VBA projects.&#0160; To run a macro, select it in the list and click the <strong>Run</strong> button.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535f9d428970b-pi"><img alt="MacroDialog" border="0" height="230" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536013923970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="304" /></a> </p>
<p style="text-align: center">The Macros command dialog.</p>
<br />
<p>This interface is always available to run a macro but is not the most convenient or easiest to use, especially if you have macros that you frequently use.</p>
<br />
<p><font size="3"><strong>Running a Macro Using a Button</strong></font></p>
<p>For frequently used macros it&#39;s much more convenient to create a button to execute the macro.&#0160; To create a button for a macro there&#39;s one additional requirement on your macro.&#0160; It must exist in the default VBA project.&#0160; This is the VBA project that Inventor loads automatically every time it is started.&#0160; It&#39;s likely that your macro is already in this project.&#0160; The default VBA project is defined using the File tab of Application Options command, as shown below.&#0160; In this case it is Default.ivb in the Bin\Macros directory, but it can be any .ivb file.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535f9d42c970b-pi"><img alt="DefaultVBAProject" border="0" height="232" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535f9d42e970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="354" /></a></p>
<p style="text-align: center">Specifying the default VBA project.</p>
<p style="text-align: left">&#0160;</p>
<p style="text-align: left">To create a button use the <strong>Customize</strong> command (Tools -&gt; Customize...) and select the Commands tab of the dialog.&#0160; In the Categories list there is a &quot;Macros&quot; category.&#0160; After selecting that you&#39;ll see a list of available macros in the Commands list on the right.&#0160; You can drag and drop any of the macros in the list onto any available toolbar, including the panel bar.&#0160; This is illustrated in the picture below.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536013928970c-pi"><img alt="CustomizeDialog" border="0" height="341" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053601392c970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="404" /></a> </p>
<p style="text-align: center">Using the Customize command to create a macro button.</p>
<p style="text-align: left">&#0160;</p>
<p style="text-align: left">It&#39;s easy to create a button for your macro but it will have a default icon that&#39;s used for all VBA macros.&#0160; If you have more than one macro button it can be difficult to tell which button is for which macro.&#0160; The tool tip for the button does display the macro name, however it&#39;s also possible to create your own icon for a macro button.</p>
<p style="text-align: left">Icons are created using whatever bitmap editor you choose.&#0160; The Paint program that comes with Windows will work.&#0160; Create a bitmap that is 16x16 pixels in size.&#0160; It can use any colors but magenta is interpreted as the transparent color.&#0160; Below is an example.&#0160; The picture on the left shows the icon (zoomed in) within the Paint program.&#0160; The picture on the right shows the same icon used for a button.&#0160; Notice that the magenta color has become the background color.</p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536013e59970c-pi"><img alt="IconEdit" border="0" height="302" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535f9d7c9970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="204" /></a>&#0160;&#0160; <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536013e5e970c-pi"><img alt="IconSample" border="0" height="237" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535f9d7ce970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="184" /></a> </p>
<p style="text-align: center">Icon samples.</p>
<p style="text-align: center">&#0160;</p>
<p style="text-align: left">To associate an icon with a macro you must name it correctly and put it in the correct location.&#0160; The rules for naming are:</p>
<p style="text-align: left">&#0160;&#0160; ModuleName.MacroName.Size.bmp</p>
<p style="text-align: left">The ModuleName is the name of the VBA module where your macro is.&#0160; In this example it is &quot;Module1&quot;.&#0160; The MacroName is the name of your macro.&#0160; In this example it is &quot;SampleMacro&quot;.&#0160; The Size can be either &quot;Small&quot; or &quot;Large&quot;.&#0160; Small icons are 16x16 pixels and large icons are 32x32 pixels.&#0160; Inventor allows the end-user to choose to use large or small icons.&#0160; If you only supply a small icon Inventor will scale it and create a large icon if needed.&#0160; For the example above you would create a 16x16 pixel bitmap called:</p>
<p style="text-align: left">&#0160;&#0160; Module1.SampleMacro.Small.bmp</p>
<p style="text-align: left">The large bitmap name is:</p>
<p style="text-align: left">&#0160;&#0160; Module1.SampleMacro.Large.bmp</p>
<p style="text-align: left">These files need to be located in the same directory as Default.ivb (or your default VBA project).&#0160; Inventor will automatically associate them with the macro when creating a button.&#0160; If your icon does not display then double-check the name and the size of the icon. </p>
<p style="text-align: left">&#0160;</p>
<p style="text-align: left"><font size="3"><strong>Running a Macro from a Program</strong></font></p>
<p style="text-align: left">Although not commonly used, it&#39;s also possible to run a macro from another program.&#0160; This isn&#39;t limited to running only macros, as defined above, but any function or sub in any project and module can be executed.&#0160; I won&#39;t go into a lot of detail since there is likely not much interest in this but here is an example that demonstrates the process.&#0160; First, here are two macros in Inventor&#39;s default VBA project.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub SampleMacro() <br />&#0160;&#0160;&#0160; MsgBox &quot;The macro is running.&quot; <br />End Sub </div>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub AddNumbers(Value1 As Double, Value2 As Double) <br />&#0160;&#0160;&#0160; MsgBox &quot;Value sum: &quot; &amp; Value1 + Value2 <br />End Sub</div>
<br />
<p>Here is an Excel macro that connects to Inventor and executes the two Inventor macros.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub RunInventorMacros()&#0160;&#0160;&#0160;&#0160; <br /><strong><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Get a reference to Inventor.&#0160; This assumes Inventor is running. <br /></font></strong>&#0160;&#0160;&#0160;&#0160; Dim invApp As Inventor.Application <br />&#0160;&#0160;&#0160; Set invApp = GetObject(, &quot;Inventor.Application&quot;) <br /><br /><strong><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Get a reference to the default VBA project. <br />&#0160;&#0160;&#0160; &#39; It will always be the first item in the collection. <br /></font></strong>&#0160;&#0160;&#0160; Dim invVBAProject As InventorVBAProject <br />&#0160;&#0160;&#0160; Set invVBAProject = invApp.VBAProjects.Item(1) <br /><br /><strong><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Get a reference to the Module1 code module. <br /></font></strong>&#0160;&#0160;&#0160; Dim invModule As InventorVBAComponent <br />&#0160;&#0160;&#0160; Set invModule = invVBAProject.InventorVBAComponents.Item(&quot;Module1&quot;) <br /><br /><strong><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Get a reference to the SampleMacro sub. <br /></font></strong>&#0160;&#0160;&#0160; Dim invSub As InventorVBAMember <br />&#0160;&#0160;&#0160; Set invSub = invModule.InventorVBAMembers.Item(&quot;SampleMacro&quot;) <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Execute the macro. <br /></strong></font>&#0160;&#0160;&#0160; invSub.Execute <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Get a reference to the AddNumbers sub. <br /></strong></font>&#0160;&#0160;&#0160; Set invSub = invModule.InventorVBAMembers.Item(&quot;AddNumbers&quot;) <br /><br /><strong><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Set the arguments. <br /></font></strong>&#0160;&#0160;&#0160; invSub.Arguments.Item(&quot;Value1&quot;).Value = 3.5 <br />&#0160;&#0160;&#0160; invSub.Arguments.Item(&quot;Value2&quot;).Value = 4.75 <br /><br /><font color="#0000ff"><strong>&#0160;&#0160;&#0160; &#39; Execute the sub <br /></strong></font>&#0160;&#0160;&#0160; Call invSub.Execute <br />End Sub</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Vb Reader
EMAIL: saravanan.pon@gmail.com
IP: 218.186.12.233
URL: http://www.vbknowledgebase.com/WebApp/Guest/Home/Home.aspx?PageCode=35&Desc=Javascript-Len()-string-Length
DATE: 09/01/2009 02:30:45 PM
Nice article. need more article on Macros.
 
-----
COMMENT:
AUTHOR: Jan van Noort
EMAIL: janvannoort@gmail.com
IP: 87.212.105.166
URL: http://www.vbainventor.nl
DATE: 09/10/2009 10:32:17 AM
Thx Brian,

I needed this and very clearly explained also!

Jan van Noort,
The Netherlands, Delft

I'm building a Dutch forum on VBA subjects, still needs to grow ....  
-----
COMMENT:
AUTHOR: Ralph Daub
EMAIL: ralph.daub@wellons.com
IP: 65.102.60.116
URL: 
DATE: 11/17/2009 09:42:50 PM
Thank you. I was looking for information on how to change the macro icons on Inventor. 

This article was spot on!
-----
COMMENT:
AUTHOR: Tom
EMAIL: cad.fochler@gmail.com
IP: 217.89.55.251
URL: 
DATE: 10/22/2010 04:58:08 PM
Hi,

thanks a lot for this information. Tried to find this info for a while. Now my customer got a nice icon with his macro...

Best wishes, Tom
-----
COMMENT:
AUTHOR: Craig
EMAIL: craigtosh@gmail.com
IP: 82.69.100.219
URL: 
DATE: 07/01/2011 02:07:50 PM
Brian.  I am trying to this in IV2010 but it never displays the icons in any of the environments, always the default icon.
Lets say i have a macro called "Sub ActiveStandard ()".  My icon is called Module3.ActiveStandard.Large.BMP and is located in my project location.

What am i missing?  Does the macro need to call the icon?
-----
COMMENT:
AUTHOR: Craig
EMAIL: craigtosh@gmail.com
IP: 82.69.100.219
URL: 
DATE: 07/01/2011 02:09:34 PM
Also i seen the other webpagepage and also have a small version with the filename Module3.ActiveStandard.Small.BMP 16x16pixels.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: File References Part 2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: file-references-part-2
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/11/file-references-part-2.html 
DATE: 11/11/2008 09:51:54 PM
-----
BODY:
<p>I received a question related to my last posting that I thought was good and also helps to illustrate the previous posting.&#0160; The question that came in asked about the new <strong>Open Drawing</strong> command that is part of the subscription pack.&#0160; When you have a part, assembly, or presentation document open and right-click on the top node in the browser you&#39;ll see the new <strong>Open Drawing</strong> command in the context menu, as shown below.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535ec13ce970c-pi"><img alt="OpenDrawing" border="0" height="230" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535ec13d1970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="244" /></a> </p>
<p>Based on the last posting, the obvious question is how can this work since we learned that the part doesn&#39;t know which documents it&#39;s referenced in.&#0160; Is there something I wasn&#39;t telling you?&#0160; The answer is that nothing has changed from the last posting and everything I explained there still applies.&#0160; But then how can this command work?&#0160; It&#39;s actually quite simple how the command works and could have easily been implemented as a small add-in command.</p>
<p>When you run the <strong>Open Drawing</strong> command it looks in the current directory and subdirectories for a file that has the same name as the active document, but with a .idw or .dwg file extension.&#0160; If it doesn&#39;t find the file in the current directory or subdirectory it will search the other directories defined by the active project.&#0160; If it still doesn&#39;t find the file then it displays the Open dialog to allow you to specify the file.&#0160; The part doesn&#39;t have any knowledge of the drawing, it&#39;s only the program logic that&#39;s making that association based on the filename of the part.</p>
<p>There was also a related question in the customization newsgroup that I thought was answered in the previous posting but I think probably needs to be emphasized.&#0160; The concept to understand is that a reference to another document is just the filename, i.e. MyPart.ipt, NOT the full filename, C:\Temp\MyPart.ipt.&#0160; When Inventor opens an assembly it reads the file reference list and looks for the referenced files on disk.&#0160; It does this using the file name and the active project to define the possible locations of the file.&#0160; <span style="text-decoration: underline;">The location is not part of the file reference</span>.&#0160; The important thing to get from this is that if you need to reorganize your files and move them around on disk you don&#39;t need to do anything about the file references.&#0160; You only need to make sure that the project specifies the directories that contain the files.&#0160; The only time you need to change file references is when you&#39;ve changed the filename of the file.&#0160; </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Alessandro Ferraz
EMAIL: engenharia@ecologicalatex.com.br
IP: 200.153.55.146
URL: http://www.automationprojects.com.br
DATE: 12/15/2009 06:44:37 PM
Boa tarde,
Comecei a trabalhar com a API do Inventor e estou encontrando um problema que Ã© a das dimensÃµes do esboÃ§o, vocÃª poderia me ajudar me fornecendo o cÃ³digo de como criar um desenho usando o VBA ele vem com as dimensÃµes especificadas por mim um UserForm.
Obrigado.
Alessandro
Â SÃ£o Paulo Brasil
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Understanding File References
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: understanding-file-references
CATEGORY: Assemblies
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/11/understanding-file-references.html 
DATE: 11/06/2008 10:51:29 PM
-----
BODY:
<p>It&#39;s been a long time since my last post.&#0160; I&#39;ve been busy with Autodesk University preparation and the next release of Inventor.</p>
<p>I thought I would take some time to discuss something that is related to some questions I recently saw on the newsgroup and see come up frequently.&#0160; The topic is file references.</p>
<p><strong>Overview</strong></p>
<p>To start let&#39;s look at a very simple case of creating an assembly.&#0160; When you first create the assembly (Assembly.iam in this example) it is empty and doesn&#39;t have any references to other files.&#0160;&#0160;&#0160; When you place a part into the assembly there are two things that Inventor creates.&#0160; It creates the occurrence that you see in the graphics window and as a node in the browser, and it also creates a reference to the part file.&#0160; The file reference isn&#39;t something you see in the user interface but is an internal action that takes place.</p>
<p>To make sense of the file reference concept, I visualize the references as a table in each Inventor document.&#0160; The table is a list of all of the files that file references.&#0160; The table doesn&#39;t know why the reference exists (in this example because of an occurrence being placed), but just that there is a reference to a certain file.&#0160; Below is a picture that illustrates this.&#0160; It&#39;s the assembly with a single instance of Part1.ipt.&#0160; We see the part in the graphics window and in the browser.&#0160; It also shows a representation of the internal table that contains a list of the referenced files, which in this case has a single file in the list.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535df3e58970c-pi"><img alt="FileReferences1" border="0" height="259" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535df3e5d970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="404" /></a> </p>
<p>Now I&#39;ve added a second part to the assembly, Part2.ipt, with the result shown below.&#0160; The result shouldn&#39;t be surprising; a new occurrence in the graphics window and browser and another file in the reference table.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535df3e66970c-pi"><img alt="FileReferences2" border="0" height="259" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535df3e6d970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="404" /></a> </p>
<p>Now I&#39;ve added two more instances of Part1.ipt.&#0160; You see the additional occurrences in the graphics window and the browser but the reference table hasn&#39;t changed.&#0160; That&#39;s because there was already a reference to Part1.ipt.&#0160; There&#39;s never more than one reference for a particular file.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535df3e73970c-pi"><img alt="FileReferences3" border="0" height="259" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860de970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="404" /></a> </p>
<p>When this assembly is opened, Inventor reads the referenced file table, finds the actual file on disk, and opens it.&#0160; Inventor can then use the contents of that file for whatever the reference is used for; assembly occurrences, drawing views, derived parts, etc.</p>
<p><strong>File References and Where Used</strong></p>
<p>One important thing to highlight here&#0160; is that the files being referenced, (Part1.ipt and Part2.ipt in this example) don&#39;t know they&#39;re referenced by another file.&#0160; Referencing a file doesn&#39;t change it in any way.&#0160; This is important because a part can be used in any number of assemblies or drawings.&#0160; Also a file might be read-only because of being an approved part and not available for edit or because the file exists on a read-only media.&#0160; </p>
<p>A couple of the recent questions on the newsgroup had to do with determining where a file is used.&#0160; Given Part1.ipt they want to know where it is used.&#0160; It&#39;s a reasonable question, but as you can see from the discussion above, it&#39;s not a question that Part1.ipt can answer because it doesn&#39;t know.&#0160; Design Assistant supports <em>where used</em> functionality but it does this within the limitations we&#39;ve just discussed.&#0160; Design Assistant looks through all of the files in a specified set of directories and reads the referenced file list within each file to see if that file references the file you want the where used information for.&#0160; This has the limitation that it&#39;s only reporting for the files in the searched directories.&#0160; PDM applications will typically save file reference information in a database when files are checked in and use this data to determine where used information.</p>
<p><strong>Projects</strong></p>
<p>Another topic that&#39;s important to understand relative to file references is <em>projects</em>.&#0160; In the previous example, I explained that when the assembly is opened Inventor reads the referenced file list and then finds and opens the referenced files.&#0160; To find the files Inventor uses the project information.&#0160; The easy way to visualize a project is that it defines a list of directories to search.&#0160; When Inventor reads Part1.ipt from the referenced file list it looks through the directories specified by the project to find Part1.ipt.&#0160; Because of the flexibility of defining where files are you can easily move files around and as long as the project points to the new location Inventor will find and open the file.&#0160; The file reference stored is basically just the file name, not the path because the path is dynamically defined by the current project.</p>
<p><strong>Changing References</strong></p>
<p>A common task is to change a file reference.&#0160; Here&#39;s a simple example to illustrate.&#0160; It starts with the assembly from the previous example where it references two parts; Part1.ipt and Part2.ipt.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860e1970b-pi"><img alt="FileReferences4" border="0" height="254" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860e3970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="300" /></a> </p>
<p>I want to make a revision to Part1.ipt so I make a copy to Part1_Rev1.ipt and make the required changes.&#0160; The picture below illustrates the current situation.&#0160; The assembly is unchanged but I have a new file, Part1_Rev1.ipt, sitting on my disk.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860e6970b-pi"><img alt="FileReferences5" border="0" height="269" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860e8970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="450" /></a>&#0160;</p>
<p>I want my assembly to use the Part1_Rev1.ipt instead of Part1.ipt, as shown below.&#0160; There are a few ways to accomplish this but the result is that the reference in the assembly is changed to another file.&#0160; The occurrences that use that reference automatically reflect the new file.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860ec970b-pi"><img alt="FileReferences6" border="0" height="275" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010535d860ee970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="300" /></a> </p>
<p>There are a few ways to get the result shown above.&#0160; Within Inventor you do it using the <strong>Replace Component</strong> or <strong>Replace All</strong> command, which indirectly will edit the referenced file list.&#0160; You can also accomplish this using Design Assistant.&#0160; Finally Inventor&#39;s API lets you change the file references.&#0160; In fact, from the API you have direct access to the reference file table, which is also what Design Assistant uses internally. </p>
<p><strong>Limitation</strong></p>
<p>There is one limitation to be aware when attempting to change a file reference.&#0160; The general rule is that the new file must be a descendent of the original file.&#0160; In the example above, Part1_Rev1.ipt is a descendent of Part1.ipt because it was created by copying Part.ipt and then subsequently edited.&#0160; Because of this when the reference is changed, assembly constraints are able to compute correctly and the assembly behaves as expected.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rene Gerlach
EMAIL: rene.gerlach@cideon.com
IP: 212.144.19.135
URL: 
DATE: 12/02/2008 06:43:32 PM
Hi Brian, how can I check with the API:
"Part1_Rev1.ipt is a descendent of Part1.ipt"
Thanks for any hints

RenÃ©
-----
COMMENT:
AUTHOR: Pieter
EMAIL: pieter@mgfx.co.za
IP: 41.117.202.104
URL: 
DATE: 11/23/2009 07:46:32 PM
Hi Brian, Is it also posible to change the part reference of a derived part using the API? Any advice would be much appreciated!

Pieter
-----
COMMENT:
AUTHOR: Steffen
EMAIL: steffen@dyhr-nielsen.dk
IP: 87.56.112.154
URL: 
DATE: 07/20/2010 10:20:48 AM
Hi Brian

Searching the net for some time now I would also  like some advice on Pieters issue. This was my best find so far, but no cigar:
<a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Change-reference-of-derived-part/m-p/2671226/highlight/true">http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Change-reference-of-derived-part/m-p/2671226/highlight/true</a> 
-----
COMMENT:
AUTHOR: Nanette
EMAIL: 9wf8b348fb@hotmail.com
IP: 8.14.147.116
URL: http://www.rapidhawk.com/Wedding-Dash.html
DATE: 07/25/2010 09:25:09 AM
This is why i visit you site daily. Great read thanks. Incidently <a href="http://www.rapidhawk.com">http://www.rapidhawk.com</a> has a similar topic.
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Free Programming Books
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: free-programming-books
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/10/free-programming-books.html 
DATE: 10/13/2008 05:27:20 PM
-----
BODY:
<p>Last week I discovered a couple of eBooks that Microsoft is offering for free to registered users of the Express editions of Visual Basic and C#.&#0160; The free books are provided as pdf files and you can also buy the print versions.&#0160; The books are <strong>Microsoft Visual Basic 2008 Express Edition: Build a Program Now!</strong> and <strong>Microsoft Visual C# 2008 Express Edition: Build a Program Now!</strong>&#0160; Here&#39;s the description from the web site:</p>
<blockquote>
<p>This fun and highly visual guide walks you through a complete programming projectâ€”a desktop weather-reporting applicationâ€”from start to finish. Youâ€™ll learn how to put the lightweight, easy-to-use tools in Visual Basic Express to work right awayâ€”creating, compiling, testing, and delivering your first ready-to-use program. Youâ€™ll get expert tips, coaching, and visual examples at each step of the way, along with pointers to additional learning resources.</p>
</blockquote>
<p>I downloaded the Visual Basic version and looked at it briefly.&#0160; I&#39;m not sure it&#39;s the best for a brand new programmer but for someone that&#39;s programmed before (VBA or VB 6) but is new to .Net and Visual Studio I think it can be useful as an introduction to those tools and some of the new language features.&#0160; You definitely can&#39;t beat the price.</p>
<p>Here&#39;s the initial link to download it: <a href="http://msdn.microsoft.com/en-us/beginner/default.aspx" title="http://msdn.microsoft.com/en-us/beginner/default.aspx">http://msdn.microsoft.com/en-us/beginner/default.aspx</a>.&#0160; You&#39;ll need to log in to get any further and then look in the lower right-hand corner for a link to the books.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rajeev Lochan
EMAIL: rajeev@ar-cad.com
IP: 59.92.155.254
URL: http://www.smallguru.com
DATE: 10/25/2008 06:45:37 AM
Hi Brian,
Another good source to begin C# and the information in it is ample to begin Customization of Inventor using C#

http://code.professor-mustard.org/
-----
COMMENT:
AUTHOR: Hampton 
EMAIL: cgavinc@gmail.com
IP: 59.94.224.197
URL: http://www.couponalbum.com/coupons/wiley.htm
DATE: 11/01/2008 11:12:23 AM
Oh!! Wow!! I'll download some free books... Thanks for the link!!
-----
COMMENT:
AUTHOR: woodworking books on cutting boards
EMAIL: scott1202@hotmail.com
IP: 219.133.91.93
URL: http://woodworking-books.org
DATE: 09/20/2010 03:52:51 AM
Great!!Thanks.The free books are provided as pdf files and you can also buy the print versions. 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Program Prototyping
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: program-prototyping
CATEGORY: Beginning API
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/10/program-prototyping.html 
DATE: 10/10/2008 10:48:10 PM
-----
BODY:
<p>In some of the previous postings I&#39;ve talked about some of the advantages and disadvantages of the various languages. One thing I mentioned was the use of VBA to prototype programs.&#0160; A colleague stopped by my office earlier today asking for some help with a program he&#39;s writing for a customer. Apparently the customer, and now him, have been struggling with getting the program to work.&#0160; </p>
<p>Here&#39;s a simplified description of what they were trying to do.&#0160; While working in a drawing that contains retrieved dimensions they want to be able to get to the associated tolerance information from the part.&#0160; I didn&#39;t immediately know the answer to this either but was able to figure it out in a couple of minutes.&#0160; The reason I was able to do this is because I know how to use VBA as a prototyping tool.&#0160; The good part is that you can learn how too. It&#39;s an extremely powerful tool when programming Inventor that you can take advantage of regardless of what language you&#39;re writing your program in.&#0160; </p>
<p>I&#39;ll go through the procedure step-by-step that I used to figure out the solution to this specific problem.&#0160; Although this looks at a specific case, the principles demonstrated here are generally applicable to any case.&#0160; Below is the example for this case for this case which consists of a drawing view with three retrieved dimensions.&#0160; Given a dimension we want to get the tolerance information from the associated parameter in the model.</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b75970c-pi"><img alt="DiameterDim" border="0" height="162" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155c5970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="244" /></a> </p>
<ol>
<li>Have Inventor running with the document open that contains the type of data you want to query.&#0160; 
<li>Select the object you&#39;re interested in.&#0160; In this case it&#39;s one of the dimensions. 
<li>Open the VBA environment and write the following code.&#0160; (I would write it in a module in your application project then you can use it again later.) 
<blockquote>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub DebugObject() <br />&#0160;&#0160;&#0160; Dim oDoc As Document <br />&#0160;&#0160;&#0160; Set oDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; Dim oObj As Object <br />&#0160;&#0160;&#0160; Set oObj = oDoc.SelectSet.Item(1) <br />&#0160;&#0160;&#0160; Stop <br />End Sub</div></blockquote>
<li>Run the VBA macro. You&#39;ll get an error like the one shown below if there isn&#39;t an entity selected.&#0160; Just stop the program, select the desired entity and run it again. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b7a970c-pi"><img alt="GeneralError" border="0" height="139" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155cf970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="244" /></a> <br />
<li>The macro will stop execution at the <strong>Stop</strong> statement.&#0160; (You could have also put a break in the code but the Stop statement is convenient.) 
<li>Right-click the mouse anywhere within the variable oObj and select the &quot;Add Watch...&quot; command. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155d7970b-pi"><img alt="AddWatch" border="0" height="233" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155e0970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="244" /></a>&#0160; <br />
<li>Click <strong>OK</strong> and accept the defaults in the &quot;Add Watch&quot; dialog. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b80970c-pi"><img alt="AddWatch2" border="0" height="182" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b82970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="244" /></a>&#0160; <br /><br />
<li>The Watch window should appear, if it wasn&#39;t already shown, and the variable &quot;oObj&quot; will be displayed. The watch window shows three interesting things; Expression, Value, and Type. The expression is the variable or property we&#39;re watching, the value is the value of that expression, and the type is the type of the variable or object the expression results in. In this example we can see the type of oObj is a DiameterGeneralDimension.&#0160; You&#39;ll often see object types prefixed with &quot;IRx&quot; and you can just ignore the prefix. The Value is empty because a DiameterGeneralDimension doesn&#39;t have an explicit value. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b85970c-pi"><img alt="Debug1" border="0" height="209" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b89970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="431" /></a> <br /><br />
<li>Click on the &quot;+&quot; next to oObj to expand the object. Now all of the properties of the DiameterGeneralDimension are displayed. Each property also shows it&#39;s value and type.&#0160; Some of the properties return objects and have a &quot;+&quot; next to them so you can expand them and see the properties associated with that object.&#0160; In this case there are two properties that are interesting for the problem we&#39;re trying to solve; Retrieved and RetrievedFrom.&#0160; The Retrieved property indicates if this drawing dimension was created by retrieving a dimension from the model.&#0160; You can see in the debug window that the value is True for the currently selected dimension.&#0160; The RetrievedFrom property returns the model dimension this was retrieved from.&#0160; In this case the type of object returned is a FeatureDimension. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155f3970b-pi"><img alt="Debug2" border="0" height="351" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357a6b8c970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="431" /></a> <br /><br />
<li>Expanding the RetrievedFrom property you see the properties of the FeatureDimension object.&#0160; One of these is the Parameter property which returns a ModelParameter object.&#0160; Expanding this we can see the Tolerance property. Finally, expanding on this we can see the upper and lower tolerance values.&#0160; All of this is shown below. <br /><br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155f6970b-pi"><img alt="Debug4" border="0" height="465" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105357155fe970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="404" /></a> <br /><br />
<li>Here&#39;s the corresponding code that was written based on what was learned from the debugger window.&#0160;&#0160; <br /><br />
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub GetDimTolerance() <br />&#0160;&#0160;&#0160; &#39; Get the active document.&#0160; Assumes it&#39;s a drawing.&#0160; <br />&#0160;&#0160;&#0160; Dim oDrawDoc As DrawingDocument <br />&#0160;&#0160;&#0160; Set oDrawDoc = ThisApplication.ActiveDocument <br /><br />&#0160;&#0160;&#0160; &#39; Get the selected dimension, with error handling to <br />&#0160;&#0160;&#0160; &#39; gracefully error out if a dimension isn&#39;t selected. <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Dim oDim As GeneralDimension <br />&#0160;&#0160;&#0160; Set oDim = oDrawDoc.SelectSet.Item(1) <br />&#0160;&#0160;&#0160; If Err Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox &quot;A drawing dimension must be selected.&quot; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Exit Sub <br />&#0160;&#0160;&#0160; End If&#0160; <br /><br />&#0160;&#0160;&#0160; &#39; Check to see if the selected dimension was retrieved. <br />&#0160;&#0160;&#0160; If oDim.Retrieved Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the associated model dimension. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oFeatureDim As FeatureDimension <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oFeatureDim = oDim.RetrievedFrom <br /><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Get the associated model tolerance. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oTol As Tolerance <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oTol = oDim.RetrievedFrom.Parameter.Tolerance <br /><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Display the tolerance value. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print &quot;Tol: &quot; &amp; oTol.Upper &amp; &quot;/&quot; &amp; oTol.Lower <br />&#0160;&#0160;&#0160; End If <br />End Sub</div></li>
</li></li></li></li></li></li></li></li></li></li></ol>
<br />
<p>The specifics of what the code is doing in this case isn&#39;t important but the method we used to arrived at this code is.&#0160; The debug window provides a &quot;live&quot; view of the object model that you can traverse through to see how objects are connected through their various properties. Anytime you want to investigate how to use the API to access a certain object or to get to particular information. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: William
EMAIL: willemjagter@gmail.com
IP: 41.177.19.117
URL: 
DATE: 10/06/2009 10:14:54 AM
Brian;

Can you perhaps give an example, or comment, on how to create an add-in using another IDE than MS Express editions?

Specifically, there is an interesting free .NET IDE which you perhaps know about, namely SharpDevelop (<a href="http://www.icsharpcode.net/OpenSource/SD/),">http://www.icsharpcode.net/OpenSource/SD/),</a> other users may find it useful too.

SharpDevelop does not have some of the limitations of the Visual Express range, so perhaps it is easier to deploy add-ins using it.

Thanks.
-----
COMMENT:
AUTHOR: Andrew Canfield
EMAIL: andrew1001@tiscali.co.uk
IP: 79.77.96.133
URL: 
DATE: 10/13/2009 08:32:39 PM
I don't see a + next to oObj but I do when adding a watch to oDoc - i've probably missed something basic - any ideas what?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Autodesk University
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-university
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/10/autodesk-university.html 
DATE: 10/07/2008 01:43:17 AM
-----
BODY:
<p>Autodesk University is quickly approaching. Much too quickly if you ask me. I still have a lot of work to be ready for my presentations. If you were looking for some Inventor programming classes and couldn&#39;t find them they&#39;re listed under the &quot;Developer&quot; tract rather than the manufacturing tracts. There&#39;s quite a bit of Inventor programming related content this year. Here are the manufacturing related classes I could find. Let me know if I&#39;ve missed any.&#0160;</p>
<blockquote>
<p><a href="http://au.autodesk.com/sessions/detail/2746/" title="DE101-1 InventorÂ® API- Exploring iProperties and Parameters">DE101-1 InventorÂ® API- Exploring iProperties and Parameters</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/2676/" title="DE311-1 InventorÂ® API- New Features in InventorÂ® 2009">DE311-1 InventorÂ® API- New Features in InventorÂ® 2009</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/2655/" title="DE301-1 InventorÂ® API- Taking the Step from VBA Macros to Add-Ins">DE301-1 InventorÂ® API- Taking the Step from VBA Macros to Add-Ins</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/3066/" title="DE205-2 How Deep is the Rabbit Hole- Examining the Matrix and other InventorÂ® Math and Geometry">DE205-2 How Deep is the Rabbit Hole- Examining the Matrix and other InventorÂ® Math and Geometry</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/2767/" title="DE215-1 Introduction to the AutoCADÂ® Electrical API">DE215-1 Introduction to the AutoCADÂ® Electrical API</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/2674/" title="DE305-1 Introduction to the AutodeskÂ® ProductstreamÂ® API">DE305-1 Introduction to the AutodeskÂ® ProductstreamÂ® API</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/3155/" title="DE115-2 Introduction to the AutodeskÂ® Vault API">DE115-2 Introduction to the AutodeskÂ® Vault API</a></p>
<p><a href="http://au.autodesk.com/sessions/detail/2795/" title="DE111-2 InventorÂ® API- Using the Inventor Graphics API">DE111-2 InventorÂ® API- Using the Inventor Graphics API</a></p>
</blockquote>
<p>I&#39;m teaching the first four classes in the list. The first class is the most basic and would be appropriate for any Inventor user. iProperties and Parameters are used so extensively throughout Inventor that understanding how to access them through a programming interface can provide a lot of opportunities to optimize currently tedious processes.</p>
<p>The second class covers new API functionality in Inventor 2009. It&#39;s most appropriate for those of you that have some previous experience with the API.</p>
<p>The third class is a variation of a class I taught last year that covers how to create add-ins and how you can convert existing VBA macros into add-in commands.</p>
<p>The final class is the most advanced class of the four but newer users of the API should also find it interesting. We&#39;ll look at the internal representation of Inventor sketches, models, and assemblies. Inventor&#39;s user-interface covers all of this up and provides an easy to use interface. In this class we&#39;ll peel off the interface and looks at what&#39;s really there and how you can take advantage of it.</p>
<p>Even though it&#39;s always hectic getting everything ready, I look forward to AU each year. It gives me a chance to meet a lot of you and see what you&#39;re doing and hear a few stories about some triumphs you&#39;ve had with the API, and some of your struggles too. If you&#39;ll be at AU I would love to see what you&#39;ve been working on would be more than happy to help you with any API issues you might currently be struggling with. Don&#39;t hesitate to catch me between classes or email me and we can set up a time to meet. Your feedback is critical for us to correctly prioritize the work we&#39;ll be doing for upcoming releases.&#0160;</p>
<p>On Monday there is another set of meetings at the Autodesk Developer Network Conference. We&#39;ll be discussing what&#39;s coming up in the upcoming release of the various products, including Inventor. If you do much programming you should investigate joining ADN. The API support, events like this, and other benefits can make it well worth it. You can find more information about the program at <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=723353" title="Autodesk Developer Network">Autodesk Developer Network</a>.&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Converting VBA Auto Macros to an Add-In
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: converting-vba-auto-macros-to-an-add-in
CATEGORY: Add-In Creation
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/10/converting-vba-auto-macros-to-an-add-in.html 
DATE: 10/03/2008 12:56:53 AM
-----
BODY:
<p>This posting assumes you have a VBA auto macro and want to quit using the auto macro functionality and convert it to an add-in. See the previous posting <a href="http://modthemachine.typepad.com/my_weblog/2008/09/vba-document-projects.html">VBA Document Projects</a> as to why you might want to do this.&#0160; Without a lot of explanation, here are the prerequisites and the steps required to create the add-in.</p>
<p>Here is an example of an automatic macro that exists within a drawing document. It automatically writes out dwf and pdf files of the drawing whenever the drawing is saved.&#0160; The rest of this post looks at the process to create an add-in to replace this auto macro.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub AutoSave() <br /><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Get the filename minus the extension.</font> <br />&#0160;&#0160;&#0160; Dim strFilename As String <br />&#0160;&#0160;&#0160; strFilename = ThisDocument.FullFileName <br />&#0160;&#0160;&#0160; strFilename = Left(strFilename, Len(strFilename) - 4) <br /><br /><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Save the current SilentOperation and then turn it on. <br />&#0160;&#0160;&#0160; &#39; This will suppress the dwf viewer from being displayed. </font><br />&#0160;&#0160;&#0160; Dim currentSetting As Boolean <br />&#0160;&#0160;&#0160; currentSetting = ThisApplication.SilentOperation <br />&#0160;&#0160;&#0160; ThisApplication.SilentOperation = True <br /><br /><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Save the file as dwf. </font><br />&#0160;&#0160;&#0160; Call ThisDocument.SaveAs(strFilename &amp; &quot;.dwf&quot;, True) <br /><br /><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Reset SilentOperation back to its previous value.</font> <br />&#0160;&#0160;&#0160; ThisApplication.SilentOperation = currentSetting <br /><br /><font color="#0000ff">&#0160;&#0160;&#0160; &#39; Save the file as pdf. </font><br />&#0160;&#0160;&#0160; Call ThisDocument.SaveAs(strFilename &amp; &quot;.pdf&quot;, True) <br />End Sub</div>
<p></p>
<p><strong><font size="3">What You&#39;ll Need</font></strong></p>
<p><strong>A Programming Language</strong> - To write an add-in you need to use a language that supports creating COM components. For this example I&#39;ll illustrate the process using both Visual Basic 2008 and C# 2008. Microsoft provides free Express versions of both of these languages. You can install them from the <a href="http://www.microsoft.com/express/download/">Microsoft web site</a>. Microsoft also provides online training resources for learning these languages. If this is all new to you and you don&#39;t know which one to get I would recommend Visual Basic, but it really is a personal preference.</p>
<p><strong>Inventor SDK Developer Tools</strong> - You&#39;ll also need some Inventor specific development tools.&#0160; This is delivered when you install Inventor but you need to run its setup to install it. Assuming you&#39;re using Inventor 2009, locate the following file in Explorer and run it:</p>
<blockquote>
<p>C:\Program Files\Autodesk\Inventor 2009\SDK\DeveloperTools.msi</p></blockquote>
<p>Inventor 2009 was released when Visual Studio 2005 was the current development platform. Because of that the Add-In wizard provided with it does not get installed for use with Visual Studio 2008.&#0160; To work around this you can copy the files below to the specified directories.&#0160; Don&#39;t unzip the files but just copy the file as-is.</p>
<blockquote>
<p><strong>VB 2008</strong> <br />Copy <a href="http://modthemachine.typepad.com/my_weblog/files/VBInventorAddInTemplate.zip">VBInventorAddInTemplate.zip</a> to&#0160; <br />&quot;My Documents\Visual Studio 2008\Templates\ProjectTemplates&quot;</p>
<p><strong>C# 2008</strong> <br />Copy <a href="http://modthemachine.typepad.com/my_weblog/files/VCSInventorAddInTemplate.zip">VCSInventorAddInTemplate.zip</a> to&#0160; <br />&quot;My Documents\Visual Studio 2008\Templates\ProjectTemplates&quot;</p></blockquote>
<p><strong><font size="3">Creating the Add-In</font></strong></p>
<p style="text-align: left">The add-in is created using the add-in template. Start VB or C# and choose to create a new project. For the template choose &quot;Autodesk Inventor AddIn&quot;, as shown below. You can also specify the name of the add-in at this point, (&quot;AutoSaveAddIn&quot; in the example below).</p>
<p style="text-align: center"><br />&#0160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8e2970b-pi" target="_blank"><img alt="New add-in project." border="0" height="223" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8e6970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="360" /></a> </p>
<p style="text-align: left"><br />In the Visual Studio Solution Explorer you&#39;ll see the various files listed that were created for the project. For a Visual Basic add-in, most of the code is in the StandardAddInServer.vb file and for a C# add-in it is in the StandardAddInServer.cs file. Double-click on this file to open it in the code editor. You should see something very similar to one of the pictures below. Your GuidAttribute value will be different than those shown below since that is unique for every add-in. <br /></p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8e8970b-pi"><img alt="AddInStartVB" border="0" height="330" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053523ea19970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="456" /></a>&#0160; <br />Visual Basic Code Window <br /><br /><br /></p>
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8ec970b-pi"><img alt="AddInStartCS" border="0" height="432" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc6883401053523ea5f970c-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="463" /></a> <br />Visual C# Code Window <br /><br /><br /></p>
<p style="text-align: left"><strong><font size="3">Editing the Name and Description of the Add-In</font></strong></p>
<p style="text-align: left">One common thing you&#39;ll want to do when creating an add-in is to define the name and description of the add-in as it will be seen in the Add-In Manager. You do this by editing the code in the &quot;COM Registration&quot; block of the code. Click on the &quot;+&quot; next to this region to expand it. The code in red is the portion I&#39;ve changed to modify the name and the description. The code below is from the VB add-in but the C# code is almost identical and it will be obvious what to edit. <br /></p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Shared Sub Register(ByVal t As Type) <br />&#0160;&#0160; Dim clssRoot As RegistryKey = Registry.ClassesRoot <br />&#0160;&#0160; Dim clsid As RegistryKey = Nothing <br />&#0160;&#0160; Dim subKey As RegistryKey = Nothing <br />&#0160;&#0160; Try <br />&#0160;&#0160;&#0160;&#0160;&#0160; clsid = clssRoot.CreateSubKey(&quot;CLSID\&quot; + AddInGuid(t)) <br />&#0160;&#0160;&#0160;&#0160;&#0160; clsid.SetValue(Nothing, <font color="#ff0000"><strong>&quot;Automated DWF and PDF Save&quot;</strong></font>) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey = clsid.CreateSubKey( _&#0160;&#0160; <br />&#0160;&#0160;&#0160; &quot;Implemented Categories\{39AD2B5C-7A29-11D6-8E0A-0010B541CAA8}&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.Close()&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; subKey = clsid.CreateSubKey(&quot;Settings&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.SetValue(&quot;AddInType&quot;, &quot;Standard&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.SetValue(&quot;LoadOnStartUp&quot;, &quot;1&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39;subKey.SetValue(&quot;SupportedSoftwareVersionLessThan&quot;, &quot;&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.SetValue(&quot;SupportedSoftwareVersionGreaterThan&quot;, &quot;12..&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39;subKey.SetValue(&quot;SupportedSoftwareVersionEqualTo&quot;, &quot;&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39;subKey.SetValue(&quot;SupportedSoftwareVersionNotEqualTo&quot;, &quot;&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39;subKey.SetValue(&quot;Hidden&quot;, &quot;0&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39;subKey.SetValue(&quot;UserUnloadable&quot;, &quot;1&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.SetValue(&quot;Version&quot;, 0) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.Close() <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey = clsid.CreateSubKey(&quot;Description&quot;) <br />&#0160;&#0160;&#0160;&#0160;&#0160; subKey.SetValue(Nothing, <font color="#ff0000"><strong>&quot;Saves drawings as DWF and PDF.&quot;</strong></font>) <br />&#0160;&#0160; Catch ex As Exception <br />&#0160;&#0160;&#0160;&#0160;&#0160; System.Diagnostics.Trace.Assert(False) <br />&#0160;&#0160; Finally <br />&#0160;&#0160;&#0160;&#0160;&#0160; If Not subKey Is Nothing Then subKey.Close() <br />&#0160;&#0160;&#0160;&#0160;&#0160; If Not clsid Is Nothing Then clsid.Close() <br />&#0160;&#0160;&#0160;&#0160;&#0160; If Not clssRoot Is Nothing Then clssRoot.Close() <br />&#0160;&#0160; End Try <br />End Sub <br /></div>
<p></p>
<p></p>
<p></p>
<p></p>
<p><font size="4"><strong>
<p style="text-align: left"><br /><font size="3">Reacting to Events in Visual Basic</font></p></strong></font></p>
<p style="text-align: left">Now we can add the code that will react anytime a document is saved. For a VB add-in, add the code below that&#39;s shown in red. The second line is in the &quot;ApplicationAddInServer Members&quot; code region so you&#39;ll need to expand that region to see the code.&#0160; The code consists of a declaration and an assignment. <br /></p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Class StandardAddInServer <br />&#0160;&#0160; Implements Inventor.ApplicationAddInServer <br />&#0160;&#0160; &#39; Inventor application object. <br />&#0160;&#0160; Private m_inventorApplication As Inventor.Application <br />&#0160;&#0160; <font color="#ff0000"><strong>Private WithEvents m_appEvents As Inventor.ApplicationEvents <br /></strong></font><br />#Region &quot;ApplicationAddInServer Members&quot; <br />&#0160;&#0160; Public Sub Activate( _</div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal addInSiteObject As Inventor.ApplicationAddInSite, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal firstTime As Boolean) _</div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Implements Inventor.ApplicationAddInServer.Activate <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Initialize AddIn members. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication = addInSiteObject.Application <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#ff0000"><strong>m_appEvents = m_inventorApplication.ApplicationEvents</strong></font> <br />&#0160;&#0160; End Sub</div>
<p></p>
<p></p>
<p></p>
<p><br />At the top of the code window are two combo boxes. The one on the left displays a list of classes and the one on the right displays a list of methods for the selected class. Choose &quot;m_appEvents&quot; on the left and &quot;OnSaveDocument&quot; on the right, as shown below. This will insert the sub m_appEvents_OnsaveDocument as shown below. This is the event handler for the OnSaveDocument event will be called whenever a document is saved in Inventor.</p>
<br />
<p style="text-align: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8f2970b-pi"><img alt="OnSaveEventVB" border="0" height="134" src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105351af8f5970b-pi" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="490" /></a> </p>
<p style="text-align: center">&#0160;</p>
<p></p>
<p>Here&#39;s code that&#39;s equivalent to the original AutoSave macro. This performs a couple of additional checks that the original automatic macro didn&#39;t need to do. First, the OnSaveDocument is fired before and after the document is actually saved.&#0160; This listens for when the event is fired after the Inventor save. The event is also fired whenever any document is saved. This looks for and only handles drawing documents.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Private Sub m_appEvents_OnSaveDocument( _&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal DocumentObject As Inventor._Document, _&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal BeforeOrAfter As Inventor.EventTimingEnum, _&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByVal Context As Inventor.NameValueMap, _&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ByRef HandlingCode As Inventor.HandlingCodeEnum) _&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Handles m_appEvents.OnSaveDocument&#0160; <br /><font color="#ff0000">&#0160; If BeforeOrAfter = EventTimingEnum.kAfter Then&#0160; <br />&#0160;&#0160;&#0160; If DocumentObject.DocumentType = DocumentTypeEnum.kDrawingDocumentObject Then&#0160; <br /></font>&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#0000ff">&#39; Get the filename minus the extension.</font>&#0160; <br /><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160; Dim filename As String&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; filename = DocumentObject.FullFileName&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; filename = Left(filename, Len(filename) - 4)&#0160; <br /></font><br />&#0160;<font color="#0000ff">&#0160;&#0160;&#0160;&#0160; &#39; Save the current SilentOperation and then turn it on.&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; &#39; This will suppress the dwf viewer from being displayed.&#0160;&#0160; <br /></font><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160; Dim currentSetting As Boolean&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; currentSetting = m_inventorApplication.SilentOperation&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.SilentOperation = True&#0160; <br /></font><br />&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#0000ff">&#39; Save the file as dwf.</font>&#0160;&#0160; <br /><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160; DocumentObject.SaveAs(filename &amp; &quot;.dwf&quot;, True)&#0160;&#0160; <br /></font><br />&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#0000ff">&#39; Save the file as pdf.</font>&#0160;&#0160; <br /><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160; DocumentObject.SaveAs(filename &amp; &quot;.pdf&quot;, True)&#0160;&#0160; <br /></font><br />&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#0000ff">&#39; Reset SilentOperation back to its previous value.</font>&#0160;&#0160; <br /><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.SilentOperation = currentSetting</font>&#0160; <br /><font color="#ff0000">&#0160;&#0160;&#0160; End If&#0160;&#0160; <br />&#0160; End If <br /></font>End Sub</div>
<br />
<p><strong><font size="3">Reacting to Events in C#</font></strong></p>
<p>The code highlighted in red below was added to support handling the save event in C#.&#0160; The last two lines are in the &quot;ApplicationAddInServer Members&quot; code region so you&#39;ll need to expand that region to see the code.&#0160; The line where the delegate is created to handle the event is mostly created by using Intellisense.&#0160; Go slowly as you type and you&#39;ll see options pop up that allow you to press the tab key to create much of the code.</p>
<p></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">private Inventor.Application m_inventorApplication; <br /><font color="#ff0000"><strong>private Inventor.ApplicationEvents m_appEvents = null; <br /></strong></font><br />public StandardAddInServer() <br />{ <br />} <br />#region ApplicationAddInServer Members <br /><br />public void Activate(</div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Inventor.ApplicationAddInSite addInSiteObject, </div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bool firstTime) <br />{ <br />&#0160;&#0160; <font color="#0000ff">// Initialize AddIn members.</font> <br />&#0160;&#0160; m_inventorApplication = addInSiteObject.Application; <br />&#0160;&#0160; <font color="#ff0000"><strong>m_appEvents = m_inventorApplication.ApplicationEvents; <br /></strong></font><br />&#0160;<font color="#ff0000"><strong>&#0160; <font color="#0000ff">// Create the delegate object to handle the event.</font> <br />&#0160;&#0160; m_appEvents.OnSaveDocument += new&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ApplicationEventsSink_OnSaveDocumentEventHandler(</strong></font></div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new"><font color="#ff0000"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_appEvents_OnSaveDocument);</strong></font> <br />}</div>
<p><br />Intellisense can also create the event implementation code as you&#39;re typing the line above.&#0160; Below is the code it created with the additional code in red that I added to save the dwf and pdf files. <br /></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">void m_appEvents_OnSaveDocument(_Document DocumentObject, </div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; EventTimingEnum BeforeOrAfter,</div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NameValueMap Context, </div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; out HandlingCodeEnum HandlingCode) <br />{ <br /><font color="#ff0000"></font><font color="#0000ff">&#0160;&#0160; // A value has to be returned for the handling code.</font><font color="#ff0000"> <br />&#0160;&#0160; HandlingCode = HandlingCodeEnum.kEventNotHandled; <br /><br />&#0160;&#0160; if (BeforeOrAfter == EventTimingEnum.kAfter) <br />&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160; if (DocumentObject.DocumentType == DocumentTypeEnum.kDrawingDocumentObject) <br />&#0160;&#0160;&#0160;&#0160;&#0160; { <br /></font><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; // Get the filename minus the extension.</font><font color="#ff0000"> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; String filename = DocumentObject.FullFileName; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; filename = filename.Substring(0, filename.Length - 4); <br /><br />&#0160;</font><font color="#0000ff">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; // Save the current SilentOperation and then turn it on. <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; // This will suppress the dwf viewer from being displayed.</font><font color="#ff0000"> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Boolean currentSetting = m_inventorApplication.SilentOperation; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_inventorApplication.SilentOperation = true; <br /><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font><font color="#0000ff">// Save the file as dwf.</font><font color="#ff0000"> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DocumentObject.SaveAs(filename + &quot;.dwf&quot;, true);&#0160; <br /><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font><font color="#0000ff">// Save the file as pdf.</font><font color="#ff0000"> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DocumentObject.SaveAs(filename + &quot;.pdf&quot;, true); </font>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#0000ff">// Reset SilentOperation back to its previous value.</font> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <font color="#ff0000">m_inventorApplication.SilentOperation = currentSetting;</font>&#0160; <font color="#ff0000"><br />&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160; } <br /></font>}</p></div>
<p><strong><font size="4"></font></strong></p>
<p><strong><font size="4"></font></strong></p>
<p><strong><font size="4"><br /></font><font size="3">Cleaning Up</font></strong></p>
<p>Finally, just a bit of code to clean up everything when the add-in is unloaded.&#0160; This is in the Deactivate method of the add-in.&#0160; The code I added is in red.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub Deactivate() Implements Inventor.ApplicationAddInServer.Deactivate <br />&#0160;&#0160; &#39; Release objects. <br /><font color="#ff0000"><strong>&#0160;&#0160; Marshal.ReleaseComObject(m_appEvents) <br />&#0160;&#0160; m_appEvents = Nothing <br /></strong></font><br />&#0160;&#0160; Marshal.ReleaseComObject(m_inventorApplication) <br />&#0160;&#0160; m_inventorApplication = Nothing <br /><br />&#0160;&#0160; System.GC.WaitForPendingFinalizers() <br />&#0160;&#0160; System.GC.Collect() <br />End Sub</div>
<p></p>
<br />
<p>Here&#39;s the equivalent code for C#. </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">public void Deactivate() <br />{ <br />&#0160;&#0160; <font color="#0000ff">// Disconnect the event delegate.</font> <br />&#0160;<font color="#ff0000">&#0160; m_appEvents.OnSaveDocument -= new <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ApplicationEventsSink_OnSaveDocumentEventHandler(</font></div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new"><font color="#ff0000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_appEvents_OnSaveDocument); <br /></font><br />&#0160;<font color="#0000ff">&#0160; // Release objects.</font> <br />&#0160;<font color="#ff0000">&#0160; Marshal.ReleaseComObject(m_appEvents); <br />&#0160;&#0160; m_appEvents = null; <br /></font>&#0160;&#0160; Marshal.ReleaseComObject(m_inventorApplication); <br />&#0160;&#0160; m_inventorApplication = null; <br /><br />&#0160;&#0160; GC.WaitForPendingFinalizers(); <br />&#0160;&#0160; GC.Collect(); <br />} <br /></div>
<p><strong><font size="4"><br /></font><font size="3">Using the Add-In</font></strong></p>
<p>Now all you need to do is build the add-in.&#0160;&#0160; Building the add-in creates the dll and also registers it.&#0160; When you run Inventor you should see the add-in in the Add-In Manager and when you save a drawing document the corresponding pdf and dwf files will also be created.</p>
<p>To use the add-in on another computer you need to copy the add-in dll to that computer and register it.&#0160; Below are some commands you can use within .bat files to both register and unregister the add-in for 32 and 64-bit installations.</p>
<p><strong>Register on 32-bit</strong> </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">@echo off <br />C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe /codebase AutoSaveAddIn.dll <br />PAUSE <br /></div>
<p><strong><br />Unregister on 32-bit</strong> </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">@echo off <br />C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe /unregister AutoSaveAddIn.dll <br />PAUSE <br /></div>
<p><br /><strong>Register on 64-bit</strong> </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">@echo off <br />C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727\RegAsm.exe /codebase AutoSaveAddIn.dll <br />PAUSE <br /></div>
<p><strong><br />Unregister on 64-bit</strong> </p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">@echo off <br />C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727\RegAsm.exe /unregister AutoSaveAddIn.dll <br />PAUSE</div>
<p>When you test the add-in you can&#39;t just open an existing drawing, immediately save it, and expect to see the dwf and pdf files.&#0160; The reason is because the drawing hasn&#39;t changed so clicking the save button doesn&#39;t do anything.&#0160; If you make any change to the drawing, i.e. edit an iProperty or move a view or dimension, the OnSaveDocument event is fired and the additional files will be created.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jon Brabbs
EMAIL: jbrabbs@polypal.co.uk
IP: 82.219.218.73
URL: 
DATE: 10/03/2008 08:10:27 AM
Man I've been doing this the hard way, I've got about 100 lines to do this!

Thanks for the post Brian. I will have a play and see what happens.

Cheers

Jon
-----
COMMENT:
AUTHOR: AlexF
EMAIL: alex.fielder@ntlworld.com
IP: 62.22.46.197
URL: http://bigbeardy.co.uk
DATE: 11/06/2008 11:11:45 AM
Hi,
  I realise I'm a little late joining the party on this, but I was wondering if the template you've created can be used with the Express 2008 versions of both C# and VB.NET?

Cheers,

Alex.
-----
COMMENT:
AUTHOR: Bob Collins
EMAIL: RCollins@SpringMountTech.com
IP: 96.245.38.218
URL: 
DATE: 12/11/2008 04:48:13 AM
Brian,

I ran thru this example using C# and it builds successfully, but I have to manually register the dll to get Inventor to see it.  I am running Vista64 / Inventor 2009 64 bit.  Do I need to do anything different for the 64 bit vs the 32?

Just got back from AU - had a great time!

Thanks,

Bob
-----
COMMENT:
AUTHOR: DanV
EMAIL: dan.vang@mastergraphics.com
IP: 68.249.253.50
URL: 
DATE: 01/14/2009 04:56:10 PM
Brian,

Great code. This will come in handy. A question though, is there a way to generated a pdf\dwf of all the sheets in the IDW file. I noticed that it only publishes the current sheet. 

Thanks,

Dan

-----------

See the posting http://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html

-Brian
-----
COMMENT:
AUTHOR: Tim Straz
EMAIL: tstraz@3lightscad.com
IP: 71.233.85.90
URL: http://www.3lightscad.com
DATE: 02/16/2009 10:59:11 PM
Hi Brian,

Thank you for posting this and all the other great tips.  Is it possible to see the conversion of a VBA form to a VB Add-in?  
Thanks,
Tim
-----
COMMENT:
AUTHOR: Peter Bosse
EMAIL: Peter.Bosse@APV.com
IP: 159.157.246.11
URL: 
DATE: 04/08/2009 12:39:05 PM
Hi Brian,

(AutoSave DWF/PDF)

If I want to place the DWF/PDF in a particular folder fx. T:\InvDrw.. How do i do that..?
-----
COMMENT:
AUTHOR: Brian Ekins
EMAIL: 
IP: 198.102.112.18
URL: http://profile.typepad.com/1218580234s15464
DATE: 04/13/2009 10:51:41 PM
The full filename of the file to create is being defined in the program.  You set this to anything you would like.  In the sample it's getting the full filename of the document being saved and modifying the extension.

Dim filename As String  
filename = DocumentObject.FullFileName  
filename = Left(filename, Len(filename) - 4)  

It could be changed to something like this:

Dim filename As String  
filename = "T:\InvDrw\Myfile.dwf"
-----
COMMENT:
AUTHOR: AlvaA
EMAIL: 
IP: 12.34.50.40
URL: http://profile.typepad.com/6p01156f6e18cf970c
DATE: 05/01/2009 08:09:12 PM
Is it necessary for me to register (using RegAsm) any custom assemblies that my add-in class references?

Here is the problem I am having:
I am have created an add-in to Inventor 2009(in C#) and I am in the process of debugging it.  My add-in uses classes that are defined in other custom assemblies that I have created to be used with the add-in.  When I register the add-in, run Inventor, and click on my created add-in button, I sometimes get exceptions stating that my add-in cannot find the custom assemblies that are needed in order for it to run, although the assemblies are in the same directory as the add-in .dll and are of the correct version.
-----
COMMENT:
AUTHOR: Randy
EMAIL: rlpearson@DSCDREDGE.COM
IP: 69.31.145.145
URL: 
DATE: 05/26/2009 05:49:40 PM
I have the expresss version of visual basic. I build a project in 32 bit and it works. I build it on a 64 bit machine and it doesn't show in the addins. I tried to manually registering it per your bat setup, got a successful register and it still does not show. What am I missing.
-----
COMMENT:
AUTHOR: Randy
EMAIL: rlpearson@DSCDREDGE.COM
IP: 69.31.145.145
URL: 
DATE: 05/26/2009 07:25:26 PM
What I was missing was the name it was published with. It is there and works great.

Thanks
-----
COMMENT:
AUTHOR: Enrico Lucchetti
EMAIL: lucchettie@gmail.com
IP: 80.182.125.228
URL: 
DATE: 06/14/2009 06:23:52 PM
Hi Brian, I built the project and I regoster i on 32 bit, but it does not work in Inventor (I'm using 2008 version). What am I missing? Is it right if the dll is not in the bin directory of Inventor?

thanks

Enrico
-----
COMMENT:
AUTHOR: Jon Holler
EMAIL: hollertrek@gmail.com
IP: 173.31.25.8
URL: 
DATE: 11/08/2009 11:25:25 PM
Hi Brian,

The "StandardAddInServer" gives me errors when I open the the template in vb2008. Any idea what's happening here?

Jon
-----
COMMENT:
AUTHOR: M.S.R
EMAIL: muthushanmugarajan@gmail.com
IP: 59.90.240.146
URL: 
DATE: 07/09/2010 07:46:40 AM
Hi Brain,
I have created an Addin for Inventor using VB.Net in VisualStudio 2008, I have created it as a model-less dialog but when I press tab key the cursor is not moving to next tool.
I have also checked the TabStop and TabIndex those are perfect and when I create the same as model then the tab order is working...Is there any possible ways that I can make the tab order working for model less dialog also...
-----
COMMENT:
AUTHOR: swtor credits
EMAIL: zsamok@gmail.com
IP: 180.109.175.173
URL: http://www.swtorcredits.com/
DATE: 11/16/2010 03:51:48 AM
My add-in uses classes that are defined in other custom assemblies that I have created to be used with the add-in. When I register the add-in, run Inventor, and click on my created add-in button.
-----
COMMENT:
AUTHOR: Darren Smith
EMAIL: dsmith@nfm.net
IP: 213.160.103.178
URL: http://www.nfmiddon.co.uk
DATE: 03/07/2011 12:09:45 PM
Dear Brian,

Can I please ask you if you have the source code (either Visual Basic or "C") for the above project (AutoSave.dll) that I can download?

Can you make the source code public domain?

Kindest Regards

Darren Smith
-----
COMMENT:
AUTHOR: Eddie
EMAIL: egecaine@gmail.com
IP: 66.194.145.20
URL: 
DATE: 04/12/2011 08:27:10 PM
I am newbie to all this and for some odd reason doesn't recognize the add in i've created thru VS2010.  I've read alot about implementing regasm.exe to register your add in, but don't have clue how to do or what that means. Can anyone advise of how to get around this issue or have any reference material they can provide.

thanks


-----
COMMENT:
AUTHOR: Wes D
EMAIL: wesley.demaster@gmail.com
IP: 67.40.168.249
URL: 
DATE: 10/14/2011 01:30:47 AM
What would I have to do to impliment this Add In on a Win7 64 Bit system?
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: VBA Document Projects
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: vba-document-projects
CATEGORY: Beginning API
CATEGORY: Brian
CATEGORY: Visual Basic for Applications (VBA)

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/09/vba-document-projects.html 
DATE: 09/29/2008 07:34:23 PM
-----
BODY:
<p>Inventor&#39;s implementation of VBA supports two types of VBA projects; document projects and external projects.&#0160; They&#39;re defined by where the project is saved.&#0160; Document VBA projects are saved within Inventor documents, parts, assemblies, etc.&#0160; External projects are saved as individual .ivb files.&#0160; Using the File tab of the Application Options dialog you can specify one external project to be loaded automatically when Inventor starts up.&#0160; This VBA project is frequently referred to as the <em>application project</em>.</p>
<p>When VBA was integrated into Inventor we looked at other VBA integrations for ideas.&#0160; All of the applications that supported VBA that I had used at the time all used the idea of document projects so it seemed like that was something we needed to provide as part of Inventor&#39;s implementation.&#0160; However, when I had used some of these applications that only had document projects I didn&#39;t like them because it made maintaining code almost impossible.&#0160; For example, I was writing a reasonably large program in one of the applications and it was stored within a document.&#0160; I would copy that document to use the program with other sets of data.&#0160; When I wanted to make a fix or enhancement to the program I had multiple copies of it and didn&#39;t know which version of the program existed where.&#0160; As a result of this frustration we also added support for external projects in Inventor&#39;s implementation of VBA.</p>
<p>A feature of the document macros that Word and Excel supported that seemed good was the idea of automatic macros.&#0160; These are macros with a particular name that are run automatically when something happens in the application.&#0160; For example, when a document is opened or saved a macro is run.&#0160; This functionality makes it very easy for someone with limited programming experience to write a simple macro to respond to these events in Inventor.</p>
<p>A couple of releases after we added VBA to Inventor we started getting reports of some problems.&#0160; The problem turned out to be a resource issue with VBA.&#0160; People were creating document projects that used automatic macros and were using these Inventor documents that contained these projects as their templates.&#0160; That meant that every file they created had a VBA document project.&#0160; When a large assembly is loaded all of the referenced documents are also loaded, and in the case of these documents also meant loading the embedded VBA projects.&#0160; It turns out that VBA has a limit to the number of VBA projects that can be loaded.</p>
<p>The other significant problem to having document macros in a template is that it creates the problem I already talked about of having your program duplicated in all your documents making it very difficult to fix or enhance that program.&#0160; There is also another problem that recently came up with document projects and 64 bit Inventor.</p>
<p>My advice is: <strong>DO NOT USE document projects</strong>.&#0160; The one exception to this is if you&#39;re writing a program that is very specific to a single document.&#0160; For example if you have a part and write a specific program to work with only that part.&#0160; In this case it&#39;s convenient to package the program with the document rather than worry about passing an additional file with it.</p>
<p>External VBA projects should provide most of the functionality you would want and also provide the additional capability that you can create toolbar buttons to run the macros contained within them.&#0160; What external VBA projects don&#39;t provide is the ability to do the equivalent of automatic macros.&#0160; The best answer for this is to create an Add-In.&#0160; (There have been some Add-In utilities written that add support for automatic macros to VBA external projects but I&#39;ve found for most people that these end up being confusing because they don&#39;t understand how they work and as a result don&#39;t know how to debug and diagnose problems when they occur.)&#0160; An Add-In allows you to do anything you could do in VBA and more.&#0160; The downside of an Add-In is that there&#39;s a higher learning curve to getting started.</p>
<p>In my next posting I&#39;ll cover what&#39;s required to create an Add-In that replaces an existing automatic macro.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: PeterCharles
EMAIL: engineer177@hotmail.co.uk
IP: 88.106.183.41
URL: 
DATE: 10/02/2008 09:48:33 PM
Under some circumstances it is possible to write a macro in a template which is subsequently deleted from the document based on the template prior to the document being saved.

This can overcome the problem with lots of documents all containing macro's outlined above.
-----
COMMENT:
AUTHOR: jakubd
EMAIL: jakubd@pspsolution.pl
IP: 83.8.228.62
URL: http://www.pspsolution.pl
DATE: 10/13/2010 08:44:00 AM
Hi Brian,

Can You please contact me to my email, i have question for one of Our customers.

Best Regards

Jakub
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Fundamentals 004 - Connecting to the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: in-the-last-posting-i-discussed-the-object-model-and-that-it-provides-a-structured-way-to-access-the-various-objects-that-mak
CATEGORY: Beginning API
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/09/in-the-last-posting-i-discussed-the-object-model-and-that-it-provides-a-structured-way-to-access-the-various-objects-that-mak.html 
DATE: 09/23/2008 02:35:39 AM
-----
BODY:
<p>In the last posting I discussed the object model and that it provides a structured way to access the various objects that make up Inventorâ€™s API. In order to use the object model you need to do two things; reference the library that describes Inventorâ€™s object model and gain access to the Application object. (The Application object is the top-most object in the object model and through it you can access all the other objects.)</p>
<p>How you reference the API and access the Application object will differ slightly for the different languages. These are discussed below along with example code that demonstrates getting the Application object and calling its Caption property.</p>
<p><span style="FONT-SIZE: 19px; FONT-FAMILY: Arial Black">Inventorâ€™s VBA</span><br />Because the VBA thatâ€™s delivered with Inventor is integrated with Inventor, it provides the easiest access to Inventorâ€™s object model. In Inventor&#39;s VBA, the Inventor API library is already referenced and it provides an easy way of accessing the Application object by providing a global property called <em>ThisApplication</em>, which returns the Application object. All you need to display Inventorâ€™s caption with Inventorâ€™s VBA is the code below.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">MsgBox ThisApplication.Caption <br /></div>
<p><br /><span style="FONT-SIZE: 19px; FONT-FAMILY: Arial Black">External Application</span> <br /><em>External Application</em> refers to any application that runs outside of Inventor.&#0160; Typically these are Windows applications (.exe programs) but this also includes VBA programs written using VBA in another application (i.e. Word or Excel).&#0160; This term does not refer to Add-In applications. </p>
<p></p>
<p>How you Reference Inventorâ€™s API varies for each of the programming environments and is discussed below for each one. The mechanics of gaining access to the Application object also varies with the different programming languages; however, for all languages there are two basic ways to connect. The first is to see if Inventor is running and get the Application object associated with it. The second is to start Inventor and get the associated Application object. Both are useful and which one to use depends on what youâ€™re trying to accomplish. Connecting to a running instance of Inventor is probably the most common. Starting Inventor is common for batch processing types of programs.</p>
<p><strong><span style="FONT-SIZE: 16px; FONT-FAMILY: Arial">VBA / VB 6</span></strong><br /><strong>Referencing the API</strong><br />Use the â€œReferencesâ€¦â€ command (in the Tools menu in VBA and the Project menu in VB 6) to add a reference to Inventorâ€™s object library, as shown below.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534abd457970b-popup" onclick="window.open































(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="References" class="at-xid-6a00e553fcbfc68834010534abd457970b " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534abd457970b-320wi" title="References" /></a><br />Referencing the Inventor Object Library in VBA and VB 6.</p>
<p><strong>Connecting to a Running Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Dim inventorApp As Inventor.Application<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">&#39; Attempt to get a reference to a running instance of Inventor.<br /></span>On Error Resume Next<br />Set inventorApp = GetObject(, &quot;Inventor.Application&quot;)<br />If Err Then<br />&#0160;&#0160;&#0160; MsgBox &quot;Inventor must be running.&quot;<br />&#0160;&#0160;&#0160; Exit Sub<br />End If<br />On Error GoTo 0<br /><br />MsgBox inventorApp.Caption<br /></div>
<p><br /><strong>Starting an Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Dim inventorApp As Inventor.Application<br /><br />On Error Resume Next<br />Set inventorApp = CreateObject(&quot;Inventor.Application&quot;)<br />If Err Then<br />&#0160;&#0160;&#0160; MsgBox &quot;Error starting Inventor.&quot;<br />&#0160;&#0160;&#0160; Exit Sub<br />End If<br />On Error GoTo 0<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">&#39; Make Inventor visible.</span><br />inventorApp.Visible = True<br /><br />MsgBox inventorApp.Caption<br /></div>
<p><strong><span style="FONT-SIZE: 16px; FONT-FAMILY: Arial">VB.Net</span></strong><br /><strong>Referencing the API</strong><br />The .Net languages use something called an interop assembly to be able to call a COM Automation API. With Inventor 2009, Inventor installs an interop assembly (Primary Interop Assembly or PIA) for all developers to use. You reference this into your application using the â€œAdd Referenceâ€¦â€ command and selecting Autodesk.Inventor.Interop from the .Net tab as shown below.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534b3297c970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, 































&#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="InteropReference" class="at-xid-6a00e553fcbfc68834010534b3297c970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534b3297c970c-320wi" /></a><br />Referencing the Inventor Object Library in VB.Net</p>
<p>For versions of Inventor previous to Inventor 2009 you need to select â€œAutodesk Inventor Object Libraryâ€ from the COM tab of the Add Reference dialog. This will generate a local interop assembly for your project.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534ac3ff8970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, 































&#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="ReferenceNet" class="at-xid-6a00e553fcbfc68834010534ac3ff8970b " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534ac3ff8970b-320wi" /></a><br />Referencing the Inventor Object Library in VB.Net (Inventor 2008 and earlier)</p><br />
<p><strong>Connecting to a Running Instance of Inventor</strong><br />The VBA / VB6&#0160;code above will work in VB.Net, but VB.Net also provides the <em>try catch</em> style of error handling which is usually nicer than the older On Error error handling.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Dim inventorApp As Inventor.Application<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">&#39; Attempt to get a reference to a running instance of Inventor.</span><br />Try<br />&#0160;&#0160;&#0160; inventorApp = GetObject(, &quot;Inventor.Application&quot;)<br />Catch ex As Exception<br />&#0160;&#0160;&#0160; MsgBox(&quot;Inventor must be running.&quot;)<br />&#0160;&#0160;&#0160; Exit Sub<br />End Try<br /><br />MsgBox(inventorApp.Caption)<br /></div>
<p><strong>Starting an Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Dim inventorApp As Inventor.Application<br />Try<br />&#0160;&#0160;&#0160; inventorApp = CreateObject(&quot;Inventor.Application&quot;)<br />Catch ex As Exception<br />&#0160;&#0160;&#0160; MsgBox(&quot;Error starting Inventor.&quot;)<br />&#0160;&#0160;&#0160; Exit Sub<br />End Try<br /><br />inventorApp.Visible = True<br /><br />MsgBox(inventorApp.Caption)<br /></div>
<p><strong><span style="FONT-SIZE: 16px; FONT-FAMILY: Arial">C#</span></strong><br /><strong>Referencing the API</strong><br />Referencing the API in a C# application is exactly the same as for Visual Basic and the instructions above apply.&#0160; You&#39;ll need to add the following to the top of your project.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">using System.Runtime.InteropServices;</div><br />
<p><strong>Connecting to a Running Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Inventor.Application inventorApp = null<br />try<br />{<br />&#0160;&#0160;&#0160;<span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Attempt to get a reference to a running instance of Inventor.</span><br />&#0160;&#0160;&#0160;inventorApp =(Inventor.Application)Marshal.GetActiveObject(&quot;Inventor.Application&quot;);<br />}<br />catch</div>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">{<br />&#0160;&#0160;&#0160;MessageBox.Show(&quot;Unable to connect to Inventor.&quot;)<br />&#0160;&#0160;&#0160;return;<br />}<br /><br />MessageBox.Show(inventorApp.Caption);<br /></div>
<p><br /><strong>Starting an Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Inventor.Application inventorApp = null;<br /><br />try<br />{<br />&#0160;&#0160;&#0160;<span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Start Inventor.</span><br />&#0160;&#0160;&#0160;System.Type oType = System.Type.GetTypeFromProgID(&quot;Inventor.Application&quot;);<br />&#0160;&#0160;&#0160;inventorApp = (Inventor.Application)System.Activator.CreateInstance(oType);<br /><br />&#0160;&#0160;&#0160;<span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Make Inventor visible.</span><br />&#0160;&#0160;&#0160;inventorApp.Visible = true;<br />}<br />catch<br />{<br />&#0160;&#0160;&#0160;MessageBox.Show(&quot;Unable to start Inventor.&quot;);<br />&#0160;&#0160;&#0160;return<br />}<br /><br />MessageBox.Show(inventorApp.Caption);<br /><br /><br /></div>
<p><strong><span style="FONT-SIZE: 16px; FONT-FAMILY: Arial"></span></strong>&#0160;</p>
<p><strong><span style="FONT-SIZE: 16px; FONT-FAMILY: Arial">Visual C++</span></strong><br /><strong>Referencing the API</strong><br />Referencing the API for an unmanaged VC++ project is done by including a header file provided by Inventorâ€™s SDK. This header file imports Inventorâ€™s object library and includes some other useful header files.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">#include &quot;InventorUtils.h&quot;</div>
<p><strong>Connecting to a Running Instance of Inventor</strong><br />There are different flavors of VC++ (managed and unmanaged) and different ways to use Inventorâ€™s API from VC++. The samples below represent one style.</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">HRESULT Result = NOERROR;<br /><br />CLSID inventorClsid;<br />Result = CLSIDFromProgID (L&quot;Inventor.Application&quot;, &amp;inventorClsid);<br />if (FAILED(Result)) return Result;<br /><br />CComPtr<iunknown> pInventorAppUknown;<br />Result = ::GetActiveObject (inventorClsid, NULL, &amp;pInventorAppUknown);<br />if (FAILED (Result)){<br />&#0160;&#0160;&#0160;MessageBox(0, _T(&quot;Could not connect to Inventor.&quot;), _T(&quot;Error&quot;), 0);<br />&#0160;&#0160;&#0160;return Result;<br />}<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// QueryInterface for the Inventor Application object.</span><br />CComPtr<application> pInventorApp;<br />Result = pInventorAppUknown-&gt;QueryInterface(__uuidof(Application),<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;(void **) &amp;pInventorApp);<br />if (FAILED(Result)) return Result;<br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Get and display the caption.</span><br />CComBSTR bstrCaption;<br />Result = pInventorApp-&gt;get_Caption(&amp;bstrCaption);<br />if (SUCCEEDED(Result))<br />&#0160;&#0160;&#0160;MessageBox(0, bstrCaption, _T(&quot;Inventor Caption&quot;), 0);<br /><br /></application></iunknown></div>
<p><br /><strong>Starting an Instance of Inventor</strong></p>
<div style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">HRESULT Result = NOERROR;<br /><br />CLSID inventorClsid;<br />Result = CLSIDFromProgID (L&quot;Inventor.Application&quot;, &amp;inventorClsid);<br />if (FAILED(Result)) return Result;<br /><br />CComPtr<iunknown> pInventorAppUknown;<br />Result = CoCreateInstance(inventorClsid, NULL, CLSCTX_LOCAL_SERVER,<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;__uuidof(IUnknown), (void **) &amp;pInventorAppUknown);<br />if (FAILED (Result)) {<br />&#0160;&#0160;&#0160;MessageBox(0, _T(&quot;Could not start Inventor.&quot;), _T(&quot;Error&quot;), 0);<br />&#0160;&#0160;&#0160;return Result;<br />}<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// QueryInterface for the Inventor Application object.</span><br />CComPtr<application> pInventorApp;<br />Result = pInventorAppUknown-&gt;QueryInterface(__uuidof(Application),<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;(void **) &amp;pInventorApp);<br />if (FAILED(Result)) return Result;<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Make Inventor visible.</span><br />pInventorApp-&gt;Visible = VARIANT_TRUE;<br /><br /><span style="BACKGROUND: #eeeeee; COLOR: #0000ff">// Get and display the caption.</span><br />CComBSTR bstrCaption;<br />Result = pInventorApp-&gt;get_Caption(&amp;bstrCaption);<br />if (SUCCEEDED(Result))<br />&#0160;&#0160;&#0160;MessageBox(0, bstrCaption, _T(&quot;Inventor Caption&quot;), 0);<br /></application></iunknown></div>
<p></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tore
EMAIL: tme@apl.no
IP: 212.4.33.194
URL: 
DATE: 09/23/2008 08:11:57 AM
Hi Brian


Thanks, great to finally see a Inventor API blog. Looking forward to follow your posts.


Cheers
Tore
-----
COMMENT:
AUTHOR: Rajeev Lochan
EMAIL: rajeev@ar-cad.com
IP: 59.92.132.78
URL: http://www.smallguru.com
DATE: 09/23/2008 09:08:35 AM
Great Post Brian !!!
Looking forward for more posts from you :)

And thanks for covering C# code as well. Please try to give C# code examples in future posts as well.
-----
COMMENT:
AUTHOR: Thad 
EMAIL: ttf@quickdraft.com
IP: 70.60.161.139
URL: 
DATE: 09/25/2008 03:10:50 PM
Anyone have a clue how to rename the part # / member name fields in a case where
 I-assemblies and I-parts need to change per a new B.O.M. system , but have already been used in multiple higher level assemblies? This is a difficult thing to find info on, I think "VBA.net" may be our only hope??
-----
COMMENT:
AUTHOR: Eric Mathews
EMAIL: Eric@cimarronnorman.com
IP: 64.19.62.178
URL: 
DATE: 12/24/2008 03:55:53 PM
Hello,
Great information. I'm following the steps provided and I'm not getting the desired results. I am using VB.net 2008 Express. One thing is, my Inventor did not install the "Autodesk.Inventor.Interop". In order to get this file I have to install the SDK and then I can get it from: C:\Program Files\Autodesk\Inventor 2009\SDK\DeveloperTools\References.
Here is my code:

Imports Inventor
Public Class Inventor
    Public Sub LoadInv()
        Dim app As Inventor.application

    End Sub
End Class

I get the following error: Type 'Inventor.application' is not defined.

I think I'm getting close but I'm have some problem somewhere.

-----
COMMENT:
AUTHOR: Saeheal Fraubard
EMAIL: fraubard@naver.com
IP: 221.148.95.117
URL: 
DATE: 01/20/2009 06:19:30 AM
Hi Brian

Thanks, I got a lot help from this post with useing C++ API and asking your help.

I'm in the problem with Opening and Saving Preversion Inventor file with API. Dlg box(Check box) is popping up for warning.

Is there anyway to open or save in defalt mode? (In SolidWorks API, there's Silent Option, but I can't find any Option in Inventor open or save API)

Looking forward to meet your posts.


Cheers
Saeheal
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Woodworking with Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: woodworking-with-inventor
CATEGORY: Brian
CATEGORY: Woodworking

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/09/woodworking-with-inventor.html 
DATE: 09/12/2008 06:28:29 PM
-----
BODY:
<p>This posting is a little off-topic of the API but I thought I would show you a little of&#0160;how I use Inventor at home.&#0160; I do some woodworking and use Inventor to design my woodworking projects.&#0160; I agonize over the design and&#0160;worry about every cut.&#0160;Being able to&#0160;fully design every piece and see how they&#0160;fit together&#0160;before&#0160;making any saw dust&#0160;is a huge help.&#0160; Here are some pictures of my latest project, a Murphy bed.</p>
<p style="TEXT-ALIGN: center">&#0160;<a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105349dc60f970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="BedUp" class="at-xid-6a00e553fcbfc688340105349dc60f970b " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105349dc60f970b-320wi" /></a>&#0160; <br />The bed in the up position.&#0160;(click to see full size in new window)</p>
<p style="TEXT-ALIGN: center">&#0160;</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a47562970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="BedDown" class="at-xid-6a00e553fcbfc68834010534a47562970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a47562970c-320wi" /></a>&#0160; <br />The bed in the down position. (click to see full size in new window)</p>
<p style="TEXT-ALIGN: center">&#0160;</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a476c2970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="RealBed" class="at-xid-6a00e553fcbfc68834010534a476c2970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a476c2970c-320wi" /></a>&#0160;<br />The real thing.&#0160;(click to see full size in new window)</p>
<p style="TEXT-ALIGN: left">Inventor worked great for the initial design.&#0160; Where it fell short was in the process of going from that design to a set of working drawings.&#0160; The biggest issue was determining the stock I would need and how to cut the pieces from that stock.&#0160; Admittedly this is mostly a woodworking specific problem and not something Inventor was designed for.&#0160; The method I ended up using was to create an assembly for each type of wood.&#0160; For example, I had one assembly for all 3/4&quot; oak plywood, and another for all 3/4&quot; solid oak.&#0160;In each assembly I have a sketch that contains one or more rectangles that represent the stock.&#0160; I inserted each part into the correct assembly and manually positioned them within the stock. Below is a screen shot of one of these assemblies.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105349de91d970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"><img alt="BoardLayout" class="at-xid-6a00e553fcbfc688340105349de91d970b " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc688340105349de91d970b-320wi" /></a><br />Laying out the boards on the stock.</p>
<p style="TEXT-ALIGN: left">I made drawings of these assemblies to use in the shop. These drawings, an assembly drawing containing the parts list and a few more detail drawings, and I was ready to start cutting.</p>
<p style="TEXT-ALIGN: left">I plan to write an add-in to help automate the stock layout process.&#0160;I have the intial design but it will be a long-term project.</p>
<p style="TEXT-ALIGN: left">I purchased the bed mechanism and plans from <a href="http://www.rockler.com/product.cfm?page=17212" target="_blank">Rockler Woodworking.</a>&#0160;Their overall design <span id="fck_dom_range_temp_1221239136468_636"></span>is very good and the hardware functions great.&#0160; The goal of their plan was to make a bed that works and the construction being as easy as possible. I didn&#39;t like some of what they did to make the construction easier so I made some changes.&#0160;The majority of the wood in their plan&#0160;is&#0160;just plywood with iron-on edge banding.&#0160; I used solid wood to cover the edges of the sides and made rail and stile panels for the front doors.&#0160; I chose baltic birch for the bed frame and left the edges exposed.&#0160;They also had a lot of screwed butt joints in their design.&#0160;Instead I used a combination of dovetails, biscuits, and pocket screws so none of the fasteners are visible.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: AllenG
EMAIL: agager@atferrell.com
IP: 63.131.46.40
URL: 
DATE: 09/17/2008 09:32:05 PM
Nice job Brian.  It's neat to see how you are using the product and some of the challenges that occur. There are few things that say "quality" better than a nice dovetail joint.
-----
COMMENT:
AUTHOR: Brian Hall
EMAIL: bhall@qubeitdesign.com
IP: 24.173.161.78
URL: 
DATE: 10/22/2008 04:05:52 PM
That's an interesting method of determining your cuts from stock sizes.  Sort of a CNC method.

I work with aluminum framed structures so I will eventually be tackling the same type of problem programatically (i.e. stock lengths are 20', 24', 30' and I have 80 pieces to cut in all different lengths) so keep us posted on the progress of your "long term" project.  Good post!!
-----
COMMENT:
AUTHOR: K-nut
EMAIL: knutga@online.no
IP: 81.0.152.10
URL: 
DATE: 10/23/2008 06:58:56 AM
Very nice idea, Brian!
I'm using Inventor in pretty much the same way, but didn't think of this assembly approach to determine my cuts.
I've been using the program CutListPlus alongside Inventor for my sheet layouts, but an integrated Inventor application would be just perfect! I'm sure CutListPlus could provide some ideas for your development.
(For the record, I'm in no way associated with the company making CutListPlus, I'm just trying to contribute to your project!)

Anxiously awaiting your further progress on this project!

Greetings from Norway.
-----
COMMENT:
AUTHOR: Wood Working Projects
EMAIL: hariluker@hotmail.com
IP: 72.86.105.100
URL: http://www.woodworkingproject.org
DATE: 02/13/2010 03:30:23 AM
I started to use Inventor a few months ago, but it really does take some time t get used to it, for me i'm only just getting into it but after reading this it;s time to start things up again. Thanks!
-----
COMMENT:
AUTHOR: Woodworking plans
EMAIL: appieh58@hotmail.com
IP: 95.96.76.19
URL: http://www.woodworkingIdea.com
DATE: 03/14/2010 02:51:11 PM
Great work! Thank you for posting this information. I'm sure that every woodworker will love this.
-----
COMMENT:
AUTHOR: Woodworking Rack
EMAIL: jb@woodworkingrack.com
IP: 99.65.104.147
URL: http://www.woodworkingrack.com
DATE: 05/16/2010 03:00:40 PM
Brian, I had no idea about Inventor until I saw this post.  You gave me something new to check out.  Nice job on the Murphy bed, I love it!
-----
COMMENT:
AUTHOR: Woodworking Equipment
EMAIL: sumair.arshad@gmail.com
IP: 221.132.112.94
URL: http://www.woodworkingequipments.com/
DATE: 07/06/2010 12:38:31 PM
I didn't know before about woodworking with inventor but you explained here new to check out about woodworking inventor.
-----
COMMENT:
AUTHOR: haddin 
EMAIL: suntz210@gmail.com
IP: 61.94.132.19
URL: http://www.topwoodworkings.com
DATE: 07/11/2010 02:37:08 PM
this is what is needed as inspiration, this is a remarkable woodworking plans
-----
COMMENT:
AUTHOR: Cut machine
EMAIL: baura1@yahoo.com
IP: 188.27.89.159
URL: http://www.diecuttingmachine.org/choosing-a-die-cutting-machine/
DATE: 07/20/2010 11:26:09 PM
Brian Nice work. It's nice to see how you are using the product and some of the challenges we face. Few things say "quality" better than a dovetail joint. 
-----
COMMENT:
AUTHOR: Cartus canon
EMAIL: cartuse@yahoo.com
IP: 188.26.146.161
URL: http://www.cartuse.ro/
DATE: 08/04/2010 10:54:33 AM
Good post! I work with aluminum framed structures which ultimately will be fighting the same kind of problem by programming (ie values are lengths of 20 ', 24', 30 'and I have 80 pieces of cut in all different lengths ) to keep us informed on the progress of its "long term" project. 
-----
COMMENT:
AUTHOR: Fast growing hedges
EMAIL: eaura@yahoo.com
IP: 188.27.90.238
URL: http://www.fastgrowinghedges.net/
DATE: 08/09/2010 12:45:51 PM
The announcement is a bit off-topic of the API, but I thought it was going to show something of how I use Inventor at home. 
-----
COMMENT:
AUTHOR: Woodworking project plans
EMAIL: scott1202@hotmail.com
IP: 183.15.15.118
URL: http://woodworking-books.org
DATE: 08/30/2010 01:41:26 PM
Woodworking at home can be a fun and rewarding experience. 

-----
COMMENT:
AUTHOR: effah davis
EMAIL: davisdave@gmail.com
IP: 41.218.243.60
URL: http://woodworkersplans.webs.com
DATE: 02/28/2011 11:45:24 AM
I also purchasd Rockler Woodworking it i was happy i did.Infact woodworking at home should be fun and should not be as serious as exams 
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Fundamentals 003 - The Object Model
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: inventor-api-fundamentals-003---the-object-model
CATEGORY: Beginning API
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/09/inventor-api-fundamentals-003---the-object-model.html 
DATE: 09/12/2008 07:35:54 AM
-----
BODY:
<p>As discussed in the <a href="http://modthemachine.typepad.com/my_weblog/2008/09/inventor-api-fundamentals-002---choosing-a-language.html" target="_blank">previous post</a> , Inventor exposes its programming interface using COM Automation technology. A COM Automation interface is an object oriented type of interface. This means the API defines a set of objects and these objects have various functions (methods and&#160;properties) that allow you to query, edit, and create new objects.&#160; For Inventorâ€™s API, most of the API objects will already be familiar to you because they represent the same things youâ€™re working with when you use Inventor interactively, (which is why it&#39;s important to have a good knowledge of Inventor before attempting to use the API). For example, in the API there is a Parameter object that represents a parameter in a part or assembly. The Parameter object supports methods and properties that allows you to query and edit the parameter it represents.&#160; For example, a Parameter object has a property called Name that will return the name of the parameter and you can set the value of the property to change the name of the parameter. </p>
<p>The <em>Object Model</em> is an important concept to understand in order user the API. The API objects are linked together in a logical way. In order to get a certain object you need to understand how they&#39;re linked because you&#39;ll need to go from one object to another to get to a specific object. The structure of the objects is referred to as the object model. The object model is typically represented as a hierarchal chart that shows the relationship between objects. If youâ€™re familiar with C++ class diagrams, this IS NOT the same as that. It does not show a class hierarchy but illustrates an ownership hierarchy.&#160; For example, a dimension constraint is owned by a sketch, it&#39;s not derived from the sketch.&#160; If you have&#160;a reference&#160;to an API object you should be able to traverse the object model to access any other object as long as you understand the structure of the object model. </p>
<p>There are a few tools available to help you view and understand this object model: </p>
<ul>
<li>
<p style="TEXT-ALIGN: left"><strong>Object Model Chart</strong> â€“ This is a chart that illustrates the object hierarchy. Itâ€™s most useful in a hard copy form because of it&#39;s size it&#39;s hard to view on a computer screen. Initially, it can look a bit overwhelming because there are so many objects but because youâ€™ll typically just be using a few objects within a certain area of the API you&#39;ll end up learning it in small pieces. </p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a27ef5970c-popup" onclick="window.open(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="ObjectModel" class="at-xid-6a00e553fcbfc68834010534a27ef5970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a27ef5970c-pi" style="WIDTH: 400px" title="ObjectModel" /> </a><br />Object Model Chart (click to expand in a new window) </p>
<p style="TEXT-ALIGN: left">This chart is delivered as part of the Inventor API SDK (Software Development Kit) but you can also download it <a href="http://modthemachine.typepad.com/my_weblog/files/Inventor2009Model.pdf">here.</a></p>
<p></p>
<p></p>
<li><strong>Online Help</strong> â€“ Part of the programming help thatâ€™s delivered with Inventor contains a description of every object along with details about the methods, properties, and events each object supports. You access the programming help from the Help menu in Inventor. 
<p></p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a28075970c-popup" onclick="window.open(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="ProgrammingHelp" class="at-xid-6a00e553fcbfc68834010534a28075970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a28075970c-pi" style="WIDTH: 400px" title="ProgrammingHelp" /></a> <br />Inventor API Programming Help (click to expand in a new window) </p>
<li>
<p><strong>Object Browser</strong> â€“ The object browser is a user-interface for viewing the objects and their associated methods and properties. Object browsers exist in various forms in the different languages but the object browser that&#39;s part of VBA is probably the best for viewing Inventor&#39;s objects. From within VBA you show the object browser by running the Object Browser command (F2). The drop-down in the upper-left of the Object Browser dialog lets you choose which programming library you want to view. The field below that allows you to search the library.&#160; The dialog contains two main areas. The one of the left is a list of all of the objects in the selected library. When you select an object, the area on the right shows the methods and properties of that object. Selecting a method or property will display specific information about it at the bottom of the dialog.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105349bbfa4970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="DISPLAY: inline"></a><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2895d970c-popup" onclick="window.open(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="ObjectBrowser" class="at-xid-6a00e553fcbfc68834010534a2895d970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2895d970c-pi" style="WIDTH: 400px" title="ObjectBrowser" /></a><br />VBA Object Browser (click to expand in a new window)</p>
<li>
<p><strong>VBA Debugger</strong> â€“ The VBA debugger is also useful outside of the normal context of debugging a program. Because of VBAâ€™s support of COM Automation&#160;it allows you to examine live objects and their properties while traversing through&#160;multiple levels&#160;of the object model. This is an extremely powerful and useful tool no matter what language youâ€™re using, and well worth learning how to use.<br /><br />If you&#39;re unfamiliar with debugging in VBA, here&#39;s a crash course.</p>
<ol>
<li>Have Inventor running and a part open that contains a few features. 
<li>Open Inventor&#39;s VBA development environment (Alt-F11). 
<li>Double-click on a module in a project to open a code window.&#160; In the picture below it&#39;s Module1 from the ApplicationProject. 
<li>Create the Sub as shown in the picture below. 
<li>Position the cursor anywhere within the Sub you just wrote and press F8 to start debugging. 
<li>Right-click the mouse over ThisApplication and choose &quot;Add Watch...&quot; from the context menu.&#160; Click OK on the Add Watch dialog. 
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2b4a8970c-popup" onclick="window.open(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="DebugSample1" class="at-xid-6a00e553fcbfc68834010534a2b4a8970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2b4a8970c-pi" style="WIDTH: 400px" title="DebugSample1" /></a>&#160;<br />Using the VBA Debugger (click to expand in a new window) </p>
<li>
<p style="TEXT-ALIGN: left">VBA will open the Watches window with the variable you selected displayed in the window, as shown below.&#160; The object shown in this example is the Application object.&#160; The Application object represents the entire Inventor application and is the top&#160;most&#160;object in the object model.&#160; You can click the &quot;+&quot; next to the name to expand the object to show its properties.&#160; Each property&#160;shows its current value, or if the property returns another object it will have a &quot;+&quot; next to it.&#160; You can traverse through the hierarchy by expanding the plus signs.<br /><br />This provides a live view of the object model.&#160; In the example below, the ActiveDocument property is expanded to show the currently active document.&#160; For a part, most of the interesting information is contained within an object called PartComponentDefinition which is returned by the ComponentDefinition property of the PartDocument. You&#39;ll see this object provides access to parameters, features, and other part related objects. Playing with this, along with the object model chart, you can get a better understanding of the object model.</p>
<p style="TEXT-ALIGN: center"><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2c5d8970c-popup" onclick="window.open(this.href,&#39;_blank&#39;,&#39;scrollbars=no,resizable=yes,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39;); return false" style="DISPLAY: inline"><img alt="DebugSample2" class="at-xid-6a00e553fcbfc68834010534a2c5d8970c " src="https://modthemachine.typepad.com/.a/6a00e553fcbfc68834010534a2c5d8970c-pi" style="WIDTH: 400px" title="DebugSample2" /></a>&#160;<br />VBA Watch Window&#160;(click to expand in a new window) </p></li>
</ol>
</li>
</ul>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Fundamentals 002 - Choosing a Language
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: inventor-api-fundamentals-002---choosing-a-language
CATEGORY: Beginning API
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/09/inventor-api-fundamentals-002---choosing-a-language.html 
DATE: 09/10/2008 03:42:20 PM
-----
BODY:
<p>To program Inventor you need to use some type of programming language.&#160; The good and the bad news is that there are a lot of choices.&#160; Itâ€™s good because it provides flexibility for everyone to choose something they like and best fits their requirements.&#160; Itâ€™s bad because you have to make a choice and if youâ€™re new to all of this you may not know what to look for in making that choice.&#160; Discussing computer languages can be a dangerous topic because people tend to have strong opinions and can be passionate about their language of choice.&#160; In reading any of the following, just remember that itâ€™s my opinion.&#160;<br />For learning Inventorâ€™s API, I believe you should use Inventor&#39;s VBA (Visual Basic for Applications).&#160; Iâ€™m not saying itâ€™s the best language to use when writing applications for Inventor, but I think it is the best for learning and experimenting with the API.</p>
<p>When programming Inventor, Inventor doesnâ€™t care which language you use.&#160; Inventor exposes its programming interface using Microsoft technology called <em>COM Automation</em>.&#160; This technology provides a formalized way to describe the details of a programming interface in a generic way.&#160; When you call an Inventor API function&#160;the call&#160;goes through this Automation interface and when Inventor receives the call it doesnâ€™t even know what programming language the call came from.&#160; The only language requirement when programming Inventor is that it supports COM Automation, which most languages do.</p>
<p>My reason for recommending VBA&#160;is because VBA was designed specifically for programming COM Automation interfaces.&#160; Because of this there are two big advantages to using VBA; the Object Browser and debugging.&#160;&#160;The Object Browser is a tool within VBA that allows you to look at the objects and functions provided by an API.&#160; Other languages also provide object browsing functionality but they donâ€™t work as well as the VBA browser for viewing COM Automation interfaces.&#160; As far as debugging, almost all languages support the ability to debug your programs; however VBA supports better&#160;debugging a COM Automation interface by allowing you to view more details about objects.&#160; Another point in VBAâ€™s favor is thatâ€™s it integrated with Inventor, which means if you have Inventor you have VBA.&#160; This integration also makes it easier to access Inventorâ€™s API than&#160;when using&#160;any other language.&#160; One other advantage is that the API samples in the online help are currently all written in VBA.</p>
<p>All of the reasons Iâ€™ve listed above make VBA an easier language to use when learning the API and even later when prototyping and investigating the capabilities of the API.&#160; No matter what your programming experience and language preferences I highly recommend gaining a basic understanding of VBA because I believe it will benefit your overall programming efficiency when programming Inventorâ€™s API.&#160; You can think of VBA as a style of pseudo-code that you can run and test.&#160;&#160;The API principles you learn with VBA aren&#39;t language specific and&#160;are&#160;easily transferred to any other language.</p>
<p>Even with the advantages of using VBA discussed above, I donâ€™t recommend VBA for writing an Application.&#160; It&#39;s ok for small macros but for larger work there are better choices.&#160; All languages have pros and cons and VBAâ€™s cons donâ€™t make it the best language for writing applications.&#160; My current personal choice for writing applications is Visual Basic .Net, which Visual Basic 2008 is the most current version.&#160; My choice of Visual Basic over most of the other available languages is primarily personal preference but there are a couple of reasons I would also recommend it to a newer programmer.&#160; First, it provides an easier upgrade path from VBA and second, I believe it is easier to use than the other languages.</p>
<p>One version of Visual Basic worth spending a little time discussing here is Visual Basic 6.&#160; Many of the existing larger samples provided with Inventor&#39;s SDK were written using VB 6.&#160; This is an older version of the Visual Basic language and has many of the same advantages as VBA since it uses the same underlying engine.&#160; It was made to program COM Automation types of programming interfaces and has the same object browser and debugging support that VBA has.&#160; A big problem with VB 6 is that it has been discontinued and is no longer available from Microsoft.&#160; It also does not support writing applications for 64 bit Windows.&#160; If youâ€™re going to make the effort to learn a programming language it doesnâ€™t seem very good to spend your time learning and writing a lot of code with an obsolete language.&#160;&#160;Becuase of that I canâ€™t recommend using VB 6.</p>
<p>The .Net languages, C# and Visual Basic, both support COM Automation programming.&#160; Even though they both have the object browser tool and support debugging they don&#39;t work as well as they do in VBA. However, they have a lot of other advantages over VBA (and VB 6) that makes them a better choice for larger application development.&#160; Whether you choose Visual Basic or C# is really just personal preference.</p>
<p>The other popular language, primarily with professional developers, is Visual C++.&#160; Visual C++ is a very powerful language but is also difficult to learn and use.&#160; It supports programming a COM Automation interface but is significantly harder than either Visual Basic or C# to use.&#160; If you choose to use Visual C++ you can expect a higher learning curve and longer development times.</p>
<p>Finally, there are a few fringe languages.&#160; Some of these have been around for a long time, (i.e. Delphi), and others are relatively new (i.e. Python).&#160; As I said earlier, Inventor doesnâ€™t know or care what language youâ€™re using and you can use whatever you choose.&#160; However, youâ€™ll have a hard time finding any samples or support when using these languages.&#160; For me, theyâ€™re interesting to look at but at this point I would be hesitant to begin a large development project using any of them.</p>
<p>No matter what language you choose I still recommend using VBA&#160;for&#160;prototyping&#160;investigating the API.&#160; For the rest of this series of articles Iâ€™ll be using VBA to demonstrate the use of the API.&#160; Where there are actual differences when using other languages with Inventorâ€™s API, Iâ€™ll try and have code that demonstrates those differences and whatâ€™s needed in the various languages to get things to work.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rajeev Lochan
EMAIL: rajeev@ar-cad.com
IP: 59.92.152.201
URL: http://www.smallguru.com
DATE: 09/10/2008 10:01:34 PM
Brian,
Hats off to you for writing such a wonderful Inventor API. You have indeed helped a lot to Inventor Customizers by supporting at Customization Discussion Forum and now by Blogging.

I am looking forward for more Inventor API tutorials from your side.

Thanks & Regards,
Rajeev Lochan
P.S: I have made a humble beginning with Inventor API & Customization and have blogged about it with ScreenCasts at http://www.smallguru.com . It would be great if you could go through them and give feedback
-----
COMMENT:
AUTHOR: Rajeev Lochan
EMAIL: rajeev@ar-cad.com
IP: 59.92.152.201
URL: http://www.smallguru.com
DATE: 09/10/2008 10:08:57 PM
Brian,
It would be great if you could activate "Subscribe by email" for your Blog. Right now, you just have "Subscribe Feeds in a Reader" by FeedBurner.

Thanks & Regards,
Rajeev Lochan
-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Inventor API Fundamentals 001 - Getting Started
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 1
BASENAME: getting-started
CATEGORY: Beginning API
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/08/getting-started.html 
DATE: 08/21/2008 06:00:16 PM
-----
BODY:
<p>I plan on having a series of posts that are intended for those of you that are new to programming and/or Inventor&#39;s programming interface and want to get started writing programs for Inventor.&#160; I&#39;ll also break in on the series occasionally with various other topics that are usually more advanced or that I find interesting at the moment.&#160; This post is the first in the getting started series.&#160; Here is the process I would suggest for anyone wanting to program Inventor.</p>
<ol>
<li>Learn how to use Inventor interactively.&#160; This is more important than you might think.&#160; Most of Inventorâ€™s programming interface is just an alternative way of doing the same things you do interactively through the user-interface.&#160; For example, if you create an extrude feature through the user-interface you see the required input; profile, solid or surface output, operation, extent information, and taper angle.&#160; You supply all of this information through the Extrude dialog and by interacting with the model.&#160; To create an Extrude through the API you call a method that has exactly the same type of input.&#160; The same set of information is being gathered by both the command (user-interface) and the programming interface and then both interfaces end up calling the same internal function to create the actual extrusion.<br /><br />Understanding how Inventor works and the requirements for the various commands is easiest to learn through the user-interface.&#160; Since these same concepts also apply when using the programming interface it will make learning the programming interface much easier. <br /><br />
<li>Choose and learn a programming language.&#160; To effectively program you need to have a basic understanding of the programming language youâ€™re using.&#160; To effectively customize Inventor you DO NOT need to be an expert in that language.&#160; Any language has a lot of features and intricacies that you could spend more time than most of us have learning them.&#160; A basic understanding of the language should be enough.&#160; In my next posting Iâ€™ll discuss several different languages and the pros and cons of each. <br /><br />
<li>Begin learning Inventorâ€™s programming interface.&#160; There are some basic concepts to learn to get started and then you can expand into different functional areas of Inventor.&#160; You donâ€™t need to learn the entire API at once.&#160; Looking at different areas of the Inventor&#39;s API will be a running theme of this blog.&#160; </li>
</ol>
<p>So, for now just keep working with Inventor and weâ€™ll look at programming languages next time.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: Welcome
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: welcome
CATEGORY: Announcements
CATEGORY: Brian

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/2008/08/welcome.html 
DATE: 08/21/2008 05:34:21 PM
-----
BODY:
<p class="MsoNormal" style="MARGIN: 0in 0in 3pt"><span face="Calibri">Welcome to <em>Mod the Machine</em>, a blog for those interested in Autodesk Inventorâ€™s API (Application Programming Interface).<span style="mso-spacerun: yes">&nbsp; </span>First, youâ€™re probably wondering whatâ€™s the deal with the name of this blog.<span style="mso-spacerun: yes">&nbsp; </span>I was recently introduced to gaming by some colleagues here at Autodesk for the Friday evening game of <a href="http://en.wikipedia.org/wiki/Wolfenstein:_Enemy_Territory">Wolfenstein â€“ Enemy Territory</a></span><span face="Calibri">.<span style="mso-spacerun: yes">&nbsp; </span>I learned that itâ€™s possible to download enhancements to the game and these enhancements are called modifications or <a href="http://en.wikipedia.org/wiki/Mod_%28computer_gaming%29"><em>mods</em></a></span><span face="Calibri">.<span style="mso-spacerun: yes">&nbsp; </span>If we apply this gaming terminology to Inventor, youâ€™re writing mods for Inventor when you customize it. The â€œMachineâ€ portion of the name indicates this is a manufacturing related blog, and in this case will mostly be limited to Autodesk Inventor.</span></p>

<p class="MsoNormal" style="MARGIN: 0in 0in 3pt"><span face="Calibri">Now to introduce myself; Iâ€™ve been with Autodesk for 10 years and am part of the Inventor API development team.<span style="mso-spacerun: yes">&nbsp; </span>My primary role is as a product designer which means I specify what Inventorâ€™s programming interface will look like.<span style="mso-spacerun: yes">&nbsp; </span>I share this role with a couple of colleagues (Sanjay Ramaswamy and Venkatesh Thiyagarajan). In addition to product design I also get to work with customers and developers to learn more about their programming requirements and help them in their use of the API.<span style="mso-spacerun: yes">&nbsp; </span>This blog is also a new endeavor in this role.</span></p>

<p class="MsoNormal" style="MARGIN: 0in 0in 3pt"><span face="Calibri">I got started in CAD back in 1977 when my high school drafting class went on a field trip to Brigham Young University to learn more about their CAD related degree.<span style="mso-spacerun: yes">&nbsp; </span>I was hooked with the first demo.<span style="mso-spacerun: yes">&nbsp; </span>Not too much later I was in the program at BYU, which was essentially mechanical engineering with a CAD focus.<span style="mso-spacerun: yes">&nbsp; </span>After graduation I worked at Intergraph where I spent the first 9 years working as an application engineer.<span style="mso-spacerun: yes">&nbsp; </span>All of this time I never thought of myself as a programmer but as a CAD user that liked to write the occasional program.<span style="mso-spacerun: yes">&nbsp; </span>When Intergraph began developing Solid Edge they asked me to design the programming interface.<span style="mso-spacerun: yes">&nbsp; </span>I didnâ€™t feel qualified since I wasnâ€™t a programmer, but they said they didnâ€™t want a programmer to design it but wanted it to have more of an end-user focus.<span style="mso-spacerun: yes">&nbsp; </span>That began my involvement in the CAD API world which continues today.</span></p>

<p class="MsoNormal" style="MARGIN: 0in 0in 3pt"><span face="Calibri">I see CAD as a very powerful and useful tool for various types of design but in many cases the off-the-shelf product isnâ€™t quite what you need.<span style="mso-spacerun: yes">&nbsp; </span>By providing a programming interface, Inventor allows you to customize it to be the â€œperfectâ€ CAD system for you.<span style="mso-spacerun: yes">&nbsp; </span>Much of my focus in this blog will be to those CAD users looking at programming to try and make their job easier.<span style="mso-spacerun: yes">&nbsp; </span></span></p>

<p class="MsoNormal" style="MARGIN: 0in 0in 3pt"><span face="Calibri">If you have ideas for topics please email them to me at </span><a href="mailto:brian.ekins@autodesk.com"><span face="Calibri">brian.ekins@autodesk.com</span></a><span face="Calibri">.<span style="mso-spacerun: yes">&nbsp; </span>Of course you shouldnâ€™t consider this blog or emails as a support mechanism because thereâ€™s no guarantee that Iâ€™ll get to all of the topics, but I would like to hear your ideas and comments.</span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Adam Nagy
AUTHOR EMAIL: adamthenagy@gmail.com
TITLE: About the Author
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: about-the-author

UNIQUE URL: https://modthemachine.typepad.com/my_weblog/about-the-author.html 
DATE: 08/14/2008 07:01:23 PM
-----
BODY:
<p><strong>Brian Ekins</strong><br />Brian has been with Autodesk since 1998.&nbsp; He began working in the CAD industry over 25 years ago and has worked in various positions, including CAD administrator, CAD trainer, applications engineer, CAD API designer, and consultant. Brian was the original designer of the Autodesk InventorÂ® programming interface (API) and is currently working in the Lake Oswego, Oregon office as a product designer for the Autodesk InventorÂ® programming interface.</p>

<p><strong>Disclaimer</strong><br />If you need an official Autodesk company response or a contact for press related activities please contact<a href="http://www.autodesk.com/pressroom"> Autodesk Public Relations.</a></p>

<p>If you need support for our products or APIs, please visit Autodesk's <a href="http://support.autodesk.com/">support website</a>, use our <a href="http://discussion.autodesk.com/">discussion groups</a> or post a question via your reseller or the <a href="http://adn.autodesk.com/">Autodesk Developer Network website</a>, if you're a member.</p>

<p>The contents of this site are my own personal opinions and do not represent my employer's view in any way. In addition, my thoughts and opinions often change, and as a weblog is intended to provide a semi-permanent point-in-time snapshot you should not consider out-of-date posts to reflect my current thoughts and opinions.</p>

<p>The code provided in this blog is provided &quot;as is&quot; and with all faults. I (and my employer) specifically disclaim any implied warranty of merchantability or fitness for a particular use. The operation of the code provided is not warranted to be uninterrupted or error free.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
akn_exclude
-----
--------
