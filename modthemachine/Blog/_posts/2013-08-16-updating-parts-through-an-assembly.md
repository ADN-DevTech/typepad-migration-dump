---
layout: "post"
title: "Updating Parts Through an Assembly"
date: "2013-08-16 00:48:56"
author: "Adam Nagy"
categories:
  - "Assemblies"
  - "Brian"
  - "Inventor"
  - "Parts"
  - "Visual Basic for Applications (VBA)"
original_url: "https://modthemachine.typepad.com/my_weblog/2013/08/updating-parts-through-an-assembly.html "
typepad_basename: "updating-parts-through-an-assembly"
typepad_status: "Publish"
---

<p>Have you written some code to do some type of operation on a part, (i.e. create/update a parameter, create/update an iProperty, etc.), and now would like to perform that update on every part that’s used within a particular assembly?&#0160; I have good news, if you’ve already figured out how to do the work for a single part, doing it for all of the parts in an assembly is a simple step away.&#0160; Let’s look at updating a single part first and the progression of that program to updating a complete assembly.</p>
<p>Below is a typical VBA macro that creates or updates a parameter in a part.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateParameter() <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the active part. <br /></strong></span>&#0160;&#0160;&#0160; Dim part As PartDocument <br />&#0160;&#0160;&#0160; Set part = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the user parameters collection. <br /></strong></span>&#0160;&#0160;&#0160; Dim userParams As UserParameters <br />&#0160;&#0160;&#0160; Set userParams = _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; part.ComponentDefinition.Parameters.UserParameters <br /> <br /><strong><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Check to see if the parameter already exists. <br /></span></strong>&#0160;&#0160;&#0160; Dim param As Parameter <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set param = userParams.Item(&quot;SomeValue&quot;) <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If param Is Nothing Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; The parameter doesn&#39;t exist so add it. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set param = userParams.AddByExpression(&quot;SomeValue&quot;, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;2 inch&quot;, kDefaultDisplayLengthUnits) <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
</div>
<p>Here’s a variation of the macro above converted into a Sub that gets the part document through an argument. The additional code for the argument is highlighted below and the first portion of the code where it got the active document in the sample above has been removed since the document is now passed to it.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateParameter(<span style="background-color: #ffff00;">part As PartDocument</span>) <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the user parameters collection. <br /></strong></span>&#0160;&#0160;&#0160; Dim userParams As UserParameters <br />&#0160;&#0160;&#0160; Set userParams = _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; part.ComponentDefinition.Parameters.UserParameters <br /> <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Check to see if the parameter already exists. <br /></strong></span>&#0160;&#0160;&#0160; Dim param As Parameter <br />&#0160;&#0160;&#0160; On Error Resume Next <br />&#0160;&#0160;&#0160; Set param = userParams.Item(&quot;SomeValue&quot;) <br />&#0160;&#0160;&#0160; On Error GoTo 0 <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; If param Is Nothing Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; The parameter doesn&#39;t exist so add it. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set param = userParams.AddByExpression(&quot;SomeValue&quot;, _&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;2 inch&quot;, kDefaultDisplayLengthUnits) <br />&#0160;&#0160;&#0160; End If <br />End Sub</p>
</div>
<p>Here’s the macro that calls the sub above.&#0160; It gets the active part document and calls the Sub, passing it the part document.</p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdatePart() <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Get the active part. <br /></strong></span>&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Call the function to update the part. <br /></strong></span>&#0160;&#0160;&#0160; Call AddParameter(partDoc) <br />End Sub</p>
</div>
<p>Now we want to perform this same update to every part in the active assembly.&#0160; The code to do that is below.&#0160; It gets the active document, which in this case is an assembly and then uses the AllReferencedDocuments property of the assembly document to get the documents referenced by the assembly.&#0160; It then looks for the parts, to skip any referenced subassemblies, and calls the AddParameter sub just the same as before, passing in the part document.&#0160; This is the same PartDocument object you would get if you opened the part by itself and used the Application.ActiveDocument property.&#0160; The only difference is how you got the PartDocument object which in this case is through the assembly. </p>
<div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black;">
<p>Public Sub UpdateAssembly() <br />&#0160;&#0160;&#0160; Dim asmDoc As AssemblyDocument <br />&#0160;&#0160;&#0160; Set asmDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160; &#39; Iterate through all of the referenced documents at <br />&#0160;&#0160;&#0160; &#39; all levels of the assembly. <br /></strong></span>&#0160;&#0160;&#0160; Dim doc As Document <br />&#0160;&#0160;&#0160; For Each doc In asmDoc.AllReferencedDocuments <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Check for part documents. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If doc.DocumentType = kPartDocumentObject Then <br /><span style="color: #0000ff;"><strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Call the function to update the part. <br /></strong></span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call AddParameter(doc) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; Next <br />End Sub</p>
</div>
<p>The function getting the part document can do anything to the part because it is a full PartDocument object.&#0160; It doesn’t even know how the reference was obtained.&#0160; There are no limitations. </p>
<p>-Brian</p>
