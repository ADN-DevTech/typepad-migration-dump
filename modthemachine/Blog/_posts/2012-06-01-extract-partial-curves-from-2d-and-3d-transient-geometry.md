---
layout: "post"
title: "Extract partial curves from 2d and 3d transient geometry"
date: "2012-06-01 18:20:07"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Parts"
  - "Visual Basic for Applications (VBA)"
  - "Wayne"
original_url: "https://modthemachine.typepad.com/my_weblog/2012/06/extract-partial-curves-from-2d-and-3d-transient-geometry.html "
typepad_basename: "extract-partial-curves-from-2d-and-3d-transient-geometry"
typepad_status: "Publish"
---

<p>Another enhancement in the Inventor 2013 API related to transient geometry allows you to get partial curves from splines. You will find two new methods called ExtractPartial and Split on the BSplineCurve and BSplineCurve2d objects. These new methods make it easier to create new curves based on existing curves. Using ExtractPartial you can extract any portion of the curve as a new transient geometry spline. Using Split will get two transient curves from the original.</p>
<p><br /><strong>New 2013 methods used to extract a partial curve from a Spline</strong></p>
<ul>
<li>BSplineCurve.ExtractPartial</li>
<li>BSplineCurve.Split</li>
<li>BSplineCurve2d.ExtractPartial</li>
<li>BSplineCurve2d.Split</li>
</ul>
<p><strong>VBA Example: </strong></p>
<p>Keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production.</p>
<p>Note: This example is only using ExtractPartial. (Not Split)</p>
<p>Before running this procedure create a Sketch with a spline. When you run this example it will prompt you to select a “2d&#0160; spline”. If you select a spline the selected entity will be a SketchSpline and the BSplineCurve2d is returned from the Geometry property of that object. <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebff553e970c-pi"><img alt="image" border="0" height="380" src="/assets/image_255906.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="451" /></a></p>
<p>&#0160;</p>
<p>Remember that these methods are creating transient geometry so it is not affecting the real Inventor geometry. This example uses that transient geometry to create real Inventor geometry (3 splines) using Sketch.SketchFixedSplines.Add(). The code deletes the original spline. After running the procedure notice the three new splines:</p>
<p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ebff5583970c-pi"><img alt="image" border="0" height="424" src="/assets/image_781674.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="462" /></a></p>
<p><strong>VBA Code:</strong></p>
<p><span style="color: #0000ff;">&#39; Demonstrates the ability to extract partial <br />&#39; curves from a transient geometry curve.&#0160; This <br />&#39; sample has you select an existing sketch <br />&#39; spline and extracts three curves from the curve. <br />&#39; It then creates real curves using the extracted <br />&#39; curves and deletes the original sketch curve. <br /></span>Public Sub ExtractPartialCurves2D() <br />&#0160;&#0160;&#0160; Dim partDoc As PartDocument <br />&#0160;&#0160;&#0160; Set partDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim spline As Object <br />&#0160;&#0160;&#0160; Set spline = ThisApplication.CommandManager _ <br />&#0160;&#0160;&#0160; .Pick(kSketchCurveSplineFilter, &quot;Select 2d spline&quot;) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #0000ff;">&#39; Get the spline geometry from the entity. <br /></span>&#0160;&#0160;&#0160; Dim splineCurve As BSplineCurve2d <br />&#0160;&#0160;&#0160; Set splineCurve = spline.Geometry <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Get the parameter bounds of the curve. <br /></span>&#0160;&#0160;&#0160; Dim startParam As Double <br />&#0160;&#0160;&#0160; Dim endParam As Double <br />&#0160;&#0160;&#0160; Call splineCurve.Evaluator.GetParamExtents _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startParam, endParam) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Extract three curves where they are in <br />&#0160;&#0160;&#0160; &#39; thirds of the original <br />&#0160;&#0160;&#0160; &#39; relative to the curves parameter space. <br /></span>&#0160;&#0160;&#0160; Dim curves(2) As BSplineCurve2d <br />&#0160;&#0160;&#0160; Set curves(0) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (startParam, (startParam + endParam) / 3) <br />&#0160;&#0160;&#0160; Set curves(1) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ((startParam + endParam) / 3, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ((startParam + endParam) / 3) * 2) <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Set curves(2) = splineCurve.ExtractPartial _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (((startParam + endParam) / 3) * 2, _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; endParam) <br />&#0160;&#0160;&#0160; <br /><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Create new sketch curves using <br />&#0160;&#0160;&#0160; &#39; the extracted splines. <br /></span>&#0160;&#0160;&#0160; Dim splineSketch As sketch <br />&#0160;&#0160;&#0160; Set splineSketch = spline.Parent <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(0)) <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(1)) <br />&#0160;&#0160;&#0160; Call splineSketch.SketchFixedSplines. _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Add(curves(2))</p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160; &#39; Delete the original curve. <br /></span>&#0160;&#0160;&#0160; spline.Delete <br />End Sub</p>
<p>-Wayne</p>
