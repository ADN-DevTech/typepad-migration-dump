---
layout: "post"
title: "iProperties and Dates"
date: "2010-04-15 16:45:11"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/04/iproperties-and-dates.html "
typepad_basename: "iproperties-and-dates"
typepad_status: "Publish"
---

<p><strong>&#160; <br /></strong>The <a href="http://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties.html">previous post on working with custom iProperties</a> shows how to create iProperties of various types, including dates.&#160; However, dates have one unique behavior, as shown below.&#160; There is a check box next to each date property, (circled in the picture below), that the user can check or uncheck to indicate if they want to set a date or not.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe50401970c-pi"><img title="DateiProperty" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="288" alt="DateiProperty" src="/assets/image_93478.jpg" width="404" border="0" /></a> </p>  <p>A date iProperty will always have a value, but there is one date that is considered the zero date.&#160; If you set the iProperty value to this date it will have the side-effect of removing the check from the box.&#160; The date is Jan. 1, 1601.&#160; The code below demonstrates creating two new custom iProperties.&#160; One will be set to the zero date and the other will be set to the current date.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub DateProperties()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the custom property set.          <br /></strong></font>&#160;&#160;&#160; Dim customPropSet As PropertySet       <br />&#160;&#160;&#160; Set customPropSet = partDoc.PropertySets.Item( _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor User Defined Properties&quot;) </p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create the properties.          <br /></strong></font>&#160;&#160;&#160; Dim dateValue As Date       <br />&#160;&#160;&#160; dateValue = #1/1/1601#       <br />&#160;&#160;&#160; Dim sample1 As Property       <br />&#160;&#160;&#160; Set sample1 = customPropSet.Add(dateValue, &quot;Zero Date&quot;)       <br />      <br />&#160;&#160;&#160; dateValue = Now       <br />&#160;&#160;&#160; Dim sample2 As Property       <br />&#160;&#160;&#160; Set sample2 = customPropSet.Add(dateValue, &quot;Now Date&quot;)       <br />End Sub</p> </div>  <p>Here’s the result after running the program.&#160; Notice that the check box for the zero date property is unchecked.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe50433970c-pi"><img title="ZeroDate" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="277" alt="ZeroDate" src="/assets/image_745829.jpg" width="404" border="0" /></a> </p>  <p>This is also important to understand if you ever need to read the value of a date property.&#160; In the example above, the date for the Zero Date iProperty will be Jan. 1, 1601, but you should handle this date as a special case and treat it as though the date hasn’t been set.</p>
