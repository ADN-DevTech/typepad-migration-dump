---
layout: "post"
title: "Objects in the API"
date: "2012-04-17 03:03:23"
author: "Adam Nagy"
categories:
  - "Brian"
  - "Getting Started Tutorial"
original_url: "https://modthemachine.typepad.com/my_weblog/2012/04/objects-in-the-api.html "
typepad_basename: "objects-in-the-api"
typepad_status: "Publish"
---

<p>Here’s another post in the getting series where we’re looking at the creation of a new sketch command to create slot shapes.&#160; I’ll be adding each of the posts in this series to the <a href="http://modthemachine.typepad.com/my_weblog/getting-started-tutorial/">Getting Started Tutorial</a> category.</p>  <p>This post is more discussion than coding so you will have some background to follow what’s coming next.&#160; First, I want to go back to the previous program and look at that code in a bit more detail.&#160; The code below is from the previous post with the error handling removed and one of the lines has been broken into two to make it easier to follow what’s happening</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><font color="#000000">1.</font><strong>&#160; ' Connect to a running instance of Inventor.        <br /></strong></font>2.&#160; Dim invApp As Inventor.Application     <br />3.&#160; invApp = System.Runtime.InteropServices.Marshal.GetActiveObject _     <br />4.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;Inventor.Application&quot;)     <br /><font color="#0000ff"><font color="#000000">5.</font><strong>&#160; ' Get the Documents collection.        <br /></strong></font>6.&#160; Dim docs As Inventor.Documents     <br />7.&#160; docs = invApp.Documents     <br />8.     <br /><font color="#0000ff"><font color="#000000">9.&#160; </font><strong>' Create a new part document.        <br /></strong></font>10. Dim partDoc As Inventor.PartDocument     <br />11. partDoc = docs.Add(Inventor.DocumentTypeEnum.kPartDocumentObject)     <br /></p> </font>  <p>Line 2 declares a variable to be of type Inventor.Application.&#160; The “Inventor” portion of the declaration is specifying the library and the “Application” portion is the name of the object.&#160; The Inventor API is exposed as objects.&#160; You’re already used to this concept since that’s also how Visual Basic works.&#160; For example, when you place a button control on a form, that results in the creation of a button object that you can access in your program.&#160; The button has properties that you can read and write to manipulate the button.&#160; It also has methods you can call and it has events that notify you when certain things happen to the button, like when it is clicked.&#160; </p>  <p>Inventor objects have the same concept but instead of representing something on a form, they represent something within Inventor.&#160; For example, for every extrude feature in a part there is an ExtrudeFeature object that you can access and use in a program.&#160; Inventor is a large and fairly complicated application and the API reflects that.&#160; Inventor 2013 has 1365 objects which have a total of 20,462 properties, methods, and events.&#160; Don’t let these big numbers discourage you though because you don’t need to understand all of it be able to use it.</p>  <p>These objects are accessed through something known as the <em>object model or object hierarchy</em>.&#160; A useful tool in working with the API is the object model chart, which is shown below.&#160; You can download a printable pdf version of the chart <a href="http://modthemachine.typepad.com/files/Inventor2013Model.pdf">here</a>.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5127970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="FullObjectModel" border="0" alt="FullObjectModel" src="/assets/image_845474.jpg" width="479" height="311" /></a></p>  <p>&#160;</p>  <p>Below is a snapshot of the upper-left corner of the chart that includes the few objects that are used in the small program discussed here.&#160; You can see in the chart that the top-level object is the <strong>Application</strong> object.&#160; This object represents the Inventor application and has functionality that lets you manipulate the entire application; things like resizing the main window and accessing application options.&#160; However, the most important thing the Application object does is support properties that return other objects.&#160; This is how you gain access to the other objects in the hierarchy.&#160; For example, the Application object supports the Documents property which returns the Documents object.&#160; This is illustrated in line 7 in the code sample above and that relationship can be seen in the chart below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676539b40b970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="ObjectModelDocs" border="0" alt="ObjectModelDocs" src="/assets/image_481153.jpg" width="477" height="148" /></a></p>  <p>&#160;</p>  <p>You can also view all of the objects and their associated methods, properties, and events from within Visual Basic using the Object Browser.&#160; To access the Object Browser in Visual Basic Express 2010, press F2. The Object Browser is shown below, with the Inventor library selected.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5213970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="VB2010ObjectBrowser" border="0" alt="VB2010ObjectBrowser" src="/assets/image_745778.jpg" width="479" height="248" /></a></p>  <p>Below is the Object Browser with the Documents object selected in the list on the left and the Item property selected on the right.&#160; The Object Browser provides a convenient way to see the objects and what functionality they support.&#160; You can see in the picture below that the Item property is read-only and has a single argument called Index which is an Integer.&#160; You can also see that it returns an Inventor.Document object. (You can ignore the _ character in front of Document.&#160; It has something to do with how the API was implemented internally and I don’t understand it either. <font size="1"><img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/assets/image_421827.jpg" width="15" height="15" /></font>)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401676539b529970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="DocumentsCollection" border="0" alt="DocumentsCollection" src="/assets/image_193229.jpg" width="479" height="248" /></a></p>  <p>&#160;</p>  <p style="line-height: 140%; background: #eebb00; color: black"><strong>Tip:</strong> You can expose additional capabilities in the Visual Basic Express 2010 interface by changing your settings to “Expert Settings” in the “Tools” menu, as shown below.&#160; After doing this the “Object Browser” command will be displayed in the “View” menu.     <br />    <br /><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168ea3b5297970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="ExpertSettings" border="0" alt="ExpertSettings" src="/assets/image_135387.jpg" width="404" height="141" /></a>     <br /></p>  <p>&#160;</p>  <p>Line 6, in the sample above, declares a variable to be of type Documents.&#160; The Documents object is a special type of object known as a <em>collection</em> object.&#160; Collection objects are used extensively throughout the API and are an important concept to understand.&#160;&#160; </p>  <p><strong>Collection objects</strong> are utility objects used in the API.&#160; They don’t represent specific objects within Inventor but instead provide access to a group of related objects and in many cases also provide the ability to create new objects.&#160; The Documents object illustrates both of these.</p>  <p>The Documents object provides access to all of the documents that are currently open in Inventor.&#160; <u>All</u> collection objects support the properties Count and Item.&#160; The Count property tells you how many items are in the collection and the Item property lets you access the items within the collection.&#160; If you add the following to the end of the previous program it will display a message box telling you how many documents are currently open.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Display the number of documents.</font></strong>     <br /><font style="background-color: #f79646"></font>MessageBox.Show(&quot;There are &quot; &amp; docs.Count &amp; &quot; documents open.&quot;)&#160; <br /></p> </font>  <p>You use the Item property of a collection to get a specific object from the collection.&#160; This is somewhat similar to an array but the first item has in index of 1.&#160; Some collections will also let you specify the name of the object you want.&#160; The code below uses both the Count and the Item properties of the Documents object to iterate over all of the open documents and display the name of each one in the output window.&#160; (You may need to turn on the display of the output window from the menu “View –&gt; Other Windows –&gt; Output” or&#160; “Ctrl + Alt + O”.)</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><font color="#000000"><strong><font color="#0000ff">' Iterate over the open documents</font></strong>         <br />For i As Integer = 1 To docs.Count         <br />&#160;&#160;&#160; Debug.Print(&quot;Doc Name: &quot; &amp; docs.Item(i).DisplayName)         <br />Next</font></font></p>  <p>If you’re iterating through a collection a more efficient technique for is to use the For Next statement.&#160; Code using a For Each vs. the For To will typically run faster and is easier to read.&#160; This is demonstrated below.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><font color="#0000ff"><strong>' Iterate over the open documents        <br /></strong></font><font color="#000000">For Each doc As Inventor.Document In docs      <br />&#160;&#160;&#160; Debug.Print(&quot;Doc: &quot; &amp; doc.DisplayName)       <br />Next</font></p>  <p>The Item property of the Documents collection does not support indexing by name.&#160; You can determine which Item properties do support this by looking at the description of the property in the API help.&#160; The Documents object supports a separate property for named lookup called ItemByName where instead of providing the index number you supply the filename of the document.&#160; If you specify an out of range number or a name that doesn’t exist the call will fail.</p>  <p><strong>Adding objects</strong> to a collection is done by using the Add methods of the collection.&#160; This was demonstrated in the original program above in line 11 where the Add method is called.&#160; Some collections won’t have any add methods and others will have several.&#160; The arguments to the add methods will also vary greatly depending on what is being created.&#160; It’s takes much different information to create a new document versus creating a new extrude feature.</p>  <p>We’ll look at practical applications of collection objects and using them to create new objects in the upcoming posts.&#160; In the next post I’ll talk about creating sketches.</p>  <p>Another useful tool to look at Inventor’s objects is VBA’s debugger.&#160; I’ve described this in a <a href="http://modthemachine.typepad.com/my_weblog/2008/10/program-prototyping.html">previous post on program prototyping</a>.</p>
