---
layout: "post"
title: "Creating Geometric Constraints in a Sketch"
date: "2012-05-12 00:22:21"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2012/05/creating-geometric-constraints-in-a-sketch.html "
typepad_basename: "creating-geometric-constraints-in-a-sketch"
typepad_status: "Publish"
---

<p>In the <a href="http://modthemachine.typepad.com/my_weblog/2012/04/drawing-in-a-sketch.html">previous post</a> in this series I discussed creating sketch geometry.&#160; The last post ended by showing how to create lines and arcs that define the shape of a slot.&#160; It also illustrated that the lines and arcs didn’t behave quite like expected because of missing constraints.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340167666f844e970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="ModifiedSlotResult" border="0" alt="ModifiedSlotResult" src="/assets/image_57590.jpg" width="346" height="167" /></a></p>  <p>In this post we’ll look at how to create geometric sketch constraints using the API. There are two types of sketch constraints; geometric and dimension.&#160; I’ll focus on geometric constraints for this post.</p>  <p>Geometric sketch constraints are used extensively within Inventor, probably in more ways than you would initially think.&#160; Below is a portion of the sketch ribbon, where I’ve highlighted the commands you typically think of as the geometric constraint commands.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb029970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SketchConstraintCommands" border="0" alt="SketchConstraintCommands" src="/assets/image_424803.jpg" width="479" height="94" /></a></p>  <p>&#160;</p>  <p>These constraints define the behavior of sketch geometry.&#160; There are two types of geometric constraints; those that act on a single geometric entity and those that define some type of relationship between two geometric entities.&#160; For example, the Fix (Ground), Horizontal, and Vertical constraints act on a single entity, whereas all of the others control two entities.</p>  <p>All of these are quite easy to use through the API.&#160; The diagram below shows the object model for 2d sketch geometric constraints.&#160; You’ve already learned from the previous posts how to access a sketch through the API.&#160; The SketchLines and SketchArcs collections on the Sketch were used to drawing the slot geometry.&#160; Now you’ll use the GeometricConstraints collection to add the needed geometric constraints.&#160; Unlike the sketch geometry where there was a unique collection for each type of geometry, for geometric constraints there is a single collection for all of the constraint types.&#160; The GeometricConstraints collections supports many Add methods to allow the creation of each of the types of constraints.&#160; It’s also through this collection where you can access existing constraints.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb032970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="GeomConstraintsObjectModel" border="0" alt="GeomConstraintsObjectModel" src="/assets/image_146027.jpg" width="475" height="323" /></a></p>  <p>Below is the program from the last post that creates the slot shape.&#160; The new portion of code at the bottom, highlighted in yellow, creates the constraints.&#160; You can see that it uses the variables that reference geometry created earlier in the program.</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 8pt"><strong><font color="#0000ff">' Get a reference to the SketchPoints collection.</font></strong>     <br />Dim points As Inventor.SketchPoints = sketch.SketchPoints     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchLines collection.        <br /></strong></font>Dim lines As Inventor.SketchLines = sketch.SketchLines     <br />    <br /><font color="#0000ff"><strong>' Get a reference to the SketchArcs collection.</strong></font>     <br />Dim arcs As Inventor.SketchArcs = sketch.SketchArcs     <br />    <br /><font color="#0000ff"><strong>' Create the sketch points.</strong></font>     <br />Dim pointArray(5) As Inventor.SketchPoint     <br />pointArray(0) = points.Add(tg.CreatePoint2d(0, 1), False)     <br />pointArray(1) = points.Add(tg.CreatePoint2d(0, 0), False)     <br />pointArray(2) = points.Add(tg.CreatePoint2d(0, -1), False)     <br />pointArray(3) = points.Add(tg.CreatePoint2d(4, -1), False)     <br />pointArray(4) = points.Add(tg.CreatePoint2d(4, 0), False)     <br />pointArray(5) = points.Add(tg.CreatePoint2d(4, 1), False)     <br />    <br /><font color="#0000ff"><strong>' Draw the geometry.</strong></font>     <br />Dim arc1 As Inventor.SketchArc     <br />arc1 = arcs.AddByCenterStartEndPoint(pointArray(1), pointArray(0), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(2))     <br />    <br />Dim line1 As Inventor.SketchLine     <br />line1 = lines.AddByTwoPoints(pointArray(2), pointArray(3))     <br />    <br />Dim arc2 As Inventor.SketchArc     <br />arc2 = arcs.AddByCenterStartEndPoint(pointArray(4), pointArray(3), _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointArray(5))     <br />    <br />Dim line2 As Inventor.SketchLine     <br />line2 = lines.AddByTwoPoints(pointArray(5), pointArray(0))    <br /><span style="background: #eeee00">     <br /><font color="#0000ff"><strong>' Get a reference to the GeometricConstraints collection.         <br /></strong></font>Dim geomConstraints As Inventor.GeometricConstraints       <br />geomConstraints = sketch.GeometricConstraints       <br />      <br /><font color="#0000ff"><strong>' Create the four tangent constraints.</strong></font>       <br />geomConstraints.AddTangent(arc1, line1)       <br />geomConstraints.AddTangent(line1, arc2)       <br />geomConstraints.AddTangent(arc2, line2)       <br />geomConstraints.AddTangent(line2, arc1)       <br />      <br /><font color="#0000ff"><strong>' Create a parallel constraint.</strong></font>       <br />geomConstraints.AddParallel(line1, line2)       <br />      <br /><font color="#0000ff"><strong>' Create a horizontal constraint.</strong></font>       <br />geomConstraints.AddHorizontal(line1)       <br /></span></p>  <p>Creating any of the other types of constraints is similar to the above with the difference being the add method that’s used. The API help is a great resource to help in understanding the various add methods of the GeometricConstraints object.</p>  <p>I mentioned earlier that geometric constraints are used by Inventor in more ways than most people think.&#160; In addition to the typical geometric constraints as discussed above, there are several other geometry creation commands that result in the creation of geometric constraints.&#160; For example, when you create an offset, new geometry is created and Inventor creates constraints between the original geometry and the new geometry so the new geometry behaves as an offset.&#160; You can delete the constraint to remove the offset behavior.&#160; The picture below shows a simple sketch.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb048970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints1" border="0" alt="GeomConstraints1" src="/assets/image_986403.jpg" width="475" height="293" /></a></p>  <p>Below is the same sketch after offsetting the outside profile and creating a rectangular pattern of the circle.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340163057bb054970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints2" border="0" alt="GeomConstraints2" src="/assets/image_743870.jpg" width="475" height="294" /></a></p>  <p>Finally, the picture below shows the constraint symbols turned on so you can see all of the constraints that were created automatically as a result of the previous operations.&#160; The API provides query access to all of these constraints through the GeometricConstraints collection.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340168eb716546970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="GeomConstraints3" border="0" alt="GeomConstraints3" src="/assets/image_348998.jpg" width="475" height="300" /></a></p>
