---
layout: "post"
title: "iProperties Without Inventor (Apprentice)"
date: "2010-03-09 21:47:22"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/03/iproperties-without-inventor-apprentice.html "
typepad_basename: "iproperties-without-inventor-apprentice"
typepad_status: "Publish"
---

<p>Continuing with the iProperty theme of some recent <a href="http://modthemachine.typepad.com/my_weblog/iproperties/">posts</a> I want to talk about the ability to work with iProperties without using Inventor. You can do this using a component known as <em>Apprentice</em>. Apprentice doesn’t have a user-interface but is a component use can only use through programming. Apprentice is installed as part of Inventor and is also installed as part of Inventor View (<a href="http://www.autodesk.com/inventorview">www.autodesk.com/inventorview</a>).&#160; This means if Inventor or Inventor View is installed on a machine you’ll have access to the Apprentice component and any Apprentice dependent program will work.&#160; The fact that it’s available with Inventor View is interesting since Inventor View is free.</p>  <p><strong>What is Apprentice?</strong>     <br />Apprentice is a programming component that provides access to Inventor files.&#160; Using Apprentice you can open Inventor files, query information from them, and in a few cases, edit data.&#160; Apprentice supports a small subset of the functionality that Inventor supports and is primarily read-only with just a few exceptions.&#160; The primary things it provides access to are:</p>  <ul>   <li>Geometry of solids and surfaces (B-Rep) </li>    <li>Assembly structure </li>    <li>File references </li>    <li>Bill Of Material </li>    <li>Printing </li>    <li>Attributes </li>    <li>iProperties </li> </ul>  <p>You’ll notice that there are a lot of things missing.&#160; Apprentice is designed to be smaller and faster than Inventor and achieves this by providing having less code and operating on smaller portions of a document.&#160; Even things that are exposed in Apprentice will often have limitations that aren’t present in Inventor.&#160; For example, let’s say you have an extrude feature that you’ve added an attribute to in Inventor.&#160; Using Apprentice, you can open that part and you can query for all attributes and get the attribute set associated with the feature.&#160; However when you try and get the feature from the attribute set it’s not available because Apprentice doesn’t support features.&#160; Apprentice is good at what it does but does have limitations you need to be aware of before attempting to use it in a project.</p>  <p><strong>Using Apprentice</strong>     <br />Apprentice uses much of the same code and components as Inventor.&#160; Because of this there are conflicts if you try running both of them within the same process.&#160; Remember that Apprentice always runs within the process of another program.</p>  <p>This means:</p>  <ul>   <li>You can’t use Apprentice with Inventor’s VBA. </li>    <li>You can’t use Apprentice in an Add-In.</li> </ul>  <p>Using VBA within another application, for example Excel, is ok since Apprentice will be running within the Excel process and not Inventor’s process.&#160; Another common use of Apprentice is within standalone exe programs where Apprentice will be running within the exe process.&#160; The example that part of this post is a standalone exe.</p>  <p>Another limitation of Apprentice is that it can’t migrate files.&#160; Migration occurs when you open a file that is older than the current version of Inventor.&#160; For example, if I have an Inventor 2009 file on disk and open it with Inventor 2010 the data is migrated to the current version of Inventor.&#160; Inventor is smart and only migrates what’s necessary based on what you’re currently doing with the file.&#160; However, if you save the file, the entire file must be migrated to the current version before it is saved.&#160; Apprentice can open and query older files but nothing can be changed and saved because that would require migration.&#160; You can use the NeedsMigrating property to determine if a file can be edited and saved.&#160; This is demonstrated in the sample at the bottom of this post.</p>  <p><strong>Connecting to Apprentice</strong>     <br />Here’s an example of how to use Apprentice within a VB Express Windows forms application.&#160; To enable the use of Apprentice in your program you need to add a reference to the Inventor Object Library.&#160; The Inventor Object Library is used for both Inventor and Apprentice even though Apprentice only supports a small subset of the entire library.&#160; You can add the reference using the <strong>Project |</strong> <strong>Add Reference…</strong> command.&#160; In the example below I’ve select the version 14.0.0 (Inventor 2010) interop.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f82b0a9970c-pi"><img title="AddReference" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="375" alt="AddReference" src="/assets/image_180353.jpg" width="471" border="0" /></a> </p>  <p></p>  <p>Below is the minimum code needed to load Apprentice.&#160; This declares and creates a new ApprenticeServerComponent object.&#160; The ApprenticeServerComponent object is similar to the Inventor Application object.&#160; It is the top-level object for Apprentice.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim apprentice As New Inventor.ApprenticeServerComponent </p> </div>  <p>It’s also common to declare the variable and then create apprentice separately, like shown below.&#160; I do this in the sample program where the variable is declared as a member variable so I can reuse it.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim apprentice As Inventor.ApprenticeServerComponent      <br />apprentice = New Inventor.ApprenticeServerComponent </p> </div>  <p>When you create the ApprenticeServerComponent object the Apprentice dll’s are loaded into your process and you can access the apprentice functionality through the properties and methods of the object.</p>  <p>Once you have an instance of the ApprenticeServerComponent, the next step is to open an Inventor document.&#160; You do this using the Open method of the ApprenticeServerComponent object, as shown below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Open a file using Apprentice.         <br /></strong></font>Dim apprenticeDoc As Inventor.ApprenticeServerDocument       <br />apprenticeDoc = apprentice.Open(Filename)</p> </div>  <p>Apprentice supports the ApprenticeServerDocument and ApprenticeServerDrawingDocument types.&#160; The ApprenticeServerDocument object can represent all document types.&#160; the ApprenticeServerDrawingDocument can be used to access some drawing specific functionality.</p>  <p><strong>Using iProperties With Apprentice</strong>     <br />Once you have the document, accessing iProperties is the same in Apprentice as it is in Inventor.&#160; The example below gets the summary information property set and changes the value of the “Company” property.&#160; The previous <a href="http://modthemachine.typepad.com/my_weblog/iproperties/">posts</a> on using the API with iProperties also apply to Apprentice.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Get the &quot;Summary Information&quot; property set.&#160; <br /></strong></font>Dim summaryPropSet As Inventor.PropertySet&#160; <br />summaryPropSet = apprenticeDoc.PropertySets.Item( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Inventor Document Summary Information&quot;)&#160; <br />      <br /><font color="#0000ff"><strong>' Get the &quot;Company&quot; property.&#160; <br /></strong></font>Dim companyProp As Inventor.Property&#160; <br />companyProp = summaryPropSet.Item(&quot;Company&quot;) </p>    <p><font color="#0000ff"><strong>' Change the value of the iProperty.&#160; <br /></strong></font>companyProp.Value = &quot;Widgets R Us&quot; </p> </div>  <p><strong>Saving Changes With Apprentice      <br /></strong>When you use Inventor to change iProperties, you save the changes by saving the document.&#160; In Apprentice there’s a much more efficient way of saving iProperty changes.&#160; Instead of saving the entire document it’s possible to just save the iProperties.&#160; You do this using the FlushToFile method of the PropertySet object, as illustrated below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>' Save the iProperty changes.</strong></font>&#160; <br />apprenticeDoc.PropertySets.FlushToFile()</div>  <p><strong>Example Program     <br /></strong>Here’s an <a href="http://modthemachine.typepad.com/files/ApprenticeSample.zip">example program</a> written using Visual Basic 2008 Express.&#160; It demonstrates the functionality discussed above.&#160; It’s a simple program that gets all of the part files in a specified directory, changes an iProperty value and saves it.&#160; Even though it’s simple it does demonstrates the functionality needed to access iProperties using Apprentice.&#160; You’ll need to modify it to fit your specific requirements.</p>
