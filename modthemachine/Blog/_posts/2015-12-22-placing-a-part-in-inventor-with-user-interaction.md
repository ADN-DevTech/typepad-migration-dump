---
layout: "post"
title: "Placing a Part in Inventor with User Interaction"
date: "2015-12-22 18:34:55"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2015/12/placing-a-part-in-inventor-with-user-interaction.html "
typepad_basename: "placing-a-part-in-inventor-with-user-interaction"
typepad_status: "Publish"
---

<p>The various add methods of the ComponentOccurrences objects let you place new parts or assemblies into an assembly, but in all cases you have to specify the position as part of the placement. There are times when you don’t know where it should be positioned and want to give the user the ability to position it. This can be done using a little known capability of the API.</p>  <p>The <strong>Place Component</strong> command has a special API behavior.&#160; When the command is invoked, it typically displays the dialog to allow you to choose which part or assembly to place and then puts you in a mode where that part or assembly is attached to the cursor and each click creates a new occurrence.&#160; The special behavior of the command is that it can bypass the dialog and go directly to the placement. It’s possible through the API to post the filename to a queue and when the command is executed it checks to see if there is a filename in the queue and if there is it uses it and skips the dialog.</p>  <p>The VBA sample below demonstrates this. It uses the PostPrivateEvent of the CommandManager object to post the filename to the private event queue. It then executes the <strong>Place Component</strong> command.&#160; Calling Execute on a control definition is exactly the same as executing the command in the user interface. In fact if you comment out the last line in the program below and run it and then run the <strong>Place Component</strong> command in the user interface it will still skip the dialog step of the command. Once the filename is read from the queue, the queue is cleared so the next time the <strong>Place Component</strong> command is run it will run in the normal way and display the file dialog.</p>  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub PlacePartInteractive()&#160; <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Define the filename to place.         <br /></font></strong>&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = &quot;C:\Temp\PartTest_2016.ipt&quot;&#160; <br />      <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Post the filename to the private event queue.         <br /></font></strong>&#160;&#160;&#160; Dim cmdMgr As CommandManager       <br />&#160;&#160;&#160; Set cmdMgr = ThisApplication.CommandManager       <br />&#160;&#160;&#160; Call cmdMgr.PostPrivateEvent(kFileNameEvent, filename)      <br />      <br /><strong><font color="#0000ff">&#160;&#160;&#160; ' Execute the &quot;Place Component&quot; command.</font></strong>      <br />&#160;&#160;&#160; cmdMgr.ControlDefinitions.Item(&quot;AssemblyPlaceComponentCmd&quot;).Execute       <br />End Sub</p> </div>  <br />  <p>There is a downside to using this technique. With the typical Add methods, the occurrence is created and then passed back to your program where you now have control and can continue whatever processing you need to do. By executing a standard command you've essentially turned control of Inventor back to the user. If you're finished with whatever you need to do then this works great because you're done and don't need to get back control. Otherwise it gets more complicated because you'll also need to watch events to catch when new occurrences are placed and do whatever processing might be needed. I'll save that discussion for another time.    <br />    <br />-Brian</p>
