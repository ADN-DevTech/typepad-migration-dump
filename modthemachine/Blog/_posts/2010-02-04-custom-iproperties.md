---
layout: "post"
title: "Custom iProperties"
date: "2010-02-04 00:10:05"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/02/custom-iproperties.html "
typepad_basename: "custom-iproperties"
typepad_status: "Publish"
---

<P>Following up from the <A href="http://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html">previous post about iProperties</A>, I want to discuss how to work with custom iProperties.&nbsp; In the user-interface you access custom properties using the “Custom” tab of the iProperties dialog, as shown below.</P>
<P><A href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fd5970b-pi"><img title=CustomiProperties style="BORDER-TOP-WIDTH: 0px; DISPLAY: block; BORDER-LEFT-WIDTH: 0px; FLOAT: none; BORDER-BOTTOM-WIDTH: 0px; MARGIN-LEFT: auto; MARGIN-RIGHT: auto; BORDER-RIGHT-WIDTH: 0px" height=473 alt=CustomiProperties src="/assets/image_244405.jpg" width=456 border=0 /></A>&nbsp;</P>
<P>Custom iProperties are accessed the same as other iProperties.&nbsp; It’s just that there is a specific property set that contains them.&nbsp; The property set is called:</P>
<blockquote>
<P>“Inventor User Defined Properties”</p>

</blockquote>
<P><font size=3><strong><font size=2>Getting iProperty Values</font> <br></strong></font>The name of the property is the name that was assigned when it was created.&nbsp; You use the name to access a specific property.&nbsp; The sample VBA code below illustrates getting the custom property named “Sample1” and displaying its value.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P>Public Sub GetCustomiProperty() <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim doc As Document <br>&nbsp;&nbsp;&nbsp; Set doc = ThisApplication.ActiveDocument <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = doc.PropertySets.Item( _ <br>							&nbsp;&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the property named "Sample1". <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customProp As Property <br>&nbsp;&nbsp;&nbsp; Set customProp = customPropSet.Item("Sample1") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Display the value of the iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; MsgBox "Sample1 = " &amp; customProp.Value <br>End Sub</P></DIV>
<P>This results in displaying the dialog shown below.</P>
<P><A href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a85a3fe3970b-pi"><img title=CustomiPropertyValue style="BORDER-TOP-WIDTH: 0px; DISPLAY: inline; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=104 alt=CustomiPropertyValue src="/assets/image_136744.jpg" width=184 border=0 /></A> </P>
<P><strong>Setting iProperty Values</strong> <br>In the example above the Value property of the Property object is used to get the current value of the iProperty.&nbsp; You can also set the value of the iProperty using the Value property as demonstrated in the code below.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Set the value of the property.</strong></font> <br>&nbsp;&nbsp;&nbsp; customProp.Value = "Here's a new value." </P></DIV>
<P>When setting the value of an iProperty you are also controlling the property type (Text, Number, Date, or Yes/No).&nbsp; This is implicitly defined by the type of the value you assign to the property.&nbsp; If the value is a String then the property will be a Text property type.&nbsp; If you assign any number type (Integer, Long, Double, etc.) then the result will be a Number property type.&nbsp; If you assign a Date type then the result will be a Date property type.&nbsp; Finally, if you assign a Boolean type then the result will be a Yes/No property type.&nbsp; This also applies when creating iProperties and is demonstrated in the section below.</P>
<P><strong>Creating Custom iProperties</strong> <br>Another difference between custom iProperties and the standard iProperties is that you can create new ones and delete existing ones.&nbsp; For the standard iProperties you’re limited to only getting and setting their values.&nbsp; To create a new iProperty you use the Add method of the PropertySet object.&nbsp; It has three arguments, the value, the name, and the ID.&nbsp; Besides its name, the ID is another way to identify a specific iProperty.&nbsp; This argument is optional and Inventor will automatically assign an ID if you don’t provide one, which is what I always do.</P>
<P>The sample VBA code below demonstrates creating several new iProperties.&nbsp; The type of iProperty created (Text, Number, Date, or Yes/No) is implicitly defined by the type of the value you supply.</P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">
<P>Public Sub CreateCustomiProperty() <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim doc As Document <br>&nbsp;&nbsp;&nbsp; Set doc = ThisApplication.ActiveDocument <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = doc.PropertySets.Item( _ <br>							&nbsp;&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new text property.&nbsp; <br></strong></font>&nbsp;&nbsp;&nbsp; Dim textValue As String <br>&nbsp;&nbsp;&nbsp; textValue = "Here's some text." <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(textValue, "TextProp") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new number property. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim numberValue As Double <br>&nbsp;&nbsp;&nbsp; numberValue = 3.14159265358979 <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(numberValue, "Pi") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new date property. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim dateValue As Date <br>&nbsp;&nbsp;&nbsp; dateValue = Now <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(dateValue, "Right Now") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Create a new boolean property. <br></strong></font>&nbsp;&nbsp;&nbsp; yesNoValue As Boolean <br>&nbsp;&nbsp;&nbsp; yesNoValue = True <br>&nbsp;&nbsp;&nbsp; Call customPropSet.Add(yesNoValue, "Chocolate is good") <br>End Sub</P></DIV>
<P><strong>Creating or Updating Custom iProperties</strong> <br>If you run the above sample code twice, it will fail the second time.&nbsp; That’s because it’s attempting to create iProperties with names that already exist.&nbsp; Each iProperty must have a unique name with respect to other iProperties in that property set.&nbsp; A common workflow is to update the value of an iProperty, but if it doesn’t exist to create it.&nbsp; The VBA sample code below demonstrates a function that does this.&nbsp; It relies on error handling to determine if an iProperty already exists.&nbsp; If it exists it updates its value.&nbsp; If it doesn’t exist then it creates it.&nbsp; Below this sample I’ve also listed VB.Net, and C# samples since there are differences in syntax and error handling, even though they all make the same Inventor API calls.</P><strong>VBA</strong> 
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Public Sub TestiPropertyUpdate() <br>&nbsp;<font color=#0000ff><strong>&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim Doc As Document <br>&nbsp;&nbsp;&nbsp; Set Doc = ThisApplication.ActiveDocument <br><br>
<P></P>
<P><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; Call UpdateCustomiProperty(Doc, "Test", "Some Text") <br>End Sub <br><br><br><br>Public Sub UpdateCustomiProperty(ByRef Doc As Document, _ <br>								 ByRef PropertyName As String, _ <br>								 ByRef PropertyValue As Variant) <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As PropertySet <br>&nbsp;&nbsp;&nbsp; Set customPropSet = Doc.PropertySets.Item( _ <br>							&nbsp;&nbsp; "Inventor User Defined Properties") <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim prop As Property <br>&nbsp;&nbsp;&nbsp; On Error Resume Next <br>&nbsp;&nbsp;&nbsp; Set prop = customPropSet.Item(PropertyName) <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Check to see if the above call failed.&nbsp; If it failed <br>&nbsp;&nbsp;&nbsp; ' then the property doesn't exist. <br></strong></font>&nbsp;&nbsp;&nbsp; If Err.Number &lt;&gt; 0 Then <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; Set prop = customPropSet.Add(PropertyValue, PropertyName) <br>&nbsp;&nbsp;&nbsp; Else <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue <br>&nbsp;&nbsp;&nbsp; End If <br>End Sub</P></DIV>
<br>
<P><strong>VB.Net</strong> <br></P>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">Private Sub TestiPropertyUpdate() </DIV>
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new"><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Connect to a running instance of Inventor. <br>&nbsp;&nbsp;&nbsp; ' Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim invApp As Inventor.Application <br>&nbsp;&nbsp;&nbsp; invApp = System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application")&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim Doc As Inventor.Document <br>&nbsp;&nbsp;&nbsp; Doc = invApp.ActiveDocument&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; UpdateCustomiProperty(Doc, "Test", "Some Text") <br>End Sub <br><br><br><br>Private Sub UpdateCustomiProperty(ByRef Doc As Inventor.Document, _ <br>								 ByRef PropertyName As String, _ <br>								 ByRef PropertyValue As Object) <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the custom property set. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim customPropSet As Inventor.PropertySet <br>&nbsp;&nbsp;&nbsp; customPropSet = Doc.PropertySets.Item( _ <br>							&nbsp;&nbsp; "Inventor User Defined Properties")&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; ' Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Dim prop As Inventor.Property = Nothing <br>&nbsp;&nbsp;&nbsp; Dim propExists As Boolean = True <br>&nbsp;&nbsp;&nbsp; Try <br>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Item(PropertyName) <br>&nbsp;&nbsp;&nbsp; Catch ex As Exception <br>	&nbsp;&nbsp;&nbsp; propExists = False <br>&nbsp;&nbsp;&nbsp; End Try&nbsp; <br><br>&nbsp;&nbsp;&nbsp; ' Check to see if the property was successfully obtained. <br>&nbsp;&nbsp;&nbsp; If Not propExists Then <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Add(PropertyValue, PropertyName) <br>&nbsp;&nbsp;&nbsp; Else <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; ' Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue <br>&nbsp;&nbsp;&nbsp; End If <br>End Sub</DIV>
<br><strong>C#</strong> 
<DIV style="FONT-SIZE: 8pt; BACKGROUND: #eeeeee; COLOR: black; LINE-HEIGHT: 140%; FONT-FAMILY: courier new">private void TestiPropertyUpdate() <br>{ <br>&nbsp;&nbsp;&nbsp; // Connect to a running instance of Inventor. <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Application invApp = null; <br>&nbsp;&nbsp;&nbsp; invApp = (Inventor.Application)System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application");&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the active document. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Document doc = invApp.ActiveDocument;&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Update or create the custom iProperty. <br></strong></font>&nbsp;&nbsp;&nbsp; UpdateCustomiProperty(doc, "Test2", "Some updated text."); <br>} 
<P>private void UpdateCustomiProperty(Inventor.Document Doc, <br>								&nbsp;&nbsp; String PropertyName, <br>								&nbsp;&nbsp; Object PropertyValue) <br>{ <br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the custom property set.&nbsp; <br></strong></font><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Watch out for the wrapped line. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.PropertySet customPropSet; <br>&nbsp;&nbsp;&nbsp; customPropSet = Doc.PropertySets["Inventor User Defined Properties"];&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Get the existing property, if it exists. <br></strong></font>&nbsp;&nbsp;&nbsp; Inventor.Property prop = null; <br>&nbsp;&nbsp;&nbsp; Boolean propExists = true; <br>&nbsp;&nbsp;&nbsp; try <br>&nbsp;&nbsp;&nbsp; { <br>	&nbsp;&nbsp;&nbsp; prop = customPropSet[PropertyName]; <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; catch (Exception ex) <br>&nbsp;&nbsp;&nbsp; { <br>	&nbsp;&nbsp;&nbsp; propExists = false; <br>&nbsp;&nbsp;&nbsp; }&nbsp; <br><br><font color=#0000ff><strong>&nbsp;&nbsp;&nbsp; // Check to see if the property was successfully obtained. <br></strong></font>&nbsp;&nbsp;&nbsp; if (!propExists) <br>&nbsp;&nbsp;&nbsp; { <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; // Failed to get the existing property so create a new one. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop = customPropSet.Add(PropertyValue, PropertyName, null); <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; else <br>&nbsp;&nbsp;&nbsp; { <br><font color=#0000ff><strong>	&nbsp;&nbsp;&nbsp; // Change the value of the existing property. <br></strong></font>	&nbsp;&nbsp;&nbsp; prop.Value = PropertyValue; <br>&nbsp;&nbsp;&nbsp; } <br>}</P></DIV>
<P><strong></strong></P>
<P><strong>Deleting iProperties</strong> <br>To delete an iProperty you just call the Delete method of the Property object.</P>
