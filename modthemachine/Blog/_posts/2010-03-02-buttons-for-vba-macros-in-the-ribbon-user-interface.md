---
layout: "post"
title: "Buttons for VBA Macros in the Ribbon User-Interface"
date: "2010-03-02 19:23:47"
author: "Adam Nagy"
categories:
  - "Brian"
  - "Visual Basic for Applications (VBA)"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/03/buttons-for-vba-macros-in-the-ribbon-user-interface.html "
typepad_basename: "buttons-for-vba-macros-in-the-ribbon-user-interface"
typepad_status: "Publish"
---

<p>There’s a <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">previous post</a> that describes various ways to run a VBA macro, with a&#160; portion of that post discussing how to create a button to execute a macro.&#160; That post describes the process of creating a button for the classic user-interface but the process is different for the ribbon user-interface.&#160; This post describes the differences when using the ribbon.</p>  <p>To create a button to execute a VBA macro in the ribbon user-interface you use the <strong>Customize User Commands</strong> command which you access by right-clicking anywhere on the ribbon, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8ed48e9970b-pi"><img title="CustomizeUserCommandsContext" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="263" alt="CustomizeUserCommandsContext" src="/assets/image_531984.jpg" width="454" border="0" /></a> </p>  <p>The command displays the dialog shown below.&#160; To choose a VBA macro select “Macros” in the drop-down in the upper-left corner of the dialog.&#160; The list of commands will now show all of the VBA macros in the application project.&#160; Select the desired macro and then click the “Add &gt;&gt;” button in the middle of the dialog.&#160; You can continue to select and add other macros and then click OK when finished. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f5413b8970c-pi"><img title="CustomizeUserCommands" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="390" alt="CustomizeUserCommands" src="/assets/image_69383.jpg" width="454" border="0" /></a> </p>  <p>Buttons for the selected macros are added to a new panel, as shown below.&#160; The “User Commands” panel is added to the currently active ribbon tab, so by choosing which tab to add the macros to you have some control over when the command is available.&#160; If you need it in more than one tab, you’ll need to go through the process&#160; for each tab.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401310f5413c9970c-pi"><img title="UserCommandExample" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="167" alt="UserCommandExample" src="/assets/image_518025.jpg" width="331" border="0" /></a>&#160;</p>  <p></p>  <p></p>  <p>As explained in the <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">other post</a>, you can assign your own icons, as I’ve done in this example.&#160; This is done in exactly the same way as described before, by creating a bmp file, saving it in the same directory as the .ivb file, and naming it correctly.&#160; One thing to be aware of is that you don’t have control over whether the button will be displayed as a large or small button; it’s always small.&#160; Because of that the bitmap you create should be 16x16 pixels and should be named “<em>ModuleName</em>.<em>MacroName</em>.Small.bmp”.&#160; Unfortunately, you don’t have the option of displaying text with the button.&#160; Having a recognizable icon will help with this and the tooltip for the button displays the name of the macro.</p>
