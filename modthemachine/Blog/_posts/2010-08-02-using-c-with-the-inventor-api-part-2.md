---
layout: "post"
title: "Using C# with the Inventor API (Part 2)"
date: "2010-08-02 18:58:01"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/08/using-c-with-the-inventor-api-part-2.html "
typepad_basename: "using-c-with-the-inventor-api-part-2"
typepad_status: "Publish"
---

<p>Here’s my second installment on some of the differences you’ll encounter when using C# to program Inventor’s API.&#160; The first post is <a href="http://modthemachine.typepad.com/my_weblog/2010/07/using-c-with-the-inventor-api-part-1.html">here</a>.     <br /></p>  <p><em><strong>Property Name Differences</strong></em>     <br />If a property has arguments then C# automatically converts that property into one or two methods so that there is a method that represents the read version of the property and another for the write version.     <br />    <br />Here’s an example VBA program that calls some properties.&#160; The first is the Transformation property of the ComponentOccurrence object.&#160; It reads this property and then later also sets the value of the property.&#160; The program also uses the Cell property of the Matrix object.&#160; This property has arguments to allow you to specify the row and column of the cell you want to get or set.&#160; </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Get the selected occurrence from the active document.          <br />' This will fail if an occurrence is not currently selected.           <br /></strong></font>Set occ = asmDoc.SelectSet.Item(1) </p>    <p><font color="#0000ff"><strong>' Get the transform from the selected occurrence.          <br /></strong></font>Dim transform As Matrix       <br />Set transform = occ.Transformation </p>    <p><font color="#0000ff"><strong>' Display the current X translation value.          <br /></strong></font>Debug.Print &quot;X translation: &quot; &amp; transform.Cell(1, 4) </p>    <p><font color="#0000ff"><strong>' Modify the X translation to be an additional 1 cm.          <br /></strong></font>transform.Cell(1, 4) = transform.Cell(1, 4) + 1 </p>    <p><font color="#0000ff"><strong>' Assign the modified matrix back to the occurence.          <br /></strong></font>occ.Transformation = transform </p> </div>  <p>Here’s the equivalent code in C#.&#160; Because the Transformation property doesn’t have any arguments, you use it the same way as in the VBA code above.&#160; The Cell property has arguments and doesn’t exist in C# but is instead accessed by the get_Cell and set_Cell methods.&#160; The get_Cell method takes the row and column as input arguments and returns the value of the cell as a return value.&#160; To set the cell I call the set_Cell method.&#160; This has three arguments, the first two are the row and column and the third is the new value of the cell.&#160; The get_Cell and set_Cell methods don’t actually exist in the Inventor API, but are automatically created by C# as part of its COM interop implementation.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>// Get the selected occurrence from the active document.          <br />// This will fail if an occurrence is not currently selected.           <br /></strong></font>occ = (ComponentOccurrence) asmDoc.SelectSet[1]; </p>    <p><font color="#0000ff"><strong>// Get the transform from the selected occurrence.          <br /></strong></font>Matrix transform;       <br />transform = occ.Transformation; </p>    <p><font color="#0000ff"><strong>// Display the current X translation value.          <br /></strong></font>System.Diagnostics.Debug.Print(       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;X translation: &quot; + transform.get_Cell(1, 4)); </p>    <p><font color="#0000ff"><strong>// Modify the X translation to be an additional 1 cm.          <br /></strong></font>transform.set_Cell( 1, 4, transform.get_Cell(1, 4) + 1.0 ); </p>    <p><font color="#0000ff"><strong>// Assign the modified matrix back to the occurence.          <br /></strong></font>occ.Transformation = transform;</p> </div>  <p>This inconsistency between VB and C# is relatively easy to catch because you’ll get an error saying that the specified property doesn’t exist.&#160; That should be the reminder to look for the get_XXX or set_XXX version instead.</p>  <p><em><strong>Methods that Return Values as Arguments</strong></em>    <br />In C# you need to explicitly specify that an argument will return a value when making a method call.&#160; Here’s the VBA example of calling the GetCoordinateSystem method of the Matrix object.&#160; All four arguments are return values.&#160; The VBA version of the code doesn’t do anything special to indicate they are return values. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>' Get the coordinate system information from the matrix.        <br /></strong></font>Dim origin As Point     <br />Dim xAxis As Vector     <br />Dim yAxis As Vector     <br />Dim zAxis As Vector     <br />Call transform.GetCoordinateSystem(origin, xAxis, yAxis, zAxis) </div>  <br />Here’s the equivalent C# code.&#160; Notice that I have to qualify each argument that will return a value with the “out” keyword to indicate that the argument is being passed by reference and will return a value.   <br />  <br />  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>// Get the coordinate system information from the matrix.</strong></font>     <br />Inventor.Point origin;     <br />Vector xAxis;     <br />Vector yAxis;     <br />Vector zAxis;     <br />transform.GetCoordinateSystem(out origin, out xAxis,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; out yAxis, out zAxis);     <br /></div>  <p>This issue is also relatively easy to catch and fix since it shows itself as a compile error.&#160; Intellisense provides the best clue about what the problem is.&#160; Below is the feedback for the code above before I added the “out” keyword to each argument.&#160; Notice that each argument has the “out” keyword in the signature shown in the intellisense window.&#160; Typically there may be some input arguments and one or two output arguments.&#160; It’s only the output arguments that you need to add the “out” keyword to.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133f2cd5863970b-pi"><img title="OutKeyword" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="159" alt="OutKeyword" src="/assets/image_641790.jpg" width="495" border="0" /></a></p>
