---
layout: "post"
title: "Translating Files with the API"
date: "2009-01-22 00:18:26"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html "
typepad_basename: "translating-files-with-the-api"
typepad_status: "Publish"
---

<p>I've been asked the same question twice recently that's related to my previous <a href="http://modthemachine.typepad.com/my_weblog/2008/10/converting-vba-auto-macros-to-an-add-in.html">Converting VBA Auto Macros to an Add-In</a> post.&#160; In that example I showed how to write out dwf and pdf files using the API.&#160; The question asked was how to create a pdf file that contains all of the sheets in the drawing instead of just the active sheet.&#160; Similar questions about how to control the translators have been asked in the customization newsgroup too, so I think it's worthwhile to discuss how to read and write various file formats using Inventor's API.&#160; Inventor's API supports three different ways of importing and exporting files in and out of Inventor.&#160; These are discussed below.&#160; </p>  <p><strong><font size="4">Method 1 (Save As)</font></strong>     <br />The first way to translate files is very easy to use and supports a wide variety of formats but has limited flexibility with respect to controlling the various options when doing the translation.&#160; This first method uses the Document.SaveAs method to translate a file from Inventor to another format and the Documents.Open method to translate a foreign file into Inventor.&#160; Below is an example of a program that uses the SaveAs method to save a PDF file of the active document.</p>  <br />  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsPDF()    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the active docuement.</strong></font>     <br />&#160;&#160;&#160; Dim oDoc As Document     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.activeDocument     <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Save a copy as a PDF file.</strong></font>     <br />&#160;&#160;&#160; Call oDoc.SaveAs(&quot;C:\Temp\TestFile.pdf&quot;, True)     <br />End Sub </div>  <div></div>  <p>   <br />The SaveAs and Open methods are the methods you use to open and save Inventor files.&#160; The key to also using them to translate other file formats is the file extension.&#160; When you specify the filename to open or save to, Inventor looks at the extension of the filename and will automatically call the appropriate translator.&#160; In this example it sees the PDF file extension and automatically calls the PDF translator.&#160; The same limitations of the file types that you have in the Inventor <strong>Open</strong> and <strong>Save Copy As</strong> commands apply.&#160; For example, you can save a part as an stl file but you can't open an stl file.&#160;&#160; The picture below shows the file types available in the Open dialog.&#160; These are also the file types that are supported by the Documents.Open method.     <br /></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4af970c-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="356" alt="OpenFileTypes" src="/assets/image_337517.jpg" width="400" border="0" /></a> </p>  <p>This technique is very simple, as you can see in the sample code above.&#160; The primary limitation with this approach is that you don't have control over any of the options for the translator.&#160; For example, the picture below shows the options dialog that's available when you're using the <strong>Save Copy As</strong> command to create a PDF file.&#160; When you use the Document.SaveAs method from the API the PDF will be created using default values for these settings.&#160; Typically these defaults are the settings last specified by the user when using the <strong>Save Copy As</strong> command, although this behavior can vary from one translator type to another.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536e2b8d3970b-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="191" alt="pdfOptions" src="/assets/image_401647.jpg" width="354" border="0" /></a> </p>  <p>&#160;</p>  <p><font size="4"><strong>Method 2</strong> (Translator Add-Ins)</font>     <br />This second technique is more complicated to use but provides access to the various options that the translator supports.&#160; It takes advantage of the fact that translators in Inventor are implemented as a special type of Add-In.&#160; All translator Add-Ins are required to support a common set of methods and properties which allows you to write a program that drives the translator.&#160; This is illustrated in the sample program below.</p>  <p>&#160;</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsPDF()&#160; <br />&#160; <font color="#0000ff"><strong>' Get the PDF translator Add-In.</strong></font>&#160; <br />&#160; Dim oPDFTrans As TranslatorAddIn&#160; <br />&#160; Set oPDFTrans = ThisApplication.ApplicationAddIns.ItemById( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}&quot;)&#160; <br />&#160; If oPDFTrans Is Nothing Then&#160; <br />&#160;&#160;&#160; MsgBox &quot;Could not access PDF translator.&quot;&#160; <br />&#160;&#160;&#160; Exit Sub&#160; <br />&#160; End If&#160;&#160; <br />    <br />&#160; <font color="#0000ff"><strong>' Create some objects that are used to pass information to&#160; <br />&#160; the translator Add-In.</strong></font>&#160;&#160; <br />&#160; Dim oContext As TranslationContext&#160; <br />&#160; Set oContext = ThisApplication.TransientObjects.CreateTranslationContext&#160; <br />&#160; Dim oOptions As NameValueMap&#160; <br />&#160; Set oOptions = ThisApplication.TransientObjects.CreateNameValueMap&#160; <br />&#160; If oPDFTrans.HasSaveCopyAsOptions(ThisApplication.activeDocument, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContext, oOptions) Then&#160; <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set to print all sheets.&#160; This can also have the value&#160; <br />&#160;&#160;&#160; ' kPrintCurrentSheet or kPrintSheetRange. If kPrintSheetRange&#160; <br />&#160;&#160;&#160; ' is used then you must also use the CustomBeginSheet and&#160; <br />&#160;&#160;&#160; ' Custom_End_Sheet to define the sheet range.&#160; <br /></strong></font>&#160;&#160;&#160; oOptions.Value(&quot;Sheet_Range&quot;) = kPrintAllSheets&#160; <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Other possible options...&#160; <br /></strong></font>&#160;&#160;&#160; 'oOptions.Value(&quot;Custom_Begin_Sheet&quot;) = 1&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Custom_End_Sheet&quot;) = 5&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;All_Color_AS_Black&quot;) = True&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Remove_Line_Weights&quot;) = True&#160; <br />&#160;&#160;&#160; 'oOptions.Value(&quot;Vector_Resolution&quot;) = 200 </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Define various settings and input to provide the translator.</strong>&#160; <br /></font>&#160;&#160;&#160; oContext.Type = kFileBrowseIOMechanism&#160; <br />&#160;&#160;&#160; Dim oData As DataMedium&#160; <br />&#160;&#160;&#160; Set oData = ThisApplication.TransientObjects.CreateDataMedium&#160; <br />&#160;&#160;&#160; oData.FileName = &quot;C:\temp\test.pdf&quot;&#160;&#160; <br />    <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Call the translator.&#160; <br /></strong></font>&#160;&#160;&#160; Call oPDFTrans.SaveCopyAs(ThisApplication.activeDocument, _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContext, oOptions, oData)&#160; <br />&#160; End If     <br />End Sub</div>  <p>   <br />This program begins by getting a specific translator Add-In using its ID, the PDF translator in this case.&#160; (See the translator reporter paragraph below for one method to determine the Add-In ID.)&#160; It then creates some objects that are required for some input arguments.&#160; The next section is the most interesting and is where it sets the values for the various options of the translator.&#160; In this cases it's setting the PDF translator to print all of the sheets in the drawing.&#160; Next it defines the filename of the output file and finally it calls the method on the translator to perform the actual translation.</p>  <p>The hardest part of using this approach to translate files is understanding what the supported options are and how to set them.&#160; The best resource for this information is the programming help.&#160; This discusses the options for each translator type along with samples for most of the translators.&#160; Look for the help topic &quot;TranslatorAddIn Object&quot;.&#160; You can also get to this topic from the <strong>Samples</strong> page in the programming help and selecting one of the samples from the <strong>Import/Export</strong> section.&#160; The picture below illustrates how to access the programming help.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc68834010536ebf4c1970c-pi"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="197" alt="APIHelpAccess" src="/assets/image_588915.jpg" width="350" border="0" /></a>     <br /></p>  <p>Here's a <a href="http://modthemachine.typepad.com/files/translatorreport.zip">translator reporter macro</a> that I created before the help files existed but that I still find useful when working with translators.&#160; To use it copy and paste the code into a VBA project and run the macro.&#160; It writes a report that contains information about all of the loaded translators.&#160; The most interesting information reported is the list of all of the available translator Add-Ins, their Add-In ID, and the options supported by each Add-In.&#160; The online help is still the best resource for the option information since it also includes a description of the options and valid input for the options.</p>  <p>&#160;</p>  <p><strong><font size="4">Method 3 (DataIO)</font>       <br /></strong>The final method of translating data has the most limitations but supports some special cases that aren't handled by the standard translators.&#160; This method uses an API object called DataIO which you can get from some Inventor API objects.&#160; Basically, you get the DataIO object from the object of Interest and use the methods on the DataIO object to write out the object of interest in the specified format.&#160; The DataIO object can also be used to read data into Inventor.&#160; The number of objects that support DataIO and the formats supported are very small.&#160; Here are what I think are the most interesting:</p>  <ul>   <li>Writing out a sheet metal flat pattern as DWG or DXF. </li>    <li>Writing out the contents of a sketch as DWG or DXF. </li>    <li>Reading and writing a part solid as SAT. </li> </ul>  <p>These and more information about DataIO are discussed in more detail in the programming help.&#160; Since it's not used very often and rather than just repeat that information here I'll refer you to it.</p>
