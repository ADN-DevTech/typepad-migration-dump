---
layout: "post"
title: "Open Drawing from a Part or Assembly"
date: "2016-01-13 22:51:42"
author: "Adam Nagy"
categories:
  - "Brian"
  - "Drawings"
  - "Inventor"
original_url: "https://modthemachine.typepad.com/my_weblog/2016/01/open-drawing-from-a-part-or-assembly.html "
typepad_basename: "open-drawing-from-a-part-or-assembly"
typepad_status: "Publish"
---

<p>Inventor supports the “Open Drawing” command that you can access from the context menu when clicking on a part or assembly node in the browser.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c807155b970b-pi"><img title="FindDrawing" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="FindDrawing" src="/assets/image_626594.jpg" width="247" height="350" /></a></p>  <p>&#160;</p>  <p>The equivalent functionality is not available through the Inventor API. However, the logic behind the command is very simple and not difficult to do on your own using Inventor’s API and features built into your programming language. A part or assembly doesn’t know if there are any drawings referencing it so the command just takes the filename of the part or assembly and looks for a file within the project of the same name as the part or assembly but with a .idw or .dwg extension.</p>  <p>Below is a VBA Sub that passes in the active part or assembly document to a function that either returns the full filename to the found drawing or an empty string if it can’t find a drawing.</p>  <br />  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub FindDrawingTest()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument&#160; <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Call the function to get the drawing.</font></strong>&#160; <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = FindDrawingFile(partDoc)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <strong><font color="#0000ff">' Display the result.</font></strong>       <br />&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;The drawing for &quot;&quot;&quot; &amp; partDoc.fullFilename &amp; &quot;&quot;&quot; was found: &quot; &amp; vbCr &amp; drawingFilename       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;No drawing was found for &quot;&quot;&quot; &amp; partDoc.fullFilename &amp; &quot;&quot;&quot;&quot;       <br />&#160;&#160;&#160; End If       <br />End Sub      <br />      <br />      <br /><font color="#0000ff"><strong>' Find the drawing for the specified part of assembly.          <br /></strong></font>Private Function FindDrawingFile(PartOrAssemblyDoc As Document)       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = PartOrAssemblyDoc.fullFilename       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the path from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim path As String       <br />&#160;&#160;&#160; path = Left$(fullFilename, InStrRev(fullFilename, &quot;\&quot;))       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the filename from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = Right$(fullFilename, Len(fullFilename) - InStrRev(fullFilename, &quot;\&quot;))       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Replace the extension with &quot;dwg&quot;</strong></font>       <br />&#160;&#160;&#160; filename = Left$(filename, InStrRev(filename, &quot;.&quot;)) &amp; &quot;dwg&quot;       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the drawing exists.</strong></font>       <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = ThisApplication.DesignProjectManager.ResolveFile(path, filename)       <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename = &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Try again with idw extension.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Left$(filename, InStrRev(filename, &quot;.&quot;)) &amp; &quot;idw&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the drawing exists.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawingFilename = ThisApplication.DesignProjectManager.ResolveFile(path, filename)       <br />&#160;&#160;&#160; <br /><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Return the result.</font>         <br /></strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = drawingFilename       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = &quot;&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; FindDrawingFile = drawingFilename       <br />&#160;&#160;&#160; End If       <br />End Function</p> </div>  <br />  <p>And here’s the same thing implemented in Visual Basic .NET</p>  <div style="font-size: 10pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Private Sub btnFindDrawing_Click(sender As Object, e As EventArgs) Handles btnFindDrawing.Click      <br />&#160;&#160;&#160; Dim invApp As Inventor.Application = GetObject(, &quot;Inventor.Application&quot;)       <br />&#160;&#160;&#160; Dim partDoc As Inventor.PartDocument = invApp.ActiveDocument      <br />      <br /></p>&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>'&#160; Call the function to get the drawing.</strong></font>&#160; <br />    <p>&#160;&#160;&#160; Dim drawingFilename As String = FindDrawingFile(partDoc)     <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Display the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;The drawing for &quot;&quot;&quot; &amp; partDoc.FullFileName &amp; &quot;&quot;&quot; was found: &quot; &amp; vbCr &amp; drawingFilename)       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox(&quot;No drawing was found for &quot;&quot;&quot; &amp; partDoc.FullFileName &amp; &quot;&quot;&quot;&quot;)       <br />&#160;&#160;&#160; End If       <br />End Sub       <br />      <br />      <br /><font color="#0000ff"><strong>' Find the drawing for the specified part of assembly.</strong></font>       <br />Private Function FindDrawingFile(PartOrAssemblyDoc As Inventor.Document)       <br />&#160;&#160;&#160; Dim fullFilename As String = PartOrAssemblyDoc.FullFileName      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the path from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim path As String = System.IO.Path.GetFullPath(fullFilename)      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Extract the filename from the full filename.</strong></font>       <br />&#160;&#160;&#160; Dim filename As String = System.IO.Path.GetFileNameWithoutExtension(fullFilename)      <br />&#160;&#160;&#160; Dim invApp As Inventor.Application = PartOrAssemblyDoc.Parent      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Find if the dwg exists.</strong></font>       <br />&#160;&#160;&#160; Dim drawingFilename As String       <br />&#160;&#160;&#160; drawingFilename = invApp.DesignProjectManager.ResolveFile(path, filename &amp; &quot;.dwg&quot;)      <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Check the result.</strong></font>       <br />&#160;&#160;&#160; If drawingFilename = &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Try again with idw extension.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawingFilename = invApp.DesignProjectManager.ResolveFile(path, filename &amp; &quot;.idw&quot;)      <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If drawingFilename &lt;&gt; &quot;&quot; Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return drawingFilename       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return &quot;&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Else       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff"><strong>' Return the result.</strong></font>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Return drawingFilename       <br />&#160;&#160;&#160; End If       <br />End Function</p> </div>  <br />-Brian
