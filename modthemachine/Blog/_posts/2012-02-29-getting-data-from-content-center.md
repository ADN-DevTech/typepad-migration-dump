---
layout: "post"
title: "Getting data from Content Center"
date: "2012-02-29 20:38:53"
author: "Wayne Brill"
categories:
  - "Assemblies"
original_url: "https://modthemachine.typepad.com/my_weblog/2012/02/getting-data-from-content-center.html "
typepad_basename: "getting-data-from-content-center"
typepad_status: "Publish"
---

<p>You can use GetContentObject() of ContentCenter<em> </em>to get data about an occurrence that was placed from content center. There are two samples that use the ContentCenter object in the API help file, however there is not an example of using GetContentObject(). If you are trying to use this method it will help to know how to create the string so it will return what you need.&#160;&#160;&#160; </p>  <p>In a recent case my colleague Xiaodong Liang explained that if the MemberId is included in the string parameter, GetContentObject() returns the ContentTableRow and if the MemberId is not provided, the method returns the ContentFamily. To get the MemberId you access a PropertySet of the PartDocument. (Use the Definition of the occurrence).</p>  <p><em>PartDocument-&gt;PropertySets-&gt;Content Library Component Properties&gt;item[MemberId].Value.</em></p>  <p><strong>VBA Example</strong>. (Please keep in mind that we only recommend using VBA for prototyping and learning the API but do not recommend using VBA in production).</p>  <p style="line-height: 140%; font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">Sub GetContentObject_Test()    <br />&#160;&#160;&#160; Dim oOcc As ComponentOccurrence     <br />&#160;&#160;&#160; Set oOcc = ThisApplication.CommandManager.Pick _     <br />&#160;&#160;&#160; (kAssemblyOccurrenceFilter, &quot;Pick occurrence&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If oOcc.DefinitionDocumentType &lt;&gt; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kPartDocumentObject Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;The occurrence is not a CC part.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oOccDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oOccDef = oOcc.Definition     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If Not oOccDef.IsContentMember Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;The occurrence is not a CC part.&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Sub     <br />&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Set a reference to the ContentCenter object.</font>     <br />&#160;&#160;&#160; Dim oContentCenter As ContentCenter     <br />&#160;&#160;&#160; Set oContentCenter = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ContentCenter     <br />&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Reference &quot;CC Library Component      <br />&#160;&#160;&#160; ' Properties' propertyset       <br /></font>&#160;&#160;&#160; Dim propSet As PropertySet     <br />&#160;&#160;&#160; Set propSet = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oOccDef.Document.PropertySets.Item _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;{B9600981-DEE8-4547-8D7C-E525B3A1727A}&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <font color="#0000ff">' Get FamilyId property      <br /></font>&#160;&#160;&#160; Dim familyId As Property     <br />&#160;&#160;&#160; Set familyId = propSet.Item(&quot;FamilyId&quot;)     <br />&#160;&#160; <br />&#160;&#160; <font color="#0000ff">' Get MemberId property      <br /></font>&#160;&#160;&#160; Dim strMemberId As String     <br />&#160;&#160;&#160; strMemberId = propSet(&quot;MemberId&quot;).Value     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim msgBoxResult As VbMsgBoxResult     <br />&#160;&#160;&#160; msgBoxResult = MsgBox _     <br />&#160;&#160; (&quot;Get Family ?&quot;, vbYesNo, &quot;Yes=Family No=Row&quot;)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; If msgBoxResult = vbYes Then     <br />&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Get family, (Not including memberId)</font>     <br />&#160;&#160;&#160;&#160;&#160;&#160; Dim oContentFamily As ContentFamily     <br />&#160;&#160;&#160;&#160;&#160;&#160; Set oContentFamily = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentCenter.GetContentObject _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (&quot;v3#&quot; &amp; familyId.Value &amp; &quot;#&quot;)     <br />&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; MsgBox &quot;family display name: &quot; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; oContentFamily.DisplayName &amp; vbCr &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;family LibraryName name: &quot; &amp; _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentFamily.LibraryName     <br />&#160;&#160;&#160;&#160;&#160; Else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#0000ff">' Get Table Row, (Including memberId)</font>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim oContentTableRow As ContentTableRow     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oContentTableRow = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oContentCenter.GetContentObject _     <br />&#160;&#160;&#160;&#160; (&quot;v3#&quot; &amp; familyId.Value &amp; &quot;#&quot; &amp; strMemberId)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim str As String     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; str = &quot;Data from cells in Table Row&quot; &amp; vbCr     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Debug.Print oContentTableRow.count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For i = 1 To oContentTableRow.count     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Debug.Print i&#160; <br />&#160;&#160;&#160;&#160;&#160; ' Debug.Print oContentTableRow.GetCellValue(i)&#160; <br />&#160;&#160;&#160;&#160;&#160; str = str &amp; oContentTableRow.GetCellValue(i)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MsgBox str     <br />&#160;&#160;&#160; End If     <br />End Sub</p>  <p>Wayne Brill</p>
