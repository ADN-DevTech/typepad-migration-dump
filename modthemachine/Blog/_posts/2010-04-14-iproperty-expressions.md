---
layout: "post"
title: "iProperty Expressions"
date: "2010-04-14 20:19:08"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/04/iproperty-expressions.html "
typepad_basename: "iproperty-expressions"
typepad_status: "Publish"
---

<p>In the iProperties dialog, Inventor allows you to create expressions for the values of iProperties.&#160; Using an expression you can combine the values of other iProperties into a single iProperty value.&#160; (By using the functionality described in <a href="http://modthemachine.typepad.com/my_weblog/2010/04/parameters-as-iproperties.html">a previous post</a> to create an iProperty for a parameter, you can also use parameter values in an expression.)&#160; To create an expression just enter an “=” sign as the first character of the iProperty value.&#160; Inventor will now treat this as an expression.&#160; An expression can consist of any text and can reference any existing iProperties by specifying their names in brackets, as shown below.&#160; The expression in this example uses the iProperty named “Part Number” and two custom iProperties named “Length” and “Height” that were created by exporting parameters.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ecb03915970b-pi"><img title="iPropertyExpression" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="231" alt="iPropertyExpression" src="/assets/image_218897.jpg" width="450" border="0" /></a> </p>  <p>Once you’ve finished entering the expression and press return, the expression is evaluated and the resulting value is displayed, as shown below.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe008bc970c-pi"><img title="iPropertyExpressionResult" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="56" alt="iPropertyExpressionResult" src="/assets/image_339430.jpg" width="450" border="0" /></a></p>  <p>The <img title="fx" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="16" alt="fx" src="/assets/image_346540.jpg" width="15" border="0" /> symbol to the right of the field indicates that the property is defined using an expression.&#160; To edit the expression, rather than the value, right-click in the iProperty field and select the Edit Expression command from the context menu, as shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401347fe00913970c-pi"><img title="EditExpression" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="88" alt="EditExpression" src="/assets/image_853443.jpg" width="450" border="0" /></a></p>  <p>To use expressions through the API you use the Expression property of the Property object.&#160; This is demonstrated below.&#160; The Expression property is the equivalent of editing the expression in the iProperties dialog.&#160; When setting the value of the Expression property you need to follow the same rules as when creating an expression in the iProperties dialog.&#160; The Value property of the Property object will always return the evaluated result.&#160; Setting the value through the Value property will remove the expression associated with the property or you can set the value of the expression to an empty string (“”).</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub TestExpression()      <br />&#160;&#160;&#160; Dim partDoc As PartDocument       <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Design Tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim designTrackPropSet As PropertySet       <br />&#160;&#160;&#160; Set designTrackPropSet = partDoc.PropertySets.Item( _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Description property.          <br /></strong></font>&#160;&#160;&#160; Dim descProp As Property       <br />&#160;&#160;&#160; Set descProp = designTrackPropSet.Item(&quot;Description&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add an expression to the property.          <br /></strong></font>&#160;&#160;&#160; descProp.Expression = _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;=&lt;Part Number&gt; size is &lt;Length&gt; x &lt;Height&gt;&quot;       <br />End Sub</p> </div>  <p>The program below removes the expression from the property but maintains the property’s current value.&#160; It does this by setting the value of the property to its current value.&#160; This would at first seem like it wouldn’t do anything, but in the case where the property is defined using an expression, setting the value of the property removes the expression.&#160; It’s just that in this case the value we’re setting it to happens to be the current displayed value.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub TestExpression()    <br />&#160;&#160;&#160; Dim partDoc As PartDocument     <br />&#160;&#160;&#160; Set partDoc = ThisApplication.ActiveDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Design Tracking property set.        <br /></strong></font>&#160;&#160;&#160; Dim designTrackPropSet As PropertySet     <br />&#160;&#160;&#160; Set designTrackPropSet = partDoc.PropertySets.Item( _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Design Tracking Properties&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the Description property.        <br /></strong></font>&#160;&#160;&#160; Dim descProp As Property     <br />&#160;&#160;&#160; Set descProp = designTrackPropSet.Item(&quot;Description&quot;)     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the value of the property to it’s current value.       <br />&#160;&#160;&#160; ' This has the side-effect of removing an associated expression.</strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; descProp.Value = descProp.Value   <br />End Sub</div>
