---
layout: "post"
title: "Working with Files and Directories"
date: "2010-05-25 22:36:59"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/05/working-with-files-and-directories.html "
typepad_basename: "working-with-files-and-directories"
typepad_status: "Publish"
---

<p>Here’s some more functionality I’ve discovered in the .Net Framework that makes it hard for me when I have use VBA.&#160; In a <a href="http://modthemachine.typepad.com/my_weblog/2010/05/working-with-filenames.html">recent post</a> I talked about the functionality to manipulate full paths that’s supported by the Path class of the System.IO namespace.&#160; Two other very useful classes supported by System.IO are Directory and File.&#160; In VBA there are several functions that work with files but they’re harder to use and don’t have the same capabilities as what’s supported by System.IO.</p>  <p>A workhorse function in VBA is the Dir function.&#160; You can use it to check for the existence of a file.&#160; This isn’t much code but it’s not particularly intuitive that you can use Dir for this.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim filename As String      <br />filename = &quot;C:\Temp\Part1.ipt&quot;       <br />If Dir(filename) = &quot;&quot; Then       <br />&#160;&#160;&#160; MsgBox &quot;Specified file does not exist.&quot;       <br />Else       <br />&#160;&#160;&#160; MsgBox &quot;File exists.&quot;       <br />End If</p> </div>  <p>Using VB.Net and System.IO I can accomplish the same thing with the code below.&#160; In lines of code there’s not any difference, but it’s easier to understand what it’s supposed to be doing.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Dim filename As String      <br />filename = &quot;C:\Temp\Part1.ipt&quot;       <br />If System.IO.File.Exists(filename) Then       <br />&#160;&#160;&#160; MsgBox(&quot;File exists.&quot;)       <br />Else       <br />&#160;&#160;&#160; MsgBox(&quot;Specified file does not exist.&quot;)       <br />End If       <br /></p> </div>  <p>The File class that’s used above supports much more than just the Exists function.&#160; You can delete, open for read, create, get and set various file attributes, etc.</p>  <p>In addition to the File class the System.IO class also supports the Directory class.&#160; Using this class you can check for the existence of a directory, create a directory, delete a directory and much more.&#160; Here’s a VBA example using the Dir function to iterate over all of the part files within a directory.&#160; This does the job but isn’t particularly intuitive.&#160; If you also want to process the contents of subdirectories then it gets much more complicated because you can’t have nested Dir calls.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessPartsVBA()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot;       <br />      <br /></p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory.&#160;&#160; <br /></strong></font>&#160;&#160;&#160; Dim filename As String     <br />&#160;&#160;&#160; filename = Dir(processPath &amp; &quot;*.ipt&quot;)     <br />&#160;&#160;&#160; Do While filename &lt;&gt; &quot;&quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print &quot;Processing &quot; &amp; processPath &amp; filename     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Dir     <br />&#160;&#160;&#160; Loop     <br />End Sub</div>  <p>Here’s the same thing using the Directory class.&#160; Here a single call to the GetFiles function returns all of the files matching the search pattern as an array of strings.&#160; I think this is much easier to read, maintain, and is more flexible.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessPartsVBNet()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot; </p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory.       <br /></strong></font>&#160;&#160;&#160; Dim filenames() As String     <br />&#160;&#160;&#160; filenames = System.IO.Directory.GetFiles(processPath, &quot;*.ipt&quot;)     <br />&#160;&#160;&#160; For Each filename As String In filenames     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print(&quot;Processing &quot; &amp; filename)     <br />&#160;&#160;&#160; Next     <br />End Sub </div>  <p>There’s also a version of the GetFiles function that gets the files in the current directory and all subdirectories.&#160; This is messy to do with VBA.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ProcessAllPartsVBNet()      <br />&#160;&#160;&#160; Dim processPath As String       <br />&#160;&#160;&#160; processPath = &quot;C:\Temp\&quot; </p>   <font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the files in the specified directory and subdirectories.       <br /></strong></font>&#160;&#160;&#160; Dim filenames() As String     <br />&#160;&#160;&#160; filenames = System.IO.Directory.GetFiles(processPath, _    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;*.ipt&quot;, SearchOption.AllDirectories )     <br />&#160;&#160;&#160; For Each filename As String In filenames     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print(&quot;Processing &quot; &amp; filename)     <br />&#160;&#160;&#160; Next     <br />End Sub</div>
