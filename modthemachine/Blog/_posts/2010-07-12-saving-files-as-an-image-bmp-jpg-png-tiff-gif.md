---
layout: "post"
title: "Saving Files as an Image (bmp, jpg, png, tiff, gif)"
date: "2010-07-12 21:59:17"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/07/saving-files-as-an-image-bmp-jpg-png-tiff-gif.html "
typepad_basename: "saving-files-as-an-image-bmp-jpg-png-tiff-gif"
typepad_status: "Publish"
---

<p>I was recently asked if I had a macro that would create a jpg file for each part in a directory.&#160; The code below is what I came up with.&#160; It finds all of the files of a certain type within a specified directory and creates an image file for each one.&#160; </p>  <p>The primary function this macro uses to accomplish this is the SaveAsBitmap method.&#160; This method is on the View object, which represents a graphics window.&#160; The SaveAsBitmap method saves the contents of that window as an image.&#160; You can specify one of several different image types and you can also specify the size of the output image.&#160; The supported image types are bmp, jpg, png, tiff, and gif.&#160; The type to write out is inferred by the extension of the image file you specify.&#160; The sample below will create jpg files.&#160; Being able to specify the size of the output image is also powerful because then you’re not limited by the size of the window and the resulting image is not just a scaled bitmap of the current window contents&#160; but is an image rendered specifically at the specified size.</p>  <p>It’s also very simple in that there isn’t any user-interface.&#160; All inputs, the directory to process and the input and output file types, are hard-coded within the program.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub SaveImages()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Specify the size of the output image in pixels.&#160; If you          <br />&#160;&#160;&#160; ' use zero then it will be the actual size of the window.           <br /></strong></font>&#160;&#160;&#160; Dim pixelWidth As Integer       <br />&#160;&#160;&#160; Dim pixelHeight As Integer       <br />&#160;&#160;&#160; pixelWidth = 800       <br />&#160;&#160;&#160; pixelHeight = 800      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Specify the path where the files exist.&#160; The rest of the          <br />&#160;&#160;&#160; ' code expects this path name to end with a backslash.           <br /></strong></font>&#160;&#160;&#160; Dim dirName As String       <br />&#160;&#160;&#160; dirName = &quot;C:\Temp\&quot;       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Loop through the files in the specified directory.          <br />&#160;&#160;&#160; ' Depending on the file type you want to generate the           <br />&#160;&#160;&#160; ' images for you may need to change the file extension.           <br />&#160;&#160;&#160; ' In this case it will create images for all the part           <br />&#160;&#160;&#160; ' files in the specified directory.&#160; Editing &quot;*.ipt&quot; to           <br />&#160;&#160;&#160; ' &quot;*.iam&quot; will generate images for all assemblies.           <br /></strong></font>&#160;&#160;&#160; Dim filename As String       <br />&#160;&#160;&#160; filename = Dir(dirName &amp; &quot;*.ipt&quot;)       <br />&#160;&#160;&#160; Do While filename &lt;&gt; &quot;&quot;       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Save the current silent operation state.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim silentState As Boolean       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; silentState = ThisApplication.SilentOperation       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Turn on silent operation.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.SilentOperation = True       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Open the document.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set doc = ThisApplication.Documents.Open(dirName &amp; filename)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Restore the state to its previous value.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.SilentOperation = silentState      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the currently active view, which will be for         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the document just opened.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim window As view       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set window = ThisApplication.ActiveView      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Create the filename for the output file.&#160; This uses          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' the same name as the original file and replaces the          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' extension with .jpg           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim imageFilename As String       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; imageFilename = dirName &amp; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Left$(filename, InStr(filename, &quot;.&quot;)) &amp; &quot;jpg&quot;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call window.SaveAsBitmap(imageFilename, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pixelWidth, pixelHeight)      <br />       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Close the current document.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call doc.Close(True)       <br />      <br /><font color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the next filename.        <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; filename = Dir       <br />&#160;&#160;&#160; Loop       <br />      <br />&#160;&#160;&#160; ThisApplication.StatusBarText = &quot;Finished processing.&quot;       <br />End Sub</p> </div>
