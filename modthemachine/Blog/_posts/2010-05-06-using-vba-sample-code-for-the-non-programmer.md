---
layout: "post"
title: "Using VBA Sample Code (for the Non-Programmer)"
date: "2010-05-06 21:15:44"
author: "Adam Nagy"
categories:
  - "Brian"
  - "Visual Basic for Applications (VBA)"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/05/using-vba-sample-code-for-the-non-programmer.html "
typepad_basename: "using-vba-sample-code-for-the-non-programmer"
typepad_status: "Publish"
---

<p>You don’t know anything about VBA but you’ve found some interesting VBA code somewhere on the web, in a newsgroup, or maybe even here.&#160; So now what do you do with that code to be able to use it in Inventor?&#160; Here are the cookbook steps:</p>  <ol>   <li>From within Inventor, press Alt-F11 or run the <strong>VBA Editor</strong> command from the Tools tab of the ribbon.&#160; This will open the VBA development environment, as seen below.       <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17c6970c-pi"><img title="VBAEditor" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="330" alt="VBAEditor" src="/assets/image_679702.jpg" width="450" border="0" /></a> </p>   </li>    <li>The <strong>Project Explorer</strong> is the window containing the tree at the upper-left in the picture.&#160; <ul>       <li>Expand the node labeled “ApplicationProject”.&#160; </li>        <li>Expand the node labeled “Modules” </li>        <li>Double-click on the node labeled “Module1”          <br />An editor window will pop-up, similar to the picture below. (In the picture below I have one document open so there are two top-level nodes in the project explorer.&#160; One node is for the application project and the other node is for the document.&#160; Make sure you use the application project.)           <br /></li>     </ul>     <a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d17de970c-pi"><img title="VBAEditorModule1" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="330" alt="VBAEditorModule1" src="/assets/image_759072.jpg" width="450" border="0" /></a>       <p></p>      <p></p>   </li>    <li>Go to wherever the original VBA code is (browser, new reader, email, etc.) and copy it to the clipboard.      <br /></li>    <li>Click within the VBA code window and paste the code.&#160; You should see something similar to the picture below.      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed5953b2970b-pi"><img title="VBAEditorCode" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="270" alt="VBAEditorCode" src="/assets/image_35112.jpg" width="450" border="0" /></a> </p>   </li>    <li>Scan through the code to see if there are any problems.&#160; Do this by scrolling down through the pasted code looking for any red lines.&#160; If you don’t see any problems go to step 6, otherwise continue with this step.      <p>The most common issue when pasting code is that lines that should be a single line may end up wrapping onto two lines.&#160; VBA expects a statement to be on a single line.&#160; The example below illustrates the problem where what should be a single line has been broken and wraps onto the next line. </p>      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed59543d970b-pi"><img title="VBABadCodeSample" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="174" alt="VBABadCodeSample" src="/assets/image_76807.jpg" width="450" border="0" /></a> </p>      <p></p>      <p>Fix it by editing it so it is on a single line.</p>      <p>There’s also an exception to the statement I made above about the requirement of a statement only being a single line.&#160; It’s possible to break a statement into multiple lines by adding a “ _” (space and underscore) at the end of a line.&#160; This is a line continuation character and indicates that the statement continues on the next line.&#160; That’s shown in the top statement in the previous picture.&#160; You may need to understand that to better understand why a line is shown in red.       <br />        <br />If you see other problems, it beyond the scope of this post to diagnose those.&#160; It would be best to go back to the author or to ask someone that has some familiarity with the API.</p>   </li>    <li>Close the VBA window.      <br /></li>    <li>Run the program by pressing Alt-F8 or running the <strong>Macros</strong> command from the Tools tab.&#160; This will display the Macros dialog, as shown below.       <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d18fc970c-pi"><img title="MacrosEmptyDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="262" alt="MacrosEmptyDialog" src="/assets/image_755771.jpg" width="354" border="0" /></a> </p>   </li>    <li>In the “Macros in” drop-down list select “Application Project” and choose the macro you want to run from the list, as shown below.      <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340134808d193a970c-pi"><img title="MacrosDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="262" alt="MacrosDialog" src="/assets/image_988100.jpg" width="354" border="0" /></a> </p>   </li>    <li>Click the “Run” button. </li> </ol>  <p></p>  <p>For some other ways to execute a macro see the post <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">Creating Buttons for VBA Macros</a>.</p>
