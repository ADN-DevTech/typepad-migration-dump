---
layout: "post"
title: "VBA Document Projects"
date: "2008-09-29 19:34:23"
author: "Adam Nagy"
categories:
  - "Beginning API"
  - "Brian"
  - "Visual Basic for Applications (VBA)"
original_url: "https://modthemachine.typepad.com/my_weblog/2008/09/vba-document-projects.html "
typepad_basename: "vba-document-projects"
typepad_status: "Publish"
---

<p>Inventor&#39;s implementation of VBA supports two types of VBA projects; document projects and external projects.&#0160; They&#39;re defined by where the project is saved.&#0160; Document VBA projects are saved within Inventor documents, parts, assemblies, etc.&#0160; External projects are saved as individual .ivb files.&#0160; Using the File tab of the Application Options dialog you can specify one external project to be loaded automatically when Inventor starts up.&#0160; This VBA project is frequently referred to as the <em>application project</em>.</p>
<p>When VBA was integrated into Inventor we looked at other VBA integrations for ideas.&#0160; All of the applications that supported VBA that I had used at the time all used the idea of document projects so it seemed like that was something we needed to provide as part of Inventor&#39;s implementation.&#0160; However, when I had used some of these applications that only had document projects I didn&#39;t like them because it made maintaining code almost impossible.&#0160; For example, I was writing a reasonably large program in one of the applications and it was stored within a document.&#0160; I would copy that document to use the program with other sets of data.&#0160; When I wanted to make a fix or enhancement to the program I had multiple copies of it and didn&#39;t know which version of the program existed where.&#0160; As a result of this frustration we also added support for external projects in Inventor&#39;s implementation of VBA.</p>
<p>A feature of the document macros that Word and Excel supported that seemed good was the idea of automatic macros.&#0160; These are macros with a particular name that are run automatically when something happens in the application.&#0160; For example, when a document is opened or saved a macro is run.&#0160; This functionality makes it very easy for someone with limited programming experience to write a simple macro to respond to these events in Inventor.</p>
<p>A couple of releases after we added VBA to Inventor we started getting reports of some problems.&#0160; The problem turned out to be a resource issue with VBA.&#0160; People were creating document projects that used automatic macros and were using these Inventor documents that contained these projects as their templates.&#0160; That meant that every file they created had a VBA document project.&#0160; When a large assembly is loaded all of the referenced documents are also loaded, and in the case of these documents also meant loading the embedded VBA projects.&#0160; It turns out that VBA has a limit to the number of VBA projects that can be loaded.</p>
<p>The other significant problem to having document macros in a template is that it creates the problem I already talked about of having your program duplicated in all your documents making it very difficult to fix or enhance that program.&#0160; There is also another problem that recently came up with document projects and 64 bit Inventor.</p>
<p>My advice is: <strong>DO NOT USE document projects</strong>.&#0160; The one exception to this is if you&#39;re writing a program that is very specific to a single document.&#0160; For example if you have a part and write a specific program to work with only that part.&#0160; In this case it&#39;s convenient to package the program with the document rather than worry about passing an additional file with it.</p>
<p>External VBA projects should provide most of the functionality you would want and also provide the additional capability that you can create toolbar buttons to run the macros contained within them.&#0160; What external VBA projects don&#39;t provide is the ability to do the equivalent of automatic macros.&#0160; The best answer for this is to create an Add-In.&#0160; (There have been some Add-In utilities written that add support for automatic macros to VBA external projects but I&#39;ve found for most people that these end up being confusing because they don&#39;t understand how they work and as a result don&#39;t know how to debug and diagnose problems when they occur.)&#0160; An Add-In allows you to do anything you could do in VBA and more.&#0160; The downside of an Add-In is that there&#39;s a higher learning curve to getting started.</p>
<p>In my next posting I&#39;ll cover what&#39;s required to create an Add-In that replaces an existing automatic macro.</p>
