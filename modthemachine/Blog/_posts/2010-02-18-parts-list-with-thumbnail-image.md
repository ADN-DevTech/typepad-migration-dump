---
layout: "post"
title: "Parts List with Thumbnail Image"
date: "2010-02-18 17:52:27"
author: "Adam Nagy"
categories:
  - "Brian"
  - "Drawings"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/02/parts-list-with-thumbnail-image.html "
typepad_basename: "parts-list-with-thumbnail-image"
typepad_status: "Publish"
---

<p>There was a recent question in the customization newsgroup about creating a parts list in Word or Excel that contained the thumbnail image for each part.&#0160; This seemed like an interesting problem to tackle.&#0160; Since a parts list is a table, Excel was the obvious first choice.&#0160; However, after playing with it a bit I found that Excel doesn’t support inserting pictures into cells and from what I found online is an enhancement coming in Office 2010.&#0160; I also found out that Word does allow you to insert pictures into table cells so that’s what I decided to use.</p>  <p>Below is an example of the result using one of the sample files that comes with Inventor.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e34970b-pi"><img alt="PartListThumbResult" border="0" height="442" src="/assets/image_579582.jpg" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="PartListThumbResult" width="454" /></a> </p>  <p>My initial code for this was a VBA macro but it was found to have a problem on 64-bit machines.&#0160; I’m leaving the original VBA version described below because it’s simpler and easier to understand the what’s going on.&#0160; It isn’t fancy but mostly does the job.&#0160; The new version is an add-in and will work on 32 and 64-bit machines.</p>  <p><strong>Add-In Version</strong>&#0160; <br />To use this version download this <a href="http://modthemachine.typepad.com/files/ThumbnailPartsList.zip">zip file</a>.&#0160; Inside the zip is a .exe and another zip file.&#0160; The .exe is an installer and running it will install the add-in.&#0160; It creates a new button on the Tools tab of the drawing ribbon.&#0160; If you’re using the classic UI then it adds a new button to the annotation panel bar.&#0160; The add-in is compatible with Inventor 2010.&#0160; The zip file contains the source code for the add-in, in case you’re interested in that.&#0160; It was written using Visual Basic Express 2008. </p>  <p><strong>VBA Version      <br /></strong>You can To use the program you need to copy and paste the <a href="http://modthemachine.typepad.com/files/PartsListThumbnail.txt">source code</a> into VBA.&#0160; I would recommend pasting it into your VBA application project, as shown below. </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e44970b-pi"><img alt="PasteMacroVBA" border="0" height="355" src="/assets/image_579910.jpg" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="PasteMacroVBA" width="454" /></a> </p>  <p>Since this program uses Word and drives it through the Word API, you need to add a reference to the Word Object Library.&#0160; You do this by using the <strong>References…</strong> command in the Tools menu within VBA.&#0160; You need to check the box next to “Microsoft Word 12.0 Object Library” as shown below.&#0160; (I received some feedback on the newsgroup that this will also work with Word 2002 with some small changes to the code, which I’ve made the linked source code.&#0160; There’s also a change so that it’s tolerant of files that don’t have a thumbnail.&#0160; Thanks to Cadfish1 from the autodesk.inventor.customization newsgroup for his input.)</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8b26e50970b-pi"><img alt="ReferenceWord" border="0" height="361" src="/assets/image_510312.jpg" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" title="ReferenceWord" width="453" /></a> </p>  <p>Now you’re all set.&#0160; You need to have a drawing open and the parts list selected that you want to write out and then you can run the program.&#0160; You run the program using the <strong>Macros</strong> command on the Tools tab of Inventor (which you can also access using Alt-F8).&#0160; Once it’s finished you should have a new Word document that contains the parts list table.</p>
