---
layout: "post"
title: "XML Ribbon Builder Design Pattern"
date: "2012-02-18 00:08:11"
author: "Wayne Brill"
categories: []
original_url: "https://modthemachine.typepad.com/my_weblog/2012/02/xml-ribbon-builder-design-pattern.html "
typepad_basename: "xml-ribbon-builder-design-pattern"
typepad_status: "Publish"
---

<p>We all want to be efficient in our code writing and using design patterns can help with this. A design pattern is utility code that will solve a commonly recurring task. For Inventor AddIns creating the ribbon elements is a common task that can be expedited by using a design pattern. My colleagues Jan Liska and Philippe Leefsma created this example design pattern named AdnRibbonBuilder. This is XML based and provides these advantages:</p>  <ul>   <li>Define Ribbon elements much faster and more easily </li>    <li>Generate the Ribbon items dynamically at loading </li>    <li>Use external XML that can be replaced or modified by user </li> </ul>  <p>To use this design pattern you add the AdnRibbonBuilder class to your project. This class has functions that will create the Ribbon elements by parsing an xml file. Once you have added the class to your project there are two things you need to do.</p>  <ol>   <li>Create the xml file with the settings that will be parsed. There are tags in the xml file that will allow you control where the ribbon element is created and what the ribbon element is. </li>    <li>Call the CreateRibbon or CreateRibbonFromFile methods of the AdnRibbonBuilder class from the Activate method of the AddIn. One of the CreateRibbon parameters is a string that is the name of a resource. (This resource is an embedded xml file). CreateRibbonFromFile takes a string that is a name of an xml file on disk. </li> </ol>  <p>Here is the xml code from the project in this <a href="http://modthemachine.typepad.com/RibbonByXML_Example.zip">zip file</a> that creates a button when it is parsed by AdnRibbonBuilder. Notice that it is going to add the button to the Modify panel on the Part ribbon. The Button will use the ButtonDefintion named Autodesk:RibbonVBTest:Button4. (This ButtonDefinition needs to be already created in the project before the xml file is parsed).</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RibbonTab</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">ribbons</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Part</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">id_TabModel</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">displayName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetTab</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RibbonPanel</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">id_PanelP_ModelModify</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">displayName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetPanel</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Button</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">internalName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Autodesk:RibbonVBTest:Button4</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">useLargeIcon</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">isInSlideout</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">targetControl</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;&quot;</span><span style="line-height: 140%; color: blue"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">insertBefore</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RibbonPanel</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RibbonTab</span><span style="line-height: 140%; color: blue">&gt;</span></p> </div>  <p>Below is the code from the attached project that calls CreateRibbonFromFile or CreateRibbon. Having the ability to use an xml file on disk makes it easy to create a different layout of the ribbon elements. If you want to try using the file, rename this file so the extension is only “xml”. (Ribbon_By_Xml_Example.ribbons.override.rename_to_just_xml) </p>  <p>The tags in the xml file cause the buttons to be created as a slide out instead of on the main ribbon.&#160; </p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">(</span><span style="line-height: 140%; color: red">isInSlideout</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">&quot;)</span></p> </div>  <p>If this xml file is found (this example is looking for it at the same location of the AddIn dll) it will be used instead of the xml resource.</p>  <p>Here is the code: </p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> asmName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160;&#160;&#160;&#160; Assembly</span><span style="line-height: 140%">.GetExecutingAssembly().GetName().Name</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (System.IO.</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (asmName + </span><span style="line-height: 140%; color: #a31515">&quot;.ribbons.override.xml&quot;</span><span style="line-height: 140%">)) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160; AdnRibbonBuilder</span><span style="line-height: 140%">.CreateRibbonFromFile(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Me</span><span style="line-height: 140%">.GetType,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; asmName + </span><span style="line-height: 140%; color: #a31515">&quot;.ribbons.override.xml&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">&#160;&#160; AdnRibbonBuilder</span><span style="line-height: 140%">.CreateRibbon(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Me</span><span style="line-height: 140%">.GetType,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;Ribbon_By_Xml_Example.Ribbons.xml&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p> </div>  <p>You can explore the AdnRibbonBuilder class to see how it creates the ribbon elements based on the tags in the xml file. The zip file with the project also has an xml file named ribbons_template.xml. This file has examples of xml tags that will create a few other ribbon elements. Here is the complete list of ribbon elements that AdnRibbonBuilder can create. (From the ProcessPanelNode Sub Procedure).</p>  <div style="font-family: courier new; background: #eeeeee; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Button&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessButtonNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Separator&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessSeparatorNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ButtonPopup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessButtonPopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Popup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessPopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ComboBox&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessComboBoxNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Gallery&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessGalleryNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Macro&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessMacroNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;SplitButton&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessSplitButtonNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;SplitButtonMRU&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; AddressOf</span><span style="line-height: 140%"> ProcessSplitButtonMRUNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;TogglePopup&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; processMethod = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Action</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RibbonPanel</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">XmlNode</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">AddressOf</span><span style="line-height: 140%"> ProcessTogglePopupNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Exit Select</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Case Else</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160; Continue For</span></p> </div>  <p>Wayne Brill</p>
