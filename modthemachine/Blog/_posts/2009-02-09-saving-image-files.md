---
layout: "post"
title: "Saving Image Files"
date: "2009-02-09 22:29:30"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2009/02/saving-image-files.html "
typepad_basename: "saving-image-files"
typepad_status: "Publish"
---

<p>This is somewhat of a follow-up posting to the previous <a href="http://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html" target="_blank">Translating Files with the API</a> posting since some might consider that saving an Inventor file as a .bmp or other type of image format is a form of translating that file.&#160; Here is some information specific to saving an image file.</p>  <p>If you have an Inventor file open and run the Save Copy As command you’ll notice that several of the file types shown are image files, as shown below.&#160; This is how you can interactively save an Inventor file as an image file.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c3970c-pi"><img title="SaveAsImage" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="254" alt="SaveAsImage" src="/assets/image_2050.jpg" width="404" border="0" /></a> </p>  <p>&#160;</p>  <p>The technique described in the <a href="http://modthemachine.typepad.com/my_weblog/2009/01/translating-files-with-the-api.html" target="_blank">Translating Files with the API</a> post that uses the SaveAs method will also work for image file types too.&#160; It has all of the same advantages and disadvantages as described in the posting; it’s easy to use but doesn’t provide access to the setting in the options dialog, which in this case allows you to specify the resolution of the output image.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678cc970c-pi"><img title="SaveImageOptions" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="194" alt="SaveImageOptions" src="/assets/image_72154.jpg" width="299" border="0" /></a> </p>  <p>   <br />    <br />When using the SaveAs method the output resolution will always be the current screen resolution.&#160; Here’s an example.</p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsBMP()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.</strong>       <br /></font>&#160;&#160;&#160; Dim oDoc As Document     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.activeDocument     <br />    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save a copy as a BMP file.</strong>       <br /></font>&#160;&#160;&#160; Call oDoc.SaveAs(&quot;C:\Temp\Test.bmp&quot;, True)     <br />End Sub</div>  <br />  <br />There aren’t translator add-ins for the image file formats so that option as described in the file translation posting will not work for image files.&#160; However, Inventor does support another way to save image files that does allow you to specify the output resolution.&#160; This is the View.SaveAsBitmap method.&#160; Here’s an example of using it to save a jpg file.  <p></p>  <p></p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsJPG()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active view.       <br /></strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oView as View    <br />&#160;&#160;&#160; Set oView = ThisApplication.ActiveView </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save the view as a jpg file.</strong>&#160; <br /></font>&#160;&#160;&#160; Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 700, 500)     <br />End Sub</div>  <br />  <br />There are a few things to understand when using this method.&#160; First is that it’s a method of the View object and not the Document object.&#160; In the API the View object represents a graphics window.&#160; This method is supported on the View object because you’re not saving the entire contents of a document, like you do when you use the other translators, but you’re capturing a snapshot of a specific view.&#160; It’s possible to display multiple windows for a document, as illustrated below.&#160; By choosing which view to call the SaveAsBitmap method on you can control which view is saved as an image file.  <p></p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340105371c1b72970b-pi"><img title="MultipleViews" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="293" alt="MultipleViews" src="/assets/image_857202.jpg" width="454" border="0" /></a> </p>  <p>&#160;</p>  <p>There are a couple of ways to access a View object through the API.&#160; One of the most common, and the one used in the sample above, is to use the ActiveView property of the Application object.&#160; This returns the view that the end-user is currently working on.&#160; Only one window is ever active at a time.&#160; The other method is to use the Views property of the Document object to access all of the views associated with a particular document.</p>  <p>The second thing to understand is how to specify the format of the image file you’re creating.&#160; This is done implicitly by the extension of the supplied filename.&#160; In the example above it will create a jpg file because the filename is “Test.jpg”.&#160; If “Test.bmp” had been used instead it would have created a bmp file.&#160; You can see the formats that Inventor supports by looking at the types shown in the “Save as type” dropdown in the Save Copy As dialog, as shown below.&#160; Inventor currently supports bmp, gif, jpg, png, and tiff files.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340111685678c3970c-pi"><img title="SaveAsImage" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="254" alt="SaveAsImage" src="/assets/image_2050.jpg" width="404" border="0" /></a>&#160; </p>  <p>&#160;</p>  <p>The final thing to understand is how to control the size, or resolution, of the output image.&#160; Unlike a screen capture, you’re not limited by the screen resolution.&#160; The two arguments following the filename are the height and width of the output image, where the size is specified as the number of pixels.&#160; You can provide zero as the argument value to indicate you want to use the current view size on the screen.&#160; For example, the following program will create a jpg file that is exactly the same size as the view on the screen.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Public Sub SaveAsJPG()    <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active view.       <br /></strong></font></div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;&#160;&#160; Dim oView as View    <br />&#160;&#160;&#160; Set oView = ThisApplication.ActiveView </div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">&#160;</div>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new"><font color="#0000ff"><strong>&#160;&#160;&#160; ' Save the view as a jpg file.</strong>&#160; <br /></font>&#160;&#160;&#160; Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 0, 0)     <br />End Sub</div>  <p>&#160;</p>  <p>You can also use a combination of values and zeros.&#160; This can be useful when you want a specific resolution but also want to maintain the same aspect ratio as the view.&#160; The example below will create a jpg that is 2000 pixels wide and the height will be computed by Inventor to be whatever’s necessary to maintain the view’s current height-width ratio.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">Call oView.SaveAsBitmap(&quot;C:\Temp\Test.jpg&quot;, 2000, 0)    <br /></div>
