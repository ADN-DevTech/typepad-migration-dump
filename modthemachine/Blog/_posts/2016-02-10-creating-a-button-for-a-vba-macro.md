---
layout: "post"
title: "Creating a Button for a VBA Macro"
date: "2016-02-10 01:45:20"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2016/02/creating-a-button-for-a-vba-macro.html "
typepad_basename: "creating-a-button-for-a-vba-macro"
typepad_status: "Publish"
---

<p>I had written a <a href="http://modthemachine.typepad.com/my_weblog/2008/11/creating-buttons-for-vba-macros.html">post many years ago</a> describing the process to do this but it was before the existence of the ribbon user interface and a few things have changed so I thought I would create a new post.</p>  <p>It’s fairly easy to create a button within the ribbon that will execute an existing VBA macro.&#160; In Inventor, have the ribbon that you want to insert your button displayed, right-click on the ribbon, and choose the “Customize User Commands…”. This will display the Customize dialog shown below. Choose “Macros” from the drop-down at the top of the command list. This will display all of your macros. Pick your macro and then click the “&gt;&gt;” button in the middle of the dialog. This will move that macro over to the right-hand side of the dialog. You can then choose if text should be displayed and if a large or small icon should be used. A new panel called “User Commands” will be added to the ribbon and it will contain buttons for the macros you’ve selected to give you one-click easy access to your program.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b7c8138102970b-pi"><img title="CustomizeRibbon" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="CustomizeRibbon" src="/assets/image_324807.jpg" width="749" height="419" /></a></p>  <p>When you do this a default icon is used. If you want a custom icon you need to create a 16x16 image for a small icon or a 32x32 image for a large icon. This currently must be a bmp type of image. The name of the image is important. In this example, my macro is called “TitleBlock”&#160; and the images for it are:</p>  <p>&#160;&#160;&#160; Module1.TitleBlock.Small.bmp</p>  <p>&#160;&#160;&#160; Module1.TitleBlock.Large.bmp </p>  <p>Where the name is “<i>ModuleName</i>.<i>MacroName</i>.<i>IconSize</i>.bmp” where IconSize can be “Small” or “Large”. The files need to be in the same directory as the VBA project file. You can find out that location on your system by looking at the “File” tab of the “Application Options” dialog, as shown below. On my computer this is “C:\Users\Public\Documents\Autodesk\Inventor 2016”.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d19da357970c-pi"><img title="DefaultVBAProject" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="DefaultVBAProject" src="/assets/image_407447.jpg" width="516" height="61" /></a></p>  <p>The other option to making your program easily accessible is to convert it to an add-in. This makes it very easy to share your program. You can deliver a set of files, or even an installer, and the receiver either copies the files to a specified location or just runs the installer. The next time they start Inventor they’ll see the new commands. If you get serious about writing programs you’ll want to start writing add-ins.</p>  <p>-Brian</p>
