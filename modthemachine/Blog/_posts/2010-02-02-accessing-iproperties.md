---
layout: "post"
title: "Accessing iProperties"
date: "2010-02-02 02:14:07"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/02/accessing-iproperties.html "
typepad_basename: "accessing-iproperties"
typepad_status: "Publish"
---

<p>Probably the most used area of Inventor’s API is iProperties and because of that it generates more questions than any other single area.&#160; I wanted to try and eliminate some of those questions by giving a brief overview of how to access iProperties that I hope will answer most questions.&#160; Because iProperties is relatively simple it’s also a very good introduction to Inventor’s API.&#160; In the example below we’ll look at what it takes to edit the value of the Part Number property.</p>  <p><font size="3"><strong>iProperty Object Model</strong>       <br /></font>When working with Inventor’s API you need to be aware of the <em>Object Model</em>.&#160; The object model describes the relationship between the various API objects and is used to understand how to gain access to a particular object.&#160; Inventor’s entire object model is quite large and can be a bit overwhelming, which can be seen below.&#160; (Click the picture to access the pdf file of the entire chart.)</p>  <p><a href="http://modthemachine.typepad.com/files/Inventor2010Model.pdf"><img title="FullObjectModel" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="295" alt="FullObjectModel" src="/assets/image_973261.jpg" width="454" border="0" /></a> </p>  <p>However, when programming with Inventor you don’t need to understand the entire object model, but just the portion of the model that you’re currently using.&#160; When working with iProperties you’ll be using a maximum of only six different objects.&#160; A simplified version of the object model for these six objects is shown below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846027e970b-pi"><img title="iPropertiesObjectModel" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="166" alt="iPropertiesObjectModel" src="/assets/image_196046.jpg" width="160" border="0" /></a> </p>  <p>The Application object is the top-level object and represents Inventor.&#160; From it you can get the Documents object which provides the ability to access any open documents and also to open documents and create new documents.&#160; The Document object represents any of the various Inventor documents, i.e. part, assembly, drawing, etc.&#160; From the object model chart we learn that the PropertySets object is accessed from a document.&#160; This implies that properties are owned by a document and each document has its own unique set.</p>  <p><font size="3"><strong>Accessing a Document        <br /></strong></font>There are several ways to access a specific document but for this example I’ll keep it simple by accessing the document that’s currently open for edit.&#160; This is also the most common way of accessing a document.&#160; You do this by using the ActiveDocument property of the Application object.&#160; Looking at the object model chart above, using this property takes you from the Application object and jumps directly to the Document object, bypassing the Documents object.&#160; The code for this is shown below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the active document.</strong></font>       <br />&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />End Sub</p> </div>  <p><font size="3"><strong>Accessing iProperties</strong></font>     <br />From each document you can access its associated iProperties.&#160; iProperties are organized in groups and the API provides access to these groups.&#160; The first iProperty related object is the PropertySets object.&#160; You can think of the PropertySets object as the equivalent to the iProperties dialog.&#160; It’s the top level that provides access to all iProperty information.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a8460285970b-pi"><img title="PropertySets" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="359" alt="PropertySets" src="/assets/image_355752.jpg" width="450" border="0" /></a> </p>  <p>The code below shows how to get the PropertySets object.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />End Sub</p> </div>  <p>The next object in the object model is the PropertySet object.&#160; You can think of this object as being equivalent to a tab in the iProperties dialog.&#160; </p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846028f970b-pi"><img title="PropertySet" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="357" alt="PropertySet" src="/assets/image_383726.jpg" width="450" border="0" /></a> </p>  <p>There’s a little more to worry about when accessing the PropertySet object because you have to specify which of the existing PropertySet objects you want.&#160; There are a few different ways to do this but I would recommend using the name of the PropertySet.&#160; This makes your code easier to read later.&#160; The names of the standard property sets are:</p>  <blockquote>   <p>Inventor Document Summary Information      <br />Inventor Summary Information       <br />Design Tracking Properties       <br />Inventor User Defined Properties</p> </blockquote>  <p>For this sample I want to get the value of the Part Number property.&#160; This is in the “Design Tracking Properties” property set (as determined by looking at the chart at the end of this post).&#160; The code below illustrates getting this property set by name.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />End Sub</p> </div>  <p>The next object is the Property object.&#160; This represents a specific property, as illustrated below.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a846029e970b-pi"><img title="Property" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="358" alt="Property" src="/assets/image_731890.jpg" width="450" border="0" /></a> </p>  <p>Properties are also identified by name.&#160; The code below demonstrates accessing the part number property.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />End Sub</p> </div>  <p>Once you have a Property object you can use its Value property to get its current value and to also set the value is you want to change the iProperty.&#160; The code below displays the part number of the active document in a message box.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Display the value.          <br /></strong></font>&#160;&#160;&#160; MsgBox &quot;The part number is: &quot; &amp; oPartNumiProp.Value       <br />End Sub</p> </div>  <p>This code changes the value of the part number property.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub SetiProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim oDoc As Document       <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the PropertySets object.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSets As PropertySets       <br />&#160;&#160;&#160; Set oPropSets = oDoc.PropertySets       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the design tracking property set.          <br /></strong></font>&#160;&#160;&#160; Dim oPropSet As PropertySet       <br />&#160;&#160;&#160; Set oPropSet = oPropSets.Item(&quot;Design Tracking Properties&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the part number iProperty.          <br /></strong></font>&#160;&#160;&#160; Dim oPartNumiProp As Property       <br />&#160;&#160;&#160; Set oPartNumiProp = oPropSet.Item(&quot;Part Number&quot;)       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Set the part number.          <br /></strong></font>&#160;&#160;&#160; oPartNumiProp.Value = &quot;SamplePart001&quot;       <br />End Sub</p> </div>  <p>Accessing an iProperty is simply of a matter of navigating down the object model to get to a specific Property object.&#160; The tricky parts is knowing which property set the property you want is located in, and knowing the name of that property set and the name of the property.&#160; The table below lists all of the standard property sets and the names of the properties they contain.&#160; This should provide all you need to access existing properties.&#160; In addition to the names, the chart also lists the type of each property.&#160; This is important when setting the value of a property so you know what type is expected.</p>  <table border="black"><tbody>     <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor Summary Information</b> </td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Author</td>        <td>String</td>     </tr>      <tr>       <td>Comments</td>        <td>String</td>     </tr>      <tr>       <td>Keywords</td>        <td>String</td>     </tr>      <tr>       <td>Last Saved By</td>        <td>String</td>     </tr>      <tr>       <td>Thumbnail</td>        <td>IPictureDisp</td>     </tr>      <tr>       <td>Revision Number</td>        <td>String</td>     </tr>      <tr>       <td>Subject</td>        <td>String</td>     </tr>      <tr>       <td>Title</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor Document Summary Information</b></td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Category</td>        <td>String</td>     </tr>      <tr>       <td>Company</td>        <td>String</td>     </tr>      <tr>       <td>Manager</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Design Tracking Properties</b></td>     </tr>      <tr>       <td align="center"><b>Property Name</b></td>        <td align="center"><b>Type</b></td>     </tr>      <tr>       <td>Authority</td>        <td>String</td>     </tr>      <tr>       <td>Catalog Web Link</td>        <td>String</td>     </tr>      <tr>       <td>Categories</td>        <td>String</td>     </tr>      <tr>       <td>Checked By</td>        <td>String</td>     </tr>      <tr>       <td>Cost</td>        <td>Currency</td>     </tr>      <tr>       <td>Cost Center</td>        <td>String</td>     </tr>      <tr>       <td>Creation Time</td>        <td>Date</td>     </tr>      <tr>       <td>Date Checked</td>        <td>Date</td>     </tr>      <tr>       <td>Defer Updates</td>        <td>Boolean</td>     </tr>      <tr>       <td>Description</td>        <td>String</td>     </tr>      <tr>       <td>Design Status</td>        <td>Long</td>     </tr>      <tr>       <td>Designer</td>        <td>String</td>     </tr>      <tr>       <td>Document SubType</td>        <td>String</td>     </tr>      <tr>       <td>Document SubType Name</td>        <td>String</td>     </tr>      <tr>       <td>Engineer</td>        <td>String</td>     </tr>      <tr>       <td>Engr Approved By</td>        <td>String</td>     </tr>      <tr>       <td>Engr Date Approved</td>        <td>Date</td>     </tr>      <tr>       <td>External Property Revision Id</td>        <td>String</td>     </tr>      <tr>       <td>Language</td>        <td>String</td>     </tr>      <tr>       <td>Manufacturer</td>        <td>String</td>     </tr>      <tr>       <td>Material</td>        <td>String</td>     </tr>      <tr>       <td>Mfg Approved By</td>        <td>String</td>     </tr>      <tr>       <td>Mfg Date Approved</td>        <td>Date</td>     </tr>      <tr>       <td>Parameterized Template</td>        <td>Boolean</td>     </tr>      <tr>       <td>Part Icon</td>        <td>IPictureDisp</td>     </tr>      <tr>       <td>Part Number</td>        <td>String</td>     </tr>      <tr>       <td>Part Property Revision Id</td>        <td>String</td>     </tr>      <tr>       <td>Project</td>        <td>String</td>     </tr>      <tr>       <td>Proxy Refresh Date</td>        <td>Date</td>     </tr>      <tr>       <td>Size Designation</td>        <td>String</td>     </tr>      <tr>       <td>Standard</td>        <td>String</td>     </tr>      <tr>       <td>Standard Revision</td>        <td>String</td>     </tr>      <tr>       <td>Standards Organization</td>        <td>String</td>     </tr>      <tr>       <td>Stock Number</td>        <td>String</td>     </tr>      <tr>       <td>Template Row</td>        <td>String</td>     </tr>      <tr>       <td>User Status</td>        <td>String</td>     </tr>      <tr>       <td>Vendor</td>        <td>String</td>     </tr>      <tr>       <td>Weld Material</td>        <td>String</td>     </tr>      <tr>       <td></td>     </tr>      <tr>       <td align="center" bgcolor="#c0c0c0" colspan="2"><b>Inventor User Defined Properties</b></td>     </tr>   </tbody></table>
