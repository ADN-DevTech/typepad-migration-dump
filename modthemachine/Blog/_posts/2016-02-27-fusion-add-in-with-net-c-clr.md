---
layout: "post"
title: "Fusion Add-In with .NET (C++ & CLR)"
date: "2016-02-27 00:44:09"
author: "Adam Nagy"
categories:
  - "Adam"
  - "Add-In Creation"
  - "C++"
  - "Fusion 360"
original_url: "https://modthemachine.typepad.com/my_weblog/2016/02/fusion-add-in-with-net-c-clr.html "
typepad_basename: "fusion-add-in-with-net-c-clr"
typepad_status: "Publish"
---

<p>I&#39;ve&#0160;written about <a href="http://modthemachine.typepad.com/my_weblog/2016/02/fusion-add-in-with-mfc.html">using <strong>MFC</strong> from a <strong>C++</strong> <strong>Fusion</strong> add-in</a>. You could also use .<strong>NET</strong> from your add-in, and it&#39;s even simpler to set up.</p>
<p>1) Create a <strong>C++</strong> add-in inside the&#0160;&quot;<strong>Scripts and Add-Ins</strong>&quot; <strong>Fusion&#0160;</strong>dialog:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f5a6970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="CreateAddIn" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f5a6970c img-responsive" src="/assets/image_105256.jpg" title="CreateAddIn" /></a></p>
<p>I&#39;m leaving&#0160;&quot;<strong>Run on&#0160;Startup</strong>&quot; option&#0160;above <strong>unchecked</strong>,&#0160;because it would not be a good idea to pop up a modal dialog while <strong>Fusion</strong> is starting up. That would halt the startup process.</p>
<p>2) Open it for edit:</p>
<p><a class="asset-img-link" href="http://a2.typepad.com/6a0112791b8fe628a401bb08bfa202970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="EditAddIn" class="asset  asset-image at-xid-6a0112791b8fe628a401bb08bfa202970d img-responsive" src="/assets/image_508691.jpg" title="EditAddIn" /></a></p>
<p>3) Add &quot;<strong>Common Language Runtime Support</strong>&quot; in your <strong>C++</strong> project&#39;s <strong>Properties</strong> dialog</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bf9f67970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="ClrSupport" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bf9f67970d img-responsive" src="/assets/image_749756.jpg" title="ClrSupport" /></a></p>
<p>4) Place the <strong>Fusion</strong> related code inside a&#0160;<span style="background: #ffffff; color: #0000ff;">#pragma</span> <span style="background: #ffffff; color: #0000ff;">unmanaged</span>&#0160;/<span style="background: #ffffff; color: #0000ff;">#pragma</span> <span style="background: #ffffff; color: #0000ff;">managed&#0160;</span>block</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa0b1970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="PragmaUnmanaged" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bfa0b1970d img-responsive" src="/assets/image_651143.jpg" title="PragmaUnmanaged" /></a></p>
<p>5) Add a &quot;<strong>Windows Form</strong>&quot; through &quot;<strong>PROJECT</strong>&quot; &gt;&gt; &quot;<strong>Add New Item...</strong>&quot;</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401bb08bfa110970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="WindowsForm" class="asset  asset-image at-xid-6a00e553fcbfc6883401bb08bfa110970d img-responsive" src="/assets/image_397688.jpg" title="WindowsForm" /></a></p>
<p>Note: You can add any of the <strong>.NET Form</strong> controls to it as in case of a <strong>C#</strong> or <strong>VB.NET</strong> project. I&#39;ve just added a list box for testing and filled it with items.</p>
<p>6) Create a function to show this dialog</p>
<p>a) In &quot;<strong>MyForm.h</strong>&quot; declare&#0160;<strong>showDialog</strong>()</p>
<p><a class="asset-img-link" href="http://a3.typepad.com/6a0112791b8fe628a401bb08bfa213970d-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyFormH" class="asset  asset-image at-xid-6a0112791b8fe628a401bb08bfa213970d img-responsive" src="/assets/image_947956.jpg" title="MyFormH" /></a></p>
<p>b) In &quot;<strong>MyForm.cpp</strong>&quot; implement the function</p>
<p><a class="asset-img-link" href="http://a0.typepad.com/6a0112791b8fe628a401b8d1a4f7b8970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyFormCpp" class="asset  asset-image at-xid-6a0112791b8fe628a401b8d1a4f7b8970c img-responsive" src="/assets/image_926240.jpg" title="MyFormCpp" /></a></p>
<p>7) Now we can call it from the&#0160;startup function called <strong>run</strong>()</p>
<p>a) Add&#0160;<span style="background: #ffffff; color: #0000ff;">#include</span> <span style="background: #ffffff; color: #a31515;">&quot;MyForm.h&quot;</span>&#0160;to the top of &quot;<strong>CustomNetUi.cpp</strong>&quot;</p>
<p>b) Call <strong>showDialog</strong>() from <strong>run</strong>()</p>
<div style="line-height: 120%; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #a31515;">&quot;C&quot;</span> <span style="background: #ffffff; color: #6f008a;">XI_EXPORT</span> <span style="background: #ffffff; color: #0000ff;">bool</span><span style="background: #ffffff; color: #000000;"> run(</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">char</span><span style="background: #ffffff; color: #000000;">* </span><span style="background: #ffffff; color: #808080;">context</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; app = </span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">::get();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!app)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; ui = app-&gt;userInterface();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (!ui)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; showDialog();</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>8) Test the&#0160;app by running it from the&#0160;&quot;<strong>Scripts and Add-Ins</strong>&quot; <strong>Fusion&#0160;</strong>dialog:</p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f96f970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="RunAddIn" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f96f970c img-responsive" src="/assets/image_739467.jpg" title="RunAddIn" /></a></p>
<p><a class="asset-img-link" href="http://modthemachine.typepad.com/.a/6a00e553fcbfc6883401b8d1a4f976970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="AddInForm" class="asset  asset-image at-xid-6a00e553fcbfc6883401b8d1a4f976970c img-responsive" src="/assets/image_309514.jpg" title="AddInForm" /></a></p>
<p>The sample project can be found here:<br /><a href="https://github.com/AutodeskFusion360/NativeUI">https://github.com/AutodeskFusion360/NativeUI</a></p>
<p>-Adam</p>
