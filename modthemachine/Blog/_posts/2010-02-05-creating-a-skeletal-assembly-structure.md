---
layout: "post"
title: "Creating a Skeletal Assembly Structure"
date: "2010-02-05 23:59:05"
author: "Adam Nagy"
categories:
  - "Assemblies"
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/02/creating-a-skeletal-assembly-structure.html "
typepad_basename: "creating-a-skeletal-assembly-structure"
typepad_status: "Publish"
---

<p>I wrote a program several months ago that I was reminded of when writing the post about <a href="http://modthemachine.typepad.com/my_weblog/2010/01/exporting-assembly-structure-to-excel.html">exporting an assembly structure to Excel</a>.&#160; This program does somewhat the opposite.&#160; It creates an assembly based on the structure defined by an input file. All parts and subassemblies are created by the program and assembled as defined by the input file. The parts are empty parts created using the default template file. You can optionally specify iProperty values for each assembly and part. You can then create the geometry for each of the parts to complete the assembly.&#160; </p>  <p>I’m not sure how many people will find this useful but thought I would make it available in case it can benefit someone.</p>  <p>I chose to use XML as the way of defining the assembly structure since it provides a better way to define structure than Excel.&#160; However, it would be fairly easy to convert this to use Excel or to write an Excel macro that would write out an Excel sheet into the required XML format.</p>  <p><strong>Using the Program      <br /></strong>To use the program execute BuildAssemblyStructure.exe, (typically by double-clicking on the program in Explorer). The dialog below is displayed. In the top field specify the xml file that defines the structure of the assembly you want to create. The lower field defines the path where the parts and assemblies will be created. Once the two fields are defined, click the Create Assembly button to start the creation of the assembly. Inventor must already be running.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340120a86815a7970b-pi"><img title="BuildAssemblyStructureDialog" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="155" alt="BuildAssemblyStructureDialog" src="/assets/image_12339.jpg" width="454" border="0" /></a> </p>  <p>After the program has completed running the defined assembly will be open in Inventor. None of the files will have been saved to disk yet. Saving the assembly will prompt you to save all of the related files too. Closing the assembly without saving will result in no files being created.</p>  <p><strong>XML Format      <br /></strong>If you’ve never used XML before, don’t worry about having to learn a new complicated language. It’s an ASCII file with a .xml extension that you can create using Notepad or any other ASCII editor you’re familiar with and is just a standardized way of structuring data.&#160; Here’s a quick overview of XML.</p>  <p>An XML document contains one or more <em>elements</em>.&#160; Below is an example of an element.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;ElementName&gt;      <br />This is some text within the ElementName element.       <br />&lt;/ElementName&gt;</p> </div>  <p>The element consists of two <em>tags</em>, an opening tag which is the element name conntained within the less than (&lt;) and greater-than (&gt;) signs and a closing tag which is the same except there is a forward slash (/) in front of the element name.&#160; All elements must have an opening and closing tag.&#160; A common mistake is to forget the closing tag.</p>  <p>Elements can also have <em>attributes</em>, as shown in the example below:</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly.iam'&gt;</p> </div>  <p>The attribute is specified within the opening tag and in his example is called “Filename”.&#160; It has a value of “Assembly.iam” which is contained within single or double quotes.</p>  <p>Elements can also be nested as in the example below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly.iam'&gt;      <br />&#160;&#160;&#160; &lt;Assembly Filename=’SubAssembly.iam’&gt;       <br />&#160;&#160;&#160; &lt;/Assembly&gt;       <br />&lt;/Assembly&gt;</p> </div>  <p>The nesting is defined by the fact that the second Assembly element is within the first Assembly element.&#160; The indenting of the lines doesn’t define the nesting but makes it easier for humans to read and edit.</p>  <p>That’s about all you need to know about XML to create a file to use with this program.&#160; Here’s an example of the format expected by this program.&#160; It describes the structure of the XML to create parts and assembly and also define any iProperties. </p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>&lt;Assembly Filename='Assembly01.iam'&gt;      <br />&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;Designer&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;Spock&lt;/Value&gt;       <br />&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;Assembly Filename='Assembly02.iam'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;Designer&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;Capt. Kirk&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Part Filename='Part01.ipt'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Part&gt;       <br />&#160;&#160;&#160; &lt;/Assembly&gt;       <br />&#160;&#160;&#160; &lt;Part Filename='Part01.ipt'&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Property&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Name&gt;DeliveryDate&lt;/Name&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Value&gt;12/18/08&lt;/Value&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Type&gt;Date&lt;/Type&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/Property&gt;       <br />&#160;&#160;&#160; &lt;/Part&gt;       <br />&lt;/Assembly&gt;</p> </div>  <p>The first line defines the opening tag of an Assembly element. This will be the top-level assembly document. There is a closing tag for the element at the bottom of the file.</p>  <p>The second line begins a Property element. This will define the values for any properties of the assembly. In this case there are two nested elements that will set the property called “Designer” to the value “Spock”. There is a closing tag for the property. Each property value defined is contained within its own Property element. This is demonstrated by the next set of lines that begins another Property element and sets the property named “DeliveryDate” to have a value of Dec. 18, 2008.</p>  <p>The second property, DeliveryDate, has a Type element whereas the first property does not. This is because the first property set, “Designer”, is a standard property and its type is defined by Inventor. The second property “DeliverDate” is not a standard property so the program will create a custom property for it and set its type to be whatever is specified by this element. If the custom property already exists, the type value is ignored and the value is set using the specified value. The names of the standard iProperties are listed below.</p>  <p>The next element is another Assembly element. This will result in the creation of a subassembly. Within this Assembly element there is a Property element that will set a property value for this subassembly. There is also a Part element that will create a part within this assembly. The part also has a Property element to set a property within it.</p>  <p>Finally, there is another Part element that defines a part within the top-level assembly. There is no limit to number of the parts or assemblies that can be defined or the number of levels of subassemblies.</p>  <p><b>Standard Properties      <br /></b>The following are the names and types of the standard iProperties that can be set. If you specify any other name besides these a custom property will be created.</p>  <blockquote>   <p>Title, String      <br />Subject, String       <br />Author, String       <br />Keywords, String       <br />Comments, String       <br />Revision Number, String       <br />Category, String       <br />Manager, String       <br />Company, String       <br />Creation Time, String       <br />Part Number, String       <br />Project, String       <br />Cost Center, String       <br />Checked By, String       <br />Date Checked, String       <br />Engr Approved By, String       <br />Engr Date Approved, Date       <br />User Status, String       <br />Catalog Web Link, String       <br />Description, String       <br />Vendor, String       <br />Mfg Approved By, String       <br />Mfg Date Approved, Date       <br />Cost, Currency       <br />Designer, String       <br />Engineer, String       <br />Authority, String       <br />Standard Revision, String       <br />Stock Number, String</p> </blockquote>  <p>You can download the program and source code here.&#160; Feel free to use and modify it to fit your specific needs. It was written using Visual Basic 2008 Express and is compatible with Inventor 2009 and later.</p>  <p><a href="http://modthemachine.typepad.com/files/BuildAssemblyStructure.zip">Assembly Structure Program</a>     <br /><a href="http://modthemachine.typepad.com/files/BuildAssemblyStructureSource.zip">Assembly Structure Source</a></p>
