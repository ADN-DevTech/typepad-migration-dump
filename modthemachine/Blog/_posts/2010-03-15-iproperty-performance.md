---
layout: "post"
title: "iProperty Performance"
date: "2010-03-15 23:50:33"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/03/iproperty-performance.html "
typepad_basename: "iproperty-performance"
typepad_status: "Publish"
---

<p>Here’s some performance data regarding using Inventor and Apprentice to work with iProperties.&#160; I found this interesting and think it will be useful when architecting your programs so you fully understand the advantages and disadvantages of different approaches.</p>  <p>All of the test results shown below are for processing 1000 unique files.</p>  <p><strong>Test 1 – Open, Edit, Save, Close      <br /></strong>This test opened each of the 1000 files, edited the value of two iProperties, saved the document, and closed it.</p>  <ol>   <li>Apprentice – 116 seconds. </li>    <li>Inventor (visible document) – 1068 seconds.&#160; This test opened the documents visibly by setting the second argument of the Documents.Open method to True. </li>    <li>Inventor (invisible document) – 238 seconds.&#160; This is the same as the test above but opens the documents invisibly by setting the second argument of the Documents.Open method to False. </li> </ol>  <p>The biggest difference is between opening the document visibly or invisibly.&#160; When a document is opened invisibly, Inventor is able to optimize the open and not read all of the file.&#160; Opening a file invisibly is similar to the time it takes in Apprentice, as shown by test 2 below.&#160; However, for test 1 Apprentice is still twice as fast.&#160; Two things account for the extra time spent by Inventor; changing the property value and saving the document.&#160; Changing the value of an iProperty in Inventor is transacted, meaning that you can undo the operation.&#160; Transacting has some overhead which accounts for some of the time.&#160; Apprentice doesn’t have any transaction capabilities so it doesn’t have this overhead.&#160; The other big difference is the save.&#160; To save an iProperty change in Inventor you need to save the entire document using Document.Save.&#160; In Apprentice you can save just the iProperty portion of the document using PropertySets.FlushToFile.</p>  <p><strong>Test 2 – Open, Read, Close</strong>     <br />This test also operated on all 1000 files by opening a file, reading property values, and closing the document.</p>  <ol>   <li>Apprentice – 92.341 seconds </li>    <li>Inventor (invisible document) – 100.374 seconds </li> </ol>  <p>These numbers show that there isn’t a lot of difference between invisible Inventor and Apprentice when you don’t do anything that’s transacted and you don’t save the document.&#160; This is particularly important for add-in writers to understand since you can’t use Apprentice within an add-in.</p>  <p><strong>Test 3 – Open, Close      <br /></strong>This test uses VB.Net to open and close the same 1000 files.&#160; It opens a file, reads the file into memory, and closes the file.&#160; It is a pure VB.Net program and has nothing to do with Inventor.&#160; I wrote this program to help understand how much of the time is spent on general overhead of reading the file and how much time is spent by Inventor or Apprentice actually doing the work they need to do.&#160; As you can see, most of the time used by Apprentice or Inventor is system overhead of opening and reading the file.&#160; Anytime you have to read or write data to a hard drive, performance will be slow.</p>  <ol>   <li>VB.Net – 77.69 seconds </li> </ol>  <p><strong>Summary      <br /></strong>If you need to write a utility to manipulate iProperties, using Apprentice will allow you to create the fastest program.&#160; However, if you just need to read iProperty data, opening documents invisibly in Inventor is almost as fast and a good alternative.&#160; Remember that Apprentice cannot be used within an add-in.&#160; If you need to do a lot of iProperty processing (writing and saving) through an add-in it might be worth creating a separate exe that uses apprentice that your add-in uses.&#160; You need to be careful that those documents are not currently open in Inventor.</p>  <p><strong>Gotcha</strong>     <br />Here’s something to watch out for when doing any timing tests like those above.&#160; The first time I ran a test it was slow and subsequent runs were significantly faster.&#160; For example, when I first ran test 2 with Inventor it took 100 seconds and then running the same test a second time only took 4 seconds.&#160; Even test 3, which doesn’t have anything to do with Inventor went from 77 seconds for the first run down to 0.338 seconds for subsequent runs.&#160; What’s happening is that Windows is caching data in memory in case the data is used again.&#160; This is great if you are reusing data but I think in most workflows where you’re batch reading and updating iProperties this won’t be the case.&#160; To get the times reported above I rebooted between each test to clear memory and force the data to be read from disk.</p>
