---
layout: "post"
title: "Working with Filenames"
date: "2010-05-04 17:44:21"
author: "Adam Nagy"
categories:
  - "Brian"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/05/working-with-filenames.html "
typepad_basename: "working-with-filenames"
typepad_status: "Publish"
---

<p>It’s common to need to manipulate filenames within a program.&#160; When using VBA there’s very little built-in functionality to help with this.&#160; When using VB.Net I had assumed I needed to do the same thing there that I had been doing in VBA.&#160; It wasn’t until fairly recently that I discovered a set of utilities in the .Net Framework that makes working with filenames much easier. </p>  <p>The .Net Framework is one of the huge advantages of doing development with any of the .Net languages.&#160; Especially compared to VBA which has very little built-in functionality.&#160; As I find things in the .Net Framework I find useful I’ll add blog posts in case some of you are like me and are still discovering its capabilities.</p>  <p>For those of you using VBA, here are some functions that I wrote to work with filenames.&#160; Using these I can extract the various bits of a filename and piece it back together to get the new filename I need.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p><font color="#0000ff"><strong>' Return the path of the input filename.          <br /></strong></font>Public Function FilePath(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the path by getting everything up to and          <br />&#160;&#160;&#160; ' including the last backslash &quot;\&quot;.           <br /></strong></font>&#160;&#160;&#160; FilePath = Left$(fullFilename, InStrRev(fullFilename, &quot;\&quot;) - 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the name of the file, without the path.          <br /></strong></font>Public Function Filename(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everything to          <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Filename = Right$(fullFilename, Len(fullFilename) – _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the base name of the input filename, without          <br />' the path or the extension.           <br /></strong></font>Public Function BaseFilename(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everttgubg to          <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Dim temp As String       <br />&#160;&#160;&#160; temp = Right$(fullFilename, Len(fullFilename) – _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />      <br />&#160;&#160;&#160; <font color="#0000ff"><strong>' Get the base filename by getting everything to          <br />&#160;&#160;&#160; ' the left of the last period &quot;.&quot;.           <br /></strong></font>&#160;&#160;&#160; BaseFilename = Left$(temp, InStrRev(temp, &quot;.&quot;) - 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Return the extension of the input filename.          <br /></strong></font>Public Function FileExtension(ByVal fullFilename As String) As String       <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Extract the filename by getting everthing to&#160; <br />&#160;&#160;&#160; ' the right of the last backslash.           <br /></strong></font>&#160;&#160;&#160; Dim temp As String       <br />&#160;&#160;&#160; temp = Right$(fullFilename, Len(fullFilename) – _       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InStrRev(fullFilename, &quot;\&quot;))       <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the base filename by getting everything to          <br />&#160;&#160;&#160; ' the right of the last period &quot;.&quot;.           <br /></strong></font>&#160;&#160;&#160; FileExtension = Right$(temp, Len(temp) - InStrRev(temp, &quot;.&quot;) + 1)       <br />End Function       <br />      <br />      <br /><font color="#0000ff"><strong>' Test the filename functions.</strong></font>       <br />Public Sub TestFileFunctionsVBA()       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = &quot;C:\Samples\Models\Parts\OilPan\OilPan.ipt&quot;       <br />&#160;&#160;&#160; Debug.Print FilePath(fullFilename)       <br />&#160;&#160;&#160; Debug.Print Filename(fullFilename)       <br />&#160;&#160;&#160; Debug.Print BaseFilename(fullFilename)       <br />&#160;&#160;&#160; Debug.Print FileExtension(fullFilename)       <br />End Sub</p> </div>  <p>Below are the results as seen in the Immediate window.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">C:\Samples\Models\Parts\OilPan    <br />OilPan.ipt     <br />OilPan     <br />.ipt     <br /></div>  <p>Using VB.Net this is all much easier.&#160; The .Net Framework supports the IO class which has a lot of file related functionality.&#160; For working with file paths the IO class provides access to the Path class.&#160; Below is a VB.Net function that does the same thing as the VBA code above but it uses .Net Framework functions instead of custom functions.&#160; You’ll need to use the Imports statement for System.IO or specify the full namespace path as demonstrated in the GetDirectoryName call below.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Imports System.IO      <br />      <br /><font color="#0000ff"><strong>' Test the .Net Framework Path functions.         <br /></strong></font>Public Sub TestFileFunctionsVBNet()       <br />&#160;&#160;&#160; Dim fullFilename As String       <br />&#160;&#160;&#160; fullFilename = &quot;C:\Samples\Models\Parts\OilPan\OilPan.ipt&quot;       <br />&#160;&#160;&#160; Debug.Print(System.IO.Path.GetDirectoryName(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetFileName(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetFileNameWithoutExtension(fullFilename))       <br />&#160;&#160;&#160; Debug.Print(Path.GetExtension(fullFilename))       <br />End Sub </p> </div>  <p>As you can see the results are identical to the VBA sample without having to write the custom functions.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>C:\Samples\Models\Parts\OilPan      <br />OilPan.ipt       <br />OilPan       <br />.ipt</p> </div>
