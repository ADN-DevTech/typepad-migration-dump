---
layout: "post"
title: "Creating Custom Property Sets and iProperties"
date: "2010-04-28 00:21:50"
author: "Adam Nagy"
categories:
  - "Brian"
  - "iProperties"
original_url: "https://modthemachine.typepad.com/my_weblog/2010/04/creating-custom-property-sets-and-iproperties.html "
typepad_basename: "creating-custom-property-sets-and-iproperties"
typepad_status: "Publish"
---

<p>In all previous iProperty related posts I’ve only talked about working with the four public property sets; Design Tracking, Summary Info, Document Summary Info, and User Defined.&#160; The first three of these contain a fixed number of properties while the user defined allows you to add and delete your own properties.&#160; This mirrors the iProperty functionality that’s available through Inventor’s user-interface.</p>  <p>Using the API it’s possible to create new property sets in addition to these standard four.&#160; A property set created using the API is not visible through the user-interface.&#160; For example, it does not automatically create a new tab in the iProperty dialog.&#160; It is only accessible through the API.&#160; The code below creates a new property set named “MyStuff” and a property named “Favorite Fruit”.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub CreatePropertySet()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument      <br />      <br />&#160;<font color="#0000ff"><strong>&#160;&#160; ' Create a new property set.          <br /></strong></font>&#160;&#160;&#160; Dim customSet As PropertySet       <br />&#160;&#160;&#160; Set customSet = doc.PropertySets.Add(&quot;My Stuff&quot;)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Add a property.          <br /></strong></font>&#160;&#160;&#160; Call customSet.Add(&quot;Banana&quot;, &quot;Favorite Fruit&quot;)       <br />End Sub</p> </div>  <p>Here’s some sample code that accesses and reads the value of the property created above.</p>  <div style="font-size: 8pt; background: #eeeeee; color: black; line-height: 140%; font-family: courier new">   <p>Public Sub ReadProperty()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the active document.          <br /></strong></font>&#160;&#160;&#160; Dim doc As Document       <br />&#160;&#160;&#160; Set doc = ThisApplication.ActiveDocument      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the custom property set.          <br /></strong></font>&#160;&#160;&#160; Dim customSet As PropertySet       <br />&#160;&#160;&#160; Set customSet = doc.PropertySets.Item(&quot;My Stuff&quot;)      <br />      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Get the value of the &quot;Favorite Fruit&quot; property.          <br /></strong></font>&#160;&#160;&#160; Dim fruit As String       <br />&#160;&#160;&#160; fruit = customSet.Item(&quot;Favorite Fruit&quot;).value       <br />&#160;&#160;&#160; MsgBox &quot;The favorite fruit is: &quot; &amp; fruit       <br />End Sub</p> </div>  <p>Hopefully you can see that working with these custom property sets is not any different than working with the standard property sets.&#160; It’s likely that you won’t ever&#160; need for this capability but sometimes it can come in handy.&#160; The primary use is when you need to store additional data with a file.&#160; iProperties especially make sense when you want to be able to access this information from Apprentice.&#160; An example of where Inventor uses this functionality is Content Center.&#160; Content Center adds an new property set to the parts it creates and uses the property set to store information about the part.</p>  <p>A useful tool when working with iProperties is a sample program that’s delivered with the Inventor SDK.&#160; Assuming you’ve installed the developer tools using the DeveloperTools.msi in the SDK directory, you’ll find the following directory:</p>  <p><font face="Arial Narrow">SDK\DeveloperTools\Samples\VB\Standalone Applications\ApprenticeServer\Properties</font></p>  <p>It’s an old VB6 sample, but you can use the EXE without having VB6.&#160; When you run the EXE, the dialog below is displayed.&#160; You use the button at the top to browse to any Inventor file.&#160; The property sets and properties are then displayed in the dialog and you can double-click on most properties to edit them.&#160; I use tool anytime I want to know about all of the iProperties in a document.</p>  <p><a href="http://modthemachine.typepad.com/.a/6a00e553fcbfc688340133ed00d537970b-pi"><img title="PropertyViewer" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="328" alt="PropertyViewer" src="/assets/image_891557.jpg" width="454" border="0" /></a></p>
