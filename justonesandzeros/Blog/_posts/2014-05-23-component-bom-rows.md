---
layout: "post"
title: "Component BOM Rows"
date: "2014-05-23 09:31:58"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
  - "Vault"
original_url: "https://justonesandzeros.typepad.com/blog/2014/05/component-bom-rows.html "
typepad_basename: "component-bom-rows"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/Vault4.png" /> <br /><img alt="" src="/assets/TipsAndTricks4.png" /></p>
<p>Previously, I talked about how to <a href="http://justonesandzeros.typepad.com/blog/2014/04/disabling-and-enabling-bom-rows.html" target="_blank">disable and re-enable a BOM row</a>, but that’s only half the story.&#0160; There are actually 2 types of “off” BOM rows.&#0160; The type I discussed earlier is an Item that has been disabled.&#0160; The other type is a <strong>Component BOM Row</strong>, which means that the child is not a real Item.&#0160; Components have the potential to be an Item, but are not quite there yet.&#0160;</p>
<hr noshade="noshade" style="color: #d09219;" />
<p><strong>Reading the Unassigned Component rows</strong></p>
<p>When calling GetItemBOMByItemIdAndDate, make sure your the BOMViewEditOptions includes <strong>ReturnUnassignedComponents</strong>.&#0160; If not, then the Component rows will be omitted.&#0160; When you get back the ItemBOM, the BOMCompArray is where you can find the Component objects.&#0160; The BOM rows themselves are represented by objects the ItemAssocArray.&#0160; This array contains both Item-to-Item and Item-to-Component links.&#0160; So you need to account for both cases when reading ItemAssoc objects.</p>
<p>In the case of an Item-Component link, the BOMCompId will have a valid value but CldItemID and CldItemMasterID will be 0.&#0160; The parent will always be an Item, so ParItemID and ParItemMasterID will have a valid value in all cases.&#0160; There is no such thing as a Component-to-Component link in an Item BOM.</p>
<hr noshade="noshade" style="color: #d09219;" />
<p><strong>Turing on the component BOM row</strong></p>
<p>If you have a Component row that you want to enable, there are several steps.&#0160; You have to promote the Component into an Item.&#0160; Then you need to update the BOM association so that it points to the Item instead of the Component.</p>
<p>I’d better just post some sample code for this one.&#0160; Here is a function to enable a single component BOM row.</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// C#</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">public</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">void</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> EnableComponentBOMRow(</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">Item</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> parentItem, </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">string</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> componentName)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemService</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> itemSvc =</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; connection.WebServiceManager.ItemService;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// put the parent item in edit mode</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">Item</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> editableItem = itemSvc.EditItems(</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">long</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {parentItem.RevId}).First();</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// read the BOM data</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemBOM</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> bom = itemSvc.GetItemBOMByItemIdAndDate(</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">editableItem.Id, </span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">DateTime</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">.MinValue, </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMTyp</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.Tip,</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMViewEditOptions</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.Defaults |</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMViewEditOptions</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.ReturnExcluded |</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMViewEditOptions</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.ReturnUnassignedComponents);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// locate the component we want to enable</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMComp</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> component = bom.BOMCompArray.FirstOrDefault(n =&gt; </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">n.Name == componentName);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// promote the component</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.AddComponentsToPromote(</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">long</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {component.Id}, </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemAssignAll</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">.Default, </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">false</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">DateTime</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">GetPromoteOrderResults</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> orderResult = </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.GetPromoteComponentOrder(</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">out</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.PromoteComponents(timestamp,</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; orderResult.PrimaryArray);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemsAndFiles</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> promoteResult = </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.GetPromoteComponentsResults(timestamp);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// update the BOM link to point to the Item </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">&#0160;&#0160;&#0160; // instead of the Component</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemAssoc</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> bomLink = bom.ItemAssocArray.First(n =&gt; </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">n.ParItemID == editableItem.Id &amp;&amp; </span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">n.BOMCompId == component.Id);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.UpdateItemBOMAssociations(</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">editableItem.Id, </span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">long</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {bomLink.Id},</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">long</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {promoteResult.ItemRevArray[0].Id}, </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">double</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {bomLink.Quant},</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">bool</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {bomLink.IsStatic}, </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">bool</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> [] {</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">true</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">}, </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">int</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {bomLink.BOMOrder},</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">string</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> [] {bomLink.PositionNum},</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMEditAction</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> [] {</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMEditAction</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.Update}, </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">BOMViewEditOptions</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">.ReturnBOMFragmentsOnEdits);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">// commit changes to the the parent item and </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #008000;">&#0160;&#0160;&#0160; // the newly promoted item</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">List</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">&lt;</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">Item</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">&gt; itemsToCommit = </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">new</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">List</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">&lt;</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">Item</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">&gt;();</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemsToCommit.Add(editableItem);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemsToCommit.AddRange(promoteResult.ItemRevArray);</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.UpdateAndCommitItems(itemsToCommit.ToArray());</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt; line-height: 13pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">&#39; VB.NET</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Public</span></span></span><span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> EnableComponentBOMRow(parentItem </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">Item</span></span><span style="color: #000000;">, componentName </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> itemSvc </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">ItemService</span></span><span style="color: #000000;"> = connection.WebServiceManager.ItemService</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; put the parent item in edit mode</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> editableItem </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">Item</span></span><span style="color: #000000;"> = itemSvc.EditItems(</span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() {parentItem.RevId}).First()</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; read the BOM data</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> bom </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">ItemBOM</span></span><span style="color: #000000;"> = itemSvc.GetItemBOMByItemIdAndDate(editableItem.Id, </span><span><span style="color: #2b91af;">DateTime</span></span><span style="color: #000000;">.MinValue, </span><span><span style="color: #2b91af;">BOMTyp</span></span><span style="color: #000000;">.Tip, </span><span><span style="color: #2b91af;">BOMViewEditOptions</span></span><span style="color: #000000;">.Defaults </span><span><span style="color: #0000ff;">Or</span></span><span><span style="color: #2b91af;">BOMViewEditOptions</span></span><span style="color: #000000;">.ReturnExcluded </span><span><span style="color: #0000ff;">Or</span></span><span><span style="color: #2b91af;">BOMViewEditOptions</span></span><span style="color: #000000;">.ReturnUnassignedComponents)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; locate the component we want to enable</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> component </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">BOMComp</span></span><span style="color: #000000;"> = bom.BOMCompArray.FirstOrDefault(</span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.Name = componentName)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; promote the component</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.AddComponentsToPromote(</span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() {component.Id}, ItemAssignAll.[Default], </span><span><span style="color: #0000ff;">False</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> timestamp </span><span><span style="color: #0000ff;">As</span></span></span><span><span style="font-size: 9pt; color: #2b91af;">DateTime</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> orderResult </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> GetPromoteOrderResults = itemSvc.GetPromoteComponentOrder(timestamp)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.PromoteComponents(timestamp, orderResult.PrimaryArray)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> promoteResult </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">ItemsAndFiles</span></span><span style="color: #000000;"> = itemSvc.GetPromoteComponentsResults(timestamp)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; update the BOM link to point to the Item instead of the Component</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> bomLink </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #2b91af;">ItemAssoc</span></span><span style="color: #000000;"> = bom.ItemAssocArray.First(</span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.ParItemID = editableItem.Id </span><span><span style="color: #0000ff;">AndAlso</span></span><span style="color: #000000;"> n.BOMCompId = component.Id)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.UpdateItemBOMAssociations(editableItem.Id, </span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() {bomLink.Id}, </span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() {promoteResult.ItemRevArray(0).Id}, </span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Double</span></span><span style="color: #000000;">() {bomLink.Quant}, </span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Boolean</span></span><span style="color: #000000;">() {bomLink.IsStatic}, </span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Boolean</span></span><span style="color: #000000;">() {</span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">}, _</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 2;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">() {bomLink.BOMOrder}, </span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">() {bomLink.PositionNum}, </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> BOMEditAction() {BOMEditAction.Update}, </span><span><span style="color: #2b91af;">BOMViewEditOptions</span></span><span style="color: #000000;">.ReturnBOMFragmentsOnEdits)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">&#39; commit changes to the the parent item and the newly promoted item</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> itemsToCommit </span><span><span style="color: #0000ff;">As</span></span><span><span style="color: #0000ff;">New</span></span><span><span style="color: #2b91af;">List</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">Of</span></span><span><span style="color: #2b91af;">Item</span></span><span style="color: #000000;">)()</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemsToCommit.Add(editableItem)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemsToCommit.AddRange(promoteResult.ItemRevArray)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.UpdateAndCommitItems(itemsToCommit.ToArray())</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">End</span></span></span><span><span><span style="font-size: 9pt; color: #0000ff;">Sub</span></span></span></span></p>
</td>
</tr>
</tbody>
</table>
<hr noshade="noshade" style="color: #d09219;" />
<p><strong>Turing on the Component BOM row</strong></p>
<p>Technically it’s not a Component row any more.&#0160; It’s a normal row since the child is an Item.&#0160; If you want to turn off the row, you can <a href="http://justonesandzeros.typepad.com/blog/2014/04/disabling-and-enabling-bom-rows.html" target="_blank">disable it</a>.&#0160; Disabling the row leaves the Item intact.&#0160; So the row is still an Item-to-Item link.</p>
<p>If we want to truly revert the state, so that it’s an Item-to-Component link, you can delete the Item.&#0160; This will cause the BOM to revert the row back to using the Component.&#0160; This process only works for Items that come from Components.&#0160; If the Item was created directly in the Item Master, then there is no Component.&#0160; Deleting an Item in this case will simply remove it from all BOMs that it’s in.</p>
<hr noshade="noshade" style="color: #d09219;" />
<p><strong>Where do Components come from</strong></p>
<p>Components come from CAD files.&#0160; When a CAD file is uploaded to Vault, the CAD plug-in includes BOM information.&#0160; That information becomes Components, and Components become Items.&#0160; If you want more information, you can read the article about the <a href="http://justonesandzeros.typepad.com/blog/2012/11/the-bom-pipeline.html">BOM Pipeline</a>.&#0160; The basic takeaway is that Components are hooked to CAD files.&#0160; Items created directly in the Item Master have no Components.</p>
<hr noshade="noshade" style="color: #d09219;" />
