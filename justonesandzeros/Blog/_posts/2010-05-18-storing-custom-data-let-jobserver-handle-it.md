---
layout: "post"
title: "Storing Custom Data: Let Jobserver Handle It"
date: "2010-05-18 09:53:19"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2010/05/storing-custom-data-let-jobserver-handle-it.html "
typepad_basename: "storing-custom-data-let-jobserver-handle-it"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>Welcome back to my <em>Storing Custom Data</em> series, where I go into the various ways you can store custom data needed by your Vault customization.&#0160; Last time I talked about using the <a href="http://justonesandzeros.typepad.com/blog/2010/04/storing-custom-data-vault-options.html">Vault Options</a> concept to store your data.&#0160; </p> <p><strong>Job Server:</strong>   <br />In this article, I&#39;ll be focusing on the Job Processor API, which allows you to hook to the Jobserver feature.&#0160; If you are writing a custom job handler, you might want it to remember some settings.&#0160; Although Vault Options can be used, I want to explore something that doesn&#39;t involve additional Vault API calls.</p> <p>It&#39;s possible to have the job handler store all the data itself, with a local settings file for example.&#0160; The theory is that the job handler &quot;owns&quot; the data.&#0160; Any edits to the data, must go through the custom job handler.&#0160; From the client&#39;s point of view, the data maintenance tasks are a black box.&#0160; Any outside changes to this data would have do be done through a custom job.</p> <p><strong>Example:</strong>   <br /><a href="http://justonesandzeros.typepad.com/blog/2010/05/watch-folder.html">Watch Folder</a> has an example of this technique.&#0160; Most of the work in that utility is done by a custom job handler.&#0160; That handler also keeps track of which users are watching which folders.</p> <p>When a user says that they want to watch a folder, it causes a job to be queued.&#0160; The job informs the handler of the update to the watch settings.&#0160; The handler reads this job and updates the settings accordingly.&#0160; In this case, the settings are in an XML file local to the handler.</p> <p>When a job comes in telling the handler to scan for new files and send out emails, it does a re-read the settings file.</p> <p>HandlerClass.cs in the WatchFolderJobHandler project has the sample code.&#0160; WatchCollection.xml is the file that remembers the folders being watched for each user.&#0160; &quot;Autodesk.WatchFolder.SettingJob&quot; is the job type that tells the hander to update the settings.&#0160; &quot;Autodesk.WatchFolder.NotificationJob&quot; is the job type that tells the handler to scan for new files and send out the emails.</p> <p><strong>Analysis:</strong>   <br />This technique is probably more trouble than it&#39;s worth, but it&#39;s still worth looking into.&#0160; It&#39;s up to you to decide if this technique is best for your requirements.</p> <p>Let&#39;s list out all the issues:</p> <ul>
  <li>No easy way for a client to see the settings.&#0160; Because the job handler owns the settings, the only way to see them is talk to the job handler.&#0160; And the only way to talk to a job handler is to queue up a job.&#0160; Once the handler gets the job, some sort of mechanism needs to be developed for the job handler to pass the data back to the client (for example, an email).&#0160; Best case scenario is a few minute delay between the request and the results. </li>
  <li>Multiple handlers may be on the network at a given time.&#0160; This can result in a fragmented data set.&#0160; One way to solve this would be to put the settings in a file on a network share.&#0160; The handlers would need to handle things gracefully if they both try to write to the file at the same time.   <br />Another option is to require only one handler on the network at a time.&#0160; But there is no framework in place to enforce this configuration.</li>
  <li>Connected workgroups add problems too.&#0160; Each workgroup has its own queue, which does not get replicated to the other workgroups.&#0160; So again, it&#39;s possible to have fragmented data.&#0160; This might be OK as long as users stick to a single workgroup.&#0160; Another workaround is for the user to log-in to the workgroup with the job handler running to do the one or two things needed for that operation.&#0160; Then they can log-out and go back to their local workgroup.</li>
  <li>From a permissions standpoint, the user needs to be at least Document Editor (Level 1) to be able to add jobs to the queue.</li>
 </ul>
