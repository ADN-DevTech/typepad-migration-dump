---
layout: "post"
title: "Debugging a custom command"
date: "2010-04-19 07:50:51"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2010/04/debugging-a-custom-command.html "
typepad_basename: "debugging-a-custom-command"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>Everyone who writes a custom Vault Explorer command ends up with the same development environment, more or less.&#0160; So I thought I would quickly go over the setup that I use, just to have it documented somewhere.</p> <p><strong>Goal</strong>  <br />A typical development process for writing a program is 1) write code 2) build 3) debug 4) repeat.&#0160; The goal of the development environment is to make those steps as painless as possible.</p> <p><strong>The development computer</strong>  <br />There are a bunch of things you will want to have on your computer.&#0160; Item 1 is the only hard requirement, but items 2 and 3 will make your life much easier.</p> <ol>
 <li>Visual Studio </li>
 <li>The Vault client.&#0160; Base Vault doesn&#39;t have the ability to run custom commands.&#0160; So use either Workgroup, Collaboration, or Professional depending on your requirements. </li>
 <li>The Vault SDK.&#0160; If you don&#39;t have the Vault Server installed on your computer, copy the SDK over from the server machine. </li>
 </ol>
 <p>Note: I&#39;m using Visual Studio 2008 Team Edition.&#0160; I do not know if the Express Editions have all the capabilities that I am about to go over.</p> <p><strong>Visual Studio project references</strong>  <br />OK, your computer is set up.&#0160; Now you can create your Class Library project.&#0160; You will need to reference Autodesk.Connectivity.Explorer.Extensibility.dll from your Vault client&#39;s &quot;Explorer&quot; folder.&#0160; This DLL is already part of the client.&#0160; So tell Visual Studio <strong>not</strong> to copy the DLL to the output folder.  <br /><img src="/assets/vsSetting1.png" /> </p> <p>If you are making server calls, you will probably want to reference Autodesk.Connectivity.WebServices.dll from the SDK.&#0160; This DLL is not part of the client, so you want to keep the default setting of having the DLL copied to your output folder.</p> <p><strong>Creating the .vcet.config file</strong>  <br />Add a new XML file to your project and change the name to [project name].vcet.config.&#0160; You can look at the SDK documentation for more information on the XML syntax.&#0160; However there are some things I want to add.</p> <p>If you are deploying anything more than 1 DLL, you need to set AddFolderToAssemblyProbingPath to true.&#0160; In fact, you can set this to true always.&#0160; I don&#39;t see a reason for ever setting this to false.</p> <p>In the Visual Studio properties on the .vcet.config file, set the Copy to Output Directory setting to &quot;copy if newer&quot;.&#0160; This way, when you build, the config file goes with you. <br /><img src="/assets/vsSetting2.png" /> </p> <p><strong>Debug settings</strong>  <br />For debug mode, you can just set the build target to be the Extensions folder for your Vault Explorer client.&#0160; (ex. C:\Program Files (x86)\Autodesk\Vault Professional 2011\Explorer\Extensions\HelloWorld\ ).</p> <p>Next go to the Debug settings and set the Start Action to &quot;Start External Program&quot;.&#0160; Supply the path to your Vault Explorer EXE (ex. C:\Program Files (x86)\Autodesk\Vault Professional 2011\Explorer\Connectivity.VaultPro.exe ).&#0160; And set the working folder to the EXE directory. <br /><img src="/assets/vsSetting3.png" /> </p> <p><strong>Debugging</strong>  <br />You should be all set now.&#0160; When you run in debug mode, it should start up Vault Explorer and halt at any breakpoints you set in your code.  <br /><img src="/assets/breakpoint.png" /></p>
