---
layout: "post"
title: "Change Order Sample Code"
date: "2011-03-18 09:51:15"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2011/03/change-order-sample-code.html "
typepad_basename: "change-order-sample-code"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/TipsAndTricks2.png" /></p>
<p>Any many of you have pointed out, there isn&#39;t much sample code out there on working with Change Orders.&#0160; So let me attempt to remedy that by providing code on two common operations you might want to do through the API:&#0160; creating a new Change Order and updating the lifecycle state of a Change Order.</p>
<p><strong>Adding a new Change Order     <br /></strong>A new Change Order will always use the default workflow.&#0160; A workflow is the set of lifecycle states and transitions (activities) between them.&#0160; Once created, the Change Order is locked to that workflow forever.&#0160;</p>
<p>So, when you create a new Change Order you don&#39;t need to pass in the workflow.&#0160; But you do need to pass in the routing, which is the set of users and their roles on that Change Order.&#0160; You also need to pass in the number for the Change Order.&#0160; The easiest route is to just use the default routing and default numbering scheme, as shown below.</p>
<table border="1" cellpadding="2" cellspacing="0" width="450">
<tbody>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">// C#               <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">private</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">void</span></span> NewChangeOrder(<span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrderService</span></span> coSvc)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">{               <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">// get the default routing                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">Workflow</span></span> workflow = coSvc.GetDefaultWorkflow();                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">Routing</span></span> [] routings = coSvc.GetRoutingsByWorkflowId(workflow.Id);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">Routing</span></span> defaultRouting = routings.FirstOrDefault(n =&gt; n.IsDflt);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">if</span></span> (defaultRouting == <span style="color: #0000ff;"><span style="color: blue;">null</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">Exception</span></span>(<span style="color: #a31515;"><span style="color: #a31515;">&quot;No default routing&quot;</span></span>);                <br /> <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">// get the next number in the default sequence                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrderNumSchm</span></span> [] numberingSchemes =&#0160; <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>coSvc.GetNumberingSchemesByType(<span style="color: #2b91af;"><span style="color: #2b91af;">NumSchmType</span></span>.ApplicationDefault);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrderNumSchm</span></span> defaultNumberingScheme = numberingSchemes.FirstOrDefault();                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">if</span></span> (defaultNumberingScheme == <span style="color: #0000ff;"><span style="color: blue;">null</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">Exception</span></span>(<span style="color: #a31515;"><span style="color: #a31515;">&quot;No default numbering scheme&quot;</span></span>);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">string</span></span> coNumber = coSvc.GetChangeOrderNumberBySchemeId(defaultNumberingScheme.Id);                <br /> <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">// create the new change order                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrder</span></span> newCo = coSvc.AddChangeOrder(defaultRouting.Id, coNumber, </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="color: #a31515;"><span style="color: #a31515;">&quot;Sample CO&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Sample&quot;</span></span>, <span style="color: #2b91af;"><span style="color: #2b91af;">DateTime</span></span>.Now.AddMonths(1), </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">} </span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">&#39; VB.NET               <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Private</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">Sub</span></span> NewChangeOrder(coSvc <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrderService)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">&#39; get the default routing                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> workflow <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Workflow = coSvc.GetDefaultWorkflow()                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> routings <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Routing() = coSvc.GetRoutingsByWorkflowId(workflow.Id)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> defaultRouting <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Routing = routings.FirstOrDefault(<span style="color: #0000ff;"><span style="color: blue;">Function</span></span>(n) n.IsDflt)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">If</span></span> defaultRouting <span style="color: #0000ff;"><span style="color: blue;">Is</span></span> <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span> <span style="color: #0000ff;"><span style="color: blue;">Then                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">New</span></span> Exception(<span style="color: #a31515;"><span style="color: #a31515;">&quot;No default routing&quot;</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">If                   <br /> <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">&#39; get the next number in the default sequence                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> numberingSchemes <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrderNumSchm() = _                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>coSvc.GetNumberingSchemesByType(NumSchmType.ApplicationDefault)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> defaultNumberingScheme <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrderNumSchm = _                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>numberingSchemes.FirstOrDefault()                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">If</span></span> defaultNumberingScheme <span style="color: #0000ff;"><span style="color: blue;">Is</span></span> <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span> <span style="color: #0000ff;"><span style="color: blue;">Then                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">New</span></span> Exception(<span style="color: #a31515;"><span style="color: #a31515;">&quot;No default numbering scheme&quot;</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">If                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> coNumber <span style="color: #0000ff;"><span style="color: blue;">As</span></span> <span style="color: #0000ff;"><span style="color: blue;">String</span></span> = coSvc.GetChangeOrderNumberBySchemeId( _                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>defaultNumberingScheme.Id)                <br /> <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">&#39; create the new change order                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> newCo <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrder = coSvc.AddChangeOrder( _                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>defaultRouting.Id, coNumber, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Sample CO&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Sample&quot;</span></span>, _&#0160; <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>DateTime.Now.AddMonths(1), <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>)                <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">End</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">Sub</span></span></span></span><span style="font-size: xx-small;"><span style="line-height: 115%; font-size: 8pt;"> </span></span></p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<p><strong>Moving to a new state     <br /></strong>One nice thing is that the Change Order object has an Activities property which lists all the valid state changes currently possible.&#0160; So, all your code needs to do is pick one and run the update calls.&#0160; There are a few things you need to know:</p>
<ul>
<li>There might not be any activities.&#0160; There are a couple of &quot;sink&quot; states where Change Orders cannot move out of.</li>
<li>An activity might loop back to the same state.&#0160; For example, you can perform the review operation when you are in the review state.&#0160; This will result in the Change Order moving to the review state.&#0160; So even though an activity was performed, the state is the same.</li>
<li>Closing a Change Order requires additional information, effectivity.&#0160; Therefore, a different API function is used for that case.</li>
</ul>
<p>Like with many Item operations, you need to do 2 calls to perform the update.&#0160; The first call starts the operation and the second call commits the operation.&#0160; If something goes wrong, you need to call an undo function.</p>
<table border="1" cellpadding="2" cellspacing="0" width="450">
<tbody>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">private</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">void</span></span> ChangeState(<span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrderService</span></span> coSvc, <span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrder</span></span> co)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">{               <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">if</span></span> (co.ActivityArray == <span style="color: #0000ff;"><span style="color: blue;">null</span></span> || co.ActivityArray.Length == 0)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">Exception</span></span>(<span style="color: #a31515;"><span style="color: #a31515;">&quot;Change Order cannot be moved to another state&quot;</span></span>);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">// for demo purposes, we will just pick the first one                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">Activity</span></span> activity = co.ActivityArray[0];                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrder</span></span> editableCo = <span style="color: #0000ff;"><span style="color: blue;">null</span></span>;                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">try                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>{                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo = coSvc.StartChangeOrderActivity(                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>co.Id, activity.Id, co.StateId, co.StateEntered);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">ChangeOrder</span></span> committedCo;                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">if</span></span> (activity.Name == <span style="color: #a31515;"><span style="color: #a31515;">&quot;Set Effectivity&quot;</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>committedCo = coSvc.CommitChangeOrderCloseActivity(                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo.Id, activity.Id, editableCo.StateId,                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo.StateEntered, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>,                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">DateTime</span></span>.Now, <span style="color: #2b91af;"><span style="color: #2b91af;">DateTime</span></span>.MaxValue);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">else                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>committedCo = coSvc.CommitChangeOrderActivity(                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo.Id, activity.Id, editableCo.StateId,                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo.StateEntered, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>, <span style="color: #0000ff;"><span style="color: blue;">null</span></span>);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>}                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">catch                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>{                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">if</span></span> (editableCo != <span style="color: #0000ff;"><span style="color: blue;">null</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>coSvc.CancelChangeOrderActivity(editableCo.Id, activity.Id);                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">throw</span></span>;                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>}                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">}</span></span><span style="font-size: xx-small;"><span style="line-height: 115%; font-size: 8pt;"> </span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Private</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">Sub</span></span> ChangeState(coSvc <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrderService, co <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrder)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">If</span></span> co.ActivityArray <span style="color: #0000ff;"><span style="color: blue;">Is</span></span> <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span> <span style="color: #0000ff;"><span style="color: blue;">OrElse</span></span> co.ActivityArray.Length = 0 <span style="color: #0000ff;"><span style="color: blue;">Then                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Throw</span></span> <span style="color: #0000ff;"><span style="color: blue;">New</span></span> Exception(<span style="color: #a31515;"><span style="color: #a31515;">&quot;Change Order cannot be moved to another state&quot;</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">If                   <br /> <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #008000;"><span style="color: green;">&#39; for demo purposes, we will just pick the first one                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> activity <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Activity = co.ActivityArray(0)                <br /> <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> editableCo <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrder = <span style="color: #0000ff;"><span style="color: blue;">Nothing                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Try                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>editableCo = coSvc.StartChangeOrderActivity( _                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>co.Id, activity.Id, co.StateId, co.StateEntered)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> committedCo <span style="color: #0000ff;"><span style="color: blue;">As</span></span> ChangeOrder                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">If</span></span> activity.Name = <span style="color: #a31515;"><span style="color: #a31515;">&quot;Set Effectivity&quot;</span></span> <span style="color: #0000ff;"><span style="color: blue;">Then                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 3;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>committedCo = coSvc.CommitChangeOrderCloseActivity( </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">editableCo.Id, activity.Id, editableCo.StateId, </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">editableCo.StateEntered, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">DateTime.Now, DateTime.MaxValue)               <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Else                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 3;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>committedCo = coSvc.CommitChangeOrderActivity( </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">editableCo.Id, activity.Id, editableCo.StateId, </span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">editableCo.StateEntered, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>, <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span>)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">If                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Catch                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">If</span></span> editableCo <span style="color: #0000ff;"><span style="color: blue;">IsNot</span></span> <span style="color: #0000ff;"><span style="color: blue;">Nothing</span></span> <span style="color: #0000ff;"><span style="color: blue;">Then                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 3;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>coSvc.CancelChangeOrderActivity(editableCo.Id, activity.Id)                <br /></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">If                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 2;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Throw                   <br /></span></span></span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-tab-count: 1;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">End</span></span> <span style="color: #0000ff;"><span style="color: blue;">Try                   <br /></span></span></span></span><span style="color: #0000ff; font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">End</span></span><span style="font-family: Courier New; font-size: xx-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">Sub</span></span></span></span><span style="font-size: xx-small;"><span style="line-height: 115%; font-size: 8pt;"> </span></span></p>
</td>
</tr>
</tbody>
</table>
