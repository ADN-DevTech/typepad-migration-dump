---
layout: "post"
title: "Setting the Properties on a Category"
date: "2012-03-15 09:38:04"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2012/03/setting-the-properties-on-a-category.html "
typepad_basename: "setting-the-properties-on-a-category"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/TipsAndTricks3.png" /></p>
<p>The question has come up a couple of times on how to associate Property Definitions with a Category.&#0160; So I thought I would write up the code and post it here.</p>
<p><img alt="" src="/assets/admindialog_scaled.png" /></p>
<p>The code is a bit hard to follow unless you understand a few things about Categories.&#0160; A Category is a <a href="http://justonesandzeros.typepad.com/blog/2011/09/entities-and-behaviors.html" target="_blank">behavior</a> that is a container for other behaviors.&#0160; Things like property definitions, lifecycles and revision schemes can be thought of as living inside a category or set of categories.&#0160; So in the case of properties, we are adding a new property definition to a Category’s collection of behaviors.&#0160; So a lot of the code deals with Behavior objects, which is an abstract representation of our property definition.&#0160; The good news is that the code below can easily be re-purposed to associate revisions and lifecycles to a Category.</p>
<p>In this example code, I’m going to take a UDP I created, MyProp, and associate it to the Engineering category.</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="468">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">// C#</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>private</span></span></span><span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> UpdateCategoryProperties(</span><span><span style="color: #2b91af;">WebServiceManager</span></span><span style="color: #000000;"> mgr)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">Cat</span></span><span style="color: #000000;"> [] categories = </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>mgr.CategoryService.GetCategoriesByEntityClassId(</span></span><span><span><span style="color: #a31515;">&quot;FILE&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">Cat</span></span><span style="color: #000000;"> engineeringCat = categories.SingleOrDefault(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>n =&gt; n.SysName == </span></span><span><span><span style="color: #a31515;">&quot;Engineering&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">CatCfg</span></span><span style="color: #000000;"> catCfg = mgr.CategoryService.GetCategoryConfigurationById(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>engineeringCat.Id, </span></span><span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">[] { </span><span><span style="color: #a31515;">&quot;UserDefinedProperty&quot;</span></span><span style="color: #000000;"> });</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">IEnumerable</span></span><span style="color: #000000;">&lt;</span><span><span style="color: #0000ff;">long</span></span><span style="color: #000000;">&gt; propDefIds = catCfg.BhvCfgArray[0].BhvArray.Select(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>n =&gt; n.Id);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">PropDef</span></span><span style="color: #000000;">[] props = </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>mgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span><span><span><span style="color: #a31515;">&quot;FILE&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">PropDef</span></span><span style="color: #000000;"> myProp = props.SingleOrDefault(n =&gt; n.DispName == </span><span><span style="color: #a31515;">&quot;MyProp&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (propDefIds.Contains(myProp.Id))</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">return</span></span><span style="color: #000000;">;<span style="mso-spacerun: yes;">&#0160; </span></span></span><span><span style="color: #008000;">// the property is already hooked to the category</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">long</span></span><span style="color: #000000;"> [] propDefArray = propDefIds.Concat(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">long</span></span><span style="color: #000000;"> [] {myProp.Id}).ToArray();</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">BehaviorAssignmentType</span></span><span style="color: #000000;"> [] typeArray = propDefArray.Select(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>n =&gt; </span></span><span><span><span style="color: #2b91af;">BehaviorAssignmentType</span></span><span style="color: #000000;">.Default).ToArray();</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>mgr.CategoryService.UpdateCategoryBehaviorAssignmentTypes(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>engineeringCat.Id,</span></span><span><span><span style="color: #a31515;">&quot;UserDefinedProperty&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #2b91af;">AllowNoBehavior</span></span><span style="color: #000000;">.Yes, </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>propDefArray, typeArray, </span></span><span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span>&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="color: #000000; font-family: Consolas; font-size: xx-small;">&#0160;</span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="468">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">&#39; VB.NET</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>Private</span></span></span><span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> UpdateCategoryProperties(mgr </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">WebServiceManager</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> categories </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Cat</span></span><span style="color: #000000;">() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>mgr.CategoryService.GetCategoriesByEntityClassId(</span></span><span><span><span style="color: #a31515;">&quot;FILE&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> engineeringCat </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Cat</span></span><span style="color: #000000;"> = categories.SingleOrDefault( _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.SysName = </span><span><span style="color: #a31515;">&quot;Engineering&quot;</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> catCfg </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">CatCfg</span></span><span style="color: #000000;"> = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>mgr.CategoryService.GetCategoryConfigurationById( _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>engineeringCat.Id, </span></span><span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">() {</span><span><span style="color: #a31515;">&quot;UserDefinedProperty&quot;</span></span><span style="color: #000000;">})</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> propDefIds </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">IEnumerable</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">Of</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">) = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>catCfg.BhvCfgArray(0).BhvArray.[Select](</span></span><span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.Id)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> props </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">PropDef</span></span><span style="color: #000000;">() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>mgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span><span><span><span style="color: #a31515;">&quot;FILE&quot;</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> myProp </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">PropDef</span></span><span style="color: #000000;"> = props.SingleOrDefault( _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.DispName = </span><span><span style="color: #a31515;">&quot;MyProp&quot;</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> propDefIds.Contains(myProp.Id) </span></span><span><span style="color: #0000ff;">Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Return</span></span><span style="color: #000000;"> </span></span><span><span style="color: #008000;">&#39; the property is already hooked to the category</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> propDefArray </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>propDefIds.Concat(</span></span><span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Long</span></span><span style="color: #000000;">() {myProp.Id}).ToArray()</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> typeArray </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">BehaviorAssignmentType</span></span><span style="color: #000000;">() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>propDefArray.[Select]( _ </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span><span style="font-family: Consolas;"><span><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) </span><span><span style="color: #2b91af;">BehaviorAssignmentType</span></span><span style="color: #000000;">.[Default]).ToArray()</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>mgr.CategoryService.UpdateCategoryBehaviorAssignmentTypes( _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>engineeringCat.Id, </span></span><span><span><span style="color: #a31515;">&quot;UserDefinedProperty&quot;</span></span><span style="color: #000000;">, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">AllowNoBehavior</span></span><span style="color: #000000;">.Yes, propDefArray, typeArray, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>End</span></span></span><span><span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Sub</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="font-size: xx-small;"><span><span><span style="color: #0000ff;">&#0160;</span></span></span></span></span></p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<p>After I ran the code, my Engineering category looked like this.</p>
<p><img alt="" src="/assets/completed_scaled.png" /></p>
<p><img alt="" src="/assets/TipsAndTricks3-1.png" /></p>
