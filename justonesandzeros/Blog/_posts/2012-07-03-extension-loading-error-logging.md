---
layout: "post"
title: "Extension Loading Error Logging"
date: "2012-07-03 07:56:44"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2012/07/extension-loading-error-logging.html "
typepad_basename: "extension-loading-error-logging"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/TipsAndTricks3.png" /></p>
<p>For the first time ever, I’ll be copying an article from the SDK to my blog.&#0160; Usually it goes on my blog first before going into the knowledge base.&#0160; Anyway, most of you probably didn’t notice the new knowledge base article titled “Extension Loading Error Logging” in the Vault 2013 SDK.&#0160; My colleague, Dan Dulzo, wrote the article after adding a feature that lets you log the load errors for any of your Vault extensions.</p>
<p>Sometimes, Vault extensions are loaded into environments without a GUI, such as an event handler. Unfortunately, if the extension fails to load due to errors, it will fail silently. As an SDK programmer, this can cause confusion when trying to develop and deploy an extension. Fortunately, the SDK can be configured to log these errors, allowing developers to see (and hopefully fix) what went wrong when loading an extension.</p>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Configuring Logging</strong></p>
<p>To enable logging, deploy an xml file named ExtensionLogConfig.xml to the same directory that extensions are deployed to (ex. C:\Program Data\Autodesk\Vault 2013\Extensions). Upon loading an extension, this directory is checked for the configuration file, and if it is found, logging is enabled. The <strong>ExtensionLogConfig.xml</strong> file has a pretty simple format. An example can be seen below.</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;"><span style="font-size: 10pt;">&lt;?</span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #ff00ff;">xml version=&quot;1.0&quot;</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">?&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;"><span style="font-size: 10pt;">&lt;</span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">ExtensionLoggerConfiguration</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000066;"><span style="font-size: 10pt;">&#0160; </span></span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">BaseFileName</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&gt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000066;">C:\ProgramData\Autodesk\Vault 2013\Extensions\ExtensionLog_</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;/</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">BaseFileName</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000066;"><span style="font-size: 10pt;">&#0160; </span></span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">DateFormat</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&gt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000066;">_yyyyMMdd</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;/</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">DateFormat</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000066;"><span style="font-size: 10pt;">&#0160; </span></span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">KeepLogsFor</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&gt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000066;">1</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;/</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">KeepLogsFor</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0.75pt 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;"><span style="font-family: Courier New;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000066;"><span style="font-size: 10pt;">&#0160; </span></span></span></span><span style="font-size: 10pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">FileExtension</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&gt;</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000066;">.txt</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;">&lt;/</span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #800000;">FileExtension</span></span></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></p>
<span style="font-family: Courier New;"><span style="line-height: 12pt; mso-fareast-font-family: &#39;Times New Roman&#39;; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="color: #0000ff;"><span style="font-size: 10pt;">&lt;/</span></span></span><span style="font-size: 10pt;"><span style="line-height: 12pt; mso-fareast-font-family: &#39;Times New Roman&#39;; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="color: #800000;">ExtensionLoggerConfiguration</span></span></span><span style="line-height: 12pt; mso-fareast-font-family: &#39;Times New Roman&#39;; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="font-size: 10pt; color: #0000ff;">&gt;</span></span></span></td>
</tr>
</tbody>
</table>
<p>The <strong>BaseFileName</strong> element specifies the location of the output log file, as well as the base file name of the file. The <strong>DateFormat</strong> element tells the logger the how to format the date when appending it to the log file name. The <strong>KeepLogsFor</strong> sets the number of days to keep log files for. The logger will attempt to automatically delete log files with a date older than the specified number of days. Using a value of -1 will cause the logger to delete any previous log information each time an extension attempts to load. Finally, the <strong>FileExtension</strong> element is used to specify the file extension to use for the log files.</p>
<p>Note: If there are no extensions to load, logging will not be performed regardless of any configuration file.&#0160; Also, if the configuration file cannot be read due to being malformed or any other reason, logging will not be enabled.</p>
<p>The logger will write out what extensions load successfully and various error messages for extensions that failed to load. Most errors will result in a descriptive message getting written to the error log. Problems, such as having incorrect assembly attributes or missing a public contractor for your extension class, should be easy to identify when reading the log.</p>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Common Problems</strong></p>
<p>Unfortunately, the logger will not be able to provide a useful message in certain situations when the extension loader doesn&#39;t know enough about why an extension failed to load. In these cases, the log will contain a generic message resembling &quot;Could not load file or assembly...&quot; or sometimes no message at all. Below are some descriptions of common problems and likely solutions to a few situations where the logger will be unable to provide specific information about why an extension failed to load.</p>
<p><em>Problem 1: No log file is created</em></p>
<p>If an extension is failing to load and there is no log file being created, double-check that your ExtensionLogConfig.xml file is properly formatted xml. Ensure that the configuration file has appropriate values for all of the configuration settings, i.e. the complete file name is valid, DateFormat is an appropriate date format string, Vault has permission to create files in the directory specified in BaseFileName, etc. Next, check that the ExtensionLogConfig.xml has been deployed to the correct directory. A common mistake here is deploying an ExtensionLogConfig.xml file to each extension&#39;s directory. There should be only one configuration file and it should be deployed to the Extensions directory(C:\Program Data\Autodesk\Vault 2013\Extensions\ExtensionLogConfig.xml), NOT to a specific extension&#39;s directory (C:\Program Data\Autodesk\Vault 2013\Extensions\[Some Extension&#39;s Name]\ExtensionLogConfig.xml). Finally, check to make sure at least one extension is configured to load because no log file is created if there will be nothing to log.</p>
<p><em>Problem 2: An extension failed to load but there is nothing about the failed extension in the log file</em></p>
<p>The log file will always output messages for extensions that successfully load and extensions that try to load. If there are no message of an extension in the log file, it essentially means that Vault is unaware of the extension, and in fact, didn&#39;t even try to load it. The key thing to check in this situation is the .vcet.config file that is supposed to be deployed along with each extension. Make sure this file has the right name, is well formed, contains all the necessary information about the extension, and is in the correct directory. It&#39;s important to remember that the .vcet.config file is what lets Vault know of each extension to load. Another issue to check is that all extension files are deployed to the correct directory as well.</p>
<p><em>Problem 3: The log contains the vague error message of &quot;Could not load file or assembly...&quot;</em></p>
<p>For whatever reason, the extension loader could not load some sort of file or assembly referenced by an extension. The most common root cause of this message is that something is missing. Usually, the first thing to check is that all assemblies referenced by an extension are deployed along-side it (unless they are available in the GAC). Please note that certain SDK assemblies referenced by an extension do not need to be deployed with each extension because they are already loaded by Vault. Another possible cause is that the failed extension references the wrong version of the SDK assemblies, so be sure to check this as well.</p>
<p><img alt="" src="/assets/TipsAndTricks3-1.png" /></p>
