---
layout: "post"
title: "Setting File Attributes on Download"
date: "2010-02-16 07:50:19"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2010/02/setting-file-attributes-on-download.html "
typepad_basename: "setting-file-attributes-on-download"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p><strong>The Problem:</strong>  <br />Through the API, you download a file and place it in the local workspace.&#0160; But when you open up Vault Explorer, it says that the file has been edited out of turn.<img src="/assets/Out_of_turn.png" /> </p> <p><strong>The Solution:</strong>  <br />After downloading the file, you need to set it to read-only (unless you have it checked out to you) and you need to set the create date of the local file to match the create date of the File object.<img src="/assets/Out_of_turn.png" /></p> <p>C#:</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>   <tr>    <td valign="top" width="450">     <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span color="#0000ff" size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">public</span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <font color="#0000ff"><span style="color: blue;">void</span></font></span> DownloadFile(<font color="#2b91af"><span style="color: #2b91af;">File</span></font> file, <font color="#0000ff"><span style="color: blue;">string</span></font> localPath)        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">{        <br /></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><font color="#0000ff"><span style="color: blue;">byte</span></font></span>[] buffer;        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>docSvc.DownloadFile(file.Id, <font color="#0000ff"><span style="color: blue;">true</span></font></span>, <font color="#0000ff"><span style="color: blue;">out</span></font> buffer);        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">              </span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>System.IO.<font color="#2b91af"><span style="color: #2b91af;">File</span></font></span>.WriteAllBytes(localPath, buffer);        </span>&#0160; <br /><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">       </span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>System.IO.<font color="#2b91af"><span style="color: #2b91af;">FileInfo</span></font></span> info = <font color="#0000ff"><span style="color: blue;">new</span></font> <font color="#2b91af"><span style="color: #2b91af;">FileInfo</span></font>(localPath);        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>info.CreationTime = file.CreateDate;        <br /></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>info.Attributes = info.Attributes | <font color="#2b91af"><span style="color: #2b91af;">FileAttributes</span></font></span>.ReadOnly;        <br /></span><span size="2;" style="font-family: Courier New"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt;">}</span></span></p>    </td>   </tr>  </tbody></table> <p>VB:</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>   <tr>    <td valign="top" width="450">     <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span color="#0000ff" size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Public</span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <font color="#0000ff"><span style="color: blue;">Sub</span></font></span> DownloadFile(<font color="#0000ff"><span style="color: blue;">ByVal</span></font> file <font color="#0000ff"><span style="color: blue;">As</span></font> File, <font color="#0000ff"><span style="color: blue;">ByVal</span></font> localPath <font color="#0000ff"><span style="color: blue;">As</span></font> <font color="#0000ff"><span style="color: blue;">String</span></font>)        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span><font color="#0000ff"><span style="color: blue;">Dim</span></font></span> buffer <font color="#0000ff"><span style="color: blue;">As</span></font> <font color="#0000ff"><span style="color: blue;">Byte</span></font>()        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span>docSvc.DownloadFile(file.Id, <font color="#0000ff"><span style="color: blue;">True</span></font></span>, buffer)        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; <br /></span></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span>System.IO.File.WriteAllBytes(localPath, buffer)        <br /></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; <br /></span></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span><font color="#0000ff"><span style="color: blue;">Dim</span></font></span> info <font color="#0000ff"><span style="color: blue;">As</span></font> System.IO.FileInfo = <font color="#0000ff"><span style="color: blue;">New</span></font> FileInfo(localPath)        <br /></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span>info.CreationTime = file.CreateDate        <br /></span></span><span size="2;" style="font-family: Courier New"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160; </span>info.Attributes = info.Attributes <font color="#0000ff"><span style="color: blue;">Or</span></font></span> FileAttributes.[ReadOnly]        <br /></span><span size="2;" style="font-family: Courier New"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;</span><font color="#0000ff"><span style="color: blue;">End</span></font></span> <font color="#0000ff"><span style="color: blue;">Sub</span></font></span></p>    </td>   </tr>  </tbody></table> <p><strong></strong></p> <p><strong><br /></strong></p><p><strong>Technical Details:</strong>  <br />The problem isn&#39;t that the file was downloaded wrong.&#0160; The problem is that Vault Explorer expects things in a certain way.&#0160; If you want to &quot;play nice&quot; with the Autodesk clients, then you need to perform a few extra steps.<img src="/assets/Out_of_turn.png" /></p><p></p><p><strong>If you liked this article, you might also like:</strong><br /><a href="http://justonesandzeros.typepad.com/blog/2009/11/the-return-of-the-lock-icon.html">The
Return
of the Lock Icon</a></p>
