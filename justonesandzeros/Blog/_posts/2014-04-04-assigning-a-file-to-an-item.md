---
layout: "post"
title: "Assigning a File to an Item"
date: "2014-04-04 17:04:33"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
  - "Vault"
original_url: "https://justonesandzeros.typepad.com/blog/2014/04/assigning-a-file-to-an-item.html "
typepad_basename: "assigning-a-file-to-an-item"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/Vault4.png" /> <br /><img alt="" src="/assets/TipsAndTricks4.png" /></p>
<p>In Vault 2015, PromoteFiles has been removed from the ItemService.&#0160; Previously, the quickest way was to call PromoteFiles followed by UpdateAndCommitItems.&#0160; Of course, more complex cases would require more API calls and data checks.&#0160; Anyway, the simple workflow just got more complex in 2015.&#0160; That’s sometimes the price you pay for better functionality.</p>
<p>Before I dive into the new code, let me explain the reason for the change.&#0160; First, PromoteFiles was not very efficient.&#0160; It tried to do the entire BOM at once, which is bad for server performance and scalability.&#0160; Next, it favored a file-first workflow (the files need to get created before the items).&#0160; In Vault 2015, there is much better support for item-first workflows, which I’ll go over in other articles.</p>
<p>For now, let’s go back to the simple file-first case.&#0160; You have an Inventor assembly checked-in and you want to create the BOM in Vault.</p>
<hr noshade="noshade" style="color: #d09219;" />
<p>Here is the code for doing that...</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// C#</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">ItemService</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> itemSvc = m_conn.WebServiceManager.ItemService;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="font-size: 9pt;">itemSvc.AddFilesToPromote(fileIds, </span></span></span></span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemAssignAll</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">.Default, </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">false</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">DateTime</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">GetPromoteOrderResults</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> promoteOrder =</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">&#0160;&#0160;&#0160; itemSvc.GetPromoteComponentOrder(</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">out</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.PromoteComponents(timestamp, promoteOrder.PrimaryArray);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">ItemsAndFiles</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> itemsAndFiles = </span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160; itemSvc.GetPromoteComponentsResults(timestamp);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// TODO: edit the items if needed</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.UpdateAndCommitItems(itemsAndFiles.ItemRevArray);</span></span></span></td>
</tr>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">&#39; VB.NET</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> itemSvc </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemService</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> = m_conn.WebServiceManager.ItemService</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="font-size: 9pt;">itemSvc.AddFilesToPromote(fileIds, ItemAssignAll.Default, </span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">False</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> timestamp </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #2b91af;">DateTime</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> promoteOrder </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> GetPromoteOrderResults = itemSvc.GetPromoteComponentOrder(timestamp)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.PromoteComponents(timestamp, promoteOrder.PrimaryArray)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> itemsAndFiles </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemsAndFiles</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> = itemSvc.GetPromoteComponentsResults(timestamp)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">&#39; edit the items as needed</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.UpdateAndCommitItems(itemsAndFiles.ItemRevArray)</span></span></span></td>
</tr>
</tbody>
</table>
<p>Basically, PromoteFiles has been replaced by 4 function calls: AddFilesToPromote, GetPromoteComponentOrder, PromoteComponents, and GetPromoteComponentsResults.&#0160; The &quot;timestamp&quot; variable is the thread that ties together the four calls.&#0160; When you want to finalize the operation, call UpdateAndCommitItems just like before.</p>
<p>Yes, it seems like 4 function calls makes things worse than before.&#0160; It&#39;s definitely more work for a client, but it makes and improvement on the server side.&#0160; Less is done in a single call, which means that transactions are smaller and quicker.&#0160; That, in turn, means more concurrency and throughput.</p>
<p><a href="http://justonesandzeros.typepad.com/blog/2014/08/updating-an-item-from-file.html" target="_blank">Click here for an article on how to update an Item in response to File updates</a></p>
<hr noshade="noshade" style="color: #d09219;" />
