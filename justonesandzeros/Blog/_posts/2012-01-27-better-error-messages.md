---
layout: "post"
title: "Better Error Messages"
date: "2012-01-27 12:04:59"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2012/01/better-error-messages.html "
typepad_basename: "better-error-messages"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/TipsAndTricks3.png" /></p>
<p>Put on your Ramones T-shirt and get out your beige box because it’s hacker time.&#0160; Not real hacking, of course, since I work for Autodesk.&#0160; This is more of a “programmer for a major software corporation posting to a blog” style of hacking.</p>
<p>Anyway, the goal is to display up a better message when our programs run across an error from Vault.&#0160; For example, instead of “303” as the error message, I’ll show you how to display “PermissionDenied” or whatever else you want.</p>
<p>There are over 800 error codes that the Vault server might return, and they always take the form of a number.&#0160; We want to display something human readable and we don’t want to spend all day typing.</p>
<p>Here are the hax0r tools you will need:</p>
<ul>
<li>The Vault SDK </li>
<li>Microsoft Excel </li>
<li>Microsoft Visual Studio 2010 </li>
</ul>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Step 1:&#0160; Get the error codes</strong></p>
<p>You can find the list of error codes in the SDK documentation.&#0160; Go to the “Error Codes – Server” page has our list.&#0160; It has all the codes, and it has text names of the codes.&#0160;</p>
<p>Right click on the page and click on “View Source.”&#0160; This will pop up the raw HTML.&#0160; Save the text as an HTML file.&#0160; Now we have the codes out of the CHM.&#0160; The codes are in table form, which is good, but we need to do more with this data.&#0160; So let’s fire up a spreadsheet program.</p>
<p><img alt="" src="/assets/CHM.png" /></p>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Step 2: Edit in Excel</strong></p>
<p>Open the HTML file in Excel, which will take the error code table and put it in spreadsheet format.&#0160; Feel free to delete everything outside the error code table.&#0160;</p>
<p>We need to put a text prefix in front of our error numbers.&#0160; Visual studio won’t like it if we have a number as our first character, so we are going to add the word “error” in front of all error number.&#0160; Select all the error numbers, right click, and choose “Format Cells.”&#0160; In the number tab, put in <strong>“error”0</strong> as the custom format.&#0160; Now we have a word in front of our error codes.</p>
<p><img alt="" src="/assets/formatCells.png" /></p>
<p>&#0160;</p>
<p>Your error code table should look like this. <br /><img alt="" src="/assets/excel.png" /></p>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Step 3: Copy into Visual Studio</strong></p>
<p>Inside of your Visual Studio project, create a new RESX file if you don’t have one already.&#0160; To create a new one, you need to add a new Resources File to your project.&#0160; If you are not familiar with the concept, a resources file is a place to store things in your program like images and string tables.&#0160; It’s the perfect place for this error code table.</p>
<p>In Excel, select the first two columns from our error code table.&#0160; Don’t select all rows, just the rows with error codes in them.&#0160; Copy these cells.</p>
<p>In Visual Studio, select your RESX file and go to the Strings part.&#0160; Run the paste command and it should put in all our data.&#0160; Now we have all our error codes in a format where it is easy to look up from our code.</p>
<p><img alt="" src="/assets/resx.png" /></p>
<hr noshade="noshade" style="color: #ff5a00;" />
<p><strong>Step 4 (optional): Error handling with Invoke Events </strong></p>
<p>As I mentioned in my <a href="http://justonesandzeros.typepad.com/blog/2011/12/web-service-invoke-events.html" target="_blank">Invoke Events article</a>, you have common hook point for handling all the errors coming back from the server.&#0160; So here is some example code that makes that happen…</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span><span style="color: #008000;">// C#</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="color: #008000; font-family: Consolas;"><span>&#0160;</span></span></span><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>&#0160;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>using</span></span></span><span><span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">WebServiceManager</span></span><span style="color: #000000;"> serviceManager = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">WebServiceManager</span></span><span style="color: #000000;">(login))</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">// add hooks to all services that you use</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">// do this right after the manager is created</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>serviceManager.DocumentService.PostInvokeEvents += Service_PostInvokeEvents;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>serviceManager.PropertyService.PostInvokeEvents += Service_PostInvokeEvents;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">// do stuff</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: 13pt; margin: 0in 0in 10pt;"><span style="font-family: Calibri;"><span style="color: #000000;">&#0160;</span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">// gets called after every web service call</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>void</span></span></span><span><span><span style="color: #000000;"> Service_PostInvokeEvents(</span><span><span style="color: #0000ff;">object</span></span><span style="color: #000000;"> sender, </span><span><span style="color: #2b91af;">WebServiceInvokeEventArgs</span></span><span style="color: #000000;"> e)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (e.Exception != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160; </span></span><span><span style="mso-spacerun: yes;">&#0160; </span>{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>DisplayError(e.Exception);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">return</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">// show the message to the user</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>void</span></span></span><span><span><span style="color: #000000;"> DisplayError(</span><span><span style="color: #2b91af;">Exception</span></span><span style="color: #000000;"> ex)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> errorCode;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">List</span></span><span style="color: #000000;">&lt;</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">&gt; restrictionCodes;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>GetErrorAndRestrictionCodesString(ex, </span></span><span><span><span style="color: #0000ff;">out</span></span><span style="color: #000000;"> errorCode, </span><span><span style="color: #0000ff;">out</span></span><span style="color: #000000;"> restrictionCodes);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> errorMsg = </span><span><span style="color: #2b91af;">String</span></span><span style="color: #000000;">.Empty;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (errorCode != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> desc = </span><span><span style="color: #2b91af;">Resource</span></span><span style="color: #000000;">.ResourceManager.GetString(</span><span><span style="color: #a31515;">&quot;error&quot;</span></span><span style="color: #000000;"> + errorCode);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (desc == </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>desc = </span></span><span><span><span style="color: #a31515;">&quot;Unknown error&quot;</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>errorMsg = </span></span><span><span><span style="color: #a31515;">&quot;Error retuned from Vault Server: &quot;</span></span><span style="color: #000000;"> + desc;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff;">else</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>errorMsg = </span></span><span><span><span style="color: #a31515;">&quot;Error: &quot;</span></span><span style="color: #000000;"> + ex.Message;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(errorMsg);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">&#39; VB.NET</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>Using</span></span></span><span><span><span style="color: #000000;"> serviceManager </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> WebServiceManager(login)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">&#39; add hooks to all services that you use</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">&#39; do this right after the manager is created</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">AddHandler</span></span><span style="color: #000000;"> serviceManager.DocumentService.PostInvokeEvents, </span><span><span style="color: #0000ff;">AddressOf</span></span><span style="color: #000000;"> Service_PostInvokeEvents</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">AddHandler</span></span><span style="color: #000000;"> serviceManager.PropertyService.PostInvokeEvents, </span><span><span style="color: #0000ff;">AddressOf</span></span><span style="color: #000000;"> Service_PostInvokeEvents</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;">&#39; do stuff</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>End</span></span></span><span><span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Using</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">&#39; gets called after every web service call</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>Private</span></span></span><span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> Service_PostInvokeEvents(</span><span><span style="color: #0000ff;">ByVal</span></span><span style="color: #000000;"> sender </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Object</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">ByVal</span></span><span style="color: #000000;"> e </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> WebServiceInvokeEventArgs)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> e.Exception </span><span><span style="color: #0000ff;">IsNot</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>DisplayError(e.Exception)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff;">Return</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>End</span></span></span><span><span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Sub</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;">&#0160;</span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #008000;">&#39; show the message to the user</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>Private</span></span></span><span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> DisplayError(</span><span><span style="color: #0000ff;">ByVal</span></span><span style="color: #000000;"> ex </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Exception</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> errorCode </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">String</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> restrictionCodes </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">List</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">Of</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160; </span></span><span>GetErrorAndRestrictionCodesString(ex, errorCode, restrictionCodes)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> errorMsg </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">[String]</span></span><span style="color: #000000;">.Empty</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> errorCode </span><span><span style="color: #0000ff;">IsNot</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> desc </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;"> = Resource.ResourceManager.GetString(</span><span><span style="color: #a31515;">&quot;error&quot;</span></span><span style="color: #000000;"> &amp; errorCode)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> desc </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>desc = </span></span><span><span style="color: #a31515;">&quot;Unknown error&quot;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>errorMsg = </span></span><span><span><span style="color: #a31515;">&quot;Error retuned from Vault Server: &quot;</span></span><span style="color: #000000;"> &amp; desc</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff;">Else</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span>errorMsg = </span></span><span><span><span style="color: #a31515;">&quot;Error: &quot;</span></span><span style="color: #000000;"> &amp; </span><span><span style="color: #2b91af;">Convert</span></span><span style="color: #000000;">.ToString(ex.Message)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(errorMsg)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>End</span></span></span><span><span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Sub</span></span></span></span></p>
</td>
</tr>
</tbody>
</table>
<p>The code for the GetErrorAndRestrictionCodesString is from an <a href="http://justonesandzeros.typepad.com/blog/2011/11/getting-the-restriction-codes.html" target="_blank">earlier article</a>.</p>
<p><img alt="" src="/assets/TipsAndTricks3-1.png" /></p>
