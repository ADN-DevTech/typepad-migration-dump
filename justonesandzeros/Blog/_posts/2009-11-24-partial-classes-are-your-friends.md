---
layout: "post"
title: "Partial Classes are Your Friends"
date: "2009-11-24 07:53:36"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2009/11/partial-classes-are-your-friends.html "
typepad_basename: "partial-classes-are-your-friends"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>Another neat aspect of our API classes is that they are all partial classes.&#0160; This means you can spread out the class definition in multiple source files.&#0160; It’s very good for auto-generated code (like with web services) because you can have code that you control in one file while the auto-generated code stays in another file.</p> <p>Again, there are many uses for this concept.&#0160; For example:</p> <ul>
 <li>You can add properties. </li>
 <li>You can add methods.&#0160; </li>
 <li>You can implement additional interfaces. </li>
 <li>You can override the Invoke method and create a single point for all your API calls to flow through. </li>
 </ul>
 <p>My last point is probably the most useful.&#0160; For a given service, all API functions flow through the Invoke method.&#0160; By overriding that method, you can have a common spot to put code.&#0160; For example, you can…</p> <ul>
 <li>Handle errors in a generic way, such as popping up a dialog. </li>
 <li>Log each API call. </li>
 <li>See how long an API call takes to complete. </li>
 <li>Put in fixes for specific errors, such as error 300. </li>
 </ul>
 <br /> <h4>Error 300</h4> <p>This is a good time to talk about error 300, because overriding the Invoke method is the only good way I know of to handle it.&#0160; Error 300 means that the authentication token is invalid.&#0160; Usually it occurs because that server changes its encryption key, which happens periodically and without warning.&#0160; In other words, <strong>error 300 can happen, without warning, at any time while your program is running</strong>.</p> <p>The best thing to do is to re-authenticate and run the command again.&#0160; Thanks to partial classes, it isn’t too hard.</p> <p>C#: </p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">namespace</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: green;">// TODO: set namespace same as service class    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">{    <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">partial</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">class</span> <span style="color: #2b91af;">DocumentServiceWse    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">protected</span> <span style="color: blue;">new</span> <span style="color: blue;">object</span>[] Invoke(<span style="color: blue;">string</span> methodName, <span style="color: blue;">object</span>[] parameters)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">return</span> <span style="color: blue;">base</span>.Invoke(methodName, parameters);    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">catch</span> (<span style="color: #2b91af;">Exception</span> ex)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">string</span> errorCodeString = GetErrorCodeString(ex);    <br /><br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">       </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">if</span> (errorCodeString != <span style="color: #a31515;">&quot;300&quot;</span>)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// TODO:<span>&#0160; </span>handle or re-throw the error    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}    <br />    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// Ran into error 300.&#0160; <br /></span></span><span style="font-family: &#39;Courier New&#39;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// </span></span><span style="font-family: &#39;Courier New&#39;; font-size: 10pt;"><span style="color: green;">Log in again and re-run the command</span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span style="color: green;">    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// TODO: re-authenticate    <br /><br /></span></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">       </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">return</span> <span style="color: blue;">base</span>.Invoke(methodName, parameters);    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">catch</span> (<span style="color: #2b91af;">Exception</span>)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// TODO:<span>&#0160; </span>handle or re-throw the error    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>}    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">}    <br /></span><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt;">}</span></p>  </td>  </tr> </tbody></table> <p>VB.NET: </p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Namespace</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: green;">&#39; TODO: set namespace same as service class    <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Partial</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">Class</span> DocumentServiceWse    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">Protected</span> <span style="color: blue;">Shadows</span> <span style="color: blue;">Function</span> Invoke(<span style="color: blue;">ByVal</span> methodName <span style="color: blue;">As</span> <span style="color: blue;">String</span>, <span style="color: blue;">ByVal</span> parameters <span style="color: blue;">As</span> <span style="color: blue;">Object</span>()) <span style="color: blue;">As</span> <span style="color: blue;">Object</span>()    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Return</span> <span style="color: blue;">MyBase</span>.Invoke(methodName, parameters)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160; </span><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> Exception    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Dim</span> errorCodeString <span style="color: blue;">As</span> <span style="color: blue;">String</span> = GetErrorCodeString(ex)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">    <br />   </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">If</span> (errorCodeString &lt;&gt; <span style="color: #a31515;">&quot;300&quot;</span>) <span style="color: blue;">Then    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; TODO:<span>&#0160; </span>Handle or re-throw the error    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">If    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">Try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">    <br />   </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; Ran into error 300&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; Log in again and re-run the command    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; TODO: re-authenticate    <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">    <br />   </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Return</span> <span style="color: blue;">MyBase</span>.Invoke(methodName, parameters)    <br />&#0160;</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Catch    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; TODO:<span>&#0160; </span>Handle or re-throw the error    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">Try    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160; </span><span>&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">Function    <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">End</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">Class    <br /></span></span><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">End</span><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">Namespace</span></span></p>  </td>  </tr> </tbody></table>
