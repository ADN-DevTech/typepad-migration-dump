---
layout: "post"
title: "Storing Custom Data: Vault Options"
date: "2010-04-12 08:25:45"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2010/04/storing-custom-data-vault-options.html "
typepad_basename: "storing-custom-data-vault-options"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>You are writing a Vault application, and you have data that doesn&#39;t fit nicely into a Vault object.&#0160; Your data is not a File Property, or a Change Order, or a Folder, and so on.&#0160; Your data is something else, and you need to store it somewhere.</p> <p>Welcome to <em>Storing Custom Data</em>, which will be an ongoing series on this blog.&#0160; Storing your custom data is a common problem.&#0160; There are many solutions, each with their own pros and cons.&#0160; In each article in the series, I will explore a different way to persist the custom data in your Vault application.</p> <p><strong>Vault Options</strong>   <br />In this article, I will be talking about the &quot;Vault Options&quot; concept.&#0160; In a nutshell, a Vault Option is a name/value string pair that your program can read or write to.&#0160; I like to think of it as the Vault equivalent of the Windows registry.&#0160; </p> <p>There is a companion concept called a &quot;System Option&quot;.&#0160; The only difference is that a Vault Option is specific to a Vault and a System Option is valid across all Vaults in a given system.</p> <p>The maximum length for an option name is 50 characters.&#0160; However the value is limited only by the HTTP max request length (50 MB is the default value for Vault).&#0160; So you can get pretty creative here, as I will illustrate in an example below.</p> <p>Options can be set only by a user with administrative privileges.&#0160; However all users can read an option. So this technique is ideal for administrative settings, but doesn&#39;t work so well for user settings.</p> <p><strong>API functions</strong>   <br />You can only get or set options data through the Web Service API.&#0160; It&#39;s one of the few API features that doesn&#39;t map to a client UI command.&#0160; There are 4 relevant functions and they are all in the Knowledge Vault Service:&#0160; GetVaultOption, SetVaultOption, GetSystemOption and SetSystemOption.</p> <p>To create an option, you set it using a name that doesn&#39;t already exist.&#0160; The common naming convention is to use your company name as a prefix.&#0160; To delete an option, you just set the value to null.&#0160; </p> <p>Any application can read any option value, however the application needs to know the exact option name.&#0160; There is currently no way to browse options.&#0160; So if your app stores data here, it&#39;s fairly safe from tampering.&#0160; When you create an option, you need to remember the name.&#0160; It&#39;s good form to delete an option when you are done using it, but it&#39;s usually hard to tell when this time is.&#0160; As a result, several unused options may get accumulated in the Vault as time goes on, just like with the Windows registry.</p> <p><strong>Example</strong>   <br /><a href="http://justonesandzeros.typepad.com/blog/2010/04/effective-folder-permissions-20.html">Effective Folder Permissions 2.0</a> has an example of this technique.&#0160; In that application, there is a settings dialog, where the administrator can set up which folders to view in the Permissions Overview.&#0160; When the admin clicks OK, the settings are serialized as XML data and stored as a Vault option.&#0160; So all the settings are contained in a single option.&#0160; This approach works well for this application.&#0160; Not only is it easy to code, but it allows me to easily add or remove settings in the future.&#0160; </p> <p>This example is illustrated in Settings.cs from Effective Folder Permissions 2.0.&#0160; The Settings class not only stores the settings data, but it can serialize/deserialize itself to XML and save/load itself from the Vault option.</p>
