---
layout: "post"
title: "Autodesk.Connectivity.WebServices.dll"
date: "2010-04-26 08:53:36"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2010/04/autodeskconnectivitywebservicesdll.html "
typepad_basename: "autodeskconnectivitywebservicesdll"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>Autodesk.Connectivity.WebServices.dll is one of the new additions to the Vault 2011 SDK.&#0160; I wrote the DLL with one goal in mind:&#0160; The elimination of everything I hated about working with web services.</p> <p>Overall, it worked out pretty well.&#0160; (Of course, if it was a crushing failure, I wouldn&#39;t bother blogging about it.)&#0160; All SDK sample and apps from this blog are built on the DLL, so there are plenty of examples on how to use.</p><p></p> <p><strong>Summary</strong>  <br />Autodesk.Connectivity.WebServices.dll is an alternative mechanism for using the Web Services API.&#0160; Instead of creating Web References, you just create a regular DLL reference.</p> <p>I encourage you to use this DLL if possible instead of the web service approach.&#0160; Not only is it easier to use, but it&#39;s the future direction of the Web Services API.</p><p></p> <p><strong>Advantages</strong></p> <ul>
 <li><strong>WSE 3.0 issues fixed</strong>.&#0160; With web references, you have to go through extra steps to get WSE to work with Visual Studio 2008.&#0160; Use of the DLL takes care of those steps for you.&#0160; No extra steps needed. </li>
 <li><strong>All service classes are WSE enabled</strong>.&#0160; No more confusion between DocumentService and DocumentServiceWse.&#0160; There is just one class, DocumentService, and it is WSE enabled. </li>
 <li><strong>Single namespace</strong>.&#0160; If you get a File object back from a DocumentService call, it&#39;s in the same namespace as a File object from the ItemService.&#0160; No more need to copy an object from one namespace to another.  <br />The only exception is SecurityHeader.&#0160; For technical reasons, they each need to live in separate namespaces.</li>
 <li><strong>Single reference</strong>.&#0160; There are 17 web services in Vault 2011.&#0160; That&#39;s a lot of references to deal with.&#0160; True, your app will probably not use all 17, but you can expect about 3 or 4 on average.&#0160; The DLL allows you to get everything with a single reference. </li>
 </ul>
<br />
 <p><strong>Example</strong></p> <p>Here is a comparison between web references and the DLL.&#0160; The code is taken from the VaultList sample in the SDK.&#0160; You&#39;ll notice that the two pieces of code are almost identical, and that&#39;s kind of the point.&#0160; The API is the same, it&#39;s just been made easier to use.</p> <p>Using web references:</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span color="#0000ff" size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt;">using</span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;"> VaultList.Document;    <br /></span></span><span color="#0000ff" size="1;" style="font-family: Courier New;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt;">using</span></span><span size="1;" style="font-family: Courier New;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt;"> VaultList.Security;    <br />    <br />...    <p></p>    </span></span></p>   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span color="#2b91af" size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt;">SecurityService</span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;"> secSrv = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <font color="#2b91af"><span style="color: #2b91af;">SecurityService</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.SecurityHeaderValue = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> VaultList.Security.<font color="#2b91af"><span style="color: #2b91af;">SecurityHeader</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.Url = <font color="#a31515"><span style="color: #a31515;">&quot;http://&quot;</span></font></span><font color="#a31515"> + serverName + <font color="#a31515"><span style="color: #a31515;">&quot;/AutodeskDM/Services/SecurityService.asmx&quot;</span></font>;    <br />    <br /></font></span><font color="#a31515"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.SignInReadOnly(<font color="#a31515"><span style="color: #a31515;">&quot;Administrator&quot;</span></font></span><font color="#a31515">, <font color="#a31515"><span style="color: #a31515;">&quot;&quot;</span></font>, <font color="#a31515"><span style="color: #a31515;">&quot;Vault&quot;</span></font>);    <br />    <br /></font></span><font color="#a31515"></font><span color="#2b91af" size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt;">DocumentServiceWse</span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;"> docSrv = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <font color="#2b91af"><span style="color: #2b91af;">DocumentServiceWse</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> VaultList.Document.<font color="#2b91af"><span style="color: #2b91af;">SecurityHeader</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue.UserId = secSrv.SecurityHeaderValue.UserId;    <br /></span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue.Ticket = secSrv.SecurityHeaderValue.Ticket;    <br /></span></span><span size="1;" style="font-family: Courier New;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.Url = <font color="#a31515"><span style="color: #a31515;">&quot;http://&quot;</span></font></span><font color="#a31515"> + serverName + <font color="#a31515"><span style="color: #a31515;">&quot;/AutodeskDM/Services/DocumentService.asmx&quot;</span></font>;    </font><p></p><font color="#a31515">    </font></span><font color="#a31515"></font></p>  </td>  </tr> </tbody></table> <p>Using Autodesk.Connectivity.WebServices.dll:</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal"><span color="#0000ff" size="1;" style="font-family: Courier New;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt;">using</span></span><span size="1;" style="font-family: Courier New;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 8pt;"> Autodesk.Connectivity.WebServices;    <br />    <br />...    <p></p>    </span></span></p>   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span color="#2b91af" size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt;">SecurityService</span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;"> secSrv = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <font color="#2b91af"><span style="color: #2b91af;">SecurityService</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.SecurityHeaderValue = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">Autodesk.Connectivity.WebServices.SecuritySvc.</span><font color="#2b91af"><span style="color: #2b91af;">SecurityHeader</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.Url = <font color="#a31515"><span style="color: #a31515;">&quot;http://&quot;</span></font></span><font color="#a31515"> + serverName + <font color="#a31515"><span style="color: #a31515;">&quot;/AutodeskDM/Services/SecurityService.asmx&quot;</span></font>;    <br />    <br /></font></span><font color="#a31515"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">secSrv.SignInReadOnly(<font color="#a31515"><span style="color: #a31515;">&quot;Administrator&quot;</span></font></span><font color="#a31515">, <font color="#a31515"><span style="color: #a31515;">&quot;&quot;</span></font>, <font color="#a31515"><span style="color: #a31515;">&quot;Vault&quot;</span></font>);    <br />    <br /></font></span><font color="#a31515"></font><span color="#2b91af" size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt;">DocumentService</span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;"> docSrv = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <font color="#2b91af"><span style="color: #2b91af;">DocumentService</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue = <font color="#0000ff"><span style="color: blue;">new</span></font></span><font color="#0000ff"> <span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">Autodesk.Connectivity.WebServices.DocumentSvc.</span><font color="#2b91af"><span style="color: #2b91af;">SecurityHeader</span></font>();    <br /></font></span><font color="#0000ff"></font><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue.UserId = secSrv.SecurityHeaderValue.UserId;    <br /></span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.SecurityHeaderValue.Ticket = secSrv.SecurityHeaderValue.Ticket;    <br /></span></span><span size="1;" style="font-family: Courier New;"><span style="font-family: &quot;Courier New&quot;; font-size: 8pt;">docSrv.Url = <font color="#a31515"><span style="color: #a31515;">&quot;http://&quot;</span></font></span><font color="#a31515"> + serverName + <font color="#a31515"><span style="color: #a31515;">&quot;/AutodeskDM/Services/DocumentService.asmx&quot;</span></font>;    </font><p></p><font color="#a31515">    </font></span><font color="#a31515"></font></p>  </td>  </tr> </tbody></table> <p><strong><br /></strong></p><p><strong>Other notes</strong></p> <ul>
 <li>This DLL will works with all Vault 2011 products.&#0160; However some of the services will only work with a specific product.&#0160; So the burden is on the programmer to use only the API pieces that fit the target Vault product.&#0160; <br />For example, if you are developing an app for Vault Workgroup, don&#39;t reference the Item Service. </li>
 <li>There are two cases where different classes have the same name.&#0160; The result is a single class in the DLL with properties merged in from both cases.&#0160; This shouldn&#39;t affect how your program runs, but it might be a bit confusing when you are writing code.  <br />Here are the two cases:  <ul>
  <li>ItemService.Attmt and PackageService.Attmt </li>
  <li>DocumentServiceExtensions.LfCycDef and (ItemService or ChangeOrderService).LfCycDef </li>
  </ul>
 </li>
 <li>You can&#39;t use partial classes with a class in another DLL.&#0160; So if you are using the trick I <a href="http://justonesandzeros.typepad.com/blog/2009/11/partial-classes-are-your-friends.html">documented earlier</a> with the Invoke method, that won&#39;t work the same.&#0160; The new way of doing things is to subclass the service object and overwrite the Invoke method.&#0160; </li>
 </ul>
