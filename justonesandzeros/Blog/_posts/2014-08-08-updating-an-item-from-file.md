---
layout: "post"
title: "Updating an Item from File"
date: "2014-08-08 16:14:52"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
  - "Vault"
original_url: "https://justonesandzeros.typepad.com/blog/2014/08/updating-an-item-from-file.html "
typepad_basename: "updating-an-item-from-file"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/Vault4.png" /><img alt="" src="/assets/TipsAndTricks4.png" /></p>
<p>A while back I posted some code showing <a href="http://justonesandzeros.typepad.com/blog/2014/04/assigning-a-file-to-an-item.html" target="_blank">how to create Items from Files</a>.&#0160; This time Iâ€™ll post code code showing how to update those Items when you want to consume File changes.&#0160;</p>
<p>The code is almost identical.&#0160; The creating Items from Files and updating Items from Files are actually the same operation under the hood.&#0160; The only difference is how the process gets kicked off.&#0160; When creating Items, you start with a set of Files.&#0160; When updating Items, you start with a set of Items.</p>
<p>Here is the code for the update operation.&#0160; This time around UpdatePromoteComponents kicks off the process.&#0160; Again, this is a very simplified example.&#0160; More complex BOMs may involve more code.</p>
<table border="1" cellpadding="2" cellspacing="0" width="470">
<tbody>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;"> <br />// C#</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">ItemService</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> itemSvc = m_conn.WebServiceManager.ItemService;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="font-size: 9pt;">itemSvc.UpdatePromoteComponents(itemRevIds, <br /></span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">&#0160;&#0160;&#0160; ItemAssignAll</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">.Default, </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">false</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">DateTime</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">GetPromoteOrderResults</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> promoteOrder =</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;">&#0160;&#0160;&#0160; itemSvc.GetPromoteComponentOrder(</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">out</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> timestamp);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.PromoteComponents(timestamp, promoteOrder.PrimaryArray);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;"><span style="font-size: 9pt;">ItemsAndFiles</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> itemsAndFiles = <br />&#0160;&#0160;&#0160; itemSvc.GetPromoteComponentsResults(timestamp);</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// edit the items as needed</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.UpdateAndCommitItems(itemsAndFiles.ItemRevArray);</span></span></span></td>
</tr>
<tr>
<td valign="top" width="470">
<p class="MsoNormal" style="margin: 0in 0in 10pt; line-height: 13pt;"><span style="font-family: Consolas;"><span style="color: #008000;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white;"><span style="font-size: 9pt;"> <br />&#39; </span></span><span style="line-height: 10pt;"><span style="font-size: 9pt;">VB.NET</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> itemSvc </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemService</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> = m_conn.WebServiceManager.ItemService</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"><span style="font-size: 9pt;">itemSvc.UpdatePromoteComponents(itemRevIds, _ <br /><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>ItemAssignAll.Default, </span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">False</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;">)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> timestamp </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #2b91af;">DateTime</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> promoteOrder </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;"> GetPromoteOrderResults = _ <br /><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>itemSvc.GetPromoteComponentOrder(timestamp)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.PromoteComponents(timestamp, promoteOrder.PrimaryArray)</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span style="font-size: 9pt;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #000000;"> itemsAndFiles </span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #0000ff;">As</span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="color: #2b91af;">ItemsAndFiles</span></span></span><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-size: 9pt; color: #000000;"> = _</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">itemSvc.GetPromoteComponentsResults(timestamp)</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">&#39; edit the items as needed</span></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; mso-layout-grid-align: none;"><span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; mso-highlight: white;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<span style="background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; line-height: 10pt; mso-highlight: white; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-ansi-language: en-us; mso-fareast-language: en-us; mso-bidi-language: ar-sa;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">itemSvc.UpdateAndCommitItems(itemsAndFiles.ItemRevArray)</span></span></span></td>
</tr>
</tbody>
</table>
<hr noshade="noshade" style="color: #d09219;" />
