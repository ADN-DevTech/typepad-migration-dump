---
layout: "post"
title: "WebServiceManager"
date: "2011-04-21 19:30:19"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2011/04/webservicemanager.html "
typepad_basename: "webservicemanager"
typepad_status: "Publish"
---

<p><img alt="" src="/assets/TipsAndTricks2.png" /></p>
<p>The service manager concept has been around for a while.&#0160; Almost every SDK and blog sample has one.&#0160; For Vault 2012, we decided to build it into the API.&#0160; It&#39;s a bit tricky to get used to at first.&#0160; But once you get the hang of it, you&#39;ll love it.</p>
<p><strong>WebServiceManager features:</strong></p>
<ul>
<li><strong>Login management</strong> - It will handle the login and logout for you so you don&#39;t have to. </li>
<li><strong>Service creation</strong> - The WebServiceManager is a factory, so it will create all your services for you.&#0160; You don&#39;t have to worry about calling new, setting the URL or copying security headers. </li>
<li><strong>Re-SignIn</strong> - If you run into error 300, which means your login has been invalidated, the WebServiceManager will automatically catch the error, sign-in again, re-run the command, and return the new result.&#0160; This feature is only available if you use a credentials class that supports sign in. </li>
</ul>
<p><strong>How to use      <br /></strong>The WebServiceManager can be found in Autodesk.Connectivity.WebServicesTools.dll.&#0160; As the name implies, it contains tools to help you use the web services.&#0160; Currently, the WebServiceManager is the main component of the DLL.</p>
<p>To create a WebServiceManager, you need to provide it with <strong>credentials</strong>, which tells the manager how to log in and log out of Vault.&#0160; There are several credentials classes available, so you need to use the appropriate one.&#0160; It usually is based on the information you have available.&#0160; For example, if you have the username and password, you would use the UserPasswordCredentials.&#0160; If you are in a custom command, and a context is passed in, you can use the UserIdTicketCredentials.</p>
<p><strong>NOTE:&#0160; There are some known issues with UserIdTicketCredentials and WebServiceCredentials, so <a href="http://justonesandzeros.typepad.com/blog/2011/04/issues-with-the-vault-2012-api.html" target="_blank">read this article first</a> before using.</strong></p>
<p>Once you have created your WebServiceManager, you are ready to start making web service calls.&#0160; It has properties for each service and each service has its full set of functions.</p>
<p>To sign out, just let WebServiceManager go out of scope.&#0160; It&#39;s an <a href="http://msdn.microsoft.com/en-us/library/system.idisposable.aspx" target="_blank">IDisposable</a> class, which means it does special things before it gets garbage collected.&#0160; So that&#39;s where all the sign out happens if a sign out is needed.&#0160; I recommend declaring the WebServiceManager in a using statement if possible.&#0160; That way you know when Dispose() will get called.&#0160; If it doesn&#39;t make sense to have a using statement, I recommend explicitly calling Dispose() when you are done with it.&#0160; In effect, the Dispose() replaces SignOut().</p>
<p>Since the WebServiceManager references every service, which in turn references every server function, the WebServiceManager <strong><span style="text-decoration: underline;"><em>is</em></span></strong> the web services API.&#0160; You can just use a single object to make every Vault server call.</p>
<p><strong>Sample code:      <br /></strong>Here is a comparison of the old way versus the new way with the WebServiceManager.</p>
<table border="1" cellpadding="2" cellspacing="0" width="450">
<tbody>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />// THE OLD WAY - C#                 <br /></span></span><span style="color: #2b91af; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />SecurityService</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> secSrv = <span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">SecurityService</span></span>();                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.SecurityHeaderValue = <span style="color: #0000ff;"><span style="color: blue;">new</span></span> Autodesk.Connectivity.WebServices.SecuritySvc.<span style="color: #2b91af;"><span style="color: #2b91af;">SecurityHeader</span></span>();                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.Url = <span style="color: #a31515;"><span style="color: #a31515;">&quot;http://localhost/AutodeskDM/Services/SecurityService.asmx&quot;</span></span>;                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.SignInReadOnly(<span style="color: #a31515;"><span style="color: #a31515;">&quot;Administrator&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Vault&quot;</span></span>);                 <br /> <br /></span></span><span style="color: #2b91af; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">DocumentService</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> docSrv = <span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">DocumentService</span></span>();                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue = <span style="color: #0000ff;"><span style="color: blue;">new</span></span> Autodesk.Connectivity.WebServices.DocumentSvc.<span style="color: #2b91af;"><span style="color: #2b91af;">SecurityHeader</span></span>();                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue.UserId = secSrv.SecurityHeaderValue.UserId;                <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue.Ticket = secSrv.SecurityHeaderValue.Ticket;                <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.Url = <span style="color: #a31515;"><span style="color: #a31515;">&quot;http://localhost/AutodeskDM/Services/DocumentService.asmx&quot;</span></span>;                 <br /></span></span><span style="color: #2b91af; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />Folder</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> root = docSrv.GetFolderRoot();                <br /> <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.SignOut();</span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />// THE NEW WAY - C#                 <br /> <br /></span></span><span style="color: #2b91af; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">UserPasswordCredentials</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> login =&#0160; <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">UserPasswordCredentials</span></span>(                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #a31515;"><span style="color: #a31515;">&quot;localhost&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Vault&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Administrator&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;&quot;</span></span>, <span style="color: #0000ff;"><span style="color: blue;">true</span></span>);                 <br /> <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">using</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> (<span style="color: #2b91af;"><span style="color: #2b91af;">WebServiceManager</span></span> serviceManager =&#0160; <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">new</span></span> <span style="color: #2b91af;"><span style="color: #2b91af;">WebServiceManager</span></span>(login))                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">{                <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af;"><span style="color: #2b91af;">Folder</span></span> root =&#0160; <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>serviceManager.DocumentService.GetFolderRoot();                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">}</span></span></p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
<table border="1" cellpadding="2" cellspacing="0" width="450">
<tbody>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />&#39; THE OLD WAY - VB.NET </span> </span></p>
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Dim</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> secSrv <span style="color: #0000ff;"><span style="color: blue;">As</span></span> SecurityService = <span style="color: #0000ff;"><span style="color: blue;">New</span></span> SecurityService()                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.SecurityHeaderValue = <span style="color: #0000ff;"><span style="color: blue;">New</span></span> Autodesk.Connectivity.WebServices.SecuritySvc.SecurityHeader                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.Url = <span style="color: #a31515;"><span style="color: #a31515;">&quot;http://localhost/AutodeskDM/Services/SecurityService.asmx&quot;                    <br /></span></span></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />secSrv.SignInReadOnly(<span style="color: #a31515;"><span style="color: #a31515;">&quot;Administrator&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Vault&quot;</span></span>)                 <br /> <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Dim</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> docSrv <span style="color: #0000ff;"><span style="color: blue;">As</span></span> DocumentService = <span style="color: #0000ff;"><span style="color: blue;">New</span></span> DocumentService()                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue = <span style="color: #0000ff;"><span style="color: blue;">New</span></span> Autodesk.Connectivity.WebServices.DocumentSvc.SecurityHeader                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue.UserId = secSrv.SecurityHeaderValue.UserId                <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.SecurityHeaderValue.Ticket = secSrv.SecurityHeaderValue.Ticket                <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">docSrv.Url = <span style="color: #a31515;"><span style="color: #a31515;">&quot;http://localhost/AutodeskDM/Services/DocumentService.asmx&quot; </span> </span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Dim</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> root <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Folder = docSrv.GetFolderRoot() </span> </span></p>
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="font-family: Courier New; font-size: x-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">secSrv.SignOut()</span></span></p>
</td>
</tr>
<tr>
<td valign="top" width="450">
<p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt; mso-layout-grid-align: none;"><span style="color: #008000; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <br />&#39; THE NEW WAY - VB.NET                 <br /> <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">dim</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> login <span style="color: #0000ff;"><span style="color: blue;">As</span></span> UserPasswordCredentials = _                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">New</span></span> UserPasswordCredentials(serverName, _                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #a31515;"><span style="color: #a31515;">&quot;Vault&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;Administrator&quot;</span></span>, <span style="color: #a31515;"><span style="color: #a31515;">&quot;&quot;</span></span>)                 <br /> <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">Using</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> serviceManager <span style="color: #0000ff;"><span style="color: blue;">As</span></span> <span style="color: #0000ff;"><span style="color: blue;">New</span></span> WebServiceManager(login)                 <br /></span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: #0000ff;"><span style="color: blue;">Dim</span></span> root <span style="color: #0000ff;"><span style="color: blue;">As</span></span> Folder = _                <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &#39;Courier New&#39;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">serviceManager.DocumentService</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">.GetFolderRoot()                <br /></span></span><span style="color: #0000ff; font-family: Courier New; font-size: x-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;">End</span></span><span style="font-family: Courier New; font-size: x-small;"><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt; mso-bidi-language: ar-sa; mso-no-proof: yes;"> <span style="color: #0000ff;"><span style="color: blue;">Using</span></span></span></span></p>
</td>
</tr>
</tbody>
</table>
