---
layout: "post"
title: "Localizing a Custom Command"
date: "2010-07-12 08:14:02"
author: "Doug Redmond"
categories:
  - "Concepts"
original_url: "https://justonesandzeros.typepad.com/blog/2010/07/localizing-a-custom-command.html "
typepad_basename: "localizing-a-custom-command"
typepad_status: "Publish"
---

<p><img src="/assets/Concepts2.png" /> </p> <p>Despite what some Americans may think, not everybody speaks English.&#0160; So it&#39;s sometimes a good idea for your Vault command to support multiple languages.&#0160; Since your command is a plug-in and not an EXE, there are some complications.</p> <p><strong><br />Satellite Assemblies:</strong> <br />Vault Explorer localization is based on the .NET concept of <em>Satellite Assemblies</em>.&#0160; If you are not familiar with that concept, you way want to read the relevant MSDN articles.</p> <p>In a nutshell, satellite assemblies are DLLs that contain the localized strings and dialogs for a specific language or locale.&#0160; At run time, every time a resource is needed, .NET attempts to find it in the appropriate satellite assembly.&#0160; If the resource is not found, the default resource is used.&#0160; The OS language is used to determine which satellite assembly to use.</p> <p><strong><br />Vault Explorer and your custom command:</strong> <br />For Vault Explorer, the default language is English.&#0160; If you install the English version of Vault, you get no satellite assemblies.&#0160; If you install a non-English version of Vault, you get everything the English install has plus the satellite assemblies for the install language.</p> <p>So you&#39;ve written a custom command for Vault Explorer.&#0160; For sake of demonstration, let&#39;s say you&#39;ve set up satellite assemblies for all the major languages.&#0160; Your control is .NET so it follows the .NET localization mechanism.&#0160; At runtime the <strong>OS language</strong> determines which satellite assembly is use.&#0160; <strong>The Vault install language is not a factor</strong>.</p> <p>This can lead to some interesting results.&#0160; Here a chart with some example set-ups and their results:</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody> <tr> <td valign="top" width="95"><strong>OS Language</strong></td> <td valign="top" width="107"><strong>Vault Install Language</strong></td> <td valign="top" width="105"><strong>Vault Runtime Language</strong></td> <td valign="top" width="141"><strong>Custom Command Runtime Language</strong></td> </tr> <tr> <td bgcolor="#ffc0cb" valign="top" width="95">English</td> <td bgcolor="#ffc0cb" valign="top" width="107">English</td> <td bgcolor="#ffc0cb" valign="top" width="105">English</td> <td bgcolor="#ffc0cb" valign="top" width="141">English</td> </tr> <tr> <td bgcolor="#ffc0cb" valign="top" width="95">German</td> <td bgcolor="#ffc0cb" valign="top" width="107">English</td> <td bgcolor="#ffc0cb" valign="top" width="105">English</td> <td bgcolor="#ffc0cb" valign="top" width="141">German</td> </tr> <tr> <td valign="top" width="95">English</td> <td valign="top" width="107">German</td> <td valign="top" width="105">English</td> <td valign="top" width="141">English</td> </tr> <tr> <td bgcolor="#ffc0cb" valign="top" width="95">German</td> <td bgcolor="#ffc0cb" valign="top" width="107">German</td> <td bgcolor="#ffc0cb" valign="top" width="105">German</td> <td bgcolor="#ffc0cb" valign="top" width="141">German</td> </tr> <tr> <td valign="top" width="95">French</td> <td valign="top" width="107">German</td> <td valign="top" width="105">English</td> <td valign="top" width="141">French</td> </tr> </tbody></table> <p>There is a pattern that emerges.&#0160; Vault runs as English (default language) if the install language doesn&#39;t match the OS language.&#0160; The custom command matches the OS language.&#0160; So we can create a more abstract grid...</p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody> <tr> <td valign="top" width="95"><strong>OS Language</strong></td> <td valign="top" width="107"><strong>Vault Install Language</strong></td> <td valign="top" width="105"><strong>Vault Runtime Language</strong></td> <td valign="top" width="141"><strong>Custom Command Runtime Language</strong></td> </tr> <tr> <td bgcolor="#ffc0cb" valign="top" width="95">X</td> <td bgcolor="#ffc0cb" valign="top" width="107">X</td> <td bgcolor="#ffc0cb" valign="top" width="105">X</td> <td bgcolor="#ffc0cb" valign="top" width="141">X</td> </tr> <tr> <td valign="top" width="95">X</td> <td valign="top" width="107">Y</td> <td valign="top" width="105">English</td> <td valign="top" width="141">X</td> </tr> </tbody></table> <p>NOTE:&#0160; The highlighted configurations are the ones supported by Autodesk.</p> <p>&#0160; <br /><strong>Deployment:</strong></p> <p>Vault has several different language installs which are released at different times.&#0160; However your control doesn&#39;t have to follow this pattern.&#0160; In most cases, it will probably be easiest to support all your languages in a single deployment.&#0160; In other words, all the satellite assemblies are deployed at the same time.</p> <p><strong><br />Testing:</strong></p> <p>If you have an English OS and want to test out your localization, it can be a bit tricky to switch your OS language.&#0160; Changing the locale formats and keyboard settings in the Control Panel does <strong>not</strong> change the OS language. First you need to install the appropriate language pack.&#0160; Next, you need to set the “Display Language” from the Control Panel localization, which requires a reboot or re-login.</p> <br /> <p>That&#39;s all I have for this article.&#0160; Auf Wiedersehen. </p>
