---
layout: "post"
title: "Security"
date: "2009-10-26 16:11:00"
author: "Doug Redmond"
categories:
  - "Concepts"
original_url: "https://justonesandzeros.typepad.com/blog/2009/10/security.html "
typepad_basename: "security"
typepad_status: "Publish"
---

<p><img src="/assets/Concepts2.png" /> </p>
<p>Vault uses two different security mechanisms.&#0160; There is a system based on <strong>user permissions</strong> and a system based on <strong>access control lists</strong> (ACL).&#0160; The permissions-based security is part of the base Vault functionality, but the ACL based security is an optional feature which may or may not be available depending on the version of Vault.</p>
<p>Both security systems operate differently.&#0160; They are conceptually different, they have different API&#39;s, and they were designed to solve different problems.&#0160; There are even cases where the two mechanisms contradict each other.</p><br />
<p><strong><font size="4">Permission-Based Security</font></strong></p>
<p>Each user has a set of <strong>roles,</strong> and each role has a set of <strong>permissions</strong>.&#0160; These permissions determine what the user can do.&#0160; Also, these permissions apply globally to everything in the Vault.&#0160; For example, if a user has the “File Read” permission, then it can read any file in the Vault. <br /><img src="/assets/Permissions.png" /> </p>
<p>If a user has multiple roles, then&#0160;its permission set is the union of those role permissions.&#0160; So a user has the “File Read” permission as long as&#0160;it is in at least 1 role that has that permission.&#0160; The same thing applies to groups.&#0160; Groups can have roles associated with them.&#0160; These roles trickle down to the users.&#0160; For example, a user can have no permissions of it&#39;s own, but if it&#39;s part of the Administrators group, that user has administrative permissions.&#0160; Being part of a group will never take away permissions from a user;&#0160; the user can only gain extra permissions when being part of a group.&#0160; In other words, an <strong>inclusive</strong> model is used.</p><br />
<p><strong><font size="4">ACL-Based Security</font></strong></p>
<p>An ACL is a list of who can is allowed and denied access to a given object.&#0160; Each ACL contains a list of Access Control Entries (ACE).&#0160; Each ACE contains a single User or Group and the list of permissions that it has.&#0160; Vault currently has 3 types of permissions:&#0160; <strong>Read</strong>, <strong>Write</strong> and <strong>Delete</strong>.&#0160; An ACE does not need to contain all 3 permissions.&#0160; For example, it can just set Read to ALLOW (true) and not specify the Write or Delete permissions.&#0160;&#0160; <br />&#0160;<img src="/assets/FolderACL.png" /> </p>
<p>ACLs use an <strong>exclusive</strong> model.&#0160; If a user has access but is in a group with restricted access, then the user will also have restricted access.&#0160; This is directly opposite from the permissions-based system.</p>Here is the algorithm for determining if an ACL allows user access: <br />
<table border="2" cellpadding="2" cellspacing="0" width="450">
<tbody>
<tr>
<td bgcolor="#ffffcc" valign="top" width="450">A user is given access if and only if their user or parent group has an ALLOW bit and no DENY bits.</td></tr></tbody></table>
<p>The ACL model adds restrictions above and beyond the User Permission model.&#0160; However, the ACL model does not replace the other model.&#0160; In order to read a file, the user still needs the File Read user permission in addition to an ALLOW read ACL permission.&#0160; </p><br />
<p><strong><font size="4">Flowchart</font></strong></p>
<p>Let’s put everything together in flowchart form:</p>
<p><img src="/assets/Flowchart.png" /> </p>
<p>Keep in mind this process gets run for each permission.&#0160; So it’s possible for READ to evaluate to “Access Allowed” while WRITE evaluates to “Access Denied”.</p>
