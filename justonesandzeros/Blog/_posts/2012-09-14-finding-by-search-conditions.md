---
layout: "post"
title: "Finding by Search Conditions"
date: "2012-09-14 16:46:12"
author: "Doug Redmond"
categories:
  - "Concepts"
original_url: "https://justonesandzeros.typepad.com/blog/2012/09/finding-by-search-conditions.html "
typepad_basename: "finding-by-search-conditions"
typepad_status: "Publish"
---

<p><img src="/assets/Concepts3.png" alt="" /></p>
<p>It recently came to my attention that there are no articles on using the Find <span style="text-decoration: underline;">X</span> By Search Conditions.&nbsp; So let my fix that now.&nbsp; These Find functions are the API equivalent of the Advanced Find command in the UI.&nbsp; Hopefully you are familiar with the following dialog.</p>
<p><img src="/assets/AdvancedFind.png" alt="" /></p>
<p>The basic idea is that you construct your search criteria by chaining together a bunch of search conditions.&nbsp; The result set consists of all the entities that match the search conditions.</p>
<p>The results are returned in <strong>pages</strong> for performance reasons.&nbsp; By default 100 is the page size, but that value can be changed in ADMS Console.&nbsp; You can also define <span style="color: #232323;"><strong>sort</strong></span> criteria, so that the results come back in a specific order.&nbsp; That way you can hopefully get what you want on the first page.</p>
<p>Each major entity type has it’s own set of Find by Search Conditions functions, but they all work basically the same.&nbsp; I will be focusing mainly on FindFilesBySearchConditions for this article.</p>
<hr style="color: #5acb04;" noshade="noshade" />
<p><strong>Sample code      <br /></strong>I’ll start by showing the code, then explaining what is going on.</p>
<table border="1" cellspacing="0" cellpadding="2" width="470">
<tbody>
<tr>
<td width="470" valign="top">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// C#</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">PropDef</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> [] filePropDefs = </span></span></span></span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">m_svcMgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span></span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #a31515;">"FILE"</span><span style="color: #000000;">);</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">PropDef</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> checkedOutPropDef = filePropDefs.Single(n =&gt; n.SysName == </span><span style="color: #a31515;">"CheckoutUserName"</span><span style="color: #000000;">);</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">PropDef</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> projectPropDef = filePropDefs.Single(n =&gt; n.SysName == </span><span style="color: #a31515;">"Project"</span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">SrchCond</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> isCheckedOut = </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> </span><span style="color: #2b91af;">SrchCond</span><span style="color: #000000;">()</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">PropDefId = checkedOutPropDef.Id,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">PropTyp = </span></span><span style="font-size: 9pt;"><span style="color: #2b91af;">PropertySearchType</span><span style="color: #000000;">.SingleProperty,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">SrchOper = 5, </span></span><span style="font-size: 9pt; color: #008000;">// is not empty</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">SrchRule = </span></span><span style="font-size: 9pt;"><span style="color: #2b91af;">SearchRuleType</span><span style="color: #000000;">.Must,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">};</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">SrchCond</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> padlockProject = </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> </span><span style="color: #2b91af;">SrchCond</span><span style="color: #000000;">()</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">PropDefId = projectPropDef.Id,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">PropTyp = </span></span><span style="font-size: 9pt;"><span style="color: #2b91af;">PropertySearchType</span><span style="color: #000000;">.SingleProperty,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">SrchOper = 3, </span></span><span style="font-size: 9pt; color: #008000;">// is equal</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">SrchRule = </span></span><span style="font-size: 9pt;"><span style="color: #2b91af;">SearchRuleType</span><span style="color: #000000;">.Must,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">SrchTxt = </span></span><span style="font-size: 9pt; color: #a31515;">"Padlock"</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">};</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #0000ff;"><span style="font-size: 9pt;">string</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> bookmark = </span><span style="color: #0000ff;">string</span><span style="color: #000000;">.Empty;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">SrchStatus</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> status = </span><span style="color: #0000ff;">null</span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #2b91af;"><span style="font-size: 9pt;">List</span></span><span style="font-size: 9pt;"><span style="color: #000000;">&lt;</span><span style="color: #2b91af;">File</span><span style="color: #000000;">&gt; totalResults = </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> </span><span style="color: #2b91af;">List</span><span style="color: #000000;">&lt;</span><span style="color: #2b91af;">File</span><span style="color: #000000;">&gt;();</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #0000ff;"><span style="font-size: 9pt;">while</span></span><span style="font-size: 9pt;"><span style="color: #000000;"> (status == </span><span style="color: #0000ff;">null</span><span style="color: #000000;"> || totalResults.Count &lt; status.TotalHits)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="color: #2b91af;">File</span><span style="color: #000000;"> [] results = m_svcMgr.DocumentService.FindFilesBySearchConditions(</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="color: #0000ff;">new</span><span style="color: #000000;"> </span><span style="color: #2b91af;">SrchCond</span><span style="color: #000000;">[] { isCheckedOut, padlockProject },</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="color: #0000ff;">null</span><span style="color: #000000;">, </span><span style="color: #0000ff;">null</span><span style="color: #000000;">, </span><span style="color: #0000ff;">false</span><span style="color: #000000;">, </span><span style="color: #0000ff;">true</span><span style="color: #000000;">, </span><span style="color: #0000ff;">ref</span><span style="color: #000000;"> bookmark, </span><span style="color: #0000ff;">out</span><span style="color: #000000;"> status);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="color: #0000ff;">if</span><span style="color: #000000;"> (results != </span><span style="color: #0000ff;">null</span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size: 9pt;">totalResults.AddRange(results);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt; color: #0000ff;">else</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="color: #0000ff;">break</span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-size: 8pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">// total results now has the results</span></span></span></p>
</td>
</tr>
<tr>
<td width="470" valign="top">
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">' VB.NET</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> filePropDefs </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> PropDef() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">m_svcMgr.PropertyService.GetPropertyDefinitionsByEntityClassId(</span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">"FILE"</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> checkedOutPropDef </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> PropDef = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">filePropDefs.[Single](</span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.SysName = </span><span><span style="color: #a31515;">"CheckoutUserName"</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> projectPropDef </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> PropDef = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">filePropDefs.[Single](</span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Function</span></span><span style="color: #000000;">(n) n.SysName = </span><span><span style="color: #a31515;">"Project"</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">' SrchOper 5 =&gt; is not empty</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> isCheckedOut </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> SrchCond() </span><span><span style="color: #0000ff;">With</span></span><span style="color: #000000;"> { _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.PropDefId = checkedOutPropDef.Id, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.PropTyp = PropertySearchType.SingleProperty, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.SrchOper = 5, _</span><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&nbsp; </span></span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.SrchRule = SearchRuleType.Must _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">' SrchOper 3 =&gt; equals</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> padlockProject </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> SrchCond() </span><span><span style="color: #0000ff;">With</span></span><span style="color: #000000;"> { _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.PropDefId = projectPropDef.Id, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.PropTyp = PropertySearchType.SingleProperty, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.SrchOper = 3, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.SrchRule = SearchRuleType.Must, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">.SrchTxt = </span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">"Padlock"</span></span><span style="color: #000000;"> _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> bookmark </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">.Empty</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> status </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> SrchStatus = </span></span><span><span style="font-size: 9pt; color: #0000ff;">Nothing</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">Dim</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> totalResults </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> List(</span><span><span style="color: #0000ff;">Of</span></span><span style="color: #000000;"> File)()</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">While</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> status </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">OrElse</span></span><span style="color: #000000;"> totalResults.Count &lt; status.TotalHits</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> results </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> File() = _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp; </span>m_svcMgr.DocumentService.FindFilesBySearchConditions( _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> SrchCond() {isCheckedOut, padlockProject}, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">False</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">, bookmark, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 2;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">status)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> results </span><span><span style="color: #0000ff;">IsNot</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="font-size: 9pt; color: #0000ff;">Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-tab-count: 2;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size: 9pt;">totalResults.AddRange(results)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">Else</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 2;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">Exit While</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="font-size: 9pt; color: #0000ff;">If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 9pt;">End</span></span></span><span><span style="font-size: 9pt;"><span style="color: #000000;"> </span></span><span><span style="font-size: 9pt; color: #0000ff;">While</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #008000;">' total results now has the results</span></span></span></p>
</td>
</tr>
</tbody>
</table>
<p>The code is running the same search from the screenshot at the top of the article.&nbsp; In this case, I want to gather all results, even if it’s bigger than the page size.&nbsp; I put the Find call in a while loop so that I can keep going, page by page, until I get all the results.</p>
<hr style="color: #5acb04;" noshade="noshade" />
<p><strong>Search Conditions&nbsp; <br /></strong>The SrchCond objects are the main building blocks of your search.&nbsp; Each object defines a single condition in the search.&nbsp; A condition consists of a property, a condition and a value.&nbsp; For example, “<span style="text-decoration: underline;">Author</span> <span style="text-decoration: underline;">is</span> <span style="text-decoration: underline;">Doug</span>” or “<span style="text-decoration: underline;">CreateDate</span> <span style="text-decoration: underline;">is less than</span> <span style="text-decoration: underline;">6/31/2011</span>”.&nbsp; Value may not be used in some cases depending on the condition.&nbsp; For example, “<span style="text-decoration: underline;">Checked Out By</span> <span style="text-decoration: underline;">is not empty</span>”.&nbsp; </p>
<p>The PropTyp property basically determines if this is an advanced search or a basic search.&nbsp; “SingleProperty” means advanced search because the value only relates to a single property.&nbsp; “AllProperties” and “AllPropertiesAndContent” both refer to the basic search feature where a single value is compared against all properties.</p>
<p>SrchOper defines the comparison operator, such as “equals” or “less than”.&nbsp; It’s a number, and the SDK documentation has a table of all the legal values.</p>
<p><a href="http://justonesandzeros.typepad.com/blog/2010/12/may-and-must-search-rules.html" target="_blank">Search Rule</a> is something I covered in another article, so I won’t go over it here.&nbsp; The advanced find command in the Vault client always uses Must, which means there is an AND relationship between the conditions.</p>
<hr style="color: #5acb04;" noshade="noshade" />
<p><strong>FindFilesBySearchConditions</strong>     <br />Here is the function itself.&nbsp; I won’t be going over every parameter, but I will make sure to cover the tricky ones.</p>
<p>File[] FindFilesBySearchConditions(    <br />&nbsp;&nbsp; SrchCond[] conditions,     <br />&nbsp;&nbsp; SrchSort[] sortConditions,     <br />&nbsp;&nbsp; long[] folderIds,     <br />&nbsp;&nbsp; bool recurseFolders,     <br />&nbsp;&nbsp; bool latestOnly,     <br />&nbsp;&nbsp; ref System.string bookmark,     <br />&nbsp;&nbsp; out SrchStatus searchstatus     <br />)</p>
<p>The first parameter is the array of <strong>search conditions</strong>.&nbsp; You can pass in an empty array, which results in all Files being returned.&nbsp; It’s actually the <a href="http://justonesandzeros.typepad.com/blog/2011/03/coding-for-performance-getting-all-files.html" target="_blank">most efficient way to scan through all the files in the Vault</a>.</p>
<p>Next is the array of <strong>sort</strong> objects.&nbsp; You can pass in null if you don’t care about the order.&nbsp; If you do want a sort, the SrchSort class is pretty straightforward.&nbsp; It’s a Vault property you want to sort on, and you can have it be ascending or descending.&nbsp; The input is an array so that you can sort across multiple properties.&nbsp; The first object in the array is a primary sort, the second object is the secondary sort, and so on.</p>
<p><strong>FolderIds</strong> is for cases where you want to search in a specific set of folders.&nbsp; If you want to search the whole Vault, pass in null.&nbsp; Passing in the root folder may slow performance.</p>
<p><strong>Bookmark</strong> is for when you need multiple pages returned.&nbsp; The first time you call Find, you pass in an empty string for the bookmark.&nbsp; If you don’t get all the results in the first call, bookmark will get updated.&nbsp; You can then use the bookmark for the next call and it will continue the search from where the last search left off.</p>
<p><strong>Search Status</strong> lets you know how many total results there are.&nbsp; It also lets you know if a re-index is going on.&nbsp; In the event of a re-index, your results may not be 100% accurate.&nbsp; There is not much you can do in this case aside from warning the user. </p>
<p><img src="/assets/Concepts3-1.png" alt="" /></p>
