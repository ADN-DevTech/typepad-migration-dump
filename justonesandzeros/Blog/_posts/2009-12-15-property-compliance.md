---
layout: "post"
title: "Property Compliance"
date: "2009-12-15 08:02:50"
author: "Doug Redmond"
categories:
  - "Tips and Tricks"
original_url: "https://justonesandzeros.typepad.com/blog/2009/12/property-compliance.html "
typepad_basename: "property-compliance"
typepad_status: "Publish"
---

<p><img src="/assets/TipsAndTricks2.png" /> </p> <p>The Property Compliance feature has some aspects that may affect your programs.</p> <p><strong>Background:  <br /></strong>Vault has a special property called Property Compliance, which tells if your file has broken any property compliance rules. This is very useful for things like life cycle state transitions, where you don’t want files to move to the Released state unless all the properties are compliant.</p> <p><strong>The problem:  <br /></strong>The Property Compliance value is calculated by the Vault server asynchronously. So if you write a program that updates some properties then immediately moves the file to Released, you will likely run into <strong>error 1092</strong> with a <strong>restriction code of 5003</strong>, which means that the properties are not compliant.</p> <p>The error is a bit misleading. The properties may be compliant, but the Vault sever hasn’t calculated the Property Compliance value yet.</p> <p><strong>How to Fix:  <br /></strong>Unfortunately there is no perfect solution. There is no API function that will force the compliance check. Here are some workarounds you can do, and you can decide which one fits best given your project requirements.</p> <p><strong>Solution #1: Halt your program until the Property Compliance value is set</strong></p> <p>If you application has UI, you can put up a wait cursor or something while waiting.</p> <p>C# code: </p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">// a place to store the Property Compliance PropDef object    <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> Document.<span style="color: #2b91af;">PropDef</span> m_propertyCompliancePropDef; </span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">&#0160; <br /></span></p>   <span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">// a value of 4 means that compliance is still pending   <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">int</span> COMPLIANCE_PENDING = 4;    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">///</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;"> </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;summary&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">///</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;"> This function will halt the program until it detects   <br />that the compliance check has been completed    <br /></span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">///</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;"> </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;/summary&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">///</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;"> </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;param name=&quot;fileId&quot;&gt;</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">The file to check compliance   <br />on</span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;/param&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">void</span> WaitForCompliance(<span style="color: blue;">long</span> fileId)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">{   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">if</span> (m_propertyCompliancePropDef == <span style="color: blue;">null</span>)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// find the &quot;Property compliance&quot; property    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><font size="1">Document.<span style="color: #2b91af;">PropDef</span>[] propDefs =    <br />docSvc.FindPropertyDefinitionsByPropertySetIdsPropIdsAndDataTypes(    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">new</span> <span style="color: blue;">string</span>[] { <span style="color: #a31515;">&quot;89562930-aa40-41d3-a671-132f42cb6ab6&quot;</span> },    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">new</span> <span style="color: blue;">string</span>[] { <span style="color: #a31515;">&quot;Compliance&quot;</span> },    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">new</span> <span style="color: blue;">string</span>[] { <span style="color: #a31515;">&quot;int&quot;</span> });&#0160; <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// save off this information once we find it    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// we don&#39;t want to keep looking this up    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>m_propertyCompliancePropDef = propDefs[0];    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>}&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: green;">// if we are in a dialog, change the cursor to let the user know that we are waiting    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: #2b91af;">Cursor</span> currentCursor = <span style="color: blue;">this</span>.Cursor;    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">this</span>.Cursor = System.Windows.Forms.<span style="color: #2b91af;">Cursors</span>.WaitCursor;&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">int</span> propCompliance = COMPLIANCE_PENDING;    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">while</span> (propCompliance == COMPLIANCE_PENDING)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>{    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// read the property from the file    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>Document.<span style="color: #2b91af;">PropInst</span>[] propInsts = docSvc.GetProperties(<span style="color: blue;">new</span> <span style="color: blue;">long</span>[] { fileId },    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">new</span> <span style="color: blue;">long</span>[] { m_propertyCompliancePropDef.Id });&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">if</span> (propInsts != <span style="color: blue;">null</span> &amp;&amp; propInsts.Length == 1)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>propCompliance = (<span style="color: blue;">int</span>)propInsts[0].Val;    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">else    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">break</span>; <span style="color: green;">// or throw an error error&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// wait 10 seconds if property compliance is pending    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">if</span> (propCompliance == COMPLIANCE_PENDING)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>System.Threading.<span style="color: #2b91af;">Thread</span>.Sleep(1000 * 10);&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// TODO: You might want to provide a way for the user to break out of this loop    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span>}&#0160; <br />   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: green;">// switch the cursor back to the original value    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">this</span>.Cursor = currentCursor;    <br /></span><span style="line-height: 115%; font-family: &quot;Courier New&quot;; font-size: 10pt;">}</span>   <p></p>  </td>  </tr> </tbody></table> <p>VB.Net code: </p> <table border="1" cellpadding="2" cellspacing="0" width="450"><tbody>  <tr>  <td valign="top" width="450">   <p class="MsoNormal" style="line-height: normal; margin-bottom: 0pt;"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39; a place to store the Property Compliance PropDef object    <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> m_propertyCompliancePropDef <span style="color: blue;">As</span> Document.PropDef    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"></span>   </p><p>&#0160; </p>     <span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39; a value of 4 means that compliance is still pending   <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> COMPLIANCE_PENDING <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = 4    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <p>&#0160; </p>   </span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39;&#39;&#39; </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;summary&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39;&#39;&#39; This function will halt the program until it detects that the compliance check has been completed   <br /></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39;&#39;&#39; </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;/summary&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">&#39;&#39;&#39; </span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;param name=&quot;fileId&quot;&gt;</span><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 10pt;">The file to check compliance on</span><span style="font-family: &quot;Courier New&quot;; color: gray; font-size: 10pt;">&lt;/param&gt;   <br /></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">Private</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">Sub</span> WaitForCompliance(<span style="color: blue;">ByVal</span> fileId <span style="color: blue;">As</span> <span style="color: blue;">Long</span>)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">If</span> (m_propertyCompliancePropDef <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span>) <span style="color: blue;">Then&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;"><font size="1">&#39; find the &quot;Property compliance&quot; property    <br /></font></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Dim</span> propDefs <span style="color: blue;">As</span> Document.PropDef() = docSvc.FindPropertyDefinitionsByPropertySetIdsPropIdsAndDataTypes( _    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">New</span> <span style="color: blue;">String</span>() {<span style="color: #a31515;">&quot;89562930-aa40-41d3-a671-132f42cb6ab6&quot;</span>}, _    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">New</span> <span style="color: blue;">String</span>() {<span style="color: #a31515;">&quot;Compliance&quot;</span>}, _    <br /></font></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><font size="1"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">New</span> <span style="color: blue;">String</span>() {<span style="color: #a31515;">&quot;int&quot;</span>})</font>&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">&#0160;&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; save off this information once we find it    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; we don&#39;t want to keep looking this up    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>m_propertyCompliancePropDef = propDefs(0)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">If&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; if we are in a dialog, change the cursor to let the user know that we are waiting    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">Dim</span> currentCursor <span style="color: blue;">As</span> Cursor = <span style="color: blue;">Me</span>.Cursor    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">Me</span>.Cursor = System.Windows.Forms.Cursors.WaitCursor&#0160; <br />   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">Dim</span> propCompliance <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = COMPLIANCE_PENDING    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">While</span> (propCompliance = COMPLIANCE_PENDING)&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; read the property from the file    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Dim</span> propInsts <span style="color: blue;">As</span> Document.PropInst() = docSvc.GetProperties(<span style="color: blue;">New</span> <span style="color: blue;">Long</span>() {fileId}, _    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">New</span> <span style="color: blue;">Long</span>() {m_propertyCompliancePropDef.Id})&#0160; <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">If</span> (propInsts <span style="color: blue;">IsNot</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">AndAlso</span> propInsts.Length = 1) <span style="color: blue;">Then    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>propCompliance = <span style="color: blue;">CType</span>(propInsts(0).Val, <span style="color: blue;">Integer</span>)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Else    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">Exit</span> <span style="color: blue;">While</span> <span style="color: green;">&#39; or throw an error error    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">If&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; wait 10 seconds if property compliance is pending    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">If</span> (propCompliance = COMPLIANCE_PENDING) <span style="color: blue;">Then    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>System.Threading.Thread.Sleep(1000 * 10)    <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">If    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; TODO: You might want to provide a way for the user to break out of this loop    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">End</span> <span style="color: blue;">While&#0160; <br /></span></span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">   <br /></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: green;">&#39; switch the cursor back to the original value    <br /></span></span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"><span>&#0160;&#0160;&#0160; </span><span style="color: blue;">Me</span>.Cursor = currentCursor    <p></p>   </span>   <p></p>   <span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 10pt;">End</span><span style="font-family: &quot;Courier New&quot;; font-size: 10pt;"> <span style="color: blue;">Sub</span></span> </td>  </tr> </tbody></table> <p><strong>Solution #2: Don’t use Property Compliance</strong></p> <p>Maybe you don’t need the Property Compliance feature. In that case you can just to the Administration dialog and edit the appropriate life cycle states so that Property Compliance is no longer a requirement of the transition. <br /><img src="/assets/transitiondialog.png" /> </p> <p><strong>Solution #3: Your program is the compliance check</strong></p> <p>Your program just set the properties, so you can be sure that those values are correct. You can also query any other properties to make sure that they are right too. If anything is not correct, your program can throw an error and not proceed with the state transition. In effect, what you have is a property compliance check in your own program instead of on the server side. So you can go ahead and remove the Property Compliance checks like in solution 2.</p> <p>The drawback here is that it assumes this transition will always be going through your program. If that is what you want, you need a way to uphold this rule. I recommend creating a user specific to your application. Next set it so that the transition can only be done by the new user. Lastly you update your program so that it logs in as that user to do lifecycle transitions.</p>
