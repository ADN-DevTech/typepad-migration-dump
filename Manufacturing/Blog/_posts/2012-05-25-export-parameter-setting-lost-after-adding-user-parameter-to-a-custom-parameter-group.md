---
layout: "post"
title: "Export Parameter setting lost after adding user parameter to a custom parameter group"
date: "2012-05-25 14:36:08"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/export-parameter-setting-lost-after-adding-user-parameter-to-a-custom-parameter-group.html "
typepad_basename: "export-parameter-setting-lost-after-adding-user-parameter-to-a-custom-parameter-group"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p><b>Issue</b></p>  <p>I create a Custom Parameter Group to contain certain user parameters. The custom parameter group is created correctly however the user parameters do not retain the export parameter setting. (This applies to the 2009 release of Inventor).</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>A workaround is to restore the export parameter property by setting the ExposedAsProperty property of the parameter object (the equivalent to this export parameter check mark in the Parameters dialog) after it is added in the custom parameter group. The below VB.Net code demonstrates this suggestion:</p>  <div style="font-family: consolas; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Sub</span> CreateCustomParaGroup()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oCustomParameterGroup <span style="color: blue">As</span> <span style="color: #2b91af">CustomParameterGroup</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oParams <span style="color: blue">As</span> <span style="color: #2b91af">Parameters</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oDoc <span style="color: blue">As</span> <span style="color: #2b91af">PartDocument</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc = _invApp.ActiveDocument</p>    <p style="margin: 0px">&#160;&#160;&#160; oParams = oDoc.ComponentDefinition.Parameters</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; oCustomParameterGroup = oParams. _</p>    <p style="margin: 0px">&#160;&#160; CustomParameterGroups.Add(<span style="color: #a31515">&quot;LVA_VCC&quot;</span>, <span style="color: #a31515">&quot;LVA_VCC&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oParameter <span style="color: blue">As</span> <span style="color: #2b91af">UserParameter</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> <span style="color: blue">Each</span> oParameter <span style="color: blue">In</span> oParams.UserParameters</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oStr <span style="color: blue">As</span> <span style="color: blue">String</span> = oParameter.Comment</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oStr = oStr.Substring(0, 3)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> oStr = <span style="color: #a31515">&quot;LVA&quot;</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oExported <span style="color: blue">As</span> <span style="color: blue">Boolean</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oExported = oParameter.ExposedAsProperty</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCustomParameterGroup.Add(oParameter)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oParameter.ExposedAsProperty = oExported</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>
