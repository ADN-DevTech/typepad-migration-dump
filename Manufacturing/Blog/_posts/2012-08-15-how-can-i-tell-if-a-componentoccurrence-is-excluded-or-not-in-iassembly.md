---
layout: "post"
title: "How can I Tell If a ComponentOccurrence is Excluded or Not in IAssembly"
date: "2012-08-15 21:49:04"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/how-can-i-tell-if-a-componentoccurrence-is-excluded-or-not-in-iassembly.html "
typepad_basename: "how-can-i-tell-if-a-componentoccurrence-is-excluded-or-not-in-iassembly"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><b>Issue</b></p>  <p>I'm trying to find out if a ComponentOccurrence is excluded or not in iAssembly, but did not find any property I could use. Is it possible?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>You can use the iAssemblyTableRow.IsExcluded() function for this purpose. The code below assumes that the ActiveDocument is an iAssembly.</p>  <p>VBA code sample:</p>  <blockquote>   <p><font size="1" face="Courier New">Sub testExclude()       <br />Dim invAD As AssemblyDocument        <br />Set invAD = ThisApplication.ActiveDocument        <br />If invAD.ComponentDefinition.IsiAssemblyFactory Then        <br />Dim invCO As ComponentOccurrence        <br />For Each invCO In invAD.ComponentDefinition.Occurrences        <br />Debug.Print invCO.Name &amp; &quot; is excluded = &quot; &amp; _        <br />invAD.ComponentDefinition.iAssemblyFactory.DefaultRow.IsExcluded(invCO)        <br />Next        <br />End If        <br />End Sub</font></p> </blockquote>  <p>VB.NET code sample:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt; color: "><font color="#0000ff"><font style="font-size: 9pt">Sub</font></font></span><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> testExclude()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 13pt"><font color="#000000"> m_inventorApp </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 13pt"><font color="#000000"> Inventor.Application = </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 13pt"><font color="#000000"> m_quitInventor </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Boolean</font></span><span style="line-height: 13pt"><font color="#000000"> = </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">False</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#008000">' Try to get an active instance of Inventor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; m_inventorApp = System.Runtime.InteropServices.Marshal.GetActiveObject(</font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#a31515">&quot;Inventor.Application&quot;</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Catch</font></span><span style="line-height: 13pt"><font color="#000000"> ex </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> Exception</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#008000">' If not active, create a new Inventor session</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">If</font></span><span style="line-height: 13pt"><font color="#000000"> m_inventorApp </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Is</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Nothing</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 13pt"><font color="#000000"> inventorAppType </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 13pt"><font color="#000000"> Type = System.Type.GetTypeFromProgID(</font></span><span style="line-height: 13pt; color: "><font color="#a31515">&quot;Inventor.Application&quot;</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 13pt"><font face="Courier New"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; m_inventorApp = System.Activator.CreateInstance(inventorAppType)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; m_quitInventor = </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">True</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 13pt"><font color="#000000"> invAD </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> AssemblyDocument</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 13pt"><font face="Courier New"><font style="font-size: 9pt" color="#000000">&#160; invAD = m_inventorApp.ActiveDocument</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">If</font></span><span style="line-height: 13pt"><font color="#000000"> invAD.ComponentDefinition.IsiAssemblyFactory </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 13pt"><font color="#000000"> invCO </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> ComponentOccurrence</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">For</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Each</font></span><span style="line-height: 13pt"><font color="#000000"> invCO </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">In</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> invAD.ComponentDefinition.Occurrences</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; System.Diagnostics.Debug.Write(invCO.Name &amp; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#a31515">&quot; is excluded = &quot;</font></span></font><span style="line-height: 13pt"><font style="font-size: 9pt" color="#000000"> &amp; _</font></span></font><span style="line-height: 13pt"><font face="Courier New"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160; invAD.ComponentDefinition.iAssemblyFactory.DefaultRow.IsExcluded(invCO) &amp; vbCr)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">If</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Not</font></span><span style="line-height: 13pt"><font color="#000000"> m_inventorApp </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Is</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">Nothing</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">AndAlso</font></span><span style="line-height: 13pt"><font color="#000000"> m_quitInventor = </font></span><span style="line-height: 13pt; color: "><font color="#0000ff">True</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 13pt"><font face="Courier New"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; m_inventorApp.Quit()</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt"><font color="#000000"><font style="font-size: 9pt">&#160; m_inventorApp = </font></font></span><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 13pt; color: "><font color="#0000ff"><font style="font-size: 9pt">End</font></font></span><font style="font-size: 9pt"><span style="line-height: 13pt"><font color="#000000"> </font></span></font><span style="line-height: 13pt; color: "><font style="font-size: 9pt" color="#0000ff">Sub</font></span></font></p> </div>  <p><font size="1" face="Courier New">&#160;</font></p>
