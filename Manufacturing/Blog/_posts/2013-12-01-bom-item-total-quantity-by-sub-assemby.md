---
layout: "post"
title: "BOM Item total quantity by sub-assemby"
date: "2013-12-01 23:21:36"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2013/12/bom-item-total-quantity-by-sub-assemby.html "
typepad_basename: "bom-item-total-quantity-by-sub-assemby"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Question:     <br /></strong>I would like to obtain, in a structured parts list, the total number of ITEM in the sub-assembly.     <br />I have found an iLogic rule to create an user ipropertie in each part, with the total nomber of this part in all the assemby (included all sub-assemblies).    <br />I would like to know if it is possible to obtain the total of this part only in the sub-assembly. Is it possible with an iLogic rule or VBA ?&#160; <strong></strong></p>  <p><strong>Solution:     <br /></strong>You can recurse the referenced documents of the top assembly, filter out the sub assemblies. And iterate the occurrences of the assemblies to count each part. iLogic is based on VB.NET, so you could take advantage the <em>Dictionary</em> object to make the worflow more clear. </p>  <p>The following code is a demo to dump an assembly, get the part count of each sub assembly.</p>  <pre style="line-height: normal"><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Sub</strong></font></span><span><font color="#000000"> </font></span><strong><span><font color="#800080">Main</font></span><span><font color="#000000">()</font></span></strong><span>

<font color="#000000">    </font></span><font color="#808080"><em><span>'</span><span>get top assembly</span></em></font><span>
</span><span><font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oTopAss</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">AssemblyDocument</font></span><span>
<font color="#000000">    </font></span><span><font color="#800000">oTopAss</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800080"><strong>ThisApplication</strong></font></span><span><font color="#000000">.</font></span><span><font color="#800000">ActiveDocument</font></span><span>

<font color="#000000">    </font></span><font color="#808080"><em><span>'</span><span>store part info for each sub assembly,</span></em></font><span>
</span><span><font color="#000000">    </font></span><font color="#808080"><em><span>'</span><span> including decedent Sub Assembly</span></em></font><span>
</span><span><font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000">     </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">       </font></span><span><font color="#ff0000"><strong>New</strong></font></span><span><font color="#000000"> </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">       </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">))</font></span></strong><span><font color="#000000"> 
     
    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">Document</font></span><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>For</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Each</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>In</strong></font></span><span><font color="#000000">  </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">        </font></span><span><font color="#800000">oTopAss</font></span><span><font color="#000000">.</font></span><span><font color="#800000">ReferencedDocuments</font></span><span>
<font color="#000000">        </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>TypeOf</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Is</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">AssemblyDocument</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Then</strong></font></span><span>
<font color="#000000">            </font></span><font color="#808080"><em><span>'</span><span>get full path of the assembly</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubAssFullPath</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oSubAssFullPath</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span>  </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000">.</font></span><span><font color="#800000">FullFileName</font></span><span>

<font color="#000000">            </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">ContainsKey</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oSubAssFullPath</font></span><font color="#000000"><span><strong>)</strong></span><span> </span></font><span><font color="#ff0000"><strong>Then</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span> should have iterated, do nothing</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>Else</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>store each unique part per its full path</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubDict</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span>  </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#ff0000"><strong>New</strong></font></span><span><font color="#000000"> </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span><font color="#000000"> 
                                    </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">)</font></span></strong><span>

<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>add a dictionary for the sub assembly</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Add</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oSubAssFullPath</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                                </font></span><span><font color="#800000">oSubDict</font></span><span><strong><font color="#000000">)</font></strong></span><span>

<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>iterate the parts within the sub assembly</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">recurseSubAss</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                             </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                             </font></span><span><font color="#800000">oSubDict</font></span><span><strong><font color="#000000">)</font></strong></span><span>
<font color="#000000">            </font></span><span><font color="#ff0000"><strong>End</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span>

<font color="#000000">        </font></span><span><font color="#ff0000"><strong>End</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Next</strong></font></span><span><font color="#000000"> 

    </font></span><font color="#808080"><em><span>'</span><span>dump the count statistic of the assemblies</span></em></font><span>
</span><span><font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oMsg</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>

<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">iAssKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachAssDic</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000">  </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">        </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">)</font></span></strong><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span><span>Nothing</span></font><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>For</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Each</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">iAssKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>In</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">        </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Keys</font></span><span>
<font color="#000000">        </font></span><font color="#808080"><em><span>'</span><span>each sub assembly, including the decendent assembly</span></em></font><span>
</span><span><font color="#000000">        </font></span><span><font color="#800000">oMsg</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+=</strong></font></span><font color="#000000"><span> </span><span>vbCr</span><span> </span></font><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><font color="#008080"><span>&quot;</span><span>***</span><span>&quot;</span></font><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">iAssKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><font color="#008080"><span>&quot;</span><span>***</span><span>&quot;</span></font><span>
<font color="#000000">        </font></span><span><font color="#800000">oEachAssDic</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">iAssKey</font></span><span><strong><font color="#000000">)</font></strong></span><span>

<font color="#000000">        </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">iPartKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>
<font color="#000000">        </font></span><span><font color="#ff0000"><strong>For</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Each</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">iPartKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>In</strong></font></span><span><font color="#000000">  </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oEachAssDic</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Keys</font></span><span>
<font color="#000000">            </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">quantity</font></span><span><font color="#000000">  </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Integer</strong></font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span>  </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                </font></span><span><font color="#800000">oEachAssDic</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">iPartKey</font></span><span><strong><font color="#000000">)</font></strong></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oMsg</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+=</strong></font></span><font color="#000000"><span> </span><span>vbCr</span><span> </span></font><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><font color="#008080"><span>&quot;</span><span>    </span><span>&quot;</span></font><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000">  </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                </font></span><span><font color="#800000">iPartKey</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><font color="#008080"><span>&quot;</span><span>  [count: </span><span>&quot;</span></font><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#800000">quantity</font></span><span><font color="#000000"> .</font></span><span><font color="#800000">ToString</font></span><font color="#000000"><span><strong>()</strong></span><span> </span></font><span><font color="#ff0000"><strong>+</strong></font></span><span><font color="#000000"> </font></span><font color="#008080"><span>&quot;</span><span>]</span><span>&quot;</span></font><span>
<font color="#000000">        </font></span><span><font color="#ff0000"><strong>Next</strong></font></span><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Next</strong></font></span><span>

<font color="#000000">    </font></span><font color="#808080"><em><span>'</span><span>message the info</span></em></font><span>
</span><span><font color="#000000">    </font></span><span><font color="#ff0000"><strong>System</strong></font></span><span><font color="#000000">.</font></span><span><font color="#800000">Windows</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Forms</font></span><span><font color="#000000">.</font></span><span><font color="#800000">MessageBox</font></span><span><font color="#000000">.</font></span><strong><span><font color="#800080">Show</font></span><span><font color="#000000">(</font></span></strong><span><font color="#800000">oMsg</font></span><span><strong><font color="#000000">)</font></strong></span><span><font color="#000000"> 

</font></span><span><font color="#ff0000"><strong>End Sub</strong></font></span><span>

</span><span><font color="#ff0000"><strong>Sub</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">recurseSubAss</font></span><strong><span><font color="#000000">(</font></span><span><font color="#ff0000">ByVal</font></span></strong><span><font color="#000000"> </font></span><span><font color="#800000">oParentDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">AssemblyDocument</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                  </font></span><span><font color="#ff0000"><strong>ByRef</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                      </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                        </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">))</font></span></strong><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                  </font></span><span><font color="#ff0000"><strong>ByRef</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubDict</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                      </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                        </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">))</font></span></strong><span>

<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oAssDef</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">AssemblyComponentDefinition</font></span><span>
<font color="#000000">    </font></span><span><font color="#800000">oAssDef</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">oParentDoc</font></span><span><font color="#000000">.</font></span><span><font color="#800000">ComponentDefinition</font></span><span>

<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachOcc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">ComponentOccurrence</font></span><span>
<font color="#000000">    </font></span><span><font color="#ff0000"><strong>For</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Each</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachOcc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>In</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oAssDef</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Occurrences</font></span><span>
<font color="#000000">        </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">Document</font></span><span>
<font color="#000000">        </font></span><span><font color="#800000">oEachRefDoc</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">oEachOcc</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Definition</font></span><span><font color="#000000">.</font></span><span><font color="#800080"><strong>Document</strong></font></span><span>

<font color="#000000">        </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>TypeOf</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Is</strong></font></span><span><font color="#000000">  </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">AssemblyDocument</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>Then</strong></font></span><span>
<font color="#000000">            </font></span><font color="#808080"><em><span>'</span><span>get full path of the assembly</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubAssFullPath</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oSubAssFullPath</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span>  </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                </font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000">.</font></span><span><font color="#800000">FullFileName</font></span><span>

<font color="#000000">            </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">ContainsKey</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oSubAssFullPath</font></span><font color="#000000"><span><strong>)</strong></span><span> </span></font><span><font color="#ff0000"><strong>Then</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span> should have iterated, do nothing</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>Else</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>store each unique part per its full path</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubSubDict</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#ff0000"><strong>New</strong></font></span><span><font color="#000000"> </font></span><strong><span><font color="#ff0000">Dictionary</font></span><span><font color="#000000">(</font></span><span><font color="#ff0000">Of</font></span></strong><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span><font color="#000000">, </font></span><strong><span><font color="#ff0000">Integer</font></span><span><font color="#000000">)</font></span></strong><span><font color="#000000"> 

                </font></span><font color="#808080"><em><span>'</span><span>add a dictionary for the sub assembly</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Add</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oSubAssFullPath</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#800000">oSubSubDict</font></span><span><strong><font color="#000000">)</font></strong></span><span>

<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>iterate the documents within the sub assembly</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">recurseSubAss</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#800000">oTotalDict</font></span><span><font color="#000000">, </font></span><span><font color="#800000">_</font></span><span>
<font color="#000000">                        </font></span><span><font color="#800000">oSubSubDict</font></span><span><strong><font color="#000000">)</font></strong></span><span>
<font color="#000000">            </font></span><span><font color="#ff0000"><strong>End</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span>

<font color="#000000">        </font></span><span><font color="#ff0000"><strong>Else</strong></font></span><span>

<font color="#000000">            </font></span><font color="#808080"><em><span>'</span><span> it is part</span></em></font><span>
</span><span>
<font color="#000000">            </font></span><font color="#808080"><em><span>'</span><span>get full path of the part</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>Dim</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oPartFullPath</font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>As</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>String</strong></font></span><span>
<font color="#000000">            </font></span><span><font color="#800000">oPartFullPath</font></span><font color="#000000"><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">oEachRefDoc</font></span><span><font color="#000000">.</font></span><span><font color="#800000">FullFileName</font></span><span>


<font color="#000000">            </font></span><font color="#808080"><em><span>'</span><span>add this part to the dictionary</span></em></font><span>
</span><span><font color="#000000">            </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span><font color="#000000"> </font></span><span><font color="#800000">oSubDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">ContainsKey</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oPartFullPath</font></span><font color="#000000"><span><strong>)</strong></span><span> </span></font><span><font color="#ff0000"><strong>Then</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span> if the part has existed in the dictionary</span></em></font><span>
</span><span><font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span>quantity  + 1</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">oSubDict</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oPartFullPath</font></span><font color="#000000"><span><strong>)</strong></span><span> </span><span><strong>=</strong></span><span> </span></font><span><font color="#800000">_</font></span><span>
<font color="#000000">                    </font></span><span><font color="#800000">oSubDict</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oPartFullPath</font></span><font color="#000000"><span><strong>)</strong></span><span> </span></font><span><font color="#ff0000"><strong>+</strong></font></span><font color="#000000"><span> </span><span><strong>1</strong></span></font><span>
<font color="#000000">            </font></span><span><font color="#ff0000"><strong>Else</strong></font></span><span>
<font color="#000000">                </font></span><font color="#808080"><em><span>'</span><span> add this part, quantity  =1</span></em></font><span>
</span><span><font color="#000000">                </font></span><span><font color="#800000">oSubDict</font></span><span><font color="#000000">.</font></span><span><font color="#800000">Add</font></span><span><font color="#000000"><strong>(</strong></font></span><span><font color="#800000">oPartFullPath</font></span><font color="#000000"><span>, </span><strong><span>1</span><span>)</span></strong></font><span>
<font color="#000000">            </font></span><span><font color="#ff0000"><strong>End</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span>
<font color="#000000">        </font></span><span><font color="#ff0000"><strong>End</strong></font></span><span><font color="#000000"> </font></span><span><font color="#ff0000"><strong>If</strong></font></span><span>

<font color="#000000">    </font></span><span><font color="#ff0000"><strong>Next</strong></font></span><span>

</span><span><font color="#ff0000"><strong>End Sub</strong></font></span></pre>
