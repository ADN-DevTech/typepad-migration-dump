---
layout: "post"
title: "Using Microsoft Edge WebView2 in a DetailPaneTab"
date: "2020-12-25 00:10:27"
author: "Sajith Subramanian"
categories:
  - "Sajith Subramanian"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2020/12/using-microsoft-edge-webview2-in-a-detailpanetab.html "
typepad_basename: "using-microsoft-edge-webview2-in-a-detailpanetab"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/sajith-subramanian.html" target="_self">Sajith Subramanian</a></p><p><br></p><p>Previously, in order to have a Chromium based browser control, you probably would have used <a href="https://cefsharp.github.io/">CefSharp</a>. Now there is an alternative which is also Chromium based, i.e. the <a href="https://developer.microsoft.com/en-us/microsoft-edge/webview2/">WebView2</a>.</p><p>One of the quicker and easier ways to test this, would be using the HelloWorld sample that comes along with the Vault SDK.</p><p>The first step in our HelloWorld sample would be to add the WebView2 SDK. To do so, navigate to Tools –&gt; NuGet Package Manager –&gt; Manage NuGet Packages for Solution, and install the WebView2 as shown below.</p><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0263e9834458200b-pi"><img width="532" height="378" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_e84d15.jpg" border="0"></a></p><p><br></p><p>Next, open the UserControl file as Designer and add the WebView2 control as shown below:</p><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b026be42fa2fa200d-pi"><img width="605" height="340" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_4ef820.jpg" border="0"></a></p><p>For a complete step by step guide on using WebView2 with Windows forms, do take a look at the below article:</p><p><a title="https://docs.microsoft.com/en-us/microsoft-edge/webview2/gettingstarted/winforms" href="https://docs.microsoft.com/en-us/microsoft-edge/webview2/gettingstarted/winforms">https://docs.microsoft.com/en-us/microsoft-edge/webview2/gettingstarted/winforms</a></p><p><br></p><p>Now, in our Command Extension class, i.e. the HelloWorldCommandExtension.cs in the HelloWorld sample, add the below lines of code in the DetailTabs() function.</p><pre><p>public IEnumerable&lt;DetailPaneTab&gt; DetailTabs()<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp; // Create a DetailPaneTab list to return from method<br>&nbsp;&nbsp;&nbsp;&nbsp; List&lt;DetailPaneTab&gt; fileTabs = new List&lt;DetailPaneTab&gt;();</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create Selection Info tab for Files<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DetailPaneTab filePropertyTab = new DetailPaneTab("File.Tab.browsertab",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Browser Tab",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SelectionTypeId.File,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typeof(BrowserControl)); //type of our UserControl</p>
<p>&nbsp;&nbsp; //The propertyTab_SelectionChanged is called whenever our tab is active and the selection    </p><p>     //changes in the main grid </p><p><br>&nbsp;&nbsp;&nbsp; filePropertyTab.SelectionChanged += propertyTab_SelectionChanged;<br>&nbsp;&nbsp;&nbsp; fileTabs.Add(filePropertyTab);<br>
</p></pre><p><br></p><p>Next add the below code in the Selection Changed event of our custom tab.</p><p><pre>void propertyTab_SelectionChanged(object sender, SelectionChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // The event args has our custom tab object.&nbsp; We need to cast it to our type.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BrowserControl tabControl = e.Context.UserControl as BrowserControl;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If something goes wrong, we don't want the exception to bubble up to Vault Explorer.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show("Error: " + ex.Message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></pre><p><br></p><p>Lastly, to get this up and running, you would need the WebView2 runtime. You can download it <a href="https://developer.microsoft.com/en-us/microsoft-edge/webview2/">here</a>. </p><p><br></p><p>You should now have the browser control show up in your custom tab!</p><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b026be42fa2ff200d-pi"><img width="703" height="522" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_8df181.jpg" border="0"></a></p>
