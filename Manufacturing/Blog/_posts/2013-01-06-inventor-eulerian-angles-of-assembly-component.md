---
layout: "post"
title: "Inventor: Eulerian angles of assembly component"
date: "2013-01-06 07:11:11"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/01/inventor-eulerian-angles-of-assembly-component.html "
typepad_basename: "inventor-eulerian-angles-of-assembly-component"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>    <p><b>Issue</b></p>  <p>If we look at the properties of a part in an assembly, we can see the <i>x, y, z</i> coordinates and angles. How can we get the angle values via API?</p>  <p><a name="section2"></a><b>Solution</b></p>  <p>There is no direct way to get these angles via API. However, it should be possible to get them via the 4x4 homogeneous transformation matrix.</p>  <p>t11&#160;&#160; t12&#160;&#160; t13&#160;&#160; tx   <br />t21&#160;&#160; t22&#160;&#160; t23&#160;&#160; ty    <br />t31&#160;&#160; t32&#160;&#160; t33&#160;&#160; tz    <br />0&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160; 0&#160;&#160;&#160; 1</p>  <p>tx, ty, and tz represent the translations along x, y, and z directions.</p>  <p>From the values of other elements of the matrix, one can get the Eulerian/ Cardanian angles. </p>  <p>&#160;</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">Sub GetAngles()</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oDoc As AssemblyDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oDoc = ThisApplication.ActiveDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oOcc As ComponentOccurrence</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oOcc = oDoc.ComponentDefinition.Occurrences(3)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oMat As Matrix</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oMat = oOcc.Transformation</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim aRotAngles(2) As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Call CalculateRotationAngles(oMat, aRotAngles)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">' Print results</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim i As Integer</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">For i = 0 To 2</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Debug.Print FormatNumber(aRotAngles(i), 3)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Next i</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Beep</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">End Sub</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">Sub CalculateRotationAngles( _</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">ByVal oMatrix As Inventor.Matrix, _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">ByRef aRotAngles() As Double)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Const PI = 3.14159265358979</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Const TODEGREES As Double = 180 / PI</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim dB As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim dC As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim dNumer As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim dDenom As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim dAcosValue As Double</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oRotate As Inventor.Matrix</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oAxis As Inventor.Vector</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oCenter As Inventor.Point</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oRotate = ThisApplication.TransientGeometry.CreateMatrix</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oAxis = ThisApplication.TransientGeometry.CreateVector</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oCenter = ThisApplication.TransientGeometry.CreatePoint</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oCenter.X = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oCenter.Y = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oCenter.Z = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">' Choose aRotAngles[0] about x which transforms axes[2] onto the x-z plane</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dB = oMatrix.Cell(2, 3)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dC = oMatrix.Cell(3, 3)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dNumer = dC</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dDenom = Sqr(dB * dB + dC * dC)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">' Make sure we can do the division.<span style="mso-spacerun: yes">&#160; </span>If not, then axes[2] is already in the x-z plane</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (Abs(dDenom) &lt;= 0.000001) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(0) = 0#</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (dNumer / dDenom &gt;= 1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = 0#</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (dNumer / dDenom &lt;= -1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = PI</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = Acos(dNumer / dDenom)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(0) = Sgn(dB) * dAcosValue</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oAxis.X = 1</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt"><span style="mso-spacerun: yes">&#160;</span>oAxis.Y = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oAxis.Z = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Call oRotate.SetToRotation(aRotAngles(0), oAxis, oCenter)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Call oMatrix.PreMultiplyBy(oRotate)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">' Choose aRotAngles[1] about y which transforms axes[3] onto the z axis</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (oMatrix.Cell(3, 3) &gt;= 1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = 0#</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (oMatrix.Cell(3, 3) &lt;= -1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = PI</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = Acos(oMatrix.Cell(3, 3))</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(1) = Math.Sgn(-oMatrix.Cell(1, 3)) * dAcosValue</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oAxis.X = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oAxis.Y = 1</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oAxis.Z = 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Call oRotate.SetToRotation(aRotAngles(1), oAxis, oCenter)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Call oMatrix.PreMultiplyBy(oRotate)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">' Choose aRotAngles[2] about z which transforms axes[0] onto the x axis</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (oMatrix.Cell(1, 1) &gt;= 1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = 0#</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If (oMatrix.Cell(1, 1) &lt;= -1#) Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = PI</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Else</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">dAcosValue = Acos(oMatrix.Cell(1, 1))</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160; </span>End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(2) = Math.Sgn(-oMatrix.Cell(2, 1)) * dAcosValue</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'if you want to get the result in degrees</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(0) = aRotAngles(0) * TODEGREES</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(1) = aRotAngles(1) * TODEGREES</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">aRotAngles(2) = aRotAngles(2) * TODEGREES</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">End Sub</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">Public Function Acos(value) As Double</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Acos = Math.Atn(-value / Math.Sqr(-value * value + 1)) + 2 * Math.Atn(1)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">End Function</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: #eaf1dd; mso-background-themecolor: accent3; mso-background-themetint: 51" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>
