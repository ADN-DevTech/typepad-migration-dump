---
layout: "post"
title: "PackAndGo from C++"
date: "2014-09-23 04:07:54"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/09/packandgo-from-c.html "
typepad_basename: "packandgo-from-c"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>The <strong>Inventor API Reference</strong> provides <strong>VB.NET</strong> and <strong>C#</strong> sample codes, and there is also a <a href="http://adndevblog.typepad.com/manufacturing/2013/05/use-packandgo-of-2014-api.html" target="_self">blog post</a> on it, but here is now a <strong>C++</strong> sample too.</p>
<p>I simply used the <strong>SimpleApprenticeExe</strong> sample project and added the following to it:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">#import&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;DTPackAndGo.tlb&quot;</span><span style="background: #ffffff; color: #000000;"> no_namespace named_guids \ <br /> &#0160;&#0160;&#0160;&#0160;raw_dispinterfaces raw_method_prefix(</span><span style="background: #ffffff; color: #a31515;">&quot;&quot;</span><span style="background: #ffffff; color: #000000;">) \ <br /> &#0160;&#0160;&#0160;&#0160;high_method_prefix(</span><span style="background: #ffffff; color: #a31515;">&quot;Method&quot;</span><span style="background: #ffffff; color: #000000;">) </span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> PackAndGoSample()</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">HRESULT</span><span style="background: #ffffff; color: #000000;"> Result = </span><span style="background: #ffffff; color: #6f008a;">NOERROR</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">CComPtr</span><span style="background: #ffffff; color: #000000;">&lt;</span><span style="background: #ffffff; color: #2b91af;">IPackAndGoComponent</span><span style="background: #ffffff; color: #000000;">&gt; packAndGoComp;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;Result = packAndGoComp.CoCreateInstance(CLSID_PackAndGoComponent);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">CComPtr</span><span style="background: #ffffff; color: #000000;">&lt;</span><span style="background: #ffffff; color: #2b91af;">IPackAndGo</span><span style="background: #ffffff; color: #000000;">&gt; packAndGo = </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;packAndGoComp-&gt;MethodCreatePackAndGo(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;L</span><span style="background: #ffffff; color: #a31515;">&quot;C:\\Temp\\Source\\Assembly1.iam&quot;</span><span style="background: #ffffff; color: #000000;">, L</span><span style="background: #ffffff; color: #a31515;">&quot;C:\\Temp\\Destination&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Set the design project. This defaults to the </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// current active project.</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;ProjectFile = L</span><span style="background: #ffffff; color: #a31515;">&quot;C:\\Temp\\Source\\Test.ipj&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Set the options</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;SkipLibraries = </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;SkipStyles = </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;SkipTemplates = </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;CollectWorkgroups = </span><span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;KeepFolderHierarchy = </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;IncludeLinkedFiles = </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">SAFEARRAY</span><span style="background: #ffffff; color: #000000;"> * refFiles = </span><span style="background: #ffffff; color: #6f008a;">NULL</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">VARIANT</span><span style="background: #ffffff; color: #000000;"> refMissFiles;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Get the referenced files</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;MethodSearchForReferencedFiles(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&amp;refFiles, &amp;refMissFiles);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Add the referenced files for package</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;MethodAddFilesToPackage(&amp;refFiles);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Start the pack and go to create the package</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// OverrideExistingFiles = TRUE</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;packAndGo-&gt;MethodCreatePackage(</span><span style="background: #ffffff; color: #6f008a;">VARIANT_TRUE</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>As pointed out in the other blog post as well, a&#0160;program that uses <strong>Pack and Go</strong> must be the <strong>same bitness as the Inventor</strong> they’re running with. If you’re using 64-bit Inventor then the program must also be 64-bit.</p>
<p>So I had to change the <strong>Project settings</strong> of the <strong>SimpleApprenticeExe</strong> sample on my <strong>Windows 7 x64</strong> machine to <strong>x64:</strong>&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c6e574b5970b img-responsive"><a href="http://adndevblog.typepad.com/files/simpleapprenticeexe_packandgo.zip">Download SimpleApprenticeExe_PackAndGo</a></span></p>
<p>I&#39;m also attaching the sample <strong>Inventor 2015</strong> project and document files that can be unpacked into the <strong>C:\Temp</strong> folder to test this program with:&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c6e574b9970b img-responsive"><a href="http://adndevblog.typepad.com/files/source.zip">Download Source</a></span></p>
