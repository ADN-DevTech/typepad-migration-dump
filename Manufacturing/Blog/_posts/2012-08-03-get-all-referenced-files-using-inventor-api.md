---
layout: "post"
title: "Get All Referenced Files Using Inventor API"
date: "2012-08-03 02:28:41"
author: "Barbara Han"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/get-all-referenced-files-using-inventor-api.html "
typepad_basename: "get-all-referenced-files-using-inventor-api"
typepad_status: "Draft"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong>    <br />Is there a way to get all the referenced files using the Inventor API, instead of Apprentice Server API? </p>  <p><strong>Solution</strong>    <br />Yes, it is possible to get the all referenced files using inventor API. See the VBA code below which will give you all referenced files.</p>  <p><font size="1" face="Courier New">Sub reftest()     <br />&#160;&#160;&#160; Dim OApp As Inventor.Application      <br />&#160;&#160;&#160; Set OApp = GetObject(, &quot;Inventor.Application&quot;)</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; Dim oDoc As Document     <br />&#160;&#160;&#160; Set oDoc = OApp.ActiveDocument</font>    <br /><font size="1" face="Courier New">&#160;&#160;&#160; Dim oAllrefdocs As Documents     <br />&#160;&#160;&#160; Set oAllrefdocs = oDoc.ReferencedFiles</font></p>  <p>   <br /><font size="1" face="Courier New">&#160;&#160;&#160; Dim oSubDoc As Document     <br />&#160;&#160;&#160; Dim oSubDoc1 As Document      <br />&#160;&#160;&#160; Dim sMsg As String      <br />&#160;&#160;&#160; Dim iLeafNodes As Long      <br />&#160;&#160;&#160; Dim iSubAssemblies As Long</font></p>  <p>   <br /><font size="1" face="Courier New">&#160;&#160;&#160; For Each oSubDoc In oAllrefdocs     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If oSubDoc.ReferencedFileDescriptors.count = 0 Then      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print oSubDoc.FullFileName      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iLeafNodes = iLeafNodes + 1      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print oSubDoc.FullFileName      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iSubAssemblies = iSubAssemblies + 1      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call processAllSubdoc(oSubDoc, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sMsg, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iLeafNodes, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iSubAssemblies)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If      <br />&#160;&#160;&#160; Next      <br />End Sub</font></p>  <p>   <br /><font size="1" face="Courier New">Sub processAllSubdoc(ByVal oSubDoc As Document, _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef sMsg As String, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef iLeafNodes As Long, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef iSubAssemblies As Long)      <br />&#160;&#160;&#160; Dim oSubDoc1 As Document      <br />&#160;&#160;&#160; For Each oSubDoc1 In oSubDoc.ReferencedFiles      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Check if it's child occurrence (leaf node)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If oSubDoc1.ReferencedFileDescriptors.count = 0 Then      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print oSubDoc1.FullFileName      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iLeafNodes = iLeafNodes + 1      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sMsg = sMsg + oSubDoc1.Name + vbCr      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iSubAssemblies = iSubAssemblies + 1      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call processAllSubdoc(oSubDoc1, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sMsg, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iLeafNodes, _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iSubAssemblies)      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If      <br />&#160;&#160;&#160; Next      <br />End Sub</font></p>
