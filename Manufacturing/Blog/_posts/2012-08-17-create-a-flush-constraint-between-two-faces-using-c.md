---
layout: "post"
title: "Create a Flush Constraint between Two Faces Using C++"
date: "2012-08-17 03:47:54"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/create-a-flush-constraint-between-two-faces-using-c.html "
typepad_basename: "create-a-flush-constraint-between-two-faces-using-c"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong>     <br />How to create a flush constraint between two faces using C++?</p>  <p><strong>Solution</strong>     <br />The following code creates a flush constraint for the first faces of the first two occurrences.     <br />Please make sure that these faces are planar, not e.g. the side of a cylinder.</p>  <p><font size="1" face="Courier New">static HRESULT GetInventorInformation()      <br />{       <br />&#160;&#160;&#160; HRESULT Result = NOERROR;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TCHAR Str[_MAX_PATH];      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; CLSID InvAppClsid;       <br />&#160;&#160;&#160; Result = CLSIDFromProgID (L&quot;Inventor.Application&quot;, &amp;InvAppClsid);       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; // Either create a new instance of the application or latch on to the currently active one.      <br />&#160;&#160;&#160; _tprintf_s (_T(&quot;Would you like to create a new Inventor application? (y/n) _: &quot;));       <br />&#160;&#160;&#160; _tscanf_s (_T(&quot;%ls&quot;), Str, _MAX_PATH);</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComPtr&lt;IUnknown&gt; pInvAppUnk;      <br />&#160;&#160;&#160; if (toupper (Str[0]) == _T('Y'))       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Result = CoCreateInstance (InvAppClsid, NULL, CLSCTX_LOCAL_SERVER, __uuidof(IUnknown), (void **) &amp;pInvAppUnk);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (FAILED (Result))       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _tprintf_s (_T(&quot;*** Failed to create a new Inventor application ***\n&quot;));       <br />&#160;&#160;&#160; }       <br />&#160;&#160;&#160; else       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Result = ::GetActiveObject (InvAppClsid, NULL, &amp;pInvAppUnk);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (FAILED (Result))       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _tprintf_s (_T(&quot;*** Could not get hold of an active Inventor application ***\n&quot;));       <br />&#160;&#160;&#160; }       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComPtr&lt;Application&gt; pInvApp;      <br />&#160;&#160;&#160; Result = pInvAppUnk-&gt;QueryInterface (__uuidof(Application), (void **) &amp;pInvApp);       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComPtr&lt;Document&gt; pDoc;      <br />&#160;&#160;&#160; Result = pInvApp-&gt;get_ActiveDocument(&amp;pDoc);       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComQIPtr&lt;AssemblyDocument&gt; pAsmDoc(pDoc);      <br />&#160;&#160;&#160; CComPtr&lt;AssemblyComponentDefinition&gt; pCD;       <br />&#160;&#160;&#160; Result = pAsmDoc-&gt;get_ComponentDefinition(&amp;pCD);       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComPtr&lt;AssemblyConstraints&gt; pACs(pCD-&gt;Constraints);</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComPtr&lt;Face&gt; pFace1(pCD-&gt;Occurrences-&gt;Item[1]-&gt;SurfaceBodies-&gt;Item[1]-&gt;Faces-&gt;Item[1]);      <br />&#160;&#160;&#160; CComPtr&lt;Face&gt; pFace2(pCD-&gt;Occurrences-&gt;Item[2]-&gt;SurfaceBodies-&gt;Item[1]-&gt;Faces-&gt;Item[1]);</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; CComVariant varEmpty, varReal(0.0);</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; // add the constraint      <br />&#160;&#160;&#160; CComPtr&lt;FlushConstraint&gt; pFC;&#160;&#160;&#160; <br />&#160;&#160;&#160; Result = pACs-&gt;AddFlushConstraint(pFace1, pFace2, varReal, varEmpty, varEmpty,&amp;pFC);       <br />&#160;&#160;&#160; if (FAILED(Result)) return Result;       <br />&#160;&#160;&#160; return true;       <br />}</font></p>
