---
layout: "post"
title: "DesignViewAssociative does not work for Documents.OpenWithOptions"
date: "2012-07-21 07:09:45"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/designviewassociative-does-not-work-for-documentsopenwithoptions.html "
typepad_basename: "designviewassociative-does-not-work-for-documentsopenwithoptions"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><b>Issue     <br /></b>I set DesignViewAssociative in an option for Documents.OpenWithOptions. But OpenWithOptions failed.</p>  <p><a name="section2"></a></p>  <p><b>Solution     <br /></b>DesignViewAssociative does not support with Documents.Open. But you can still control the option by</p>  <p>- AssemblyOptions. DefaultDesignViewIsAssociative&#160;&#160; (Inventor 2010 and before)   <br />- FileOpenOptions. DefaultDesignViewIsAssociative&#160;&#160; (Inventor 2011)</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">static</span> <span style="color: blue">void</span> Test()</p>    <p style="margin: 0px">{&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// assume we have had Inventor application</span></p>    <p style="margin: 0px">&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Create a new NameValueMap object</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">NameValueMap</span> oDocOpenOptions = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; _InvApplication.TransientObjects.CreateNameValueMap();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;<span style="color: green">// Set the representations to use when opening the document.</span></p>    <p style="margin: 0px">&#160;&#160; oDocOpenOptions.Add(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;LevelOfDetailRepresentation&quot;</span>, <span style="color: #a31515">&quot;MyLODRep&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; oDocOpenOptions.Add(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;PositionalRepresentation&quot;</span>, <span style="color: #a31515">&quot;MyPositionalRep&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; oDocOpenOptions.Add(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;DesignViewRepresentation&quot;</span>, <span style="color: #a31515">&quot;MyDesignViewRep&quot;</span>);</p>    <p style="margin: 0px"><span style="color: green">//&#160; oDocOpenOptions.Add(</span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot;DefaultDesignViewIsAssociative&quot;, false);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">FileOpenOptions</span> oFileOp =&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _InvApplication.FileOptions.FileOpenOptions;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oFileOp.DefaultDesignView == <span style="color: #2b91af"></span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DesignViewTypeEnum</span>.kLastActiveDesignViewType)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: green">// This property is only applicable if the default </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160; // design view is</span><span style="color: green"> 'Last Active' as indicated by the </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160; //DefaultDesignView property </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: green">// returning kLastActiveDesignViewType. If the default </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160; // design view</span><span style="color: green"> is any other value, then this property is </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160; // not </span><span style="color: green"> applicable and </span><span style="color: green"> setting it will fail.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oFileOp.DefaultDesignViewIsAssociative = <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Open the document.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">AssemblyDocument</span> oDoc =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">AssemblyDocument</span>)_InvApplication.Documents.OpenWithOptions(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">@&quot;C:\Temp\test.iam&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDocOpenOptions, <span style="color: blue">true</span>);&#160; </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p> </div>
