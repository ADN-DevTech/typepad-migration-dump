---
layout: "post"
title: "How to create Sketches and Features using C++"
date: "2012-07-23 06:11:56"
author: "Philippe Leefsma"
categories:
  - "Inventor"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/how-to-create-sketches-and-features-using-c.html "
typepad_basename: "how-to-create-sketches-and-features-using-c"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>The sample code below is a C++ equivalent of &quot;DrawBlockWithPocket&quot; sample provided in the API Help files. It also illustrates how to use UnitsOfMeaure object to get string from a value. </p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><span style="font-family: ; color: ; mso-no-proof: yes"><font color="#0000ff">#define</font></span><span style="font-family: ; mso-no-proof: yes"><font color="#000000"> pi 3.1415926535897932384626433832795</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000">HRESULT DrawBlockWithPocket(CComPtr&lt;Application&gt; pApp)</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000">{<span style="mso-tab-count: 1">&#160;&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>HRESULT hr = NOERROR;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get part document template</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>_bstr_t templateFilename = pApp-&gt;MethodGetTemplateFile(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kPartDocumentObject,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kDefaultSystemOfMeasure,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kDefault_DraftingStandard,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>vtMissing);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get Documents</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Documents&gt; pDocs;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pApp-&gt;get_Documents(&amp;pDocs);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a new part document</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><font color="#000000"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR">CComPtr&lt;Document&gt;<span style="mso-spacerun: yes">&#160; </span>pDocument;</span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pDocs-&gt;Add(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><font color="#000000"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: ; mso-no-proof: yes">kPartDocumentObject,</span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>templateFilename,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_TRUE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pDocument);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// convert generic document to partdocument</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><font color="#000000"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></span><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR">CComPtr&lt;PartDocument&gt; pPartDocument;</span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160; </span>hr = pDocument-&gt;QueryInterface(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font face="Courier New"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DIID_PartDocument, </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font face="Courier New"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">**)&amp;pPartDocument); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span></span><span style="font-family: ; color: ; mso-no-proof: yes"><font color="#0000ff">if</font></span><span style="font-family: ; mso-no-proof: yes"><font color="#000000"> (FAILED(hr)) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Set a reference to the component definition.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160; </span>CComPtr&lt;PartComponentDefinition&gt; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"></span><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pPartComponentDefinition;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160; </span>hr = pPartDocument-&gt;get_ComponentDefinition(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;pPartComponentDefinition); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a new sketch on the X-Y work plane </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">&#160;&#160;&#160; //(Fixed predefined).<span style="mso-spacerun: yes">&#160; </span></font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Since it's being created on one of the base </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">&#160;&#160;&#160; //workplanes we know </font></span></font></span><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">the orientation it will be created </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">&#160;&#160;&#160; // in and don't need to worry </font></span></font></span><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">about controlling it.<span style="mso-spacerun: yes">&#160; </span></font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="color: "><font color="#008000">&#160;&#160;&#160; // Because of this we also know the origin </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160; //</font></span><span style="color: "><font color="#008000">of the sketch plane will be at (0,0,0) in model space.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get PlanarSketches</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;PlanarSketches&gt; pSketches;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pPartComponentDefinition-&gt;get_Sketches(&amp;pSketches);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get standard WorkPlanes</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkPlanes&gt; pWorkPlanes ;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pPartComponentDefinition-&gt;get_WorkPlanes(&amp;pWorkPlanes);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkPlane&gt; pWorkPlane ;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr= pWorkPlanes-&gt;get_Item(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t(3L, VT_I4),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pWorkPlane);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;PlanarSketch&gt; pSketch;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketches-&gt;Add(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch *) pWorkPlane),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_FALSE, </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pSketch);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Set a reference to the transient geometry object.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>CComPtr&lt;TransientGeometry&gt; pTrGeom; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pTrGeom = pApp-&gt;TransientGeometry; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Draw a 4cm x 3cm rectangle with the corner at (0,0)</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Point2d&gt; pPt1;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pTrGeom-&gt;CreatePoint2d(0.0,0.0,&amp;pPt1); <span style="mso-tab-count: 1">&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Point2d&gt; pPt2;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pTrGeom-&gt;CreatePoint2d(4.0,3.0,&amp;pPt2);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create sketch points from above points</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get SkecthPoints</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;SketchPoints&gt; pSkPoints;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;get_SketchPoints(&amp;pSkPoints);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;SketchPoint&gt; pSpt1;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkPoints-&gt;Add(pPt1,VARIANT_FALSE,&amp;pSpt1); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;SketchPoint&gt; pSpt2;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkPoints-&gt;Add(pPt2,VARIANT_FALSE,&amp;pSpt2);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;SketchEntitiesEnumerator&gt; pRectangleLines;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get SketchLines</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;SketchLines&gt; pSkLines;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;get_SketchLines(&amp;pSkLines);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Creat a rectangle from two points</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkLines-&gt;AddAsTwoPointRectangle(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch *) pSpt1),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch *) pSpt2),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pRectangleLines);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 2"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a profile.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span></span><span style="font-family: ; color: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font color="#008000">// Get Profiles</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Profiles&gt; pSkProfiles;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Courier New"><font color="#000000"><span style="font-family: ; mso-ansi-language: fr; mso-no-proof: yes" lang="FR"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: ; mso-no-proof: yes">hr = pSketch-&gt;get_Profiles(&amp;pSkProfiles);</span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;ObjectCollection&gt; pOC;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>hr = pApp-&gt;TransientObjects-&gt;CreateObjectCollection(vtMissing, &amp;pOC);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Profile&gt; pSkProfile;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkProfiles-&gt;AddForSolid(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_FALSE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>CComVariant(pOC),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>vtMissing,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pSkProfile); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a base extrusion 1cm thick.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get Features</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;PartFeatures&gt; pFeatures;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pPartComponentDefinition-&gt;get_Features(&amp;pFeatures);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get Extrude Features</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr &lt;ExtrudeFeatures&gt; pExtrudeFeatures;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pFeatures-&gt;get_ExtrudeFeatures(&amp;pExtrudeFeatures);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create base extrusion</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: ; mso-no-proof: yes"><font color="#008000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// get Units object from document</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;UnitsOfMeasure&gt; pUOM;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pDocument-&gt;get_UnitsOfMeasure(&amp;pUOM);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComBSTR pAngUnits;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pUOM-&gt;GetStringFromValue(10.0*(pi/180.0) , _variant_t(</font><span style="color: "><font color="#a31515">&quot;deg&quot;</font></span><font color="#000000">), &amp;pAngUnits);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;ExtrudeFeature&gt; pExtrude;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>hr = pExtrudeFeatures-&gt;AddByDistanceExtent(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>pSkProfile,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t(1.0)</font><span style="color: "><font color="#008000">/* thickness in cm */</font></span><font color="#000000">,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kNegativeExtentDirection,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kJoinOperation, </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t(pAngUnits), </font><span style="color: "><font color="#008000">/* taper in radians */</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pExtrude);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span><span style="mso-spacerun: yes">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get the top face of the extrusion to use for creating the new sketch.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: ; mso-no-proof: yes"><font color="#008000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get StartFaces from base Extrusion</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Faces&gt; pFaces;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pExtrude-&gt;get_StartFaces(&amp;pFaces);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Face&gt; pFace;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>hr = pFaces-&gt;get_Item(1L,&amp;pFace);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160; </span><span style="mso-tab-count: 1">&#160;&#160; </span></font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a new sketch on this face, but use the method that allows you to</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// control the orientation and orgin of the new sketch.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: ; mso-no-proof: yes"><font color="#008000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get the fixed work Axis (X)</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkAxes&gt; pWorkAxes;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pPartComponentDefinition-&gt;get_WorkAxes(&amp;pWorkAxes);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkAxis&gt; pWorkAxis;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pWorkAxes-&gt;get_Item(_variant_t(1L),&amp;pWorkAxis);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Get the fixed work point (0,0,0)</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkPoints&gt; pWorkPoints;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pPartComponentDefinition-&gt;get_WorkPoints(&amp;pWorkPoints);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;WorkPoint&gt; pWorkPoint;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pWorkPoints-&gt;get_Item(_variant_t(1L),&amp;pWorkPoint);<span style="mso-spacerun: yes">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSketch=NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketches-&gt;AddWithOrientation(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch*)pFace),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch*)pWorkAxis),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_TRUE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_TRUE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch*)pWorkPoint), </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_FALSE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pSketch);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Determine where in sketch space the point (0.5,0.5,0) is.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Point&gt; pPt;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pTrGeom-&gt;CreatePoint(0.5,0.5,0.0,&amp;pPt);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Point2d&gt; pCorner1;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;ModelToSketchSpace(pPt,&amp;pCorner1);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span><span style="mso-spacerun: yes">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>CComPtr&lt;Point2d&gt; pCorner2;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pTrGeom-&gt;CreatePoint2d(pCorner1-&gt;GetX()+3,pCorner1-&gt;GetY()+2,&amp;pCorner2);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSpt1 = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSpt2 = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSkPoints=NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;get_SketchPoints(&amp;pSkPoints);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkPoints-&gt;Add(pCorner1,VARIANT_FALSE,&amp;pSpt1);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkPoints-&gt;Add(pCorner2,VARIANT_FALSE,&amp;pSpt2);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create the interior 3cm x 2cm rectangle for the pocket.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pRectangleLines = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSkLines = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;get_SketchLines(&amp;pSkLines);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkLines-&gt;AddAsTwoPointRectangle(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch*)pSpt1),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t((IDispatch*)pSpt2),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pRectangleLines);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 2"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Create a profile.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSkProfile = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pSkProfiles = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSketch-&gt;get_Profiles(&amp;pSkProfiles);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pSkProfiles-&gt;AddForSolid(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>VARIANT_FALSE,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>CComVariant(pOC),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>vtMissing,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pSkProfile); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color="#000000" face="Courier New">&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">//Create a pocket .25 cm deep with -10 deg taper.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>pExtrude = NULL;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>hr = pExtrudeFeatures-&gt;AddByDistanceExtent(</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>pSkProfile,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t(0.25),</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kNegativeExtentDirection,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>kCutOperation,</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>_variant_t(</font><span style="color: "><font color="#a31515">&quot;-10.0 deg&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#008000">// taper</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&amp;pExtrude);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (FAILED(hr)) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 2"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;<span style="mso-tab-count: 1">&#160; </span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">&#160;</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#008000">// Fit the view and set the camera to ISO TOP RIGHT</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;View&gt; pView;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pApp-&gt;get_ActiveView(&amp;pView);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pView-&gt;Fit(VARIANT_TRUE);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>CComPtr&lt;Camera&gt; pCamera;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pView-&gt;get_Camera(&amp;pCamera);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pCamera-&gt;put_ViewOrientationType(kIsoTopRightViewOrientation);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><font color="#000000"><span style="mso-tab-count: 1">&#160;&#160;&#160;&#160;&#160; </span>hr = pCamera-&gt;Apply();</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><span style="mso-tab-count: 1"><font color="#000000" face="Courier New">&#160;&#160;&#160;&#160;&#160; </font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font face="Courier New"><span style="mso-tab-count: 1"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> hr;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New">}</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><font color="#000000" face="Courier New"></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-no-proof: yes"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768b06134970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="img" border="0" alt="img" src="/assets/image_fb5555.jpg" width="504" height="358" /></a></span></p>
