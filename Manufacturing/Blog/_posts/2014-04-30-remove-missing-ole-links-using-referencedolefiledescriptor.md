---
layout: "post"
title: "Remove missing OLE Links using ReferencedOLEFileDescriptor"
date: "2014-04-30 12:38:07"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/04/remove-missing-ole-links-using-referencedolefiledescriptor.html "
typepad_basename: "remove-missing-ole-links-using-referencedolefiledescriptor"
typepad_status: "Draft"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>Here is a VBA example that uses the Delete method of the ReferencedOLEFileDescriptor in a part file to remove OLE links. SilentOperation of the Application is set to True to avoid dialogs. </p>  <p>Also the Dirty property of the document is set to True. I found that without doing this the save did not save to disk with the removed Links.</p>  <p>This ivb file has this code for removing the links in a part as well as removing the links in parts in an assembly. It is an update that removes OLE links to the AssemblyCount VBA example in the API help.</p>  <p>&#160;</p>  <p>Public Sub oleLinksDelete()    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; ThisApplication.SilentOperation = True     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160; Dim oPartDoc As PartDocument     <br />&#160;&#160;&#160;&#160; Set oPartDoc = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160; Dim bSaveDoc As Boolean     <br />&#160;&#160;&#160;&#160; bSaveDoc = False     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160; Dim oRefOleFileDesc As ReferencedOLEFileDescriptor     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160; If oPartDoc.ReferencedOLEFileDescriptors.Count &gt; 0 Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; For Each oRefOleFileDesc In _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.ReferencedOLEFileDescriptors     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'Debug.Print oRefOleFileDesc.ReferenceStatus     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If oRefOleFileDesc.ReferenceStatus = _     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kMissingReference Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Debug.Print oRefOleFileDesc.DisplayName     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRefOleFileDesc.Delete     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.Dirty = True     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bSaveDoc = True     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next oRefOleFileDesc     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; If bSaveDoc = True Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.Save     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bSaveDoc = False     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160; <font color="#0000ff">' Be sure to set this back to False      <br /></font>&#160;&#160;&#160;&#160; ThisApplication.SilentOperation = False     <br />End Sub</p>
