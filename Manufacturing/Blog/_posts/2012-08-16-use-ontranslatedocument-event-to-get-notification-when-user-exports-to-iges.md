---
layout: "post"
title: "Use OnTranslateDocument event to get notification when user exports to IGES"
date: "2012-08-16 17:44:14"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/use-ontranslatedocument-event-to-get-notification-when-user-exports-to-iges.html "
typepad_basename: "use-ontranslatedocument-event-to-get-notification-when-user-exports-to-iges"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>If you need to get a notification when the user exports to other formats such as IGES, STEP or SAT use the <strong>ApplicationEvents.OnTranslateDocument</strong> event. This event is fired when a document is translated to a different format. The code snippet below is a C# example.</p>  <p>This SDK project shows how to use events in VB.NET:</p>  <p><em>C:\Users\Public\Documents\Autodesk\Inventor 2013\SDK\DeveloperTools\Tools\EventWatcher</em></p>  <p><strong>C# code snippet:</strong></p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px">&#160; <span style="color: blue">private</span> <span style="color: blue">void</span> InitEvent()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAppEvents = _invApp.ApplicationEvents;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAppEvents.OnTranslateDocument += </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span></p>    <p style="margin: 0px"><span style="color: #2b91af">ApplicationEventsSink_OnTranslateDocumentEventHandler</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oAppEvent_OnTranslateDocument);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">void</span> oAppEvent_OnTranslateDocument</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">bool</span> TranslatingIn,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: #2b91af">_Document</span> DocumentObject,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">string</span> FullFileName,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">EventTimingEnum</span> BeforeOrAfter,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">NameValueMap</span> Context,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">out</span> <span style="color: #2b91af">HandlingCodeEnum</span> HandlingCode)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">string</span> extension = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; System.IO.<span style="color: #2b91af">Path</span>.GetExtension(FullFileName);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (extension == <span style="color: #a31515">&quot;.igs&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: #2b91af">MessageBox</span>.Show(<span style="color: #a31515">&quot;saving to a .igs file&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span> <span style="color: blue">if</span> (extension == <span style="color: #a31515">&quot;.jpg&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.</p>    <p style="margin: 0px">&#160;&#160; <span style="color: #2b91af">MessageBox</span>.Show(<span style="color: #a31515">&quot;saving to a .jpg file&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; HandlingCode = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">HandlingCodeEnum</span>.kEventNotHandled;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p> </div>
