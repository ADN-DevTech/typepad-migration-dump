---
layout: "post"
title: "Check if Occurrence is a Reference"
date: "2012-07-13 13:50:59"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/check-if-occurrence-is-a-reference.html "
typepad_basename: "check-if-occurrence-is-a-reference"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>There are two ways to do it. The official way is to check the BOMStructure value. The other way is checking the hidden Reference property value. This example shows both ways.</p>  <div style="font-family: ; background: white">   <div style="font-family: ; background: white">     <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> oDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">AssemblyDocument</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">oDoc = m_inventorApplication.ActiveDocument</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">' By checking the BOMStructure</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt" color="#000000"> (oDoc.ComponentDefinition.Occurrences(1). _</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; BOMStructure = </font></font><font style="font-size: 8pt"><span><font color="#2b91af">BOMStructureEnum</font></span><font color="#000000">.kReferenceBOMStructure) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; MsgBox(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Occurrence is a reference&quot;</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">' By checking the Reference property</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt"><font color="#000000"> (oDoc.ComponentDefinition.Occurrences(1).Reference) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; MsgBox(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Occurrence is a reference&quot;</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>   </div> </div>
