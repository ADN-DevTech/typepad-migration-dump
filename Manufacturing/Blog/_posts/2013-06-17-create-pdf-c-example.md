---
layout: "post"
title: "Create PDF C++ Example"
date: "2013-06-17 09:23:31"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/06/create-pdf-c-example.html "
typepad_basename: "create-pdf-c-example"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>There is a VBA example that uses the PDF translator in the Inventor API help file. Here is an example in C++. You can&#160; replace the code in the SimpleExe SDK example to test this code.&#160; (At this location on my system)&#160;&#160; </p>  <p>&quot;<em>C:\Users\Public\Documents\Autodesk\Inventor 2014\SDK\DeveloperTools\Samples\VC++\Standalone Applications\Inventor\SimpleExe&quot;</em> </p>  <p>It creates a pdf for each sheet and one PDF with all the sheets. </p>  <p>&lt;code_begin&gt;    <br />// SimpleExe.cpp : Defines the entry point for the console application. </p>  <p>#include &quot;stdafx.h&quot; </p>  <p>// Forward declarations    <br />static HRESULT PrintPDF(); </p>  <p>// Main. Note that all COM related activity (including the automatic 'release' within smart    <br />// pointers) MUST take place BEFORE CoUnitialize(). Hence the function 'block' within which     <br />// the smart-pointers construct and destruct (and AddRef and Release) keeping the CoUnitialize     <br />// safely out of the way. </p>  <p>int _tmain(int argc, _TCHAR* argv[])    <br />{     <br />HRESULT Result = NOERROR; </p>  <p>Result = CoInitialize (NULL); </p>  <p>if (SUCCEEDED(Result))    <br />Result = PrintPDF(); </p>  <p>CoUninitialize(); </p>  <p>return 0;    <br />} </p>  <p>   <br />static HRESULT PrintPDF()     <br />{     <br />HRESULT Result = NOERROR; </p>  <p>CLSID InvAppClsid;    <br />Result = CLSIDFromProgID (L&quot;Inventor.Application&quot;, &amp;InvAppClsid);     <br />if (FAILED(Result)) return Result; </p>  <p>CComPtr&lt;IUnknown&gt; pInvAppUnk;    <br />Result = ::GetActiveObject (InvAppClsid, NULL, &amp;pInvAppUnk);     <br />if (FAILED (Result))     <br />{     <br />_tprintf_s (_T(&quot;*** Could not get hold of an active Inventor application ***\n&quot;));     <br />return Result;     <br />} </p>  <p>CComPtr&lt;Application&gt; pInvApp;    <br />Result = pInvAppUnk-&gt;QueryInterface (__uuidof(Application), (void **) &amp;pInvApp);     <br />if (FAILED(Result)) return Result; </p>  <p>CComPtr&lt;Document&gt; pDoc;    <br />Result = pInvApp-&gt;get_ActiveDocument(&amp;pDoc);     <br />if (FAILED(Result)) return Result; </p>  <p>CComQIPtr&lt;DrawingDocument&gt; pDrawDoc = pDoc; </p>  <p>// Get the PDF translator Add-In.    <br />CComPtr&lt;ApplicationAddIns&gt; pAddIns;     <br />Result = pInvApp-&gt;get_ApplicationAddIns(&amp;pAddIns); </p>  <p>CComPtr&lt;ApplicationAddIn&gt; pAddIn;    <br />Result = pAddIns-&gt;get_ItemById(_bstr_t(&quot;{0AC6FD96-2F4D-42CE-8BE0-8AEA580399E4}&quot;), &amp;pAddIn);     <br />&#160; <br />CComQIPtr&lt;TranslatorAddIn&gt; pTransAddIn = pAddIn; </p>  <p>CComPtr&lt;TransientObjects&gt; pTransObjects;    <br />Result = pInvApp-&gt;get_TransientObjects(&amp;pTransObjects); </p>  <p>// Create the context.    <br />CComPtr&lt;TranslationContext&gt; pContext;     <br />Result = pTransObjects-&gt;CreateTranslationContext(&amp;pContext);     <br />Result = pContext-&gt;put_Type(kFileBrowseIOMechanism); </p>  <p>// Create a NameValueMap object    <br />CComPtr&lt;NameValueMap&gt; pOptions;     <br />Result = pTransObjects-&gt;CreateNameValueMap(&amp;pOptions); </p>  <p>// Create a DataMedium object    <br />CComPtr&lt;DataMedium&gt; pDataMedium;     <br />Result = pTransObjects-&gt;CreateDataMedium(&amp;pDataMedium); </p>  <p>// Check whether the translator has 'SaveCopyAs' options    <br />VARIANT_BOOL hasOptions;     <br />Result = pTransAddIn-&gt;get_HasSaveCopyAsOptions(pDrawDoc, pContext, pOptions, &amp;hasOptions);     <br />if (Result == S_OK)     <br />{     <br />CComPtr&lt;Sheets&gt;pSheets;     <br />Result = pDrawDoc-&gt;get_Sheets(&amp;pSheets); </p>  <p>long sheetCount;    <br />Result = pSheets-&gt;get_Count(&amp;sheetCount); </p>  <p>if (true)    <br />{     <br />for( int i=1; i&lt;=sheetCount; ++i)     <br />{     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Vector_Resolution&quot;), CComVariant(400)); </p>  <p>Result = pOptions-&gt;put_Value(_bstr_t(&quot;Sheet_Range&quot;), CComVariant(kPrintSheetRange));    <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_Begin_Sheet&quot;), CComVariant(i));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_End_Sheet&quot;), CComVariant(i)); </p>  <p>//Set the destination file name    <br />char filename[100];     <br />sprintf_s(filename, &quot;c:\\temp\\test%d.pdf&quot;, i); </p>  <p>pDataMedium-&gt;put_FileName(_bstr_t(filename)); </p>  <p>// Publish document.    <br />Result = pTransAddIn-&gt;SaveCopyAs(pDrawDoc, pContext, pOptions, pDataMedium); </p>  <p>}    <br />&#160;&#160; <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Sheet_Range&quot;), CComVariant(kPrintAllSheets));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_Begin_Sheet&quot;), CComVariant(1));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_End_Sheet&quot;), CComVariant(sheetCount));     <br />pDataMedium-&gt;put_FileName(_bstr_t(&quot;c:\\temp\\testPDF_all_Sheets_in_one.pdf&quot;)); </p>  <p>// Publish document.    <br />Result = pTransAddIn-&gt;SaveCopyAs(pDrawDoc, pContext, pOptions, pDataMedium);     <br />}     <br />else     <br />{     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Vector_Resolution&quot;), CComVariant(400));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Sheet_Range&quot;), CComVariant(kPrintSheetRange));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_Begin_Sheet&quot;), CComVariant(1));     <br />Result = pOptions-&gt;put_Value(_bstr_t(&quot;Custom_End_Sheet&quot;), CComVariant(sheetCount));     <br />&#160; <br />//Set the destination file name     <br />char filename[500];     <br />sprintf_s(filename, &quot;c:\\temp\\testAll.pdf&quot;); </p>  <p>pDataMedium-&gt;put_FileName(_bstr_t(filename)); </p>  <p>// Publish document.    <br />Result = pTransAddIn-&gt;SaveCopyAs(pDrawDoc, pContext, pOptions, pDataMedium);     <br />}     <br />} </p>  <p>return Result;    <br />}     <br /></p> &lt;code_end&gt;
