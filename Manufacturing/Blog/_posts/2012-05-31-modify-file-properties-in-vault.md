---
layout: "post"
title: "Modify File Properties in Vault"
date: "2012-05-31 23:59:36"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/modify-file-properties-in-vault.html "
typepad_basename: "modify-file-properties-in-vault"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong>    <br />While trying to write an app that allows me to update multiple file properties to a preset series of values, I was looking to use the Edit properties function of Vault Explorer. Can it be achieved through the Vault API?</p>  <p><strong>Solution</strong>    <br />If you have access to Vault Workgroup or Vault Collaboration or Vault Professional, it is possible to edit the file properties through the API ‘UpdateFileProperties’ from DocumentServiceExtensions service (not available in base version of Vault). </p>  <p>The UpdateFileProperties method can update the user defined property values, for example: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">PropInst</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">[] myInst = docSvcExt.UpdateFileProperties(fileMasterIds, propDefIds,</font></span></font><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt"> propValues, </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Property Update&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p> </div>  <p>If what you care about is a user defined property, then you are done at this point.&#160; However, if the property is mapped to a derived property, then things get more complex. </p>  <p>Here there are two definitions related:</p>  <ul>   <li>User Defined Property: A property that lives in the Vault and can be edited by a client. Also known as Custom Property.</li>    <li>Derived Property: A property that lives in the file. Editing can only be done by checking out the file, editing the file, and checking it back in.</li> </ul>  <p>For mapped property, you might need &quot;write back&quot; the user defined property to the file, and this can be done using ExplorerUtil.UpdateFileProperties method. For more details of this method, please read <a href="http://adndevblog.typepad.com/manufacturing/2012/05/can-i-use-vault-api-to-edit-a-file.html">this post</a> and Vault API help document. You can also do the ‘write back’ by yourself - check out the file via Vault API, and then use CAD product’s API to edit the file properties. For example, for Inventor file, you can use Inventor Apprentice API to edit the iProperties of the file. For more details of Inventor Apprentice please look at <a href="http://usa.autodesk.com/adsk/servlet/index?id=1079044&amp;siteID=123112">this page</a>.</p>  <p>You may also need run the &quot;property sync&quot; command from the UI or creating a property sync job. The ability to create a job is only available in Vault Collaboration or Vault Professional. </p>  <p>If you want to do a “property sync” via API, you can refer to this post: <a href="http://adndevblog.typepad.com/manufacturing/2012/05/add-property-synchronization-job.html">Add property synchronization job</a></p>
