---
layout: "post"
title: "Inventor 2014 API: Set Part material"
date: "2013-07-30 01:00:00"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/07/inventor-2014-api-set-part-material.html "
typepad_basename: "inventor-2014-api-set-part-material"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>  <p>With Inventor 2014 new API functionality has been introduced that fully supports consistent materials. The primary object in consistent materials is an Asset object, where Asset objects represent materials, physical properties, and colors (which are now referred to as appearances). An asset is essentially a collection of values. You may consider a material as a combination of its physical properties (density, yield strength, etc.) and how it looks or its appearance.</p>  <p>A material property has some basic information that identifies it â€“ name, description, type, etc., and it references a physical properties asset and an appearance asset. </p>  <p>Assets exist within libraries. Inventor API Help contains several code samples that write out all of the information associated with the material, appearance, and physical property assets.</p>  <p>The following VBA sample set desired material from the Autodesk Material Library to the active part. </p>  <p>&#160;</p>  <p><span style="font-family: "><font face="Consolas"><font color="#000000" size="1"></font></font></span></p>  <p><span style="font-family: "><font face="Consolas"><font color="#000000" size="1">Private Sub SetMaterialToPart()</font></font></span><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Dim oDoc As PartDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Set oDoc = ThisApplication.ActiveDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Dim Name As String</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Name = &quot;Copper&quot;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000" size="1">'<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Name = &quot;Steel&quot;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Dim localAsset As Asset</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>On Error Resume Next</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Set localAsset = oDoc.Assets.Item(Name)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>If Err Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>On Error GoTo 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' Failed to get the appearance</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' in the document, so import it.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' Get an asset library by name.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' Either the displayed name (which</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' can changed based on the current language)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' or the internal name</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' (which is always the same) can be used.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim assetLib As AssetLibrary</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set assetLib = ThisApplication.AssetLibraries _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>.Item(&quot;Autodesk Material Library&quot;)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000" size="1">'<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set assetLib = ThisApplication.AssetLibraries _</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span>'.Item(&quot;AD121259-C03E-4A1D-92D8-59A22B4807AD&quot;)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' Get an asset in the library</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim libAsset As Asset</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set libAsset = assetLib.MaterialAssets.Item(Name)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>' Copy the asset locally.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set localAsset = libAsset.CopyTo(oDoc)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>On Error GoTo 0</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>'set material to the part</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>oDoc.ActiveMaterial = localAsset</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" size="1">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>' Select the top browser node of the model pane.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>' This is a workaround to refresh materials info in the UI.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000"><font size="1"><span style="mso-spacerun: yes">&#160; </span>Call oDoc.BrowserPanes.ActivePane.TopNode.DoSelect</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000" size="1">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNoSpacing"><span style="font-family: "><font face="Consolas"><font color="#000000" size="1">End Sub</font></font></span></p>
