---
layout: "post"
title: "A Way to Identify the Intersection Plane of Two Extrude Features"
date: "2012-06-11 21:11:53"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/06/a-way-to-identify-the-intersection-plane-of-two-extrude-features.html "
typepad_basename: "a-way-to-identify-the-intersection-plane-of-two-extrude-features"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><b>Issue</b></p>  <p>I am exporting the extrude features' data in xml. Consider two extrude features, where one lies on another,I need to identify on which plane the extrude feature lies, then extract the information of the plane. Can you please let us know how to do that through API?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>To get the intersected plane of two features, there is no direct API for that, but it can be done using MeasureTools.GetMinimumDistance method. If the distance of two faces is zero, the two faces must overlap/intersect. Please refer to below sample code. </p>  <p>VBA sample code:</p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000" size="1" face="Courier New">Sub intersectionOf2Extrudes() </font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim extr1 As ExtrudeFeature </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim extr2 As ExtrudeFeature </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>'get two extrude features, here assuming the user selected them from UI </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set extr1 = ThisApplication.ActiveDocument.SelectSet.Item(1) </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set extr2 = ThisApplication.ActiveDocument.SelectSet.Item(2) </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>ThisApplication.ActiveDocument.SelectSet.Clear </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim faces1 As FaceCollection </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set faces1 = ThisApplication.TransientObjects.CreateFaceCollection </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim faces2 As FaceCollection </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Set faces2 = ThisApplication.TransientObjects.CreateFaceCollection </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim f1 As Face </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Dim f2 As Face </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>For Each f1 In extr1.Faces </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim d As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>For Each f2 In extr2.Faces </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>d = ThisApplication.MeasureTools.GetMinimumDistance(f1, f2) </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Debug.Print d </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>If d = 0 Then </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>ThisApplication.ActiveDocument.SelectSet.Select f2 </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim obj As Object </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Set obj = f2.Geometry </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Select Case f2.SurfaceType </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Case SurfaceTypeEnum.kPlaneSurface </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim objPlane As Plane </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Set objPlane = obj </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim rp() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim normal() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>obj.GetPlaneData rp, normal </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>'TODO: export the plane information </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Case SurfaceTypeEnum.kBSplineSurface </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim objBSpline As BSplineSurface </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Set objBSpline = obj </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim poles() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim knotsU() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim knotsV() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Dim weight() As Double </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>objBSpline.GetBSplineData poles, knotsU, knotsV, weight </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>'TODO: export the plane information </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Case Else 'ToDo: judge other type and get data accordingly </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160; </span>''do something here </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>End Select </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>End If </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>Next </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000"><font face="Courier New"><font size="1"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>Next </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNoSpacing"><font color="#000000" size="1" face="Courier New">End Sub</font></p>  <p>VB.NET sample code:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">' ThisApplication is a global variant that delegate Application object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">Sub</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> intersectionOf2Extrudes()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> extr1 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ExtrudeFeature</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> extr2 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ExtrudeFeature</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">'get two extrude features, here assuming the user selected them from UI</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; extr1 = ThisApplication.ActiveDocument.SelectSet.Item(1)</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; extr2 = ThisApplication.ActiveDocument.SelectSet.Item(2)</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; ThisApplication.ActiveDocument.SelectSet.Clear()</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> faces1 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FaceCollection</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; faces1 = ThisApplication.TransientObjects.CreateFaceCollection</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> faces2 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FaceCollection</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; faces2 = ThisApplication.TransientObjects.CreateFaceCollection</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> f1 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Face</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> f2 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Face</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">For</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">Each</font></span><span style="line-height: 11pt"><font color="#000000"> f1 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">In</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> extr1.Faces</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> d </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">For</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">Each</font></span><span style="line-height: 11pt"><font color="#000000"> f2 </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">In</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> extr2.Faces</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; d = ThisApplication.MeasureTools.GetMinimumDistance(f1, f2)</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; Debug.Print(d)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">If</font></span><span style="line-height: 11pt"><font color="#000000"> d = 0 </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ThisApplication.ActiveDocument.SelectSet.Select(f2)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> obj </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Object</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; obj = f2.Geometry</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Select</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">Case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> f2.SurfaceType</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SurfaceTypeEnum.kPlaneSurface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> objPlane </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Plane</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; objPlane = obj</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> rp(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> normal(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; obj.GetPlaneData(rp, normal)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">'TODO: export the plane information</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SurfaceTypeEnum.kBSplineSurface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> objBSpline </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> BSplineSurface</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; objBSpline = obj</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> poles(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> knotsU(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> knotsV(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> weight(0) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; objBSpline.GetBSplineData(poles, knotsU, knotsV, weight)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">'TODO: export the plane information</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">Case Else</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">'ToDo: judge other type and get data accordingly</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">''do something here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Select</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">End</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>
