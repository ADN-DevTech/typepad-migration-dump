---
layout: "post"
title: "Implement multiple interface in Vault customization"
date: "2014-04-09 01:12:01"
author: "Daniel Du"
categories:
  - "Daniel Du"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/04/implement-multiple-interface-in-vault-customization.html "
typepad_basename: "implement-multiple-interface-in-vault-customization"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/Daniel-Du.html">Daniel Du</a></p>  <p>When doing vault customization, we generally just make it one of the three types: explore plug-in, custom job or event hander, which means we probably just implement one of these three interfaces:&#160; IExplorerExtension, IJob, or IWebServiceExtension. But as you know, in .net it is possible to implement more than one interface, it applies to vault customization as well, sometimes, we have to do that, implementing multiple interface to do our job.</p>  <p>Let’s say&#160; we are trying to monitoring the life cycle state change event and then update the file properties on Vault Explorer, and of cause a class implementing IWebServiceExtension and then hooking the event in OnLoad is the direct solution. We can obtain IExplorerUtil within the UpdateFileLifecycleStateEvents.Post-event using LoadExplorerUtil. In general, it works fine, but when it is running in Vault Explorer, it will be problematic. When entities life cycle changed, the Explorer grid will be empty. We should use GetExplorerUtil, not LoadExplorerUtil if running inside Vault Explorer. We can call System.Diagnostics.Process.GetCurrentProcess().ProcessName to figure out what the running process is. But if we just implement the IWebServiceExtension interface, we cannot call GetExplorerUtil, as it need a an Instance of Autodesk.Connectivity.Explorer.Extensibility.IApplication as a parameter, what should we do? </p>  <p>In this case, we need to implement IExplorerExtension as well, here is a code sample: </p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: blue">assembly</span>: <span style="color: #2b91af">ApiVersion</span>(<span style="color: #a31515">&quot;6.0&quot;</span>)]<br />[<span style="color: blue">assembly</span>: <span style="color: #2b91af">ExtensionId</span>(<span style="color: #a31515">&quot;ff477652-5bdf-438d-975a-d8e61580d39c&quot;</span>)]<br /> <br /><span style="color: blue">namespace</span> MultiInterfaceSample<br />{<br />&#160;&#160;&#160; <span style="color: green">//if you rename this class name, please make sure change accordingly in vaultplugin.vcet.config</span><br />&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">Class1</span> : <span style="color: #2b91af">IWebServiceExtension</span>, <span style="color: #2b91af">IExplorerExtension</span><br />&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">private</span>&#160;<span style="color: #2b91af">IApplication</span> m_explorerApplication = <span style="color: blue">null</span>;<br /> <br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #region</span> IExplorerExtenion implemenation<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: #2b91af">IEnumerable</span>&lt;<span style="color: #2b91af">CommandSite</span>&gt; CommandSites()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">null</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />…<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">void</span> OnStartup(<span style="color: #2b91af">IApplication</span> application)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_explorerApplication = application;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DocumentServiceExtensions</span>.UpdateFileLifecycleStateEvents.Post += <br />             <span style="color: blue">new</span>&#160;<span style="color: #2b91af">EventHandler</span>&lt;<span style="color: #2b91af">UpdateFileLifeCycleStateCommandEventArgs</span>&gt;(UpdateFileLifecycleStateEvents_Post);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #endregion</span><br /> <br /> <br /> <br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #region</span> IWebServiceExtension implementation<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">void</span> OnLoad()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// regeister web service command events here if running outside Vault Explorer.</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// If running inside Vault Explorer, OnStartup is where these events are registered.</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (System.Diagnostics.<span style="color: #2b91af">Process</span>.GetCurrentProcess().ProcessName != <span style="color: #a31515">&quot;Connectivity.VaultPro&quot;</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DocumentServiceExtensions</span>.UpdateFileLifecycleStateEvents.Post += <br />                 <span style="color: blue">new</span>&#160;<span style="color: #2b91af">EventHandler</span>&lt;<span style="color: #2b91af">UpdateFileLifeCycleStateCommandEventArgs</span>&gt;(UpdateFileLifecycleStateEvents_Post);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">void</span> UpdateFileLifecycleStateEvents_Post(<span style="color: blue">object</span> sender, <span style="color: #2b91af">UpdateFileLifeCycleStateCommandEventArgs</span> e)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">IExplorerUtil</span> explorerUtil = <span style="color: blue">null</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">string</span> procName = System.Diagnostics.<span style="color: #2b91af">Process</span>.GetCurrentProcess().ProcessName;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (procName == <span style="color: #a31515">&quot;Connectivity.VaultPro&quot;</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; explorerUtil = <span style="color: #2b91af">ExplorerLoader</span>.GetExplorerUtil(m_explorerApplication);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">long</span> userId = 1;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; explorerUtil = <span style="color: #2b91af">ExplorerLoader</span>.LoadExplorerUtil(<span style="color: #a31515">&quot;server&quot;</span>, <span style="color: #a31515">&quot;vaultName&quot;</span>, userId, <span style="color: #a31515">&quot;ticket&quot;</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//implement your logic</span><br />&#160;&#160;&#160;&#160;&#160; <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #endregion</span><br />&#160;&#160;&#160; }<br />}</pre>

<p>&#160;</p>

<p>And here is the vcet.config file: </p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">&lt;?</span><span style="color: #a31515">xml</span><span style="color: blue">&#160;</span><span style="color: red">version</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;<span style="color: blue">&#160;</span><span style="color: red">encoding</span><span style="color: blue">=</span>&quot;<span style="color: blue">utf-8</span>&quot;<span style="color: blue"> ?&gt;</span><br /><span style="color: blue">&lt;</span><span style="color: #a31515">configuration</span><span style="color: blue">&gt;</span><br /><span style="color: blue">&#160; &lt;</span><span style="color: #a31515">connectivity.ExtensionSettings3</span><span style="color: blue">&gt;</span><br /><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">extension</span><br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">interface</span><span style="color: blue">=</span>&quot;<span style="color: blue">Autodesk.Connectivity.WebServices.IWebServiceExtension, <br />          Autodesk.Connectivity.WebServices, Version=18.0.0.0, Culture=neutral, PublicKeyToken=aa20f34aedd220e1</span>&quot;<br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">type</span><span style="color: blue">=</span>&quot;<span style="color: blue">MultiInterfaceSample.Class1, MultiInterfaceSample</span>&quot;<span style="color: blue">&gt;</span><br /><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">extension</span><span style="color: blue">&gt;</span><br /><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">extension</span><br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">interface</span><span style="color: blue">=</span>&quot;<span style="color: blue">Autodesk.Connectivity.Explorer.Extensibility.IExplorerExtension, <br />         Autodesk.Connectivity.Explorer.Extensibility, Version=18.0.0.0, Culture=neutral, PublicKeyToken=aa20f34aedd220e1</span>&quot;<br /><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">type</span><span style="color: blue">=</span>&quot;<span style="color: blue">MultiInterfaceSample.Class1, MultiInterfaceSample</span>&quot;<span style="color: blue">&gt;</span><br /><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">extension</span><span style="color: blue">&gt;</span><br /><span style="color: blue">&#160; &lt;/</span><span style="color: #a31515">connectivity.ExtensionSettings3</span><span style="color: blue">&gt;</span><br /><span style="color: blue">&lt;/</span><span style="color: #a31515">configuration</span><span style="color: blue">&gt;</span><br /></pre>

<p>&#160;</p>

<p>In fact, the JobProcessorApiSamples sample application that is packaged with the SDK is another example. Hope this helps.</p>
