---
layout: "post"
title: "Using Inventor View from 64 and 32 bit processes"
date: "2014-10-13 15:51:46"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/10/using-inventor-view-from-64-and-32-bit-process.html "
typepad_basename: "using-inventor-view-from-64-and-32-bit-process"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>As mentioned in <a href="http://adndevblog.typepad.com/manufacturing/2014/09/inventorviewctrlocx-2015-not-displaying-inventor-files.html" target="_self">this blog post</a> you need to use some workaround to get the <strong>Inventor View</strong>&#0160;<strong>2015</strong> component to show more than just a blank screen with a toolbar.&#0160;</p>
<p>You can set the <strong>PATH</strong> either system wide in <strong>System Properties</strong> &gt;&gt; <strong>Environment Variables</strong>, or just for your own application using&#0160;<strong>System.Environment.SetEnvironmentVariable()</strong></p>
<p>If you want to use <strong>Any CPU</strong> compilation for your application so that on a <strong>32 bit OS</strong> it runs as a <strong>32 bit process</strong> and on a <strong>64 bit OS</strong> it runs as a <strong>64 bit process</strong>, then you can just set the <strong>PATH</strong> variable to <strong>&lt;Inventor install path&gt;\Bin</strong></p>
<p>However, if you want to compile your application with the&#0160;<strong>x86</strong> platform option so that it always runs as a <strong>32 bit process</strong> no matter what OS it is on, then you could take advantage of the&#0160;<a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitoperatingsystem(v=vs.100).aspx" target="_self"><strong>Environment.Is64BitOperatingSystem</strong></a> property introduced in&#0160;<strong>.NET Framework 4.0</strong>, and could set the <strong>PATH</strong> variable based on the OS. To make the code work for all combinations of OS&#39;s and process bitnesses, you could use this in combination with&#0160;<a href="http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess(v=vs.110).aspx" target="_self"><strong>Environment.Is64BitProcess</strong></a>:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">public&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> AddInventorPath()</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Note: System.Environment.Is64BitProcess and</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// System.Environment.Is64BitProcess were</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// introduced in .NET Framework 4.0</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> path = <br />&#0160; &#0160; System.</span><span style="background: #ffffff; color: #2b91af;">Environment</span><span style="background: #ffffff; color: #000000;">.GetEnvironmentVariable(</span><span style="background: #ffffff; color: #a31515;">&quot;PATH&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// In case process and OS bitness match it&#39;s</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// C:\Program Files\Autodesk\Inventor 2015\</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// otherwise it&#39;s</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// C:\Program Files\Autodesk\Inventor 2015\bin\</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> inventorPath = m_oserver.InstallPath;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (System.</span><span style="background: #ffffff; color: #2b91af;">Environment</span><span style="background: #ffffff; color: #000000;">.Is64BitOperatingSystem &amp;&amp;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;!System.</span><span style="background: #ffffff; color: #2b91af;">Environment</span><span style="background: #ffffff; color: #000000;">.Is64BitProcess)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// If you are running the app as a 32 bit process </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// on a 64 bit OS then you&#39;ll need this</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;path += </span><span style="background: #ffffff; color: #a31515;">&quot;;&quot;</span><span style="background: #ffffff; color: #000000;"> + inventorPath + </span><span style="background: #ffffff; color: #a31515;">&quot;Bin32&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">else</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Otherwise you need this</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;path += </span><span style="background: #ffffff; color: #a31515;">&quot;;&quot;</span><span style="background: #ffffff; color: #000000;"> + inventorPath + </span><span style="background: #ffffff; color: #a31515;">&quot;Bin&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;System.</span><span style="background: #ffffff; color: #2b91af;">Environment</span><span style="background: #ffffff; color: #000000;">.SetEnvironmentVariable(</span><span style="background: #ffffff; color: #a31515;">&quot;PATH&quot;</span><span style="background: #ffffff; color: #000000;">, path);</span><br /> <span style="background: #ffffff; color: #000000;">}</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">public</span><span style="background: #ffffff; color: #000000;"> Form1()</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Try to create an instance of apprentice server</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">try</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;m_oserver = </span><span style="background: #ffffff; color: #0000ff;">new</span><span style="background: #ffffff; color: #2b91af;">ApprenticeServerComponent</span><span style="background: #ffffff; color: #000000;">();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;AddInventorPath();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">catch</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #2b91af;">SystemException</span><span style="background: #ffffff; color: #000000;"> exception)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MessageBox</span><span style="background: #ffffff; color: #000000;">.Show(</span><span style="background: #ffffff; color: #0000ff;">this</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;Failed to create an instance of Apprentice server.&quot;</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;CSharpFileDisplaySample&quot;</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MessageBoxButtons</span><span style="background: #ffffff; color: #000000;">.OK, </span><span style="background: #ffffff; color: #2b91af;">MessageBoxIcon</span><span style="background: #ffffff; color: #000000;">.Warning);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;m_odocument = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;m_oview = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;m_ocamera = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;m_bmouseDown = </span><span style="background: #ffffff; color: #0000ff;">false</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">//</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Required for Windows Form Designer support</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">//</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;InitializeComponent();</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>I started with the <strong>C:\Users\Public\Documents\Autodesk\Inventor 2015\SDK\DeveloperTools\Samples\VCSharp.NET\Standalone Applications\ApprenticeServer\FileDisplay</strong>&#0160;sample as a test, but got this error when running the application if I changed the project&#39;s <strong>Target framework</strong> to <strong>.NET Framework 4</strong>:</p>
<pre>System.IO.FileNotFoundException was unhandled
  HResult=-2147024894
  Message=Could not load file or assembly &#39;Interop.InventorApprentice, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&#39; or one of its dependencies. The system cannot find the file specified.</pre>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6f2cbfb970b-pi" style="display: inline;"><img alt="Error" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b7c6f2cbfb970b image-full img-responsive" src="/assets/image_52b2ad.jpg" title="Error" /></a></p>
<p>I had the same issue even after changing the&#0160;<strong>Interop.InventorViewControlLib</strong> assembly&#39;s <strong>Embed Interop Types</strong> to <strong>False</strong>. So I created new interop assemblies for the <strong>Inventor View</strong> component following this info:&#0160;<a href="http://adndevblog.typepad.com/autocad/2012/07/use-64-bit-activex-component-from-a-net-assembly.html" target="_self" title="">http://adndevblog.typepad.com/autocad/2012/07/use-64-bit-activex-component-from-a-net-assembly.html</a></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0797e80a970d-pi" style="display: inline;"><img alt="Aximp" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb0797e80a970d image-full img-responsive" src="/assets/image_60f0b7.jpg" title="Aximp" /></a></p>
<p>Then I replaced the references in the project with the newly created ones, but still got the same error. However, once I changed the&#0160;<strong>InventorViewControlLib</strong>&#0160;assembly&#39;s&#0160;<strong>Embed Interop Types</strong>&#0160;to&#0160;<strong>False</strong> the error went away.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6f2c6c2970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="EmbedInteropTypes" class="asset  asset-image at-xid-6a0167607c2431970b01b7c6f2c6c2970b img-responsive" src="/assets/image_c359f8.jpg" style="width: 400px;" title="EmbedInteropTypes" /></a></p>
<p>See the sample in action:</p>
<p><iframe allowfullscreen="" frameborder="0" height="315" src="//www.youtube.com/embed/iuaeAvn0Rdk" width="560"></iframe></p>
<p><strong>Sample project</strong>: <a href="https://github.com/adamenagy/InventorView-FileDisplay-.NET-4.0" target="_self" title="">https://github.com/adamenagy/InventorView-FileDisplay-.NET-4.0</a>&#0160;</p>
