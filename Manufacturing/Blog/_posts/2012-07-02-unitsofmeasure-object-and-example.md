---
layout: "post"
title: "UnitsOfMeasure object and example"
date: "2012-07-02 05:22:49"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/unitsofmeasure-object-and-example.html "
typepad_basename: "unitsofmeasure-object-and-example"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html" target="_blank">Augusto Goncalves</a></p>  <p>UnitsOfMeasure is an object that helps conversion of values from and to Inventorâ€™s database units. Inventor internally always uses <strong>cm</strong> (centimeters) for length, <strong>radians</strong> for angle, <strong>kg</strong> (kilograms) for mass and <strong>seconds</strong> for time. But the user can choose to work in another units, which can be set by this object. The various API methods, for example, creation of sketch entities, always take values that are in the internal database units. When a <strong>SketchPoint</strong> object is created whose coordinates are say (5,5), the values are always in <strong>cm</strong> even though the user may have his default units set to <strong>inches</strong>. Another example is the creation of parameters using the API, the methods always take the values of the parameters in the internal database units.</p>  <p>Consider the scenario of a program that accepts new parameter values from an end-user using a form and passes this value to a method that updates the parameter value. The end-user assumes that the values that he enters are in the default units that he has set up and it would not be intuitive to ask the user to convert the values to the internal database units before passing it on to the API method that updates the parameter value.</p>  <p>The <strong>UnitsOfMeasure</strong> object is very useful, in this case, to allow conversion from one unit system to the other. This object supports the following methods to help convert values and strings from one unit type to another:</p>  <p>1. <em><strong>GetStringFromType</strong></em>(UnitsType as UnitsTypeEnum) as String    <br />This method returns the string representation of the unit type for the UnitTypeEnum parameter that is passed in. For example, when kCentimeterLengthUnits is supplied, &quot;centimeter&quot; is returned. The items in the list box on the right are displayed by making use of this method.</p>  <p>2. <strong><em>GetTypeFromString</em></strong>(UnitsString As String) As UnitsTypeEnum    <br />This method returns the reverse of the above method, i.e. it returns the UnitTypeEnum for the string representation that is passed in. For example, when <strong>centimeter</strong> or &quot;<strong>cm</strong>&quot; is passed in, kCentimeterLengthUnits is returned.</p>  <p>3. <strong><em>GetStringFromValue</em></strong>(Value As Double, UnitsSpecifier) As String    <br />This method returns the value along with the units for the value and the unit type in which you want the returned value to be specified in. The unit type of the Value parameter is the internal units that Inventor uses and are converted to the desired unit type as specified by the UnitsSpecifier parameter, which can be a string or the UnitsTypeEnum. For example, if parameters 2.0 and &quot;in&quot; (or &quot;inches&quot; or kInchLengthUnits) are passed in, the string that would be returned is &quot;0.787 in&quot;.</p>  <p>4. <em><strong>GetValueFromExpression</strong></em>(Expression As String, UnitsSpecifier) As Double    <br />When an expression is passed in, this method returns the value in the internal units, the UnitsSpecifier is used to indicate the unit type of any number that is part of the string and which doesn't have a string next to it to indicate its unit type. For example, if the string &quot; 2 + 3 cm&quot; and kInchLengthUnits is passed in, the unit type of 2 is inches and so the returned value would be 8.08 (the equivalent of 2in + 3cm in cm units).</p>  <p>The UnitsOfMeasure object can be queried from the Document object</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font style="font-size: 8pt" color="#008000">'get the units of measure object</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">oUOM = oDoc.UnitsOfMeasure</font></font></p> </div>
