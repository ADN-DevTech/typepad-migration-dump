---
layout: "post"
title: "Getting properties of file interation with Vault Development Framework in Vault 2014 API"
date: "2013-12-11 22:04:21"
author: "Daniel Du"
categories:
  - "Daniel Du"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/12/getting-properties-of-file-interation-with-vault-development-framework-in-vault-2014-api.html "
typepad_basename: "getting-properties-of-file-interation-with-vault-development-framework-in-vault-2014-api"
typepad_status: "Publish"
---

<pre style="font-size: 13px; font-family: consolas; background: white; color: black">By <a href="http://adndevblog.typepad.com/manufacturing/Daniel-Du.html">Daniel Du</a></pre>
<p>&nbsp;</p>
<p>I am playing with the Vault Development Framwork(VDF) which is provided from Autodesk Vault 2014, here is a demo of getting fileâ€™s properties with VDF. I am doing in C#, and I just noticed that Wayne did a similar sample in VB.net <a href="http://adndevblog.typepad.com/manufacturing/2013/11/vault-2014-api-example-getting-property-values-of-a-file.html">here</a>. </p>
<p>In Vault 2013 or earlier version, we can get properties with PropertyService PropertyManager. While in Vault 2014, with VDF we have a new way to do that, we can get the properties with PropertyManager, following code snippet demos how to login to Vault and get property manager. With VDF, it is easy to login vault with a built-in well designed UI, or a non-UI way if prefer:</p><pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">////login with UI</span>
<span style="color: green">//VDF.Vault.Currency.Connections.Connection connection = VDF.Vault.Forms.Library.Login(new VDF.Vault.Forms.Settings.LoginSettings());</span>
 
<span style="color: green">//Another way to log into Vault without UI</span>
VDF.Vault.Results.<span style="color: #2b91af">LogInResult</span> results =
		VDF.Vault.<span style="color: #2b91af">Library</span>.ConnectionManager.LogIn(
				<span style="color: #a31515">"localhost"</span>, <span style="color: #a31515">"Vault"</span>, <span style="color: #a31515">"Administrator"</span>, <span style="color: #a31515">""</span>,
				VDF.Vault.Currency.Connections.<span style="color: #2b91af">AuthenticationFlags</span>.Standard, <span style="color: blue">null</span>);
<span style="color: blue">if</span> (!results.Success)
{
	<span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"Login failed. exit..."</span>);
	<span style="color: #2b91af">Console</span>.ReadLine();
	<span style="color: blue">return</span>;
}
 
VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> connection = results.Connection;
 
VDF.Vault.Services.Connection.<span style="color: #2b91af">IPropertyManager</span> propMgr = connection.PropertyManager;</pre>
<p>&nbsp;</p>
<p>In this sample, I firstly get all folders/file entities in vault, talking about this, the first idea comes to my head is to use FolderManager and FileManager, but with help of Daniel Dulzo, one of my Vault API expert colleauges, I will use </p>
<p>IEntityOperationManager, which can be accessed off of a connection object through the EntityOperations property, provides a set of methods that can be used on generic IEntity instances. So while I checked for a method to get child files in both the FileManager and the FolderManager, the method to get child entities actually exists on the IEntityOperationManager because it is generic to all entities. 
<p>&nbsp; <p>OK, here are the code snippet: </p>
<p>&nbsp;</p><pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">using</span> Autodesk.Connectivity.WebServices;<br><span style="color: blue">using</span> System;<br><span style="color: blue">using</span> System.Collections.Generic;<br><span style="color: blue">using</span> System.Linq;<br><span style="color: blue">using</span> VDF = Autodesk.DataManagement.Client.Framework;<br> <br><span style="color: blue">namespace</span> VaultLabs<br>{<br>&nbsp; <span style="color: blue">class</span>&nbsp;<span style="color: #2b91af">Lab03</span><br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; <span style="color: green">// We will collect Property Definitions here</span><br>&nbsp;&nbsp;&nbsp; <span style="color: blue">static</span> VDF.Vault.Currency.Properties.<span style="color: #2b91af">PropertyDefinitionDictionary</span> propDefs;<br> <br>&nbsp;&nbsp;&nbsp; <span style="color: green">// The entry point of the program</span><br>&nbsp;&nbsp;&nbsp; <span style="color: green">//==========================================================================</span><br>&nbsp;&nbsp;&nbsp; <span style="color: blue">static</span>&nbsp;<span style="color: blue">void</span> Main(<span style="color: blue">string</span>[] args)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">try</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">////login with UI</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//VDF.Vault.Currency.Connections.Connection connection </span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = VDF.Vault.Forms.<span style="color: #2b91af">Library</span>.Login(<span style="color: blue">new</span> VDF.Vault.Forms.Settings.<span style="color: #2b91af">LoginSettings</span>());<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//Another way to log into Vault without UI</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Results.<span style="color: #2b91af">LogInResult</span> results =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.<span style="color: #2b91af">Library</span>.ConnectionManager.LogIn(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #a31515">"localhost"</span>, <span style="color: #a31515">"Vault"</span>, <span style="color: #a31515">"Administrator"</span>, <span style="color: #a31515">""</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Connections.<span style="color: #2b91af">AuthenticationFlags</span>.Standard, <span style="color: blue">null</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (!results.Success)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"Login failed. exit..."</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ReadLine();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">return</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> connection = results.Connection;<br> <br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (connection.IsConnected)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReadProperties(connection);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">Folder</span> folder = connection.FolderManager.RootFolder;<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PrintChildren(connection, folder);<br> <br> <br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ResetColor();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">""</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"Press any key to exit..."</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ReadKey();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br> <br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">catch</span> (<span style="color: #2b91af">Exception</span> ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"ERROR: {0}"</span>, ex.Message);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; } <span style="color: green">// Main()</span><br> <br> <br>&nbsp;&nbsp;&nbsp; <span style="color: green">// Read all the Property Definitions for the "FILE" Entity Class</span><br>&nbsp;&nbsp;&nbsp; <span style="color: green">//===============================================================================</span><br>&nbsp;&nbsp;&nbsp; <span style="color: blue">static</span>&nbsp;<span style="color: blue">void</span> ReadProperties(VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> connection)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; propDefs =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connection.PropertyManager.GetPropertyDefinitions(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">EntityClassIds</span>.Files,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">null</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Properties.<span style="color: #2b91af">PropertyDefinitionFilter</span>.IncludeUserDefined<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br> <br> <br>&nbsp;&nbsp;&nbsp; }<br> <br> <br>&nbsp;&nbsp;&nbsp; <span style="color: green">// Output information about each file in a folder along with its properties</span><br>&nbsp;&nbsp;&nbsp; <span style="color: green">//===========================================================================</span><br>&nbsp;&nbsp;&nbsp; <span style="color: blue">static</span>&nbsp;<span style="color: blue">void</span> PrintChildren(VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> connection,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">Folder</span> parentFolder)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ForegroundColor = <span style="color: #2b91af">ConsoleColor</span>.Cyan;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"{0}"</span>, parentFolder.FullName);<br> <br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">IEnumerable</span>&lt;VDF.Vault.Currency.Entities.<span style="color: #2b91af">IEntity</span>&gt; entities = connection<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .EntityOperations.GetBrowseChildren(parentFolder);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (entities != <span style="color: blue">null</span> &amp;&amp; entities.Count&lt;VDF.Vault.Currency.Entities.<span style="color: #2b91af">IEntity</span>&gt;() &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">foreach</span> (<span style="color: blue">var</span> ent <span style="color: blue">in</span> entities)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (ent <span style="color: blue">is</span> VDF.Vault.Currency.Entities.<span style="color: #2b91af">FileIteration</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">FileIteration</span> fileIteration<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = ent <span style="color: blue">as</span> VDF.Vault.Currency.Entities.<span style="color: #2b91af">FileIteration</span>;<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ForegroundColor = <span style="color: #2b91af">ConsoleColor</span>.Green;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">" {0}"</span>, fileIteration.EntityName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.ForegroundColor = <span style="color: #2b91af">ConsoleColor</span>.Yellow;<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//Now print the properties of the file</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PrintProperties(connection, fileIteration);<br> <br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">else</span>&nbsp;<span style="color: blue">if</span> (ent <span style="color: blue">is</span> VDF.Vault.Currency.Entities.<span style="color: #2b91af">Folder</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Recursively print info about subfolders and files in them</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">//-------------------------------------------------------------------------</span><br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">Folder</span> folder<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = ent <span style="color: blue">as</span> VDF.Vault.Currency.Entities.<span style="color: #2b91af">Folder</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PrintChildren(connection, folder);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; }<br> <br> <br>&nbsp;&nbsp;&nbsp; <span style="color: blue">static</span>&nbsp;<span style="color: blue">void</span> PrintProperties(VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> connection,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VDF.Vault.Currency.Entities.<span style="color: #2b91af">FileIteration</span> fileInteration)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">foreach</span> (<span style="color: blue">var</span> key <span style="color: blue">in</span> propDefs.Keys)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Print the Name from the Definition and the Value from the Property</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">object</span> propValue = connection.PropertyManager.GetPropertyValue(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileInteration, propDefs[key], <span style="color: blue">null</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">"&nbsp; '{0}' = '{1}'"</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; key.ToString(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; propValue == <span style="color: blue">null</span> ? <span style="color: #a31515">""</span> : propValue.ToString());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br> <br> <br>&nbsp; } <span style="color: green">// class Lab03</span><br> <br>} <span style="color: green">// namespace VaultLabs</span><br></pre>
