---
layout: "post"
title: "Calling translator add-in from external application"
date: "2013-01-30 08:20:40"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/01/calling-translator-add-in-from-external-application.html "
typepad_basename: "calling-translator-add-in-from-external-application"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Actually this can be done with any add-in, including custom add-ins loaded on Inventor, as shown at this <a href="http://adndevblog.typepad.com/manufacturing/2012/07/connect-to-an-inventor-add-in-an-external-application.html">blog post</a>.</p>  <p>Here we show how get a built-in Translator add-in and call its <strong>SaveAsCopy</strong> method. This will create a .igs file for the current open .ipt file. For simplicity, minimal error check is included on the code.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// get the &quot;Translator: IGES&quot; addin</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ApplicationAddIn</font></span><font color="#000000"> addin = _inventorApp.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; ApplicationAddIns.get_ItemById(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{90AF7F44-0C01-11D5-8E83-0010B541CD80}&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// check if is a valid translator add-in</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">TranslatorAddIn</font></span><font color="#000000"> igsSaveAs = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; addin </font></font><font style="font-size: 8pt"><span><font color="#0000ff">as</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">TranslatorAddIn</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (igsSaveAs == </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Unable to get the translator add-in&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// context object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">TranslationContext</font></span><font color="#000000"> context = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _inventorApp.TransientObjects.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; CreateTranslationContext();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">context.Type = Inventor.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">IOMechanismEnum</font></span><font color="#000000">.kFileBrowseIOMechanism;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// and the data parameter</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">DataMedium</font></span><font color="#000000"> data = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _inventorApp.TransientObjects.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; CreateDataMedium();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">data.FileName = </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;c:\\temp\\file.igs&quot;</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// configure the options...</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">NameValueMap</font></span><font color="#000000"> options = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _inventorApp.TransientObjects.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; CreateNameValueMap();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt" color="#000000"> (igsSaveAs.get_HasSaveCopyAsOptions(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _inventorApp.ActiveDocument,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; context, options))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; options.Value[</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;GeometryType&quot;</font></span><font color="#000000">] = 1;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; options.Value[</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;SolidFaceType&quot;</font></span><font color="#000000">] = 0;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; options.Value[</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;SurfaceType&quot;</font></span><font color="#000000">] = 0;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// finally save as the file as .igs</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">igsSaveAs.SaveCopyAs(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _inventorApp.ActiveDocument,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; context, options, data);</font></font></p> </div>
