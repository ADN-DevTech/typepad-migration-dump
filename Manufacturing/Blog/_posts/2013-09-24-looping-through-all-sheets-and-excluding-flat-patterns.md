---
layout: "post"
title: "Looping through all sheets and excluding flat patterns"
date: "2013-09-24 03:03:00"
author: "Xiaodong Liang"
categories:
  - "iLogic"
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/09/looping-through-all-sheets-and-excluding-flat-patterns.html "
typepad_basename: "looping-through-all-sheets-and-excluding-flat-patterns"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Question</strong>:     <br />I have an iLogic rule that automatically adds centerlines to cylindrical elements and holes. It runs on save. Is there a way to</p>  <p>A) Make that rule loop through each sheet in the drawing file? Right now it loops through each view on the active sheet and I'm not sure how to get the total sheet count to make another loop for that.</p>  <p>B) Is there a way I can conditionally check if the view is a flat pattern or not? I'd like to use an IF statement to exclude applying the center marks to the flat.</p>  <p><strong>Solution</strong>:     <br />For question ( A )</p>  <p>iLogic is based on VB.NET. The Sheets or Views is a kind of collection you will have two ways to iterate: either get the collection count and define an index variable, e.g.</p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font style="font-size: 10pt" color="#808080">' assume this is a collection</font></font></span></i></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000"><font style="font-size: 10pt">Dim</font></font></span></b><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt" color="#800000">oObj_Array</font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font style="font-size: 10pt">&#160;</font></font></span></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font style="font-size: 10pt" color="#808080">'iterate by index</font></font></span></i></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000"><font style="font-size: 10pt">Dim</font></font></span></b><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt" color="#800000">i</font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000"><font style="font-size: 10pt">For</font></font></span></b><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#800000">i</font></span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> <b>=</b> <b>0</b> </span><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000">To</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt"> </font><b><font style="font-size: 10pt">10</font></b></span></font></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160; </font></span></span><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt" color="#808080">'get each object in the collection</font></span></i></font></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160; </font></span></span><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#800000">oEachObj</font></span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes">&#160; </span><b>=</b><span style="mso-spacerun: yes">&#160; </span></span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#800000">oObj_Array</font></span><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;">(</span></b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#800000">i</font></span></font><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt">)</font></span></b></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font style="font-size: 10pt" color="#ff0000">Next</font></font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal">&#160;</p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal">or enumerate the element of the collection </p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal">&#160;</p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font style="font-size: 10pt" color="#808080">'enumerate the element of the collection </font></font></span></i></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000"><font style="font-size: 10pt">For</font></font></span></b><font style="font-size: 10pt"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#800000">oEachObj</font></span><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000">In</font></span></b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"> </span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font style="font-size: 10pt" color="#800000">oObj_Array</font></span></font><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></p>  <p style="margin: 0cm 0cm 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt" class="MsoNormal"><font face="Courier New"><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160; </font></span></span><font style="font-size: 10pt" color="#808080"><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;">'</span></i></font></font><font color="#808080"><font style="font-size: 10pt"><i><span style="font-family: ; color: ; mso-bidi-font-family: &#39;MS Mincho&#39;" lang="ZH-CN"><font face="MS Mincho">可直接</font></span></i></font><i><span style="font-family: ; color: ; mso-bidi-font-family: simsun" lang="ZH-CN"><font face="SimSun"><font style="font-size: 10pt">访问每个对象</font></font></span></i></font><i><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></i></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#ff0000">Next</font></font></span></b></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000" size="3" face="Times New Roman"></font></span></b></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000" size="3" face="Times New Roman"></font></span></b></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000" size="3" face="Times New Roman"></font></span></b></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><b><span style="font-family: ; color: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#ff0000" size="3" face="Times New Roman">&#160;</font></span></b></p>  <p>For question ( B ): The property DrawingView.IsFlatPatternView tells you if this drawing view is of a sheet metal flat pattern.</p>  <p>So the iLogic code could be:</p>  <p><span style="color: "><font color="#800000"><font style="font-size: 12pt">doc</font></font></span><font style="font-size: 12pt"><span style="color: "> </span><span style="color: "><strong>=</strong></span><span style="color: "> </span><span style="color: "><font color="#800080"><strong>ThisDoc</strong></font></span><span style="color: ">.</span><span style="color: "><font color="#800080"><strong>Document</strong></font></span><span style="color: ">        <br /></span><span style="color: "><font color="#ff0000"><strong>For</strong></font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>Each</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">oSheet</font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>In</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">doc</font></span><span style="color: ">.</span><span style="color: "><font color="#800000">Sheets</font></span><span style="color: ">        <br />&#160; </span><span style="color: "><font color="#ff0000"><strong>For</strong></font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>Each</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">oView</font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>In</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">oSheet</font></span><span style="color: ">.</span><span style="color: "><font color="#800000">DrawingViews</font></span><span style="color: ">        <br />&#160;&#160;&#160; </span><span style="color: "><font color="#ff0000"><strong>If</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">oView</font></span><span style="color: ">.</span><span style="color: "><font color="#800000">IsFlatPatternView</font></span><span style="color: ">&#160; </span><span style="color: "><font color="#ff0000"><strong>Then</strong></font></span><span style="color: ">        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: "><font color="#800080"><strong>MessageBox</strong></font></span><span style="color: ">.</span><strong><span style="color: "><font color="#800080">Show</font></span><span style="color: ">(</span></strong><font color="#008080"><span style="color: ">&quot;</span><span style="color: ">[Sheet Name] </span><span style="color: ">&quot;</span></font><span style="color: "><font color="#ff0000"><strong>+</strong></font></span><span style="color: "> </span><span style="color: "><font color="#800000">oSheet</font></span><span style="color: ">.</span><span style="color: "><font color="#800080"><strong>Name</strong></font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>+</strong></font></span><span style="color: "> </span><font color="#008080"><span style="color: ">&quot;</span><span style="color: ">[View Name] </span><span style="color: ">&quot;</span></font><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>+</strong></font></span><span style="color: ">        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: "><font color="#800000">oView</font></span><span style="color: ">.</span><span style="color: "><font color="#800080"><strong>Name</strong></font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>+</strong></font></span><span style="color: "> </span><font color="#008080"><span style="color: ">&quot;</span><span style="color: "> This is a view from flatpattern</span><span style="color: ">&quot;</span></font><span style="color: ">, </span><font color="#008080"><span style="color: ">&quot;</span><span style="color: ">Title</span><span style="color: ">&quot;</span></font><span style="color: "><strong>)</strong></span><span style="color: ">        <br />&#160;&#160;&#160; </span><span style="color: "><font color="#ff0000"><strong>End</strong></font></span><span style="color: "> </span><span style="color: "><font color="#ff0000"><strong>If</strong></font></span><span style="color: ">        <br />&#160; </span><span style="color: "><font color="#ff0000"><strong>Next</strong></font></span><span style="color: ">        <br /></span></font><span style="color: "><font style="font-size: 12pt" color="#ff0000"><strong>Next</strong></font></span></p>
