---
layout: "post"
title: "Overriding the Inventor native &quot;File Open&quot; and &quot;File SaveAs&quot; dialog boxes"
date: "2012-12-02 07:37:44"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/12/overriding-the-inventor-native-file-open-and-file-saveas-dialog-boxes.html "
typepad_basename: "overriding-the-inventor-native-file-open-and-file-saveas-dialog-boxes"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>  <p><b>Issue</b></p>  <p>How to override the Inventor native &quot;File Open&quot; and &quot;File Save As&quot; dialog boxes?</p>  <p><b></b></p>  <p><b>Solution</b></p>  <p>It is possible to override the Inventor's native FileOpen and FileSave dialog boxes. This would normally be done by overriding the FileUIEvents_OnFileOpenDialog or FileUIEvents_OnFileSaveAsDialog method respectively. When you override the event methods, you could choose to implement your own functionality as part of the event methods, thus allowing you to, for example, display your own custom dialog boxes. One of the options could be to use Microsoft's common &quot;File Open&quot; or &quot;Save As&quot; dialogs.</p>  <p>The following shows the VB code when the &quot;FileUIEvents_OnFileOpenDialog&quot; event has been overridden to display a custom file open dialog box:</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font color="#0000ff"><font style="font-size: 10pt">Private</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> m_FileUIEvents_OnFileOpenDialog_1( _</font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">ByRef</font></span><font color="#000000"> FileTypes() </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000">, _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> ParentHWND </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000">, _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">ByRef</font></span><font color="#000000"> FileName </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000">, _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> Context </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">NameValueMap</font></span><font color="#000000">, _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">ByRef</font></span><font color="#000000"> HandlingCode </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">HandlingCodeEnum</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><span><font style="font-size: 10pt" color="#008000">'<span style="mso-spacerun: yes">&#160;&#160; </span>USE YOUR OWN CUSTOM FILE DIALOG </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><span><font style="font-size: 10pt" color="#008000">'<span style="mso-spacerun: yes">&#160;&#160; </span>e.g. Microsoft's FileOpenDialog</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><span><font style="font-size: 10pt" color="#008000">'<span style="mso-spacerun: yes">&#160;&#160; </span>Display the dialog for the user to enter a filename.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> m_FileOpenForm </font><span><font color="#0000ff">As</font></span><font color="#000000"> System.Windows.Forms.</font><span><font color="#2b91af">OpenFileDialog</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">= </font></font><font style="font-size: 10pt"><span><font color="#0000ff">New</font></span><font color="#000000"> System.Windows.Forms.</font></font><span><font style="font-size: 10pt" color="#2b91af">OpenFileDialog</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">With</font></span><font color="#000000"> m_FileOpenForm</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font></span><span><font style="font-size: 10pt" color="#008000">'Set the initial Directory</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.InitialDirectory = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;C:\Program Files\Autodesk&quot;</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.Title = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;File Open&quot;</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.Filter = </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Part File (*.ipt)|*.ipt&quot;</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">&amp; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;|Assembly File (*.iam)|*.iam&quot;</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">&amp; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;|Presentation File (*.ipn)|*.ipn&quot;</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">&amp; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;|Drawing File (*.idw)|*.idw&quot;</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">&amp; </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;|Design element File (*.ide)|*.ide&quot;</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.FilterIndex = 1<span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></font><span><font style="font-size: 10pt" color="#008000">' *.ipt files</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.Multiselect = </font></font><span><font style="font-size: 10pt" color="#0000ff">False</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">.ShowDialog()</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">With</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> m_FileOpenForm.FileNames.Length = 0 </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">HandlingCode = </font></font><font style="font-size: 10pt"><span><font color="#2b91af">HandlingCodeEnum</font></span><font color="#000000">.kEventCanceled</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><span><font style="font-size: 10pt" color="#0000ff">Else</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">FileName = m_FileOpenForm.FileNames(0)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160; </font></span><font style="font-size: 10pt">HandlingCode = </font></font><font style="font-size: 10pt"><span><font color="#2b91af">HandlingCodeEnum</font></span><font color="#000000">.kEventHandled</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;</font></span><font style="font-size: 10pt"><span style="mso-spacerun: yes">&#160;</span>m_FileOpenForm = </font></font><span><font style="font-size: 10pt" color="#0000ff">Nothing</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.0pt"><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font color="#0000ff" face="Consolas"><span style="font-family: ; mso-bidi-font-size: 9.0pt"><span></span></span></font></p>  <p>Another option would be to customize the native Inventor dialog boxes themselves. You may set the default directory, default file name, file filters, enable multiselection mode and 'Options' button and also may suppress resolution warnings. Here is C# sample of native Inventor FileDialog customization.<font size="5"><font size="1"></font></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: "><font color="#0000ff"><font style="font-size: 9pt">private</font></font></span><span style="font-family: "><font style="font-size: 9pt"><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> btn_OpenFile_Click(</font><span><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span><font color="#2b91af">EventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Create a new FileDialog object.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Inventor.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">FileDialog</font></span><font color="#000000"> oFileDlg;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oApp.CreateFileDialog(</font></font><font style="font-size: 9pt"><span><font color="#0000ff">out</font></span><font color="#000000">(oFileDlg));</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Define the filter to select part </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// and assembly files or any file.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.Filter = </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#a31515">&quot;Inventor Files (*.iam;*.ipt)|*.iam;*.ipt|All Files )|*.*&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Define the part and assembly files filter </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// to be the default filter.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.FilterIndex = 1;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Set the title for the dialog.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.DialogTitle = </font></font><font style="font-size: 9pt"><span><font color="#a31515">&quot;Open File Test&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Set the initial directory that </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// will be displayed in the dialog.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.InitialDirectory = </font></font><font style="font-size: 9pt"><span><font color="#a31515">@&quot;C:\Program Files\Autodesk&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Set the flag so an error will not be raised </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// if the user clicks the Cancel button.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.CancelError = </font></font><font style="font-size: 9pt"><span><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// Show the open dialog.<span style="mso-spacerun: yes">&#160; </span>The same procedure </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// is also used for the Save dialog.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// The commented code can be used for the Save dialog.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oFileDlg.ShowOpen();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// oFileDlg.ShowSave();</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">System.Windows.Forms.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show( </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#a31515">&quot;File \n&quot;</font></span><font color="#000000"> + oFileDlg.FileName + </font><span><font color="#a31515">&quot;\nwas selected.&quot;</font></span><font color="#000000">, </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#a31515">&quot;Selected file&quot;</font></span><font color="#000000">);</font></font><span style="mso-spacerun: yes"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas">&#160;</font></span></p>
