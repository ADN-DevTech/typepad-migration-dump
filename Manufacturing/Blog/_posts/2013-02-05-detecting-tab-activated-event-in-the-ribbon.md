---
layout: "post"
title: "Detecting Tab Activated Event in the Ribbon"
date: "2013-02-05 07:35:29"
author: "Philippe Leefsma"
categories:
  - "Inventor"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/02/detecting-tab-activated-event-in-the-ribbon.html "
typepad_basename: "detecting-tab-activated-event-in-the-ribbon"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>I was recently working on an ADN case where the developer wanted to react to his custom tab being activated. The Inventor Ribbon API itself doesn’t provide this kind of notification, however the underlying Ribbon API does.</p>  <p>You need to add a reference to AdWindows.dll (located in Inventor Bin install folder) to your .Net project in order to compile that code:</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="color: "><font color="#008000" face="Consolas"><font style="font-size: 12pt">//Your Add-In activate method, for example </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000" size="3" face="Consolas"><span style="font-family: ; color: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 12pt">public</font></font></span><span style="font-family: "><font style="font-size: 12pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> Activate(</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#2b91af">ApplicationAddInSite</font></span><font color="#000000"> addInSiteObject,</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> firstTime)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160; </font></font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000"></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Autodesk.Windows.</font></font><font style="font-size: 12pt"><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.ItemInitialized </font></font></font></span></p>  <blockquote>   <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">+= </font></font></font></span><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">RibbonItemEventArgs</font></span><font color="#000000">&gt;(</font></font></font></span></p> </blockquote>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">ComponentManager_ItemInitialized);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 12pt">void</font></font></span><span style="font-family: "><font style="font-size: 12pt"><font color="#000000"> ComponentManager_ItemInitialized(</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: "><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: "><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RibbonItemEventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 12pt" color="#008000">// Now one Ribbon item is initialized, </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="color: "><font style="font-size: 12pt" color="#008000">&#160;&#160;&#160; // but the Ribbon control </font></span></font></span><span style="font-family: "><font face="Consolas"><span style="color: "><font style="font-size: 12pt" color="#008000">may not be available&#160; </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="color: "><font style="font-size: 12pt" color="#008000">&#160;&#160;&#160; // yet, so check before</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (Autodesk.Windows.</font><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (Autodesk.Windows.</font><span style="color: "><font color="#2b91af">RibbonTab</font></span><font color="#000000"> Tab </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Windows.</font><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon.Tabs)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 12pt"><span style="font-family: "><font face="Consolas"><span style="color: "><font color="#008000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Replace with the id of the target tab</font></span></font></span></font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (Tab.Id == </font><span style="color: "><font color="#a31515">&quot;id_TabTools&quot;</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Tab.Activated += </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font size="3"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">(Tab_Activated);</font></font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 12pt" color="#008000">//and remove the event handler</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Autodesk.Windows.</font></font><font style="font-size: 12pt"><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ItemInitialized –=</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">RibbonItemEventArgs</font></span><font color="#000000">&gt;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComponentManager_ItemInitialized);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 12pt">void</font></font></span><span style="font-family: "><font style="font-size: 12pt"><font color="#000000"> Tab_Activated(</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="color: "><font color="#2b91af">EventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">System.Windows.Forms.</font></font><font style="font-size: 12pt"><span style="color: "><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show(</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 12pt"><span style="color: "><font color="#a31515">&quot;Tab &quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon.ActiveTab.Id </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font><span style="color: "><font color="#a31515">&quot; Activated!&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 12pt" color="#000000">}</font></font></span></p>
