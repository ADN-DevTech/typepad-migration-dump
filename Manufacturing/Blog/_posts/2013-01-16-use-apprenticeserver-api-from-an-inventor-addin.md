---
layout: "post"
title: "Use ApprenticeServer API from an Inventor Addin"
date: "2013-01-16 05:00:14"
author: "Augusto Goncalves"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2013/01/use-apprenticeserver-api-from-an-inventor-addin.html "
typepad_basename: "use-apprenticeserver-api-from-an-inventor-addin"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>We can create an ActiveX executable, which references the ApprenticeServer API, and which also exposes a suitable API of its own. We can then call into our ActiveX executable from an Inventor AddIn dll to request updates to any file references.</p>  <p>So - as a minimum, the API exposed by our ActiveX executable should allow us to open an Inventor document, update any file references, then save the updated document.</p>  <p>Here are the steps we need to perform in our server:-</p>  <p>(1) Create an Apprentice Server object</p>  <p>(2) Open an Inventor document via the Apprentice Server API</p>  <p>(3) Update relevant file references</p>  <p>(4) Save the modified document</p>  <p>(5) Destroy the Apprentice Server object.</p>  <p>The code sample sample below does exactly this (with the restriction that only Assembly documents can be updated). When an instance of the ActiveX component is initialized, an ApprenticeServerComponent is automatically created.</p>  <p>Then we call the 'OpenAssembly()' method passing in the path to an Assembly file.</p>  <p>Next we call the 'Update()' method - passing in a path to a referenced file that is to be updated, along with the new path.</p>  <p>Once all paths have been updated, we call the 'Save()' method to save our updated file references in the Assembly document.</p>  <p>The ApprenticeServerComponent object is automatically destroyed as our ActiveX server terminates.</p>  <p>To use our Server we firstly need to add a reference to it from our Inventor AddIn project (I've called it 'FileRefUpdater'), then we just add code to call the API we have exposed.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font style="font-size: 10pt" color="#008000" face="Courier New">' The path to our Assembly document</font></span><span><font color="#0000ff"><font style="font-size: 10pt">           <br /><font face="Courier New">Dim</font></font></font></span><font face="Courier New"><font style="font-size: 10pt"><font color="#000000"> sAsmDocPathName </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">String </font></span><font color="#000000"><font style="font-size: 10pt">= </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;..........&quot;</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Dim</font></font></span><font style="font-size: 10pt"><font color="#000000"> oFileRefUpdater </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Object</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">oFileRefUpdater = CreateObject(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;FileRefUpdater.clsFileRefUpdater&quot;</font></span><font color="#000000">) </font></font><span><font style="font-size: 10pt" color="#008000">' create our Server&#160; </font></span></font></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span><font style="font-size: 10pt" color="#008000" face="Courier New">' and open the Assembly document</font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">oFileRefUpdater.OpenAssembly(sAsmDocPathName) </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Dim</font></font></span><font style="font-size: 10pt"><font color="#000000"> sOldPath </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">sOldPath = </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;......&quot;</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#008000">' the path to a file that is being moved</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Dim</font></font></span><font style="font-size: 10pt"><font color="#000000"> sNewPath </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">sNewPath = </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;.....&quot;</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#008000">' the updated location.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">System.IO.</font></font><font style="font-size: 10pt"><span><font color="#2b91af">File</font></span><font color="#000000">.Move(sOldPath, sNewPath) </font></font><span><font style="font-size: 10pt" color="#008000">' move the document&#160;&#160; <br /><span><font style="font-size: 10pt" color="#008000">' update the references in our Assembly&#160;&#160; </font></span></font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">oFileRefUpdater.Update(sOldPath, sNewPath)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">oFileRefUpdater.Save() </font></font><span><font style="font-size: 10pt" color="#008000">' and save&#160;&#160; </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">oFileRefUpdater = </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Nothing</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#008000">' all done!</font></span></font></p> </div>
