---
layout: "post"
title: "Use DisabledCommandTypes to turn off commands"
date: "2013-07-23 17:01:07"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/07/use-disabledcommandtypes-to-turn-off-commands.html "
typepad_basename: "use-disabledcommandtypes-to-turn-off-commands"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>You may want to turn off certain commands in a document. To do this use a property on the Document called &quot;DisabledCommandTypes&quot;. Through this property, you can disable entire classes of commands. This is a way to make a part behave similar to a part in content library. For example you could have is a&#160; document and have Inventor UI grey-out all of the geometry modifying commands when it is the active document, but keep the File Property edit commands enabled. (the setting is saved with the document)</p>  <p><strong>VB.NET example:</strong></p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px">&#160;<span style="color: blue">Sub</span> DisableEdit()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> m_inventorApp <span style="color: blue">As</span> Inventor.<span style="color: #2b91af">Application</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.Runtime.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InteropServices.<span style="color: #2b91af">Marshal</span>.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetActiveObject(<span style="color: #a31515">&quot;Inventor.Application&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oDoc <span style="color: blue">As</span> <span style="color: #2b91af">Document</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc = m_inventorApp.ActiveDocument</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Disable all editing commands.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.DisabledCommandTypes =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">CommandTypesEnum</span>.kShapeEditCmdType</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Enable all editing commands.</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'&#160; oDoc.DisabledCommandTypes = 0</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p>&#160;</p>  <p><strong>C++ example:</strong></p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">void</span> CTestDlg::OnBnClickedButton3()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; HRESULT hr; </p>    <p style="margin: 0px">&#160;&#160;&#160; CComPtr&lt;Application&gt; Inv;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; CLSID InvApplicationClsid; </p>    <p style="margin: 0px">&#160;&#160;&#160; hr = ::CLSIDFromProgID (L<span style="color: #a31515">&quot;Inventor.Application&quot;</span>, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;InvApplicationClsid); </p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">//latch on to existing one </span></p>    <p style="margin: 0px">&#160;&#160;&#160; CComPtr&lt;IUnknown&gt; pInvAppUnk; </p>    <p style="margin: 0px">&#160;&#160;&#160; hr = ::GetActiveObject </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (InvApplicationClsid, NULL, &amp;pInvAppUnk); </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; hr = pInvAppUnk-&gt;QueryInterface </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">__uuidof</span>(Application), (<span style="color: blue">void</span> **) &amp;Inv); </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; CComPtr&lt;Document&gt; Doc; </p>    <p style="margin: 0px">&#160;&#160;&#160; hr = Inv-&gt;get_ActiveDocument(&amp;Doc);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">//Disable all feature editing commands </span></p>    <p style="margin: 0px">&#160;&#160;&#160; hr = Doc-&gt;put_DisabledCommandTypes</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (kShapeEditCmdType); </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p> </div>
