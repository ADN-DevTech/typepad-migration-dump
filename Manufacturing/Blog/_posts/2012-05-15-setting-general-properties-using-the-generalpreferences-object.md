---
layout: "post"
title: "Setting general properties using the GeneralPreferences object"
date: "2012-05-15 07:08:03"
author: "Gary Wassell"
categories:
  - "Gary Wassell"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/setting-general-properties-using-the-generalpreferences-object.html "
typepad_basename: "setting-general-properties-using-the-generalpreferences-object"
typepad_status: "Publish"
---

<p><strong>Issue</strong></p>
<p>How to set general properties, e.g. &quot;defer update for assemblies&quot; using the Inventor API?</p>
<p><a name="section2"></a></p>
<p><strong>Solution</strong></p>
<p>Using the Inventor API, you can specify some general options (the options that you would in the Tools-&gt;Application Options¡± tab in the Inventor UI). These options are returned as properties of the GeneralPreferences object. This object supports some of the properties found in the Tools-&gt;Application Options tab. The GeneralPreferences object is returned as part of the objects enumerator returned by the Application.Preferences object. In addition to the GeneralPreferences, this collection could also return other preferences e.g. Graphics preferences. Once you get the GeneralPreferences object, you can use its properties to, for example, defer update for assemblies, enable multi-users etc. The code below is equivalent to the &quot;<strong>Defer Update</strong>&quot; option that is available in the &quot;Tools-&gt;Application Options&quot; and &quot;Assembly&quot; tab.</p>
<p>From Inventor R11, we provided <strong>AssemblyOptions.DeferUpdate</strong> that enables or disables updating assemblies when you edit components. Setting this property to True will defer updates of an assembly until the Update button is clicked or the Update method of the document is called.</p>
<p>VBA</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> GeneralPrefs()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">&#39; Find the general preferences preference set.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oGeneralPref </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> GeneralPreferences</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> i </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Long</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> i = 1 </span><span><span style="color: #0000ff;">To</span></span><span style="color: #000000;"> ThisApplication.Preferences.Count</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">TypeOf</span></span><span style="color: #000000;"> ThisApplication.Preferences.Item(i) </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> GeneralPreferences </span></span><span><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref = ThisApplication.Preferences.Item(i)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff;">Exit For</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">&#39; for example, defer the assembly update.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref.DeferUpdate = </span></span><span><span style="color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Sub</span></span></span></p>
</div>
<p>VB.NET</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> GeneralPrefs()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">&#39; Find the general preferences preference set.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oGeneralPref </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> GeneralPreferences</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> i </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Long</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> i = 1 </span><span><span style="color: #0000ff;">To</span></span><span style="color: #000000;"> m_inventorApplication.Preferences.Count</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">TypeOf</span></span><span style="color: #000000;"> m_inventorApplication.Preferences.Item(i) </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> GeneralPreferences </span></span><span><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref = m_inventorApplication.Preferences.Item(i)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff;">Exit For</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">&#39; for example, defer the assembly update.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref.DeferUpdate = </span></span><span><span style="color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff;">Sub</span></span></span></p>
</div>
<p>C#</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> GeneralPrefs()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">// &#39; Find the general preferences preference set.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GeneralPreferences oGeneralPref = </span></span><span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Object</span></span><span style="color: #000000;"> oPre </span><span><span style="color: #0000ff;">in </span></span><span style="color: #000000;">m_inventorApplication.Preferences)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref = oPre </span></span><span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> Inventor.GeneralPreferences;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (oGeneralPref != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">break</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #008000;">//&#0160;&#0160; &#39; for example, defer the assembly update.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (oGeneralPref != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oGeneralPref.DeferUpdate = </span></span><span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
</div>
