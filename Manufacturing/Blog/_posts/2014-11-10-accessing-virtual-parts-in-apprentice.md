---
layout: "post"
title: "Accessing Virtual Parts in Apprentice"
date: "2014-11-10 15:51:52"
author: "Adam Nagy"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2014/11/accessing-virtual-parts-in-apprentice.html "
typepad_basename: "accessing-virtual-parts-in-apprentice"
typepad_status: "Publish"
---

<p>It is possible to access and get information from virtual parts in an assembly using Apprentice.&#160; It’s basically the same as in Inventor with a slight difference because all of the same types aren’t defined within Apprentice. Rather than go through a lengthy discussion, here’s some VB.NET code that demonstrates getting iProperties from an assembly and correctly handling virtual components.</p>  <p>&#160;</p>  <div style="font-size: 8pt; font-family: courier new; background: #eeeeee; color: black; line-height: 140%">   <p>Public Sub TestVirtual()      <br /><font color="#0000ff"><strong>&#160;&#160;&#160; ' Create Apprentice and open the assembly.          <br /></strong></font>&#160;&#160;&#160; Dim app As ApprenticeServerComponent       <br />&#160;&#160;&#160; app = New ApprenticeServerComponent       <br />&#160;&#160;&#160; Dim doc As ApprenticeServerDocument       <br />&#160;&#160;&#160; doc = app.Open(&quot;C:\Temp\TestAssembly.iam&quot;)</p>    <p><strong><font color="#0000ff">&#160;&#160;&#160; ' Iterate through the occurrences in the assembly.          <br /></font></strong>&#160;&#160;&#160; Dim occ As ComponentOccurrence       <br />&#160;&#160;&#160; For Each occ In doc.ComponentDefinition.Occurrences       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim def As ComponentDefinition       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; def = occ.Definition</p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Check to see if this occurrence is for a virtual part.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160; If TypeOf def Is VirtualComponentDefinition Then       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the virtual component definition since this          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' is what provides access to the property sets.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim virtualDef As VirtualComponentDefinition       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; virtualDef = def</p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Call the function to get the properties.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call ShowProperties(virtualDef.PropertySets)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Else       <br /><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Get the associated document since this is what          <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' provides access to the property sets.           <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim refDoc As ApprenticeServerDocument       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; refDoc = def.Document</p>    <p><font color="#0000ff"><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Call the function to get the properties.          <br /></strong></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call ShowProperties(refDoc.PropertySets)       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160; Next       <br />End Sub      <br />      <br />      <br /><font color="#0000ff"><strong>' Sample to show getting properties.          <br /></strong></font>Private Sub ShowProperties(PropSets As PropertySets)       <br />&#160;&#160;&#160; Dim designTracking As PropertySet       <br />&#160;&#160;&#160; designTracking = PropSets.Item(&quot;Design Tracking Properties&quot;)       <br />&#160;&#160;&#160; Debug.Print(&quot;Part Number: &quot; &amp; _      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; designTracking.Item(&quot;Part Number&quot;).Value)       <br />End Sub </p> </div>  <br />    <p>-Brian</p>
