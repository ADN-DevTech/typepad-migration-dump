---
layout: "post"
title: "Open assembly with specific design view representation in C++"
date: "2012-09-20 02:01:51"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/09/open-assembly-with-specific-design-view-representation-in-c.html "
typepad_basename: "open-assembly-with-specific-design-view-representation-in-c"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>If you want to open in a specific design view, you need to use OpenWithOptions, while Open method can only open the assembly with LOD (Level of Detail) option.</p>  <p>Following is a code to open an assembly with last active LOD and last active design view</p>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> HRESULT GetInventorInformation()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; HRESULT Result = NOERROR;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; </span><span style="line-height: 140%; color: green">// Assume Inventor application pInvApp is available</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; CComPtr&lt;Documents&gt; pAllDocs = NULL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Result = pInvApp-&gt;get_Documents(&amp;pAllDocs);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; CComPtr&lt;FileManager&gt; pFileManager;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Result = pInvApp-&gt;get_FileManager(&amp;pFileManager);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; _bstr_t bsCurrentDocumentName(L</span><span style="line-height: 140%; color: #a31515">&quot;C:\\test.iam&quot;</span><span style="line-height: 140%">);&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get last LOD</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; BSTR strLastActiveLOD; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Result = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pFileManager-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetLastActiveLevelOfDetailRepresentation(bsCurrentDocumentName,&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;strLastActiveLOD);&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get last Design View Representation</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; BSTR strLastActiveView; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Result =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pFileManager-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetLastActiveDesignViewRepresentation(bsCurrentDocumentName,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;strLastActiveView);&#160;&#160;&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; BSTR strFullDocumentName; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Result =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pFileManager-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetFullDocumentName(bsCurrentDocumentName, strLastActiveLOD,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;strFullDocumentName); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; CComPtr&lt;NameValueMap&gt; nameValueMap = NULL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; pInvApp-&gt;TransientObjects-&gt;CreateNameValueMap(&amp;nameValueMap);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nameValueMap-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Add(_bstr_t(</span><span style="line-height: 140%; color: #a31515">&quot;LevelOfDetailRepresentation&quot;</span><span style="line-height: 140%">),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _variant_t( strLastActiveLOD) );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nameValueMap-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Add(_bstr_t(</span><span style="line-height: 140%; color: #a31515">&quot;DesignViewRepresentation&quot;</span><span style="line-height: 140%">),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _variant_t( strLastActiveView ));</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; CComPtr&lt;Document&gt; pDocument = NULL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//pDocument = pAllDocs-&gt;MethodOpen(strFullDocumentName,VARIANT_TRUE);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pDocument = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pAllDocs-&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MethodOpenWithOptions(bsCurrentDocumentName,nameValueMap,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _variant_t(VARIANT_TRUE));</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Result;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
