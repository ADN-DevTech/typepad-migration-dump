---
layout: "post"
title: "Use UpdateAndCommitItem()to change the Category of an Item"
date: "2014-11-17 10:44:07"
author: "Wayne Brill"
categories:
  - "Vault"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/11/use-updateandcommititemto-change-the-category-of-an-item.html "
typepad_basename: "use-updateandcommititemto-change-the-category-of-an-item"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>The function to change the category of an item may not be easy to find. To change the category of a file you can use&#160; UpdateFileCategories(). To change the category of a folder you use UpdateFolderCategories(). To change the category of an Item you change the ItemTypId field of the item and then use UpdateAndCommitItem().</p>  <p>You can test this using the code below by adding a button to the ItemEditor example. </p>  <p><em>C:\Program Files (x86)\Autodesk\Autodesk Vault 2014 SDK\VS10\VB\ItemEditor</em></p>  <p>&#160;</p>  <div style="font-size: 10pt; font-family: consolas; background: #eeeeee; color: black">   <p style="margin: 0px"><span style="color: blue">Private</span> <span style="color: blue">Sub</span> Button1_Click _</p>    <p style="margin: 0px">(sender <span style="color: blue">As</span> System.<span style="color: #2b91af">Object</span>, e <span style="color: blue">As</span> System.<span style="color: #2b91af">EventArgs</span>) _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Handles</span> Button1.Click</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> myItem <span style="color: blue">As</span> <span style="color: #2b91af">Item</span> = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Try</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Using this to get the category to change</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' the Item to. On the form select the </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' dropdown for the Type (category). </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Not using the Title so just leave</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' it blank and hit ok</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> form <span style="color: blue">As</span> <span style="color: blue">New</span> <span style="color: #2b91af">CreateItemForm</span>(m_connection)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">form</span>.ShowDialog()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: #2b91af">form</span>.DialogResult &lt;&gt; <span style="color: #2b91af">DialogResult</span>.OK <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Get the latest item</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> itemRev <span style="color: blue">As</span> <span style="color: #2b91af">Item</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_connection.WebServiceManager.ItemService. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetLatestItemByItemNumber(m_selectedItem.ItemNum)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Edit the item</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; myItem = m_connection.WebServiceManager. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ItemService.EditItem(itemRev.RevId)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Change the category of the item</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; myItem.ItemTypId = form.Category.Id <span style="color: green">'3</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'commit</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_connection.WebServiceManager.ItemService. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UpdateAndCommitItem(myItem, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0, <span style="color: blue">False</span>, <span style="color: blue">Nothing</span>, <span style="color: blue">Nothing</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Nothing</span>, <span style="color: blue">Nothing</span>, <span style="color: blue">Nothing</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Nothing</span>, 2)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Catch</span> ex <span style="color: blue">As</span> <span style="color: #2b91af">Exception</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: blue">Not</span> myItem <span style="color: blue">Is</span> <span style="color: blue">Nothing</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_connection.WebServiceManager. _</p>    <p style="margin: 0px">ItemService.UndoEditItems(<span style="color: blue">New</span> <span style="color: blue">Long</span>() {myItem.Id})</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MessageBox</span>.Show _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;Error occurred &quot;</span> + ex.ToString())</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Try</span></p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>
