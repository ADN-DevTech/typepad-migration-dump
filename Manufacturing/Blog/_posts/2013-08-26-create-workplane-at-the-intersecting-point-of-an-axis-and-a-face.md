---
layout: "post"
title: "Create workplane at the intersecting point of an axis and a face"
date: "2013-08-26 05:59:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/08/create-workplane-at-the-intersecting-point-of-an-axis-and-a-face.html "
typepad_basename: "create-workplane-at-the-intersecting-point-of-an-axis-and-a-face"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Question</strong>:    <br />Is there a way to add a WorkPoint where an Axis and a Part Face Intersect?&#160; I need this to be able to create a WorkPlane normal to the surface of the part at that location.</p>  <p><strong>Solution</strong>:    <br />TransientGeometry.<strong>CurveSurfaceIntersection</strong> can tell the intersecting points of a curve and a surface. And WorkPlanes collection provides the method <strong>AddByPointAndTangent</strong> creates a new work plane through the input point and tangent to the input surface. But this method does not accept <strong>Point</strong> as the argument.&#160; We can workaround it by creating a tempeory sketch3d point. The code below demos it.</p>  <p>&#160;</p>  <p><em>Sub addWPByIntersectPtAtFace()</em></p>  <p><em>&#160;&#160;&#160; Dim oDoc As PartDocument     <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oWorkAxis As WorkAxis      <br />&#160;&#160;&#160; Set oWorkAxis = ThisApplication.CommandManager.Pick(kWorkAxisFilter, &quot;pick an axis&quot;)      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oFace As Face      <br />&#160;&#160;&#160; Set oFace = ThisApplication.CommandManager.Pick(kPartFaceFilter, &quot;pick an face&quot;)      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oTG As TransientGeometry      <br />&#160;&#160;&#160; Set oTG = ThisApplication.TransientGeometry      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oObjs As ObjectsEnumerator      <br />&#160;&#160;&#160; Set oObjs = oTG.CurveSurfaceIntersection(oWorkAxis.Line, oFace.Geometry)      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; ' assume only one intersect point      <br />&#160;&#160;&#160; Dim oIntersecPt As Point      <br />&#160;&#160;&#160; Set oIntersecPt = oObjs(1)      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; 'WorkPlanes.AddByPointAndTangent does not accept Point      <br />&#160;&#160;&#160; ' so use sketch3d point as an alternative      <br />&#160;&#160;&#160; Dim oDef As PartComponentDefinition      <br />&#160;&#160;&#160; Set oDef = oDoc.ComponentDefinition      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oTemp3dSketch As Sketch3D      <br />&#160;&#160;&#160; Set oTemp3dSketch = oDef.Sketches3D.Add      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oSketchPt3d As SketchPoint3D      <br />&#160;&#160;&#160; Set oSketchPt3d = oTemp3dSketch.SketchPoints3D.Add(oIntersecPt)      <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; Call oDef.WorkPlanes.AddByPointAndTangent(oSketchPt3d, oFace)      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; 'delete the temp sketch 3d      <br />&#160;&#160;&#160; oTemp3dSketch.Delete      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <br />End Sub</em></p>
