---
layout: "post"
title: "Dimension.FormattedText does not work well if FullFileName has single quote mark"
date: "2012-09-06 03:26:18"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/09/dimensionformattedtext-does-not-work-well-if-fullfilename-has-single-quote-mark.html "
typepad_basename: "dimensionformattedtext-does-not-work-well-if-fullfilename-has-single-quote-mark"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Issue</strong>    <br />I have a folder whose name has&#160; single quote mark, e.g.&#160; c:\temp\mytest'inventor\. I put a drawing and its referenced part document in the folder. The VBA code gets a curve and creates a dimension. Then overrides the dimension text by FormattedText. The FormattedText wants to use one parameter from the part document.&#160; But the result text shows full content of&#160; FormattedText. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177448c2b49970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_40f3e3.jpg" width="478" height="101" /></a> </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> test()</span></p>    <p style="margin: 0px">&#160; </p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get Drawing</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oDoc = InvApp.ActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> Path </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Path = Replace(oDoc.FullFileName, </span><span style="line-height: 140%; color: #a31515">&quot;idw&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;ipt&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get Part</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPartDoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PartDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oPartDoc = InvApp.Documents.ItemByName(Path)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' assume the first curve is a circle</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oView </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingView</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oView = oDoc.ActiveSheet.DrawingViews.Item(1) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get a curve</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oOneCurve </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingCurve</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oOneCurve = oView.DrawingCurves.Item(1)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">''Add dimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> Intent </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">GeometryIntent</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Intent = oDoc.ActiveSheet.CreateGeometryIntent(oOneCurve)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPt </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oPt = InvApp.TransientGeometry.CreatePoint2d(0, 0)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oPt.X = oView.Center.X + 5 </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oPt.Y = oView.Center.Y +5&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' add a Diameter Dimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oDim </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DiameterGeneralDimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oDim = oDoc.ActiveSheet.DrawingDimensions.GeneralDimensions.AddDiameter(oPt, Intent)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">'' Format dimension and link a part parameter</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">'assume we have a param named 'myParam'</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ParameterName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ParameterName = </span><span style="line-height: 140%; color: #a31515">&quot;myParam&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oFormattedText </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oFormattedText = </span><span style="line-height: 140%; color: #a31515">&quot;&lt;StyleOverride Font='AIGDT'&gt;n&lt;/StyleOverride&gt;&quot;</span><span style="line-height: 140%"> &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;Parameter ComponentIdentifier='&quot;</span><span style="line-height: 140%"> &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPartDoc.FullFileName &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;' Name='&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ParameterName &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;' Precision='0' &gt;&lt;/Parameter&gt;&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oDim.HideValue = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oDim.Text.FormattedText = oFormattedText</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p><strong>Solution     <br /></strong>The reason is: the tag (Parameter ComponentIdentifier) of FormattedText needs a full file name string within two single quote marks.&#160; While the single quote mark within the&#160; full file name truncates the string which causes the FormattedText cannot be parsed correctly. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> test()</span></p>    <p style="margin: 0px">&#160;&#160; </p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get Drawing</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oDoc = InvApp.ActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> Path </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Path = Replace(oDoc.FullFileName, </span><span style="line-height: 140%; color: #a31515">&quot;idw&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;ipt&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get Part</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPartDoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PartDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oPartDoc = InvApp.Documents.ItemByName(Path)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' assume the first curve is a circle</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oView </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingView</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oView = oDoc.ActiveSheet.DrawingViews.Item(1) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">''Get a curve</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oOneCurve </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingCurve</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oOneCurve = oView.DrawingCurves.Item(1)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">''Add dimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> Intent </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">GeometryIntent</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Intent = oDoc.ActiveSheet.CreateGeometryIntent(oOneCurve)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPt </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oPt = InvApp.TransientGeometry.CreatePoint2d(0, 0)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oPt.X = oView.Center.X + 5 </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oPt.Y = oView.Center.Y +5&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' add a Diameter Dimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oDim </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DiameterGeneralDimension</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oDim = oDoc.ActiveSheet.DrawingDimensions.GeneralDimensions.AddDiameter(oPt, Intent)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> sPartFileName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">sPartFileName = oPartDoc.FullFileName</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' replace the quotation marks if there are in the file path</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> InStr(1, sPartFileName, </span><span style="line-height: 140%; color: #a31515">&quot;'&quot;</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; sPartFileName = Replace(sPartFileName, </span><span style="line-height: 140%; color: #a31515">&quot;'&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;&amp;apos;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">'' Format dimension and link a part parameter</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">'assume we have a param named 'myParam'</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ParameterName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ParameterName = </span><span style="line-height: 140%; color: #a31515">&quot;myParam&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oFormattedText </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oFormattedText = </span><span style="line-height: 140%; color: #a31515">&quot;&lt;StyleOverride Font='AIGDT'&gt;n&lt;/StyleOverride&gt;&quot;</span><span style="line-height: 140%"> &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;Parameter ComponentIdentifier='&quot;</span><span style="line-height: 140%"> &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sPartFileName &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;' Name='&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ParameterName &amp;&#160; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;' Precision='0' &gt;&lt;/Parameter&gt;&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oDim.HideValue = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oDim.Text.FormattedText = oFormattedText</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3bdd0f94970c-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_2fb582.jpg" width="384" height="178" /></a> </p>  <p>Users should take care of the quotation marks when place them into the FormattedText, they should use the codes instead to represent&#160; them. Below is the update code:   <br /> o get more info about this, please refer to the Inventor API help for title 'XML Tags for FormattedText', and at the bottom there is a table to list the codes for some certain characters.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177448c2b74970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_912ec3.jpg" width="362" height="238" /></a></p>
