---
layout: "post"
title: "Create simplified part by API"
date: "2013-06-13 22:00:24"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2013/06/create-simplified-part-by-api.html "
typepad_basename: "create-simplified-part-by-api"
typepad_status: "Publish"
---

<p>by&#0160;<a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html">Xiaodong Liang</a></p>
<p>The [Create Simplified Part] actually creates a derived assembly for the new part document. You will firstly create&#0160;<strong>DerivedAssemblyDefinition, </strong>and configure the relevant options, finally add it to the new part by&#0160;<strong>DerivedAssemblyComponents.Add.</strong></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019103526711970c-pi" style="display: inline;"><img alt="6-14-2013 12-05-08 PM" border="0" class="asset  asset-image at-xid-6a0167607c2431970b019103526711970c" src="/assets/image_832162.jpg" title="6-14-2013 12-05-08 PM" /></a></p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019103526823970c-pi" style="display: inline;"><img alt="6-14-2013 12-06-53 PM" border="0" class="asset  asset-image at-xid-6a0167607c2431970b019103526823970c" src="/assets/image_7a1951.jpg" title="6-14-2013 12-06-53 PM" /></a></p>
<p><span style="font-family: tahoma, arial, helvetica, sans-serif;">The following is a small code demo.&#0160;</span></p>
<pre><span style="font-family: tahoma, arial, helvetica, sans-serif;">Sub CreateSimplifiedPart()</span><br /><br /><span style="color: #00bf00; font-family: tahoma, arial, helvetica, sans-serif;">&#39; Set a reference to the active assembly document</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oDoc As AssemblyDocument</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oDoc = ThisApplication.ActiveDocument</span><br /><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oDef As AssemblyComponentDefinition</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oDef = oDoc.ComponentDefinition</span><br /><br /><span style="color: #00bf00; font-family: tahoma, arial, helvetica, sans-serif;">&#39; Create a new part document that will derive the assembly</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oPartDoc As PartDocument</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oPartDoc = ThisApplication.Documents.Add(kPartDocumentObject, , True)</span><br /><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oPartDef As PartComponentDefinition</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oPartDef = oPartDoc.ComponentDefinition</span><br /><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oDerivedAssemblyDef As DerivedAssemblyDefinition</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oDerivedAssemblyDef = oPartDef.ReferenceComponents.DerivedAssemblyComponents.CreateDefinition(oDoc.FullDocumentName)</span><br /><br /><span style="color: #00bf00; font-family: tahoma, arial, helvetica, sans-serif;">&#39; Set various related options</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.DeriveStyle = kDeriveAsSingleBodyNoSeams</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.IncludeAllTopLevelWorkFeatures = kDerivedIncludeAll</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.IncludeAllTopLevelSketches = kDerivedIncludeAll</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.IncludeAllTopLeveliMateDefinitions = kDerivedExcludeAll</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.IncludeAllTopLevelParameters = kDerivedExcludeAll</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">oDerivedAssemblyDef.ReducedMemoryMode = True</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Call oDerivedAssemblyDef.SetHolePatchingOptions(kDerivedPatchAll)</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Call oDerivedAssemblyDef.SetRemoveByVisibilityOptions(kDerivedRemovePartsAndFaces, 25)</span><br /><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">&#39; Create the shrinkwrap component</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Dim oDerivedAssembly As DerivedAssemblyComponent</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Set oDerivedAssembly = oPartDef.ReferenceComponents.DerivedAssemblyComponents.Add(oDerivedAssemblyDef)</span><br /><br /><span style="color: #00bf00; font-family: tahoma, arial, helvetica, sans-serif;"> &#39;save the new part file</span><br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">Call oPartDoc.SaveAs(&quot;c:\temp\newpart.ipt&quot;, False)</span><br />  <br /><span style="font-family: tahoma, arial, helvetica, sans-serif;">End Sub</span><br /></pre>
<p>&#0160;</p>
<p>&#0160;</p>
