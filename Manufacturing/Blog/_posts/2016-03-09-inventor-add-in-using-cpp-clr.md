---
layout: "post"
title: "Inventor Add-In using C++/CLR"
date: "2016-03-09 14:23:08"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2016/03/inventor-add-in-using-cpp-clr.html "
typepad_basename: "inventor-add-in-using-cpp-clr"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p><a href="http://adndevblog.typepad.com/manufacturing/philippe-leefsma.html">Philippe</a> already created a <a href="http://adndevblog.typepad.com/manufacturing/2012/07/creating-a-mix-managed-inventor-add-in.html">sample</a> <strong>mixed-managed</strong> (<strong>C++</strong>/<strong>CLR</strong>) add-in that you can have a look at. But I thought it could be useful to list the steps to achieve that. Instead of creating a <strong>C++</strong> <strong>Inventor</strong> add-in using the <strong>Inventor Add-In wizard</strong>, adding .<strong>NET</strong> support to it, and separating the generated code from the managed parts using <strong>#pragma unmanaged</strong>&#0160;/<strong>#pragma managed</strong>&#0160;blocks, it&#39;s easier to create a <strong>C++</strong>/<strong>CLR</strong>&#0160;<strong>Class Library</strong> and&#0160;implement your <strong>ApplicationAddInServer</strong> in .<strong>NET</strong>.</p>
<p>1) Create the &quot;<strong>C++</strong>/<strong>CLR</strong>&#0160;<strong>Class Library</strong>&quot; - preferably inside &quot;<strong>%APPDATA%\Autodesk\ApplicationPlugins</strong>&quot; to make your life easier</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1abe580970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="MyClrAddIn" class="asset  asset-image at-xid-6a0167607c2431970b01b8d1abe580970c img-responsive" src="/assets/image_bbdcd4.jpg" title="MyClrAddIn" /></a></p>
<p>2) Create a &quot;<strong>x64</strong>&quot; platform for the project and keep that active</p>
<p>Inside the<strong>&#0160;</strong>&quot;<strong>Configuration Manager</strong>&quot; dialog, under &quot;<strong>Active solution platform</strong>&quot; select &quot;<strong>&lt;New...&gt;</strong>&quot;&#0160;and add the &quot;<strong>x64</strong>&quot; platform</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1abe3e4970c-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="X64" class="asset  asset-image at-xid-6a0167607c2431970b01b8d1abe3e4970c img-responsive" src="/assets/image_d03837.jpg" title="X64" /></a></p>
<p>3) Reference &quot;<strong>Autodesk.Inventor.Interop.dll</strong>&quot;</p>
<p>Click &quot;<strong>PROJECT</strong>&quot; &gt;&gt; &quot;<strong>References...</strong>&quot; and browse to &quot;<strong>&lt;Inventor install folder&gt;\Bin\Public Assemblies</strong>&quot; and add&#0160;&quot;<strong>Autodesk.Inventor.Interop.dll</strong>&quot;</p>
<p>4) Inside the same dialog box also add a reference to &quot;<strong>System.Windows.Forms</strong>&quot; just so that we can show a message box from our code later on</p>
<p>5)&#0160;Implement the &quot;<strong>ApplicationAddInServer</strong>&quot;<strong>&#0160;</strong>class</p>
<div style="line-height: 120%; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #008000;">// MyClrAddIn.h</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">#pragma</span> <span style="background: #ffffff; color: #0000ff;">once</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> System::Runtime::InteropServices;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> System::Windows::Forms;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> Inventor;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> MyClrAddIn {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #0000ff;">ref</span> <span style="background: #ffffff; color: #0000ff;">class</span> <span style="background: #ffffff; color: #2b91af;">StandardAddInServer</span><span style="background: #ffffff; color: #000000;"> : </span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #2b91af;">ApplicationAddInServer</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span><span style="background: #ffffff; color: #000000;">:</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;StandardAddInServer(</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; {</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; }</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">virtual</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> Activate(</span><span style="background: #ffffff; color: #2b91af;">ApplicationAddInSite</span><span style="background: #ffffff; color: #000000;">^ </span><span style="background: #ffffff; color: #808080;">addInSiteObject</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #0000ff;">bool</span> <span style="background: #ffffff; color: #808080;">firstTime</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MessageBox</span><span style="background: #ffffff; color: #000000;">::Show(</span><span style="background: #ffffff; color: #a31515;">&quot;Add-In Loading&quot;</span><span style="background: #ffffff; color: #000000;">); </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">virtual</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> Deactivate()</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MessageBox</span><span style="background: #ffffff; color: #000000;">::Show(</span><span style="background: #ffffff; color: #a31515;">&quot;Add-In Unloading&quot;</span><span style="background: #ffffff; color: #000000;">); </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">virtual</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> ExecuteCommand(</span><span style="background: #ffffff; color: #0000ff;">int</span> <span style="background: #ffffff; color: #808080;">CommandID</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">virtual</span> <span style="background: #ffffff; color: #0000ff;">property</span> <span style="background: #ffffff; color: #2b91af;">Object</span><span style="background: #ffffff; color: #000000;">^ Automation</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// If you want to return an interface to another client of this addin,</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// implement that interface in a class and return that class object </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// through this property</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Object</span><span style="background: #ffffff; color: #000000;">^ get()</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">nullptr</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; }</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; }</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; };</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>5) Create a <strong>GUID</strong>&#0160;and a&#0160;<strong>ProgId</strong> for the class and make it <strong>ComVisible</strong></p>
<div style="line-height: 120%; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> MyClrAddIn {</span><br /> <strong><span style="background: #ffffff; color: #000000;">&#0160;&#0160;[</span></strong><br /><strong> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;ProgId(</span><span style="background: #ffffff; color: #a31515;">&quot;MyClrAddIn.StandardAddInServer&quot;</span><span style="background: #ffffff; color: #000000;">),</span></strong><br /><strong> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;GuidAttribute(</span><span style="background: #ffffff; color: #a31515;">&quot;3543165F-7F19-4614-8842-572A5EBE9549&quot;</span><span style="background: #ffffff; color: #000000;">), </span></strong><br /><strong> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;ComVisible(</span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">)</span></strong><br /><strong> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;]</span></strong><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #0000ff;">ref</span> <span style="background: #ffffff; color: #0000ff;">class</span> <span style="background: #ffffff; color: #2b91af;">StandardAddInServer</span><span style="background: #ffffff; color: #000000;"> : </span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #2b91af;">ApplicationAddInServer</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; {</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// etc...</span></div>
</div>
<p>Note: you can use&#0160;<strong>Visual Studio</strong>&#39;s &quot;<strong>Create GUID</strong>&quot; dialog for creating a new&#0160;<strong>GUID</strong></p>
<p>7) Create an *.<strong>addin</strong> file inside your solution&#39;s folder with name &quot;&quot; and content &#0160;</p>
<div style="line-height: 120%; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">&lt;?</span><span style="background: #ffffff; color: #a31515;">xml</span> <span style="background: #ffffff; color: #ff0000;">version</span><span style="background: #ffffff; color: #0000ff;">=</span><span style="background: #ffffff; color: #000000;">&quot;</span><span style="background: #ffffff; color: #0000ff;">1.0</span><span style="background: #ffffff; color: #000000;">&quot;</span> <span style="background: #ffffff; color: #ff0000;">encoding</span><span style="background: #ffffff; color: #0000ff;">=</span><span style="background: #ffffff; color: #000000;">&quot;</span><span style="background: #ffffff; color: #0000ff;">utf-8</span><span style="background: #ffffff; color: #000000;">&quot;</span><span style="background: #ffffff; color: #0000ff;">?&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;!--</span><span style="background: #ffffff; color: #008000;"> Type attribute is same as Type registry key </span><br /> <span style="background: #ffffff; color: #008000;">&#0160;&#0160;(Standard, Translator, Plugin (Server only) </span><span style="background: #ffffff; color: #0000ff;">--&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">Addin</span> <span style="background: #ffffff; color: #ff0000;">Type</span><span style="background: #ffffff; color: #0000ff;">=</span><span style="background: #ffffff; color: #000000;">&quot;</span><span style="background: #ffffff; color: #0000ff;">Standard</span><span style="background: #ffffff; color: #000000;">&quot;</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;!--</span><span style="background: #ffffff; color: #008000;"> Should be the same as the &quot;GuidAttribute&quot; in MyClrAddIn.h </span><span style="background: #ffffff; color: #0000ff;">--&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">ClassId</span><span style="background: #ffffff; color: #0000ff;">&gt;{</span><span style="background: #ffffff; color: #000000;">3543165F-7F19-4614-8842-572A5EBE9549}</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">ClassId</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">ClientId</span><span style="background: #ffffff; color: #0000ff;">&gt;{</span><span style="background: #ffffff; color: #000000;">3543165F-7F19-4614-8842-572A5EBE9549}</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">ClientId</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;!--</span><span style="background: #ffffff; color: #008000;"> Both of the following fields should be translated. </span><br /> <span style="background: #ffffff; color: #008000;">&#0160;&#0160;NO OTHER FIELDS SHOULD BE TRANSLATED! </span><span style="background: #ffffff; color: #0000ff;">--&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">DisplayName</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">MyClrAddIn</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">DisplayName</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">Description</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">MyClrAddIn</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">Description</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;!--</span><span style="background: #ffffff; color: #008000;"> Assumes that MyClrAddIn.dll is in the same folder as the *.addin file </span><span style="background: #ffffff; color: #0000ff;">--&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">Assembly</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">MyClrAddIn.dll</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">Assembly</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">SupportedSoftwareVersionGreaterThan</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">17..</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">SupportedSoftwareVersionGreaterThan</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">LoadOnStartUp</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">1</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">LoadOnStartUp</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&#0160;&#0160;&lt;</span><span style="background: #ffffff; color: #a31515;">Hidden</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><span style="background: #ffffff; color: #000000;">0</span><span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">Hidden</span><span style="background: #ffffff; color: #0000ff;">&gt;</span><br /> <span style="background: #ffffff; color: #0000ff;">&lt;/</span><span style="background: #ffffff; color: #a31515;">Addin</span><span style="background: #ffffff; color: #0000ff;">&gt;</span></div>
</div>
<p>Here is the source code of the project:<br /><a href="https://github.com/adamenagy/Inventor-AddInWithCLR">https://github.com/adamenagy/Inventor-AddInWithCLR</a></p>
