---
layout: "post"
title: "Know if a given Part Feature was created by an iFeature and which one"
date: "2012-09-13 02:01:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/09/know-if-a-given-part-feature-was-created-by-an-ifeature-and-which-one.html "
typepad_basename: "know-if-a-given-part-feature-was-created-by-an-ifeature-and-which-one"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Issue      <br /></strong>Given a Part containing various features, how can I know which ones are the result of an iFeature and in this case, can I know which iFeature definition file (*.ide) was used to generate it?</p>
<p><a name="section2"></a></p>
<p><strong>Solution      <br /></strong>The following code sample will print in the immediate VBA window the list of all the features contained in the current Part, that were generated by an iFeature. The last known path and filename of the parent iFeature will be printed out as well.</p>
<p>VBA Code:</p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;">Public Sub GetiFeatures<span style="color: #ff0000;">(</span><span style="color: #ff0000;">)</span>       <br />      <br />      <br />&#0160;&#0160;&#0160; Dim oDoc As PartDocument       <br />&#0160;&#0160;&#0160; Set oDoc = ThisApplication.ActiveDocument       <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim oRefComps As ReferenceComponents       <br />&#0160;&#0160;&#0160; Set oRefComps = oDoc.ComponentDefinition.ReferenceComponents       <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim oiFeatureComp As iFeatureComponent       <br />&#0160;&#0160;&#0160; For Each oiFeatureComp In oRefComps.iFeatureComponents       <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print <span style="color: #ff00ff;">&quot;Feature Name: &quot;</span> + oiFeatureComp.Name       <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Debug.Print <span style="color: #ff00ff;">&quot;Generated by iFeature: &quot;</span> + oiFeatureComp.iFeatureTemplateDescriptor.LastKnownSourceFileName + vbCrLf       <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Next       <br />      <br />End Sub</span></p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;</span></p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;</span></p>
VB.NET Code
<div style="font-family: courier new; background: white; color: black; font-size: 9pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">Public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">Sub</span><span style="line-height: 140%;"> GetiFeatures()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">Dim</span><span style="line-height: 140%;"> oDoc </span><span style="line-height: 140%; color: blue;">As</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">PartDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; oDoc = _InvApplication.ActiveDocument</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">Dim</span><span style="line-height: 140%;"> oRefComps </span><span style="line-height: 140%; color: blue;">As</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">ReferenceComponents</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; oRefComps = oDoc.ComponentDefinition.ReferenceComponents</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">Dim</span><span style="line-height: 140%;"> oiFeatureComp </span><span style="line-height: 140%; color: blue;">As</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">iFeatureComponent</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">For</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">Each</span><span style="line-height: 140%;"> oiFeatureComp </span><span style="line-height: 140%; color: blue;">In</span><span style="line-height: 140%;"> oRefComps.iFeatureComponents</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Debug</span><span style="line-height: 140%;">.Print(</span><span style="line-height: 140%; color: #a31515;">&quot;Feature Name: &quot;</span><span style="line-height: 140%;"> + oiFeatureComp.Name)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Debug</span><span style="line-height: 140%;">.Print(</span><span style="line-height: 140%; color: #a31515;">&quot;Generated by iFeature: &quot;</span><span style="line-height: 140%;"> + oiFeatureComp.iFeatureTemplateDescriptor.LastKnownSourceFileName + vbCrLf)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">End</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">Sub</span></p>
</div>
