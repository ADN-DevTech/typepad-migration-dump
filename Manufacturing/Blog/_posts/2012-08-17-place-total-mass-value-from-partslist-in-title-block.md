---
layout: "post"
title: "Place total mass value from partslist in Title Block"
date: "2012-08-17 10:56:38"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/place-total-mass-value-from-partslist-in-title-block.html "
typepad_basename: "place-total-mass-value-from-partslist-in-title-block"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The mass values can be queried from Partslist and we can iterate through all rows and sum up all mass column values. We can create a custom property named &quot;Mass&quot; with PropID 99 and this property can be put into Title Block as TextBox object. We can also put some static text like &quot;Total Weight&quot; or &quot;Total Mass&quot; to the left of custom property.</p>  <p>The Advantage of using Custom property in Title Block is that it gets updated automatically when the property value is modified. The sample code demonstrates same.</p>  <p>If the drawing does not contain mass column in PartsList then you    <br />can add one&#160; by following the procedure shown below</p>  <ol>   <li>Select PartsList </li>    <li>Right click and Select &quot;Edit PartsList...&quot; </li>    <li>Select Column Chooser Icon (2nd from left) </li>    <li>In the left Combo box select PartsList </li>    <li>At the list select &quot;MASS&quot; and click on &quot;Add-&gt;&quot; button </li> </ol>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Sub</font></font></span><font style="font-size: 8pt" color="#000000"> UpdateMassInTitleBlock()</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' The sample code calculates total</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' weight from partslist and adds a</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' custom property &quot;mass&quot; to drawing</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' document, this custom property is</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' then added to title block definition.</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Make sure that Mass column is</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' added to partslist</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' The custom property is added once</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' to title block definition, whenever the</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' value of custom property changes</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' the value is automatically updated in</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Title block</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' This sample should be tested on</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' a drawing which has C/A2 sheet along</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' With PartsList</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' The co-ordinated of static text</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' and property value are based on sheet size</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Document</font></span><font color="#000000"> = _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; m_inventorApplication.ActiveDocument</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (oDoc.DocumentType = </font><span><font color="#2b91af">DocumentTypeEnum</font></span><font color="#000000">. _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; kDrawingDocumentObject) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oDrgDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">DrawingDocument</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oDrgDoc = oDoc</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'sum up the mass from partslist</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oPartsList </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">PartsList</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oPartsList = oDrgDoc.ActiveSheet. _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; PartsLists.Item(1)</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Assuming that last column is mass</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> dTotalWt </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i = 1 </font><span><font color="#0000ff">To</font></span><font color="#000000"> oPartsList.PartsListRows.Count</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> nColInd </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Long</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; nColInd = oPartsList.PartsListColumns.Count</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get weight from column , it also contains units</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> sVal </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; sVal = oPartsList.PartsListRows. _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Item(i).Item(nColInd).ToString() </font></font><span><font style="font-size: 8pt" color="#008000">' CHNAGE 1</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pos </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Integer</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; pos = InStrRev(sVal, </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot; &quot;</font></span><font color="#000000">)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Get the units of mass value</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> sUnits </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; sUnits = Mid(sVal, pos + 1)</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; sVal = LSet(sVal, pos - 1) </font></font><span><font style="font-size: 8pt" color="#008000">'chnage 2</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (sUnits = </font><span><font color="#a31515">&quot;lbmass&quot;</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; dTotalWt = dTotalWt + </font></font><font style="font-size: 8pt"><span><font color="#0000ff">CDbl</font></span><font color="#000000">(sVal) _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; * (1.0# / 2.2) </font></font><span><font style="font-size: 8pt" color="#008000">'convert to Kg</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Else</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; dTotalWt = dTotalWt + </font></font><font style="font-size: 8pt"><span><font color="#0000ff">CDbl</font></span><font color="#000000">(sVal)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Add the custom property mass if not present</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Get User Defined propertySet</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oPropSet </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">PropertySet</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oPropSet = oDoc.PropertySets(</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;User Defined Properties&quot;</font></span><font color="#000000">)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oProp </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font></font><span><font style="font-size: 8pt" color="#2b91af">Property</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oProp = oPropSet.ItemByPropId(99)</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'change 2</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Call</font></span><font color="#000000"> oPropSet.Add(dTotalWt, </font><span><font color="#a31515">&quot;Mass&quot;</font></span><font color="#000000">, 99)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Catch</font></span><font color="#000000"> ex </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">Exception</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; oProp.Value = dTotalWt</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Check whether 'Total Weight' label is present</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oTitleDef </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">TitleBlockDefinition</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTitleDef = oDrgDoc.ActiveSheet. _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; TitleBlock.Definition</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oTextB </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">TextBox</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> oTextB </font><span><font color="#0000ff">In</font></span><font color="#000000"> oTitleDef.Sketch.TextBoxes</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> oTextB.Text = </font><span><font color="#a31515">&quot;Total Weight&quot;</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.Save()</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Exit Sub</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oTG </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">TransientGeometry</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTG = m_inventorApplication.TransientGeometry</font></font></p>  <p style="margin: 0px; font-family: ; background: white">&#160;</p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'Start edit of Title Block</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oSketch </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">DrawingSketch</font></span><font color="#000000"> = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Call</font></span><font color="#000000"> oTitleDef.Edit(oSketch)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white">&#160;</p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Add static text</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> sText </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; sText = </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;&lt;StyleOverride FontSize='.35'&gt;&quot;</font></span><font color="#000000"> + _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#a31515">&quot;Total Weight&lt;/StyleOverride&gt;&quot;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oTextBox </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">TextBox</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox = oSketch.TextBoxes.AddFitted(</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(43, 5), sText)</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox.VerticalJustification = _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">VerticalTextAlignmentEnum</font></span><font color="#000000">.kAlignTextMiddle</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox.HorizontalJustification = _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">HorizontalTextAlignmentEnum</font></span><font color="#000000">.kAlignTextLeft</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Add some property Value</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' In the statement below Property </font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Document= 'drawing' means that</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' custom property is part of this</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' drawing document.</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' FormatID is GUID of User</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Defined(properties)</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Finally value 99 in PropertyID</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' is value we assigned to Mass property</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' The property value updates</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' automatically in the title block when</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' the value of property is modified.</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' GUID of user defined properties</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'{D5CDD505-2E9C-101B-9397-08002B2CF9AE}</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; sText = </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;&lt;StyleOverride FontSize='0.35'&gt;&quot;</font></span><font color="#000000"> + _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;&lt;Property Document='drawing' &quot;</font></span><font color="#000000"> + _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;FormatID=&quot;</font></span><font color="#000000"> + _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;'{D5CDD505-2E9C-101B-9397-08002B2CF9AE}' &quot;</font></span><font color="#000000"> + _</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#a31515">&quot;PropertyID='99' /&gt;&lt;/StyleOverride&gt;&quot;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox = oSketch.TextBoxes.AddFitted( _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; oTG.CreatePoint2d(46, 5), sText)</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox.VerticalJustification = _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">VerticalTextAlignmentEnum</font></span><font color="#000000">.kAlignTextMiddle</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; oTextBox.HorizontalJustification = _</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">HorizontalTextAlignmentEnum</font></span><font color="#000000">.kAlignTextLeft</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' End editing</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Call</font></span><font color="#000000"> oTitleDef.ExitEdit(</font><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>
