---
layout: "post"
title: "Drag & Drop file from external application"
date: "2015-04-09 07:45:28"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2015/04/drag-drop-file-from-external-application.html "
typepad_basename: "drag-drop-file-from-external-application"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>You may want to provide a user control with a list of components that you could drag &amp; drop onto <strong>Inventor</strong>. In case of <strong>.NET</strong> it&#39;s quite easy to set up. You just have to handle the <strong>MouseDown</strong> event of the control from which you want to enable the <strong>Drag &amp; Drop</strong>, and then set up the data that could be dragged onto another applications.</p>
<p>In this case we have a simple <strong>.NET Form</strong> with a button on it named <strong>myButton</strong> with text <strong>&quot;Drag Me!&quot;</strong>. If the user starts dragging this button then it will drag a file onto other applications like <strong>Inventor</strong>, which accept such a thing.</p>
<p>Here is the main part of the <strong>C#</strong> source code:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Collections.Specialized;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Windows.Forms;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> DragAndDropTest</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public&#0160;</span><span style="background: #ffffff; color: #0000ff;">partial&#0160;</span><span style="background: #ffffff; color: #0000ff;">class </span><span style="background: #ffffff; color: #2b91af;">MyForm</span><span style="background: #ffffff; color: #000000;">&#0160;: </span><span style="background: #ffffff; color: #2b91af;">Form</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span><span style="background: #ffffff; color: #000000;">&#0160;MyForm()</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;InitializeComponent();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">private&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;">&#0160;myButton_MouseDown(<br /></span><span style="background: #ffffff; color: #0000ff;">&#0160; &#0160; &#0160; object</span><span style="background: #ffffff; color: #000000;"> sender, </span><span style="background: #ffffff; color: #2b91af;">MouseEventArgs</span><span style="background: #ffffff; color: #000000;"> e)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">DataObject</span><span style="background: #ffffff; color: #000000;">&#0160;dragInfo = </span><span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">DataObject</span><span style="background: #ffffff; color: #000000;">();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">StringCollection</span><span style="background: #ffffff; color: #000000;"> coll = </span><span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">StringCollection</span><span style="background: #ffffff; color: #000000;">();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;coll.Add(</span><span style="background: #ffffff; color: #a31515;">@&quot;c:\temp\test.ipt&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;dragInfo.SetFileDropList(coll);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// &quot;Copy&quot; will let us open the ipt</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// &quot;Link&quot; will let us insert the ipt in an assembly</span><br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; myButton.DoDragDrop(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;dragInfo, <br /></span><span style="background: #ffffff; color: #2b91af;">&#0160; &#0160; &#0160; &#0160; DragDropEffects</span><span style="background: #ffffff; color: #000000;">.Copy | </span><span style="background: #ffffff; color: #2b91af;">DragDropEffects</span><span style="background: #ffffff; color: #000000;">.Link);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>Here it is in action:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c775b289970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="Drag&amp;Drop" class="asset  asset-image at-xid-6a0167607c2431970b01b7c775b289970b img-responsive" src="/assets/image_03ce96.jpg" title="Drag&amp;Drop" /></a></p>
<p>&#0160;</p>
