---
layout: "post"
title: "What&rsquo;s new in the Vault 2021 API"
date: "2020-06-15 08:49:47"
author: "Sajith Subramanian"
categories:
  - "Sajith Subramanian"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2020/06/whats-new-in-the-vault-2020-api.html "
typepad_basename: "whats-new-in-the-vault-2020-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/sajith-subramanian.html" target="_self">Sajith Subramanian</a><p>Vault 2021 was released worldwide in March 2020. This blog post will highlight the major API updates for this release.<p>In case you prefer to watch, rather than read, please feel free to skip to the below video! <a href="https://www.youtube.com/watch?v=dtWpkKAAnzM">https://www.youtube.com/watch?v=dtWpkKAAnzM<br></a><h3>New Web Service: Analytics Service</h3><p>The Analytics Service collects and reports information back to users for Duplicate Search functionality, which finds geometrically identical shapes inside a Vault.<p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0263e950b796200b-pi"><img width="682" height="433" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_2a3611.jpg" border="0"></a><p><strong><br></strong><p><strong>New Supporting Classes:</strong><h4><em>1. DuplicateSearchSnapshot</em></h4><ul><li>&nbsp;<strong>CandidateFileCount (long)</strong></li><ul><li>Total files that are within the indexing scope for determining duplicates.</li></ul><li>&nbsp;<strong>DuplicateFileCount (long)</strong></li><ul><li>The number of files determined as duplicates.</li></ul><li><strong>DuplicateFileGroupsCount (long)</strong></li><ul><li><strong> </strong>The number of files determined as having unique shapes (group).</li></ul><li><strong>Extension (string)</strong></li><ul><li>The file extension.</li></ul><li><strong>IndexedFileCount (long)</strong></li><ul><li>The number of files currently indexed for determining duplicates.</li></ul><li><strong>VaultedFileCount (long)</strong></li><ul><li>The total number of files that are in the current Vault.</li></ul></ul><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0264e2e2ce0a200d-pi"><img width="696" height="333" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_e2d12d.jpg" border="0"></a></p><p><br></p><h4><em>2. DuplicateSearchStatus</em></h4><ul><li><strong>AnyFailedIndexedJobs (bool)</strong></li><ul><li>Did any jobs fail for indexing the file data?</li></ul><li><strong>IsEnabled (bool)</strong></li><ul><li>Is the Duplicate Search functionality enabled?</li></ul><li><strong>IsFoldersConfigured (bool)</strong></li><ul><li>Are there any folders configured for file indexing?</li></ul><li><strong>Snapshot (DuplicateSearchSnapshot)</strong></li><ul><li>A snapshot of the duplicate search results.</li></ul></ul><p><br></p><h4><em>3. DuplicateSearchFolderConfiguration</em></h4><ul><li><strong>FolderId (long)</strong></li><ul><li>The folder ID in duplicate search’s scope.</li></ul></ul><p><br><h4><em>4. DuplicateSearchConfiguration</em></h4><ul><li><strong>DuplicateSearchFolderConfigurationArray (DuplicateSearchFolderConfiguration[])</strong></li><ul><li>A collection of duplicate search folder configurations, which defines the scope of folders to use in indexing.</li></ul><li><strong>Enabled (bool)</strong></li><ul><li>Is duplicate search enabled for the current Vault?</li></ul></ul><p><br></p><p><strong>New Methods:</strong></p><ul><li><strong>DuplicateSearchConfiguration GetDuplicateSearchConfiguration()</strong></li><ul><li>Gets the current Vault’s duplicate search configuration.</li></ul><li><strong>void SetDuplicateSearchConfiguration(DuplicateSearchConfiguration config)</strong></li><ul><li>Sets the duplicate search configuration for the current Vault.</li></ul><li><strong>DuplicateSearchStatus GetDuplicateSearchStatus()</strong></li><ul><li>Gets the Vault’s duplicate search status, which contains snapshot data.</li></ul></ul><p><br></p><h3>Updated Web Service: Change Order Service</h3><p><strong>New Supporting Classes:</strong></p><h4><em>1. ChangeOrderEmailTemplate</em></h4><ul><li><strong>Body (string)</strong></li><ul><li>The template for the email’s body.</li></ul><li><strong>COPropDefIdArray (long[])</strong></li><ul><li>A collection of which change order property definitions to include in the e-mail, selected by property definition ID.</li></ul><li><strong>FilePropDefIdArray (long[])</strong></li><ul><li>A collection of which controlled files’ property definitions to include in the e-mail, selected by property definition ID.</li></ul><li><strong>ItemPropDefIdArray (long[])</strong></li><ul><li>A collection of which controlled items’ property definitions to include in the e-mail, selected by property definition ID.</li></ul><li><strong>Subject (string)</strong></li><ul><li>The template for the email’s subject</li></ul></ul><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0263ec22580e200c-pi"><img width="750" height="386" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_fcc3c6.jpg" border="0"></a></p><p><br></p><h4><em>2. EmailMsg</em></h4><ul><li><strong>Body (string)</strong></li><ul><li>The e-mail’s body</li></ul><li><strong>Subject (string)</strong></li><ul><li>The e-mail’s subject</li></ul></ul><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0263e950b7ab200b-pi"><img width="750" height="352" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_54900f.jpg" border="0"></a></p><p><br></p><p><strong>New Methods:</strong></p><ul><li><strong>ChangeOrderEmailTemplate GetDefaultEmailTemplate()</strong></li><ul><li>Gets the current Vault’s system-generated (default) e-mail template for change order notifications.</li></ul><li><strong>ChangeOrderEmailTemplate GetEmailTemplate()</strong></li><ul><li>Gets the customized email template for change order notifications.</li></ul><li><strong>void SaveEmailTemplate(string subject, string body, long[] coPropDefIds, long[] itemPropDefIds, long[] filePropDefIds)</strong></li><ul><li>Saves the customized e-mail template to a ChangeOrderEmailTemplate object, for use in change order notifications.</li></ul><li><strong>EmailMsg GetEmailMessageByChangeOrderId(long changeOrderId, string changeOrderNumber, string stateName, bool excludeRelatedObjects)</strong></li><ul><li>Gets an e-mail message for a given Change order ID.</li></ul></ul><p><strong><br></strong></p><p><strong>Removed Methods:</strong></p><ul><li><strong>string GetEmailBodyByChangeOrderId(long changeOrderId, string changeOrderNumber, string stateName, bool excludeRelatedObjects)</strong></li><ul><li>This method has been replaced with <strong>GetEmailMessageByChangeOrderId()</strong></li></ul></ul><p><br></p><h3>Miscellaneous Changes</h3><p><strong>New Property:</strong></p><ul><li><strong>Role.SysName (string)</strong></li><ul><li>Exposes the Role’s internal system name.</li><li>This value is immutable and cannot be user set.</li></ul></ul><p><strong>New Method:</strong><ul><li><strong>Job JobService.ResubmitJob(long jobId)</strong></li><ul><li>You can now resubmit jobs from Vaults other than where they were originally submitted from.</li></ul></ul><p><strong>Updated Enumerations:</strong></p><ul><li><strong>FileClassification.DesignPresentation</strong></li><ul><li>With this new classification, we can identify Inventor Presentation (.IPN) files more accurately within Vault</li></ul></ul><p><br></p><h3>Highlighted Feature Updates</h3><p><br></p><h4><em>1. Download Permisisons</em></h4><ul><li>Updated Property:</li><ul><li>AccessPermis.Id (long)</li></ul><li>There’s a new Id value added to accommodate for setting or denying Download Permissions: </li><ul><li>4, AllowDownload</li></ul><li>New Exception Class:</li><ul><li>VaultDownloadDeniedException</li></ul></ul><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0263ec225816200c-pi"><img width="607" height="732" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_a3f7dc.jpg" border="0"></a></p><p><br></p><h4><em>2. Purge Enhancements</em></h4><p><strong>New Method:</strong><ul><li><strong>void LifeCycleService.ApplyPurgeRestrictOptionToHistory(long lcStateId)</strong></li></ul><p><a href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0264e2e2ce16200d-pi"><img width="629" height="537" title="image" style="display: inline; background-image: none;" alt="image" src="/assets/image_ff1a4f.jpg" border="0"></a></p>
