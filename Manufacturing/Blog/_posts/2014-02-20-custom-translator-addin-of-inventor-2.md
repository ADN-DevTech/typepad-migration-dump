---
layout: "post"
title: "Custom Translator Addin of Inventor - 2"
date: "2014-02-20 23:57:58"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2014/02/custom-translator-addin-of-inventor-2.html "
typepad_basename: "custom-translator-addin-of-inventor-2"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>(Continued)</p>  <p>In the <a href="http://adndevblog.typepad.com/manufacturing/2014/02/custom-translator-addin-of-inventor-1.html">past post</a>, we got a skeleton of a translator add-in. By this translator, we can open a data source *.abc, and save the geometries of Inventor to a *.abc file.</p>  <p>To make a simpler demo, we define the *.abc as a text file. It has 3 lines:</p>  <p>1. Three double, split by the comma (for center point of a sphere)</p>  <p>2. A double (for radius of a sphere)</p>  <p>3. A string (for iProperties &gt;&gt; part number)</p>  <p>In Open method of the add-in. we will open a *.abc file, create a sphere with data of line 1 &amp; 2, and update iProperties &gt;&gt; part number with line 3. In the SaveCopyAs method, we will get one existing sphere face of a part, save center point coordinates and radius to the *.abc file. And save iProperties &gt;&gt; part number to the file.</p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="font-family: &#39;Times New Roman&#39;"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="color: #0000ff"><span style="font-size: 8pt">public</span></span></span><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-size: 8pt"><span><span style="color: #0000ff">void</span></span><span style="color: #000000"> Open(</span><span><span style="color: #2b91af">DataMedium</span></span><span style="color: #000000"> SourceData,</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">TranslationContext</span></span><span style="color: #000000"> Context, </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">NameValueMap</span></span><span style="color: #000000"> Options,</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">ref</span></span><span><span style="color: #0000ff">object</span></span><span style="color: #000000"> TargetObject)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="font-size: 8pt">{</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// When Open *.abc, this function will</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// be invoked</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//the file name of the data source </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000"> fileName = SourceData.FileName;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// the params read from the data source</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//center point of sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Point</span></span><span style="color: #000000"> oCenterPt = </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.TransientGeometry.CreatePoint();</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//radius of sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">double</span></span><span style="color: #000000"> radius = 0;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//part number</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000"> partNumber = </span><span><span style="color: #a31515">&quot;&quot;</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff; font-size: 8pt">try</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//read the data source </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">using</span></span><span style="color: #000000"> (</span><span><span style="color: #2b91af">StreamReader</span></span><span style="color: #000000"> sr = </span><span><span style="color: #0000ff">new</span></span><span><span style="color: #2b91af">StreamReader</span></span><span style="color: #000000">(fileName))</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">String</span></span><span style="color: #000000"> line;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">int</span></span><span style="color: #000000"> rowIndex = 0;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// Read and display lines from the file until the end of </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// the file is reached.</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">while</span></span><span style="color: #000000"> ((line = sr.ReadLine()) != </span><span><span style="color: #0000ff">null</span></span><span style="color: #000000">)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (rowIndex == 0)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//center point of sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000">[] oStrArray = line.Split(</span><span><span style="color: #0000ff">new</span></span><span><span style="color: #0000ff">char</span></span><span style="color: #000000">[]{</span><span><span style="color: #a31515">&#39;,&#39;</span></span><span style="color: #000000">});</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oCenterPt.X = </span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Convert</span></span><span style="color: #000000">.ToDouble(oStrArray[0]);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oCenterPt.Y = </span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Convert</span></span><span style="color: #000000">.ToDouble(oStrArray[1]);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>oCenterPt.Z = </span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Convert</span></span><span style="color: #000000">.ToDouble(oStrArray[2]);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">else</span></span><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (rowIndex == 1)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//radius of sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">radius = </span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Convert</span></span><span style="color: #000000">.ToDouble(line);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">else</span></span><span><span style="color: #0000ff">if</span></span><span style="color: #000000">(rowIndex == 2)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//part number</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">partNumber = line;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff; font-size: 8pt">else</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//in this demo, we are interested in</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// the 3 params only</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">break</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">rowIndex++;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff; font-size: 8pt">try</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (radius &gt; 0)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//if the radius is valid</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//create a new part document</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PartDocument</span></span><span style="color: #000000"> oNewDoc =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.Documents.Add(</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">DocumentTypeEnum</span></span><span style="color: #000000">.kPartDocumentObject)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">as</span></span><span><span style="color: #2b91af">PartDocument</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//get ComponentDefinition of the part</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PartComponentDefinition</span></span><span style="color: #000000"> oDocDef =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oNewDoc.ComponentDefinition;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//get TransientBRep</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">TransientBRep</span></span><span style="color: #000000"> oTB =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.TransientBRep;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//create a transient body of a sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">SurfaceBody</span></span><span style="color: #000000"> oSB =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oTB.CreateSolidSphere(oCenterPt, radius);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//add the transient body to the part as a </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// non ParametricBaseFeature</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oDocDef.Features.</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">NonParametricBaseFeatures.Add(oSB);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//update the iProperties with the part</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//number from the data source</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PropertySet</span></span><span style="color: #000000"> oPS = </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oNewDoc.PropertySets[</span></span><span style="font-size: 8pt"><span><span style="color: #a31515">&quot;Design Tracking Properties&quot;</span></span><span style="color: #000000">];</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oPS.ItemByPropId[</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">(</span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">int</span></span><span style="color: #000000">)</span><span><span style="color: #2b91af">PropertiesForDesignTrackingPropertiesEnum</span></span><span style="color: #000000">.</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">kPartNumberDesignTrackingProperties].Value = partNumber;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.ActiveView.Fit();</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff; font-size: 8pt">else</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">MessageBox</span></span><span style="color: #000000">.Show(</span><span><span style="color: #a31515">&quot;the radius is invalid!&quot;</span></span><span style="color: #000000">);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">catch</span></span><span style="color: #000000"> (</span><span><span style="color: #2b91af">Exception</span></span><span style="color: #000000"> Exception1)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">MessageBox</span></span><span style="color: #000000">.Show(</span><span><span style="color: #a31515">&quot;fail to create model!\n&quot;</span></span><span style="color: #000000"> + </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Exception1.ToString());</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">} </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">catch</span></span><span style="color: #000000">(</span><span><span style="color: #2b91af">Exception</span></span><span style="color: #000000"> Exception){</span></span><span style="mso-spacerun: yes"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">MessageBox</span></span><span style="color: #000000">.Show(</span><span><span style="color: #a31515">&quot;reading data failed!\n&quot;</span></span><span style="color: #000000"> +</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Exception.ToString());</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">} </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="mso-spacerun: yes"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="font-family: &#39;Times New Roman&#39;"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="color: #0000ff"><span style="font-size: 8pt">public</span></span></span><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-size: 8pt"><span><span style="color: #0000ff">void</span></span><span style="color: #000000"> SaveCopyAs(</span><span><span style="color: #0000ff">object</span></span><span style="color: #000000"> SourceObject, </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">TranslationContext</span></span><span style="color: #000000"> Context,</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">NameValueMap</span></span><span style="color: #000000"> Options, </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">DataMedium</span></span><span style="color: #000000"> TargetData)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// When save to *.abc, this function will</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">// be invoked</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//the file to be saved</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000"> fileName = TargetData.FileName;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PartDocument</span></span><span style="color: #000000"> oPartDoc =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.ActiveDocument</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">as</span></span><span><span style="color: #2b91af">PartDocument</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PartComponentDefinition</span></span><span style="color: #000000"> oPartDef =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oPartDoc.ComponentDefinition;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (oPartDef.Features.RevolveFeatures.Count &gt; 0)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//if there is revolve feature in the part</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//get one revolve feature</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//which is full sphere surface</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">bool</span></span><span style="color: #000000"> found = </span><span><span style="color: #0000ff">false</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Point</span></span><span style="color: #000000"> centerPt =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">m_inventorApplication.TransientGeometry.CreatePoint();</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">double</span></span><span style="color: #000000"> radius = 0;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000"> partNumber = </span><span><span style="color: #a31515">&quot;&quot;</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">foreach</span></span><span style="color: #000000"> (</span><span><span style="color: #2b91af">RevolveFeature</span></span><span style="color: #000000"> oRF</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">in</span></span><span style="color: #000000"> oPartDef.Features.RevolveFeatures)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (oRF.Faces.Count == 1 )</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Face</span></span><span style="color: #000000"> oF = oRF.Faces[1];</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000">(oF.Edges.Count == 0 &amp;&amp;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oF.Vertices.Count ==0 )</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//this is a full sphere</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">found = </span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">true</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">SurfaceEvaluator</span></span><span style="color: #000000"> oSE = oF.Evaluator;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//calculate radius</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">radius = </span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Math</span></span><span style="color: #000000">.Sqrt(oSE.Area / 4 * </span><span><span style="color: #2b91af">Math</span></span><span style="color: #000000">.PI);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//calcuate center point</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Point</span></span><span style="color: #000000"> maxPt = oSE.RangeBox.MaxPoint;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">Point</span></span><span style="color: #000000"> minPt = oSE.RangeBox.MinPoint;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>centerPt.X = (maxPt.X - minPt.X) / 2.0;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">centerPt.Y = (maxPt.X - minPt.Y) / 2.0;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">centerPt.Z = (maxPt.X - minPt.Z) / 2.0;</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;</span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">if</span></span><span style="color: #000000"> (!found)</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">MessageBox</span></span><span style="color: #000000">.Show(</span><span><span style="color: #a31515">&quot;no revolve feature which is full sphere!&quot;</span></span><span style="color: #000000">);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">return</span></span><span style="color: #000000">;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//get the iProperties &gt;&gt; part number</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">Inventor.</span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">PropertySet</span></span><span style="color: #000000"> oPS =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">oPartDoc.PropertySets[</span></span><span style="font-size: 8pt"><span><span style="color: #a31515">&quot;Design Tracking Properties&quot;</span></span><span style="color: #000000">];</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">partNumber = oPS.ItemByPropId[</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">(</span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">int</span></span><span style="color: #000000">)</span><span><span style="color: #2b91af">PropertiesForDesignTrackingPropertiesEnum</span></span><span style="color: #000000">.</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">kPartNumberDesignTrackingProperties].Value.ToString();</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="mso-spacerun: yes"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000; font-size: 8pt">//write the data to the *.abc</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">using</span></span><span style="color: #000000"> (</span><span><span style="color: #2b91af">StreamWriter</span></span><span style="color: #000000"> writer =</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">new</span></span><span><span style="color: #2b91af">StreamWriter</span></span><span style="color: #000000">(fileName))</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-tab-count: 1"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160; </span>{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #0000ff">string</span></span><span style="color: #000000"> centerPtStr=centerPt.X + </span><span><span style="color: #a31515">&quot;,&quot;</span></span><span style="color: #000000"> +</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">centerPt.Y + </span></span><span style="font-size: 8pt"><span><span style="color: #a31515">&quot;,&quot;</span></span><span style="color: #000000"> +</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">centerPt.Z;</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-tab-count: 1"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>writer.WriteLine(centerPtStr );</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-tab-count: 1"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>writer.WriteLine(radius.ToString());</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-tab-count: 1"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>writer.WriteLine(partNumber);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-tab-count: 1"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160; </span>}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="mso-spacerun: yes"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #0000ff; font-size: 8pt">else</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">{</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span><span style="color: #2b91af">MessageBox</span></span><span style="color: #000000">.Show(</span><span><span style="color: #a31515">&quot;no revolve feature!&quot;</span></span><span style="color: #000000">);</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000"><span style="mso-spacerun: yes"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt">}</span></span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none"><span lang="EN-US" style="mso-font-kerning: 0pt"><span style="font-family: &#39;Times New Roman&#39;"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>  <p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none">&#0160;</p>  <p>The full project can be downloaded at: <span class="asset  asset-generic at-xid-6a0167607c2431970b01a511722c04970c img-responsive"><a href="http://adndevblog.typepad.com/files/mytranslator.zip">Download MyTranslator</a></span></p>  <p><span class="asset  asset-generic at-xid-6a0167607c2431970b01a511722c04970c img-responsive"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d7d75bd970d-pi"><img alt="Untitled" height="224" src="/assets/image_ddae66.jpg" style="display: inline" title="Untitled" width="299" /></a></span></p>  <p>As you remember, we can customize the options of the built-in translators. It is same to custom translator add-in.In the demo above, we define the behaviors directly without taking any options into account. In the next post, we will see how to control the options.</p>  <p>(to be continued)</p>
