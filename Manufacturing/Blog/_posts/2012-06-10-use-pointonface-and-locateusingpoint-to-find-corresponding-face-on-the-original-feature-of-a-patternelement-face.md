---
layout: "post"
title: "Use PointOnFace and LocateUsingPoint to find corresponding face on the original feature of a PatternElement face"
date: "2012-06-10 21:54:00"
author: "Gary Wassell"
categories:
  - "Gary Wassell"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/06/use-pointonface-and-locateusingpoint-to-find-corresponding-face-on-the-original-feature-of-a-patternelement-face.html "
typepad_basename: "use-pointonface-and-locateusingpoint-to-find-corresponding-face-on-the-original-feature-of-a-patternelement-face"
typepad_status: "Publish"
---

<p><strong>Issue</strong></p>
<p>Is there a way to find the corresponding face on the original feature for PatternElement face?</p>
<p><a name="section2"></a></p>
<p><strong>Solution</strong></p>
<p>There is not a straightforward way to get at the original face. Here is an approach to find the face on the original feature:</p>
<p>1.&#0160;&#0160;&#0160; Get a sample point on the pattern element face (Face.PointOnFace property) <br />2.&#0160;&#0160;&#0160; Find which PatternElement the point belongs to <br />3.&#0160;&#0160;&#0160; Transform this point to the original occurrence of the pattern (post multiply by the inverse of the transform obtained using FeaturePatternElement.Transform) <br />4.&#0160;&#0160;&#0160; Use the transformed point in SurfaceBody.LocateUsingPoint method to obtain the original face. <br />5.&#0160;&#0160;&#0160; Use this original face to get its feature.</p>
<p>Here is a example. Before running this macro select a face from a CircularPatternFeature. (not a face on the original feature) The corresponding face on the original feature, including the original feature will be added to the selectSet.</p>
<p>VB.NET</p>
<p>&#0160;</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> test()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> m_inventorApp.ActiveDocument.DocumentType &lt;&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 10pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DocumentTypeEnum.kPartDocumentObject </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox(</span></span><span style="font-size: 10pt;"><span><span style="color: #a31515;">&quot;Make a Part Document the active document&quot;</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">End</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oPart </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> PartDocument = m_inventorApp.ActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> oPart.SelectSet.Count &lt; 1 </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="font-size: 10pt;"><span><span style="color: #a31515;">&quot;Need to select a face of a circular pattern feature&quot;</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">End</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> testObj </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">Object</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; testObj = oPart.SelectSet(1)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Not</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">TypeOf</span></span><span style="color: #000000;"> testObj </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> Face </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox(</span></span><span style="font-size: 10pt;"><span><span style="color: #a31515;">&quot;Select a face of a circular patern feature&quot;</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">End</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oSelFace </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> Face</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSelFace = testObj</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oCirPattern </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> CircularPatternFeature</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; testObj = oSelFace.CreatedByFeature</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Not</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">TypeOf</span></span><span style="color: #000000;"> testObj </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> CircularPatternFeature </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MsgBox(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="font-size: 10pt;"><span><span style="color: #a31515;">&quot;Selected face not a face of a circular patern feature&quot;</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">End</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oCirPattern = testObj</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oSelFace_PatternElement </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> FeaturePatternElement</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oPatternElement </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> FeaturePatternElement</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oEachFace </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> Face</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Each</span></span><span style="color: #000000;"> oPatternElement </span><span><span style="color: #0000ff;">In</span></span><span style="color: #000000;"> oCirPattern.PatternElements</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Each</span></span><span style="color: #000000;"> oEachFace </span><span><span style="color: #0000ff;">In</span></span><span style="color: #000000;"> oPatternElement.Faces</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> oEachFace.TransientKey = oSelFace.TransientKey</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 10pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oSelFace_PatternElement = oPatternElement</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">Exit For</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Next</span></span><span style="color: #000000;"> oEachFace</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Not</span></span><span style="color: #000000;"> oSelFace_PatternElement </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span><span style="color: #0000ff; font-size: 10pt;">Exit For</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Next</span></span><span style="color: #000000;"> oPatternElement</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Not</span></span><span style="color: #000000;"> oSelFace_PatternElement </span><span><span style="color: #0000ff;">Is</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Nothing</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oPtInFace </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> Point</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPtInFace = oSelFace.PointOnFace</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oMatrix </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> Matrix</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMatrix = oSelFace_PatternElement.Transform</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMatrix.Invert()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Call</span></span><span style="color: #000000;"> oPtInFace.TransformBy(oMatrix)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oOrignFace </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> Face</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oOrignFace = oPart.ComponentDefinition.</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; SurfaceBodies(1).</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; LocateUsingPoint(ObjectTypeEnum.kFaceObject, oPtInFace)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Call</span></span><span style="color: #000000;"> oPart.SelectSet.Select(oOrignFace)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> oOriginalF </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> PartFeature</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000; font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oOriginalF = oOrignFace.CreatedByFeature</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">Call</span></span><span style="color: #000000;"> oPart.SelectSet.Select(oOriginalF)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 10pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 10pt;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span></span><span><span style="color: #0000ff; font-size: 10pt;">Sub</span></span></span></p>
</div>
