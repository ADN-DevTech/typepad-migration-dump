---
layout: "post"
title: "Inventor API: Alpha Sort Occurrences in Assembly browser"
date: "2013-07-30 01:19:12"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/07/inventor-api-resort-occurrences-in-assembly-browser.html "
typepad_basename: "inventor-api-resort-occurrences-in-assembly-browser"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>
<p><strong>Q: </strong>Is it possible to sort the occurrences alphabetically in an assembly browser? <a name="section2"></a></p>
<p><strong>A: </strong>The following VBA code illustrates the solution.</p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">Public Sub AlphaSortComponents()</span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim oDoc As AssemblyDocument</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Set oDoc = ThisApplication.ActiveDocument</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim odef As AssemblyComponentDefinition</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Set odef = oDoc.ComponentDefinition</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim strOccs() As String</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">ReDim strOccs(odef.Occurrences.Count - 1)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">&#39; Get names of all occurrences in the assembly.</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim i As Long</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">For i = 1 To odef.Occurrences.Count</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">strOccs(i - 1) = odef.Occurrences(i).Name</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Next</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt; tab-stops: 28.8pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">&#39; Sort the names alphabetically.</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">QuickSort strOccs, LBound(strOccs), UBound(strOccs)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">On Error Resume Next</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim oTransaction As Transaction</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Set oTransaction = ThisApplication.TransactionManager _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">.StartTransaction(oDoc, &quot;Sort Components&quot;)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">&#39; Get the &quot;model&quot; browser pane</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim oPane As BrowserPane</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Set oPane = oDoc.BrowserPanes.Item(&quot;AmBrowserArrangement&quot;)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim oPreviousOcc As ComponentOccurrence</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Set oPreviousOcc = Nothing</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Dim j As Long</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">For j = 1 To odef.Occurrences.Count</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oThisOcc As ComponentOccurrence</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oThisOcc = odef.Occurrences.ItemByName(strOccs(j - 1))</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">&#39;Ignore pattern elements</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">If oThisOcc.PatternElement Is Nothing Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oThisNodeDef As BrowserNodeDefinition</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oThisNodeDef = oDoc.BrowserPanes _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">.GetNativeBrowserNodeDefinition(oThisOcc)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oThisBrowserNode As BrowserNode</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>Set oThisBrowserNode = oPane.TopNode _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">.AllReferencedNodes(oThisNodeDef).Item(1)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">If Not oPreviousOcc Is Nothing Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oPreviousNodeDef As BrowserNodeDefinition</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oPreviousNodeDef = oDoc.BrowserPanes _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>.GetNativeBrowserNodeDefinition(oPreviousOcc)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oPreviousBrowserNode As BrowserNode</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oPreviousBrowserNode = oPane.TopNode _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">.AllReferencedNodes(oPreviousNodeDef).Item(1)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Call oPane.Reorder(oPreviousBrowserNode, _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">False, oThisBrowserNode)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">If Err.Number Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oTransaction.Abort</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">MsgBox &quot;Sorting failed.&quot;, vbExclamation</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Exit Sub</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">End If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Else</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">&#39;Move the first node below origin folder</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160; </span>Dim oFirstBrowserNode As BrowserNode</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oTempNode As BrowserNode</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">For Each oTempNode In oPane.TopNode.BrowserNodes</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Dim oNativeObject As Object</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oNativeObject = oTempNode _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">.BrowserNodeDefinition.NativeObject</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">If Not oNativeObject Is Nothing Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">If TypeOf oNativeObject Is ComponentOccurrence Or _</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">TypeOf oNativeObject Is OccurrencePattern Then</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oFirstBrowserNode = oTempNode</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Exit For</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">End If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">End If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Next</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Call oPane.Reorder(oFirstBrowserNode, True, oThisBrowserNode)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Err.Clear</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">End If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Set oPreviousOcc = oThisOcc</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">End If</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">Next</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;">oTransaction.End</span></span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">End Sub</span></span></span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;">&#0160;</p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">Private Sub QuickSort( _</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
strArray() As String, _</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
intBottom As Integer, _</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
intTop As Integer)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160; Dim
strPivot As String, strTemp As String</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160; Dim
intBottomTemp As Integer, intTopTemp As Integer</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;
intBottomTemp = intBottom</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;
intTopTemp = intTop</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160; strPivot
= strArray((intBottom + intTop) \ 2)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160; While
(intBottomTemp &lt;= intTopTemp)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; While
(UCase$(strArray(intBottomTemp)) &lt; UCase$(strPivot) _</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
And intBottomTemp &lt; intTop)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
intBottomTemp = intBottomTemp + 1</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; Wend</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; While
(UCase$(strPivot) &lt; UCase$(strArray(intTopTemp)) _</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
And intTopTemp &gt; intBottom)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
intTopTemp = intTopTemp - 1</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; Wend</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; If
intBottomTemp &lt; intTopTemp Then</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
strTemp = strArray(intBottomTemp)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
strArray(intBottomTemp) = strArray(intTopTemp)</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
strArray(intTopTemp) = strTemp</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; End If</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; If
intBottomTemp &lt;= intTopTemp Then</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
intBottomTemp = intBottomTemp + 1</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;
intTopTemp = intTopTemp - 1</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160;&#0160;&#0160; End If</span></p>
<p><span style="font-family: &#39;courier new&#39;, courier; font-size: 8pt;">&#0160; Wend&#0160;</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">&#0160; &#39;the
function calls itself until everything is in good order</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">&#0160; If
(intBottom &lt; intTopTemp) Then _</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
QuickSort strArray, intBottom, intTopTemp</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">&#0160; If
(intBottomTemp &lt; intTop) Then _</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;
QuickSort strArray, intBottomTemp, intTop</span></p>
<p><span style="font-size: 8pt; font-family: &#39;courier new&#39;, courier;">End Sub</span></p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;">&#0160;</p>
<p class="MsoNormal" style="line-height: 12pt; margin: 0cm 0cm 0pt;">Thanks to&#0160;Nathaniel for help!</p>
