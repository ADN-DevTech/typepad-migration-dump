---
layout: "post"
title: "Assembly is not dirty when modify component in-place"
date: "2012-10-26 02:49:45"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/10/assembly-is-not-dirty-when-modify-component-in-place.html "
typepad_basename: "assembly-is-not-dirty-when-modify-component-in-place"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Issue</strong>    <br />I created an assembly and placed one part, saved them and closed. Next I opened assembly again,&#160; modified part in-place, next returned to assembly and ran the VBA code below. it shows:    <br />&#160;&#160;&#160;&#160; Assembly dirty is false    <br />&#160;&#160;&#160;&#160; Part dirty is true </p>  <p>But if I clicked [Global Update] after&#160; modifying part in-place, returned&#160; to assembly and ran the VBA code below. it shows:   <br />&#160;&#160;&#160;&#160; Assembly dirty is true    <br />&#160;&#160;&#160;&#160; Part dirty is true</p>  <p>The first scenario looks problematic to me. The part has been modified, why the assembly is NOT dirty?</p>  <p>Sub test()   <br />&#160;&#160;&#160; Dim oAssDoc As AssemblyDocument    <br />&#160;&#160;&#160; Set oAssDoc = ThisApplication.ActiveDocument    <br />&#160;&#160;&#160; Dim oStr As String    <br />&#160;&#160;&#160; oStr = &quot;Assembly Dirty is &quot; &amp; oAssDoc.Dirty &amp; vbCr    <br />&#160;&#160;&#160; Dim oPartDoc As PartDocument    <br />&#160;&#160;&#160; Set oPartDoc = oAssDoc.ComponentDefinition.Occurrences(1).Definition.Document    <br />&#160;&#160;&#160; oStr = oStr &amp; &quot;Part&#160; dirty is &quot; &amp; oPartDoc.Dirty    <br />&#160;&#160;&#160; MsgBox oStr    <br />End Sub</p>  <p>   <br /><strong>Solution     <br /></strong>This is as designed that you can reproduce this from UI too.&#160; The Global Update will update all components including the top-assembly. </p>  <p>This is controlled by the Save options(SaveOptions.PromptSaveForRecomputableChanges): Prompt to save for re-computable updates. As default this option is un-checked, so when you modify a part, the referencing(top) assembly does not need to update in this case because the reference relationship is not changed but only need to re-compute the change(like mass properties etc.). Below are the changes which are considered to be recomputable:   <br />•&#160;&#160;&#160;&#160;&#160;&#160;&#160; system resolved file references     <br />•&#160;&#160;&#160;&#160;&#160;&#160;&#160; audit     <br />•&#160;&#160;&#160;&#160;&#160;&#160;&#160; mass properties update     <br />•&#160;&#160;&#160;&#160;&#160;&#160;&#160; drawing view update     <br />•&#160;&#160;&#160;&#160;&#160;&#160;&#160; migration    <br />if you don’t check the option and when modify a part, the top assembly won’t be regarded as dirty unless you call Global Update to force the top assembly to update.</p>
