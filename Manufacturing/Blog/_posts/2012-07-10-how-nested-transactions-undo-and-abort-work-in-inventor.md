---
layout: "post"
title: "How Nested Transactions, Undo and Abort Work in Inventor?"
date: "2012-07-10 02:37:02"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/how-nested-transactions-undo-and-abort-work-in-inventor.html "
typepad_basename: "how-nested-transactions-undo-and-abort-work-in-inventor"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p>For programmers who used ObjectARX before, they understand how transactions work in ObjectARX, but may be wondering how nested transactions suppose to work in Inventor in general.</p>  <p>The following is a summary of how transactions are suppose to work in Inventor:</p>  <p>The Inventor ActiveX API's implementation of nested transactions is based on the Inventor's internal architecture. </p>  <p>1. In Inventor's COM API, transactions are represented by the Transaction object. Transaction objects are managed by the TransactionManager object. You can start a transaction by calling TransactionManager.StartTransaction. To end a transaction, call TransactionManager.EndTransaction. You can abort a transaction before it ends by calling TransactionManager.AbortTransaction.</p>  <p>You can nest transactions by starting/ending another transaction within a scope of another starting/ending transaction.</p>  <p><font size="1" face="Courier New">TransactionManager.StartTransaction // T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.StartTransaction // child of T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.EndTransaction // child of T1</font></p>  <p><font size="1" face="Courier New">TransactionManager.EndTransaction // T1</font></p>  <p>However, you can't overlap one starting/ending loop with another one.</p>  <p><font size="1" face="Courier New">TransactionManager.StartTransaction // T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.StartTransaction // child of T1</font></p>  <p><font size="1" face="Courier New">TransactionManager.EndTransaction // T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.EndTransaction // child of T1</font></p>  <p>The above is wrong.</p>  <p>Refer to the Inventor COM API documentation for more details on Transaction and TransactionManager objects.</p>  <p>2. Undo will undo all nested transactions up to the parent transaction (the top level transaction). Inventor internal architecture only supports such a behavior so the API is reflecting it. So in this sense it will not be transaction UNDO API feature mirrors the AutoCAD implementation. Inventor and AutoCAD function differently.</p>  <p>3. Calling undo transaction on the current top parent transaction will cause an undo only if the transaction is committed. The next committed top level transaction in the stack would then automatically be eligible for the next TransactionManager.UndoTransaction call.</p>  <p>4. When you have nested transactions, you can use CheckPoints to control the level of aborting before transactions are committed. To set a CheckPoint, call TransactionManager.SetCheckPoint(). When you abort, it will roll back to the last available CheckPoint or a specified one. If there is none, it will roll back to the parent transaction. This is generally true but may vary based on where you set your CheckPoint and how you nest your transactions.</p>  <p><font size="1" face="Courier New">TransactionManager.StartTransaction // T1 - parent</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.StartTransaction // child 1 of T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransactionManager.SetCheckPoint // check point for child 1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.EndTransaction // child 1 of T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.StartTransaction // child 2 of T1</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransactionManager.SetCheckPoint // check point for child 2</font></p>  <p><font size="1" face="Courier New">&#160;&#160;&#160; TransactionManager.EndTransaction // child 2 of T1</font></p>  <p><font size="1" face="Courier New">TransactionManager.EndTransaction // T1</font></p>  <p>   <br />5. Currently you can only abort nested child transactions. Parent transactions can only be undo/redo.</p>  <p>ChangeProcessor interface also support undo actions. Please look at Inventor API help document for more details. There are also some related blog articles:</p>  <p><a href="http://adndevblog.typepad.com/manufacturing/2012/05/how-to-undo-or-abort-changeprocessor.html">How to Undo or Abort ChangeProcessor</a></p>  <p><a href="http://adndevblog.typepad.com/manufacturing/2012/05/is-there-a-way-to-purge-all-the-unreferenced-documents-in-inventor.html">Is there a way to purge all the unreferenced documents in Inventor ?</a></p>
