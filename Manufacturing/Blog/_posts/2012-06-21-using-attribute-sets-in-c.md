---
layout: "post"
title: "Using Attribute Sets in C#"
date: "2012-06-21 12:58:47"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/06/using-attribute-sets-in-c.html "
typepad_basename: "using-attribute-sets-in-c"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html" target="_blank">Augusto Goncalves</a></p>  <p>This sample code adds an Attribute Set containing a single Attribute to the first Edge in the Part Document. If the Edge already has the given Attribute, then it replaces with a new value.</p>  <p>Since the value type of an Attribute cannot be changed, if the Edge contains a different Attribute type with the same name, then first delete it and then add an Attribute with the new value.</p>  <p>The code below illustrates how to use Attributes from C#. It expects an open Part Document containing at least one Edge.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// attribute names</font></font></span></p>    <div style="font-family: ; background: white">     <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">const</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000"> attributeSetName = </font><span><font color="#a31515">&quot;MyAttributeSet&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">const</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000"> attributeName = </font><span><font color="#a31515">&quot;MyAttribute&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000"> app = System.Runtime.InteropServices.</font><span><font color="#2b91af">Marshal</font></span><font color="#000000">.</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; GetActiveObject(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Inventor.Application&quot;</font></span><font color="#000000">) </font><span><font color="#0000ff">as</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">Application</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">PartDocument</font></span><font color="#000000"> doc = </font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; app.ActiveDocument </font></font><font style="font-size: 8pt"><span><font color="#0000ff">as</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">PartDocument</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Create a collection of objects</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">object</font></font></span><font style="font-size: 8pt"><font color="#000000"> obj = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ObjectCollection</font></span><font color="#000000"> objectCollection = </font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; app.TransientObjects.CreateObjectCollection(obj);</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Get one surface body edge</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">objectCollection.Add(</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; doc.ComponentDefinition.SurfaceBodies[1].Edges[1]);</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// ... you can keep on adding the objects you need to ...</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// if OpenAttributeSets function does not find the given attribute</font></font></span></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// set for an object in the collection, it creates one for it</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">AttributeSetsEnumerator</font></span><font color="#000000"> attributeSets = </font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; doc.AttributeManager.OpenAttributeSets(</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; objectCollection, attributeSetName);</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// you can keep changing this to check if</font></font></span></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// assigning the new value works fine</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">byte</font></font></span><font style="font-size: 8pt"><font color="#000000">[] newData = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#0000ff">byte</font></span><font color="#000000">[] { 5, 8, 10 }; </font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// attributeSets contains the attributeSet of </font></font></span></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// each object you added to the objectCollection</font></font></span></p>      <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// in this case only one, the first Edge</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><font color="#000000"> (Inventor.</font><span><font color="#2b91af">AttributeSet</font></span><font color="#000000"> attributeSet </font><span><font color="#0000ff">in</font></span><font color="#000000"> attributeSets)</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// if it throws exception, then it did not find the attribute</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Attribute</font></span><font color="#000000"> attribute = attributeSet[attributeName];</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// we have to initialize the array before it can be used</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">byte</font></span><font color="#000000">[] oldData = attribute.Value </font><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#0000ff">byte</font></span><font color="#000000">[];</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// if oldData is null, then it found the attribute</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// but it contains a different data type</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (oldData == </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// we'd better delete the old value with different </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// data type if you want ValueType to be consistent</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// with the object it stores, since we cannot change</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// the attribute.ValueType(read-only)</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; attribute.Delete();</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// and then create it again with the new</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// value type - by throwing exception </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// (same as if the attribute wasn't there in the first place)</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">throw</font></span><font color="#000000"> </font><span><font color="#0000ff">new</font></span><font color="#000000"> System.</font><span><font color="#2b91af">Exception</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;The data type is different, &quot;</font></span><font color="#000000"> +</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot; and therefore the attribute has been deleted&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; attribute.Value = newData;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">catch</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// add the attribute with the new value</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; attributeSet.Add(attributeName, </font></font></p>      <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Inventor.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ValueTypeEnum</font></span><font color="#000000">.kByteArrayType, newData);</font></font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>   </div> </div>
