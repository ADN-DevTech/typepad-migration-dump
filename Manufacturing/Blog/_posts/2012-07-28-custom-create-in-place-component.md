---
layout: "post"
title: "custom 'Create In-Place Component'"
date: "2012-07-28 21:24:10"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/custom-create-in-place-component.html "
typepad_basename: "custom-create-in-place-component"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>By responding to FileUIEvents.OnFileInsertNewDialog the client can replace the 'Create In-Place Component' dialog with their own. This notification is sent to the client immediately after the command is executed but before the standard dialog is displayed to the end-user. By supplying at least the Filename argument and setting the HandlingCode to kEventHandled, Inventor will bypass displaying the standard dialog and use the information provided to create a new in-place component within the assembly. The rest of the command behavior remains the same. That is, if this isn't the first component being placed in the assembly, the end-user must select a location in the assembly to position the new component. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">WithEvents</span><span style="line-height: 140%"> oFileUIE </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">FileUIEvents</span><span style="line-height: 140%"> </span></p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">     <p style="margin: 0px"><span style="line-height: 140%; color: green"></span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: green">'start file UI events</span></p>   </div>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> startFileUIEvent()</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">_InvApplication = _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Runtime.InteropServices.</span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">. _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GetActiveObject(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oFileUIE = _InvApplication.FileUIEvents </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span>&#160;</p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">     <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: green">'end file UI events</span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> endFileUIEvent()</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oFileDlgEvents = </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>      <p style="margin: 0px"><span style="line-height: 140%; color: green">'OnFileInserNewDialog</span></p>   </div>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> oFileUIE_OnFileInsertNewDialog(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> TemplateDir </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> FileTypes() </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal</span><span style="line-height: 140%"> DocumentObject </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">_Document</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal</span><span style="line-height: 140%"> ParentHWND </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Integer</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> TemplateFileName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> FileName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> RelativeFileName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> LibraryName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> CustomLogicalName() </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Byte</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByVal</span><span style="line-height: 140%"> Context </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">NameValueMap</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ByRef</span><span style="line-height: 140%"> HandlingCode </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">HandlingCodeEnum</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Handles</span><span style="line-height: 140%"> oFileUIE.OnFileInsertNewDialog</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">TemplateDir = </span><span style="line-height: 140%; color: #a31515">&quot;C:\Users\Public\Documents\Autodesk\Inventor 2013\Templates\&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #a31515"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">TemplateFileName =&#160; </span><span style="line-height: 140%; color: #a31515">&quot;C:\Users\Public\Documents\Autodesk\Inventor 2013\Templates\standard.ipt&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #a31515"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">FileName = </span><span style="line-height: 140%; color: #a31515">&quot;c:\newpart.ipt&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #a31515"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">HandlingCode = </span><span style="line-height: 140%; color: #2b91af">HandlingCodeEnum</span><span style="line-height: 140%">.kEventHandled </span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;</span></p> </div>  <p>But, when this is done, the dialog box that appears on selecting the &quot;Create Component&quot; command of the UI is by passed and so, the user is not given the following choices:</p>  <p>1) Constrain sketch plane to selected face or plane, which is specified on the check box which is normally displayed on the dialog box that appears on selecting the &quot;Create Component&quot; command of UI can no longer be specified.</p>  <p>2) the choice of selecting a face from existing occurrences that help in defining the xy,xz and yz planes of the new occurrence that is going to be created. A new part is created with the filename specified in the event, but, the x, y and z axis are the assembly's x, y and z axis and the user is not given a choice of where to create the part.</p>  <p>The workarounds are:</p>  <p>way 1. Create your own command which will execute the following code.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> CreateComponent()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' assume inventor application is available </span></p>    <p style="margin: 0px"><span style="line-height: 140%">_InvApplication.CommandManager.PostPrivateEvent(</span><span style="line-height: 140%; color: #2b91af">PrivateEventTypeEnum</span><span style="line-height: 140%">.kFileNameEvent, </span><span style="line-height: 140%; color: #a31515">&quot;c:\newpart.ipt&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oCtrlDef </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ButtonDefinition</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oCtrlDef = _InvApplication.CommandManager.ControlDefinitions.Item(</span><span style="line-height: 140%; color: #a31515">&quot;AssemblyCreateComponentCmd&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oCtrlDef.Execute</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p> </div> way 2. Monitor the UserInputEvents.OnActivateCommand. If the CommandName is &quot;AssemblyCreateComponentCmd&quot;, then execute the following line to feed in the file name  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; _InvApplication.CommandManager.PostPrivateEvent (</span><span style="line-height: 140%; color: #2b91af">PrivateEventTypeEnum</span><span style="line-height: 140%">.kFileNameEvent, </span><span style="line-height: 140%; color: #a31515">&quot;c:\newpart.ipt&quot;</span><span style="line-height: 140%">)</span></p> </div>
