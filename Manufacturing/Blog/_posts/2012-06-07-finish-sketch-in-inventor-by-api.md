---
layout: "post"
title: "Finish Sketch in Inventor by API"
date: "2012-06-07 20:17:30"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/06/finish-sketch-in-inventor-by-api.html "
typepad_basename: "finish-sketch-in-inventor-by-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <div style="font-family: ; background: white; color: ">   <p><b>Issue</b></p>    <p>been reported to My user often clicks my custom command in the sketch context, but my custom command doesn't work in the sketch context, how can I programmatically exit the sketch context to the part environment?</p>    <p><a name="section2"></a></p>    <p><b>Solution</b></p>    <p>Running ‘AppReturnTopCmd’ or ‘AppReturnParentCmd’ command through Inventor API can exit the sketch context. Please refer to below sample code snippet:</p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">' Inventor application object.</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> m_inApp </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> Inventor.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Application</font></span></font></p>      <p style="margin: 0px"><font color="#2b91af" face="Courier New"><span style="line-height: 11pt; color: ">……</span></font></p>   </div>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> m_inApp.UserInterfaceManager.ActiveEnvironment.InternalName =</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;PMxPartSketchEnvironment&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; m_inApp.CommandManager.ControlDefinitions.Item(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;AppReturnTopCmd&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">).</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; Execute() </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">'or AppReturnParentCmd</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p> </div>
