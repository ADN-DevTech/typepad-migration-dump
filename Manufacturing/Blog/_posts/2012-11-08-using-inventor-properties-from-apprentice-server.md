---
layout: "post"
title: "Using Inventor Properties from Apprentice Server"
date: "2012-11-08 12:02:25"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/11/using-inventor-properties-from-apprentice-server.html "
typepad_basename: "using-inventor-properties-from-apprentice-server"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Inventor documents have a set of properties (iProperties) associated with them and are organized into Property Sets, with related properties found in a given set. Each PropertySet is identified by its Display Name and an Internal Name and each of the Properties that it contains is in turn identified by its PropertyID and an optional Name. It is possible to create new PropertySets, which contain user defined properties in addition to the four predefined PropertySets. None of the Inventor created PropertySets can be deleted,but those that are created by third parties can be.</p>  <p>The DisplayNames of all the PropertySets can be changed. In addition to changing the names of the Properties their values can also be changed. In order to access a particular Property within a particular PropertySet (in order to change its Value or Name) one can do so directly instead of having to iterate through all the PropertySets.</p>  <p>The following examples (VB6, VB.NET and c++) show how to access a particular Propertycalled &quot;Cost&quot; within the PropertySet &quot;Design Tracking Properties irectly using the PropertyID.The example also shows how to create new PropertySets/Properties and how to set/change valuesof properties. Using Apprentice Server all additions/changes to the PropertySets collection can be saved using the PropertySets.FlushToFile method instead of having to save the entire document.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> </font><font color="#000000"><span>PropFromApprentice</span></font><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' Start Apprentice</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> newApp </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">ApprenticeServerComponent</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">On</font></span><font color="#000000"> </font><span><font color="#0000ff">Error</font></span><font color="#000000"> </font><span><font color="#0000ff">Resume</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; newApp = CreateObject(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Inventor.ApprenticeServer&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> newApp </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; MsgBox(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;cannot start Apprentice&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">End</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> newDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">ApprenticeServerDocument</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' open the document</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; newDoc = newApp.Open(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;C:\Temp\Part1_08.ipt&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> propsets </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">PropertySets</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; propsets = newDoc.PropertySets</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'Another way to access propertysets and properties</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i = 1 </font><span><font color="#0000ff">To</font></span><font color="#000000"> propsets.Count</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> propsets(i).DisplayName = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Design Tracking Properties&quot;</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> prop </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font></font><span><font style="font-size: 10pt" color="#2b91af">Property</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> j </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> j = 1 </font><span><font color="#0000ff">To</font></span><font color="#000000"> propsets(i).Count</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; prop = propsets(i).Item(j)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> prop.Name = </font><span><font color="#a31515">&quot;Cost&quot;</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; prop.Value = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;250&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' Accessing a particular property </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' of a particular propertyset directly</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; propsets.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Design Tracking Properties&quot;</font></span><font color="#000000">). _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; ItemByPropId( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">PropertiesForDesignTrackingPropertiesEnum</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; kCostDesignTrackingProperties).Value = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;300&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' you could also pass the Internal Name</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' or the index as a parameter to the Item method.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' adding the new propertyset</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">On</font></span><font color="#000000"> </font><span><font color="#0000ff">Error</font></span><font color="#000000"> </font><span><font color="#0000ff">Resume</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> NewPropertySet </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">PropertySet</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; NewPropertySet = propsets.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property Set&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (NewPropertySet </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; MsgBox(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Adding new property set : DevTech Property Set&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; NewPropertySet = propsets.Add(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property Set&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' adding the new property to the property set</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> NewProperty </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font></font><span><font style="font-size: 10pt" color="#2b91af">Property</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; NewProperty = NewPropertySet.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (NewProperty </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 10pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> value </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> id </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; value = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;1&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; id = 15</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; NewPropertySet.Add(value, </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property&quot;</font></span><font color="#000000">, id)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; NewProperty.value = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;2&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' change the name of the new propertyset</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; propsets.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property Set&quot;</font></span><font color="#000000">). _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; DisplayName = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;New Property Set&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' change the value of the new property</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; propsets.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property Set&quot;</font></span><font color="#000000">). _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;DevTech Property&quot;</font></span><font color="#000000">).Value = </font></font><span><font style="font-size: 10pt" color="#a31515">&quot;3&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' FlushToFile (only for Apprentice)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; propsets.FlushToFile()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></font></p> </div>
