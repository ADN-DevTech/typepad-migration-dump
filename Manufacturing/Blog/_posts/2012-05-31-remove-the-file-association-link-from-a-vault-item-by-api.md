---
layout: "post"
title: "Remove the File Association Link from a Vault Item by API"
date: "2012-05-31 21:54:38"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/remove-the-file-association-link-from-a-vault-item-by-api.html "
typepad_basename: "remove-the-file-association-link-from-a-vault-item-by-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong>    <br />Is there a way to remove an associated file from a vault item using the web services API in .net. I have looked through the API and have not been able to figure this out.    <br /><strong>Solution</strong>    <br />If you want to remove the file link to the item, then EditItem (or PromoteFiles or AddItemRevision)&#160; -&gt; UpdateAndCommitItem is the correct way to do that. </p>  <p>The UpdateAndCommitItem function has many arguments. If you want to get the original file association links for the item, you can refer to this post: <a href="http://adndevblog.typepad.com/manufacturing/2012/05/remove-add-or-modify-custom-item-properties-in-vault.html">Remove, Add or Modify Custom Item Properties in Vault</a>. </p>  <p>If you want to remove all file association links from the item, but keep the some properties, then setting those link parameters of the UpdateAndCommitItem to zero or null, and passing the PropInst array in will do that. For example:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">Item</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> editItem = m_serviceManager.ItemService.EditItem(m_selectedItem.RevId);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">PropDef</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">[] props = m_serviceManager.ItemService.GetAllItemPropertyDefinitions();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">System.Collections.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ArrayList</font></span><span style="line-height: 11pt"><font color="#000000"> userProperties = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> System.Collections.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">ArrayList</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">PropDef</font></span><span style="line-height: 11pt"><font color="#000000"> propDef </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">in</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> props)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (propDef.DispName == </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Type&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">continue</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; userProperties.Add(propDef.Id);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">PropInst</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">[] propValues = m_serviceManager.ItemService.GetItemProperties(</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">long</font></span><span style="line-height: 11pt"><font color="#000000">[] { editItem.Id }, (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">long</font></span><span style="line-height: 11pt"><font color="#000000">[])userProperties.ToArray(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">long</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)));</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">m_serviceManager.ItemService.UpdateAndCommitItem(editItem,0,</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span><span style="line-height: 11pt"><font color="#000000">,</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span><span style="line-height: 11pt"><font color="#000000">,</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">, </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,propValues, 7);</font></span></font></p> </div>
