---
layout: "post"
title: "Saving a snapshot of a document&rsquo;s view"
date: "2013-11-20 07:41:23"
author: "Philippe Leefsma"
categories:
  - "Inventor"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/11/saving-a-snapshot-of-a-documents-view.html "
typepad_basename: "saving-a-snapshot-of-a-documents-view"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>Here are three different approaches to save a snapshot picture of a document view.</p>  <p>1 - Simply saving the active view as is. Note that if you specify a top color, you will have to pass also a bottom one:</p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>Sub SaveView1()</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim view As view</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set view = ThisApplication.ActiveView</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim camera As camera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set camera = view.camera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim topClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set topClr = ThisApplication.TransientObjects.CreateColor(255, 0, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim bottomClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set bottomClr = ThisApplication.TransientObjects.CreateColor(0, 255, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Call camera.SaveAsBitmap(&quot;C:\Temp\test.png&quot;, _</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; view.width, view.height, topClr, bottomClr)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>End Sub</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><em><font color="#000000" face="Calibri"></font></em></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal">2 - That second approach is creating an additional view and closing it at the end. You could use that approach if you plan to modify the view in any way to create the snapshot and want to conserve the active view intact for the user:</p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><em><font color="#ffffff" face="Calibri">-</font></em></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>Sub SaveView2()</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim doc As Document</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set doc = ThisApplication.ActiveDocument</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim view As view</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set view = doc.views.Add</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim camera As camera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set camera = view.camera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim topClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set topClr = ThisApplication.TransientObjects.CreateColor(255, 0, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim bottomClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set bottomClr = ThisApplication.TransientObjects.CreateColor(0, 255, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Call camera.SaveAsBitmap(&quot;C:\Temp\test.png&quot;, _</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; view.width, view.height, topClr, bottomClr)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">view.Close</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>End Sub</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#000000" face="Calibri"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal">3 - The third approach is creating a transient camera. It similar to the second way but probably better because you donâ€™t have to create a temporary view: </p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#ffffff" face="Calibri">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>Sub SaveView3()</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim doc As Document</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set doc = ThisApplication.ActiveDocument</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim view As view</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set view = ThisApplication.ActiveView</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim camera As camera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set camera = ThisApplication.TransientObjects.CreateCamera</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">camera.SceneObject = doc.ComponentDefinition</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">camera.ViewOrientationType = kIsoTopLeftViewOrientation</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">camera.Fit</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">camera.ApplyWithoutTransition</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim topClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set topClr = ThisApplication.TransientObjects.CreateColor(255, 0, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Dim bottomClr As color</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Set bottomClr = ThisApplication.TransientObjects.CreateColor(0, 255, 0)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt">Call camera.SaveAsBitmap(&quot;C:\Temp\test.png&quot;, _</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><em><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; view.width, view.height, topClr, bottomClr)</font></em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>&#160;</em></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"><em>End Sub</em></font></font></p>
