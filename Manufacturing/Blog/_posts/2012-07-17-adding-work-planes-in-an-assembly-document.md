---
layout: "post"
title: "Adding work planes in an Assembly document"
date: "2012-07-17 00:49:18"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/07/adding-work-planes-in-an-assembly-document.html "
typepad_basename: "adding-work-planes-in-an-assembly-document"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html" target="_self">Vladimir Ananyev</a></p>  <p><b>Issue</b></p>  <p>I need to create a work plane in the Assembly document. I have tried using AddByPlaneAndOffset and other methods however an error occurs. Is there a way to add a work plane programmatically to the assembly document? </p>  <p><a name="section2"></a><b>Solution</b></p>  <p>The only add method that is supported for work features in the assembly document is the AddFixed (this is true for all work feature types). The resulting work plane will return an AssemblyWorkPlaneDef definition. Work plane position can be changed by assembly constraints. We do not currently support (and there are currently no plans to support) the other methods in assembly.</p>  <p>This VBA example creates a work plane on the same plane as the YZ plane in the second part placed in the assembly.    <br /></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><font face="Lucida Console"><font color="#000000"><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font style="font-size: 10pt">Public Sub </font></span><font style="font-size: 10pt"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;">AddWorkPlaneInAssembly</span></font></font></font><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">()          <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oAsmDoc As AssemblyDocument           <br />&#160;&#160;&#160; Set oAsmDoc = ThisApplication.ActiveDocument           <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oAsmCompDef As AssemblyComponentDefinition           <br />&#160;&#160;&#160; Set oAsmCompDef = oAsmDoc.ComponentDefinition           <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oOcc As ComponentOccurrence           <br />&#160;&#160;&#160; Set oOcc = oAsmCompDef.Occurrences(2)           <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oPartDef As PartComponentDefinition           <br />&#160;&#160;&#160; Set oPartDef = oOcc.Definition           <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oWrkPlane1 As WorkPlane           <br />&#160;&#160;&#160; Set oWrkPlane1 = oPartDef.WorkPlanes(1)           <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oWrkPlane1Proxy As WorkPlaneProxy           <br />&#160;&#160;&#160; Call oOcc.CreateGeometryProxy( _</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWrkPlane1, oWrkPlane1Proxy)          <br />&#160;&#160;&#160; Dim oOriginPnt As Point           <br />&#160;&#160;&#160; Dim oXaxis As UnitVector           <br />&#160;&#160;&#160; Dim oYaxis As UnitVector           <br />&#160;&#160;&#160; Call oWrkPlane1Proxy.GetPosition( _</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oOriginPnt, oXaxis, oYaxis)          <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oWrkPlane As WorkPlane           <br />&#160;&#160;&#160; Set oWrkPlane = oAsmCompDef.WorkPlanes _</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .AddFixed(oOriginPnt, oXaxis, oYaxis)          <br />End Sub</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="mso-bidi-font-size: 11.0pt"><font face="Calibri"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="mso-bidi-font-size: 11.0pt"><font color="#000000" face="Calibri">VB .NET:</font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="mso-bidi-font-size: 11.0pt"><font face="Calibri"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font face="Lucida Console"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font color="#0000ff"><font style="font-size: 10pt">Public</font></font></span><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> AddWorkPlaneInAssembly()</font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oAsmDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AssemblyDocument</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160; = m_inventorApp.ActiveDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oAsmCompDef </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AssemblyComponentDefinition</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 10pt">= oAsmDoc.ComponentDefinition</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oOcc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ComponentOccurrence</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = oAsmCompDef.Occurrences(2)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oPartDef </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartComponentDefinition</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = oOcc.Definition</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oWrkPlane1 </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">WorkPlane</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = oPartDef.WorkPlanes(1)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oWrkPlane1Proxy </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">WorkPlaneProxy</font></span><font color="#000000"> = </font></font><span><font style="font-size: 10pt" color="#0000ff">Nothing</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Call</font></span><font color="#000000"> oOcc.CreateGeometryProxy( _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oWrkPlane1, oWrkPlane1Proxy)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oOriginPnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span><font color="#2b91af">Point</font></span><font color="#000000"> = </font></font><span><font style="font-size: 10pt" color="#0000ff">Nothing</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oXaxis </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">UnitVector</font></span><font color="#000000"> = </font></font><span><font style="font-size: 10pt" color="#0000ff">Nothing</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oYaxis </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">UnitVector</font></span><font color="#000000"> = </font></font><span><font style="font-size: 10pt" color="#0000ff">Nothing</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Call</font></span><font color="#000000"> oWrkPlane1Proxy.GetPosition( _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oOriginPnt, oXaxis, oYaxis)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 10pt">&#160;&#160; </font></font></span><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oWrkPlane </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">WorkPlane</font></span><font color="#000000"> _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; = oAsmCompDef.WorkPlanes.AddFixed _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt"><font color="#000000">(oOriginPnt, oXaxis, oYaxis)</font></font></font></span></font></font></font></span><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font face="Lucida Console"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><font face="Lucida Console"><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><span style="font-family: ; mso-bidi-font-family: &#39;Lucida Console&#39;"><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="mso-bidi-font-size: 11.0pt"><font face="Calibri"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="mso-bidi-font-size: 11.0pt"><font face="Calibri"><font style="font-size: 10pt" color="#000000">&#160;</font></font></span></p>
