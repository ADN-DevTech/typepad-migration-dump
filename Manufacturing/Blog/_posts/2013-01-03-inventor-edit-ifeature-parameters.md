---
layout: "post"
title: "Inventor: Edit iFeature Parameters"
date: "2013-01-03 16:31:24"
author: "Vladimir Ananyev"
categories:
  - "Inventor"
  - "Vladimir Ananyev"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/01/inventor-edit-ifeature-parameters.html "
typepad_basename: "inventor-edit-ifeature-parameters"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>  <p><b>Issue</b></p>  <p>Why does editing more than one parameter of an iFeature errors out ?</p>  <p><a name="section2"></a><b>Solution</b></p>  <p>iFeatureDefinition and all the connected iFeatureInput objects are snapshots and hence are valid for only one transaction. Since modifying a parameter constitutes a transaction, you would have to re-initialize the definition each time in the loop </p>  <p>Here is the VBA sample for iFeature parameters editing in a loop.</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">Sub Edit_iFeature_Paraemters_Sample()</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim oDoc As PartDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Set oDoc = ThisApplication.ActiveDocument</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#00b050">'reference to the first iFeature object</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim oiFeature As iFeature</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Set oiFeature = oDoc.ComponentDefinition _</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">.Features.iFeatures.Item(1)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#00b050">'reference to the definition</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim iDef As iFeatureDefinition</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Set iDef = oiFeature.iFeatureDefinition</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#00b050">'inputs collection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim oInputs As iFeatureInputs</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Set oInputs = iDef.iFeatureInputs</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#00b050">'root name</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim iName As String</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">iName = oiFeature.Name &amp; &quot;:&quot;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160; </font></font></span><span><font style="font-size: 9pt" color="#00b050">'iterate inputs collection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Dim oInput As iFeatureInput</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">For Each oInput In oInputs</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#00b050"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">'Debug.Print oInput.Name</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">If oInput.Type = kiFeatureParameterInputObject Then</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oParInput As iFeatureParameterInput</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oParInput = oInput</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Dim oPar As Parameter</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Set oPar = oParInput.Parameter</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Select Case UCase(oParInput.Name)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Case UCase(iName + &quot;Diameter&quot;)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oPar.Expression = &quot;0.6 in&quot;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Case UCase(iName + &quot;Depth&quot;)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oPar.Expression = &quot;0.6 in&quot;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End Select</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160; </font></span><font style="font-size: 9pt">End If</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Next</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9pt" color="#000000">&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">oDoc.Update</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span><font style="font-size: 9pt">Beep</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Consolas"><font style="font-size: 9pt" color="#000000">End Sub</font></font></span></p>
