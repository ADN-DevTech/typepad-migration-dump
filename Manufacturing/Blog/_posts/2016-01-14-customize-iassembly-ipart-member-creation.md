---
layout: "post"
title: "Customize iAssembly / iPart member creation"
date: "2016-01-14 17:21:57"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "iLogic"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2016/01/customize-iassembly-ipart-member-creation.html "
typepad_basename: "customize-iassembly-ipart-member-creation"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html">Adam Nagy</a></p>
<p>I&#39;ve seen a few posts on the forum about trying to use <strong>iLogic</strong> code inside <strong>iAssembly</strong> and <strong>iPart</strong>&#0160;<strong>factories</strong> to customize the created <strong>member</strong> file to change e.g. some of its <strong>iProperties</strong>.&#0160;</p>
<p>So I thought it could be useful to talk about the internal process of <strong>member</strong> creation.</p>
<p><strong>iAssembly</strong></p>
<p>This is quite straight-forward. In this case when an&#0160;<strong>iAssembly</strong> instance&#39;s row is changed in the containing assembly document then <strong>Inventor</strong> checks if the appropriate <strong>member</strong> file already exists. If it does, there is nothing to do. If it does not, then:<br />1) it copies the <strong>iAssembly</strong> <strong>factory</strong> file and names it according to the <strong>member</strong>&#0160;name<br />2) updates the properties in the <strong>member</strong> file based on the <strong>iAssembly</strong> table row info<br />3) saves and closes the <strong>member</strong> file</p>
<p>So in this case if the <strong>iAssembly</strong> <strong>factory</strong> has a rule that fires on &quot;<strong>Before Save Document</strong>&quot; which modifies the document, then it basically modified the created <strong>member</strong> file - which is what you probably want.</p>
<p><strong>iPart</strong></p>
<p>This is more complicated. When an <strong>iPart</strong>&#0160;instance&#39;s row is changed in the containing assembly document&#0160;then <strong>Inventor</strong> checks if the appropriate <strong>member</strong> file already exists. If it does, there is nothing to do. If it does not, then:<br />1) it creates a <strong>new</strong> part file based on the active part file template and names it according to the <strong>member</strong> name&#0160;<br />2) in the <strong>factory</strong> file it starts a <strong>transaction</strong> which will be aborted later, so that the <strong>factory</strong> file does not get modified in the end<br />3) inside the <strong>transaction</strong> it changes the <strong>iPart</strong> row to the required one<br />4) stores all the info it will need later on for the <strong>member</strong> file: the generated <strong>geometry</strong>, <strong>iProperties</strong>, <strong>Parameters</strong>, etc<br />5) aborts the <strong>transaction</strong> <br />6) copies the previously stored info into the <strong>member</strong> file&#0160;<br />7) saves and closes the <strong>member</strong> file</p>
<p>So in this case if the <strong>iPart</strong>&#0160;<strong>factory</strong> has a rule that fires on &quot;<strong>Before Save Document</strong>&quot; which modifies the document, then it has no effect on the created <strong>member</strong> file because the event is not firing inside the <strong>member</strong> file, but inside the <strong>factory</strong>. Also, inside <strong>member</strong> files most <strong>iLogic&#0160;</strong>functionality, along with lots of other features as well, is disabled so it could not fire an event anyway (you could run a rule explicitly though).</p>
<p>Unfortunately, there are no events specific to <strong>member</strong>&#0160;file generation steps that would fire e.g. before the information from the <strong>factory</strong> file gets saved. <br />We only have the <strong>ModelingEvents</strong>.<strong>OnGenerateMember</strong> (the closest to it in <strong>iLogic</strong>&#0160;is&#0160;&quot;<strong>iPart or iAssembly Change Component</strong>&quot; but that also fires if the member is already available) but that&#0160;fires inside the assembly that contains the <strong>iPart</strong>/<strong>iAssembly</strong> <strong>member</strong> instance, not inside the <strong>member</strong> or the <strong>factory</strong>.</p>
<p>Hooking into other events could achieve some results, but it might not be very robust.<br />E.g. if you have a rule in the <strong>iPart</strong> <strong>factory</strong> that is set to fire on &quot;<strong>Part Geometry Change</strong>&quot; to modify some geometry and in it&#0160;you also synchronously update the document to reflect the changes immediately (using <strong>Document</strong>.<strong>Update2</strong>()), then it can modify the geometry that gets copied into the created <strong>member</strong> file.<br />But e.g. if you try to modify there an <strong>iProperty</strong> (like <strong>Project</strong> &gt;&gt; <strong>Description</strong>) that will be too late. It seems by the time &quot;<strong>Part Geometry Change</strong>&quot; is fired those already got stored. Also, that seems to be the only event firing during <strong>member</strong> creation.<br /><strong>Note</strong>: the workaround in the following article only works when you modify the <strong>iPart</strong> table row explicitly when the <strong>factory</strong>&#0160;file is open. It does not work if the row is changed as a result of a row change on a <strong>member</strong> instance inside an assembly: <a href="http://adndevblog.typepad.com/manufacturing/2015/12/no-iproperty-change-event-fired-for-ipart-row-change.html">http://adndevblog.typepad.com/manufacturing/2015/12/no-iproperty-change-event-fired-for-ipart-row-change.html</a></p>
<p><strong>Bottom line&#0160;</strong></p>
<p>Best thing is to keep <strong>everything</strong> you want to drive inside the <strong>member</strong> files in the <strong>iPart</strong>/<strong>iAssembly</strong> table: the <strong>Parameters</strong>, the <strong>iProperties</strong>, etc.&#0160;<br />So if you want to drive e.g. the <strong>Project</strong> &gt;&gt; <strong>Description</strong> property, add that to the table:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c8079303970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IPartDescription" class="asset  asset-image at-xid-6a0167607c2431970b01b7c8079303970b img-responsive" src="/assets/image_f0c27a.jpg" title="IPartDescription" /></a></p>
<p>Since <strong>iParts</strong>&#0160;and&#0160;<strong>iAssemblies</strong> are driven by an <strong>Excel&#0160;</strong>table, you can also use <strong>Excel</strong> functions to calculate things and&#0160;set up relationships between&#0160;cells:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c8079315970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="IPartExcel" class="asset  asset-image at-xid-6a0167607c2431970b01b7c8079315970b img-responsive" src="/assets/image_b4e5cc.jpg" title="IPartExcel" /></a></p>
<p>&#0160;</p>
