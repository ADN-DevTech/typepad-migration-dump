---
layout: "post"
title: "Get WebServiceManager in a Vault Event handler"
date: "2013-06-11 12:31:11"
author: "Wayne Brill"
categories:
  - "Vault"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/06/get-webservicemanager-in-a-vault-event-handler.html "
typepad_basename: "get-webservicemanager-in-a-vault-event-handler"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>It is not obvious how to get the WebServiceManager in a WebService extension event handler. One of the arguments passed into the event is named “sender” by default. (A Vault event handler will have a sender and event arguments). The sender argument is simple object but it can be cast it to IWebService. You can use IWebService to create WebServiceCredentials and this can be used to create new instance of WebServiceManager. Here is a C# example of an event handler that gets the WebServiceManager: </p>  <p>&#160;</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">void</span> UpdateItemLifecycleStateEvents_Pre_wb</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; (<span style="color: blue">object</span> sender,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">UpdateItemLifeCycleStateCommandEventArgs</span> e)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;&#160;&#160; Autodesk.Connectivity.WebServicesTools.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">WebServiceCredentials</span> CurrentCredentials = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> Autodesk.Connectivity.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; WebServicesTools.<span style="color: #2b91af">WebServiceCredentials</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ((<span style="color: #2b91af">IWebService</span>)sender);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; Autodesk.Connectivity.WebServicesTools.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">WebServiceManager</span> ServiceManager = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> Autodesk.Connectivity.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; WebServicesTools.<span style="color: #2b91af">WebServiceManager</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (CurrentCredentials);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">MessageBox</span>.Show(<span style="color: #a31515">&quot;From Event&quot;</span>);</p>    <p style="margin: 0px">}</p> </div>  <p>&#160;</p>  <p>Note: Some operations may not work correctly when it’s executed from event handler (i.e. modifying of mapped properties when file is already open in Inventor). For such cases the safer approach may be to schedule a job and perform operation later. </p>
