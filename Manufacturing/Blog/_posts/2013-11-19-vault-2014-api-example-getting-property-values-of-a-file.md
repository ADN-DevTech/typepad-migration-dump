---
layout: "post"
title: "Vault 2014 API example getting property values of a file"
date: "2013-11-19 12:55:52"
author: "Wayne Brill"
categories:
  - "Vault"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/11/vault-2014-api-example-getting-property-values-of-a-file.html "
typepad_basename: "vault-2014-api-example-getting-property-values-of-a-file"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>This VB example uses <em>GetPropertyDefinitions()</em> and the <em>GetPropertyValue()</em> of the the<em> PropertyManager</em> to retrieve the value of system and a user defined property (UDP) for a file. It may not be&#160; obvious how to get the <em>PropertyDefinition</em> parameter that you need to pass to <em>GetPropertyValue().</em></p>  <p>To get the <em>PropertyDefinition</em> you can use <em>GetPropertyDefinitions()</em> which returns a <em>PropertyDefinitionDictionary</em> which is a key value pair. The value of the <em>KeyValuePair</em> are property definitions. In this example the display name of the <em>PropertyDefinition</em> is used to find a user defined property to use with <em>GetPropertyValue().</em> </p>  <p>For system properties you can use one of the members of <em>PropertyDefinitionIds.Server</em>. This example is using <em>PropertyDefinitionIds.Server.LifeCycleDefinition and <em>PropertyDefinitionIds.Server.</em>VersionNumber.</em></p>  <p>To try this code you can add a button to the VaultList SDK sample and copy in this code.</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Private</span> <span style="color: blue">Sub</span> Button5_Click(sender <span style="color: blue">As</span> System.<span style="color: #2b91af">Object</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; e <span style="color: blue">As</span> System.<span style="color: #2b91af">EventArgs</span>) <span style="color: blue">Handles</span> Button5.Click</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' For demonstration purposes, </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'the information is hard-coded.</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> results <span style="color: blue">As</span> VDF.Vault.Results.<span style="color: #2b91af">LogInResult</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; VDF.Vault.<span style="color: #2b91af">Library</span>.ConnectionManager.LogIn _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;localhost&quot;</span>, <span style="color: #a31515">&quot;Vault&quot;</span>, <span style="color: #a31515">&quot;Administrator&quot;</span>, <span style="color: #a31515">&quot;&quot;</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; VDF.Vault.Currency.Connections. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">AuthenticationFlags</span>.Standard, <span style="color: blue">Nothing</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: blue">Not</span> results.Success <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> m_conn <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; VDF.Vault.Currency.Connections.<span style="color: #2b91af">Connection</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = results.Connection</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> props <span style="color: blue">As</span> <span style="color: #2b91af">PropertyDefinitionDictionary</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; m_conn.PropertyManager.GetPropertyDefinitions(</p>    <p style="margin: 0px">&#160;&#160; VDF.Vault.Currency.Entities.<span style="color: #2b91af">EntityClassIds</span>.Files,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Nothing</span>, <span style="color: #2b91af">PropertyDefinitionFilter</span>.IncludeAll)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> myKeyValPair <span style="color: blue">As</span> <span style="color: #2b91af">KeyValuePair</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">Of</span> <span style="color: blue">String</span>, <span style="color: #2b91af">PropertyDefinition</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> myUDP_DayOFSave <span style="color: blue">As</span> <span style="color: #2b91af">PropertyDefinition</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> propDef <span style="color: blue">As</span> <span style="color: #2b91af">PropertyDefinition</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> <span style="color: blue">Each</span> myKeyValPair <span style="color: blue">In</span> props</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Property definition from KeyValuePair</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; propDef = myKeyValPair.Value()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Using the display name to identify </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' the PropertyDefinition</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: #2b91af">propDef</span>.DisplayName = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;wb_Day_Of_IDW_Save&quot;</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'It is the PropertyDefinition </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; myUDP_DayOFSave = propDef</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Exit For</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> myLifeCycleDef <span style="color: blue">As</span> <span style="color: #2b91af">PropertyDefinition</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160; props(<span style="color: #2b91af">PropertyDefinitionIds</span>.<span style="color: #2b91af">Server</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; LifeCycleDefinition)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> myVerNumDef <span style="color: blue">As</span> <span style="color: #2b91af">PropertyDefinition</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160; props(<span style="color: #2b91af">PropertyDefinitionIds</span>.<span style="color: #2b91af">Server</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; VersionNumber)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' Get the FileIteration </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> fileIter <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">VDF.Vault.Currency.Entities.<span style="color: #2b91af">FileIteration</span> = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Change this to the name of a file in your vault</span></p>    <p style="margin: 0px">&#160;&#160;&#160; fileIter = _</p>    <p style="margin: 0px">getFileIteration(<span style="color: #a31515">&quot;wB_Assembly_9-23-13.idw&quot;</span>, m_conn)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Name of the life cycle definition</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> strLifeCycleName <span style="color: blue">As</span> <span style="color: blue">String</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_conn.PropertyManager.GetPropertyValue _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (fileIter, myLifeCycleDef, <span style="color: blue">Nothing</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Version number</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> strVersionNumber <span style="color: blue">As</span> <span style="color: blue">String</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_conn.PropertyManager.GetPropertyValue _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (fileIter, myVerNumDef, <span style="color: blue">Nothing</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">'Get the user defined property value</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">If</span> <span style="color: blue">Not</span> myUDP_DayOFSave <span style="color: blue">Is</span> <span style="color: blue">Nothing</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> strPropertyVal <span style="color: blue">As</span> <span style="color: blue">String</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_conn.PropertyManager.GetPropertyValue _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (fileIter, myUDP_DayOFSave, <span style="color: blue">Nothing</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MessageBox</span>.Show(<span style="color: #a31515">&quot;Value of custom prop &quot;</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; myUDP_DayOFSave.DisplayName.ToString() _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp; <span style="color: #a31515">&quot; = &quot;</span> &amp; strPropertyVal)</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>  <p><strong>Here is the code that gets the FileIteration.</strong> </p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Function</span> getFileIteration _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (nameOfFile <span style="color: blue">As</span> <span style="color: blue">String</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; connection <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; VDF.Vault.Currency. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Connections.<span style="color: #2b91af">Connection</span>) _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">As</span> VDF.Vault.Currency. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Entities.<span style="color: #2b91af">FileIteration</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> conditions <span style="color: blue">As</span> ACW.<span style="color: #2b91af">SrchCond</span>()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">ReDim</span> conditions(0)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> lCode <span style="color: blue">As</span> <span style="color: blue">Long</span> = 1</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> Defs <span style="color: blue">As</span> ACW.<span style="color: #2b91af">PropDef</span>() = _</p>    <p style="margin: 0px">&#160; connection.WebServiceManager. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PropertyService. _</p>    <p style="margin: 0px">GetPropertyDefinitionsByEntityClassId(<span style="color: #a31515">&quot;FILE&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> Prop <span style="color: blue">As</span> ACW.<span style="color: #2b91af">PropDef</span> = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> <span style="color: blue">Each</span> def <span style="color: blue">As</span> ACW.<span style="color: #2b91af">PropDef</span> <span style="color: blue">In</span> Defs</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> def.DispName = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;File Name&quot;</span> <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Prop = def</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span> def</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> searchCondition <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">ACW.<span style="color: #2b91af">SrchCond</span> = <span style="color: blue">New</span> ACW.<span style="color: #2b91af">SrchCond</span>()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; searchCondition.PropDefId = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Prop.Id</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; searchCondition.PropTyp = _</p>    <p style="margin: 0px">ACW.<span style="color: #2b91af">PropertySearchType</span>.SingleProperty</p>    <p style="margin: 0px">&#160;&#160;&#160; searchCondition.SrchOper = lCode</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; searchCondition.SrchTxt = nameOfFile</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; conditions(0) = searchCondition</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' search for files</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> FileList <span style="color: blue">As</span> <span style="color: #2b91af">List</span> _</p>    <p style="margin: 0px">(<span style="color: blue">Of</span> Autodesk.Connectivity.WebServices.<span style="color: #2b91af">File</span>) = _</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">New</span> <span style="color: #2b91af">List</span> _</p>    <p style="margin: 0px">(<span style="color: blue">Of</span> Autodesk.Connectivity.WebServices.<span style="color: #2b91af">File</span>) <span style="color: green">'()</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> sBookmark <span style="color: blue">As</span> <span style="color: blue">String</span> = <span style="color: blue">String</span>.Empty</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> Status <span style="color: blue">As</span> ACW.<span style="color: #2b91af">SrchStatus</span> = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">While</span> (Status <span style="color: blue">Is</span> <span style="color: blue">Nothing</span> <span style="color: blue">OrElse</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FileList.Count &lt; Status.TotalHits)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> files <span style="color: blue">As</span> Autodesk.Connectivity. _</p>    <p style="margin: 0px">WebServices.<span style="color: #2b91af">File</span>() = connection.WebServiceManager.</p>    <p style="margin: 0px">DocumentService.FindFilesBySearchConditions _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (conditions, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Nothing</span>, <span style="color: blue">Nothing</span>, <span style="color: blue">True</span>, <span style="color: blue">True</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sBookmark, Status)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> (<span style="color: blue">Not</span> files <span style="color: blue">Is</span> <span style="color: blue">Nothing</span>) <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FileList.AddRange(files)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">While</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> oFileIteration <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; VDF.Vault.Currency.Entities. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">FileIteration</span> = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">For</span> i <span style="color: blue">As</span> <span style="color: blue">Integer</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0 <span style="color: blue">To</span> FileList.Count - 1</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> FileList(i).Name = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; nameOfFile <span style="color: blue">Then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oFileIteration = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">New</span> VDF.Vault.Currency. _</p>    <p style="margin: 0px">Entities.<span style="color: #2b91af">FileIteration</span>(connection, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FileList(i))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">If</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Return</span> oFileIteration</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Function</span></p> </div>
