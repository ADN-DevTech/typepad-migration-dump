---
layout: "post"
title: "Programmatically Rename Assembly with iParts"
date: "2012-06-08 02:35:46"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/06/programmatically-rename-assembly-with-iparts.html "
typepad_basename: "programmatically-rename-assembly-with-iparts"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong></p>  <p>I want to programmatically rename all documents (for instance an assembly containing a part). I can do this successfully (I first open the part, and saves part with its new name, then open the assembly, call ReplaceReference on the part reference and then save the assembly with its new name).    <br />However, if iParts are involved, I run into some issues.     <br />I've a project containing the following hierarchy of documents: </p>  <p>// Top.iam    <br />// A-4.ipt (iPart member)     <br />//&#160;&#160; A.ipt (iPart factory)     <br />// A-6.ipt (iPart member)     <br />//&#160;&#160; A.ipt (iPart factory)     <br />So there are 2 iPart members of the same iPart factory inserted into the assembly.     <br />Now I want to rename the files according to a given naming scheme. In the sample code I use the following name changes:     <br />// Rename &quot;Top.iam&quot; -&gt; &quot;001.iam&quot;     <br />// Rename &quot;A.ipt&quot; -&gt; &quot;002.ipt&quot;     <br />//     <br />// The iPart member names will follow the updated iPart factory name, so that:     <br />// &quot;A-4.ipt&quot; -&gt; &quot;002-4.ipt&quot;     <br />// &quot;A-6.ipt&quot; -&gt; &quot;002-6.ipt&quot; </p>  <p>After the renaming operations, I did the following observations of the renamed files.</p>  <p>&quot;001.iam&quot;: I get exclamation icons for both of the inserted iPart members. There is a red cross appearing in the title bar of Inventor, and if I press it, it opens &quot;Design Doctor&quot;. There i get a message that &quot;Member row deleted in factory&quot;. </p>  <p>&quot;002.ipt&quot; (iPart factory): If I right click the table in the tree view, I get a message &quot;The values in the Active Row of the table do not match the document's current values. Do you wish to update the table before continuing? Part Number : &quot;A-01&quot; != &quot;002&quot;&quot;.</p>  <p><strong>Solution</strong></p>  <p>In this case, iPart member file needs to be re-generated and then be replaced in the assembly file. The exclamation icon will be gone with this way. </p>  <p>Please refer to below C# sample code snippet:</p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// The following code will take an assembly containing 2 iPart members </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// and rename all files. </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Original file references: </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Top.iam </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// A-4.ipt (iPart member) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// A.ipt (iPart factory) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// A-6.ipt (iPart member) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// A.ipt (iPart factory) </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Rename &quot;Top.iam&quot; -&gt; &quot;001.iam&quot; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Rename &quot;A.ipt&quot; -&gt; &quot;002.ipt&quot; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// The iPart member names will follow the updated iPart factory name, so that: </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// &quot;A-4.ipt&quot; -&gt; &quot;002-4.ipt&quot; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// &quot;A-6.ipt&quot; -&gt; &quot;002-6.ipt&quot; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// First modify iPart factory </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> partFactoryName = Path.Combine(sourceDir, </font></span><span style="font-family: ; color: "><font color="#a31515">&quot;A.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Debug.WriteLine(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;Opening iPart factory &quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> + partFactoryName); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Inventor._PartDocument part = (Inventor._PartDocument)Application.Documents.Open(partFactoryName, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">false</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">Inventor.PartComponentDefinition partComponentDefinition = part.ComponentDefinition; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> (!partComponentDefinition.IsiPartFactory) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">throw</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> </font></span><span style="font-family: ; color: "><font color="#0000ff">new</font></span><span style="font-family: ; color: "><font color="#000000"> </font></span><span style="font-family: ; color: "><font color="#2b91af">Exception</font></span><span style="font-family: ; color: "><font color="#000000">(</font></span><span style="font-family: ; color: "><font color="#a31515">&quot;Expected a factory&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">Inventor.iPartFactory factory = partComponentDefinition.iPartFactory; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> (factory.CustomFactory) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">throw</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> </font></span><span style="font-family: ; color: "><font color="#0000ff">new</font></span><span style="font-family: ; color: "><font color="#000000"> </font></span><span style="font-family: ; color: "><font color="#2b91af">Exception</font></span><span style="font-family: ; color: "><font color="#000000">(</font></span><span style="font-family: ; color: "><font color="#a31515">&quot;Custom factories not supporteed&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Modify each member row</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> oldPartNumber = (</font></span><span style="font-family: ; color: "><font color="#0000ff">string</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">)factory.DefaultRow[2].Value;</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> (Inventor.iPartTableRow row </font></span><span style="font-family: ; color: "><font color="#0000ff">in</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> factory.TableRows)</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> newRowPartName = row.PartName.Replace(</font></span><span style="font-family: ; color: "><font color="#a31515">&quot;A-&quot;</font></span><span style="font-family: ; color: "><font color="#000000">, </font></span><span style="font-family: ; color: "><font color="#a31515">&quot;002-&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">);</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//remove the .ipt in the string</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">newRowPartName = newRowPartName.Remove(newRowPartName.Length - 4);</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">row.PartName = newRowPartName; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Save the modified factory to its new name</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> newPartFactoryName = Path.Combine(destinationDir, </font></span><span style="font-family: ; color: "><font color="#a31515">&quot;002.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">);</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Debug.WriteLine(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;Saving part factory with new name: &quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> + newPartFactoryName);</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//update the Part Number property in the iPart factory file to make it </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//synchronous with the Part //Number in the iPart table</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">part.PropertySets[</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;{32853F0F-3444-11d1-9E93-0060B03C1CA6}&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">].get_ItemByPropId(</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">int</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">)Inventor.PropertiesForDesignTrackingPropertiesEnum.</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">kPartNumberDesignTrackingProperties).Value=oldPartNumber;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">part.SaveAs(newPartFactoryName,</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">);</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">part.Close(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">false</font></span><span style="font-family: ; color: "><font color="#000000">); </font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#008000">// already saved, so close with false</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//re-generate the iPart member file </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">part = (Inventor._PartDocument)Application.Documents.Open(newPartFactoryName, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">false</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">factory = part.ComponentDefinition.iPartFactory; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> (Inventor.iPartTableRow row </font></span><span style="font-family: ; color: "><font color="#0000ff">in</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> factory.TableRows) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">factory.CreateMember(row); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">part.Close(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">false</font></span><span style="font-family: ; color: "><font color="#000000">); </font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#008000">// already saved, so close with false </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Now modify the iPart members </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> partMemberFileName1; </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> newPartMemberFileName1; </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> partMemberFileName2; </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> newPartMemberFileName2; </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//A-4 -&gt; 002-4 </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">partMemberFileName1 = Path.Combine(sourcePartMemberDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;A-4.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">newPartMemberFileName1 = Path.Combine(destinationPartMemberDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;002-4.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//A-6 -&gt; 002-6 </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">partMemberFileName2 = Path.Combine(sourcePartMemberDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;A-6.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">newPartMemberFileName2 = Path.Combine(destinationPartMemberDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;002-6.ipt&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Open assembly, update references or replace iPart member occurrance, and save with new name </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">Inventor._AssemblyDocument assembly = (Inventor._AssemblyDocument)Application.Documents.Open(Path.Combine(sourceDir, </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#a31515"><font style="font-size: 8pt">&quot;Top.iam&quot;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000">), </font></span><span style="font-family: ; color: "><font color="#0000ff">false</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> (Inventor.ComponentOccurrence occ </font></span><span style="font-family: ; color: "><font color="#0000ff">in</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> assembly.ComponentDefinition.Occurrences) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> (occ.ReferencedFileDescriptor.FullFileName.Equals(partMemberFileName1, </font></span><span style="font-family: ; color: "><font color="#2b91af">StringComparison</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">.OrdinalIgnoreCase)) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">occ.Replace(newPartMemberFileName1, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">else</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> </font></span><span style="font-family: ; color: "><font color="#0000ff">if</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> (occ.ReferencedFileDescriptor.FullFileName.Equals(partMemberFileName2, </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#2b91af"><font style="font-size: 8pt">StringComparison</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">.OrdinalIgnoreCase)) </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{ </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">occ.Replace(newPartMemberFileName2, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">assembly.Update(); </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// &quot;Top.iam&quot; -&gt; &quot;001.iam&quot; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#000000"> newAssemblyFileName = Path.Combine(destinationDir, </font></span><span style="font-family: ; color: "><font color="#a31515">&quot;001.iam&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Debug.WriteLine(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;Saving assembly with new name: &quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000"> + newAssemblyFileName); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">assembly.SaveAs(newAssemblyFileName, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">assembly.Close(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#0000ff">false</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Open assembly and one of the iPart members to make sure they look correct after renaming </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Application.Documents.Open(Path.Combine(destinationPartMemberDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;002-4.ipt&quot;</font></span><span style="font-family: ; color: "><font color="#000000">), </font></span><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Application.Documents.Open(Path.Combine(destinationDir, </font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;001.iam&quot;</font></span><span style="font-family: ; color: "><font color="#000000">), </font></span><span style="font-family: ; color: "><font color="#0000ff">true</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 8pt">Debug.WriteLine(</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">&quot;completed&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white"><span style="font-family: ; color: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>
