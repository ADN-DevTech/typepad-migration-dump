---
layout: "post"
title: "Parse BrowserNodes for a specified node and perform UserInterface commands"
date: "2012-09-11 01:51:52"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/09/parse-browsernodes-for-a-specified-node-and-perform-userinterface-commands.html "
typepad_basename: "parse-browsernodes-for-a-specified-node-and-perform-userinterface-commands"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><b>Issue</b></p>  <p>How can I select programmatically a node in the browser and perform a command as if it was performed from the UserInterface?</p>  <p><a name="section2"></a></p>  <p><b>Solution      <br /></b>The following DevNote exposes some useful methods to manipulate the Inventor native BrowserPanes for PartDocuments, Assemblies and Drawings.</p>  <p>- The “GetDocumentBrowserPane(oDoc As Document) As BrowserPane” method will return the main BrowserPane object independently of the type of the active document. From this object you are able to access the “TopNode” property and then all the children nodes present in the browser.</p>  <p>- The “GetBrowserNodeByFullPath(FullPath As String) As BrowserNode” method will return the BrowserNode object that corresponds to the fullpath you provide as input. ‘Nothing’ is retuned if the path doesn’t exist.</p>  <p>- The “GetSelectedNodesFullPath” method will print in the VBA immediate window the list of the currently selected nodes in the browser.</p>  <p>- At last, the “TestSelectNode” method shows an example on how to use these previous methods to select a node in the DrawingBrowser and calls the “Get Model Sketches” command to make the assembly sketches visible in the drawing.</p>  <p>Note: the API is able to select only one node at a time, i.e. calling “oNode.DoSelect” on a second will unselect the first one. If you want to perform the same command on several nodes, you will need to execute it several times, one for each node.</p>  <p>Here are the samples. The code can be cut &amp; paste directly in VBA:</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt">'Get the Main BrowserPane for any type of document      <br />Public Function GetDocumentBrowserPane<span style="color: #ff0000">(</span>oDoc As Document<span style="color: #ff0000">)</span> As BrowserPane       <br />      <br />&#160;&#160;&#160; Dim oModelBP As BrowserPane       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; 'Get the Model BrowserPane for Part       <br />&#160;&#160;&#160; If <span style="color: #ff0000">(</span>TypeOf oDoc Is PartDocument<span style="color: #ff0000">)</span> Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oModelBP = oDoc.BrowserPanes.Item<span style="color: #ff0000">(</span><span style="color: #ff00ff">&quot;PmDefault&quot;</span><span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; 'Get the Model BrowserPane for Assembly       <br />&#160;&#160;&#160; If <span style="color: #ff0000">(</span>TypeOf oDoc Is AssemblyDocument<span style="color: #ff0000">)</span> Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oModelBP = oDoc.BrowserPanes.Item<span style="color: #ff0000">(</span><span style="color: #ff00ff">&quot;AmBrowserArrangement&quot;</span><span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; 'Get the Model BrowserPane for Drawing       <br />&#160;&#160;&#160; If <span style="color: #ff0000">(</span>TypeOf oDoc Is DrawingDocument<span style="color: #ff0000">)</span> Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oModelBP = oDoc.BrowserPanes.Item<span style="color: #ff0000">(</span><span style="color: #ff00ff">&quot;DlHierarchy&quot;</span><span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; Set GetDocumentBrowserPane = oModelBP       <br />      <br />End Function       <br />      <br />      <br />Public Function GetBrowserNodeByFullPathRecursive<span style="color: #ff0000">(</span>oBrowserNode As BrowserNode, FullPath As String<span style="color: #ff0000">)</span> As BrowserNode       <br />      <br />&#160;&#160;&#160; If <span style="color: #ff0000">(</span>oBrowserNode.FullPath = FullPath<span style="color: #ff0000">)</span> Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set GetBrowserNodeByFullPathRecursive = oBrowserNode       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Function       <br />&#160;&#160;&#160; End If       <br />      <br />&#160;&#160;&#160; Dim oBrowserNodeIterator As BrowserNode       <br />&#160;&#160;&#160; For Each oBrowserNodeIterator In oBrowserNode.BrowserNodes       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim oResultNode As BrowserNode       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set oResultNode = GetBrowserNodeByFullPathRecursive<span style="color: #ff0000">(</span>oBrowserNodeIterator, FullPath<span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not oResultNode Is Nothing Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set GetBrowserNodeByFullPathRecursive = oResultNode       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit Function       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; Next       <br />&#160;&#160;&#160;&#160; <br />End Function       <br />      <br />      <br />Public Function GetBrowserNodeByFullPath<span style="color: #ff0000">(</span>FullPath As String<span style="color: #ff0000">)</span> As BrowserNode       <br />      <br />&#160;&#160;&#160; Dim oModelBP As BrowserPane       <br />&#160;&#160;&#160; Set oModelBP = GetDocumentBrowserPane<span style="color: #ff0000">(</span>ThisApplication.ActiveDocument<span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; Set GetBrowserNodeByFullPath = GetBrowserNodeByFullPathRecursive<span style="color: #ff0000">(</span>oModelBP.TopNode, FullPath<span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160;&#160; <br />End Function       <br />      <br />      <br />Public Sub GetSelectedNodesFullPathRecursive<span style="color: #ff0000">(</span>oBrowserNode As BrowserNode<span style="color: #ff0000">)</span>       <br />      <br />&#160;&#160;&#160; If <span style="color: #ff0000">(</span>oBrowserNode.Selected = True<span style="color: #ff0000">)</span> Then       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print <span style="color: #ff00ff">&quot; - &quot;</span> + oBrowserNode.FullPath       <br />&#160;&#160;&#160; End If       <br />      <br />&#160;&#160;&#160; Dim oBrowserNodeIterator As BrowserNode       <br />&#160;&#160;&#160; For Each oBrowserNodeIterator In oBrowserNode.BrowserNodes       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call GetSelectedNodesFullPathRecursive<span style="color: #ff0000">(</span>oBrowserNodeIterator<span style="color: #ff0000">)</span>       <br />&#160;&#160;&#160; Next       <br />      <br />End Sub       <br />      <br />      <br />Public Sub GetSelectedNodesFullPath<span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>       <br />      <br />&#160;&#160;&#160; 'Get the Model BrowserPane       <br />&#160;&#160;&#160; Dim oModelBP As BrowserPane       <br />&#160;&#160;&#160; Set oModelBP = GetDocumentBrowserPane<span style="color: #ff0000">(</span>ThisApplication.ActiveDocument<span style="color: #ff0000">)</span>       <br />      <br />&#160;&#160;&#160; Call GetSelectedNodesFullPathRecursive<span style="color: #ff0000">(</span>oModelBP.TopNode<span style="color: #ff0000">)</span>       <br />      <br />End Sub       <br />      <br />      <br />Public Sub TestSelectNode<span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>       <br />      <br />&#160;&#160;&#160; Dim oBrowserNode As BrowserNode       <br />&#160;&#160;&#160; Set oBrowserNode = GetBrowserNodeByFullPath<span style="color: #ff0000">(</span><span style="color: #ff00ff">&quot;Assembly1:Sheet:1:VIEW1:Assembly1.iam:Assembly1.iam&quot;</span><span style="color: #ff0000">)</span>       <br />      <br />&#160;&#160;&#160; 'Ensures Node is expanded, some commands don't work otherwise       <br />&#160;&#160;&#160; oBrowserNode.Expanded = True       <br />&#160;&#160;&#160; oBrowserNode.DoSelect       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; 'Call command that is not available in API       <br />&#160;&#160;&#160; Dim InternalCommandName As String       <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; InternalCommandName = <span style="color: #ff00ff">&quot;DrawingGetModelSketchesCtxCmd&quot;</span>       <br />&#160;&#160;&#160; ThisApplication.CommandManager.ControlDefinitions.Item<span style="color: #ff0000">(</span>InternalCommandName<span style="color: #ff0000">)</span>.Execute       <br />      <br />End Sub</span></p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"></span></p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt">&#160;</span></p> VB.NET Code  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> GetDocumentBrowserPane(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserPane</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oModelBP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserPane</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Get the Model BrowserPane for Part</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">TypeOf</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PartDocument</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oModelBP = oDoc.BrowserPanes.item(</span><span style="line-height: 140%; color: #a31515">&quot;PmDefault&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Get the Model BrowserPane for Assembly</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">TypeOf</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">AssemblyDocument</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oModelBP = oDoc.BrowserPanes.item(</span><span style="line-height: 140%; color: #a31515">&quot;AmBrowserArrangement&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Get the Model BrowserPane for Drawing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">TypeOf</span><span style="line-height: 140%"> oDoc </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingDocument</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oModelBP = oDoc.BrowserPanes.item(</span><span style="line-height: 140%; color: #a31515">&quot;DlHierarchy&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; GetDocumentBrowserPane = oModelBP</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> GetBrowserNodeByFullPathRecursive(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> oBrowserNode </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> FullPath </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (oBrowserNode.FullPath = FullPath) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetBrowserNodeByFullPathRecursive = oBrowserNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Exit Function</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oBrowserNodeIterator </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oResultNode </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> oBrowserNodeIterator </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> oBrowserNode.BrowserNodes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oResultNode = GetBrowserNodeByFullPathRecursive(oBrowserNodeIterator, FullPath)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Not</span><span style="line-height: 140%"> oResultNode </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetBrowserNodeByFullPathRecursive = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oResultNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Exit Function</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> oResultNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> GetBrowserNodeByFullPath(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> FullPath </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Try to get an active instance of Inventor</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.Runtime.InteropServices.</span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.GetActiveObject(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> ex </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Exception</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' If not active, create a new Inventor session</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> inventorAppType </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%"> = System.</span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%">.GetTypeFromProgID(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.</span><span style="line-height: 140%; color: #2b91af">Activator</span><span style="line-height: 140%">.CreateInstance(inventorAppType)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oModelBP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserPane</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oModelBP = GetDocumentBrowserPane(m_inventorApp.ActiveDocument)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; GetBrowserNodeByFullPath = GetBrowserNodeByFullPathRecursive(oModelBP.TopNode, FullPath)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> GetSelectedNodesFullPathRecursive(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> oBrowserNode </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> (oBrowserNode.Selected = </span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Debug</span><span style="line-height: 140%">.Print(</span><span style="line-height: 140%; color: #a31515">&quot; - &quot;</span><span style="line-height: 140%"> + oBrowserNode.FullPath)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oBrowserNodeIterator </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> oBrowserNodeIterator </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> oBrowserNode.BrowserNodes</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetSelectedNodesFullPathRecursive(oBrowserNodeIterator)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> GetSelectedNodesFullPath()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Try to get an active instance of Inventor</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.Runtime.InteropServices.</span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.GetActiveObject(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> ex </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Exception</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' If not active, create a new Inventor session</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> inventorAppType </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%"> = System.</span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%">.GetTypeFromProgID(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.</span><span style="line-height: 140%; color: #2b91af">Activator</span><span style="line-height: 140%">.CreateInstance(inventorAppType)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Get the Model BrowserPane</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oModelBP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserPane</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oModelBP = GetDocumentBrowserPane(m_inventorApp.ActiveDocument)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; GetSelectedNodesFullPathRecursive(oModelBP.TopNode)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> TestSelectNode()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Inventor.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Try to get an active instance of Inventor</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.Runtime.InteropServices.</span><span style="line-height: 140%; color: #2b91af">Marshal</span><span style="line-height: 140%">.GetActiveObject(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> ex </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Exception</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' If not active, create a new Inventor session</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> m_inventorApp </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> inventorAppType </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%"> = System.</span><span style="line-height: 140%; color: #2b91af">Type</span><span style="line-height: 140%">.GetTypeFromProgID(</span><span style="line-height: 140%; color: #a31515">&quot;Inventor.Application&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.</span><span style="line-height: 140%; color: #2b91af">Activator</span><span style="line-height: 140%">.CreateInstance(inventorAppType)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oBrowserNode </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">BrowserNode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oBrowserNode = GetBrowserNodeByFullPath(</span><span style="line-height: 140%; color: #a31515">&quot;Assembly1:Sheet:1:VIEW1:Assembly1.iam:Assembly1.iam&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Ensures Node is expanded, some commands don't work otherwise</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oBrowserNode.Expanded = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oBrowserNode.DoSelect()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'Call command that is not available in API</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> InternalCommandName </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; InternalCommandName = </span><span style="line-height: 140%; color: #a31515">&quot;DrawingGetModelSketchesCtxCmd&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; m_inventorApp.CommandManager.ControlDefinitions.Item(InternalCommandName).Execute()</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>
