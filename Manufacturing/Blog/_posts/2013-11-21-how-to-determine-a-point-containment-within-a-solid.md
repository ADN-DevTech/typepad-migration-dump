---
layout: "post"
title: "How to determine a point containment within a solid?"
date: "2013-11-21 01:14:25"
author: "Philippe Leefsma"
categories:
  - "Inventor"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/11/how-to-determine-a-point-containment-within-a-solid.html "
typepad_basename: "how-to-determine-a-point-containment-within-a-solid"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>This is a question asked recently by an ADN developer: how can you determine if a point is located inside a watertight solid or outside?</p>  <p>There is no API that would directly return the information in Inventor. However here is a simple approach:</p>  <p>- Create a tiny spherical transient solid centered on the point, using specified tolerance as radius</p>  <p>- Check the volume of each solids, let’s call them vol1 and vol2</p>  <p>- Do a Boolean union between both solids, the sphere and the original solid</p>  <p>- Check volume of the union, if its volume is smaller than the sum of the two volumes, the solids intersect: volUnion &lt; vol1 + vol2 –&gt; point is contained by original solid.</p>  <p>Here is the VBA code that implements that solution:</p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>Function PointContainment( _</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">point As point, _</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">body As SurfaceBody, _</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">tol As Double) As Boolean</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">PointContainment = False</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim TxBrep As TransientBRep</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Set TxBrep = ThisApplication.TransientBRep</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim ptBody As SurfaceBody</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Set ptBody = TxBrep.CreateSolidSphere(point, tol)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim vol1 As Double</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">vol1 = ptBody.volume(tol)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim vol2 As Double</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">vol2 = body.volume(tol)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Call TxBrep.DoBoolean(ptBody, body, kBooleanTypeUnion)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim volRes As Double</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">volRes = ptBody.volume(tol)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">If (volRes &lt; vol1 + vol2) Then</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">PointContainment = True</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">End If</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>End Function</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>Sub TestPointContainment()</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim doc As PartDocument</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Set doc = ThisApplication.ActiveDocument</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim point As point</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Set point = ThisApplication.TransientGeometry.CreatePoint(0, 0, 0)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;</em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim body As SurfaceBody</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Set body = ThisApplication.CommandManager.Pick( _</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 12pt">kPartBodyFilter, &quot;Pick a body: &quot;)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Dim res As Boolean</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">res = PointContainment(point, body, 0.0001)</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font color="#000000"><em><span style="mso-spacerun: yes"><font style="font-size: 12pt">&#160;&#160;&#160; </font></span><font style="font-size: 12pt">Debug.Print &quot;Point containment: &quot; &amp; res</font></em></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>&#160;&#160;&#160; </em></font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Times New Roman"><font style="font-size: 12pt" color="#000000"><em>End Sub</em></font></font></span></p>
