---
layout: "post"
title: "Detect In-Place edit session in Inventor"
date: "2013-01-18 09:53:14"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/01/detect-in-place-edit-session-in-inventor.html "
typepad_basename: "detect-in-place-edit-session-in-inventor"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>&quot;In-place&quot; editing refers to placing a part or sub-assembly document in edit mode, not by directly opening the document, but, via an occurrence in an assembly that the part or sub-assembly represents. It is in this case limited to the context of an assembly, i.e. editing a part or sub-assembly occurrence from within the assembly document. </p>  <p>If an assembly document is open and a part document or a component of the part document (e.g. sketch or feature) has been activated for edit, then the active edit object would be the part document or the component (sketch or feature) respectively, but, the active document would still be the assembly through which the part has been activated for edit. If ?In-place?edit is not active with just the assembly document open then the active document and the active edit object would both be the assembly.</p>  <p>Therefore, in order to determine if you are in an &quot;In-Place&quot; edit session you have to compare the ActiveDocument against the ActiveEditObject. If they are the same, then that would mean some component in the assembly has been activated for edit, as in the following code fragment:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Not</font></span><font color="#000000"> _InvApplication.ActiveDocument <font style="font-size: 8pt"><span><font color="#0000ff">Is </font></span></font>_</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><font color="#000000">_InvApplication.ActiveEditObject </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Do something here as a result</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p> </div>  <p>However in the above code there is a caveat. This code in itself is not enough to determine if you are in an In-Place edit session. The code will work if you are in an In-Place edit session, however it will also work if the active document is a Drawing document or a Part document. Hence we need an additional check to see if the current document that we are working with is an Assembly document. The following code fragment demonstrates this:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt" color="#000000"> _InvApplication.ActiveDocumentType = _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAssemblyDocumentObject </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> </font><span><font color="#0000ff">Not</font></span><font color="#000000"> ThisApplication.ActiveDocument </font><span><font color="#0000ff">Is</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _InvApplication.ActiveEditObject </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Do something here as a result&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p> </div>  <p>The above code would be sufficient to suggest if In-place editing is active in versions prior to Inventor R6 but, for later versions which have the ability to create features in assemblies (e.g. we can create (activate) a new sketch in the assembly document) the code would suggest that In-place editing is active when actually an assembly feature is being edited. In order to account for this we could get the ActiveOccurrence and check if indeed an occurrence has been activated for edit. The following code fragment demonstrates this:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt" color="#000000"> _InvApplication.ActiveDocumentType = _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; kAssemblyDocumentObject </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oAssemDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">AssemblyDocument</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; oAssemDoc = _InvApplication.ActiveDocument</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> </font><span><font color="#0000ff">Not</font></span><font color="#000000"> oAssemDoc.ComponentDefinition. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ActiveOccurrence </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; MsgBox(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;In-Place edit session in effect!&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' Do something useful&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p> </div>  <p>As you might have noticed, checking to see if an occurrence has been activated for edit would suggest that In-place editing is active.</p>
