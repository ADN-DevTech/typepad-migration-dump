---
layout: "post"
title: "Edit an Item BOM Row in Vault &ndash; VB example"
date: "2016-07-11 11:50:11"
author: "Wayne Brill"
categories:
  - "Vault"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2016/07/edit-an-item-bom-row-in-vault-vb-example.html "
typepad_basename: "edit-an-item-bom-row-in-vault-vb-example"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p> <p>Here is a VB example that changes the Quantity of a BOM Row. To test this code you can add a button to this SDK sample: </p> <p>C:\Program Files (x86)\Autodesk\Autodesk Vault 2016 SDK\vs12\VB\ItemEditor <br></p> <p>&nbsp;</p> <p>After the code runs you can see the Quantity being changed in Vault Explorer. The ItemBOM and ItemAssoc are retrieved from the Item being edited.&nbsp; </p> <div style="font-size: 10pt; border-top: #000080 1px solid; font-family: consolas, 'Courier New', courier, monospace; border-right: #000080 1px solid; border-bottom: #000080 1px solid; color: #000; border-left: #000080 1px solid"> <div style="overflow: auto; white-space: nowrap; color: #000000; padding-bottom: 2px; padding-top: 2px; padding-left: 5px; padding-right: 5px; max-height: 300px; background-color: #eeeeee"><span style="color: #0000ff">Private</span> <span style="color: #0000ff">Sub</span> Button1_Click_WB(sender <span style="color: #0000ff">As</span> <span style="color: #0000ff">Object</span>, e <span style="color: #0000ff">As</span> <span style="color: #2b91af">EventArgs</span>) <span style="color: #0000ff">Handles</span> Button1.Click<br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> parentItem <span style="color: #0000ff">As</span> <span style="color: #2b91af">Item</span> = m_selectedItem<br>&nbsp;&nbsp;&nbsp; <span style="color: #008000">'Change this to use an Item Number in your vault</span><br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> ChildItem <span style="color: #0000ff">As</span> <span style="color: #2b91af">Item</span> = m_connection.WebServiceManager.ItemService.GetLatestItemByItemNumber(<span style="color: #a31515">"100001"</span>)<br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> newQty <span style="color: #0000ff">As</span> <span style="color: #0000ff">Integer</span> = 2<br>&nbsp;&nbsp;&nbsp; updateBOMQuantity_WB(parentItem, ChildItem, newQty)<br><span style="color: #0000ff">End</span> <span style="color: #0000ff">Sub</span><br><br><span style="color: #0000ff">Private</span> <span style="color: #0000ff">Sub</span> updateBOMQuantity_WB(parentItem <span style="color: #0000ff">As</span> <span style="color: #2b91af">Item</span>, childItem <span style="color: #0000ff">As</span> <span style="color: #2b91af">Item</span>, newQty <span style="color: #0000ff">As</span> <span style="color: #0000ff">Integer</span>)<br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> item2 <span style="color: #0000ff">As</span> <span style="color: #2b91af">Item</span> = <span style="color: #0000ff">Nothing</span><br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Try</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; item2 = m_connection.WebServiceManager.ItemService.EditItems(<span style="color: #0000ff">New</span> <span style="color: #0000ff">Long</span>() {m_selectedItem.RevId})(0)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> options <span style="color: #0000ff">As</span> <span style="color: #2b91af">BOMViewEditOptions</span> = <span style="color: #2b91af">BOMViewEditOptions</span>.Defaults <span style="color: #0000ff">Or</span> <span style="color: #2b91af">BOMViewEditOptions</span>.ReturnOccurrences _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Or</span> <span style="color: #2b91af">BOMViewEditOptions</span>.ReturnExcluded <span style="color: #0000ff">Or</span> <span style="color: #2b91af">BOMViewEditOptions</span>.ReturnUnassignedComponents<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #008000">' Get the ItemBOM from the Item being edited</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> bom <span style="color: #0000ff">As</span> <span style="color: #2b91af">ItemBOM</span> = m_connection.WebServiceManager.ItemService.GetItemBOMByItemIdAndDate _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (item2.Id, <span style="color: #2b91af">DateTime</span>.MinValue, <span style="color: #2b91af">BOMTyp</span>.Latest, options)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #008000">' Get the ItemAssoc from the ItemBOM being edited</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> itemAssoc2 <span style="color: #0000ff">As</span> <span style="color: #2b91af">ItemAssoc</span> =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bom.ItemAssocArray.FirstOrDefault(<span style="color: #0000ff">Function</span>(x) x.CldItemMasterID = childItem.MasterId)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> newBomItemAssocParam2 <span style="color: #0000ff">As</span> <span style="color: #0000ff">New</span> <span style="color: #2b91af">ItemAssocParam</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newBomItemAssocParam2.Id = itemAssoc2.Id<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newBomItemAssocParam2.EditAct = <span style="color: #2b91af">BOMEditAction</span>.Update<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newBomItemAssocParam2.Quant = newQty<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Dim</span> bom2 <span style="color: #0000ff">As</span> <span style="color: #2b91af">ItemBOM</span> = m_connection.WebServiceManager.ItemService.UpdateItemBOMAssociations _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (item2.Id, {newBomItemAssocParam2}, <span style="color: #2b91af">BOMViewEditOptions</span>.ReturnBOMFragmentsOnEdits)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_connection.WebServiceManager.ItemService.UpdateAndCommitItems(<span style="color: #0000ff">New</span> <span style="color: #2b91af">Item</span>() {item2})<br><br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">Catch</span> ex <span style="color: #0000ff">As</span> <span style="color: #2b91af">Exception</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox(ex.Message)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_connection.WebServiceManager.ItemService.UndoEditItems(<span style="color: #0000ff">New</span> <span style="color: #0000ff">Long</span>() {item2.Id})<br>&nbsp;&nbsp;&nbsp; <span style="color: #0000ff">End</span> <span style="color: #0000ff">Try</span><br><span style="color: #0000ff">End</span> <span style="color: #0000ff">Sub</span></div></div>
