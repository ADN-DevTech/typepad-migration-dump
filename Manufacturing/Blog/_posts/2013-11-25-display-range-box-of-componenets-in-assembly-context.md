---
layout: "post"
title: "Display range box of componenets in assembly context"
date: "2013-11-25 06:55:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/11/display-range-box-of-componenets-in-assembly-context.html "
typepad_basename: "display-range-box-of-componenets-in-assembly-context"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The RangeBox is a rectangular box that is guaranteed to enclose this object. If you access the range in the assembly context, you can use ComponentOccurrence.RangeBox without proxy because this has been transformed in the assembly context. The following code assumes there is a top assembly which has some sub assemblies. The sub assemblites are placed with different rotations intentionally. It gets the rangebox of each component and draws a box with transparent appearance. Their locations are in the context of the top assembly. You need to go to the &quot;Appearance Browser&quot; and add the &quot;Clear&quot; appearance to the document before running the code. Of course, you can also use API to add the appearance.</p>  <p style="margin: 7.5pt 0cm"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Sub drawComRange() </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oAssDoc As AssemblyDocument </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oAssDoc = ThisApplication.ActiveDocument </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim localAsset As Asset </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set localAsset = oAssDoc.Assets.Item(&quot;Clear&quot;) </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oCompDef As ComponentDefinition </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oCompDef = oAssDoc.ComponentDefinition </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oTransientBRep As TransientBRep </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oTransientBRep = ThisApplication.TransientBRep </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">On Error Resume Next </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oClientGraphics As ClientGraphics </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><font face="Times New Roman"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font style="font-size: 9pt">Set oClientGraphics = oCompDef.ClientGraphicsCollection.Item(&quot;Sample3DGr</font></span></i><font style="font-size: 9pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;MS Gothic&#39;">​</span></i></font><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font style="font-size: 9pt">aphicsID&quot;) </font></span></i></font></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">If Err.Number = 0 Then </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">On Error GoTo 0 </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">oClientGraphics.Delete </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">ThisApplication.ActiveView.Update </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Err.Clear </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Exit Sub </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">End If </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><font face="Times New Roman"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font style="font-size: 9pt">Set oClientGraphics = oCompDef.ClientGraphicsCollection.Add(&quot;Sample3DGra</font></span></i><font style="font-size: 9pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;MS Gothic&#39;">​</span></i></font><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font style="font-size: 9pt">phicsID&quot;) </font></span></i></font></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oSurfacesNode As GraphicsNode </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oSurfacesNode = oClientGraphics.AddNode(1) </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">oSurfacesNode.Appearance = localAsset </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oOcc As ComponentOccurrence </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">For Each oOcc In oAssDoc.ComponentDefinition.Occurrences </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oRB As Box </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oRB = oOcc.RangeBox </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oBody As SurfaceBody </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oBody = oTransientBRep.CreateSolidBlock(oRB.Copy()) </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">' Create client graphics based on the transient body </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Dim oSurfaceGraphics As SurfaceGraphics </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 72pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Set oSurfaceGraphics = oSurfacesNode.AddSurfaceGraphics(oBody) </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">Next </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">oSurfacesNode.Appearance = localAsset </font></font></span></i></p>  <p style="margin: 7.5pt 0cm 7.5pt 36pt"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">ThisApplication.ActiveView.Update</font></font></span></i></p>  <p style="margin: 7.5pt 0cm"><i style="mso-bidi-font-style: normal"><span style="mso-fareast-font-family: &#39;Microsoft YaHei&#39;"><font face="Times New Roman"><font style="font-size: 9pt">End Sub</font></font></span></i></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><i style="mso-bidi-font-style: normal"><span style="font-family: "><font face="Times New Roman"><font style="font-size: 9pt">&#160;</font></font></span></i></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b019fa206970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_91a6d2.jpg" width="561" height="473" /></a></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal">&#160;</p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal">&#160;</p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b019f4f8d970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_3a1468.jpg" width="322" height="503" /></a></p>  <p style="margin: 0cm 0cm 0pt" class="MsoNormal"><i style="mso-bidi-font-style: normal"><span style="font-family: "></span></i></p>
