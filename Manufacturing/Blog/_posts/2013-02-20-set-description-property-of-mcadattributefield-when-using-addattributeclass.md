---
layout: "post"
title: "Set Description property of McadAttributeField when using AddAttributeClass"
date: "2013-02-20 08:14:54"
author: "Wayne Brill"
categories:
  - "AutoCAD Mechanical"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/02/set-description-property-of-mcadattributefield-when-using-addattributeclass.html "
typepad_basename: "set-description-property-of-mcadattributefield-when-using-addattributeclass"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>If you are using AddAttributeClass() an error: “Generic failure to execute operation with the provided arguments” occurs if the description property is not set for the McadAttributeField objects that are added to the McadAttributeFields collection that is passed into AddAttributeClass(). </p>  <p>The documentation does not state that the Description property has to be set when AddAttributeClass() is called. Here is an excerpt from the AutoCAD Mechanical ActiveX and VBA reference:&#160; </p>  <p><em>IMcadAttributeField::Description Property</em></p>  <p><em>Remarks      <br />This property is a String.       <br />Setting or changing the field description only has an effect when the McadAttributeField is used to define an attribute class. </em></p>  <p>Here is a VB.NET example that avoids the error:</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px">&#160; &lt;CommandMethod(<span style="color: #a31515">&quot;AttTest&quot;</span>)&gt; _</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Public</span> <span style="color: blue">Sub</span> McadAttTest()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> acadApp <span style="color: blue">As</span> <span style="color: #2b91af">AcadApplication</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.AutoCAD.ApplicationServices.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.AcadApplication</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> AcadMApp <span style="color: blue">As</span> AcadmAuto.<span style="color: #2b91af">AcadmApplication</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; AcadMApp = acadApp.GetInterfaceObject _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;AcadmAuto.AcadmApplication.2&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> mcadUtil <span style="color: blue">As</span> <span style="color: #2b91af">McadUtility</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AcadMApp.ActiveDocument.Utility</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> attFields <span style="color: blue">As</span> <span style="color: #2b91af">McadAttributeFields</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mcadUtil.CreateCollection _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">McadCollectionType</span>.mcAttributeFields)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> attField <span style="color: blue">As</span> <span style="color: #2b91af">McadAttributeField</span> =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mcadUtil.CreateAttributeField()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; attField.Name = <span style="color: #a31515">&quot;InnerDiameter&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; attField.FieldType = <span style="color: #2b91af">McadFieldType</span>.mcDouble</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' If this is not set an error occurs </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' when AddAttributeClass() is called</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; attField.Description = <span style="color: #a31515">&quot;Some description&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; attFields.Add(attField)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; AcadMApp.AddAttributeClass _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;myAttributeClass&quot;</span>, attFields)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>
