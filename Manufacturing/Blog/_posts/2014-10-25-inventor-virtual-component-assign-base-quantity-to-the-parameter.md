---
layout: "post"
title: "Inventor Virtual Component: Assign Base Quantity to the Parameter"
date: "2014-10-25 14:10:06"
author: "Vladimir Ananyev"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2014/10/inventor-virtual-component-assign-base-quantity-to-the-parameter.html "
typepad_basename: "inventor-virtual-component-assign-base-quantity-to-the-parameter"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/manufacturing/vladimir-ananyev.html">Vladimir Ananyev</a></p>  <p>Each new virtual component by default has Base Quantity settings as shown below.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079f8c80970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_349e36.jpg" width="403" height="383" /></a></p>  <p>How can I assign the base quantity to some parameter?&#160; BOMQuantity.SetBaseQuantity method could do all this work for us. </p>  <p>Let’s say we have the virtual component “Paint:1” and the user parameter “Paint_Mass”:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079f8c8c970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_c2ef28.jpg" width="614" height="70" /></a></p>  <p>The following code sample illustrates the workflow:</p>  <p><font size="1" face="Consolas">Sub SetQuantity()</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oDoc As AssemblyDocument      <br /></font><font size="1" face="Consolas">&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oDef As AssemblyComponentDefinition      <br /></font><font size="1" face="Consolas">&#160;&#160;&#160; Set oDef = oDoc.ComponentDefinition</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; <font color="#9bbb59">'reference to the user parameter where mass value is stored</font></font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oPar As Inventor.UserParameter</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Set oPar = oDef.Parameters.UserParameters.Item(&quot;Paint_Mass&quot;)</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; <font color="#9bbb59">'get the reference to the virtual component by its name</font></font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oOcc As ComponentOccurrence</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Set oOcc = oDef.Occurrences.ItemByName(&quot;Paint:1&quot;)</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; <font color="#9bbb59">'virtual component definition</font></font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oVirtualDef As VirtualComponentDefinition</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Set oVirtualDef = oOcc.Definition</font></p>  <p><font color="#9bbb59" size="1" face="Consolas">&#160;&#160;&#160; 'Assign the base quantity to the parameter oPar</font></p>  <p><font color="#9bbb59" size="1" face="Consolas">&#160;&#160;&#160; 'Limitation: this works for length, volume, and mass units only.</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Dim oBOMQuantity As BOMQuantity</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Set oBOMQuantity = oVirtualDef.BOMQuantity</font></p>  <p><font size="1" face="Consolas">&#160;&#160;&#160; Call oBOMQuantity.SetBaseQuantity( _&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; </font><font size="1" face="Consolas">BOMQuantityTypeEnum.kParameterBOMQuantity, oPar)</font></p>  <p><font size="1" face="Consolas">End Sub</font></p>  <p>If you check base quantity after this subroutine is completed you will see this:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d08469c4970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_737079.jpg" width="425" height="404" /></a></p>
