---
layout: "post"
title: "Method to get the age and name of an ETO Member file"
date: "2013-09-20 14:14:16"
author: "Wayne Brill"
categories:
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/09/method-to-get-the-date-of-an-eto-member-file.html "
typepad_basename: "method-to-get-the-date-of-an-eto-member-file"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>You may want to get the name and age of a member file used by an Inventor Engineer-To-Order adopted part. Here are a couple of methods that show how this can be done. Notice it uses the default rule memberPathName to get the path to the member file. .NET System.IO methods are used to get the difference between the current time and the last time the member file was written to. </p>  <p><strong>Note:</strong> If you use cacheFileName to create your own naming scheme for member files you would need to update this example to get the get the name of the member file. The cacheFileName gives you the filename. The memberPathName ensures that the file specified by cacheFileName is created. Depending on the scenario, one of these two Rules can be used.</p>  <p><strong>Methods from an ETO Design:</strong></p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Method</span> IPTFileAgeInFullDays( p <span style="color: blue">As </span>Part) <span style="color: blue">As </span>Integer</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> Not p.IsKindOf?( :IvAdoptedPart) <span style="color: blue">Then</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160; Error( <span style="color: #a31515">&quot;Wrong Part&quot;</span>, <span style="color: #a31515">&quot;IvAdoptedPart expected&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> memberPathname <span style="color: blue">As </span>String = p.memberPathname</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span>&#160; memberCacheFileName <span style="color: blue">As </span>String = p.cacheFileName</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; printValue(memberCacheFileName)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; printValue(memberPathName)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span> FileAgeInFullDays( memberPathname)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End Method</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">'This Method returns the age of the existing file </span></p>    <p style="margin: 0px"><span style="color: green">'(based on last modification time), In full days :</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">Method</span> FileAgeInFullDays( fileName <span style="color: blue">As </span>String) <span style="color: blue">As </span>Integer</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">If</span> Not system.IO.File.Exists(fileName) _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Then</span> Error(<span style="color: #a31515">&quot;Error&quot;</span>, <span style="color: #a31515">&quot;File &quot;</span>&#160; + fileName + _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot; does not exist.&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> lwt = system.IO.File.GetLastWriteTime( fileName)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> now = system.Datetime.Now</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> span = now.Subtract( lwt)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Return</span> floor(span.TotalDays)</p>    <p style="margin: 0px"><span style="color: blue">End Method</span></p>    <p style="margin: 0px"></p> </div>
