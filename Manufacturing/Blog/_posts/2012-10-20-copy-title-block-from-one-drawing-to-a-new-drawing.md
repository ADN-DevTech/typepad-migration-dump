---
layout: "post"
title: "Copy title block from one drawing to a new drawing"
date: "2012-10-20 07:09:34"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/10/copy-title-block-from-one-drawing-to-a-new-drawing.html "
typepad_basename: "copy-title-block-from-one-drawing-to-a-new-drawing"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Issue</strong></p>  <p>I am about to attempt a title block swap from within inventor's API to copy and paste a good title block into an old idw. Is there any API?</p>  <p><strong>Solution     <br /></strong>The code below copies a title block from one drawing to a new drawing.Assume you have a template file (source drawing), which contains a titleblock named &quot;ANSI A&quot;, and another drawing that the titleblock will be copied into (let's say &quot;drawing1.idw&quot;), run the following VBA code, then you will see that the titleblock from the source drawing is copied into &quot;drawing1.idw&quot; and the tibleblocks in all Sheets are replaced with the one newly copied in. If the titleblock named as &quot;ANSI A&quot; in the &quot;drawing1.idw&quot; has existed before the copying, then the new titleblock copied into will be renamed as &quot;Copy of ANSI A&quot; to avoid the name conflict. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> TitleBlockCopy() </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' assume Inventor application is available</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oSourceDocument </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingDocument</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oSourceDocument = ThisApplication.ActiveDocument </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' Open the new drawing to copy the title block into. </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oNewDocument </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DrawingDocument</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oNewDocument = ThisApplication.Documents.Open(</span><span style="line-height: 140%; color: #a31515">&quot;e:\case\drawing1.idw&quot;</span><span style="line-height: 140%">) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' Get the new source title block definition. </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oSourceTitleBlockDef </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">TitleBlockDefinition</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oSourceTitleBlockDef = oSourceDocument.TitleBlockDefinitions.Item(</span><span style="line-height: 140%; color: #a31515">&quot;ANSI A&quot;</span><span style="line-height: 140%">) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' Get the new title block definition. </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oNewTitleBlockDef </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">TitleBlockDefinition</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oNewTitleBlockDef = oSourceTitleBlockDef.CopyTo(oNewDocument) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">' Iterate through the sheets, replace tibleblock with the one newly added. </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oSheet </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Sheet</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> oSheet </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> oNewDocument.Sheets </span></p>    <p style="margin: 0px"><span style="line-height: 140%">oSheet.Activate </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">oSheet.TitleBlock.Delete </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Call</span><span style="line-height: 140%"> oSheet.AddTitleBlock(oNewTitleBlockDef) </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">Next</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>
