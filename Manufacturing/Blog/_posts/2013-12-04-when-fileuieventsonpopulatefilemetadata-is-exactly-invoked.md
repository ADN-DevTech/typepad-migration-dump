---
layout: "post"
title: "When FileUIEvents::OnPopulateFileMetadata is exactly invoked ?"
date: "2013-12-04 03:26:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/12/when-fileuieventsonpopulatefilemetadata-is-exactly-invoked.html "
typepad_basename: "when-fileuieventsonpopulatefilemetadata-is-exactly-invoked"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>This event is invoked when internal workflow of Inventor sets the filename and properties. Currently, the support workflow contains frame generator, create substitute, shrink wrap, add assembly / part in assembly, copy component, mirror component etc.</p>  <p>The usage is very straightforward: delegate the event and suggest your custom name in the event, and tell Inventor this event is handled. The following is a small VBA code demo.</p>  <p><strong>Event Class</strong>:</p>  <p><em><font size="1">Private WithEvents fileUIEvts As FileUIEvents</font></em></p>  <p><em><font size="1">Private Sub Class_Initialize()       <br />&#160;&#160;&#160; Set fileUIEvts = ThisApplication.FileUIEvents        <br />End Sub</font></em></p>  <p><em><font size="1">Private Sub Class_Terminate()       <br />&#160;&#160;&#160; Set fileUIEvts = Nothing        <br />End Sub</font></em></p>  <p><em><font size="1">Private Sub fileUIEvts_OnPopulateFileMetadata(ByVal FileMetadataObjects As ObjectsEnumerator, ByVal Formulae As String, ByVal Context As NameValueMap, HandlingCode As HandlingCodeEnum)       <br />&#160;&#160;&#160; Dim oMetaData As FileMetadata        <br />&#160;&#160;&#160; If FileMetadataObjects.Count &gt; 0 Then        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; For Each oMetaData In FileMetadataObjects        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'suggest custom name        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oMetaData.FileName = &quot;asdk_&quot; &amp; oMetaData.FileName        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oMetaData.FileNameOverridden = True        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next oMetaData        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'tell Inventor the event is handled        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; HandlingCode = kEventHandled        <br />&#160;&#160;&#160; End If        <br />End Sub</font></em></p>  <p><font size="1"><font size="2"><strong>Module: </strong></font></font></p>  <p><em><font size="1">Private cls As clsFileE</font></em></p>  <p><em><font size="1">Sub startcmd()       <br />&#160;&#160;&#160; Set cls = New clsFileE        <br />End Sub</font></em></p>  <p><em><font size="1">Sub Endcmd()       <br />&#160;&#160;&#160; Set cls = Nothing        <br />End Sub        <br /></font></em></p>  <p><font size="1"><font size="2">       <br />The figure below is a demo when the event suggests a custom name for &quot;mirror component‚Äù command.</font></font></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0219660f970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_a34e94.jpg" width="446" height="175" /></a></p>
