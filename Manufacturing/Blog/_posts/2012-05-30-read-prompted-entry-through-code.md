---
layout: "post"
title: "Read Prompted Entry through code"
date: "2012-05-30 03:43:19"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/read-prompted-entry-through-code.html "
typepad_basename: "read-prompted-entry-through-code"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p><strong>Issue</strong></p>  <p>I need to get the property fields which can be seen in &quot;Edit property text&quot; under active Title block. I am able to get other property fields related to drawing through property set, but I don’t how to get the custom property set (Prompted Entry) for Title block.</p>  <p><strong>Solution</strong></p>  <p>The following is a VBA sample code that reads the prompted entry in the title block in the active sheet:</p>  <p>'Before running this code, add reference to Microsoft XML 6.0 in this VBA project</p>  <p>Sub readPromptedEntryInTitleBlock()    <br />&#160;&#160;&#160; Dim drawing As DrawingDocument     <br />&#160;&#160;&#160; Set drawing = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160; Dim tb As TitleBlock     <br />&#160;&#160;&#160; Set tb = drawing.ActiveSheet.TitleBlock     <br />&#160;&#160;&#160; Dim textB As TextBox     <br />&#160;&#160;&#160; For Each textB In tb.Definition.Sketch.TextBoxes     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim xml As DOMDocument     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set xml = New DOMDocument     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call xml.loadXML(textB.FormattedText)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; ' Look for prompted entry     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim node As IXMLDOMNode     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set node = xml.selectSingleNode(&quot;Prompt&quot;)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; If Not node Is Nothing Then     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Debug.Print node.Text + &quot;:&quot; + tb.GetResultText(textB)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; End If     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set xml = Nothing     <br />&#160;&#160;&#160; Next     <br />End Sub     <br />&#160; <br />Actually there is no need to look for the properties from property set, because it’s straight forward to get all texts in the title block through calling TitleBlock.GetResultText() function.</p>  <p>There are some discussion threads talking about the similar issue, for example:    <br /><a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Reading-quot-Prompted-Entry-quot-Title-Block-info-with-VBA/td-p/758297">http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/Reading-quot-Prompted-Entry-quot-Title-Block-info-with-VBA/td-p/758297</a></p>
