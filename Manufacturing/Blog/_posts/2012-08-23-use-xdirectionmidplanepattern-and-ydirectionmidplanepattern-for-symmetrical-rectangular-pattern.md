---
layout: "post"
title: "Use XDirectionMidPlanePattern and YDirectionMidPlanePattern for symmetrical Rectangular pattern"
date: "2012-08-23 18:56:57"
author: "Wayne Brill"
categories: []
original_url: "https://adndevblog.typepad.com/manufacturing/2012/08/use-xdirectionmidplanepattern-and-ydirectionmidplanepattern-for-symmetrical-rectangular-pattern.html "
typepad_basename: "use-xdirectionmidplanepattern-and-ydirectionmidplanepattern-for-symmetrical-rectangular-pattern"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p><b>Issue</b></p>  <p>I am trying to use the API to create a Rectangular Pattern that is symmetrical around the feature being used for the pattern. I am not finding a way to use the parameters of the RectangularPatternFeatures.Add method to achieve the same results that I get using the MidPlane option in the UI. Is there a way to achieve this using the API?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>The API does not provide the MidPlane option on forward create. But you can edit the feature to get the desired result. Here are a VBA and VB.NET examples that shows how this can be done. Before running have an extrusion with a hole that can be used for the pattern. (have the hole near the middle of the face)</p>  <p>VBA</p>  <p>Sub PatternRectTest()</p>  <p>&#160;&#160;&#160; Dim oDoc As PartDocument    <br />&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oCompDef As PartComponentDefinition     <br />&#160;&#160;&#160; Set oCompDef = oDoc.ComponentDefinition     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim objColFeatures As ObjectCollection     <br />&#160;&#160;&#160; Set objColFeatures = ThisApplication. _     <br />&#160;&#160;&#160; TransientObjects.CreateObjectCollection     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Call objColFeatures.Add _     <br />&#160;&#160;&#160; (oCompDef.Features.HoleFeatures.Item(1))     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; Dim oRectFeature As RectangularPatternFeature     <br />&#160;&#160;&#160; Set oRectFeature = oCompDef.Features. _     <br />&#160;&#160;&#160; RectangularPatternFeatures.Add(objColFeatures, _     <br />&#160;&#160;&#160; oCompDef.WorkAxes.Item _     <br />&#160;&#160;&#160; (&quot;X Axis&quot;), False, 3, &quot;1 in&quot;, , , _     <br />&#160;&#160;&#160; oCompDef.WorkAxes.Item _     <br />&#160;&#160;&#160; (&quot;Y Axis&quot;), True, 3, &quot;1 in&quot;, , , kOptimizedCompute)     <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; oRectFeature.XDirectionMidPlanePattern = True     <br />&#160;&#160;&#160; oRectFeature.YDirectionMidPlanePattern = True     <br />&#160;&#160;&#160; <br />End Sub</p>  <p>VB.NET</p>  <div style="font-family: consolas; background: #eeeeee; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Class</span> <span style="color: #2b91af">Form1</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> m_inventorApp <span style="color: blue">As</span> Inventor.<span style="color: #2b91af">Application</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = <span style="color: blue">Nothing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Private</span> <span style="color: blue">Sub</span> Button1_Click(<span style="color: blue">ByVal</span> sender <span style="color: blue">As</span>&#160; _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.<span style="color: #2b91af">Object</span>, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">ByVal</span> e <span style="color: blue">As</span> System.<span style="color: #2b91af">EventArgs</span>) _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Handles</span> Button1.Click</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">' Get an active instance of Inventor</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Try</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp = System.Runtime. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InteropServices.<span style="color: #2b91af">Marshal</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160; GetActiveObject(<span style="color: #a31515">&quot;Inventor.Application&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Catch</span> <span style="color: green">'Inventor not started</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.<span style="color: #2b91af">MessageBox</span>. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Show(<span style="color: #a31515">&quot;Start an Inventor session&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Exit Sub</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Try</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">'Call the Sub</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; test()</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Sub</span> test()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oDoc <span style="color: blue">As</span> <span style="color: #2b91af">PartDocument</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApp.ActiveDocument</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oCompDef <span style="color: blue">As</span> <span style="color: #2b91af">PartComponentDefinition</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.ComponentDefinition</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> objColFeatures <span style="color: blue">As</span> <span style="color: #2b91af">ObjectCollection</span> = _</p>    <p style="margin: 0px">m_inventorApp.TransientObjects.CreateObjectCollection</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Call</span> objColFeatures.Add _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (oCompDef.Features.HoleFeatures.Item(1))</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> oRectFeature <span style="color: blue">As</span> <span style="color: #2b91af">RectangularPatternFeature</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRectFeature = oCompDef.Features. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; RectangularPatternFeatures.Add(objColFeatures, _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCompDef.WorkAxes.Item _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;X Axis&quot;</span>), <span style="color: blue">False</span>, 3, <span style="color: #a31515">&quot;1 in&quot;</span>, , , _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCompDef.WorkAxes.Item(<span style="color: #a31515">&quot;Y Axis&quot;</span>), _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">True</span>, 3, <span style="color: #a31515">&quot;1 in&quot;</span>, , , _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PatternComputeTypeEnum</span>.kOptimizedCompute)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRectFeature.XDirectionMidPlanePattern = <span style="color: blue">True</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRectFeature.YDirectionMidPlanePattern = <span style="color: blue">True</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">End</span> <span style="color: blue">Sub</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Class</span></p> </div>
