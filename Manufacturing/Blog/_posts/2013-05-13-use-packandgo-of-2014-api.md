---
layout: "post"
title: "Use PackAndGo of 2014 API"
date: "2013-05-13 01:44:42"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/05/use-packandgo-of-2014-api.html "
typepad_basename: "use-packandgo-of-2014-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>2014 API provides the equivalent method PackAndGo like UI. This allows you to pack. The API help reference provides the demo code, but it is not much clear. </p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019102142c3b970c-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_062ac1.jpg" width="302" height="432" /></a> </p>  <p>The ability of PackAndGo is provided by the interop:   <br />&#160;&#160;&#160; &lt;Inventor 2014&gt;\Bin\<strong>Autodesk.PackAndGo.Interop.dll</strong></p>  <p>&#160;<a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eeb1b8f38970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_dfa0b3.jpg" width="272" height="367" /></a> </p>  <p>This interop is 32bits on 32bits OS, 64bits on 64bits. So please make sure your application is correctly configured. When I used it the first time on my 64bits, it failed. It took me some time to figure out the failure is due to the application uses X86 configuration in default. After I changed to Any CPU, it works. </p>  <p>The code below is from the API help reference. I added some tips for reference:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> Button1_Click(sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">Object</span><span style="line-height: 140%">, e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">EventArgs</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> Button1.Click</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPacknGoComp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> PackAndGoLib.</span><span style="line-height: 140%; color: #2b91af">PackAndGoComponent</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'ensure the first argument of CreatePackAndGo is correct assembly, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'and the path of the second argument exists</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' otherwise, the method will crash</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> oPacknGo </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> PackAndGoLib.</span><span style="line-height: 140%; color: #2b91af">PackAndGo</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo = oPacknGoComp.CreatePackAndGo(</span><span style="line-height: 140%; color: #a31515">&quot;C:\temp\source\MyNewPartName.iam&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;C:\Temp\Destination&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' set the correct project file.&#160; otherwise, the method will crash</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.ProjectFile = </span><span style="line-height: 140%; color: #a31515">&quot;C:\temp\source\webcast.ipj&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> sRefFiles = </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">() {}</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> sMissFiles = </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Object</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'&#160; Set the options</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.SkipLibraries = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.SkipStyles = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.SkipTemplates = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.CollectWorkgroups = </span><span style="line-height: 140%; color: blue">False</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.KeepFolderHierarchy = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.IncludeLinkedFiles = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'&#160; Get the referenced files</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.SearchForReferencedFiles(sRefFiles, sMissFiles)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">'&#160; Add the referenced files for package</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.AddFilesToPackage(sRefFiles)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Start the pack and go to create the package</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPacknGo.CreatePackage()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p> </div>
