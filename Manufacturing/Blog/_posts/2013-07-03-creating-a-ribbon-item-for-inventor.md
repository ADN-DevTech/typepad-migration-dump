---
layout: "post"
title: "Creating a Ribbon item for Inventor"
date: "2013-07-03 13:58:19"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/07/creating-a-ribbon-item-for-inventor.html "
typepad_basename: "creating-a-ribbon-item-for-inventor"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Here is a quick sample on how create a new Ribbon Tab, Panel and Button with Icon on Inventor. Although there are some samples on the blog, this just summarizes the whole process.</p>  <p>The Icon used on the Ribbon button can be placed inside the project, in this case is even better when it’s embedded on the project, that way your plugin just need to be delivered with the DLL file (no additional .ico files). To do so, put the .ico on the project folder, include on the project, then go to the file properties and select ‘Build Action’. The method <strong>GetICOResource</strong> receive the resource name, usually the <em>ProjectName.FileName.ico</em> (see sample call for this method)</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e1c1dbc970b-pi"><img title="embedded_resource_icon" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="embedded_resource_icon" src="/assets/image_f399cb.jpg" width="318" height="194" /></a></p>  <p>Now it’s time to create the code. The following sample show it for a single button, just place it inside the Activate method for a quick test.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> Activate( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> addInSiteObject </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">ApplicationAddInSite</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> firstTime </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Boolean</font></span><font color="#000000">) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Implements</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">ApplicationAddInServer</font></span><font color="#000000">.Activate</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' Inventor application</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; m_inventorApplication = addInSiteObject.Application</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' get the command manager control definition</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> conDefs </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">ControlDefinitions</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; m_inventorApplication. _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; CommandManager.ControlDefinitions</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' our custom command ID</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> idCommand1 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">String</font></span><font color="#000000"> = </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;ID_COMAND_1&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' try get the existing command definition</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; _defComando1 = conDefs.Item(idCommand1)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Catch</font></span><font color="#000000"> ex </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Exception</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' or create it</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; _defComando1 = conDefs.AddButtonDefinition( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Command 1&quot;</font></span><font color="#000000">, idCommand1, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandTypesEnum</font></span><font color="#000000">.kEditMaskCmdType, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Guid</font></span><font color="#000000">.NewGuid().ToString(), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Command 1 description&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Command 1 Tooltip&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetICOResource(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;ProjetName.StdIcon.ico&quot;</font></span><font color="#000000">), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetICOResource(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;ProjetName.Large.ico&quot;</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">If</font></span><font color="#000000"> (firstTime) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">If</font></span><font color="#000000"> (m_inventorApplication.UserInterfaceManager.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; InterfaceStyle =</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InterfaceStyleEnum</font></span><font color="#000000">.kRibbonInterface) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' 1. access the Zero Doc ribbon</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> ribbonPart </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">Ribbon</font></span><font color="#000000"> =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UserInterfaceManager.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Ribbons.Item(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;ZeroDoc&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' 2. create our custom tab</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> tabSampleBlog </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">RibbonTab</font></span><font color="#000000"> =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ribbonPart.RibbonTabs.Add( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Sample Blog&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;TAB_SAMPLE_BLOG&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Guid</font></span><font color="#000000">.NewGuid().ToString())</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' 3. criar um painel</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> pnlMyCommands </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font><span style="color: "><font color="#2b91af">RibbonPanel</font></span><font color="#000000"> =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; tabSampleBlog. _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RibbonPanels.Add(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;My Command&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;PNL_MY_COMMANDS&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Guid</font></span><font color="#000000">.NewGuid().ToString())</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' 4. colocar o botão no painel</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; pnlMyCommands.CommandControls.AddButton(_defComando1, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' register the method that will be executed</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">AddHandler</font></span><font color="#000000"> _defComando1.OnExecute, </font><span style="color: "><font color="#0000ff">AddressOf</font></span><font color="#000000"> Command1Method</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000"></font></font></p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><span style="color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">' must be declared at the class level</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> _defComando1 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> Inventor.</font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">ButtonDefinition</font></span></font></p>   </div>    <p style="margin: 0px"><font color="#000000" face="Courier New"></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="background-color: #ffff00"><span><font color="#0000ff"><font style="font-size: 8pt"></font></font></span></font></font><font style="style" face="Courier New"><font style="style"><span><font style="style" color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font style="style" color="#000000"> </font><span style="color: "><font style="style" color="#0000ff">Sub</font></span><font style="style" color="#000000"> Command1Method()</font></font></font></font></p>    <p style="margin: 0px"><font style="style" face="Courier New"><font style="style"><font style="style" color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' ToDo: do your code here</font></span></font></font></p>    <p style="margin: 0px"><font style="style"></font></p>    <p style="margin: 0px"><font style="style" face="Courier New"><font style="style"><span style="color: "><font style="style" color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font style="style" color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></font><font face="Courier New"><font style="background-color: #ffff00"><span><font style="font-size: 8pt" color="#0000ff"></font></span></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> GetICOResource( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> icoResourceName </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">String</font></span><font color="#000000">) </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Object</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> assemblyNet </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Reflection.</font><span style="color: "><font color="#2b91af">Assembly</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; System.Reflection.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Assembly</font></span><font color="#000000">.GetExecutingAssembly()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> stream </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">Stream</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; assemblyNet.GetManifestResourceStream(icoResourceName)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> ico </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000">(stream)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Return</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PictureDispConverter</font></span><font color="#000000">.ToIPictureDisp(ico)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>  <p>The PictureDispConverter converter is based on this <a href="http://adndevblog.typepad.com/manufacturing/2013/02/design-patterns-applied-to-the-inventor-api.html" target="_blank">AU class by Philippe Leefsma</a>. Below is the piece required here converted to VB.NET</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">NotInheritable</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">PictureDispConverter</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; &lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;OleAut32.dll&quot;</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; EntryPoint:=</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;OleCreatePictureIndirect&quot;</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ExactSpelling:=</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">, PreserveSig:=</font><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> OleCreatePictureIndirect( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.AsAny)&gt; picdesc </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Object</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ByRef</font></span><font color="#000000"> iid </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Guid</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.Bool)&gt; fOwn </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Boolean</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ) </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IPictureDisp</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Shared</font></span><font color="#000000"> iPictureDispGuid </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Guid</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">GetType</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IPictureDisp</font></span><font color="#000000">).GUID</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">NotInheritable</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">PICTDESC</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'Picture Types</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_UNINITIALIZED </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = -1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_NONE </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = 0</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_BITMAP </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_METAFILE </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = 2</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_ICON </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = 3</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Const</font></span><font color="#000000"> PICTYPE_ENHMETAFILE </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Short</font></span><font color="#000000"> = 4</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">StructLayout</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">LayoutKind</font></span><font color="#000000">.Sequential)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Icon</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> cbSizeOfStruct </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.SizeOf( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> picType </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.PICTYPE_ICON</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> hicon </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> unused1 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> unused2 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000">(icon__1 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Me</font></span><font color="#000000">.hicon = icon__1.ToBitmap().GetHicon()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">StructLayout</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">LayoutKind</font></span><font color="#000000">.Sequential)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Bitmap</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> cbSizeOfStruct </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.SizeOf( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Bitmap</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> picType </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.PICTYPE_BITMAP</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> hbitmap </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> hpal </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> unused </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Integer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Friend</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000">(bitmap__1 </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Bitmap</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Me</font></span><font color="#000000">.hbitmap = bitmap__1.GetHbitmap()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> ToIPictureDisp( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; icon </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IPictureDisp</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> pictIcon </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Icon</font></span><font color="#000000">(icon)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Return</font></span><font color="#000000"> OleCreatePictureIndirect(pictIcon, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iPictureDispGuid, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> ToIPictureDisp( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bmp </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> System.Drawing.</font><span style="color: "><font color="#2b91af">Bitmap</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IPictureDisp</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> pictBmp </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PICTDESC</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Bitmap</font></span><font color="#000000">(bmp)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Return</font></span><font color="#000000"> OleCreatePictureIndirect(pictBmp, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iPictureDispGuid, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p> </div>
