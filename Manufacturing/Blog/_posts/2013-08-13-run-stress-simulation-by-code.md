---
layout: "post"
title: "Run Stress Simulation by code"
date: "2013-08-13 03:42:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/08/run-stress-simulation-by-code.html "
typepad_basename: "run-stress-simulation-by-code"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>Currently, API has not exposed the ability to work with Stress Simulation. The only way which may be of a bit help is to execute the corresponding commands by ControlDefinition.Execute. e.g. in this case, the command is “”</p>  <p>“FeaSimulateCmd”.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104b8fcb0970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_6d8eda.jpg" width="293" height="144" /></a></p>  <p>But this can only pop out the dialog, instead of running it automatically. A workaround is to take advantage of VB: SendKeys since the default focused button in this dialog is [Run]. That is to say, we send key [Enter] to the dialog thus it can be executed automatically. I have to confess, however SendKeys is not always working in all cases. But in this case, it is quite simple. It works well at my side.</p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac8262f1970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_cb7340.jpg" width="334" height="168" /></a></p>  <p>&#160;</p>  <p>In addition, you need to make sure to activate the enviorment of Sress Simulation before running simulation. The following is a code demo.</p>  <p>&#160;</p>  <p>Public Sub DoFea()</p>  <p>&#160;&#160;&#160;&#160; Dim oDoc As Document</p>  <p>&#160;&#160;&#160;&#160; Set oDoc = ThisApplication.ActiveDocument</p>  <p>&#160;&#160;&#160;&#160; <font color="#00ff00">‘if stress simulation is activated      <br /></font>&#160;&#160;&#160;&#160; Dim UIManager As UserInterfaceManager</p>  <p>&#160;&#160;&#160; Set UIManager = ThisApplication.UserInterfaceManager</p>  <p>If UIManager.ActiveEnvironment.InternalName &lt;&gt; &quot;FEA Environment Internal Name&quot; Then</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font color="#00ff00">‘if it is not activated</font></p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim environmentMgr As EnvironmentManager</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set environmentMgr = oDoc.EnvironmentManager</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dim dsEnv As Environment</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Set dsEnv = UIManager.Environments.Item(&quot;FEA Environment Internal Name&quot;)</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; Call environmentMgr.SetCurrentEnvironment(dsEnv)</p>  <p>&#160;&#160;&#160; End If</p>  <p>&#160;&#160; ‘<font color="#00ff00">get [simulation] command</font></p>  <p>&#160;&#160;&#160; Dim oCol As ControlDefinition</p>  <p>&#160;&#160;&#160; Set oCol = ThisApplication.CommandManager.ControlDefinitions(&quot;FeaSimulateCmd&quot;)</p>  <p>&#160;&#160;&#160; ‘send [enter] key to the dialog to mimic the clicking [Run]</p>  <p>SendKeys &quot;{ENTER}&quot;</p>  <p><font color="#00ff00">‘execute the command. The dialog will pop out and execute run automatically.      <br /></font>&#160;&#160;&#160; oCol.Execute</p>  <p>End Sub</p>
