---
layout: "post"
title: "Which DrawingView triggered OnViewUpdate"
date: "2014-10-10 04:19:00"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/10/which-drawingview-triggered-onviewupdate.html "
typepad_basename: "which-drawingview-triggered-onviewupdate"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>Each drawing view has its own <strong>DrawingViewEvents</strong> object and the event you subscribe to through it is specific to that <strong>DrawingView</strong>. However, the event itself does not tell you which object triggered it.</p>
<p>If you want to listen to this event sent by only a couple of the drawing views then you can create a separate event handler function for each, and that way identify which <strong>DrawingView</strong> object sent it:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Runtime.InteropServices;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Collections.Generic; </span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Inventor;</span><br /> <span style="background: #ffffff; color: #0000ff;">using&#0160;</span><span style="background: #ffffff; color: #2b91af;">MsgBox</span><span style="background: #ffffff; color: #000000;"> = System.Windows.Forms.</span><span style="background: #ffffff; color: #2b91af;">MessageBox</span><span style="background: #ffffff; color: #000000;">; </span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> InventorConsoleCs</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">class&#0160;</span><span style="background: #ffffff; color: #2b91af;">Program</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /><span style="background: #ffffff; color: #000000;">&#0160; &#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingView</span><span style="background: #ffffff; color: #000000;"> dw1, dw2; </span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> Main(</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;">[] args)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;"> app = (</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Marshal</span><span style="background: #ffffff; color: #000000;">.GetActiveObject(</span><span style="background: #ffffff; color: #a31515;">&quot;Inventor.Application&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingDocument</span><span style="background: #ffffff; color: #000000;"> doc = <br />&#0160; &#0160; &#0160; &#0160; (</span><span style="background: #ffffff; color: #2b91af;">DrawingDocument</span><span style="background: #ffffff; color: #000000;">)app.ActiveDocument;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; dw1 = doc.ActiveSheet.DrawingViews[1];</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;dw1.DrawingViewEvents.OnViewUpdate += </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;DrawingViewEvents_OnViewUpdate1;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;dw2 = doc.ActiveSheet.DrawingViews[2];</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;dw2.DrawingViewEvents.OnViewUpdate += </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;DrawingViewEvents_OnViewUpdate2;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.</span><span style="background: #ffffff; color: #2b91af;">Console</span><span style="background: #ffffff; color: #000000;">.ReadKey(); </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> DrawingViewEvents_OnViewUpdate1(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">EventTimingEnum</span><span style="background: #ffffff; color: #000000;"> BeforeOrAfter, </span><span style="background: #ffffff; color: #2b91af;">NameValueMap</span><span style="background: #ffffff; color: #000000;"> Context, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">CommandTypesEnum</span><span style="background: #ffffff; color: #000000;"> ReasonsForChange, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">out&#0160;</span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;"> HandlingCode)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;HandlingCode = </span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;">.kEventNotHandled;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MsgBox</span><span style="background: #ffffff; color: #000000;">.Show(dw1.Name);&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> DrawingViewEvents_OnViewUpdate2(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">EventTimingEnum</span><span style="background: #ffffff; color: #000000;"> BeforeOrAfter, </span><span style="background: #ffffff; color: #2b91af;">NameValueMap</span><span style="background: #ffffff; color: #000000;"> Context, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">CommandTypesEnum</span><span style="background: #ffffff; color: #000000;"> ReasonsForChange, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">out&#0160;</span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;"> HandlingCode)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;HandlingCode = </span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;">.kEventNotHandled;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MsgBox</span><span style="background: #ffffff; color: #000000;">.Show(dw2.Name);&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>However, if you want to do things dynamically so that you can listen to this event coming from any number of drawing views then the best thing might be to wrap the event handler inside a <strong>class</strong>. Each <strong>class instance</strong> will know which <strong>DrawingView&#39;s</strong> event it&#39;s listening to and so inside its event handler function we can tell who sent it:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Runtime.InteropServices;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Collections.Generic; </span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Inventor;</span><br /> <span style="background: #ffffff; color: #0000ff;">using&#0160;</span><span style="background: #ffffff; color: #2b91af;">MsgBox</span><span style="background: #ffffff; color: #000000;"> = System.Windows.Forms.</span><span style="background: #ffffff; color: #2b91af;">MessageBox</span><span style="background: #ffffff; color: #000000;">; </span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> InventorConsoleCs</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">class&#0160;</span><span style="background: #ffffff; color: #2b91af;">Program</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">class&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingViewEventWatcher</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingView</span><span style="background: #ffffff; color: #000000;"> drawingView;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span><span style="background: #ffffff; color: #000000;"> DrawingViewEventWatcher(</span><span style="background: #ffffff; color: #2b91af;">DrawingView</span><span style="background: #ffffff; color: #000000;"> v)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;drawingView = v;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;v.DrawingViewEvents.OnViewUpdate += </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;DrawingViewEvents_OnViewUpdate;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> DrawingViewEvents_OnViewUpdate(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">EventTimingEnum</span><span style="background: #ffffff; color: #000000;"> BeforeOrAfter, </span><span style="background: #ffffff; color: #2b91af;">NameValueMap</span><span style="background: #ffffff; color: #000000;"> Context, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">CommandTypesEnum</span><span style="background: #ffffff; color: #000000;"> ReasonsForChange, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">out&#0160;</span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;"> HandlingCode)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;HandlingCode = </span><span style="background: #ffffff; color: #2b91af;">HandlingCodeEnum</span><span style="background: #ffffff; color: #000000;">.kEventNotHandled; </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">MsgBox</span><span style="background: #ffffff; color: #000000;">.Show(drawingView.Name);&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #2b91af;">List</span><span style="background: #ffffff; color: #000000;">&lt;</span><span style="background: #ffffff; color: #2b91af;">DrawingViewEventWatcher</span><span style="background: #ffffff; color: #000000;">&gt; watchers = </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">List</span><span style="background: #ffffff; color: #000000;">&lt;</span><span style="background: #ffffff; color: #2b91af;">DrawingViewEventWatcher</span><span style="background: #ffffff; color: #000000;">&gt;();</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160; &#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static&#0160;</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> Main(</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;">[] args)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;"> app = (</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Marshal</span><span style="background: #ffffff; color: #000000;">.GetActiveObject(</span><span style="background: #ffffff; color: #a31515;">&quot;Inventor.Application&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingDocument</span><span style="background: #ffffff; color: #000000;"> doc = <br />&#0160; &#0160; &#0160; &#0160; (</span><span style="background: #ffffff; color: #2b91af;">DrawingDocument</span><span style="background: #ffffff; color: #000000;">)app.ActiveDocument;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">foreach</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #2b91af;">Sheet</span><span style="background: #ffffff; color: #000000;"> s </span><span style="background: #ffffff; color: #0000ff;">in</span><span style="background: #ffffff; color: #000000;"> doc.Sheets)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">foreach</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #2b91af;">DrawingView</span><span style="background: #ffffff; color: #000000;"> v </span><span style="background: #ffffff; color: #0000ff;">in</span><span style="background: #ffffff; color: #000000;"> s.DrawingViews) </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;watchers.Add(</span><span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">DrawingViewEventWatcher</span><span style="background: #ffffff; color: #000000;">(v));&#0160;&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /><span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; </span></div>
<div style="background-color: #ffffff; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #000000;">&#0160; &#0160; &#0160; System.Console.ReadKey();&#0160;&#0160; &#0160; </span></div>
<div style="background-color: #ffffff; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #000000;">&#0160; &#0160; }</span><br /><span style="background: #ffffff; color: #000000;">&#0160; }</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>When running the code on a drawing with the following content then this is what we get when we modify the assembly and switch back to the drawing:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07966a0b970d-pi" style="display: inline;"><img alt="Onviewupdate" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb07966a0b970d img-responsive" src="/assets/image_8d8c4a.jpg" title="Onviewupdate" /></a></p>
<p>&#0160;</p>
