---
layout: "post"
title: "Create Command for the Custom Entity in Vault"
date: "2012-05-15 20:15:52"
author: "Barbara Han"
categories:
  - "Barbara Han"
  - "Vault"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/create-command-for-the-custom-entity-in-vault.html "
typepad_basename: "create-command-for-the-custom-entity-in-vault"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/barbara-han.html" target="_self">Barbara Han</a></p>  <p>Vault 2013 introduces a new feature “Custom Entity” (also called “Custom Object” from Vault Explorer UI), and our 3-rd party developers may want to add commands to the context menu on the custom entity. This can be done straightly.</p>  <p>First of all, find the Name of the Custom Entity. This Name is not display name or display plural name as what you see from UI. It is a string like a GUID. You can run a small app to find the Name of the Custom Entity. Please refer to below VB.NET sample code:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="color: ; line-space: 140%"><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><span style="line-space: 140%"><font color="#000000"> custEntSvc </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> CustomEntityService = ServiceManager.CustomEntityService</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: ; line-space: 140%"><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><span style="line-space: 140%"><font color="#000000"> defs </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> CustEntDef() = custEntSvc.GetAllCustomEntityDefinitions()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: ; line-space: 140%"><font color="#0000ff"><font style="font-size: 8pt">For</font></font></span><font style="font-size: 8pt"><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">Each</font></span><span style="line-space: 140%"><font color="#000000"> def </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> CustEntDef </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">In</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> defs</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">If</font></span><span style="line-space: 140%"><font color="#000000"> def.DispName = &quot;CustObjTest&quot; </font></span></font><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; System.Diagnostics.Debug.Print(def.Name)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Exit</font></span><span style="line-space: 140%"><font color="#000000"> </font></span></font><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#0000ff">For</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">End</font></span><span style="line-space: 140%"><font color="#000000"> </font></span></font><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><span style="color: ; line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#0000ff">Next</font></font></span></p> </div>  <p>Next, you can add the command through a Vault Explorer extension application. The code is very similar like the one that creating the command for file or other entities, but the CommandItem.NavigationTypes needs to change to create a SelectionTypeId for the custom entity and CommandSite.Location needs to point to custom entity’s context menu. Please refer to below VB.NET sample code snippet for more details:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: ; line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#008000">' This function tells Vault Explorer what custom commands this extension provides.</font></font></span></p>    <p style="margin: 0px"><span style="color: ; line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#008000">' Part of the IExtension interface.</font></font></span></p>    <p style="margin: 0px"><span style="color: ; line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#008000">' A collection of CommandSites, which are collections of custom commands.</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: ; line-space: 140%"><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">Function</font></span><span style="line-space: 140%"><font color="#000000"> CommandSites() </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> IEnumerable(</font></span><span style="color: ; line-space: 140%"><font color="#0000ff">Of</font></span><span style="line-space: 140%"><font color="#000000"> CommandSite) </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">Implements</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> IExtension.CommandSites</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Create the Hello World command object.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' This command is active when a custom entity is selected</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' This command is not active if there are multiple entities selected</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Dim</font></span><span style="line-space: 140%"><font color="#000000"> helloWorldCmdItem </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> CommandItem(</font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;HelloWorldCommand&quot;</font></span><span style="line-space: 140%"><font color="#000000">, </font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;Hello World...&quot;</font></span><span style="line-space: 140%"><font color="#000000">) </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">With</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> { _</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">.NavigationTypes = </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> SelectionTypeId() {</font></span><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> SelectionTypeId(</font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;45466327-8edd-4ef4-a6df-295d8c1bd2cb&quot;</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000">)}, _</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; .MultiSelectEnabled = </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">False</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> _</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">'.NavigationTypes = New SelectionTypeId() {SelectionTypeId.File, SelectionTypeId.FileVersion}, _</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' The HelloWorldCommandHandler function is called when the custom command is executed.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">AddHandler</font></span><span style="line-space: 140%"><font color="#000000"> helloWorldCmdItem.Execute, </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">AddressOf</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> HelloWorldCommandHandler</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Create a command site to hook the command to the Advanced toolbar</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Dim</font></span><span style="line-space: 140%"><font color="#000000"> toolbarCmdSite </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> CommandSite(</font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;HelloWorldCommand.Toolbar&quot;</font></span><span style="line-space: 140%"><font color="#000000">, </font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;Hello World Menu&quot;</font></span><span style="line-space: 140%"><font color="#000000">) </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">With</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> { _</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160; .Location = CommandSiteLocation.AdvancedToolbar, _</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; .DeployAsPulldownMenu = </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">False</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> _</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; toolbarCmdSite.AddCommand(helloWorldCmdItem)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Create another command site to hook the command to the right-click menu for custom entity.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Dim</font></span><span style="line-space: 140%"><font color="#000000"> fileContextCmdSite </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> CommandSite(</font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;HelloWorldCommand.FileContextMenu&quot;</font></span><span style="line-space: 140%"><font color="#000000">, </font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;Hello World Menu&quot;</font></span><span style="line-space: 140%"><font color="#000000">) </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">With</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> { _</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; .Location = </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> CommandSiteLocation(</font></span><span style="color: ; line-space: 140%"><font color="#a31515">&quot;45466327-8edd-4ef4-a6df-295d8c1bd2cb&quot;</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000">, CommandSiteLocationType.ContextMenu), _</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; .DeployAsPulldownMenu = </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">False</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> _</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">'.Location = CommandSiteLocation.FileContextMenu, _</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; fileContextCmdSite.AddCommand(helloWorldCmdItem)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Now the custom command is available in 2 places.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Gather the sites in a List.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Dim</font></span><span style="line-space: 140%"><font color="#000000"> sites </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">As</font></span><span style="line-space: 140%"><font color="#000000"> </font></span><span style="color: ; line-space: 140%"><font color="#0000ff">New</font></span><span style="line-space: 140%"><font color="#000000"> List(</font></span><span style="color: ; line-space: 140%"><font color="#0000ff">Of</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> CommandSite)()</font></span></font></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; sites.Add(toolbarCmdSite)</font></font></span></p>    <p style="margin: 0px"><span style="line-space: 140%"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; sites.Add(fileContextCmdSite)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#008000">' Return the list of CommandSites.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-space: 140%"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="color: ; line-space: 140%"><font color="#0000ff">Return</font></span></font><span style="line-space: 140%"><font style="font-size: 8pt" color="#000000"> sites</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: ; line-space: 140%"><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><span style="line-space: 140%"><font color="#000000"> </font></span></font><span style="color: ; line-space: 140%"><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>
