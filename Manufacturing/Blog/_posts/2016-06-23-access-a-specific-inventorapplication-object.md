---
layout: "post"
title: "Access a specific Inventor.Application object"
date: "2016-06-23 09:43:58"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "Inventor"
original_url: "https://adndevblog.typepad.com/manufacturing/2016/06/access-a-specific-inventorapplication-object.html "
typepad_basename: "access-a-specific-inventorapplication-object"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>When running multiple instances of <strong>Inventor</strong> (or <strong>AutoCAD</strong>, <strong>Microsoft</strong> <strong>Excel</strong>, etc) then even though the <strong>ROT</strong> (Running Objects Table) lists all the running instances, they will all return the same<strong> Inventor.Application</strong> object that is returned by <strong>GetActiveObject</strong>&#0160;as well - i.e. the first <strong>Inventor</strong> instance. See comments of this blog post:&#0160;<br /><a href="http://adndevblog.typepad.com/autocad/2013/12/accessing-com-applications-from-the-running-object-table.html">http://adndevblog.typepad.com/autocad/2013/12/accessing-com-applications-from-the-running-object-table.html</a></p>
<p>The <strong>ROT</strong>&#0160;also returns the currently open documents (<strong>Inventor.Document</strong> object) and those have the correct <strong>COM</strong> reference. So from those you can find the various <strong>Inventor.Application</strong> objects. &#0160;Of course this only works for the <strong>Inventor</strong> instances which have documents open in them - and those documents need to be unique. E.g. if in <strong>Inventor instance #2</strong> I open &quot;<strong>mypart.ipt</strong>&quot; then I also open the same file in <strong>Inventor instance #3</strong> then that document will only have a single reference in the <strong>ROT</strong> and that will reference <strong>Inventor instance #2</strong>. I won&#39;t be able to access <strong>Inventor instance #3</strong>.</p>
<p>If you are trying to access the <strong>Inventor</strong> instance that you create through <strong>CreateProcess</strong> then one workaround is to create a copy of a template document with a unique name and open that in <strong>Inventor</strong>.</p>
<div style="font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Diagnostics;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Runtime.InteropServices;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System.Runtime.InteropServices.ComTypes;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> InventorConsoleAppCSharp</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">class</span> <span style="background: #ffffff; color: #2b91af;">Program</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;[</span><span style="background: #ffffff; color: #2b91af;">DllImport</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #a31515;">&quot;ole32.dll&quot;</span><span style="background: #ffffff; color: #000000;">)]</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static</span> <span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #0000ff;">int</span><span style="background: #ffffff; color: #000000;"> CreateBindCtx(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">uint</span><span style="background: #ffffff; color: #000000;"> reserved,</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">out</span> <span style="background: #ffffff; color: #2b91af;">IBindCtx</span><span style="background: #ffffff; color: #000000;"> ppbc);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;[</span><span style="background: #ffffff; color: #2b91af;">DllImport</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #a31515;">&quot;ole32.dll&quot;</span><span style="background: #ffffff; color: #000000;">)]</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #0000ff;">static</span> <span style="background: #ffffff; color: #0000ff;">extern</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> GetRunningObjectTable(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">int</span><span style="background: #ffffff; color: #000000;"> reserved,</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">out</span> <span style="background: #ffffff; color: #2b91af;">IRunningObjectTable</span><span style="background: #ffffff; color: #000000;"> prot);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Requires Using System.Runtime.InteropServices.ComTypes</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Get all running instance by querying ROT</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">private</span> <span style="background: #ffffff; color: #0000ff;">static</span> <span style="background: #ffffff; color: #0000ff;">object</span><span style="background: #ffffff; color: #000000;"> GetInventorApplicationWithWindowHandle(</span><span style="background: #ffffff; color: #2b91af;">IntPtr</span><span style="background: #ffffff; color: #000000;"> hwnd)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// get Running Object Table ...</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">IRunningObjectTable</span><span style="background: #ffffff; color: #000000;"> Rot = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;GetRunningObjectTable(0, </span><span style="background: #ffffff; color: #0000ff;">out</span><span style="background: #ffffff; color: #000000;"> Rot);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (Rot == </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// get enumerator for ROT entries</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">IEnumMoniker</span><span style="background: #ffffff; color: #000000;"> monikerEnumerator = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;Rot.EnumRunning(</span><span style="background: #ffffff; color: #0000ff;">out</span><span style="background: #ffffff; color: #000000;"> monikerEnumerator);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (monikerEnumerator == </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;monikerEnumerator.Reset();</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">IntPtr</span><span style="background: #ffffff; color: #000000;"> pNumFetched = </span><span style="background: #ffffff; color: #0000ff;">new</span> <span style="background: #ffffff; color: #2b91af;">IntPtr</span><span style="background: #ffffff; color: #000000;">();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">IMoniker</span><span style="background: #ffffff; color: #000000;">[] monikers = </span><span style="background: #ffffff; color: #0000ff;">new</span> <span style="background: #ffffff; color: #2b91af;">IMoniker</span><span style="background: #ffffff; color: #000000;">[1];</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// go through all entries and identifies app instances</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">while</span><span style="background: #ffffff; color: #000000;"> (monikerEnumerator.Next(1, monikers, pNumFetched) == 0)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">IBindCtx</span><span style="background: #ffffff; color: #000000;"> bindCtx;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;CreateBindCtx(0, </span><span style="background: #ffffff; color: #0000ff;">out</span><span style="background: #ffffff; color: #000000;"> bindCtx);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (bindCtx == </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">continue</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> displayName;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;monikers[0].GetDisplayName(bindCtx, </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #0000ff;">out</span><span style="background: #ffffff; color: #000000;"> displayName);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.</span><span style="background: #ffffff; color: #2b91af;">Console</span><span style="background: #ffffff; color: #000000;">.WriteLine(displayName);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">object</span><span style="background: #ffffff; color: #000000;"> ComObject;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;Rot.GetObject(monikers[0], </span><span style="background: #ffffff; color: #0000ff;">out</span><span style="background: #ffffff; color: #000000;"> ComObject);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (ComObject == </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">continue</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">try</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">dynamic</span><span style="background: #ffffff; color: #000000;"> invDoc = ComObject;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #0000ff;">new</span> <span style="background: #ffffff; color: #2b91af;">IntPtr</span><span style="background: #ffffff; color: #000000;">(invDoc.Parent.MainFrameHWND) == hwnd)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// The parent of the document is the Application</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span><span style="background: #ffffff; color: #000000;"> invDoc.Parent;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">catch</span><span style="background: #ffffff; color: #000000;"> { }</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span> <span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">static</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> Main(</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;">[] args)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Create document with unique name</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> fileName = </span><span style="background: #ffffff; color: #a31515;">&quot;C:\\temp\\&quot;</span><span style="background: #ffffff; color: #000000;"> + </span><span style="background: #ffffff; color: #2b91af;">Guid</span><span style="background: #ffffff; color: #000000;">.NewGuid().ToString() + </span><span style="background: #ffffff; color: #a31515;">&quot;.ipt&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.IO.</span><span style="background: #ffffff; color: #2b91af;">File</span><span style="background: #ffffff; color: #000000;">.Copy(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;C:\\temp\\Gusset2013.ipt&quot;</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;fileName);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Start Inventor</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Process</span><span style="background: #ffffff; color: #000000;"> process = </span><span style="background: #ffffff; color: #2b91af;">Process</span><span style="background: #ffffff; color: #000000;">.Start(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">@&quot;C:\Program Files\Autodesk\Inventor 2016\Bin\Inventor.exe&quot;</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;\&quot;&quot;</span><span style="background: #ffffff; color: #000000;"> + fileName + </span><span style="background: #ffffff; color: #a31515;">&quot;\&quot;&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Wait until Inventor is fully ready</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;process.WaitForInputIdle();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">while</span><span style="background: #ffffff; color: #000000;"> (process.MainWindowTitle == </span><span style="background: #ffffff; color: #a31515;">&quot;&quot;</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;process.Refresh();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.Threading.</span><span style="background: #ffffff; color: #2b91af;">Thread</span><span style="background: #ffffff; color: #000000;">.Sleep(1000);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Get all the Inventor.Application objects</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// registered in the ROT</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// ROT = Running Objects Table</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;Inventor.</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;"> app = </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">for</span><span style="background: #ffffff; color: #000000;"> (; app == </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">; System.Threading.</span><span style="background: #ffffff; color: #2b91af;">Thread</span><span style="background: #ffffff; color: #000000;">.Sleep(1000))</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Find the Inventor.Application object with </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// the correct window handle</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;app = GetInventorApplicationWithWindowHandle(process.MainWindowHandle) </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">as</span><span style="background: #ffffff; color: #000000;"> Inventor.</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Console</span><span style="background: #ffffff; color: #000000;">.WriteLine(</span><span style="background: #ffffff; color: #a31515;">&quot;Found Inventor.Application object with title:\n&quot;</span><span style="background: #ffffff; color: #000000;"> + app.Caption);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Let&#39;s close file and delete it</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;app.Documents.get_ItemByName(fileName).Close();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.IO.</span><span style="background: #ffffff; color: #2b91af;">File</span><span style="background: #ffffff; color: #000000;">.Delete(fileName);</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">// Wait for user to finish</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Console</span><span style="background: #ffffff; color: #000000;">.WriteLine(</span><span style="background: #ffffff; color: #a31515;">&quot;Press key to exit&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Console</span><span style="background: #ffffff; color: #000000;">.ReadKey();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p>&#0160;</p>
