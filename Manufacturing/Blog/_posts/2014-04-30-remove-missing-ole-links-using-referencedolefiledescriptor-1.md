---
layout: "post"
title: "Remove missing OLE Links using ReferencedOLEFileDescriptor"
date: "2014-04-30 12:40:00"
author: "Wayne Brill"
categories:
  - "Inventor"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/manufacturing/2014/04/remove-missing-ole-links-using-referencedolefiledescriptor-1.html "
typepad_basename: "remove-missing-ole-links-using-referencedolefiledescriptor-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/wayne-brill.html" target="_self">Wayne Brill</a></p>
<p>Here is a VBA example that uses the Delete method of the ReferencedOLEFileDescriptor in a part file to remove OLE links. SilentOperation of the Application is set to True to avoid dialogs.</p>
<p>Also the Dirty property of the document is set to True. I found that without doing this the save did not save to disk with the removed Links.</p>
<p>This ivb has&#0160;code&#0160;that removes the links in a&#0160;part as well as removing the links in parts in an assembly. It is an update to the AssemblyCount VBA example in the API help.</p>
<p>&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b01a511ad9f0a970c img-responsive"><a href="http://adndevblog.typepad.com/files/removeolelinks.ivb">Download RemoveOLELinks</a></span></p>
<p>&#0160;</p>
<p>Public Sub oleLinksDelete() <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; ThisApplication.SilentOperation = True <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160; Dim oPartDoc As PartDocument <br />&#0160;&#0160;&#0160;&#0160; Set oPartDoc = ThisApplication.ActiveDocument <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160; Dim bSaveDoc As Boolean <br />&#0160;&#0160;&#0160;&#0160; bSaveDoc = False <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160; Dim oRefOleFileDesc As ReferencedOLEFileDescriptor <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160; If oPartDoc.ReferencedOLEFileDescriptors.Count &gt; 0 Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; For Each oRefOleFileDesc In _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPartDoc.ReferencedOLEFileDescriptors <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39;Debug.Print oRefOleFileDesc.ReferenceStatus <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If oRefOleFileDesc.ReferenceStatus = _ <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; kMissingReference Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; Debug.Print oRefOleFileDesc.DisplayName <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oRefOleFileDesc.Delete <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPartDoc.Dirty = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bSaveDoc = True <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Next oRefOleFileDesc <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; If bSaveDoc = True Then <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oPartDoc.Save <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bSaveDoc = False <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160;&#0160;&#0160; End If <br />&#0160;&#0160;&#0160; <span style="color: #0000ff;">&#39; Be sure to set this back to False <br /></span>&#0160;&#0160;&#0160;&#0160; ThisApplication.SilentOperation = False <br />End Sub</p>
