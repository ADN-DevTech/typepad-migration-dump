---
layout: "post"
title: "Get custom values from ipart member"
date: "2012-05-27 06:52:43"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2012/05/get-custom-values-from-ipart-member.html "
typepad_basename: "get-custom-values-from-ipart-member"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Issue</strong>:<br />We have one ipart with the custom parameters and place this ipart in an assembly. We need to get existing custom values for a particular occurrence (ipartmember).</p>
<p><br /><strong>Solution</strong><br />If you check iPartTableColumn.FormattedHeading, you will find there is such format &quot;&lt;free&gt;&lt;/free&gt;&quot; for custom column. Following is a simple sample.It assumes an assembly is opened. And the first occurrence is an iPart member.</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;"><span style="color: #0000ff;">void</span>&#0160;test()<br /> {&#0160; &#0160; &#0160;&#0160;<br />&#0160; &#0160; &#0160;<br />&#0160; &#0160; &#0160;<span style="color: #008000;">// assume we have had Inventor application</span><br /> <br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">// get current assemly</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #2b91af;">AssemblyDocument</span> invAD = <br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;(<span style="color: #2b91af;">AssemblyDocument</span>)_InvApplication.ActiveDocument;<br /> <br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">// assume the first Occurrence is from iPart</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #2b91af;">ComponentOccurrence</span> invCO&#0160;&#0160;= <br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;invAD.ComponentDefinition.Occurrences[1];<br /> &#0160;&#0160;&#0160;<br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">// get PartComponentDefinition</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #2b91af;">PartComponentDefinition</span> invPCD = <br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;(<span style="color: #2b91af;">PartComponentDefinition</span>)invCO.Definition;&#0160;&#0160;<br /> &#0160;&#0160;&#0160;<br /> &#0160;&#0160;&#0160;&#0160;<span style="color: #0000ff;">if</span>(invPCD.IsiPartMember)<br /> &#0160;&#0160;&#0160;&#0160;{<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">// get iPartFactory</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #2b91af;">iPartFactory</span> iPartfac =</div>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;invPCD.iPartMember.ParentFactory;<br /> <br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">// dump the custom values</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #0000ff;">foreach</span> (<span style="color: #2b91af;">iPartTableCell</span> inviPTC <span style="color: #0000ff;">in</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;invPCD.iPartMember.Row)<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #2b91af;">String</span> oFormatHeading =</div>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; iPartfac.TableColumns[inviPTC.Column].</div>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;FormattedHeading;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #0000ff;">if</span> (oFormatHeading.IndexOf(<span style="color: #a31515;">&quot;&lt;free&gt;&quot;</span>) != -1)<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="color: #008000;">//get value:&#0160;&#0160;iPartTableCell.Value&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;System.Diagnostics.<span style="color: #2b91af;">Debug</span>.Write(</div>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; inviPTC.Value.ToString());<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<br /> &#0160;&#0160;&#0160;&#0160;}&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<br /> }</div>
