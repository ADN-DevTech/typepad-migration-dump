---
layout: "post"
title: "Access Inventor Studio by code"
date: "2013-08-19 08:01:00"
author: "Xiaodong Liang"
categories:
  - "Inventor"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/manufacturing/2013/08/access-inventor-studio-by-code.html "
typepad_basename: "access-inventor-studio-by-code"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>Inventor Studio is also an add-in of Inventor. The corresponding *.dll locates at &lt;Inventor Installation Path&gt;\bin\Archon.dll. This dll provides some basic interfaces of Studio. The Interop.InventorStudioLib.dll is generated by VS when you add the lib from    <br />- 32bits: [Add Reference] &gt;&gt; [COM tab] &gt;&gt; [Inventor Studio Library ]     <br />- 64bits: &lt;Inventor Install Path&gt;\bin\archon.dll&#160; (you may need to run regsvr32 to register the dll firstly if you get a failure when adding the dll)</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901edeb51e970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_793c2a.jpg" width="415" height="192" /></a></p>  <p>After inporting the library, you could get its Automation interface by the add-in. e.g. the code below gets the constraints names the animation uses.</p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><font face="NSimSun"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">using</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"> InventorStudioLib;</font></span></font></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><font face="NSimSun"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">namespace</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"> WindowsFormsApplication3</font></span></font></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">{</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160; <span style="color: "><font color="#0000ff">public</font></span> <span style="color: "><font color="#0000ff">partial</font></span> <span style="color: "><font color="#0000ff">class</font></span> <span style="color: "><font color="#2b91af">Form1</font></span> : </font><span style="color: "><font style="font-size: 9.5pt" color="#2b91af">Form</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">public</font></span> Form1()</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InitializeComponent();</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">private</font></span> <span style="color: "><font color="#0000ff">void</font></span> button1_Click(<span style="color: "><font color="#0000ff">object</font></span> sender, <span style="color: "><font color="#2b91af">EventArgs</font></span> e)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">Application</font></span> m_inventorApplication =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (Inventor.<span style="color: "><font color="#2b91af">Application</font></span>)System.Runtime.InteropServices.<span style="color: "><font color="#2b91af">Marshal</font></span>.</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetActiveObject(<span style="color: "><font color="#a31515">&quot;Inventor.Application&quot;</font></span>);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (m_inventorApplication == <span style="color: "><font color="#0000ff">null</font></span>)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">MessageBox</font></span>.Show(<span style="color: "><font color="#a31515">&quot;no Inventor running!&quot;</font></span>);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">return</font></span>;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">_Document</font></span> oActivedoc = m_inventorApplication.ActiveDocument;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (oActivedoc == <span style="color: "><font color="#0000ff">null</font></span>)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">MessageBox</font></span>.Show(<span style="color: "><font color="#a31515">&quot;Please open an assembly document!&quot;</font></span>);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">return</font></span>;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">//studio is also an addin which has its guid</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">string</font></span> sutdioAddinGuid =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#a31515">&quot;{F3D38928-74D1-4814-8C24-A74CE8F3B2E3}&quot;</font></span>;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">ApplicationAddIn</font></span> oStudioAddin = <span style="color: "><font color="#0000ff">null</font></span>;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#0000ff">try</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">// try to get studio addin</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oStudioAddin =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication.ApplicationAddIns.</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; get_ItemById(sutdioAddinGuid);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#0000ff">catch</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">// any error...</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">return</font></span>;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (oStudioAddin != <span style="color: "><font color="#0000ff">null</font></span>)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">// activate the addin</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (!oStudioAddin.Activated)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oStudioAddin.Activate();</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">//get property EnvironmentManager</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">object</font></span> oObj = oActivedoc.GetType().InvokeMember(</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#a31515">&quot;EnvironmentManager&quot;</font></span>,</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Reflection.<span style="color: "><font color="#2b91af">BindingFlags</font></span>.GetProperty,</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">null</font></span>, oActivedoc, <span style="color: "><font color="#0000ff">null</font></span>, <span style="color: "><font color="#0000ff">null</font></span>, <span style="color: "><font color="#0000ff">null</font></span>, <span style="color: "><font color="#0000ff">null</font></span>);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">EnvironmentManager</font></span> oEnvironmentMgr =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (Inventor.<span style="color: "><font color="#2b91af">EnvironmentManager</font></span>)oObj;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">//activate the enviroment of Studio</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">UserInterfaceManager</font></span> UIManager =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_inventorApplication.UserInterfaceManager;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (UIManager.ActiveEnvironment.InternalName != <span style="color: "><font color="#a31515">&quot;Archon:Env&quot;</font></span>)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">Environment</font></span> studioEnv =</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UIManager.Environments[<span style="color: "><font color="#a31515">&quot;Archon:Env&quot;</font></span>];</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oEnvironmentMgr.SetCurrentEnvironment(studioEnv);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">// get the automation interface of Studio</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">InventorStudio</font></span> oInventorStudio = oStudioAddin.Automation;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 9.5pt" color="#008000">//AnimationManager</font></span></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">AnimationManager</font></span> oAM = oInventorStudio.AnimationManager;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">if</font></span> (oAM.AnimationFavorites.Count &gt;0)</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">MessageBox</font></span>.Show(<span style="color: "><font color="#a31515">&quot;Studio has AnimationFavourites not empty&quot;</font></span>);</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; color: ; mso-highlight: yellow"><font style="background-color: #ffff00; font-size: 9.5pt" color="#008000">// get first item in AnimationFavorites</font></span></font><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow"></span></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-highlight: yellow"><font face="NSimSun"><font style="background-color: #ffff00; font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#0000ff">object</font></span> oAF = oAM.AnimationFavorites[1];</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-highlight: yellow"><font face="NSimSun"><font style="background-color: #ffff00; font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inventor.<span style="color: "><font color="#2b91af">AssemblyConstraint</font></span> oAC = (Inventor.<span style="color: "><font color="#2b91af">AssemblyConstraint</font></span>) oAF;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-highlight: yellow"><font face="NSimSun"><font style="background-color: #ffff00; font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: "><font color="#2b91af">MessageBox</font></span>.Show(<span style="color: "><font color="#a31515">&quot;AnimationFavourites first item: &quot;</font></span> + oAC.Name);</font></font></span><span style="font-family: "></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>  <p style="margin: 0in 0in 0pt; text-autospace: " class="MsoNormal"><span style="font-family: "><font face="NSimSun"><font style="font-size: 9.5pt">&#160;&#160;&#160; }</font></font></span></p> <span style="font-family: ; mso-bidi-font-family: simsun; mso-fareast-font-family: simsun; mso-ansi-language: en-us; mso-fareast-language: zh-cn; mso-bidi-language: ar-sa"><font face="NSimSun"><font style="font-size: 9.5pt">}</font></font></span>
